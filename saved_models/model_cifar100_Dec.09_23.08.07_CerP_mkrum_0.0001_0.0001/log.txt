current path: saved_models/model_cifar100_Dec.09_23.08.07_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4307/4885 (88.1679%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43997944708209. Distance: 2.29274861775395
Total norm for 4 adversaries is: 42.43997944708209. distance: 2.29274861775395
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4383, Accuracy: 8838/9900 (89.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43521889579898. Distance: 2.250044080514382
Total norm for 4 adversaries is: 42.43521889579898. distance: 2.250044080514382
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7330, Accuracy: 8305/9900 (83.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4180/4717 (88.6156%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43861893315009. Distance: 2.176620348992042
Total norm for 4 adversaries is: 42.43861893315009. distance: 2.176620348992042
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4285, Accuracy: 8889/9900 (89.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4457/5066 (87.9787%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44031309711617. Distance: 2.303691377188843
Total norm for 4 adversaries is: 42.44031309711617. distance: 2.303691377188843
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6001, Accuracy: 8501/9900 (85.8687%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3840/4356 (88.1543%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3664/4356 (84.1139%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4076, Accuracy: 4675/10000 (46.7500%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3939/4465 (88.2195%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4093/4465 (91.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9795, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4040/4647 (86.9378%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4160/4647 (89.5201%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9253, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4447/5055 (87.9723%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4527/5055 (89.5549%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0860, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4445/5116 (86.8843%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4480/5116 (87.5684%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9202, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3630/4126 (87.9787%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3756/4126 (91.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9296, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3082/3472 (88.7673%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3213/3472 (92.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0640, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4432/4986 (88.8889%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4444/4986 (89.1296%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0799, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3535/4013 (88.0887%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3677/4013 (91.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8334, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4035/4618 (87.3755%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4097/4618 (88.7181%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0694, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4428/5083 (87.1139%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4430/5083 (87.1533%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2198, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3967/4511 (87.9406%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4033/4511 (89.4037%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1402, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3330/3797 (87.7008%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3397/3797 (89.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9766, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5002/5582 (89.6095%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5063/5582 (90.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1171, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3160/3616 (87.3894%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3212/3616 (88.8274%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0547, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4827/5455 (88.4876%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4839/5455 (88.7076%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9908, Accuracy: 5260/10000 (52.6000%)
time spent on training: 261.0910427570343
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1308, Accuracy: 7004/10000 (70.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.7116, Accuracy: 67/9900 (0.6768%)
Done in 290.3347146511078 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4381/4885 (89.6827%), train_poison_data_count: 385
Global model norm: 42.46745939448079.
Norm before scaling: 42.475019945091695. Distance: 2.1782627713430918
Total norm for 4 adversaries is: 42.475019945091695. distance: 2.1782627713430918
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2004, Accuracy: 9377/9900 (94.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 42.46745939448079.
Norm before scaling: 42.470997687024614. Distance: 2.2105863582133907
Total norm for 4 adversaries is: 42.470997687024614. distance: 2.2105863582133907
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4859, Accuracy: 8729/9900 (88.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 42.46745939448079.
Norm before scaling: 42.47568812899033. Distance: 2.2232431397833547
Total norm for 4 adversaries is: 42.47568812899033. distance: 2.2232431397833547
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1833, Accuracy: 9434/9900 (95.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4476/5066 (88.3537%), train_poison_data_count: 400
Global model norm: 42.46745939448079.
Norm before scaling: 42.47752881349811. Distance: 2.3454286794331685
Total norm for 4 adversaries is: 42.47752881349811. distance: 2.3454286794331685
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2249, Accuracy: 9294/9900 (93.8788%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3586/4025 (89.0932%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3722/4025 (92.4720%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8741, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3321/3797 (87.4638%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3390/3797 (89.2810%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0157, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3936/4625 (85.1027%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3983/4625 (86.1189%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1911, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3858/4481 (86.0969%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3850/4481 (85.9183%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1963, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3848/4315 (89.1773%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3984/4315 (92.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9617, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3707/4235 (87.5325%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3817/4235 (90.1299%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9836, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3352/3828 (87.5653%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3458/3828 (90.3344%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9016, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3815/4416 (86.3904%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3993/4416 (90.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8811, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3156/3638 (86.7510%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3285/3638 (90.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9650, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4510/5265 (85.6600%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4529/5265 (86.0209%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0338, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3349/3781 (88.5745%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3311/3781 (87.5694%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2864, Accuracy: 4992/10000 (49.9200%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3964/4441 (89.2592%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4010/4441 (90.2950%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2038, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3964/4433 (89.4203%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4008/4433 (90.4128%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9487, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4400/5083 (86.5631%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4441/5083 (87.3697%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2099, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4323/4928 (87.7232%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4391/4928 (89.1031%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8825, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4140/4793 (86.3760%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4350/4793 (90.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9880, Accuracy: 5488/10000 (54.8800%)
time spent on training: 251.29234266281128
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1432, Accuracy: 6986/10000 (69.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.3400, Accuracy: 80/9900 (0.8081%)
Done in 279.89613461494446 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 42.49813874600863.
Norm before scaling: 42.50063476088475. Distance: 2.1347224029604916
Total norm for 4 adversaries is: 42.50063476088475. distance: 2.1347224029604916
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2192, Accuracy: 9323/9900 (94.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4734/5305 (89.2366%), train_poison_data_count: 415
Global model norm: 42.49813874600863.
Norm before scaling: 42.502056475981256. Distance: 2.2039976082804418
Total norm for 4 adversaries is: 42.502056475981256. distance: 2.2039976082804418
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0740, Accuracy: 9692/9900 (97.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4199/4717 (89.0184%), train_poison_data_count: 370
Global model norm: 42.49813874600863.
Norm before scaling: 42.50248872538598. Distance: 2.1138165090464303
Total norm for 4 adversaries is: 42.50248872538598. distance: 2.1138165090464303
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1941, Accuracy: 9388/9900 (94.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 42.49813874600863.
Norm before scaling: 42.504256450457405. Distance: 2.2626536912510455
Total norm for 4 adversaries is: 42.504256450457405. distance: 2.2626536912510455
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1615, Accuracy: 9463/9900 (95.5859%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3135/3616 (86.6980%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3294/3616 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9017, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3395/3837 (88.4806%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3505/3837 (91.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9093, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4154/4679 (88.7797%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4262/4679 (91.0878%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0021, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3071/3638 (84.4145%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3259/3638 (89.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1394, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3605/4046 (89.1003%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3637/4046 (89.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9909, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3949/4518 (87.4059%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4085/4518 (90.4161%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0635, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3350/3797 (88.2275%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3403/3797 (89.6234%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0323, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4394/5025 (87.4428%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4459/5025 (88.7363%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3904, Accuracy: 4970/10000 (49.7000%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3926/4362 (90.0046%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3952/4362 (90.6006%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0067, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3976/4558 (87.2312%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4021/4558 (88.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2456, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3210/3672 (87.4183%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3248/3672 (88.4532%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0758, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4309/4874 (88.4079%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4357/4874 (89.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1206, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3592/4025 (89.2422%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3705/4025 (92.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9018, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4101/4663 (87.9477%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4242/4663 (90.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1384, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3416/3911 (87.3434%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3467/3911 (88.6474%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0369, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4435/5017 (88.3994%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4539/5017 (90.4724%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8320, Accuracy: 5762/10000 (57.6200%)
time spent on training: 256.19155049324036
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1314, Accuracy: 6995/10000 (69.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.1585, Accuracy: 90/9900 (0.9091%)
Done in 285.0931758880615 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4391/4885 (89.8874%), train_poison_data_count: 385
Global model norm: 42.529768985970286.
Norm before scaling: 42.53591083940133. Distance: 2.140322253126618
Total norm for 4 adversaries is: 42.53591083940133. distance: 2.140322253126618
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5410, Accuracy: 8670/9900 (87.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 42.529768985970286.
Norm before scaling: 42.52981921500417. Distance: 2.152921346436997
Total norm for 4 adversaries is: 42.52981921500417. distance: 2.152921346436997
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0842, Accuracy: 9675/9900 (97.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 42.529768985970286.
Norm before scaling: 42.531628855770386. Distance: 2.086428580894886
Total norm for 4 adversaries is: 42.531628855770386. distance: 2.086428580894886
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1705, Accuracy: 9461/9900 (95.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4500/5066 (88.8275%), train_poison_data_count: 400
Global model norm: 42.529768985970286.
Norm before scaling: 42.53636713797824. Distance: 2.271349180467278
Total norm for 4 adversaries is: 42.53636713797824. distance: 2.271349180467278
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3320, Accuracy: 9068/9900 (91.5960%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5239/6124 (85.5487%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5300/6124 (86.5447%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1322, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3843/4356 (88.2231%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3587/4356 (82.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3488, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3503/4158 (84.2472%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3568/4158 (85.8105%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0523, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4993/5455 (91.5307%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4968/5455 (91.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9511, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3897/4511 (86.3888%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4079/4511 (90.4234%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9739, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4510/5232 (86.2003%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4503/5232 (86.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1061, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4467/5244 (85.1831%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4564/5244 (87.0328%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9819, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4354/4918 (88.5319%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4440/4918 (90.2806%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0000, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3594/4126 (87.1062%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3679/4126 (89.1663%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8591, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4321/4928 (87.6826%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4399/4928 (89.2654%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1278, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3740/4223 (88.5626%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3844/4223 (91.0253%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8869, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4527/5195 (87.1415%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4612/5195 (88.7777%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0472, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4113/4679 (87.9034%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4130/4679 (88.2667%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9562, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3194/3646 (87.6029%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3269/3646 (89.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8910, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3176/3616 (87.8319%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3223/3616 (89.1316%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8984, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4053/4716 (85.9415%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4086/4716 (86.6412%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0885, Accuracy: 5302/10000 (53.0200%)
time spent on training: 266.17018008232117
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.1485, Accuracy: 6969/10000 (69.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.1517, Accuracy: 106/9900 (1.0707%)
Done in 294.89446687698364 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 42.566136500303855.
Norm before scaling: 42.57101431450307. Distance: 2.1479445013196945
Total norm for 4 adversaries is: 42.57101431450307. distance: 2.1479445013196945
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1101, Accuracy: 9616/9900 (97.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 42.566136500303855.
Norm before scaling: 42.560737562170345. Distance: 2.124170814750555
Total norm for 4 adversaries is: 42.560737562170345. distance: 2.124170814750555
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.0875, Accuracy: 9673/9900 (97.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 42.566136500303855.
Norm before scaling: 42.56767933795252. Distance: 2.0839245402390176
Total norm for 4 adversaries is: 42.56767933795252. distance: 2.0839245402390176
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1912, Accuracy: 9413/9900 (95.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4502/5066 (88.8670%), train_poison_data_count: 400
Global model norm: 42.566136500303855.
Norm before scaling: 42.57581272391124. Distance: 2.2846219995141563
Total norm for 4 adversaries is: 42.57581272391124. distance: 2.2846219995141563
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2534, Accuracy: 9261/9900 (93.5455%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5257/6124 (85.8426%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5340/6124 (87.1979%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0659, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3955/4433 (89.2172%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3990/4433 (90.0068%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0987, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3362/3781 (88.9183%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3127/3781 (82.7030%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.5515, Accuracy: 4662/10000 (46.6200%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3546/3969 (89.3424%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3584/3969 (90.2998%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9033, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4452/5025 (88.5970%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4527/5025 (90.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1127, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4148/4679 (88.6514%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4257/4679 (90.9810%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9483, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4149/4707 (88.1453%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4241/4707 (90.0999%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9778, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4388/4986 (88.0064%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4440/4986 (89.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9140, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3905/4315 (90.4983%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3950/4315 (91.5411%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8846, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3805/4416 (86.1639%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3911/4416 (88.5643%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0082, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4212/4804 (87.6769%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4085/4804 (85.0333%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1459, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4261/4793 (88.9005%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4317/4793 (90.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0192, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4502/5232 (86.0474%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4635/5232 (88.5894%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9699, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4086/4662 (87.6448%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4235/4662 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0059, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4227/4956 (85.2906%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4329/4956 (87.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1664, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3810/4368 (87.2253%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3830/4368 (87.6832%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9189, Accuracy: 5442/10000 (54.4200%)
time spent on training: 260.14459347724915
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.1462, Accuracy: 6959/10000 (69.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.1947, Accuracy: 102/9900 (1.0303%)
Done in 289.12667179107666 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4384/4885 (89.7441%), train_poison_data_count: 385
Global model norm: 42.595996822618204.
Norm before scaling: 42.6004428321137. Distance: 2.1657653058552735
Total norm for 4 adversaries is: 42.6004428321137. distance: 2.1657653058552735
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2451, Accuracy: 9283/9900 (93.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 42.595996822618204.
Norm before scaling: 42.59313525556011. Distance: 2.1389912406025107
Total norm for 4 adversaries is: 42.59313525556011. distance: 2.1389912406025107
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2080, Accuracy: 9382/9900 (94.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4260/4717 (90.3116%), train_poison_data_count: 370
Global model norm: 42.595996822618204.
Norm before scaling: 42.593903326484856. Distance: 2.040500878944946
Total norm for 4 adversaries is: 42.593903326484856. distance: 2.040500878944946
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1446, Accuracy: 9526/9900 (96.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 42.595996822618204.
Norm before scaling: 42.604885512476734. Distance: 2.2341423713855204
Total norm for 4 adversaries is: 42.604885512476734. distance: 2.2341423713855204
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1648, Accuracy: 9465/9900 (95.6061%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5282/6124 (86.2508%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5337/6124 (87.1489%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0484, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5085/5902 (86.1572%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5124/5902 (86.8180%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1374, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4156/4707 (88.2940%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4201/4707 (89.2501%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9614, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4049/4647 (87.1315%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4150/4647 (89.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9628, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2941/3297 (89.2023%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3030/3297 (91.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7627, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5578/6263 (89.0627%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5651/6263 (90.2283%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0865, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4137/4663 (88.7197%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4252/4663 (91.1859%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1268, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4300/4956 (86.7635%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4392/4956 (88.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1463, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3602/4046 (89.0262%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3707/4046 (91.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9654, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3666/4184 (87.6195%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3792/4184 (90.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8869, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4858/5591 (86.8896%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4889/5591 (87.4441%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2609, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4060/4634 (87.6133%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4134/4634 (89.2102%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9928, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3352/3828 (87.5653%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3488/3828 (91.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9714, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3135/3638 (86.1737%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3264/3638 (89.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9253, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3374/3781 (89.2357%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3345/3781 (88.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1981, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3395/3837 (88.4806%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3525/3837 (91.8686%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9318, Accuracy: 5597/10000 (55.9700%)
time spent on training: 265.34365487098694
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1585, Accuracy: 6957/10000 (69.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.3170, Accuracy: 90/9900 (0.9091%)
Done in 294.2311067581177 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 42.61931207467748.
Norm before scaling: 42.6239733082914. Distance: 2.123245187883079
Total norm for 4 adversaries is: 42.6239733082914. distance: 2.123245187883079
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.3103, Accuracy: 9172/9900 (92.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 42.61931207467748.
Norm before scaling: 42.62088449248649. Distance: 2.1808406281728847
Total norm for 4 adversaries is: 42.62088449248649. distance: 2.1808406281728847
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1786, Accuracy: 9459/9900 (95.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4201/4717 (89.0608%), train_poison_data_count: 370
Global model norm: 42.61931207467748.
Norm before scaling: 42.62401626659919. Distance: 2.1102928142852417
Total norm for 4 adversaries is: 42.62401626659919. distance: 2.1102928142852417
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1949, Accuracy: 9417/9900 (95.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4496/5066 (88.7485%), train_poison_data_count: 400
Global model norm: 42.61931207467748.
Norm before scaling: 42.62391316658775. Distance: 2.206922680370241
Total norm for 4 adversaries is: 42.62391316658775. distance: 2.206922680370241
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1679, Accuracy: 9477/9900 (95.7273%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3882/4501 (86.2475%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3883/4501 (86.2697%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1114, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3680/4175 (88.1437%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3728/4175 (89.2934%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9047, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3149/3616 (87.0852%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3249/3616 (89.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9248, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4047/4634 (87.3328%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4113/4634 (88.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0397, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4005/4558 (87.8675%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4036/4558 (88.5476%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0613, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4544/5167 (87.9427%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4635/5167 (89.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1391, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3873/4356 (88.9118%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3911/4356 (89.7842%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2320, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4214/4716 (89.3554%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4248/4716 (90.0763%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0213, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5354/6124 (87.4265%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5373/6124 (87.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0303, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4413/5055 (87.2997%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4557/5055 (90.1484%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0295, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4481/5025 (89.1741%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4545/5025 (90.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0293, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4358/4918 (88.6133%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4394/4918 (89.3453%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1071, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3710/4223 (87.8522%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3774/4223 (89.3677%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0055, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3879/4481 (86.5655%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3853/4481 (85.9853%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9947, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3194/3638 (87.7955%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3279/3638 (90.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9302, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3561/4013 (88.7366%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3672/4013 (91.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8982, Accuracy: 5593/10000 (55.9300%)
time spent on training: 264.1697874069214
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1457, Accuracy: 6963/10000 (69.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.4906, Accuracy: 73/9900 (0.7374%)
Done in 293.1892430782318 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 42.64343185384401.
Norm before scaling: 42.64642457811528. Distance: 2.1058325515139775
Total norm for 4 adversaries is: 42.64642457811528. distance: 2.1058325515139775
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2605, Accuracy: 9258/9900 (93.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4769/5305 (89.8963%), train_poison_data_count: 415
Global model norm: 42.64343185384401.
Norm before scaling: 42.6435434943886. Distance: 2.195158060417811
Total norm for 4 adversaries is: 42.6435434943886. distance: 2.195158060417811
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2539, Accuracy: 9294/9900 (93.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 42.64343185384401.
Norm before scaling: 42.645203755174066. Distance: 2.054437658400624
Total norm for 4 adversaries is: 42.645203755174066. distance: 2.054437658400624
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.3314, Accuracy: 9102/9900 (91.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.64343185384401.
Norm before scaling: 42.648889016889996. Distance: 2.2217454703516504
Total norm for 4 adversaries is: 42.648889016889996. distance: 2.2217454703516504
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1725, Accuracy: 9443/9900 (95.3838%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3176/3646 (87.1092%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3306/3646 (90.6747%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8064, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3913/4501 (86.9362%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4015/4501 (89.2024%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1662, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4105/4651 (88.2606%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4192/4651 (90.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9523, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4557/5167 (88.1943%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4645/5167 (89.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0320, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4946/5455 (90.6691%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4937/5455 (90.5041%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0426, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4881/5591 (87.3010%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4882/5591 (87.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0496, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4183/4679 (89.3994%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4174/4679 (89.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1131, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4541/5017 (90.5123%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4590/5017 (91.4889%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8922, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4313/4793 (89.9854%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4343/4793 (90.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0230, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4001/4456 (89.7890%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4091/4456 (91.8088%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9062, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4806/5424 (88.6062%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4952/5424 (91.2979%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2782, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3639/4175 (87.1617%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3696/4175 (88.5269%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9541, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4525/5116 (88.4480%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4569/5116 (89.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0605, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3279/3704 (88.5259%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3343/3704 (90.2538%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9176, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4505/5232 (86.1047%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4619/5232 (88.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1611, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3086/3472 (88.8825%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3163/3472 (91.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0363, Accuracy: 5427/10000 (54.2700%)
time spent on training: 265.8920454978943
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1400, Accuracy: 6957/10000 (69.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.4389, Accuracy: 76/9900 (0.7677%)
Done in 294.74679803848267 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 42.66312616281623.
Norm before scaling: 42.66564971983463. Distance: 2.109870569860559
Total norm for 4 adversaries is: 42.66564971983463. distance: 2.109870569860559
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3451, Accuracy: 9032/9900 (91.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 42.66312616281623.
Norm before scaling: 42.663835749488996. Distance: 2.175133874215115
Total norm for 4 adversaries is: 42.663835749488996. distance: 2.175133874215115
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1748, Accuracy: 9470/9900 (95.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4226/4717 (89.5908%), train_poison_data_count: 370
Global model norm: 42.66312616281623.
Norm before scaling: 42.665058900422984. Distance: 2.066446747410054
Total norm for 4 adversaries is: 42.665058900422984. distance: 2.066446747410054
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1705, Accuracy: 9487/9900 (95.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4516/5066 (89.1433%), train_poison_data_count: 400
Global model norm: 42.66312616281623.
Norm before scaling: 42.67008990224446. Distance: 2.2174424092793164
Total norm for 4 adversaries is: 42.67008990224446. distance: 2.2174424092793164
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2864, Accuracy: 9154/9900 (92.4646%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3213/3590 (89.4986%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3311/3590 (92.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0657, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3906/4368 (89.4231%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3930/4368 (89.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8816, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3270/3704 (88.2829%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3361/3704 (90.7397%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9033, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4351/4928 (88.2914%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4329/4928 (87.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1099, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3849/4356 (88.3609%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3880/4356 (89.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1493, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3449/3911 (88.1872%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3358/3911 (85.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1841, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4104/4651 (88.2391%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4143/4651 (89.0776%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2571, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3717/4184 (88.8384%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3716/4184 (88.8145%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8786, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3899/4346 (89.7147%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4018/4346 (92.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8457, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4307/4793 (89.8602%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4398/4793 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9678, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3386/3804 (89.0116%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3484/3804 (91.5878%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0019, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4437/4986 (88.9892%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4467/4986 (89.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8834, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5327/6124 (86.9856%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5277/6124 (86.1692%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1105, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4123/4707 (87.5929%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4250/4707 (90.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9942, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3782/4235 (89.3034%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3724/4235 (87.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0706, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3623/4046 (89.5452%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3699/4046 (91.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0652, Accuracy: 5348/10000 (53.4800%)
time spent on training: 260.789511680603
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1337, Accuracy: 6991/10000 (69.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.2017, Accuracy: 71/9900 (0.7172%)
Done in 289.3705427646637 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 42.68601153837973.
Norm before scaling: 42.68844223658129. Distance: 2.109094445680027
Total norm for 4 adversaries is: 42.68844223658129. distance: 2.109094445680027
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1008, Accuracy: 9636/9900 (97.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 42.68601153837973.
Norm before scaling: 42.69056397999079. Distance: 2.181219512813837
Total norm for 4 adversaries is: 42.69056397999079. distance: 2.181219512813837
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0849, Accuracy: 9679/9900 (97.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 42.68601153837973.
Norm before scaling: 42.68561546444101. Distance: 2.039880230510576
Total norm for 4 adversaries is: 42.68561546444101. distance: 2.039880230510576
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.4189, Accuracy: 8913/9900 (90.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4480/5066 (88.4327%), train_poison_data_count: 400
Global model norm: 42.68601153837973.
Norm before scaling: 42.693875061575724. Distance: 2.2515990614983465
Total norm for 4 adversaries is: 42.693875061575724. distance: 2.2515990614983465
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2681, Accuracy: 9209/9900 (93.0202%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4371/4986 (87.6655%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4499/4986 (90.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8691, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4018/4634 (86.7069%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4117/4634 (88.8433%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0616, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4256/4716 (90.2460%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4263/4716 (90.3944%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0567, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5277/6124 (86.1692%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5390/6124 (88.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1283, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4380/4918 (89.0606%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4509/4918 (91.6836%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0283, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3372/3797 (88.8070%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3419/3797 (90.0448%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1105, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4967/5582 (88.9824%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5031/5582 (90.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1672, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4296/4956 (86.6828%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4341/4956 (87.5908%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0983, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3979/4433 (89.7586%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4027/4433 (90.8414%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9528, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3840/4354 (88.1948%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0123, Accuracy: 3330/4354 (76.4814%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.6757, Accuracy: 4488/10000 (44.8800%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4297/4928 (87.1956%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4397/4928 (89.2248%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9062, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3456/3911 (88.3661%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3472/3911 (88.7752%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0100, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0085, Accuracy: 3818/4481 (85.2042%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3821/4481 (85.2711%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1457, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4572/5197 (87.9738%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4630/5197 (89.0899%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0327, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4890/5455 (89.6425%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4926/5455 (90.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9286, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3800/4361 (87.1360%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3710/4361 (85.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1509, Accuracy: 5143/10000 (51.4300%)
time spent on training: 270.67386746406555
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1642, Accuracy: 6909/10000 (69.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 8.9714, Accuracy: 88/9900 (0.8889%)
Done in 299.7271592617035 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 42.721440284252324.
Norm before scaling: 42.726240370654395. Distance: 2.0989323717756707
Total norm for 4 adversaries is: 42.726240370654395. distance: 2.0989323717756707
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1497, Accuracy: 9536/9900 (96.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 42.721440284252324.
Norm before scaling: 42.72187888596281. Distance: 2.128516709272641
Total norm for 4 adversaries is: 42.72187888596281. distance: 2.128516709272641
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2632, Accuracy: 9254/9900 (93.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 42.721440284252324.
Norm before scaling: 42.721350277481285. Distance: 2.0398573221538983
Total norm for 4 adversaries is: 42.721350277481285. distance: 2.0398573221538983
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1402, Accuracy: 9530/9900 (96.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4496/5066 (88.7485%), train_poison_data_count: 400
Global model norm: 42.721440284252324.
Norm before scaling: 42.72815454041618. Distance: 2.2634728042185555
Total norm for 4 adversaries is: 42.72815454041618. distance: 2.2634728042185555
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2470, Accuracy: 9292/9900 (93.8586%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4327/4928 (87.8044%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4403/4928 (89.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9509, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3737/4184 (89.3164%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3777/4184 (90.2725%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8400, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4208/4707 (89.3988%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4234/4707 (89.9511%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0771, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3390/3828 (88.5580%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3519/3828 (91.9279%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8694, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3952/4503 (87.7637%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4034/4503 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9642, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4149/4662 (88.9961%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4213/4662 (90.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9160, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3714/4235 (87.6978%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3850/4235 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0507, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4414/5244 (84.1724%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4493/5244 (85.6789%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0413, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4273/4793 (89.1508%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4401/4793 (91.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9090, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3905/4481 (87.1457%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3869/4481 (86.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0947, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3905/4346 (89.8527%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3997/4346 (91.9696%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7784, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3921/4361 (89.9106%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3812/4361 (87.4111%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1691, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4516/5055 (89.3373%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4539/5055 (89.7923%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0721, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4558/5195 (87.7382%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4528/5195 (87.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1215, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3898/4315 (90.3360%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3997/4315 (92.6304%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9275, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4167/4663 (89.3631%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4271/4663 (91.5934%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9973, Accuracy: 5410/10000 (54.1000%)
time spent on training: 263.6800980567932
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1542, Accuracy: 6946/10000 (69.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.1913, Accuracy: 62/9900 (0.6263%)
Done in 292.6123077869415 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4392/4885 (89.9079%), train_poison_data_count: 385
Global model norm: 42.748836389957006.
Norm before scaling: 42.75355488235014. Distance: 2.0851166785363238
Total norm for 4 adversaries is: 42.75355488235014. distance: 2.0851166785363238
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2481, Accuracy: 9291/9900 (93.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 42.748836389957006.
Norm before scaling: 42.752415638987586. Distance: 2.1696594793814366
Total norm for 4 adversaries is: 42.752415638987586. distance: 2.1696594793814366
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3715, Accuracy: 9040/9900 (91.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4232/4717 (89.7180%), train_poison_data_count: 370
Global model norm: 42.748836389957006.
Norm before scaling: 42.74816390885257. Distance: 2.019164061230427
Total norm for 4 adversaries is: 42.74816390885257. distance: 2.019164061230427
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2139, Accuracy: 9364/9900 (94.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4541/5066 (89.6368%), train_poison_data_count: 400
Global model norm: 42.748836389957006.
Norm before scaling: 42.75290246223422. Distance: 2.185015002620354
Total norm for 4 adversaries is: 42.75290246223422. distance: 2.185015002620354
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2246, Accuracy: 9308/9900 (94.0202%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3912/4315 (90.6605%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3907/4315 (90.5446%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9573, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3242/3590 (90.3064%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3188/3590 (88.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2785, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4174/4679 (89.2071%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4123/4679 (88.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0945, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4617/5167 (89.3555%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4636/5167 (89.7232%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0980, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3360/3775 (89.0066%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3522/3775 (93.2980%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7699, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3386/3828 (88.4535%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3484/3828 (91.0136%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8507, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3759/4235 (88.7603%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3840/4235 (90.6730%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9607, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4098/4647 (88.1859%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4219/4647 (90.7898%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8535, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4346/4918 (88.3693%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4429/4918 (90.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0820, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3974/4433 (89.6458%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4001/4433 (90.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9525, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3885/4481 (86.6994%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3855/4481 (86.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2124, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3790/4295 (88.2421%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3721/4295 (86.6356%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0735, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3988/4503 (88.5632%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4034/4503 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9168, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3806/4354 (87.4139%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3624/4354 (83.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3433, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4433/4986 (88.9089%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4448/4986 (89.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0726, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5575/6263 (89.0148%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5732/6263 (91.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1709, Accuracy: 5175/10000 (51.7500%)
time spent on training: 261.7917983531952
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1489, Accuracy: 6938/10000 (69.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.0938, Accuracy: 82/9900 (0.8283%)
Done in 294.149968624115 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 42.785847942744894.
Norm before scaling: 42.788449848407545. Distance: 2.1165040662092465
Total norm for 4 adversaries is: 42.788449848407545. distance: 2.1165040662092465
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1902, Accuracy: 9430/9900 (95.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 42.785847942744894.
Norm before scaling: 42.79021003915864. Distance: 2.256582486072462
Total norm for 4 adversaries is: 42.79021003915864. distance: 2.256582486072462
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0787, Accuracy: 9699/9900 (97.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 42.785847942744894.
Norm before scaling: 42.78700911975576. Distance: 2.0359511918773463
Total norm for 4 adversaries is: 42.78700911975576. distance: 2.0359511918773463
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1383, Accuracy: 9549/9900 (96.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 42.785847942744894.
Norm before scaling: 42.79013586726575. Distance: 2.2155188014481646
Total norm for 4 adversaries is: 42.79013586726575. distance: 2.2155188014481646
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0753, Accuracy: 9705/9900 (98.0303%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3719/4223 (88.0654%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3858/4223 (91.3569%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9398, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4951/5455 (90.7608%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4896/5455 (89.7525%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0740, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5058/5582 (90.6127%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5054/5582 (90.5410%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2062, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4008/4465 (89.7648%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4040/4465 (90.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8611, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4902/5591 (87.6766%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4944/5591 (88.4278%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1773, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3464/3911 (88.5707%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3354/3911 (85.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9658, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3869/4356 (88.8200%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0114, Accuracy: 3486/4356 (80.0275%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.4316, Accuracy: 4732/10000 (47.3200%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4446/5037 (88.2668%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4495/5037 (89.2396%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0099, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4187/4679 (89.4849%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4284/4679 (91.5580%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1097, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3943/4362 (90.3943%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3930/4362 (90.0963%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1135, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4056/4518 (89.7742%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4146/4518 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0209, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4460/5083 (87.7435%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4480/5083 (88.1369%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2113, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3618/4013 (90.1570%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3722/4013 (92.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8670, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4587/5197 (88.2625%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4612/5197 (88.7435%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3126, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2948/3297 (89.4146%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3048/3297 (92.4477%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8242, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3997/4441 (90.0023%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4043/4441 (91.0381%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1123, Accuracy: 5356/10000 (53.5600%)
time spent on training: 271.1632046699524
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1451, Accuracy: 6950/10000 (69.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.0082, Accuracy: 83/9900 (0.8384%)
Done in 300.09998059272766 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 42.81340099416887.
Norm before scaling: 42.813811567501205. Distance: 2.0930024136138865
Total norm for 4 adversaries is: 42.813811567501205. distance: 2.0930024136138865
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2390, Accuracy: 9325/9900 (94.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4770/5305 (89.9152%), train_poison_data_count: 415
Global model norm: 42.81340099416887.
Norm before scaling: 42.813693242951636. Distance: 2.1607110137194074
Total norm for 4 adversaries is: 42.813693242951636. distance: 2.1607110137194074
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2385, Accuracy: 9342/9900 (94.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 42.81340099416887.
Norm before scaling: 42.81329835022058. Distance: 2.020483740492178
Total norm for 4 adversaries is: 42.81329835022058. distance: 2.020483740492178
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3906, Accuracy: 8933/9900 (90.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4527/5066 (89.3604%), train_poison_data_count: 400
Global model norm: 42.81340099416887.
Norm before scaling: 42.81572039667133. Distance: 2.2092963823847867
Total norm for 4 adversaries is: 42.81572039667133. distance: 2.2092963823847867
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2375, Accuracy: 9287/9900 (93.8081%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3981/4501 (88.4470%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4047/4501 (89.9134%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0491, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3989/4511 (88.4283%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4111/4511 (91.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8746, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3817/4354 (87.6665%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3590/4354 (82.4529%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2753, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3909/4346 (89.9448%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3996/4346 (91.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8860, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4173/4707 (88.6552%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4237/4707 (90.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9710, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4881/5591 (87.3010%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4883/5591 (87.3368%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0768, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4076/4647 (87.7125%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4180/4647 (89.9505%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8161, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4067/4538 (89.6210%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4156/4538 (91.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9315, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4366/4934 (88.4880%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4373/4934 (88.6299%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0424, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4283/4804 (89.1549%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4129/4804 (85.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1677, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5748/6263 (91.7771%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5712/6263 (91.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1977, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3909/4481 (87.2350%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3941/4481 (87.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1665, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4398/5063 (86.8655%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4387/5063 (86.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9599, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3719/4223 (88.0654%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3866/4223 (91.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9540, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4101/4441 (92.3441%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4192/4441 (94.3932%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9829, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3368/3756 (89.6699%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3487/3756 (92.8381%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8831, Accuracy: 5653/10000 (56.5300%)
time spent on training: 266.1673324108124
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1468, Accuracy: 6968/10000 (69.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 9.0790, Accuracy: 102/9900 (1.0303%)
Done in 295.02533316612244 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4430/4885 (90.6858%), train_poison_data_count: 385
Global model norm: 42.834747014051715.
Norm before scaling: 42.83768362869163. Distance: 2.1021103836098547
Total norm for 4 adversaries is: 42.83768362869163. distance: 2.1021103836098547
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1615, Accuracy: 9493/9900 (95.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 42.834747014051715.
Norm before scaling: 42.83233459337408. Distance: 2.1883818892326214
Total norm for 4 adversaries is: 42.83233459337408. distance: 2.1883818892326214
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0658, Accuracy: 9714/9900 (98.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 42.834747014051715.
Norm before scaling: 42.83669053117972. Distance: 2.0371657863863573
Total norm for 4 adversaries is: 42.83669053117972. distance: 2.0371657863863573
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3045, Accuracy: 9151/9900 (92.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 42.834747014051715.
Norm before scaling: 42.83790874659091. Distance: 2.1588343737116324
Total norm for 4 adversaries is: 42.83790874659091. distance: 2.1588343737116324
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3738, Accuracy: 8965/9900 (90.5556%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4426/5244 (84.4012%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4571/5244 (87.1663%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9595, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4366/4928 (88.5958%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4418/4928 (89.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8952, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3367/3804 (88.5121%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3423/3804 (89.9842%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9839, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3663/4013 (91.2783%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3728/4013 (92.8981%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8165, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3571/4158 (85.8826%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3614/4158 (86.9168%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0251, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5026/5582 (90.0394%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4948/5582 (88.6421%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1740, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4887/5455 (89.5875%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4895/5455 (89.7342%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0088, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3843/4354 (88.2637%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3561/4354 (81.7869%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.5719, Accuracy: 4635/10000 (46.3500%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3968/4433 (89.5105%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4018/4433 (90.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9323, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3194/3646 (87.6029%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3327/3646 (91.2507%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8870, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4036/4518 (89.3316%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4122/4518 (91.2351%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1040, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3786/4235 (89.3979%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3751/4235 (88.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1802, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3954/4362 (90.6465%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3896/4362 (89.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0660, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4812/5392 (89.2433%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4702/5392 (87.2033%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1604, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4876/5591 (87.2116%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4877/5591 (87.2295%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2645, Accuracy: 4974/10000 (49.7400%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3464/3756 (92.2258%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3499/3756 (93.1576%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9131, Accuracy: 5647/10000 (56.4700%)
time spent on training: 263.2637174129486
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1608, Accuracy: 6924/10000 (69.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 8.9764, Accuracy: 123/9900 (1.2424%)
Done in 292.38039922714233 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 42.85491597520858.
Norm before scaling: 42.859530224381686. Distance: 2.1202710208757116
Total norm for 4 adversaries is: 42.859530224381686. distance: 2.1202710208757116
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1217, Accuracy: 9565/9900 (96.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4785/5305 (90.1979%), train_poison_data_count: 415
Global model norm: 42.85491597520858.
Norm before scaling: 42.855279151720325. Distance: 2.212593240443496
Total norm for 4 adversaries is: 42.855279151720325. distance: 2.212593240443496
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0184, Accuracy: 9841/9900 (99.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 42.85491597520858.
Norm before scaling: 42.85738409065292. Distance: 2.043014846777686
Total norm for 4 adversaries is: 42.85738409065292. distance: 2.043014846777686
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1428, Accuracy: 9548/9900 (96.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 42.85491597520858.
Norm before scaling: 42.860971363362. Distance: 2.28027249648669
Total norm for 4 adversaries is: 42.860971363362. distance: 2.28027249648669
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1199, Accuracy: 9589/9900 (96.8586%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4125/4634 (89.0160%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4178/4634 (90.1597%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9433, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4024/4503 (89.3626%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3982/4503 (88.4299%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9613, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4321/4928 (87.6826%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4434/4928 (89.9756%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7955, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3336/3804 (87.6972%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3433/3804 (90.2471%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0093, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3240/3590 (90.2507%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3080/3590 (85.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.3538, Accuracy: 4923/10000 (49.2300%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4103/4647 (88.2935%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4227/4647 (90.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9167, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4007/4625 (86.6378%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4078/4625 (88.1730%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1410, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3863/4356 (88.6823%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3878/4356 (89.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1390, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3390/3797 (89.2810%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3472/3797 (91.4406%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9252, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3992/4456 (89.5871%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4107/4456 (92.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9751, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3583/4025 (89.0186%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3687/4025 (91.6025%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8355, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3216/3472 (92.6267%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3196/3472 (92.0507%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9514, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2923/3297 (88.6564%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3023/3297 (91.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9081, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3860/4416 (87.4094%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3981/4416 (90.1495%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9211, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3897/4356 (89.4628%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3998/4356 (91.7815%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9944, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3154/3638 (86.6960%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3305/3638 (90.8466%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8237, Accuracy: 5624/10000 (56.2400%)
time spent on training: 256.5066452026367
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1483, Accuracy: 6936/10000 (69.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 8.9715, Accuracy: 115/9900 (1.1616%)
Done in 285.0305850505829 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4380/4885 (89.6622%), train_poison_data_count: 385
Global model norm: 42.87633243191983.
Norm before scaling: 42.88219549451366. Distance: 2.1807126058188517
Total norm for 4 adversaries is: 42.88219549451366. distance: 2.1807126058188517
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2106, Accuracy: 9390/9900 (94.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 42.87633243191983.
Norm before scaling: 42.879367261175275. Distance: 2.188322076277047
Total norm for 4 adversaries is: 42.879367261175275. distance: 2.188322076277047
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2012, Accuracy: 9401/9900 (94.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 42.87633243191983.
Norm before scaling: 42.8726496371995. Distance: 2.0103636686886532
Total norm for 4 adversaries is: 42.8726496371995. distance: 2.0103636686886532
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1882, Accuracy: 9416/9900 (95.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 42.87633243191983.
Norm before scaling: 42.88224958070137. Distance: 2.204730051172084
Total norm for 4 adversaries is: 42.88224958070137. distance: 2.204730051172084
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1339, Accuracy: 9557/9900 (96.5354%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3691/4175 (88.4072%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3764/4175 (90.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9206, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4280/4956 (86.3600%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4389/4956 (88.5593%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0876, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4440/5037 (88.1477%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4591/5037 (91.1455%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9303, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4296/4793 (89.6307%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4369/4793 (91.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0035, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3339/3804 (87.7760%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3399/3804 (89.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0727, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4790/5392 (88.8353%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4821/5392 (89.4102%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0029, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4018/4465 (89.9888%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4073/4465 (91.2206%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9286, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4121/4596 (89.6649%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4204/4596 (91.4708%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9139, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5299/6124 (86.5284%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5361/6124 (87.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0537, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2899/3271 (88.6273%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2960/3271 (90.4922%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9737, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3231/3590 (90.0000%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3218/3590 (89.6379%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1869, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3928/4501 (87.2695%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3996/4501 (88.7803%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0831, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4604/5232 (87.9969%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4586/5232 (87.6529%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0637, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3252/3672 (88.5621%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3293/3672 (89.6786%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0163, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3768/4223 (89.2257%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3822/4223 (90.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0478, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3842/4354 (88.2407%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0136, Accuracy: 3247/4354 (74.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.6278, Accuracy: 4402/10000 (44.0200%)
time spent on training: 263.23093938827515
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.2195, Accuracy: 6822/10000 (68.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 8.0185, Accuracy: 364/9900 (3.6768%)
Done in 292.24516892433167 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 42.92570713462753.
Norm before scaling: 42.92740482443514. Distance: 2.060310357426982
Total norm for 4 adversaries is: 42.92740482443514. distance: 2.060310357426982
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2162, Accuracy: 9389/9900 (94.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 42.92570713462753.
Norm before scaling: 42.92407763050579. Distance: 2.149025132704616
Total norm for 4 adversaries is: 42.92407763050579. distance: 2.149025132704616
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1260, Accuracy: 9560/9900 (96.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4211/4717 (89.2728%), train_poison_data_count: 370
Global model norm: 42.92570713462753.
Norm before scaling: 42.93009198512813. Distance: 2.145355677604288
Total norm for 4 adversaries is: 42.93009198512813. distance: 2.145355677604288
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0669, Accuracy: 9726/9900 (98.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4526/5066 (89.3407%), train_poison_data_count: 400
Global model norm: 42.92570713462753.
Norm before scaling: 42.93245341976888. Distance: 2.2111749420452043
Total norm for 4 adversaries is: 42.93245341976888. distance: 2.2111749420452043
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1209, Accuracy: 9614/9900 (97.1111%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5016/5582 (89.8603%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5030/5582 (90.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0048, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4048/4647 (87.1100%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4197/4647 (90.3163%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0149, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3996/4465 (89.4961%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4111/4465 (92.0717%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0206, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4459/5083 (87.7238%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4521/5083 (88.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0870, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3804/4416 (86.1413%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3974/4416 (89.9909%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9036, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4301/4956 (86.7837%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4331/4956 (87.3890%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1485, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3965/4362 (90.8987%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3924/4362 (89.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9220, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3857/4356 (88.5445%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3802/4356 (87.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1950, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3355/3781 (88.7331%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3466/3781 (91.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0695, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3205/3590 (89.2758%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3243/3590 (90.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0276, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4109/4651 (88.3466%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4182/4651 (89.9161%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1305, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4149/4662 (88.9961%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4239/4662 (90.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9809, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3164/3472 (91.1290%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3254/3472 (93.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8490, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4824/5424 (88.9381%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4951/5424 (91.2795%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1072, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2907/3271 (88.8719%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0068, Accuracy: 2831/3271 (86.5485%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0067, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4433/5037 (88.0087%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4515/5037 (89.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8461, Accuracy: 5660/10000 (56.6000%)
time spent on training: 263.08862709999084
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.2133, Accuracy: 6839/10000 (68.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 8.3555, Accuracy: 253/9900 (2.5556%)
Done in 291.75355100631714 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 42.956363271438754.
Norm before scaling: 42.958299865610954. Distance: 2.098608614150567
Total norm for 4 adversaries is: 42.958299865610954. distance: 2.098608614150567
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2068, Accuracy: 9356/9900 (94.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.956363271438754.
Norm before scaling: 42.95945211902949. Distance: 2.199889925890647
Total norm for 4 adversaries is: 42.95945211902949. distance: 2.199889925890647
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1640, Accuracy: 9478/9900 (95.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 42.956363271438754.
Norm before scaling: 42.9513800118445. Distance: 1.9690684711878543
Total norm for 4 adversaries is: 42.9513800118445. distance: 1.9690684711878543
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3064, Accuracy: 9153/9900 (92.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4501/5066 (88.8472%), train_poison_data_count: 400
Global model norm: 42.956363271438754.
Norm before scaling: 42.96237310635537. Distance: 2.2086045320596495
Total norm for 4 adversaries is: 42.96237310635537. distance: 2.2086045320596495
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.5360, Accuracy: 8595/9900 (86.8182%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4329/4989 (86.7709%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4421/4989 (88.6150%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0879, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3670/4013 (91.4528%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3775/4013 (94.0693%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7874, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4580/5195 (88.1617%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4447/5195 (85.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2111, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3543/3969 (89.2668%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3565/3969 (89.8211%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9357, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3900/4356 (89.5317%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3797/4356 (87.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1811, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4060/4441 (91.4209%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4102/4441 (92.3666%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0625, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4025/4518 (89.0881%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4128/4518 (91.3679%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0391, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3475/3911 (88.8520%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3285/3911 (83.9939%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1561, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3941/4362 (90.3485%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3851/4362 (88.2852%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1298, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3387/3804 (89.0379%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3467/3804 (91.1409%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9478, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3750/4223 (88.7994%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3896/4223 (92.2567%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8590, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4125/4634 (89.0160%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4186/4634 (90.3323%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8437, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3939/4354 (90.4685%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0126, Accuracy: 3356/4354 (77.0785%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.4688, Accuracy: 4649/10000 (46.4900%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4438/5244 (84.6301%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4559/5244 (86.9375%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8990, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4541/5037 (90.1529%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4642/5037 (92.1580%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0161, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3223/3704 (87.0140%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3354/3704 (90.5508%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0130, Accuracy: 5412/10000 (54.1200%)
time spent on training: 260.6709887981415
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.2007, Accuracy: 6871/10000 (68.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 8.4834, Accuracy: 222/9900 (2.2424%)
Done in 289.7682771682739 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 42.98047851296126.
Norm before scaling: 42.984656146845005. Distance: 2.1065720761869056
Total norm for 4 adversaries is: 42.984656146845005. distance: 2.1065720761869056
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1509, Accuracy: 9543/9900 (96.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4753/5305 (89.5947%), train_poison_data_count: 415
Global model norm: 42.98047851296126.
Norm before scaling: 42.985255352671516. Distance: 2.221274860094841
Total norm for 4 adversaries is: 42.985255352671516. distance: 2.221274860094841
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0878, Accuracy: 9673/9900 (97.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 42.98047851296126.
Norm before scaling: 42.978581261665965. Distance: 1.9896550257150483
Total norm for 4 adversaries is: 42.978581261665965. distance: 1.9896550257150483
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1411, Accuracy: 9507/9900 (96.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4554/5066 (89.8934%), train_poison_data_count: 400
Global model norm: 42.98047851296126.
Norm before scaling: 42.98370904382337. Distance: 2.162738932380936
Total norm for 4 adversaries is: 42.98370904382337. distance: 2.162738932380936
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2876, Accuracy: 9215/9900 (93.0808%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3876/4416 (87.7717%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3956/4416 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9969, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4579/5197 (88.1085%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4581/5197 (88.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0495, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4342/4918 (88.2879%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4446/4918 (90.4026%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0681, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5689/6263 (90.8351%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5706/6263 (91.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0760, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3210/3646 (88.0417%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3321/3646 (91.0861%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8551, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4216/4707 (89.5687%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4262/4707 (90.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9505, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4404/5063 (86.9840%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4304/5063 (85.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2463, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3777/4295 (87.9395%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3905/4295 (90.9197%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8986, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4326/4793 (90.2566%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4351/4793 (90.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9604, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4063/4538 (89.5328%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4174/4538 (91.9788%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9011, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4446/5083 (87.4680%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4500/5083 (88.5304%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0211, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3294/3638 (90.5443%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3320/3638 (91.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7589, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5352/6124 (87.3939%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5437/6124 (88.7818%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0079, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4125/4618 (89.3244%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4085/4618 (88.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9938, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3553/3969 (89.5188%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3580/3969 (90.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8910, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3556/4158 (85.5219%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3628/4158 (87.2535%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0734, Accuracy: 5213/10000 (52.1300%)
time spent on training: 267.8184902667999
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.2031, Accuracy: 6879/10000 (68.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 8.5423, Accuracy: 222/9900 (2.2424%)
Done in 296.8322026729584 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 43.012757294075705.
Norm before scaling: 43.0176937161472. Distance: 2.076296123472322
Total norm for 4 adversaries is: 43.0176937161472. distance: 2.076296123472322
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3182, Accuracy: 9153/9900 (92.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4748/5305 (89.5005%), train_poison_data_count: 415
Global model norm: 43.012757294075705.
Norm before scaling: 43.01836056503229. Distance: 2.2375382659879257
Total norm for 4 adversaries is: 43.01836056503229. distance: 2.2375382659879257
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2581, Accuracy: 9231/9900 (93.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 43.012757294075705.
Norm before scaling: 43.01077064645044. Distance: 2.014143761770399
Total norm for 4 adversaries is: 43.01077064645044. distance: 2.014143761770399
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2879, Accuracy: 9143/9900 (92.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 43.012757294075705.
Norm before scaling: 43.0183818472733. Distance: 2.24903615864292
Total norm for 4 adversaries is: 43.0183818472733. distance: 2.24903615864292
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3026, Accuracy: 9136/9900 (92.2828%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4239/4716 (89.8855%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4281/4716 (90.7761%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0446, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3884/4481 (86.6771%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3920/4481 (87.4805%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0821, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3908/4361 (89.6125%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3832/4361 (87.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0267, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4298/4793 (89.6724%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4410/4793 (92.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0188, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3842/4295 (89.4529%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3682/4295 (85.7276%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1513, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4488/5244 (85.5835%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4540/5244 (86.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8928, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4395/4989 (88.0938%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4427/4989 (88.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9523, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4575/5197 (88.0316%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4589/5197 (88.3009%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3593, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3894/4356 (89.3939%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3672/4356 (84.2975%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.4222, Accuracy: 4731/10000 (47.3100%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4092/4647 (88.0568%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4177/4647 (89.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8749, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3688/4013 (91.9013%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3759/4013 (93.6706%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7355, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4099/4538 (90.3261%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4155/4538 (91.5602%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8144, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4202/4707 (89.2713%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4279/4707 (90.9072%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9418, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5666/6263 (90.4678%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5732/6263 (91.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2403, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3806/4235 (89.8701%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3764/4235 (88.8784%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0207, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3427/3861 (88.7594%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3478/3861 (90.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1391, Accuracy: 5261/10000 (52.6100%)
time spent on training: 266.8918070793152
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.2114, Accuracy: 6838/10000 (68.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 8.4411, Accuracy: 235/9900 (2.3737%)
Done in 295.8786735534668 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 43.03938937863707.
Norm before scaling: 43.042713331044055. Distance: 2.1256857494813515
Total norm for 4 adversaries is: 43.042713331044055. distance: 2.1256857494813515
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1347, Accuracy: 9568/9900 (96.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 43.03938937863707.
Norm before scaling: 43.04136052473612. Distance: 2.1753600995358418
Total norm for 4 adversaries is: 43.04136052473612. distance: 2.1753600995358418
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2028, Accuracy: 9420/9900 (95.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4262/4717 (90.3540%), train_poison_data_count: 370
Global model norm: 43.03938937863707.
Norm before scaling: 43.03837824492374. Distance: 2.0145447667824623
Total norm for 4 adversaries is: 43.03837824492374. distance: 2.0145447667824623
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1612, Accuracy: 9488/9900 (95.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4530/5066 (89.4197%), train_poison_data_count: 400
Global model norm: 43.03938937863707.
Norm before scaling: 43.04539471139015. Distance: 2.238737529163994
Total norm for 4 adversaries is: 43.04539471139015. distance: 2.238737529163994
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1375, Accuracy: 9563/9900 (96.5960%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4524/5055 (89.4955%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4558/5055 (90.1682%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9216, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3392/3828 (88.6102%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3524/3828 (92.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0029, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3905/4361 (89.5437%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3968/4361 (90.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0016, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3643/4013 (90.7800%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3750/4013 (93.4463%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8553, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4037/4518 (89.3537%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4141/4518 (91.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8591, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4045/4558 (88.7451%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4040/4558 (88.6354%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1510, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3671/4126 (88.9724%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3793/4126 (91.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9190, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4201/4679 (89.7841%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3887/4679 (83.0733%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1767, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3818/4235 (90.1535%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3763/4235 (88.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9848, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4501/5037 (89.3587%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4655/5037 (92.4161%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8650, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3258/3672 (88.7255%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3360/3672 (91.5033%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8133, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4352/4928 (88.3117%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4414/4928 (89.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8994, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3902/4356 (89.5776%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3789/4356 (86.9835%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0806, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4042/4456 (90.7092%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4117/4456 (92.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9833, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4305/4793 (89.8185%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4418/4793 (92.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9421, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4497/5025 (89.4925%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4514/5025 (89.8308%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9435, Accuracy: 5532/10000 (55.3200%)
time spent on training: 262.4303545951843
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1922, Accuracy: 6913/10000 (69.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 8.8151, Accuracy: 171/9900 (1.7273%)
Done in 291.22813606262207 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4420/4885 (90.4811%), train_poison_data_count: 385
Global model norm: 43.06882522259793.
Norm before scaling: 43.07477685800807. Distance: 2.1150656339593366
Total norm for 4 adversaries is: 43.07477685800807. distance: 2.1150656339593366
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1639, Accuracy: 9479/9900 (95.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4808/5305 (90.6315%), train_poison_data_count: 415
Global model norm: 43.06882522259793.
Norm before scaling: 43.071874829953565. Distance: 2.1838593841740295
Total norm for 4 adversaries is: 43.071874829953565. distance: 2.1838593841740295
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1204, Accuracy: 9581/9900 (96.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 43.06882522259793.
Norm before scaling: 43.06799617955164. Distance: 1.9882345437670181
Total norm for 4 adversaries is: 43.06799617955164. distance: 1.9882345437670181
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2205, Accuracy: 9335/9900 (94.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4492/5066 (88.6696%), train_poison_data_count: 400
Global model norm: 43.06882522259793.
Norm before scaling: 43.07540031508341. Distance: 2.221173212358851
Total norm for 4 adversaries is: 43.07540031508341. distance: 2.221173212358851
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2623, Accuracy: 9239/9900 (93.3232%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3918/4346 (90.1519%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4052/4346 (93.2352%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8778, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3746/4184 (89.5315%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3798/4184 (90.7744%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0548, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3852/4356 (88.4298%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0103, Accuracy: 3521/4356 (80.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2649, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3261/3646 (89.4405%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3331/3646 (91.3604%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7629, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4518/5083 (88.8845%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4518/5083 (88.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0223, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3881/4356 (89.0955%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3870/4356 (88.8430%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3158, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4024/4558 (88.2843%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4099/4558 (89.9298%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1161, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3693/4175 (88.4551%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3704/4175 (88.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8914, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3178/3472 (91.5323%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3209/3472 (92.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0190, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4007/4501 (89.0247%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4033/4501 (89.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9898, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4862/5424 (89.6386%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4944/5424 (91.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2082, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3929/4481 (87.6813%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3963/4481 (88.4401%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0345, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4919/5455 (90.1742%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4942/5455 (90.5958%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3293, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4607/5232 (88.0543%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4640/5232 (88.6850%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0720, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5484/6391 (85.8082%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5500/6391 (86.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1632, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3428/3775 (90.8079%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3554/3775 (94.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9711, Accuracy: 5542/10000 (55.4200%)
time spent on training: 264.466183423996
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1953, Accuracy: 6893/10000 (68.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 8.6606, Accuracy: 189/9900 (1.9091%)
Done in 293.66181445121765 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4419/4885 (90.4606%), train_poison_data_count: 385
Global model norm: 43.087592754922646.
Norm before scaling: 43.08773440835933. Distance: 2.1198025140008343
Total norm for 4 adversaries is: 43.08773440835933. distance: 2.1198025140008343
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1541, Accuracy: 9491/9900 (95.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4816/5305 (90.7823%), train_poison_data_count: 415
Global model norm: 43.087592754922646.
Norm before scaling: 43.08326360129955. Distance: 2.11314800639182
Total norm for 4 adversaries is: 43.08326360129955. distance: 2.11314800639182
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0956, Accuracy: 9644/9900 (97.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4272/4717 (90.5660%), train_poison_data_count: 370
Global model norm: 43.087592754922646.
Norm before scaling: 43.084350180416436. Distance: 1.997976769851647
Total norm for 4 adversaries is: 43.084350180416436. distance: 1.997976769851647
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1043, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 43.087592754922646.
Norm before scaling: 43.09363244409274. Distance: 2.2354668570433356
Total norm for 4 adversaries is: 43.09363244409274. distance: 2.2354668570433356
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1683, Accuracy: 9443/9900 (95.3838%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3645/4025 (90.5590%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3704/4025 (92.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8616, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3790/4223 (89.7466%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3839/4223 (90.9069%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9277, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3276/3638 (90.0495%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3407/3638 (93.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8309, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4430/5063 (87.4975%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4242/5063 (83.7843%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1489, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4344/4874 (89.1260%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4181/4874 (85.7817%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2326, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4311/4804 (89.7377%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4286/4804 (89.2173%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1525, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3747/4158 (90.1154%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3733/4158 (89.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9194, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4046/4518 (89.5529%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4132/4518 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9322, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3793/4235 (89.5632%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3753/4235 (88.6187%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1348, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4316/4934 (87.4747%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4158/4934 (84.2724%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2672, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5513/6391 (86.2619%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5597/6391 (87.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1778, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3814/4295 (88.8009%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3826/4295 (89.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1155, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3528/3756 (93.9297%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3612/3756 (96.1661%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7545, Accuracy: 5917/10000 (59.1700%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3954/4481 (88.2392%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3896/4481 (86.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0236, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3656/4175 (87.5689%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3705/4175 (88.7425%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0347, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3255/3590 (90.6685%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3211/3590 (89.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9616, Accuracy: 5541/10000 (55.4100%)
time spent on training: 262.81371808052063
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.2550, Accuracy: 6793/10000 (67.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 8.4371, Accuracy: 227/9900 (2.2929%)
Done in 291.8525025844574 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4433/4885 (90.7472%), train_poison_data_count: 385
Global model norm: 43.111868188596716.
Norm before scaling: 43.11463162269785. Distance: 2.1173535946942352
Total norm for 4 adversaries is: 43.11463162269785. distance: 2.1173535946942352
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2246, Accuracy: 9335/9900 (94.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 43.111868188596716.
Norm before scaling: 43.11212443660716. Distance: 2.0989071545541793
Total norm for 4 adversaries is: 43.11212443660716. distance: 2.0989071545541793
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2876, Accuracy: 9208/9900 (93.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 43.111868188596716.
Norm before scaling: 43.11599911729766. Distance: 2.059586519021111
Total norm for 4 adversaries is: 43.11599911729766. distance: 2.059586519021111
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1325, Accuracy: 9577/9900 (96.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4520/5066 (89.2223%), train_poison_data_count: 400
Global model norm: 43.111868188596716.
Norm before scaling: 43.11785068682764. Distance: 2.217985854396997
Total norm for 4 adversaries is: 43.11785068682764. distance: 2.217985854396997
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2045, Accuracy: 9369/9900 (94.6364%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3446/3828 (90.0209%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3524/3828 (92.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8243, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3493/3911 (89.3122%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3362/3911 (85.9627%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1982, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3996/4362 (91.6094%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3955/4362 (90.6694%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9757, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4706/5197 (90.5522%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4558/5197 (87.7044%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1734, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4206/4679 (89.8910%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4147/4679 (88.6300%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3570, Accuracy: 4921/10000 (49.2100%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4273/4793 (89.1508%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4335/4793 (90.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9552, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4564/5116 (89.2103%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4588/5116 (89.6794%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1556, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4001/4625 (86.5081%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4053/4625 (87.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0248, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4155/4618 (89.9740%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4042/4618 (87.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2093, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2893/3271 (88.4439%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2908/3271 (88.9025%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0483, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3726/4175 (89.2455%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3734/4175 (89.4371%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9094, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3145/3616 (86.9746%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3308/3616 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8753, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3882/4481 (86.6324%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3911/4481 (87.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0894, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3948/4368 (90.3846%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3937/4368 (90.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8638, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4995/5740 (87.0209%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5138/5740 (89.5122%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0889, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4087/4647 (87.9492%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4165/4647 (89.6277%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0147, Accuracy: 5453/10000 (54.5300%)
time spent on training: 261.1592764854431
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.2140, Accuracy: 6851/10000 (68.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 8.5517, Accuracy: 214/9900 (2.1616%)
Done in 289.7704644203186 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4471/4885 (91.5251%), train_poison_data_count: 385
Global model norm: 43.143689337926354.
Norm before scaling: 43.143208338987144. Distance: 2.0300908229035124
Total norm for 4 adversaries is: 43.143208338987144. distance: 2.0300908229035124
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2595, Accuracy: 9240/9900 (93.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 43.143689337926354.
Norm before scaling: 43.13804716582857. Distance: 2.118459059282986
Total norm for 4 adversaries is: 43.13804716582857. distance: 2.118459059282986
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1800, Accuracy: 9454/9900 (95.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 43.143689337926354.
Norm before scaling: 43.14325785383143. Distance: 2.0445774374887793
Total norm for 4 adversaries is: 43.14325785383143. distance: 2.0445774374887793
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1519, Accuracy: 9498/9900 (95.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 43.143689337926354.
Norm before scaling: 43.14979614351107. Distance: 2.1827038092780398
Total norm for 4 adversaries is: 43.14979614351107. distance: 2.1827038092780398
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1764, Accuracy: 9440/9900 (95.3535%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4944/5591 (88.4278%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4963/5591 (88.7677%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2716, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4339/4956 (87.5504%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4356/4956 (87.8935%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9829, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3958/4511 (87.7411%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4091/4511 (90.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9803, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3669/4013 (91.4279%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3748/4013 (93.3965%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.7757, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3348/3590 (93.2591%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3386/3590 (94.3175%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8635, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4294/4793 (89.5890%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4382/4793 (91.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9507, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3387/3804 (89.0379%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3459/3804 (90.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9831, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3504/3837 (91.3213%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3556/3837 (92.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8939, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3934/4361 (90.2087%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3861/4361 (88.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2129, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4416/5063 (87.2210%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4240/5063 (83.7448%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.4063, Accuracy: 4772/10000 (47.7200%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3895/4368 (89.1712%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3980/4368 (91.1172%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9604, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4240/4679 (90.6177%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4049/4679 (86.5356%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3092, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4667/5265 (88.6420%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4662/5265 (88.5470%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0743, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4225/4767 (88.6302%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4191/4767 (87.9169%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1835, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5141/5902 (87.1061%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4940/5902 (83.7004%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2039, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3734/4223 (88.4206%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3831/4223 (90.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9249, Accuracy: 5589/10000 (55.8900%)
time spent on training: 264.65884041786194
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.2094, Accuracy: 6888/10000 (68.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 8.5335, Accuracy: 197/9900 (1.9899%)
Done in 293.3183958530426 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4461/4885 (91.3204%), train_poison_data_count: 385
Global model norm: 43.16946021114782.
Norm before scaling: 43.16741149338309. Distance: 2.005410267623984
Total norm for 4 adversaries is: 43.16741149338309. distance: 2.005410267623984
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3074, Accuracy: 9128/9900 (92.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 43.16946021114782.
Norm before scaling: 43.17135331525191. Distance: 2.185739080927781
Total norm for 4 adversaries is: 43.17135331525191. distance: 2.185739080927781
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2546, Accuracy: 9236/9900 (93.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4280/4717 (90.7356%), train_poison_data_count: 370
Global model norm: 43.16946021114782.
Norm before scaling: 43.16803644037087. Distance: 1.9837069250380637
Total norm for 4 adversaries is: 43.16803644037087. distance: 1.9837069250380637
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2810, Accuracy: 9222/9900 (93.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4549/5066 (89.7947%), train_poison_data_count: 400
Global model norm: 43.16946021114782.
Norm before scaling: 43.17462611122128. Distance: 2.2134513447603354
Total norm for 4 adversaries is: 43.17462611122128. distance: 2.2134513447603354
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1665, Accuracy: 9487/9900 (95.8283%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3436/3797 (90.4925%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3438/3797 (90.5452%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9443, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3494/3861 (90.4947%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3519/3861 (91.1422%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8851, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4178/4707 (88.7614%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4255/4707 (90.3973%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9227, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4038/4518 (89.3758%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4147/4518 (91.7884%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1022, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3695/4013 (92.0758%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3728/4013 (92.8981%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9002, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4640/5167 (89.8007%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4670/5167 (90.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1295, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3536/3969 (89.0905%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3597/3969 (90.6274%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0357, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4090/4441 (92.0964%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4143/4441 (93.2898%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0484, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4059/4558 (89.0522%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4092/4558 (89.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0067, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4038/4465 (90.4367%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4106/4465 (91.9597%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8523, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3317/3638 (91.1765%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3354/3638 (92.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8836, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4069/4538 (89.6651%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4162/4538 (91.7144%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8693, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5075/5740 (88.4146%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5213/5740 (90.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1535, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3476/3837 (90.5916%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3573/3837 (93.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8206, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3936/4361 (90.2545%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3635/4361 (83.3524%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0998, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4296/4793 (89.6307%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4388/4793 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9893, Accuracy: 5386/10000 (53.8600%)
time spent on training: 260.77740502357483
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.2209, Accuracy: 6874/10000 (68.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 8.2935, Accuracy: 247/9900 (2.4949%)
Done in 289.48079228401184 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4450/4885 (91.0952%), train_poison_data_count: 385
Global model norm: 43.198606793579.
Norm before scaling: 43.198804598622864. Distance: 2.0670121283615983
Total norm for 4 adversaries is: 43.198804598622864. distance: 2.0670121283615983
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1996, Accuracy: 9393/9900 (94.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 43.198606793579.
Norm before scaling: 43.196656952535115. Distance: 2.137333699499818
Total norm for 4 adversaries is: 43.196656952535115. distance: 2.137333699499818
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1361, Accuracy: 9561/9900 (96.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4261/4717 (90.3328%), train_poison_data_count: 370
Global model norm: 43.198606793579.
Norm before scaling: 43.19791729463065. Distance: 2.0350820926913293
Total norm for 4 adversaries is: 43.19791729463065. distance: 2.0350820926913293
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2005, Accuracy: 9392/9900 (94.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4548/5066 (89.7750%), train_poison_data_count: 400
Global model norm: 43.198606793579.
Norm before scaling: 43.20133501038698. Distance: 2.161645634513818
Total norm for 4 adversaries is: 43.20133501038698. distance: 2.161645634513818
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2860, Accuracy: 9201/9900 (92.9394%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4195/4767 (88.0008%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4205/4767 (88.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3547, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4086/4441 (92.0063%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4135/4441 (93.1097%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1046, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3916/4356 (89.8990%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3751/4356 (86.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.5960, Accuracy: 4763/10000 (47.6300%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5524/6391 (86.4340%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5562/6391 (87.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1020, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3743/4184 (89.4598%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3764/4184 (89.9618%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9392, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3938/4346 (90.6121%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4033/4346 (92.7980%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7925, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4484/5037 (89.0212%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4637/5037 (92.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9756, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4125/4634 (89.0160%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4226/4634 (91.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8410, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4309/4934 (87.3328%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4271/4934 (86.5626%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1047, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4840/5424 (89.2330%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4925/5424 (90.8001%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0944, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3407/3781 (90.1084%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3238/3781 (85.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2806, Accuracy: 4995/10000 (49.9500%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3543/3861 (91.7638%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3547/3861 (91.8674%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9051, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4507/5055 (89.1592%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4596/5055 (90.9199%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0561, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4020/4433 (90.6835%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4008/4433 (90.4128%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8998, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4621/5167 (89.4329%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4674/5167 (90.4587%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1350, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3352/3590 (93.3705%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3228/3590 (89.9164%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0149, Accuracy: 5592/10000 (55.9200%)
time spent on training: 265.3489365577698
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.2570, Accuracy: 6808/10000 (68.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 7.8984, Accuracy: 348/9900 (3.5152%)
Done in 294.23690700531006 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 43.22152354621769.
Norm before scaling: 43.22258688002793. Distance: 2.08990101958621
Total norm for 4 adversaries is: 43.22258688002793. distance: 2.08990101958621
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3072, Accuracy: 9162/9900 (92.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4839/5305 (91.2158%), train_poison_data_count: 415
Global model norm: 43.22152354621769.
Norm before scaling: 43.22127359542911. Distance: 2.0822077062669213
Total norm for 4 adversaries is: 43.22127359542911. distance: 2.0822077062669213
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2557, Accuracy: 9253/9900 (93.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4294/4717 (91.0324%), train_poison_data_count: 370
Global model norm: 43.22152354621769.
Norm before scaling: 43.22213217740348. Distance: 2.006178253887438
Total norm for 4 adversaries is: 43.22213217740348. distance: 2.006178253887438
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2128, Accuracy: 9343/9900 (94.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4592/5066 (90.6435%), train_poison_data_count: 400
Global model norm: 43.22152354621769.
Norm before scaling: 43.224226311576416. Distance: 2.137349316377584
Total norm for 4 adversaries is: 43.224226311576416. distance: 2.137349316377584
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3206, Accuracy: 9117/9900 (92.0909%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3912/4368 (89.5604%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3938/4368 (90.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9791, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3429/3828 (89.5768%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3525/3828 (92.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7809, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3935/4356 (90.3352%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3645/4356 (83.6777%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1158, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3483/3861 (90.2098%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3546/3861 (91.8415%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9438, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3186/3472 (91.7627%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3234/3472 (93.1452%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9056, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4123/4538 (90.8550%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4162/4538 (91.7144%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9828, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4824/5392 (89.4659%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4842/5392 (89.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1686, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3841/4295 (89.4296%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3678/4295 (85.6345%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2252, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3802/4235 (89.7757%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3768/4235 (88.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9907, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4043/4456 (90.7316%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4048/4456 (90.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9628, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4652/5265 (88.3571%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4599/5265 (87.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0171, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4081/4441 (91.8937%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4132/4441 (93.0421%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0518, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3673/4013 (91.5275%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3756/4013 (93.5958%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8781, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4015/4465 (89.9216%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4104/4465 (91.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8374, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5642/6263 (90.0846%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5678/6263 (90.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9228, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4437/4986 (88.9892%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4515/4986 (90.5535%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9184, Accuracy: 5620/10000 (56.2000%)
time spent on training: 257.7151999473572
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.2312, Accuracy: 6841/10000 (68.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 8.0117, Accuracy: 325/9900 (3.2828%)
Done in 286.6433026790619 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 43.25330071174843.
Norm before scaling: 43.25720789829425. Distance: 2.090075898868509
Total norm for 4 adversaries is: 43.25720789829425. distance: 2.090075898868509
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1780, Accuracy: 9458/9900 (95.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4843/5305 (91.2912%), train_poison_data_count: 415
Global model norm: 43.25330071174843.
Norm before scaling: 43.25460032434412. Distance: 2.1311391896725227
Total norm for 4 adversaries is: 43.25460032434412. distance: 2.1311391896725227
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1122, Accuracy: 9619/9900 (97.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4289/4717 (90.9264%), train_poison_data_count: 370
Global model norm: 43.25330071174843.
Norm before scaling: 43.25000705608685. Distance: 1.9599193346201198
Total norm for 4 adversaries is: 43.25000705608685. distance: 1.9599193346201198
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2253, Accuracy: 9320/9900 (94.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4585/5066 (90.5053%), train_poison_data_count: 400
Global model norm: 43.25330071174843.
Norm before scaling: 43.258474941875555. Distance: 2.184598469797863
Total norm for 4 adversaries is: 43.258474941875555. distance: 2.184598469797863
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1999, Accuracy: 9394/9900 (94.8889%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3720/4158 (89.4661%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3671/4158 (88.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9866, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4615/5167 (89.3168%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4659/5167 (90.1684%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1153, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3452/3828 (90.1776%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3488/3828 (91.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9217, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4240/4663 (90.9286%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4292/4663 (92.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9568, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4010/4433 (90.4579%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4083/4433 (92.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9895, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3746/4184 (89.5315%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3765/4184 (89.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9508, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4225/4716 (89.5886%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4258/4716 (90.2884%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0851, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3884/4223 (91.9725%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3928/4223 (93.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7827, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4220/4679 (90.1902%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4083/4679 (87.2622%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1963, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3340/3704 (90.1728%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3429/3704 (92.5756%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8653, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3512/3837 (91.5298%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3605/3837 (93.9536%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9091, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3539/3861 (91.6602%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3555/3861 (92.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9652, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4867/5424 (89.7308%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4903/5424 (90.3945%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.3316, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4128/4576 (90.2098%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4209/4576 (91.9799%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8310, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3630/4025 (90.1863%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3748/4025 (93.1180%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9168, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3476/3775 (92.0795%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3586/3775 (94.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7667, Accuracy: 5860/10000 (58.6000%)
time spent on training: 257.83535718917847
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.2279, Accuracy: 6858/10000 (68.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 7.8840, Accuracy: 331/9900 (3.3434%)
Done in 286.82763266563416 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4463/4885 (91.3613%), train_poison_data_count: 385
Global model norm: 43.2709204731509.
Norm before scaling: 43.27017711471797. Distance: 2.0287637606922098
Total norm for 4 adversaries is: 43.27017711471797. distance: 2.0287637606922098
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1322, Accuracy: 9545/9900 (96.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4830/5305 (91.0462%), train_poison_data_count: 415
Global model norm: 43.2709204731509.
Norm before scaling: 43.271486094067335. Distance: 2.166463683474797
Total norm for 4 adversaries is: 43.271486094067335. distance: 2.166463683474797
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2895, Accuracy: 9146/9900 (92.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 43.2709204731509.
Norm before scaling: 43.26742925770276. Distance: 1.9322843799984921
Total norm for 4 adversaries is: 43.26742925770276. distance: 1.9322843799984921
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.4183, Accuracy: 8922/9900 (90.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 43.2709204731509.
Norm before scaling: 43.27400379323451. Distance: 2.1845886475258736
Total norm for 4 adversaries is: 43.27400379323451. distance: 2.1845886475258736
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1002, Accuracy: 9634/9900 (97.3131%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4106/4576 (89.7290%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4196/4576 (91.6958%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9639, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3277/3672 (89.2429%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3341/3672 (90.9858%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9692, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4163/4618 (90.1472%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4128/4618 (89.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1399, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4121/4538 (90.8109%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4231/4538 (93.2349%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8638, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4550/5025 (90.5473%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4647/5025 (92.4776%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1101, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3375/3590 (94.0111%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3434/3590 (95.6546%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.7889, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4188/4707 (88.9739%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4272/4707 (90.7584%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0491, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4419/4918 (89.8536%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4448/4918 (90.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0366, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3883/4336 (89.5526%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3924/4336 (90.4982%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1126, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5143/5902 (87.1400%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5104/5902 (86.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1652, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4088/4441 (92.0513%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4157/4441 (93.6050%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0409, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4572/5232 (87.3853%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4622/5232 (88.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0334, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4297/4804 (89.4463%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4192/4804 (87.2606%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2311, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3567/3969 (89.8715%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3551/3969 (89.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0686, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4857/5392 (90.0779%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4898/5392 (90.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0584, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3421/3828 (89.3678%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3477/3828 (90.8307%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9840, Accuracy: 5451/10000 (54.5100%)
time spent on training: 265.7345857620239
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.2189, Accuracy: 6862/10000 (68.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 7.9322, Accuracy: 285/9900 (2.8788%)
Done in 294.49786162376404 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4490/4885 (91.9140%), train_poison_data_count: 385
Global model norm: 43.29543286347808.
Norm before scaling: 43.29453626171768. Distance: 2.0099991939789783
Total norm for 4 adversaries is: 43.29453626171768. distance: 2.0099991939789783
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1357, Accuracy: 9579/9900 (96.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4818/5305 (90.8200%), train_poison_data_count: 415
Global model norm: 43.29543286347808.
Norm before scaling: 43.29385251990893. Distance: 2.159282376501445
Total norm for 4 adversaries is: 43.29385251990893. distance: 2.159282376501445
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1757, Accuracy: 9459/9900 (95.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 43.29543286347808.
Norm before scaling: 43.29333935401466. Distance: 1.9987247096615373
Total norm for 4 adversaries is: 43.29333935401466. distance: 1.9987247096615373
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2906, Accuracy: 9189/9900 (92.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4584/5066 (90.4856%), train_poison_data_count: 400
Global model norm: 43.29543286347808.
Norm before scaling: 43.29387507651198. Distance: 2.1442929884221824
Total norm for 4 adversaries is: 43.29387507651198. distance: 2.1442929884221824
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1149, Accuracy: 9566/9900 (96.6263%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4568/5232 (87.3089%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4586/5232 (87.6529%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1149, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4402/4956 (88.8216%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4404/4956 (88.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2024, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4422/5063 (87.3395%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4412/5063 (87.1420%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1434, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3678/4025 (91.3789%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3748/4025 (93.1180%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8857, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4070/4441 (91.6460%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4102/4441 (92.3666%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0736, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4058/4625 (87.7405%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3999/4625 (86.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1513, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4900/5591 (87.6409%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4796/5591 (85.7807%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3537, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5084/5582 (91.0785%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5093/5582 (91.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1397, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5144/5902 (87.1569%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5146/5902 (87.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3754, Accuracy: 4936/10000 (49.3600%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4132/4538 (91.0533%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4227/4538 (93.1468%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8366, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4614/5025 (91.8209%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4658/5025 (92.6965%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0201, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3858/4223 (91.3569%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3910/4223 (92.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8739, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3909/4361 (89.6354%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3837/4361 (87.9844%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0979, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3898/4354 (89.5269%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3640/4354 (83.6013%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3283, Accuracy: 4935/10000 (49.3500%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3291/3672 (89.6242%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3320/3672 (90.4139%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1921, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3944/4356 (90.5418%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3897/4356 (89.4628%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1206, Accuracy: 5181/10000 (51.8100%)
time spent on training: 264.6717393398285
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1872, Accuracy: 6941/10000 (69.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 8.5404, Accuracy: 168/9900 (1.6970%)
Done in 293.36435317993164 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4432/4885 (90.7267%), train_poison_data_count: 385
Global model norm: 43.32147414470464.
Norm before scaling: 43.322592788272004. Distance: 2.0781893612639712
Total norm for 4 adversaries is: 43.322592788272004. distance: 2.0781893612639712
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0962, Accuracy: 9668/9900 (97.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4843/5305 (91.2912%), train_poison_data_count: 415
Global model norm: 43.32147414470464.
Norm before scaling: 43.3169513743429. Distance: 2.0712567173555945
Total norm for 4 adversaries is: 43.3169513743429. distance: 2.0712567173555945
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2087, Accuracy: 9388/9900 (94.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 43.32147414470464.
Norm before scaling: 43.32080773499612. Distance: 1.9981898818759372
Total norm for 4 adversaries is: 43.32080773499612. distance: 1.9981898818759372
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.4861, Accuracy: 8786/9900 (88.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4556/5066 (89.9329%), train_poison_data_count: 400
Global model norm: 43.32147414470464.
Norm before scaling: 43.32622043235626. Distance: 2.2212419082760406
Total norm for 4 adversaries is: 43.32622043235626. distance: 2.2212419082760406
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1675, Accuracy: 9496/9900 (95.9192%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3564/3828 (93.1034%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3554/3828 (92.8422%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8574, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3832/4235 (90.4841%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3816/4235 (90.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9760, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3328/3704 (89.8488%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3355/3704 (90.5778%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9461, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3694/4046 (91.3000%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3724/4046 (92.0415%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8032, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4436/4928 (90.0162%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4474/4928 (90.7873%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9068, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5132/5740 (89.4077%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5116/5740 (89.1289%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1528, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4473/5083 (87.9992%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4505/5083 (88.6288%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9081, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4120/4576 (90.0350%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4136/4576 (90.3846%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9490, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4229/4647 (91.0049%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4311/4647 (92.7695%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9152, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4924/5424 (90.7817%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4919/5424 (90.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3172, Accuracy: 4944/10000 (49.4400%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3991/4503 (88.6298%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4051/4503 (89.9622%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0428, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5517/6391 (86.3245%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5573/6391 (87.2008%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1481, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4015/4511 (89.0047%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4036/4511 (89.4702%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9141, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4029/4456 (90.4174%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4083/4456 (91.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1345, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4266/4804 (88.8010%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3924/4804 (81.6819%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1865, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3394/3804 (89.2219%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3436/3804 (90.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9858, Accuracy: 5474/10000 (54.7400%)
time spent on training: 265.12146282196045
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1978, Accuracy: 6905/10000 (69.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 8.0535, Accuracy: 272/9900 (2.7475%)
Done in 294.0120704174042 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 43.34461319661374.
Norm before scaling: 43.344666705789045. Distance: 2.0454581212484526
Total norm for 4 adversaries is: 43.344666705789045. distance: 2.0454581212484526
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2117, Accuracy: 9368/9900 (94.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4819/5305 (90.8388%), train_poison_data_count: 415
Global model norm: 43.34461319661374.
Norm before scaling: 43.34413301921611. Distance: 2.1707108485640667
Total norm for 4 adversaries is: 43.34413301921611. distance: 2.1707108485640667
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2051, Accuracy: 9378/9900 (94.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 43.34461319661374.
Norm before scaling: 43.343565529978754. Distance: 1.9900394602558122
Total norm for 4 adversaries is: 43.343565529978754. distance: 1.9900394602558122
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1680, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4585/5066 (90.5053%), train_poison_data_count: 400
Global model norm: 43.34461319661374.
Norm before scaling: 43.3455890246127. Distance: 2.1131422522449017
Total norm for 4 adversaries is: 43.3455890246127. distance: 2.1131422522449017
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1210, Accuracy: 9582/9900 (96.7879%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4425/4928 (89.7930%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4456/4928 (90.4221%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8988, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4525/5037 (89.8352%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4660/5037 (92.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8827, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4853/5392 (90.0037%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4815/5392 (89.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0371, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4015/4501 (89.2024%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4028/4501 (89.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1020, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3462/3804 (91.0095%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3537/3804 (92.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8293, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3512/3837 (91.5298%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3601/3837 (93.8494%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7554, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4433/5063 (87.5568%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4275/5063 (84.4361%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.3300, Accuracy: 4879/10000 (48.7900%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3931/4481 (87.7260%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3902/4481 (87.0788%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1289, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4104/4518 (90.8367%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4126/4518 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0248, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3272/3638 (89.9395%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3344/3638 (91.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9113, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4245/4663 (91.0358%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4296/4663 (92.1295%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0171, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4033/4625 (87.2000%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4056/4625 (87.6973%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0827, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4612/5197 (88.7435%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4606/5197 (88.6281%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1694, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4504/5083 (88.6091%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4544/5083 (89.3960%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0830, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3539/3828 (92.4504%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3586/3828 (93.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8417, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3323/3704 (89.7138%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3415/3704 (92.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9078, Accuracy: 5656/10000 (56.5600%)
time spent on training: 264.08523201942444
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.2006, Accuracy: 6906/10000 (69.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 8.4351, Accuracy: 188/9900 (1.8990%)
Done in 293.06119680404663 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4438/4885 (90.8495%), train_poison_data_count: 385
Global model norm: 43.3671037593769.
Norm before scaling: 43.368373221720425. Distance: 2.09909832079776
Total norm for 4 adversaries is: 43.368373221720425. distance: 2.09909832079776
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2732, Accuracy: 9220/9900 (93.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 43.3671037593769.
Norm before scaling: 43.36656612665092. Distance: 2.102460591313165
Total norm for 4 adversaries is: 43.36656612665092. distance: 2.102460591313165
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1097, Accuracy: 9618/9900 (97.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 43.3671037593769.
Norm before scaling: 43.36534728013328. Distance: 1.9900897182195356
Total norm for 4 adversaries is: 43.36534728013328. distance: 1.9900897182195356
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2380, Accuracy: 9333/9900 (94.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 43.3671037593769.
Norm before scaling: 43.3681100435562. Distance: 2.158306523258419
Total norm for 4 adversaries is: 43.3681100435562. distance: 2.158306523258419
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1909, Accuracy: 9404/9900 (94.9899%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3531/3861 (91.4530%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3573/3861 (92.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8830, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3760/4184 (89.8662%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3807/4184 (90.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9492, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4499/5037 (89.3190%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4582/5037 (90.9668%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9688, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4590/5197 (88.3202%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4489/5197 (86.3768%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1400, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4541/5025 (90.3682%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4577/5025 (91.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0413, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4598/5116 (89.8749%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4505/5116 (88.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0887, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3949/4481 (88.1277%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3934/4481 (87.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3066, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4200/4576 (91.7832%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4178/4576 (91.3024%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9609, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4583/5232 (87.5956%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4679/5232 (89.4304%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1281, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3893/4354 (89.4120%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3857/4354 (88.5852%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1385, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2909/3271 (88.9330%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0058, Accuracy: 2897/3271 (88.5662%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0430, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4887/5455 (89.5875%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4929/5455 (90.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1683, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3714/4126 (90.0145%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3767/4126 (91.2991%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0315, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3415/3797 (89.9394%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3476/3797 (91.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9373, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3417/3704 (92.2516%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3460/3704 (93.4125%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8118, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4382/4934 (88.8123%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4274/4934 (86.6234%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0795, Accuracy: 5285/10000 (52.8500%)
time spent on training: 263.4218966960907
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.2042, Accuracy: 6901/10000 (69.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 8.4580, Accuracy: 203/9900 (2.0505%)
Done in 292.5982663631439 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4499/4885 (92.0983%), train_poison_data_count: 385
Global model norm: 43.40388903091303.
Norm before scaling: 43.40184012876067. Distance: 1.9919062397197496
Total norm for 4 adversaries is: 43.40184012876067. distance: 1.9919062397197496
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2515, Accuracy: 9275/9900 (93.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 43.40388903091303.
Norm before scaling: 43.40344888370048. Distance: 2.146352415046326
Total norm for 4 adversaries is: 43.40344888370048. distance: 2.146352415046326
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2935, Accuracy: 9165/9900 (92.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 43.40388903091303.
Norm before scaling: 43.40075165409725. Distance: 2.030918035523985
Total norm for 4 adversaries is: 43.40075165409725. distance: 2.030918035523985
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1884, Accuracy: 9421/9900 (95.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 43.40388903091303.
Norm before scaling: 43.40178528379118. Distance: 2.171434426389416
Total norm for 4 adversaries is: 43.40178528379118. distance: 2.171434426389416
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1257, Accuracy: 9554/9900 (96.5051%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4170/4618 (90.2988%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4095/4618 (88.6748%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9826, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4029/4625 (87.1135%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4022/4625 (86.9622%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2668, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5115/5740 (89.1115%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5134/5740 (89.4425%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3882, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3917/4416 (88.7002%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3997/4416 (90.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9360, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3737/4126 (90.5720%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3784/4126 (91.7111%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8592, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3170/3616 (87.6659%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3304/3616 (91.3717%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8029, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3695/4158 (88.8648%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3738/4158 (89.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9715, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3946/4346 (90.7961%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4010/4346 (92.2688%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0260, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4272/4874 (87.6487%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4328/4874 (88.7977%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2633, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4705/5265 (89.3637%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4629/5265 (87.9202%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0080, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3661/4025 (90.9565%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3705/4025 (92.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9597, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4169/4651 (89.6366%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4233/4651 (91.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0491, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3462/3837 (90.2267%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3534/3837 (92.1032%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0510, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3258/3638 (89.5547%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3306/3638 (90.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8908, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3197/3472 (92.0795%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3274/3472 (94.2972%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9402, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4049/4456 (90.8662%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4112/4456 (92.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0724, Accuracy: 5408/10000 (54.0800%)
time spent on training: 260.4550862312317
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.2236, Accuracy: 6849/10000 (68.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 8.4015, Accuracy: 213/9900 (2.1515%)
Done in 289.7162013053894 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 43.428864642996224.
Norm before scaling: 43.43183416285801. Distance: 2.1273404864210184
Total norm for 4 adversaries is: 43.43183416285801. distance: 2.1273404864210184
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1831, Accuracy: 9464/9900 (95.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 43.428864642996224.
Norm before scaling: 43.42779652183826. Distance: 2.112823718847611
Total norm for 4 adversaries is: 43.42779652183826. distance: 2.112823718847611
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1121, Accuracy: 9608/9900 (97.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 43.428864642996224.
Norm before scaling: 43.426961682537296. Distance: 2.0177222880791903
Total norm for 4 adversaries is: 43.426961682537296. distance: 2.0177222880791903
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1566, Accuracy: 9509/9900 (96.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 43.428864642996224.
Norm before scaling: 43.433374354435095. Distance: 2.240694086986235
Total norm for 4 adversaries is: 43.433374354435095. distance: 2.240694086986235
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1954, Accuracy: 9393/9900 (94.8788%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4860/5424 (89.6018%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4909/5424 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0737, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4568/4986 (91.6165%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4555/4986 (91.3558%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8869, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4628/5167 (89.5684%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4678/5167 (90.5361%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1000, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4251/4716 (90.1399%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4255/4716 (90.2248%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1038, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3927/4368 (89.9038%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3854/4368 (88.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0572, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3984/4356 (91.4601%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3847/4356 (88.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3204, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4329/4804 (90.1124%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4342/4804 (90.3830%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0994, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3946/4481 (88.0607%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3909/4481 (87.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0340, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3641/4025 (90.4596%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3738/4025 (92.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8077, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4552/5017 (90.7315%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4590/5017 (91.4889%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9838, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3232/3616 (89.3805%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3332/3616 (92.1460%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8307, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3736/4184 (89.2925%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3789/4184 (90.5593%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9253, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4585/5195 (88.2579%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4594/5195 (88.4312%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0342, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3951/4361 (90.5985%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3959/4361 (90.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0638, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3511/3756 (93.4771%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3574/3756 (95.1544%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8121, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4923/5591 (88.0522%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4911/5591 (87.8376%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1245, Accuracy: 5388/10000 (53.8800%)
time spent on training: 266.36224365234375
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.2498, Accuracy: 6813/10000 (68.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 8.6222, Accuracy: 188/9900 (1.8990%)
Done in 294.87203192710876 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 43.46770111288453.
Norm before scaling: 43.464669448120446. Distance: 2.0535939138378017
Total norm for 4 adversaries is: 43.464669448120446. distance: 2.0535939138378017
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.3648, Accuracy: 8995/9900 (90.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4805/5305 (90.5749%), train_poison_data_count: 415
Global model norm: 43.46770111288453.
Norm before scaling: 43.46587006320663. Distance: 2.1740811347245046
Total norm for 4 adversaries is: 43.46587006320663. distance: 2.1740811347245046
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2400, Accuracy: 9307/9900 (94.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4255/4717 (90.2056%), train_poison_data_count: 370
Global model norm: 43.46770111288453.
Norm before scaling: 43.466201455214744. Distance: 2.0224120144749747
Total norm for 4 adversaries is: 43.466201455214744. distance: 2.0224120144749747
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1393, Accuracy: 9536/9900 (96.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 43.46770111288453.
Norm before scaling: 43.46653705725819. Distance: 2.156659184206561
Total norm for 4 adversaries is: 43.46653705725819. distance: 2.156659184206561
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.3243, Accuracy: 9120/9900 (92.1212%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3766/4175 (90.2036%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3792/4175 (90.8263%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9633, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4975/5455 (91.2007%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5003/5455 (91.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9586, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3398/3704 (91.7387%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3445/3704 (93.0076%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8953, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4380/4989 (87.7931%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4401/4989 (88.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9314, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4430/4928 (89.8945%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4449/4928 (90.2800%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9639, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3492/3804 (91.7981%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3535/3804 (92.9285%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9738, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3892/4336 (89.7601%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3911/4336 (90.1983%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0052, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3692/4046 (91.2506%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3695/4046 (91.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9237, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4383/4793 (91.4459%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4406/4793 (91.9257%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9493, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3509/3756 (93.4239%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3572/3756 (95.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1194, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5516/6391 (86.3089%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5502/6391 (86.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2275, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3266/3672 (88.9434%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3339/3672 (90.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8579, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4113/4558 (90.2369%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4074/4558 (89.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0068, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4143/4576 (90.5376%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4165/4576 (91.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1159, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4151/4456 (93.1553%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4190/4456 (94.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8388, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3944/4356 (90.5418%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3702/4356 (84.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2866, Accuracy: 5149/10000 (51.4900%)
time spent on training: 260.96632266044617
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.3379, Accuracy: 6720/10000 (67.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 8.9016, Accuracy: 134/9900 (1.3535%)
Done in 289.48915672302246 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 43.50341502848512.
Norm before scaling: 43.503859776227756. Distance: 2.077742921510788
Total norm for 4 adversaries is: 43.503859776227756. distance: 2.077742921510788
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2465, Accuracy: 9306/9900 (94.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 43.50341502848512.
Norm before scaling: 43.50003367455593. Distance: 2.1183883808505946
Total norm for 4 adversaries is: 43.50003367455593. distance: 2.1183883808505946
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2176, Accuracy: 9377/9900 (94.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 43.50341502848512.
Norm before scaling: 43.49743083514028. Distance: 2.038730872068598
Total norm for 4 adversaries is: 43.49743083514028. distance: 2.038730872068598
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1453, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4592/5066 (90.6435%), train_poison_data_count: 400
Global model norm: 43.50341502848512.
Norm before scaling: 43.506265824770864. Distance: 2.151381705118686
Total norm for 4 adversaries is: 43.506265824770864. distance: 2.151381705118686
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1423, Accuracy: 9541/9900 (96.3737%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4535/5116 (88.6435%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4547/5116 (88.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1008, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5058/5582 (90.6127%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5068/5582 (90.7918%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2304, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4297/4928 (87.1956%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4412/4928 (89.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0797, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3746/4126 (90.7901%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3812/4126 (92.3897%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7725, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3714/4158 (89.3218%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3738/4158 (89.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8807, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4436/5063 (87.6160%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4205/5063 (83.0535%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3631, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5374/6124 (87.7531%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5426/6124 (88.6022%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0321, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3917/4354 (89.9633%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3759/4354 (86.3344%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3625, Accuracy: 4924/10000 (49.2400%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4548/5025 (90.5075%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4622/5025 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0754, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4237/4679 (90.5535%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4081/4679 (87.2195%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1532, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4411/4793 (92.0300%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4447/4793 (92.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8991, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4100/4518 (90.7481%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4145/4518 (91.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0347, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4597/5167 (88.9685%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4671/5167 (90.4006%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9994, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4050/4433 (91.3603%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4037/4433 (91.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9136, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4040/4503 (89.7180%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4052/4503 (89.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0603, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4252/4707 (90.3335%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4307/4707 (91.5020%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8567, Accuracy: 5699/10000 (56.9900%)
time spent on training: 268.47558879852295
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.3265, Accuracy: 6736/10000 (67.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 8.7130, Accuracy: 140/9900 (1.4141%)
Done in 297.5240104198456 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 43.53234222203002.
Norm before scaling: 43.530659711988484. Distance: 2.0865562178577317
Total norm for 4 adversaries is: 43.530659711988484. distance: 2.0865562178577317
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1426, Accuracy: 9557/9900 (96.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4803/5305 (90.5372%), train_poison_data_count: 415
Global model norm: 43.53234222203002.
Norm before scaling: 43.52833353475067. Distance: 2.1278311998562733
Total norm for 4 adversaries is: 43.52833353475067. distance: 2.1278311998562733
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2368, Accuracy: 9309/9900 (94.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4299/4717 (91.1384%), train_poison_data_count: 370
Global model norm: 43.53234222203002.
Norm before scaling: 43.52832231719941. Distance: 1.9844938828308447
Total norm for 4 adversaries is: 43.52832231719941. distance: 1.9844938828308447
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1536, Accuracy: 9499/9900 (95.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4551/5066 (89.8342%), train_poison_data_count: 400
Global model norm: 43.53234222203002.
Norm before scaling: 43.53052090200622. Distance: 2.1578701401068927
Total norm for 4 adversaries is: 43.53052090200622. distance: 2.1578701401068927
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1531, Accuracy: 9495/9900 (95.9091%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3376/3704 (91.1447%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3444/3704 (92.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8928, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4783/5392 (88.7055%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4774/5392 (88.5386%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0770, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3994/4362 (91.5635%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4064/4362 (93.1683%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9510, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4136/4538 (91.1415%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4195/4538 (92.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9089, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3756/4184 (89.7706%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3809/4184 (91.0373%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8744, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3472/3756 (92.4388%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3556/3756 (94.6752%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8374, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4224/4679 (90.2757%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4154/4679 (88.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1231, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3165/3472 (91.1578%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3235/3472 (93.1740%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0694, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5539/6391 (86.6688%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5593/6391 (87.5137%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1088, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4677/5265 (88.8319%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4530/5265 (86.0399%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1941, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5122/5902 (86.7841%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5131/5902 (86.9366%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1283, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5288/6124 (86.3488%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5319/6124 (86.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1071, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4542/5083 (89.3567%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4507/5083 (88.6681%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9935, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4049/4465 (90.6831%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4098/4465 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9537, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3456/3804 (90.8517%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3511/3804 (92.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9736, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4452/4918 (90.5246%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4467/4918 (90.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0038, Accuracy: 5423/10000 (54.2300%)
time spent on training: 266.07240080833435
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.3210, Accuracy: 6739/10000 (67.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 8.8688, Accuracy: 136/9900 (1.3737%)
Done in 295.2495951652527 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4481/4885 (91.7298%), train_poison_data_count: 385
Global model norm: 43.561405731862436.
Norm before scaling: 43.55978039170351. Distance: 2.0763268973609597
Total norm for 4 adversaries is: 43.55978039170351. distance: 2.0763268973609597
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3313, Accuracy: 9104/9900 (91.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4836/5305 (91.1593%), train_poison_data_count: 415
Global model norm: 43.561405731862436.
Norm before scaling: 43.5555808484616. Distance: 2.1162907013694117
Total norm for 4 adversaries is: 43.5555808484616. distance: 2.1162907013694117
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2332, Accuracy: 9324/9900 (94.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4298/4717 (91.1172%), train_poison_data_count: 370
Global model norm: 43.561405731862436.
Norm before scaling: 43.56321875527924. Distance: 2.0104393307161086
Total norm for 4 adversaries is: 43.56321875527924. distance: 2.0104393307161086
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1930, Accuracy: 9433/9900 (95.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4578/5066 (90.3672%), train_poison_data_count: 400
Global model norm: 43.561405731862436.
Norm before scaling: 43.56611747444194. Distance: 2.172278058092454
Total norm for 4 adversaries is: 43.56611747444194. distance: 2.172278058092454
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3191, Accuracy: 9106/9900 (91.9798%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4144/4538 (91.3178%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4186/4538 (92.2433%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9034, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4344/4989 (87.0716%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4460/4989 (89.3967%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9492, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4389/4793 (91.5710%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4443/4793 (92.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8760, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3708/4158 (89.1775%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3683/4158 (88.5762%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8941, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3535/3861 (91.5566%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3560/3861 (92.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9052, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4627/5232 (88.4365%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4623/5232 (88.3601%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2524, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4243/4663 (90.9929%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4371/4663 (93.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8777, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4675/5197 (89.9557%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4647/5197 (89.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0762, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4658/5167 (90.1490%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4656/5167 (90.1103%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0964, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3937/4416 (89.1531%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4010/4416 (90.8062%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8684, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3923/4354 (90.1011%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0099, Accuracy: 3568/4354 (81.9476%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.6499, Accuracy: 4621/10000 (46.2100%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4979/5455 (91.2741%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4920/5455 (90.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9476, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4157/4456 (93.2899%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4140/4456 (92.9084%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9579, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2916/3271 (89.1470%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3009/3271 (91.9902%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9040, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3011/3297 (91.3254%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3040/3297 (92.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8010, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5106/5591 (91.3253%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5006/5591 (89.5368%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1866, Accuracy: 5201/10000 (52.0100%)
time spent on training: 265.79621148109436
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.3828, Accuracy: 6637/10000 (66.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 8.7643, Accuracy: 156/9900 (1.5758%)
Done in 294.6893963813782 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 43.59537687376524.
Norm before scaling: 43.59208106124322. Distance: 2.061106124122438
Total norm for 4 adversaries is: 43.59208106124322. distance: 2.061106124122438
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1645, Accuracy: 9487/9900 (95.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4851/5305 (91.4420%), train_poison_data_count: 415
Global model norm: 43.59537687376524.
Norm before scaling: 43.59185143715222. Distance: 2.123592583815486
Total norm for 4 adversaries is: 43.59185143715222. distance: 2.123592583815486
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.3683, Accuracy: 9060/9900 (91.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 43.59537687376524.
Norm before scaling: 43.59327116672509. Distance: 2.0420151886631994
Total norm for 4 adversaries is: 43.59327116672509. distance: 2.0420151886631994
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1394, Accuracy: 9547/9900 (96.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 43.59537687376524.
Norm before scaling: 43.598419048799094. Distance: 2.187345989800301
Total norm for 4 adversaries is: 43.598419048799094. distance: 2.187345989800301
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1223, Accuracy: 9586/9900 (96.8283%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4653/5167 (90.0523%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4687/5167 (90.7103%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1100, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3512/3775 (93.0331%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3608/3775 (95.5762%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7758, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4600/5195 (88.5467%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4662/5195 (89.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0325, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3688/4126 (89.3844%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3815/4126 (92.4624%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8036, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3500/3911 (89.4912%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3281/3911 (83.8916%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.3971, Accuracy: 4825/10000 (48.2500%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4021/4433 (90.7061%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4073/4433 (91.8791%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8399, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2892/3271 (88.4133%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0062, Accuracy: 2862/3271 (87.4962%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0838, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3367/3590 (93.7883%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3327/3590 (92.6741%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9981, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4510/4918 (91.7039%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4560/4918 (92.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0225, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4555/4986 (91.3558%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4585/4986 (91.9575%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7946, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3203/3616 (88.5785%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3298/3616 (91.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9719, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3851/4295 (89.6624%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3873/4295 (90.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9571, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4015/4356 (92.1717%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3942/4356 (90.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9983, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4427/4793 (92.3639%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4449/4793 (92.8229%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9645, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3939/4315 (91.2862%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3930/4315 (91.0776%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9259, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4281/4804 (89.1132%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4344/4804 (90.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2183, Accuracy: 5198/10000 (51.9800%)
time spent on training: 258.2078900337219
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.4658, Accuracy: 6536/10000 (65.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 8.9573, Accuracy: 152/9900 (1.5354%)
Done in 286.61263704299927 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 43.62579187587172.
Norm before scaling: 43.62169103451788. Distance: 2.061052218838547
Total norm for 4 adversaries is: 43.62169103451788. distance: 2.061052218838547
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1829, Accuracy: 9454/9900 (95.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4832/5305 (91.0839%), train_poison_data_count: 415
Global model norm: 43.62579187587172.
Norm before scaling: 43.623105595508385. Distance: 2.179880550681729
Total norm for 4 adversaries is: 43.623105595508385. distance: 2.179880550681729
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1151, Accuracy: 9613/9900 (97.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 43.62579187587172.
Norm before scaling: 43.62316855709747. Distance: 1.996225311661693
Total norm for 4 adversaries is: 43.62316855709747. distance: 1.996225311661693
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0824, Accuracy: 9672/9900 (97.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 43.62579187587172.
Norm before scaling: 43.62690411541154. Distance: 2.183054739768605
Total norm for 4 adversaries is: 43.62690411541154. distance: 2.183054739768605
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1297, Accuracy: 9569/9900 (96.6566%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4056/4503 (90.0733%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4071/4503 (90.4064%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9036, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4416/4934 (89.5014%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4256/4934 (86.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3108, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4402/4804 (91.6320%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4105/4804 (85.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3884, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4089/4456 (91.7639%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4154/4456 (93.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.7930, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4151/4651 (89.2496%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4222/4651 (90.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9421, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3751/4184 (89.6511%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3815/4184 (91.1807%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0218, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4314/4928 (87.5406%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4398/4928 (89.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0392, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3500/3775 (92.7152%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3614/3775 (95.7351%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.7826, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4465/5083 (87.8418%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4502/5083 (88.5697%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0735, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4916/5455 (90.1192%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4903/5455 (89.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1605, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3277/3638 (90.0770%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3353/3638 (92.1660%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8613, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3481/3911 (89.0054%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3529/3911 (90.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0277, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3489/3837 (90.9304%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3594/3837 (93.6669%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8628, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4036/4501 (89.6690%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4038/4501 (89.7134%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9560, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4709/5197 (90.6100%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4725/5197 (90.9178%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1902, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3503/3861 (90.7278%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3506/3861 (90.8055%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9066, Accuracy: 5623/10000 (56.2300%)
time spent on training: 261.9674913883209
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.4660, Accuracy: 6524/10000 (65.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 8.7825, Accuracy: 200/9900 (2.0202%)
Done in 290.46609258651733 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4485/4885 (91.8117%), train_poison_data_count: 385
Global model norm: 43.650416798912126.
Norm before scaling: 43.64799352624571. Distance: 2.0678336796534156
Total norm for 4 adversaries is: 43.64799352624571. distance: 2.0678336796534156
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2186, Accuracy: 9318/9900 (94.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 43.650416798912126.
Norm before scaling: 43.64743977627368. Distance: 2.1561972570188326
Total norm for 4 adversaries is: 43.64743977627368. distance: 2.1561972570188326
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1761, Accuracy: 9481/9900 (95.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4307/4717 (91.3080%), train_poison_data_count: 370
Global model norm: 43.650416798912126.
Norm before scaling: 43.64518554983685. Distance: 1.97386655032142
Total norm for 4 adversaries is: 43.64518554983685. distance: 1.97386655032142
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2113, Accuracy: 9334/9900 (94.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 43.650416798912126.
Norm before scaling: 43.65148366742174. Distance: 2.212233631888668
Total norm for 4 adversaries is: 43.65148366742174. distance: 2.212233631888668
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1412, Accuracy: 9499/9900 (95.9495%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2908/3271 (88.9025%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0060, Accuracy: 2888/3271 (88.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0268, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3951/4511 (87.5859%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4030/4511 (89.3372%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0280, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3256/3638 (89.4997%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3358/3638 (92.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8097, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5074/5582 (90.8993%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5096/5582 (91.2934%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1598, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4113/4456 (92.3025%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4179/4456 (93.7837%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8910, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5187/5902 (87.8855%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5022/5902 (85.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3227, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3908/4416 (88.4964%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3996/4416 (90.4891%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0105, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4457/4934 (90.3324%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4377/4934 (88.7110%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0775, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4127/4596 (89.7955%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4227/4596 (91.9713%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0394, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3487/3837 (90.8783%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3575/3837 (93.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8525, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5549/6391 (86.8252%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5540/6391 (86.6844%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1507, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3950/4368 (90.4304%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3938/4368 (90.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0335, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3457/3804 (90.8780%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3505/3804 (92.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8183, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5683/6263 (90.7393%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5724/6263 (91.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2690, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4379/4793 (91.3624%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4446/4793 (92.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9199, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4855/5424 (89.5096%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4945/5424 (91.1689%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3004, Accuracy: 5064/10000 (50.6400%)
time spent on training: 268.25001668930054
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.4720, Accuracy: 6528/10000 (65.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 9.1360, Accuracy: 176/9900 (1.7778%)
Done in 297.10958337783813 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 43.68024293713206.
Norm before scaling: 43.67408452594842. Distance: 2.0422733210048034
Total norm for 4 adversaries is: 43.67408452594842. distance: 2.0422733210048034
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2229, Accuracy: 9346/9900 (94.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 43.68024293713206.
Norm before scaling: 43.675641329095704. Distance: 2.1380554146860438
Total norm for 4 adversaries is: 43.675641329095704. distance: 2.1380554146860438
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2514, Accuracy: 9317/9900 (94.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 43.68024293713206.
Norm before scaling: 43.67698147694618. Distance: 2.0319581191335114
Total norm for 4 adversaries is: 43.67698147694618. distance: 2.0319581191335114
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1668, Accuracy: 9468/9900 (95.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4521/5066 (89.2420%), train_poison_data_count: 400
Global model norm: 43.68024293713206.
Norm before scaling: 43.68105057902683. Distance: 2.2684616746361868
Total norm for 4 adversaries is: 43.68105057902683. distance: 2.2684616746361868
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2369, Accuracy: 9295/9900 (93.8889%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4516/5055 (89.3373%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4597/5055 (90.9397%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9966, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3768/4184 (90.0574%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3818/4184 (91.2524%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9095, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3602/3861 (93.2919%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3586/3861 (92.8775%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.7575, Accuracy: 5911/10000 (59.1100%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4395/4804 (91.4863%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4010/4804 (83.4721%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.4386, Accuracy: 4876/10000 (48.7600%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3180/3472 (91.5899%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3223/3472 (92.8283%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9724, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3538/3969 (89.1408%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3546/3969 (89.3424%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8529, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4413/4989 (88.4546%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4465/4989 (89.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9679, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5068/5582 (90.7918%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5092/5582 (91.2218%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0721, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4382/4793 (91.4250%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4481/4793 (93.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9598, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4149/4662 (88.9961%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4257/4662 (91.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1312, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4381/4934 (88.7921%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4312/4934 (87.3936%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1617, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4560/4986 (91.4561%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4571/4986 (91.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9265, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3991/4433 (90.0293%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4007/4433 (90.3903%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9134, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4216/4716 (89.3978%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4305/4716 (91.2850%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9376, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4149/4596 (90.2742%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4221/4596 (91.8407%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0140, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3917/4354 (89.9633%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3558/4354 (81.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.5215, Accuracy: 4703/10000 (47.0300%)
time spent on training: 265.5242962837219
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.5041, Accuracy: 6502/10000 (65.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 8.3374, Accuracy: 410/9900 (4.1414%)
Done in 294.3306260108948 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4460/4885 (91.2999%), train_poison_data_count: 385
Global model norm: 43.721251715412954.
Norm before scaling: 43.719191161105094. Distance: 2.0797202505374623
Total norm for 4 adversaries is: 43.719191161105094. distance: 2.0797202505374623
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0824, Accuracy: 9691/9900 (97.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 43.721251715412954.
Norm before scaling: 43.71791513230732. Distance: 2.1840731345357307
Total norm for 4 adversaries is: 43.71791513230732. distance: 2.1840731345357307
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1862, Accuracy: 9438/9900 (95.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 43.721251715412954.
Norm before scaling: 43.71874860391349. Distance: 2.05006300201368
Total norm for 4 adversaries is: 43.71874860391349. distance: 2.05006300201368
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2823, Accuracy: 9194/9900 (92.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4541/5066 (89.6368%), train_poison_data_count: 400
Global model norm: 43.721251715412954.
Norm before scaling: 43.721903645637816. Distance: 2.2054321977895013
Total norm for 4 adversaries is: 43.721903645637816. distance: 2.2054321977895013
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.3484, Accuracy: 9072/9900 (91.6364%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4616/5116 (90.2267%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4550/5116 (88.9367%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9679, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4134/4662 (88.6744%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4252/4662 (91.2055%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9964, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5181/5902 (87.7838%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5119/5902 (86.7333%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4246, Accuracy: 4888/10000 (48.8800%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4430/5063 (87.4975%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4475/5063 (88.3863%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3149, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4025/4354 (92.4437%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0160, Accuracy: 3127/4354 (71.8190%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 3.0916, Accuracy: 3811/10000 (38.1100%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4621/5195 (88.9509%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4662/5195 (89.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0981, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4012/4356 (92.1028%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3773/4356 (86.6162%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4025, Accuracy: 4898/10000 (48.9800%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3863/4295 (89.9418%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3813/4295 (88.7776%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0440, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5701/6263 (91.0267%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5731/6263 (91.5057%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1448, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4008/4511 (88.8495%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4087/4511 (90.6008%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9667, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4280/4663 (91.7864%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4355/4663 (93.3948%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9695, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3845/4336 (88.6762%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3978/4336 (91.7435%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1191, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4290/4928 (87.0536%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4392/4928 (89.1234%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0520, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3738/4046 (92.3875%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3799/4046 (93.8952%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9449, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3302/3672 (89.9237%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3350/3672 (91.2309%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9385, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3943/4356 (90.5188%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3996/4356 (91.7355%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1760, Accuracy: 5281/10000 (52.8100%)
time spent on training: 268.01022362709045
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.5051, Accuracy: 6458/10000 (64.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 8.5256, Accuracy: 407/9900 (4.1111%)
Done in 296.8351945877075 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4467/4885 (91.4432%), train_poison_data_count: 385
Global model norm: 43.74711346504404.
Norm before scaling: 43.746415868813614. Distance: 2.0784122584004217
Total norm for 4 adversaries is: 43.746415868813614. distance: 2.0784122584004217
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2100, Accuracy: 9390/9900 (94.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 43.74711346504404.
Norm before scaling: 43.748604888470446. Distance: 2.233724112507433
Total norm for 4 adversaries is: 43.748604888470446. distance: 2.233724112507433
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1528, Accuracy: 9519/9900 (96.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4264/4717 (90.3964%), train_poison_data_count: 370
Global model norm: 43.74711346504404.
Norm before scaling: 43.741882617485444. Distance: 2.0653473821884174
Total norm for 4 adversaries is: 43.741882617485444. distance: 2.0653473821884174
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1994, Accuracy: 9407/9900 (95.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 43.74711346504404.
Norm before scaling: 43.749115504451915. Distance: 2.231741360114026
Total norm for 4 adversaries is: 43.749115504451915. distance: 2.231741360114026
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2085, Accuracy: 9384/9900 (94.7879%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4474/5037 (88.8227%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4653/5037 (92.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9378, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4213/4647 (90.6606%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4242/4647 (91.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9425, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4261/4663 (91.3789%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4301/4663 (92.2368%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0306, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3887/4336 (89.6448%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3919/4336 (90.3828%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0676, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3481/3756 (92.6784%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3597/3756 (95.7668%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8434, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4017/4625 (86.8541%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4078/4625 (88.1730%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0661, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3951/4362 (90.5777%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4027/4362 (92.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0811, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4327/4874 (88.7772%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4334/4874 (88.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1250, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4195/4767 (88.0008%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4275/4767 (89.6790%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2221, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3463/3775 (91.7351%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3587/3775 (95.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8021, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4172/4662 (89.4895%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4204/4662 (90.1759%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0461, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5357/6124 (87.4755%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5432/6124 (88.7002%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9207, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3992/4511 (88.4948%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4117/4511 (91.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9044, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3521/3911 (90.0281%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3484/3911 (89.0821%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9478, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5106/5591 (91.3253%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5130/5591 (91.7546%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1010, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3731/4126 (90.4266%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3792/4126 (91.9050%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8776, Accuracy: 5691/10000 (56.9100%)
time spent on training: 264.9177098274231
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.5121, Accuracy: 6426/10000 (64.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 8.6785, Accuracy: 351/9900 (3.5455%)
Done in 293.7749183177948 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4433/4885 (90.7472%), train_poison_data_count: 385
Global model norm: 43.770094436637756.
Norm before scaling: 43.767661055816944. Distance: 2.088929962313522
Total norm for 4 adversaries is: 43.767661055816944. distance: 2.088929962313522
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1408, Accuracy: 9555/9900 (96.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 43.770094436637756.
Norm before scaling: 43.772321314744666. Distance: 2.2399094336797742
Total norm for 4 adversaries is: 43.772321314744666. distance: 2.2399094336797742
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1883, Accuracy: 9448/9900 (95.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 43.770094436637756.
Norm before scaling: 43.768252330991864. Distance: 2.084364051160981
Total norm for 4 adversaries is: 43.768252330991864. distance: 2.084364051160981
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1179, Accuracy: 9558/9900 (96.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 43.770094436637756.
Norm before scaling: 43.77319976398944. Distance: 2.204634778144644
Total norm for 4 adversaries is: 43.77319976398944. distance: 2.204634778144644
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.2397, Accuracy: 9266/9900 (93.5960%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4604/5025 (91.6219%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4640/5025 (92.3383%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0738, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4556/5116 (89.0539%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4587/5116 (89.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0750, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4603/5167 (89.0846%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4694/5167 (90.8458%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0951, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4065/4558 (89.1839%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4055/4558 (88.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1047, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4184/4651 (89.9591%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4183/4651 (89.9376%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1465, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3893/4336 (89.7832%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3939/4336 (90.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9956, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4573/5055 (90.4649%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4615/5055 (91.2957%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8968, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3528/3775 (93.4570%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3585/3775 (94.9669%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7831, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4674/5265 (88.7749%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4695/5265 (89.1738%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0011, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3651/4025 (90.7081%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3736/4025 (92.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9152, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4430/4989 (88.7953%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4393/4989 (88.0537%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9942, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4363/4793 (91.0286%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4435/4793 (92.5308%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8781, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3432/3804 (90.2208%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3528/3804 (92.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9406, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3428/3797 (90.2818%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3493/3797 (91.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0385, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4038/4433 (91.0896%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4081/4433 (92.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8805, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4298/4707 (91.3108%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4350/4707 (92.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8975, Accuracy: 5637/10000 (56.3700%)
time spent on training: 266.1447112560272
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.5136, Accuracy: 6446/10000 (64.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 8.5633, Accuracy: 318/9900 (3.2121%)
Done in 294.83334612846375 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4464/4885 (91.3818%), train_poison_data_count: 385
Global model norm: 43.797114697881355.
Norm before scaling: 43.79521240823947. Distance: 2.054636559380709
Total norm for 4 adversaries is: 43.79521240823947. distance: 2.054636559380709
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1777, Accuracy: 9473/9900 (95.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4813/5305 (90.7257%), train_poison_data_count: 415
Global model norm: 43.797114697881355.
Norm before scaling: 43.79596915313668. Distance: 2.200423620360249
Total norm for 4 adversaries is: 43.79596915313668. distance: 2.200423620360249
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1051, Accuracy: 9632/9900 (97.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 43.797114697881355.
Norm before scaling: 43.79163476499393. Distance: 1.9571565447081065
Total norm for 4 adversaries is: 43.79163476499393. distance: 1.9571565447081065
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.4669, Accuracy: 8844/9900 (89.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4546/5066 (89.7355%), train_poison_data_count: 400
Global model norm: 43.797114697881355.
Norm before scaling: 43.79973038542518. Distance: 2.2278540362240906
Total norm for 4 adversaries is: 43.79973038542518. distance: 2.2278540362240906
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2623, Accuracy: 9253/9900 (93.4646%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4849/5392 (89.9295%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4867/5392 (90.2634%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1235, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4233/4663 (90.7785%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4345/4663 (93.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0119, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3446/3797 (90.7559%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3424/3797 (90.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0417, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5048/5582 (90.4335%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5094/5582 (91.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1168, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4617/5167 (89.3555%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4690/5167 (90.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0521, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3391/3781 (89.6853%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3334/3781 (88.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1458, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3541/3969 (89.2164%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3636/3969 (91.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0875, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3464/3837 (90.2789%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3561/3837 (92.8069%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8414, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5218/5902 (88.4107%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5177/5902 (87.7160%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1967, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4929/5455 (90.3575%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4939/5455 (90.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0325, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4527/5037 (89.8749%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4513/5037 (89.5970%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9414, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4538/5017 (90.4525%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4603/5017 (91.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0086, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4495/4986 (90.1524%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4517/4986 (90.5937%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9857, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4658/5197 (89.6286%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4574/5197 (88.0123%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1744, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3955/4361 (90.6902%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3767/4361 (86.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3225, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5729/6263 (91.4737%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5772/6263 (92.1603%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9149, Accuracy: 5643/10000 (56.4300%)
time spent on training: 271.2340726852417
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.5092, Accuracy: 6465/10000 (64.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 8.5691, Accuracy: 294/9900 (2.9697%)
Done in 300.1926109790802 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4474/4885 (91.5865%), train_poison_data_count: 385
Global model norm: 43.83070959402352.
Norm before scaling: 43.824587646912036. Distance: 2.027971174287306
Total norm for 4 adversaries is: 43.824587646912036. distance: 2.027971174287306
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1014, Accuracy: 9626/9900 (97.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4818/5305 (90.8200%), train_poison_data_count: 415
Global model norm: 43.83070959402352.
Norm before scaling: 43.826130747855494. Distance: 2.1756426289366635
Total norm for 4 adversaries is: 43.826130747855494. distance: 2.1756426289366635
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0807, Accuracy: 9690/9900 (97.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 43.83070959402352.
Norm before scaling: 43.82253195150441. Distance: 1.9628843696456608
Total norm for 4 adversaries is: 43.82253195150441. distance: 1.9628843696456608
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1138, Accuracy: 9600/9900 (96.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4593/5066 (90.6632%), train_poison_data_count: 400
Global model norm: 43.83070959402352.
Norm before scaling: 43.82632572064278. Distance: 2.13096219801614
Total norm for 4 adversaries is: 43.82632572064278. distance: 2.13096219801614
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2813, Accuracy: 9169/9900 (92.6162%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4589/5017 (91.4690%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4629/5017 (92.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7326, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4374/4928 (88.7581%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4459/4928 (90.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0235, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3791/4184 (90.6071%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3807/4184 (90.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8831, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4367/4793 (91.1120%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4413/4793 (92.0718%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0876, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5099/5740 (88.8328%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5166/5740 (90.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1421, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3509/3756 (93.4239%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3553/3756 (94.5953%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8797, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3856/4235 (91.0508%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3801/4235 (89.7521%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9319, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3824/4223 (90.5517%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3928/4223 (93.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8402, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4399/5063 (86.8852%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4294/5063 (84.8114%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1687, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4403/4989 (88.2542%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4451/4989 (89.2163%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9357, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4413/4928 (89.5495%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4428/4928 (89.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0336, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5220/5902 (88.4446%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5151/5902 (87.2755%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2967, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4136/4456 (92.8187%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4179/4456 (93.7837%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7901, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5383/6124 (87.9001%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5412/6124 (88.3736%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0356, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3544/3828 (92.5810%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3584/3828 (93.6259%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8054, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3241/3616 (89.6294%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3314/3616 (91.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7915, Accuracy: 5857/10000 (58.5700%)
time spent on training: 260.59555172920227
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.4526, Accuracy: 6549/10000 (65.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 8.8862, Accuracy: 219/9900 (2.2121%)
Done in 289.25731563568115 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4480/4885 (91.7093%), train_poison_data_count: 385
Global model norm: 43.84908979421637.
Norm before scaling: 43.84586873444435. Distance: 2.0422251060893486
Total norm for 4 adversaries is: 43.84586873444435. distance: 2.0422251060893486
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2326, Accuracy: 9366/9900 (94.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4825/5305 (90.9519%), train_poison_data_count: 415
Global model norm: 43.84908979421637.
Norm before scaling: 43.84566967242532. Distance: 2.163149313934713
Total norm for 4 adversaries is: 43.84566967242532. distance: 2.163149313934713
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2075, Accuracy: 9373/9900 (94.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 43.84908979421637.
Norm before scaling: 43.84450033882172. Distance: 2.0163104643863616
Total norm for 4 adversaries is: 43.84450033882172. distance: 2.0163104643863616
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1799, Accuracy: 9431/9900 (95.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4577/5066 (90.3474%), train_poison_data_count: 400
Global model norm: 43.84908979421637.
Norm before scaling: 43.85056661415919. Distance: 2.176729553778551
Total norm for 4 adversaries is: 43.85056661415919. distance: 2.176729553778551
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2802, Accuracy: 9226/9900 (93.1919%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3780/4223 (89.5098%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3942/4223 (93.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9488, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3992/4362 (91.5177%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3939/4362 (90.3026%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0408, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5593/6391 (87.5137%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5561/6391 (87.0130%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2040, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4347/4793 (90.6948%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4401/4793 (91.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1033, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3497/3756 (93.1044%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3580/3756 (95.3142%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8533, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4165/4618 (90.1906%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4097/4618 (88.7181%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0024, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3606/4025 (89.5901%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3744/4025 (93.0186%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8640, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3228/3638 (88.7301%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3332/3638 (91.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8398, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3937/4315 (91.2399%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3996/4315 (92.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8505, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3885/4295 (90.4540%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3686/4295 (85.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1668, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4427/4928 (89.8336%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4474/4928 (90.7873%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0237, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4513/4986 (90.5134%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4584/4986 (91.9374%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9851, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3779/4126 (91.5899%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3822/4126 (92.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7798, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4525/4918 (92.0089%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4542/4918 (92.3546%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1289, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4581/5195 (88.1809%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4573/5195 (88.0269%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1635, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5116/5740 (89.1289%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5187/5740 (90.3659%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1242, Accuracy: 5305/10000 (53.0500%)
time spent on training: 261.5403997898102
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.4506, Accuracy: 6539/10000 (65.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 9.1426, Accuracy: 185/9900 (1.8687%)
Done in 290.4032926559448 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 43.88585630689075.
Norm before scaling: 43.87958626537302. Distance: 2.0087214093645374
Total norm for 4 adversaries is: 43.87958626537302. distance: 2.0087214093645374
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1381, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4831/5305 (91.0650%), train_poison_data_count: 415
Global model norm: 43.88585630689075.
Norm before scaling: 43.882238763607425. Distance: 2.1752190402876628
Total norm for 4 adversaries is: 43.882238763607425. distance: 2.1752190402876628
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1993, Accuracy: 9395/9900 (94.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 43.88585630689075.
Norm before scaling: 43.877985230530186. Distance: 1.9573850635484484
Total norm for 4 adversaries is: 43.877985230530186. distance: 1.9573850635484484
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.4016, Accuracy: 8963/9900 (90.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4548/5066 (89.7750%), train_poison_data_count: 400
Global model norm: 43.88585630689075.
Norm before scaling: 43.89003120148341. Distance: 2.259250592068629
Total norm for 4 adversaries is: 43.89003120148341. distance: 2.259250592068629
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2606, Accuracy: 9242/9900 (93.3535%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2989/3297 (90.6582%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3064/3297 (92.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7228, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3503/3828 (91.5099%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3583/3828 (93.5998%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8503, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4410/5063 (87.1025%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4325/5063 (85.4237%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0582, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3994/4501 (88.7358%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4009/4501 (89.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0397, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4333/4793 (90.4027%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4381/4793 (91.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0177, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3840/4223 (90.9306%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3926/4223 (92.9671%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8681, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3535/3756 (94.1161%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3577/3756 (95.2343%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8115, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3257/3638 (89.5272%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3342/3638 (91.8637%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7880, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3229/3646 (88.5628%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3302/3646 (90.5650%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9607, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4347/4874 (89.1875%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4319/4874 (88.6130%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0681, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5776/6263 (92.2242%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5825/6263 (93.0065%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9647, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4494/5037 (89.2198%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4529/5037 (89.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9377, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3993/4362 (91.5406%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3936/4362 (90.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0641, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4012/4356 (92.1028%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3946/4356 (90.5877%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0417, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4560/5116 (89.1321%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4560/5116 (89.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9301, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3974/4346 (91.4404%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4044/4346 (93.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8987, Accuracy: 5678/10000 (56.7800%)
time spent on training: 263.7792525291443
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.4603, Accuracy: 6541/10000 (65.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 9.0890, Accuracy: 193/9900 (1.9495%)
Done in 292.3048059940338 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 43.907901436913946.
Norm before scaling: 43.90236442993774. Distance: 2.0511626551952498
Total norm for 4 adversaries is: 43.90236442993774. distance: 2.0511626551952498
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1486, Accuracy: 9529/9900 (96.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 43.907901436913946.
Norm before scaling: 43.903583660142424. Distance: 2.140408470173264
Total norm for 4 adversaries is: 43.903583660142424. distance: 2.140408470173264
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.3493, Accuracy: 9074/9900 (91.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4306/4717 (91.2868%), train_poison_data_count: 370
Global model norm: 43.907901436913946.
Norm before scaling: 43.90079898324389. Distance: 1.950363220719096
Total norm for 4 adversaries is: 43.90079898324389. distance: 1.950363220719096
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.3704, Accuracy: 9006/9900 (90.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 43.907901436913946.
Norm before scaling: 43.907975110682486. Distance: 2.1777941503147216
Total norm for 4 adversaries is: 43.907975110682486. distance: 2.1777941503147216
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2093, Accuracy: 9354/9900 (94.4848%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4102/4518 (90.7924%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4152/4518 (91.8991%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8934, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4019/4558 (88.1746%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4077/4558 (89.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1121, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3478/3804 (91.4301%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3511/3804 (92.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8971, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3472/3775 (91.9735%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3600/3775 (95.3642%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.6979, Accuracy: 6049/10000 (60.4900%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4545/5083 (89.4157%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4515/5083 (88.8255%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0128, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4434/4928 (89.9756%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4537/4928 (92.0657%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8753, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4549/5244 (86.7468%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4527/5244 (86.3272%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1528, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4398/4989 (88.1539%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4510/4989 (90.3989%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9480, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4544/4986 (91.1352%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4555/4986 (91.3558%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9266, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3765/4175 (90.1796%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3788/4175 (90.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9815, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4661/5232 (89.0864%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4645/5232 (88.7806%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1340, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4470/5063 (88.2876%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4336/5063 (85.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1421, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4101/4441 (92.3441%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4166/4441 (93.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0236, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3278/3646 (89.9067%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3354/3646 (91.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8158, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4615/5167 (89.3168%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4732/5167 (91.5812%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2197, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4144/4538 (91.3178%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4164/4538 (91.7585%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8996, Accuracy: 5560/10000 (55.6000%)
time spent on training: 261.2794461250305
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.4534, Accuracy: 6522/10000 (65.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 9.0366, Accuracy: 189/9900 (1.9091%)
Done in 290.12655544281006 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4496/4885 (92.0368%), train_poison_data_count: 385
Global model norm: 43.932291821033395.
Norm before scaling: 43.92516691016595. Distance: 1.9999535674427245
Total norm for 4 adversaries is: 43.92516691016595. distance: 1.9999535674427245
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.2151, Accuracy: 9379/9900 (94.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4862/5305 (91.6494%), train_poison_data_count: 415
Global model norm: 43.932291821033395.
Norm before scaling: 43.9246486139545. Distance: 2.1201582333155358
Total norm for 4 adversaries is: 43.9246486139545. distance: 2.1201582333155358
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1087, Accuracy: 9645/9900 (97.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 43.932291821033395.
Norm before scaling: 43.9291796776179. Distance: 2.081539360757341
Total norm for 4 adversaries is: 43.9291796776179. distance: 2.081539360757341
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1547, Accuracy: 9525/9900 (96.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4549/5066 (89.7947%), train_poison_data_count: 400
Global model norm: 43.932291821033395.
Norm before scaling: 43.92986186720685. Distance: 2.152179801775382
Total norm for 4 adversaries is: 43.92986186720685. distance: 2.152179801775382
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1367, Accuracy: 9548/9900 (96.4444%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4038/4356 (92.6997%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3981/4356 (91.3912%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0926, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4375/4928 (88.7784%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4396/4928 (89.2045%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9728, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4490/5037 (89.1404%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4577/5037 (90.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9245, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4380/4804 (91.1740%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4198/4804 (87.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3071, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3521/3775 (93.2715%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3599/3775 (95.3377%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7801, Accuracy: 5937/10000 (59.3700%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4656/5167 (90.1103%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4679/5167 (90.5554%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1539, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3836/4235 (90.5785%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3911/4235 (92.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9172, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4356/4956 (87.8935%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4400/4956 (88.7813%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0156, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5302/5740 (92.3693%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5325/5740 (92.7700%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9541, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4262/4679 (91.0878%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4243/4679 (90.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1312, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3411/3704 (92.0896%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3473/3704 (93.7635%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7639, Accuracy: 5954/10000 (59.5400%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3191/3472 (91.9067%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3207/3472 (92.3675%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9941, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4166/4651 (89.5721%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4217/4651 (90.6687%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1183, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4122/4634 (88.9512%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4160/4634 (89.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8872, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5195/5902 (88.0210%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5091/5902 (86.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1332, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3480/3837 (90.6959%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3595/3837 (93.6930%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8949, Accuracy: 5710/10000 (57.1000%)
time spent on training: 264.7468218803406
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.4707, Accuracy: 6474/10000 (64.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 9.1686, Accuracy: 153/9900 (1.5455%)
Done in 293.88304805755615 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4488/4885 (91.8731%), train_poison_data_count: 385
Global model norm: 43.952870877775865.
Norm before scaling: 43.94757285853509. Distance: 2.010120890573614
Total norm for 4 adversaries is: 43.94757285853509. distance: 2.010120890573614
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2857, Accuracy: 9232/9900 (93.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4823/5305 (90.9142%), train_poison_data_count: 415
Global model norm: 43.952870877775865.
Norm before scaling: 43.94774923799781. Distance: 2.1549087997220737
Total norm for 4 adversaries is: 43.94774923799781. distance: 2.1549087997220737
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1653, Accuracy: 9504/9900 (96.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4313/4717 (91.4352%), train_poison_data_count: 370
Global model norm: 43.952870877775865.
Norm before scaling: 43.94599930018872. Distance: 1.9919122842411916
Total norm for 4 adversaries is: 43.94599930018872. distance: 1.9919122842411916
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2122, Accuracy: 9362/9900 (94.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4531/5066 (89.4394%), train_poison_data_count: 400
Global model norm: 43.952870877775865.
Norm before scaling: 43.954698303249536. Distance: 2.28757081886272
Total norm for 4 adversaries is: 43.954698303249536. distance: 2.28757081886272
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1714, Accuracy: 9496/9900 (95.9192%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3563/3969 (89.7707%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3626/3969 (91.3580%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9488, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4380/4707 (93.0529%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4375/4707 (92.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8436, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3618/3861 (93.7063%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3599/3861 (93.2142%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8839, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4149/4596 (90.2742%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4265/4596 (92.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9593, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4056/4503 (90.0733%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4063/4503 (90.2287%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1770, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4427/4928 (89.8336%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4491/4928 (91.1323%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9099, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4567/5025 (90.8856%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4551/5025 (90.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0212, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4161/4576 (90.9309%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4198/4576 (91.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9192, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4519/4918 (91.8869%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4582/4918 (93.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8191, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3962/4315 (91.8192%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3981/4315 (92.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9008, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3336/3590 (92.9248%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3370/3590 (93.8719%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9519, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4120/4456 (92.4596%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4126/4456 (92.5943%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0864, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4003/4354 (91.9384%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3844/4354 (88.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3640, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4021/4501 (89.3357%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3995/4501 (88.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0784, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3485/3911 (89.1076%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3540/3911 (90.5139%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9113, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4076/4558 (89.4252%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4077/4558 (89.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0531, Accuracy: 5311/10000 (53.1100%)
time spent on training: 262.31400895118713
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.4790, Accuracy: 6456/10000 (64.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 9.3184, Accuracy: 158/9900 (1.5960%)
Done in 291.3412232398987 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4501/4885 (92.1392%), train_poison_data_count: 385
Global model norm: 43.98352574668583.
Norm before scaling: 43.97891423694925. Distance: 2.018393219873907
Total norm for 4 adversaries is: 43.97891423694925. distance: 2.018393219873907
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.3270, Accuracy: 9113/9900 (92.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 43.98352574668583.
Norm before scaling: 43.97836604158345. Distance: 2.1637824252567763
Total norm for 4 adversaries is: 43.97836604158345. distance: 2.1637824252567763
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1905, Accuracy: 9429/9900 (95.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4315/4717 (91.4776%), train_poison_data_count: 370
Global model norm: 43.98352574668583.
Norm before scaling: 43.97818284565939. Distance: 2.000928305718434
Total norm for 4 adversaries is: 43.97818284565939. distance: 2.000928305718434
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1568, Accuracy: 9502/9900 (95.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4595/5066 (90.7027%), train_poison_data_count: 400
Global model norm: 43.98352574668583.
Norm before scaling: 43.98295263019881. Distance: 2.1785219419161037
Total norm for 4 adversaries is: 43.98295263019881. distance: 2.1785219419161037
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2042, Accuracy: 9372/9900 (94.6667%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4620/5116 (90.3049%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4611/5116 (90.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1212, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4879/5392 (90.4859%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4791/5392 (88.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1077, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4238/4767 (88.9029%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4258/4767 (89.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1869, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4197/4618 (90.8835%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4204/4618 (91.0351%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0871, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3752/4046 (92.7336%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3784/4046 (93.5245%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9380, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4069/4625 (87.9784%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4105/4625 (88.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1348, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3261/3638 (89.6372%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3398/3638 (93.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8461, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3893/4416 (88.1567%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3969/4416 (89.8777%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9759, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4342/4874 (89.0849%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4280/4874 (87.8129%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2076, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3281/3646 (89.9890%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3317/3646 (90.9764%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8043, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4432/5063 (87.5370%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4309/5063 (85.1076%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0677, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3806/4126 (92.2443%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3908/4126 (94.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8505, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4441/4934 (90.0081%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4415/4934 (89.4812%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1684, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4046/4511 (89.6919%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4072/4511 (90.2682%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0117, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4091/4518 (90.5489%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4211/4518 (93.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9695, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3015/3297 (91.4468%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3044/3297 (92.3264%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7912, Accuracy: 5752/10000 (57.5200%)
time spent on training: 263.19278931617737
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.4615, Accuracy: 6450/10000 (64.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 9.2679, Accuracy: 148/9900 (1.4949%)
Done in 291.8803987503052 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 44.00098348732176.
Norm before scaling: 43.99837837698894. Distance: 2.0780043029153163
Total norm for 4 adversaries is: 43.99837837698894. distance: 2.0780043029153163
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1020, Accuracy: 9640/9900 (97.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4828/5305 (91.0085%), train_poison_data_count: 415
Global model norm: 44.00098348732176.
Norm before scaling: 43.99841028289403. Distance: 2.1831662436847767
Total norm for 4 adversaries is: 43.99841028289403. distance: 2.1831662436847767
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1141, Accuracy: 9620/9900 (97.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4306/4717 (91.2868%), train_poison_data_count: 370
Global model norm: 44.00098348732176.
Norm before scaling: 43.992257564098. Distance: 1.964082908069129
Total norm for 4 adversaries is: 43.992257564098. distance: 1.964082908069129
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.3271, Accuracy: 9090/9900 (91.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4606/5066 (90.9199%), train_poison_data_count: 400
Global model norm: 44.00098348732176.
Norm before scaling: 43.99799827877471. Distance: 2.1820913752471456
Total norm for 4 adversaries is: 43.99799827877471. distance: 2.1820913752471456
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2184, Accuracy: 9375/9900 (94.6970%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5475/6124 (89.4024%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5454/6124 (89.0594%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9047, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4522/5025 (89.9900%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4607/5025 (91.6816%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1123, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3181/3472 (91.6187%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3157/3472 (90.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0580, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4543/5037 (90.1926%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4618/5037 (91.6816%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9994, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5102/5582 (91.4009%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5073/5582 (90.8814%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1290, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4604/5116 (89.9922%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4591/5116 (89.7381%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1016, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4082/4518 (90.3497%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4160/4518 (92.0761%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9332, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4341/4928 (88.0885%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4461/4928 (90.5235%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8999, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4158/4558 (91.2242%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4075/4558 (89.4032%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0017, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3081/3297 (93.4486%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3111/3297 (94.3585%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.7141, Accuracy: 6041/10000 (60.4100%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3520/3756 (93.7167%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3570/3756 (95.0479%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9352, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4194/4651 (90.1742%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4250/4651 (91.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0289, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4044/4441 (91.0606%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4132/4441 (93.0421%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9819, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3253/3638 (89.4173%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3314/3638 (91.0940%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8599, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4178/4596 (90.9051%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4218/4596 (91.7755%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0441, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2918/3271 (89.2082%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2955/3271 (90.3393%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8168, Accuracy: 5780/10000 (57.8000%)
time spent on training: 258.8651204109192
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.4569, Accuracy: 6479/10000 (64.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 9.3977, Accuracy: 116/9900 (1.1717%)
Done in 287.7167453765869 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4479/4885 (91.6888%), train_poison_data_count: 385
Global model norm: 44.01979451985564.
Norm before scaling: 44.01510083553711. Distance: 2.0159028327549966
Total norm for 4 adversaries is: 44.01510083553711. distance: 2.0159028327549966
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.4780, Accuracy: 8745/9900 (88.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 44.01979451985564.
Norm before scaling: 44.01646115419847. Distance: 2.1693645211298884
Total norm for 4 adversaries is: 44.01646115419847. distance: 2.1693645211298884
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0470, Accuracy: 9767/9900 (98.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4260/4717 (90.3116%), train_poison_data_count: 370
Global model norm: 44.01979451985564.
Norm before scaling: 44.01426742892227. Distance: 2.0534285833304207
Total norm for 4 adversaries is: 44.01426742892227. distance: 2.0534285833304207
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1555, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4634/5066 (91.4726%), train_poison_data_count: 400
Global model norm: 44.01979451985564.
Norm before scaling: 44.013813971439696. Distance: 2.114256459295179
Total norm for 4 adversaries is: 44.013813971439696. distance: 2.114256459295179
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2335, Accuracy: 9305/9900 (93.9899%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4468/4989 (89.5570%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4517/4989 (90.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9705, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4135/4465 (92.6092%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4150/4465 (92.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8250, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3947/4315 (91.4716%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3962/4315 (91.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8600, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4255/4767 (89.2595%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4258/4767 (89.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2261, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5603/6391 (87.6702%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5567/6391 (87.1069%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1694, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3306/3672 (90.0327%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3302/3672 (89.9237%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9255, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3601/3969 (90.7281%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3580/3969 (90.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0169, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3361/3590 (93.6212%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3241/3590 (90.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1120, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5236/5902 (88.7157%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5116/5902 (86.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2675, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3717/4013 (92.6240%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3778/4013 (94.1440%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7357, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4383/4804 (91.2365%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4087/4804 (85.0749%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3357, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3743/4175 (89.6527%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3714/4175 (88.9581%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0816, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3309/3616 (91.5100%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3367/3616 (93.1139%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8357, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3963/4361 (90.8737%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3861/4361 (88.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0680, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4939/5424 (91.0583%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5019/5424 (92.5332%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1605, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3567/3837 (92.9633%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3628/3837 (94.5530%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8842, Accuracy: 5735/10000 (57.3500%)
time spent on training: 264.1988437175751
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.5187, Accuracy: 6356/10000 (63.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 9.2781, Accuracy: 133/9900 (1.3434%)
Done in 292.758118391037 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4510/4885 (92.3234%), train_poison_data_count: 385
Global model norm: 44.03839655452671.
Norm before scaling: 44.030659484152345. Distance: 2.000457353750893
Total norm for 4 adversaries is: 44.030659484152345. distance: 2.000457353750893
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2197, Accuracy: 9370/9900 (94.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4826/5305 (90.9708%), train_poison_data_count: 415
Global model norm: 44.03839655452671.
Norm before scaling: 44.0345850183055. Distance: 2.1720207769197546
Total norm for 4 adversaries is: 44.0345850183055. distance: 2.1720207769197546
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.4486, Accuracy: 8813/9900 (89.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4326/4717 (91.7108%), train_poison_data_count: 370
Global model norm: 44.03839655452671.
Norm before scaling: 44.032684671002485. Distance: 1.9549270861167893
Total norm for 4 adversaries is: 44.032684671002485. distance: 1.9549270861167893
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.4107, Accuracy: 8930/9900 (90.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4591/5066 (90.6238%), train_poison_data_count: 400
Global model norm: 44.03839655452671.
Norm before scaling: 44.03320169556718. Distance: 2.141894110490572
Total norm for 4 adversaries is: 44.03320169556718. distance: 2.141894110490572
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2424, Accuracy: 9247/9900 (93.4040%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3839/4416 (86.9339%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3970/4416 (89.9004%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9563, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5242/5740 (91.3240%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5261/5740 (91.6551%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0436, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4539/5037 (90.1132%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4644/5037 (92.1977%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0342, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4577/5116 (89.4644%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4575/5116 (89.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8887, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4492/4918 (91.3379%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4555/4918 (92.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9074, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3612/3837 (94.1360%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3672/3837 (95.6998%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8159, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4168/4651 (89.6151%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4244/4651 (91.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0029, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3585/3861 (92.8516%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3590/3861 (92.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8426, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3851/4223 (91.1911%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3962/4223 (93.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8340, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4220/4662 (90.5191%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4302/4662 (92.2780%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9508, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5820/6263 (92.9267%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5805/6263 (92.6872%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9969, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3424/3781 (90.5581%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3179/3781 (84.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3163, Accuracy: 4951/10000 (49.5100%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3465/3804 (91.0883%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3479/3804 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9773, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3562/3828 (93.0512%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3580/3828 (93.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7891, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3956/4315 (91.6802%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3993/4315 (92.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8881, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4372/4956 (88.2163%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4461/4956 (90.0121%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9585, Accuracy: 5574/10000 (55.7400%)
time spent on training: 265.2542767524719
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.5058, Accuracy: 6397/10000 (63.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 9.0122, Accuracy: 178/9900 (1.7980%)
Done in 293.9988453388214 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4479/4885 (91.6888%), train_poison_data_count: 385
Global model norm: 44.07092395095234.
Norm before scaling: 44.063628919491954. Distance: 2.032957445118645
Total norm for 4 adversaries is: 44.063628919491954. distance: 2.032957445118645
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1228, Accuracy: 9596/9900 (96.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4823/5305 (90.9142%), train_poison_data_count: 415
Global model norm: 44.07092395095234.
Norm before scaling: 44.067580602482025. Distance: 2.166761677443922
Total norm for 4 adversaries is: 44.067580602482025. distance: 2.166761677443922
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0933, Accuracy: 9667/9900 (97.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 44.07092395095234.
Norm before scaling: 44.06861382672905. Distance: 2.0186775218129203
Total norm for 4 adversaries is: 44.06861382672905. distance: 2.0186775218129203
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1412, Accuracy: 9572/9900 (96.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4614/5066 (91.0778%), train_poison_data_count: 400
Global model norm: 44.07092395095234.
Norm before scaling: 44.06759999297245. Distance: 2.109223989096853
Total norm for 4 adversaries is: 44.06759999297245. distance: 2.109223989096853
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2272, Accuracy: 9349/9900 (94.4343%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4192/4662 (89.9185%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4231/4662 (90.7550%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0240, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3312/3616 (91.5929%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3322/3616 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8185, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3524/3828 (92.0585%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3578/3828 (93.4692%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9338, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3061/3297 (92.8420%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3079/3297 (93.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7623, Accuracy: 5954/10000 (59.5400%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3989/4361 (91.4698%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3832/4361 (87.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9954, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4176/4576 (91.2587%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4192/4576 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8676, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3898/4295 (90.7567%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3745/4295 (87.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0700, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4520/5083 (88.9239%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4507/5083 (88.6681%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0537, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4583/5116 (89.5817%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4624/5116 (90.3831%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0842, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3738/4046 (92.3875%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3782/4046 (93.4750%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8720, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5186/5902 (87.8685%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5070/5902 (85.9031%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2254, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4721/5197 (90.8409%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4651/5197 (89.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1056, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4129/4465 (92.4748%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4176/4465 (93.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7846, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3399/3704 (91.7657%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3497/3704 (94.4114%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7427, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3602/3861 (93.2919%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3633/3861 (94.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8114, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3791/4126 (91.8808%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3866/4126 (93.6985%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8658, Accuracy: 5721/10000 (57.2100%)
time spent on training: 260.7130300998688
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.4895, Accuracy: 6421/10000 (64.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 9.0917, Accuracy: 178/9900 (1.7980%)
Done in 289.80402970314026 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4478/4885 (91.6684%), train_poison_data_count: 385
Global model norm: 44.091598880023334.
Norm before scaling: 44.083502862288235. Distance: 2.0373558414690516
Total norm for 4 adversaries is: 44.083502862288235. distance: 2.0373558414690516
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1970, Accuracy: 9395/9900 (94.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4819/5305 (90.8388%), train_poison_data_count: 415
Global model norm: 44.091598880023334.
Norm before scaling: 44.08550347008569. Distance: 2.16036362713186
Total norm for 4 adversaries is: 44.08550347008569. distance: 2.16036362713186
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2177, Accuracy: 9385/9900 (94.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4303/4717 (91.2232%), train_poison_data_count: 370
Global model norm: 44.091598880023334.
Norm before scaling: 44.087832090913274. Distance: 1.997473312791673
Total norm for 4 adversaries is: 44.087832090913274. distance: 1.997473312791673
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1725, Accuracy: 9491/9900 (95.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 44.091598880023334.
Norm before scaling: 44.089575014962435. Distance: 2.1316426740443926
Total norm for 4 adversaries is: 44.089575014962435. distance: 2.1316426740443926
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.4069, Accuracy: 8964/9900 (90.5455%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4069/4511 (90.2017%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4141/4511 (91.7978%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8456, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5247/5740 (91.4111%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5273/5740 (91.8641%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1438, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4270/4662 (91.5916%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4258/4662 (91.3342%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9657, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3849/4235 (90.8855%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3891/4235 (91.8772%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9493, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4741/5265 (90.0475%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4763/5265 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0704, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4074/4433 (91.9016%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4050/4433 (91.3603%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9318, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4168/4596 (90.6876%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4238/4596 (92.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0164, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4621/5055 (91.4144%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4643/5055 (91.8497%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9545, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4498/5037 (89.2992%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4565/5037 (90.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9873, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4236/4538 (93.3451%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4316/4538 (95.1080%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7088, Accuracy: 5971/10000 (59.7100%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3517/3756 (93.6368%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3535/3756 (94.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8381, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3691/4025 (91.7019%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3715/4025 (92.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8400, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4567/5244 (87.0900%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4534/5244 (86.4607%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1600, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4284/4663 (91.8722%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4363/4663 (93.5664%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9975, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3649/3837 (95.1003%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0021, Accuracy: 3686/3837 (96.0646%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.6618, Accuracy: 6083/10000 (60.8300%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3986/4481 (88.9534%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3912/4481 (87.3019%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1958, Accuracy: 5288/10000 (52.8800%)
time spent on training: 263.1299455165863
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.4780, Accuracy: 6421/10000 (64.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 9.2227, Accuracy: 183/9900 (1.8485%)
Done in 291.9192883968353 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4467/4885 (91.4432%), train_poison_data_count: 385
Global model norm: 44.12485061058281.
Norm before scaling: 44.12366101013718. Distance: 2.146293097070555
Total norm for 4 adversaries is: 44.12366101013718. distance: 2.146293097070555
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1549, Accuracy: 9567/9900 (96.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 44.12485061058281.
Norm before scaling: 44.117312704577074. Distance: 2.1605739638017165
Total norm for 4 adversaries is: 44.117312704577074. distance: 2.1605739638017165
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.2512, Accuracy: 9274/9900 (93.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4310/4717 (91.3716%), train_poison_data_count: 370
Global model norm: 44.12485061058281.
Norm before scaling: 44.121792166063614. Distance: 2.031012066330558
Total norm for 4 adversaries is: 44.121792166063614. distance: 2.031012066330558
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1895, Accuracy: 9413/9900 (95.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4589/5066 (90.5843%), train_poison_data_count: 400
Global model norm: 44.12485061058281.
Norm before scaling: 44.12238007891375. Distance: 2.1818620233032404
Total norm for 4 adversaries is: 44.12238007891375. distance: 2.1818620233032404
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1349, Accuracy: 9547/9900 (96.4343%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3991/4362 (91.4947%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3887/4362 (89.1105%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2231, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5100/5591 (91.2180%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5109/5591 (91.3790%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0270, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3955/4315 (91.6570%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3911/4315 (90.6373%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1006, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3444/3781 (91.0870%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3445/3781 (91.1135%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0753, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3718/4158 (89.4180%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3776/4158 (90.8129%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9241, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4061/4511 (90.0244%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4070/4511 (90.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9944, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4383/4793 (91.4459%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4433/4793 (92.4890%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8979, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4991/5424 (92.0170%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5021/5424 (92.5701%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2357, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4167/4618 (90.2339%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4202/4618 (90.9918%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0054, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3939/4368 (90.1786%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3965/4368 (90.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0263, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4422/4934 (89.6230%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0119, Accuracy: 3848/4934 (77.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.4566, Accuracy: 4767/10000 (47.6700%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4671/5232 (89.2775%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4693/5232 (89.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9712, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5260/5902 (89.1223%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5188/5902 (87.9024%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2472, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4840/5392 (89.7626%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4861/5392 (90.1521%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0952, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4596/5017 (91.6085%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4569/5017 (91.0704%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0523, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4652/5195 (89.5476%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4532/5195 (87.2377%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0906, Accuracy: 5378/10000 (53.7800%)
time spent on training: 268.10866475105286
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.5045, Accuracy: 6388/10000 (63.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 8.9250, Accuracy: 226/9900 (2.2828%)
Done in 297.41410636901855 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 44.1616142022154.
Norm before scaling: 44.15653336117502. Distance: 2.0653502681243934
Total norm for 4 adversaries is: 44.15653336117502. distance: 2.0653502681243934
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.3708, Accuracy: 9040/9900 (91.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 44.1616142022154.
Norm before scaling: 44.15503221737232. Distance: 2.118159560132375
Total norm for 4 adversaries is: 44.15503221737232. distance: 2.118159560132375
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.3591, Accuracy: 9045/9900 (91.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4299/4717 (91.1384%), train_poison_data_count: 370
Global model norm: 44.1616142022154.
Norm before scaling: 44.15416965861987. Distance: 2.012229247272562
Total norm for 4 adversaries is: 44.15416965861987. distance: 2.012229247272562
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.4481, Accuracy: 8846/9900 (89.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4629/5066 (91.3739%), train_poison_data_count: 400
Global model norm: 44.1616142022154.
Norm before scaling: 44.15469908369748. Distance: 2.088264453276655
Total norm for 4 adversaries is: 44.15469908369748. distance: 2.088264453276655
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.3322, Accuracy: 9100/9900 (91.9192%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4764/5265 (90.4843%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4748/5265 (90.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9265, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3890/4126 (94.2802%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3914/4126 (94.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7137, Accuracy: 5974/10000 (59.7400%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4060/4501 (90.2022%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4003/4501 (88.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2953, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5450/6124 (88.9941%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5420/6124 (88.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0497, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3013/3271 (92.1125%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2944/3271 (90.0031%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9411, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4237/4663 (90.8643%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4309/4663 (92.4083%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1111, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3679/4025 (91.4037%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3743/4025 (92.9938%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9681, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4211/4651 (90.5397%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4254/4651 (91.4642%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9810, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4349/4804 (90.5287%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4284/4804 (89.1757%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0624, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3320/3616 (91.8142%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3365/3616 (93.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7891, Accuracy: 5925/10000 (59.2500%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3562/3911 (91.0765%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3445/3911 (88.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2599, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4687/5197 (90.1866%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4713/5197 (90.6869%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0481, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4226/4538 (93.1247%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4252/4538 (93.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7977, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5655/6391 (88.4838%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5617/6391 (87.8892%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9632, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3408/3704 (92.0086%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3466/3704 (93.5745%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7585, Accuracy: 5962/10000 (59.6200%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3800/4235 (89.7285%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3755/4235 (88.6659%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1744, Accuracy: 5272/10000 (52.7200%)
time spent on training: 262.1067044734955
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.4949, Accuracy: 6420/10000 (64.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 8.9472, Accuracy: 243/9900 (2.4545%)
Done in 291.2285394668579 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 44.18968926905136.
Norm before scaling: 44.187834267653635. Distance: 2.0991743053960086
Total norm for 4 adversaries is: 44.187834267653635. distance: 2.0991743053960086
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1572, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4840/5305 (91.2347%), train_poison_data_count: 415
Global model norm: 44.18968926905136.
Norm before scaling: 44.18141367648986. Distance: 2.140992404566142
Total norm for 4 adversaries is: 44.18141367648986. distance: 2.140992404566142
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1118, Accuracy: 9625/9900 (97.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 44.18968926905136.
Norm before scaling: 44.18416409128176. Distance: 2.0335030604748177
Total norm for 4 adversaries is: 44.18416409128176. distance: 2.0335030604748177
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.2061, Accuracy: 9400/9900 (94.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 44.18968926905136.
Norm before scaling: 44.18202842493979. Distance: 2.1392463644071933
Total norm for 4 adversaries is: 44.18202842493979. distance: 2.1392463644071933
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.2006, Accuracy: 9409/9900 (95.0404%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4629/5116 (90.4808%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4617/5116 (90.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9323, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5114/5582 (91.6159%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5155/5582 (92.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0485, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3988/4235 (94.1677%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3836/4235 (90.5785%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2586, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4113/4625 (88.9297%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4119/4625 (89.0595%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1223, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4072/4481 (90.8726%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3977/4481 (88.7525%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1683, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4670/5232 (89.2584%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4697/5232 (89.7745%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9228, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4228/4662 (90.6907%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4333/4662 (92.9429%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9540, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4114/4441 (92.6368%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4153/4441 (93.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0731, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4079/4518 (90.2833%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4113/4518 (91.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0375, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4472/4928 (90.7468%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4509/4928 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9007, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4142/4634 (89.3828%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4215/4634 (90.9581%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9735, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4440/4934 (89.9878%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4371/4934 (88.5894%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1557, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3566/3861 (92.3595%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3552/3861 (91.9969%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8638, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3269/3616 (90.4038%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3345/3616 (92.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8647, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3916/4416 (88.6775%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4011/4416 (90.8288%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9933, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3479/3797 (91.6250%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3501/3797 (92.2044%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9709, Accuracy: 5585/10000 (55.8500%)
time spent on training: 259.8628945350647
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.5187, Accuracy: 6372/10000 (63.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 8.9180, Accuracy: 223/9900 (2.2525%)
Done in 288.99940967559814 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 44.210801516180695.
Norm before scaling: 44.20881072040391. Distance: 2.104318506282975
Total norm for 4 adversaries is: 44.20881072040391. distance: 2.104318506282975
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.2022, Accuracy: 9419/9900 (95.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4859/5305 (91.5928%), train_poison_data_count: 415
Global model norm: 44.210801516180695.
Norm before scaling: 44.20372011573588. Distance: 2.1483102101851563
Total norm for 4 adversaries is: 44.20372011573588. distance: 2.1483102101851563
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0802, Accuracy: 9700/9900 (97.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4289/4717 (90.9264%), train_poison_data_count: 370
Global model norm: 44.210801516180695.
Norm before scaling: 44.20524307845168. Distance: 2.0060189990573014
Total norm for 4 adversaries is: 44.20524307845168. distance: 2.0060189990573014
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.2366, Accuracy: 9326/9900 (94.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4634/5066 (91.4726%), train_poison_data_count: 400
Global model norm: 44.210801516180695.
Norm before scaling: 44.202509164144175. Distance: 2.1062798291366533
Total norm for 4 adversaries is: 44.202509164144175. distance: 2.1062798291366533
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.3718, Accuracy: 8980/9900 (90.7071%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5831/6263 (93.1023%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5819/6263 (92.9107%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9801, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3885/4295 (90.4540%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3883/4295 (90.4075%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9863, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4380/4989 (87.7931%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4465/4989 (89.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8531, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3868/4223 (91.5937%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3931/4223 (93.0855%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8543, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5438/6124 (88.7982%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5462/6124 (89.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0367, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4105/4481 (91.6090%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3992/4481 (89.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2861, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4229/4618 (91.5764%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4101/4618 (88.8047%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1567, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4139/4441 (93.1997%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4138/4441 (93.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0875, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3694/4013 (92.0508%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3757/4013 (93.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7847, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4046/4511 (89.6919%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4160/4511 (92.2190%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0253, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3919/4416 (88.7455%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3976/4416 (90.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0354, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4487/4956 (90.5367%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4490/4956 (90.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2147, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4218/4538 (92.9484%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4275/4538 (94.2045%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8556, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4650/5265 (88.3191%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4727/5265 (89.7816%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0840, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4720/5197 (90.8216%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4635/5197 (89.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3040, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4278/4716 (90.7125%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4321/4716 (91.6243%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9926, Accuracy: 5534/10000 (55.3400%)
time spent on training: 268.9033133983612
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.5256, Accuracy: 6358/10000 (63.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 9.0739, Accuracy: 186/9900 (1.8788%)
Done in 297.81882429122925 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4461/4885 (91.3204%), train_poison_data_count: 385
Global model norm: 44.23871981708656.
Norm before scaling: 44.234243917591016. Distance: 2.110425221412344
Total norm for 4 adversaries is: 44.234243917591016. distance: 2.110425221412344
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2055, Accuracy: 9406/9900 (95.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4833/5305 (91.1027%), train_poison_data_count: 415
Global model norm: 44.23871981708656.
Norm before scaling: 44.23361057711093. Distance: 2.184643869947909
Total norm for 4 adversaries is: 44.23361057711093. distance: 2.184643869947909
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2547, Accuracy: 9284/9900 (93.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 44.23871981708656.
Norm before scaling: 44.231307569819116. Distance: 2.0046289044422028
Total norm for 4 adversaries is: 44.231307569819116. distance: 2.0046289044422028
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1690, Accuracy: 9499/9900 (95.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4613/5066 (91.0580%), train_poison_data_count: 400
Global model norm: 44.23871981708656.
Norm before scaling: 44.23253843105421. Distance: 2.152274295080873
Total norm for 4 adversaries is: 44.23253843105421. distance: 2.152274295080873
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2359, Accuracy: 9308/9900 (94.0202%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3307/3616 (91.4546%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3349/3616 (92.6162%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7960, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4010/4315 (92.9316%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4019/4315 (93.1402%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8953, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4988/5455 (91.4390%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4957/5455 (90.8708%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0688, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4380/4804 (91.1740%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4058/4804 (84.4713%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.4042, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3990/4362 (91.4718%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3961/4362 (90.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0154, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5800/6263 (92.6074%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5813/6263 (92.8149%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9927, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4234/4538 (93.3010%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4269/4538 (94.0723%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7852, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4177/4634 (90.1381%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4227/4634 (91.2171%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8311, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4648/5116 (90.8522%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4594/5116 (89.7967%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9457, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4318/4716 (91.5606%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4302/4716 (91.2214%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9043, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3734/4046 (92.2887%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3743/4046 (92.5111%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9314, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4070/4518 (90.0841%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4138/4518 (91.5892%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0087, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4459/5063 (88.0703%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4327/5063 (85.4632%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1571, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5269/5740 (91.7944%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5299/5740 (92.3171%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0726, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5106/5582 (91.4726%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5134/5582 (91.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0352, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4030/4433 (90.9091%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4069/4433 (91.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9416, Accuracy: 5578/10000 (55.7800%)
time spent on training: 266.3257122039795
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.5526, Accuracy: 6298/10000 (62.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 9.0916, Accuracy: 175/9900 (1.7677%)
Done in 295.48520374298096 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 44.26407929484485.
Norm before scaling: 44.25774561446843. Distance: 2.062015129662849
Total norm for 4 adversaries is: 44.25774561446843. distance: 2.062015129662849
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1529, Accuracy: 9536/9900 (96.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4855/5305 (91.5174%), train_poison_data_count: 415
Global model norm: 44.26407929484485.
Norm before scaling: 44.25630720630747. Distance: 2.1381218747336646
Total norm for 4 adversaries is: 44.25630720630747. distance: 2.1381218747336646
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1143, Accuracy: 9587/9900 (96.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4314/4717 (91.4564%), train_poison_data_count: 370
Global model norm: 44.26407929484485.
Norm before scaling: 44.25590449881024. Distance: 2.0335234610463626
Total norm for 4 adversaries is: 44.25590449881024. distance: 2.0335234610463626
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1780, Accuracy: 9476/9900 (95.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4598/5066 (90.7619%), train_poison_data_count: 400
Global model norm: 44.26407929484485.
Norm before scaling: 44.25742428669101. Distance: 2.1485233913938893
Total norm for 4 adversaries is: 44.25742428669101. distance: 2.1485233913938893
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.3229, Accuracy: 9109/9900 (92.0101%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4651/5197 (89.4939%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4513/5197 (86.8386%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1694, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3656/4025 (90.8323%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3768/4025 (93.6149%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8920, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4121/4481 (91.9661%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4022/4481 (89.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2165, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4193/4651 (90.1527%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4202/4651 (90.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9329, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5220/5902 (88.4446%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5166/5902 (87.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0884, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3838/4126 (93.0199%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3876/4126 (93.9409%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7132, Accuracy: 5945/10000 (59.4500%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3945/4368 (90.3159%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3936/4368 (90.1099%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1014, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5663/6391 (88.6090%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5620/6391 (87.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1816, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3741/4175 (89.6048%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3774/4175 (90.3952%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0174, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4170/4596 (90.7311%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4237/4596 (92.1889%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9586, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4165/4634 (89.8792%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4239/4634 (91.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8310, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3857/4223 (91.3332%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3950/4223 (93.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9700, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3520/3911 (90.0026%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3330/3911 (85.1445%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2630, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4116/4433 (92.8491%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4144/4433 (93.4807%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8282, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3874/4336 (89.3450%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3965/4336 (91.4437%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0591, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3245/3638 (89.1974%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3335/3638 (91.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8728, Accuracy: 5687/10000 (56.8700%)
time spent on training: 257.45416617393494
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.5370, Accuracy: 6342/10000 (63.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 9.2956, Accuracy: 148/9900 (1.4949%)
Done in 286.25337314605713 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4474/4885 (91.5865%), train_poison_data_count: 385
Global model norm: 44.283786095336296.
Norm before scaling: 44.280269980774875. Distance: 2.051634866988131
Total norm for 4 adversaries is: 44.280269980774875. distance: 2.051634866988131
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.3704, Accuracy: 9035/9900 (91.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4823/5305 (90.9142%), train_poison_data_count: 415
Global model norm: 44.283786095336296.
Norm before scaling: 44.2812830804393. Distance: 2.2167928956117917
Total norm for 4 adversaries is: 44.2812830804393. distance: 2.2167928956117917
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1648, Accuracy: 9468/9900 (95.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4296/4717 (91.0748%), train_poison_data_count: 370
Global model norm: 44.283786095336296.
Norm before scaling: 44.27616634545046. Distance: 2.0207104072019253
Total norm for 4 adversaries is: 44.27616634545046. distance: 2.0207104072019253
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2048, Accuracy: 9371/9900 (94.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 44.283786095336296.
Norm before scaling: 44.27729257413231. Distance: 2.092719208641776
Total norm for 4 adversaries is: 44.27729257413231. distance: 2.092719208641776
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2853, Accuracy: 9195/9900 (92.8788%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3483/3756 (92.7316%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3567/3756 (94.9681%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8306, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4979/5424 (91.7957%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5010/5424 (92.3673%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1556, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4111/4433 (92.7363%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4143/4433 (93.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8158, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4026/4501 (89.4468%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4028/4501 (89.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0183, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3691/4025 (91.7019%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3725/4025 (92.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8980, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3946/4235 (93.1759%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3892/4235 (91.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9587, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5514/6124 (90.0392%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5415/6124 (88.4226%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8926, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4208/4634 (90.8071%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4242/4634 (91.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8874, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4376/4716 (92.7905%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4369/4716 (92.6421%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9517, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4230/4767 (88.7351%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4161/4767 (87.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1571, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3477/3804 (91.4038%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3558/3804 (93.5331%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8822, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3210/3472 (92.4539%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3285/3472 (94.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8883, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4833/5392 (89.6328%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4841/5392 (89.7812%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9994, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5269/5740 (91.7944%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5250/5740 (91.4634%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9781, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4181/4596 (90.9704%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4231/4596 (92.0583%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8812, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3277/3616 (90.6250%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3376/3616 (93.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.7906, Accuracy: 5823/10000 (58.2300%)
time spent on training: 264.57969903945923
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.5126, Accuracy: 6348/10000 (63.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 9.0303, Accuracy: 169/9900 (1.7071%)
Done in 293.58730840682983 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 44.30071494599791.
Norm before scaling: 44.293434335071744. Distance: 2.087450371797619
Total norm for 4 adversaries is: 44.293434335071744. distance: 2.087450371797619
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1201, Accuracy: 9620/9900 (97.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4857/5305 (91.5551%), train_poison_data_count: 415
Global model norm: 44.30071494599791.
Norm before scaling: 44.29449398362764. Distance: 2.179373441651304
Total norm for 4 adversaries is: 44.29449398362764. distance: 2.179373441651304
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0897, Accuracy: 9680/9900 (97.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4299/4717 (91.1384%), train_poison_data_count: 370
Global model norm: 44.30071494599791.
Norm before scaling: 44.296285269443025. Distance: 2.067018933678712
Total norm for 4 adversaries is: 44.296285269443025. distance: 2.067018933678712
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0542, Accuracy: 9748/9900 (98.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 44.30071494599791.
Norm before scaling: 44.29731453706096. Distance: 2.153660643102672
Total norm for 4 adversaries is: 44.29731453706096. distance: 2.153660643102672
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.3543, Accuracy: 9077/9900 (91.6869%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4496/5063 (88.8011%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4394/5063 (86.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1602, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4407/4804 (91.7361%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4231/4804 (88.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1635, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4141/4558 (90.8513%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4155/4558 (91.1584%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9191, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3511/3756 (93.4771%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3605/3756 (95.9798%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7916, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5025/5424 (92.6438%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5028/5424 (92.6991%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0277, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4083/4511 (90.5121%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4140/4511 (91.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9091, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4712/5167 (91.1941%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4729/5167 (91.5231%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1052, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4048/4356 (92.9293%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4086/4356 (93.8017%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0879, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4597/5244 (87.6621%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4613/5244 (87.9672%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0683, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4430/4793 (92.4265%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4450/4793 (92.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9004, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3536/3828 (92.3720%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3556/3828 (92.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8800, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3742/4046 (92.4864%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3782/4046 (93.4750%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8649, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3690/4013 (91.9512%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3747/4013 (93.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8209, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2993/3271 (91.5011%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2956/3271 (90.3699%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9511, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4037/4362 (92.5493%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4027/4362 (92.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9727, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4039/4346 (92.9360%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4125/4346 (94.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7902, Accuracy: 5916/10000 (59.1600%)
time spent on training: 262.2203850746155
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.5027, Accuracy: 6369/10000 (63.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 8.9834, Accuracy: 174/9900 (1.7576%)
Done in 291.2210681438446 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 44.31994411423668.
Norm before scaling: 44.31714565959842. Distance: 2.1420489399267373
Total norm for 4 adversaries is: 44.31714565959842. distance: 2.1420489399267373
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1409, Accuracy: 9548/9900 (96.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4848/5305 (91.3855%), train_poison_data_count: 415
Global model norm: 44.31994411423668.
Norm before scaling: 44.31105785955479. Distance: 2.1605348996727307
Total norm for 4 adversaries is: 44.31105785955479. distance: 2.1605348996727307
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1576, Accuracy: 9519/9900 (96.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4303/4717 (91.2232%), train_poison_data_count: 370
Global model norm: 44.31994411423668.
Norm before scaling: 44.313471042340076. Distance: 2.076159013365618
Total norm for 4 adversaries is: 44.313471042340076. distance: 2.076159013365618
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0467, Accuracy: 9782/9900 (98.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4599/5066 (90.7817%), train_poison_data_count: 400
Global model norm: 44.31994411423668.
Norm before scaling: 44.31697625928043. Distance: 2.1707849854731163
Total norm for 4 adversaries is: 44.31697625928043. distance: 2.1707849854731163
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.4514, Accuracy: 8818/9900 (89.0707%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3858/4126 (93.5046%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3870/4126 (93.7954%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7159, Accuracy: 5978/10000 (59.7800%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4968/5455 (91.0724%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4957/5455 (90.8708%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9668, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4184/4558 (91.7946%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4029/4558 (88.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0806, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3958/4235 (93.4593%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3910/4235 (92.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9603, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3458/3804 (90.9043%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3530/3804 (92.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8200, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5669/6391 (88.7029%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5495/6391 (85.9803%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2569, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3956/4336 (91.2362%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4003/4336 (92.3201%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1961, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4255/4663 (91.2503%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4378/4663 (93.8881%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0362, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4081/4511 (90.4677%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4168/4511 (92.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9410, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4105/4503 (91.1614%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4086/4503 (90.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0308, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4504/5063 (88.9591%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4271/5063 (84.3571%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1647, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3951/4315 (91.5643%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3963/4315 (91.8424%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8907, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3366/3638 (92.5234%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3419/3638 (93.9802%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7768, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4123/4441 (92.8395%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4144/4441 (93.3123%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0036, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4286/4679 (91.6008%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4268/4679 (91.2161%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0650, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4696/5265 (89.1928%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4677/5265 (88.8319%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1721, Accuracy: 5311/10000 (53.1100%)
time spent on training: 264.89034366607666
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.5386, Accuracy: 6328/10000 (63.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 9.0443, Accuracy: 179/9900 (1.8081%)
Done in 294.2051601409912 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4498/4885 (92.0778%), train_poison_data_count: 385
Global model norm: 44.3556364552642.
Norm before scaling: 44.34764506765692. Distance: 2.0915944404847697
Total norm for 4 adversaries is: 44.34764506765692. distance: 2.0915944404847697
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1387, Accuracy: 9589/9900 (96.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4862/5305 (91.6494%), train_poison_data_count: 415
Global model norm: 44.3556364552642.
Norm before scaling: 44.345429187727454. Distance: 2.12881475129491
Total norm for 4 adversaries is: 44.345429187727454. distance: 2.12881475129491
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0766, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4318/4717 (91.5412%), train_poison_data_count: 370
Global model norm: 44.3556364552642.
Norm before scaling: 44.347159235136616. Distance: 1.9575377397078124
Total norm for 4 adversaries is: 44.347159235136616. distance: 1.9575377397078124
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.3685, Accuracy: 9025/9900 (91.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4619/5066 (91.1765%), train_poison_data_count: 400
Global model norm: 44.3556364552642.
Norm before scaling: 44.349943409983624. Distance: 2.1487828202595485
Total norm for 4 adversaries is: 44.349943409983624. distance: 2.1487828202595485
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1308, Accuracy: 9564/9900 (96.6061%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3964/4336 (91.4207%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4004/4336 (92.3432%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0279, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3520/3828 (91.9540%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3585/3828 (93.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8454, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3300/3672 (89.8693%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3286/3672 (89.4880%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0074, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4177/4651 (89.8086%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4266/4651 (91.7222%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9374, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3960/4361 (90.8049%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3880/4361 (88.9704%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0043, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4613/5025 (91.8010%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4622/5025 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0963, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5433/6124 (88.7165%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5417/6124 (88.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0539, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3399/3704 (91.7657%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3450/3704 (93.1425%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7728, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4420/4934 (89.5825%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3990/4934 (80.8675%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.4370, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4600/5017 (91.6883%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4616/5017 (92.0072%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8876, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5089/5582 (91.1680%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5092/5582 (91.2218%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0108, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4657/5167 (90.1297%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4684/5167 (90.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1850, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3582/3861 (92.7739%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3577/3861 (92.6444%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9538, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3283/3646 (90.0439%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3340/3646 (91.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8043, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4151/4558 (91.0706%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4044/4558 (88.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2275, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4650/5116 (90.8913%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4575/5116 (89.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0862, Accuracy: 5317/10000 (53.1700%)
time spent on training: 263.6425316333771
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.5601, Accuracy: 6307/10000 (63.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 9.1586, Accuracy: 158/9900 (1.5960%)
Done in 292.7070691585541 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4460/4885 (91.2999%), train_poison_data_count: 385
Global model norm: 44.388689019733675.
Norm before scaling: 44.38246388593064. Distance: 2.140256752583666
Total norm for 4 adversaries is: 44.38246388593064. distance: 2.140256752583666
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0298, Accuracy: 9814/9900 (99.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 44.388689019733675.
Norm before scaling: 44.38127706484177. Distance: 2.1726956360836382
Total norm for 4 adversaries is: 44.38127706484177. distance: 2.1726956360836382
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1340, Accuracy: 9578/9900 (96.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4313/4717 (91.4352%), train_poison_data_count: 370
Global model norm: 44.388689019733675.
Norm before scaling: 44.37799148147297. Distance: 2.005159993435357
Total norm for 4 adversaries is: 44.37799148147297. distance: 2.005159993435357
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1314, Accuracy: 9557/9900 (96.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4597/5066 (90.7422%), train_poison_data_count: 400
Global model norm: 44.388689019733675.
Norm before scaling: 44.38573813737922. Distance: 2.1871942578955443
Total norm for 4 adversaries is: 44.38573813737922. distance: 2.1871942578955443
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1398, Accuracy: 9544/9900 (96.4040%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4058/4511 (89.9579%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4138/4511 (91.7313%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9552, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4118/4346 (94.7538%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4142/4346 (95.3060%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7620, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4362/4804 (90.7993%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4090/4804 (85.1374%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3726, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4663/5232 (89.1246%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4646/5232 (88.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1001, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4243/4618 (91.8796%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4223/4618 (91.4465%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9853, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3358/3590 (93.5376%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3243/3590 (90.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0373, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5683/6391 (88.9219%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5581/6391 (87.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0575, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3992/4354 (91.6858%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3690/4354 (84.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3750, Accuracy: 4913/10000 (49.1300%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4598/5055 (90.9594%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4629/5055 (91.5727%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0011, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3634/3837 (94.7094%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3651/3837 (95.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8312, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4091/4503 (90.8505%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4132/4503 (91.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9416, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4212/4576 (92.0455%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4277/4576 (93.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9139, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4380/4793 (91.3833%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4403/4793 (91.8631%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9702, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4232/4634 (91.3250%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4262/4634 (91.9724%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9656, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3747/4158 (90.1154%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3720/4158 (89.4661%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1512, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5270/5740 (91.8118%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5271/5740 (91.8293%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0693, Accuracy: 5389/10000 (53.8900%)
time spent on training: 266.3664309978485
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.5660, Accuracy: 6300/10000 (63.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 9.4091, Accuracy: 133/9900 (1.3434%)
Done in 295.1790144443512 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4461/4885 (91.3204%), train_poison_data_count: 385
Global model norm: 44.42106159121622.
Norm before scaling: 44.415547331160546. Distance: 2.1265516786769467
Total norm for 4 adversaries is: 44.415547331160546. distance: 2.1265516786769467
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1462, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4842/5305 (91.2724%), train_poison_data_count: 415
Global model norm: 44.42106159121622.
Norm before scaling: 44.4115908777976. Distance: 2.170507206157681
Total norm for 4 adversaries is: 44.4115908777976. distance: 2.170507206157681
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1702, Accuracy: 9476/9900 (95.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4317/4717 (91.5200%), train_poison_data_count: 370
Global model norm: 44.42106159121622.
Norm before scaling: 44.41260785326758. Distance: 2.03122805070022
Total norm for 4 adversaries is: 44.41260785326758. distance: 2.03122805070022
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.3689, Accuracy: 8970/9900 (90.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4594/5066 (90.6830%), train_poison_data_count: 400
Global model norm: 44.42106159121622.
Norm before scaling: 44.41622754727432. Distance: 2.1463738535368737
Total norm for 4 adversaries is: 44.41622754727432. distance: 2.1463738535368737
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2118, Accuracy: 9373/9900 (94.6768%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3781/4184 (90.3681%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3807/4184 (90.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9755, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5776/6263 (92.2242%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5822/6263 (92.9586%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0549, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4138/4456 (92.8636%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4146/4456 (93.0431%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.7775, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4266/4538 (94.0062%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4252/4538 (93.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8694, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3925/4235 (92.6800%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3710/4235 (87.6033%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2837, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3868/4223 (91.5937%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3949/4223 (93.5117%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8641, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4966/5455 (91.0357%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4885/5455 (89.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0771, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4513/5037 (89.5970%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4600/5037 (91.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9803, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3510/3756 (93.4505%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3554/3756 (94.6219%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9219, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4837/5265 (91.8708%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4788/5265 (90.9402%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9893, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4559/5055 (90.1879%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4603/5055 (91.0584%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0654, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4377/4804 (91.1116%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4115/4804 (85.6578%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3257, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4509/5063 (89.0579%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4334/5063 (85.6014%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0775, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3944/4295 (91.8277%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3828/4295 (89.1269%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0486, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3001/3271 (91.7456%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2917/3271 (89.1776%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0709, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4040/4356 (92.7456%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4043/4356 (92.8145%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0102, Accuracy: 5547/10000 (55.4700%)
time spent on training: 264.92973494529724
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.6373, Accuracy: 6194/10000 (61.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 9.3974, Accuracy: 120/9900 (1.2121%)
Done in 293.71906638145447 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4481/4885 (91.7298%), train_poison_data_count: 385
Global model norm: 44.44429695952634.
Norm before scaling: 44.43728573260579. Distance: 2.0852809830108483
Total norm for 4 adversaries is: 44.43728573260579. distance: 2.0852809830108483
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2319, Accuracy: 9333/9900 (94.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4841/5305 (91.2535%), train_poison_data_count: 415
Global model norm: 44.44429695952634.
Norm before scaling: 44.44224383522253. Distance: 2.1873724764028877
Total norm for 4 adversaries is: 44.44224383522253. distance: 2.1873724764028877
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2413, Accuracy: 9311/9900 (94.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4318/4717 (91.5412%), train_poison_data_count: 370
Global model norm: 44.44429695952634.
Norm before scaling: 44.43650282372731. Distance: 1.9655289109461134
Total norm for 4 adversaries is: 44.43650282372731. distance: 1.9655289109461134
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.3896, Accuracy: 9034/9900 (91.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4629/5066 (91.3739%), train_poison_data_count: 400
Global model norm: 44.44429695952634.
Norm before scaling: 44.44206117809808. Distance: 2.125758989211242
Total norm for 4 adversaries is: 44.44206117809808. distance: 2.125758989211242
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.3755, Accuracy: 9000/9900 (90.9091%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4069/4503 (90.3620%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4066/4503 (90.2954%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0717, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4148/4456 (93.0880%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4143/4456 (92.9758%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0829, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4874/5265 (92.5736%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4871/5265 (92.5166%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9424, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4348/4793 (90.7156%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4448/4793 (92.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9033, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4470/4928 (90.7062%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4490/4928 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9178, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3334/3638 (91.6438%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3384/3638 (93.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.7705, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4294/4663 (92.0866%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4371/4663 (93.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9047, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4371/4928 (88.6972%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4424/4928 (89.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1296, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4079/4465 (91.3550%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4136/4465 (92.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9208, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3540/3911 (90.5139%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3451/3911 (88.2383%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1558, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4075/4518 (90.1948%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4138/4518 (91.5892%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0420, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3913/4235 (92.3967%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3951/4235 (93.2940%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9178, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4479/4934 (90.7783%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4101/4934 (83.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3192, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4240/4647 (91.2417%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4304/4647 (92.6189%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8591, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4222/4651 (90.7762%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4266/4651 (91.7222%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1412, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4428/4989 (88.7553%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4410/4989 (88.3945%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0115, Accuracy: 5581/10000 (55.8100%)
time spent on training: 263.1960349082947
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.6189, Accuracy: 6254/10000 (62.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 9.2114, Accuracy: 137/9900 (1.3838%)
Done in 292.3161635398865 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4471/4885 (91.5251%), train_poison_data_count: 385
Global model norm: 44.477157387774625.
Norm before scaling: 44.47143872537392. Distance: 2.131373999783502
Total norm for 4 adversaries is: 44.47143872537392. distance: 2.131373999783502
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1065, Accuracy: 9630/9900 (97.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4848/5305 (91.3855%), train_poison_data_count: 415
Global model norm: 44.477157387774625.
Norm before scaling: 44.46826823570727. Distance: 2.156061910635661
Total norm for 4 adversaries is: 44.46826823570727. distance: 2.156061910635661
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.3245, Accuracy: 9162/9900 (92.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 44.477157387774625.
Norm before scaling: 44.46650583980669. Distance: 2.0334878185349137
Total norm for 4 adversaries is: 44.46650583980669. distance: 2.0334878185349137
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.2585, Accuracy: 9225/9900 (93.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 44.477157387774625.
Norm before scaling: 44.47695017286693. Distance: 2.2306659564541365
Total norm for 4 adversaries is: 44.47695017286693. distance: 2.2306659564541365
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1382, Accuracy: 9553/9900 (96.4949%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4226/4538 (93.1247%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4246/4538 (93.5654%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8025, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4040/4362 (92.6181%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3972/4362 (91.0591%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9564, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4566/5244 (87.0709%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4591/5244 (87.5477%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9246, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3736/4046 (92.3381%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3726/4046 (92.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0130, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3679/4013 (91.6770%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3758/4013 (93.6457%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8976, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4114/4465 (92.1389%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4139/4465 (92.6988%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7854, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4635/5232 (88.5894%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4613/5232 (88.1690%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1835, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4442/4928 (90.1380%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4496/4928 (91.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8488, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4484/5063 (88.5641%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4453/5063 (87.9518%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0086, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5262/5902 (89.1562%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5221/5902 (88.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1409, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4133/4456 (92.7513%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4175/4456 (93.6939%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7992, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4196/4596 (91.2968%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4282/4596 (93.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9333, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4077/4441 (91.8036%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4135/4441 (93.1097%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1272, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5381/5740 (93.7456%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5342/5740 (93.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0844, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3220/3472 (92.7419%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3173/3472 (91.3882%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0726, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3543/3861 (91.7638%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3563/3861 (92.2818%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9792, Accuracy: 5551/10000 (55.5100%)
time spent on training: 265.72920775413513
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.6041, Accuracy: 6238/10000 (62.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 8.9389, Accuracy: 170/9900 (1.7172%)
Done in 294.45421504974365 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4503/4885 (92.1801%), train_poison_data_count: 385
Global model norm: 44.49953091834929.
Norm before scaling: 44.49289192265013. Distance: 2.072206947581722
Total norm for 4 adversaries is: 44.49289192265013. distance: 2.072206947581722
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2978, Accuracy: 9143/9900 (92.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 44.49953091834929.
Norm before scaling: 44.4940935994248. Distance: 2.190855776484548
Total norm for 4 adversaries is: 44.4940935994248. distance: 2.190855776484548
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2184, Accuracy: 9411/9900 (95.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4307/4717 (91.3080%), train_poison_data_count: 370
Global model norm: 44.49953091834929.
Norm before scaling: 44.49112913030037. Distance: 2.039626003464554
Total norm for 4 adversaries is: 44.49112913030037. distance: 2.039626003464554
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1522, Accuracy: 9501/9900 (95.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4655/5066 (91.8871%), train_poison_data_count: 400
Global model norm: 44.49953091834929.
Norm before scaling: 44.49047612490018. Distance: 2.116563430531352
Total norm for 4 adversaries is: 44.49047612490018. distance: 2.116563430531352
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1384, Accuracy: 9519/9900 (96.1515%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3579/3797 (94.2586%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3542/3797 (93.2842%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9884, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3046/3297 (92.3870%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3108/3297 (94.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7436, Accuracy: 5966/10000 (59.6600%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3554/3911 (90.8719%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3458/3911 (88.4173%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1519, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2969/3271 (90.7673%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0058, Accuracy: 2915/3271 (89.1165%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9459, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3746/4046 (92.5853%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3761/4046 (92.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0377, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5363/5740 (93.4321%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5323/5740 (92.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0919, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3627/3969 (91.3832%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3612/3969 (91.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9914, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3430/3704 (92.6026%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3460/3704 (93.4125%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8746, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4305/4767 (90.3084%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4277/4767 (89.7210%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0280, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4502/4956 (90.8394%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4433/4956 (89.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0000, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3353/3590 (93.3983%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3091/3590 (86.1003%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0816, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5270/5902 (89.2918%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5154/5902 (87.3263%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2188, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4500/4928 (91.3149%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4510/4928 (91.5179%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9105, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3955/4235 (93.3884%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3955/4235 (93.3884%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0049, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4810/5265 (91.3580%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4742/5265 (90.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0560, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4027/4356 (92.4472%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3587/4356 (82.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2757, Accuracy: 5063/10000 (50.6300%)
time spent on training: 260.1177752017975
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.6807, Accuracy: 6070/10000 (60.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 8.9808, Accuracy: 135/9900 (1.3636%)
Done in 288.8995432853699 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4495/4885 (92.0164%), train_poison_data_count: 385
Global model norm: 44.535151967206616.
Norm before scaling: 44.53072093983967. Distance: 2.0896795760937628
Total norm for 4 adversaries is: 44.53072093983967. distance: 2.0896795760937628
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1422, Accuracy: 9569/9900 (96.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 44.535151967206616.
Norm before scaling: 44.525046168736594. Distance: 2.1537704585471387
Total norm for 4 adversaries is: 44.525046168736594. distance: 2.1537704585471387
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1782, Accuracy: 9454/9900 (95.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4298/4717 (91.1172%), train_poison_data_count: 370
Global model norm: 44.535151967206616.
Norm before scaling: 44.52680350607654. Distance: 2.0372114293108714
Total norm for 4 adversaries is: 44.52680350607654. distance: 2.0372114293108714
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1841, Accuracy: 9428/9900 (95.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4650/5066 (91.7884%), train_poison_data_count: 400
Global model norm: 44.535151967206616.
Norm before scaling: 44.527613612492615. Distance: 2.135047496115472
Total norm for 4 adversaries is: 44.527613612492615. distance: 2.135047496115472
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1563, Accuracy: 9504/9900 (96.0000%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3702/4025 (91.9752%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3804/4025 (94.5093%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8207, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5226/5902 (88.5463%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5189/5902 (87.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1123, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4387/4793 (91.5293%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4458/4793 (93.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8659, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4820/5265 (91.5480%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4769/5265 (90.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9609, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3931/4295 (91.5250%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3849/4295 (89.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0215, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3419/3704 (92.3056%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3436/3704 (92.7646%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7941, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4686/5116 (91.5950%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4661/5116 (91.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0159, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5369/5740 (93.5366%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5301/5740 (92.3519%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0800, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3565/3797 (93.8899%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3537/3797 (93.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8563, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4319/4716 (91.5818%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4345/4716 (92.1332%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9166, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4111/4433 (92.7363%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4132/4433 (93.2100%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7758, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3958/4416 (89.6286%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4036/4416 (91.3949%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9243, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3843/4223 (91.0017%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3938/4223 (93.2512%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8821, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4549/5083 (89.4944%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4571/5083 (89.9272%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9808, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4176/4576 (91.2587%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4221/4576 (92.2421%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9081, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4873/5392 (90.3746%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4723/5392 (87.5927%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1887, Accuracy: 5267/10000 (52.6700%)
time spent on training: 267.27840304374695
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7142, Accuracy: 6063/10000 (60.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 9.3599, Accuracy: 107/9900 (1.0808%)
Done in 296.390741109848 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4478/4885 (91.6684%), train_poison_data_count: 385
Global model norm: 44.57113893296031.
Norm before scaling: 44.56049478307551. Distance: 2.0530615345335606
Total norm for 4 adversaries is: 44.56049478307551. distance: 2.0530615345335606
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2975, Accuracy: 9196/9900 (92.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4830/5305 (91.0462%), train_poison_data_count: 415
Global model norm: 44.57113893296031.
Norm before scaling: 44.56163984969303. Distance: 2.1387424405096462
Total norm for 4 adversaries is: 44.56163984969303. distance: 2.1387424405096462
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1189, Accuracy: 9592/9900 (96.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4308/4717 (91.3292%), train_poison_data_count: 370
Global model norm: 44.57113893296031.
Norm before scaling: 44.56671696167654. Distance: 2.0478597121469932
Total norm for 4 adversaries is: 44.56671696167654. distance: 2.0478597121469932
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0946, Accuracy: 9656/9900 (97.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4616/5066 (91.1173%), train_poison_data_count: 400
Global model norm: 44.57113893296031.
Norm before scaling: 44.56204253359158. Distance: 2.140699844722588
Total norm for 4 adversaries is: 44.56204253359158. distance: 2.140699844722588
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2774, Accuracy: 9247/9900 (93.4040%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4825/5265 (91.6429%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4811/5265 (91.3770%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0289, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4071/4356 (93.4573%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3913/4356 (89.8301%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2361, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3522/3756 (93.7700%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3578/3756 (95.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7690, Accuracy: 6048/10000 (60.4800%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3578/3837 (93.2499%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3659/3837 (95.3610%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7985, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5346/5740 (93.1359%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5313/5740 (92.5610%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9371, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3862/4223 (91.4516%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3952/4223 (93.5828%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8521, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4061/4465 (90.9518%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4121/4465 (92.2956%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9969, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5083/5591 (90.9140%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5116/5591 (91.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9630, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5323/5902 (90.1898%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5072/5902 (85.9370%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2040, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4541/4918 (92.3343%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4565/4918 (92.8223%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0526, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3623/3861 (93.8358%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3629/3861 (93.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8290, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3869/4295 (90.0815%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3829/4295 (89.1502%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0050, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3731/4158 (89.7306%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3797/4158 (91.3179%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9646, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5786/6263 (92.3838%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5773/6263 (92.1763%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0158, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3966/4354 (91.0887%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0125, Accuracy: 3354/4354 (77.0326%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.5651, Accuracy: 4620/10000 (46.2000%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3538/3797 (93.1788%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3489/3797 (91.8883%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9068, Accuracy: 5747/10000 (57.4700%)
time spent on training: 267.3034465312958
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7124, Accuracy: 6065/10000 (60.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 9.1835, Accuracy: 108/9900 (1.0909%)
Done in 296.27054953575134 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4498/4885 (92.0778%), train_poison_data_count: 385
Global model norm: 44.59204183834264.
Norm before scaling: 44.58271560003313. Distance: 2.019852455907122
Total norm for 4 adversaries is: 44.58271560003313. distance: 2.019852455907122
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.3793, Accuracy: 8976/9900 (90.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4859/5305 (91.5928%), train_poison_data_count: 415
Global model norm: 44.59204183834264.
Norm before scaling: 44.57995417733317. Distance: 2.1241643047756127
Total norm for 4 adversaries is: 44.57995417733317. distance: 2.1241643047756127
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2031, Accuracy: 9407/9900 (95.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 44.59204183834264.
Norm before scaling: 44.58612299002067. Distance: 2.0360007263811837
Total norm for 4 adversaries is: 44.58612299002067. distance: 2.0360007263811837
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2226, Accuracy: 9369/9900 (94.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4596/5066 (90.7225%), train_poison_data_count: 400
Global model norm: 44.59204183834264.
Norm before scaling: 44.58662538347052. Distance: 2.185742353300079
Total norm for 4 adversaries is: 44.58662538347052. distance: 2.185742353300079
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.3952, Accuracy: 8920/9900 (90.1010%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3585/3797 (94.4166%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3574/3797 (94.1269%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8827, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4568/5037 (90.6889%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4619/5037 (91.7014%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9274, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4432/4934 (89.8257%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4352/4934 (88.2043%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1545, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4941/5455 (90.5775%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4900/5455 (89.8258%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0321, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5287/5902 (89.5798%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5172/5902 (87.6313%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2937, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5661/6391 (88.5777%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5624/6391 (87.9987%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1739, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3556/3911 (90.9230%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3330/3911 (85.1445%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3111, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4741/5195 (91.2608%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4596/5195 (88.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1386, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3928/4235 (92.7509%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3903/4235 (92.1606%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8989, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4709/5116 (92.0446%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4683/5116 (91.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0588, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4227/4538 (93.1468%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4255/4538 (93.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8954, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5118/5582 (91.6876%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5038/5582 (90.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1846, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4167/4558 (91.4217%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4191/4558 (91.9482%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9992, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3715/4046 (91.8191%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3746/4046 (92.5853%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9007, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3532/3828 (92.2675%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3527/3828 (92.1369%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8381, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4569/5055 (90.3858%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4655/5055 (92.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9198, Accuracy: 5623/10000 (56.2300%)
time spent on training: 270.0962965488434
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.6782, Accuracy: 6124/10000 (61.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 9.3152, Accuracy: 105/9900 (1.0606%)
Done in 298.844783782959 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4510/4885 (92.3234%), train_poison_data_count: 385
Global model norm: 44.62009776995115.
Norm before scaling: 44.61020002520794. Distance: 1.9952799412782616
Total norm for 4 adversaries is: 44.61020002520794. distance: 1.9952799412782616
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1599, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4834/5305 (91.1216%), train_poison_data_count: 415
Global model norm: 44.62009776995115.
Norm before scaling: 44.609492666219595. Distance: 2.153885581630297
Total norm for 4 adversaries is: 44.609492666219595. distance: 2.153885581630297
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1857, Accuracy: 9461/9900 (95.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4326/4717 (91.7108%), train_poison_data_count: 370
Global model norm: 44.62009776995115.
Norm before scaling: 44.609533712502255. Distance: 1.9866107750824227
Total norm for 4 adversaries is: 44.609533712502255. distance: 1.9866107750824227
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2572, Accuracy: 9285/9900 (93.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4614/5066 (91.0778%), train_poison_data_count: 400
Global model norm: 44.62009776995115.
Norm before scaling: 44.612688690410714. Distance: 2.1588111814875504
Total norm for 4 adversaries is: 44.612688690410714. distance: 2.1588111814875504
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1771, Accuracy: 9438/9900 (95.3333%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5125/5582 (91.8130%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5091/5582 (91.2039%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1785, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4032/4501 (89.5801%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4044/4501 (89.8467%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9670, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3552/3911 (90.8208%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3302/3911 (84.4285%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2673, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4301/4663 (92.2368%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4377/4663 (93.8666%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9215, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4809/5265 (91.3390%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4767/5265 (90.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0184, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3935/4416 (89.1078%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4001/4416 (90.6024%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1641, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4088/4433 (92.2175%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4111/4433 (92.7363%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8018, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5780/6263 (92.2880%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5722/6263 (91.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0328, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4990/5455 (91.4757%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4906/5455 (89.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0884, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4207/4634 (90.7855%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4253/4634 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8828, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4357/4707 (92.5643%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4390/4707 (93.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8669, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3858/4126 (93.5046%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3880/4126 (94.0378%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8017, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4725/5116 (92.3573%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4674/5116 (91.3604%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0911, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4539/5063 (89.6504%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4440/5063 (87.6950%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2534, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3989/4361 (91.4698%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3937/4361 (90.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3385, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5425/6124 (88.5859%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5471/6124 (89.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8346, Accuracy: 5692/10000 (56.9200%)
time spent on training: 269.7206401824951
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.6956, Accuracy: 6057/10000 (60.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 8.9974, Accuracy: 136/9900 (1.3737%)
Done in 298.71875643730164 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 44.65928414289967.
Norm before scaling: 44.65128695522462. Distance: 2.132847488731149
Total norm for 4 adversaries is: 44.65128695522462. distance: 2.132847488731149
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0555, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4859/5305 (91.5928%), train_poison_data_count: 415
Global model norm: 44.65928414289967.
Norm before scaling: 44.64589956150788. Distance: 2.1371904650981497
Total norm for 4 adversaries is: 44.64589956150788. distance: 2.1371904650981497
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.2100, Accuracy: 9371/9900 (94.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 44.65928414289967.
Norm before scaling: 44.64764667387997. Distance: 1.9885770506497478
Total norm for 4 adversaries is: 44.64764667387997. distance: 1.9885770506497478
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.5115, Accuracy: 8673/9900 (87.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4635/5066 (91.4923%), train_poison_data_count: 400
Global model norm: 44.65928414289967.
Norm before scaling: 44.65324845580946. Distance: 2.174612282582651
Total norm for 4 adversaries is: 44.65324845580946. distance: 2.174612282582651
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.2453, Accuracy: 9315/9900 (94.0909%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4099/4356 (94.1001%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3936/4356 (90.3581%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0629, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4014/4362 (92.0220%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4016/4362 (92.0679%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9222, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4270/4679 (91.2588%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4174/4679 (89.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1848, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3776/4158 (90.8129%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3809/4158 (91.6065%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9287, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4257/4651 (91.5287%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4242/4651 (91.2062%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0919, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3793/4175 (90.8503%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3792/4175 (90.8263%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9085, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4213/4618 (91.2300%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4185/4618 (90.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1204, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4135/4625 (89.4054%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4151/4625 (89.7514%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9740, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5120/5582 (91.7234%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5093/5582 (91.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1419, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4392/4874 (90.1108%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4282/4874 (87.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2940, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4472/4934 (90.6364%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4170/4934 (84.5156%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2606, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5051/5424 (93.1232%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5037/5424 (92.8650%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1880, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4392/4804 (91.4238%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4212/4804 (87.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3238, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4551/4918 (92.5376%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4584/4918 (93.2086%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9322, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3632/3861 (94.0689%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3593/3861 (93.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8376, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3889/4223 (92.0909%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3910/4223 (92.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.7734, Accuracy: 5869/10000 (58.6900%)
time spent on training: 266.0445683002472
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.6956, Accuracy: 6072/10000 (60.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 8.9947, Accuracy: 144/9900 (1.4545%)
Done in 294.8872494697571 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4535/4885 (92.8352%), train_poison_data_count: 385
Global model norm: 44.68133015755504.
Norm before scaling: 44.67127519053421. Distance: 2.010809298373127
Total norm for 4 adversaries is: 44.67127519053421. distance: 2.010809298373127
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1524, Accuracy: 9511/9900 (96.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4887/5305 (92.1206%), train_poison_data_count: 415
Global model norm: 44.68133015755504.
Norm before scaling: 44.66787839545955. Distance: 2.114827209340331
Total norm for 4 adversaries is: 44.66787839545955. distance: 2.114827209340331
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0899, Accuracy: 9682/9900 (97.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4317/4717 (91.5200%), train_poison_data_count: 370
Global model norm: 44.68133015755504.
Norm before scaling: 44.67211546804813. Distance: 2.0216523179029626
Total norm for 4 adversaries is: 44.67211546804813. distance: 2.0216523179029626
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1506, Accuracy: 9511/9900 (96.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4583/5066 (90.4659%), train_poison_data_count: 400
Global model norm: 44.68133015755504.
Norm before scaling: 44.67673876110615. Distance: 2.2220458146118154
Total norm for 4 adversaries is: 44.67673876110615. distance: 2.2220458146118154
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.3940, Accuracy: 8943/9900 (90.3333%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4196/4647 (90.2948%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4290/4647 (92.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8801, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3476/3804 (91.3775%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3509/3804 (92.2450%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9197, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5154/5591 (92.1839%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5034/5591 (90.0376%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1577, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4225/4634 (91.1739%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4243/4634 (91.5624%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9284, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4106/4433 (92.6235%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4148/4433 (93.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8131, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3397/3704 (91.7117%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3425/3704 (92.4676%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8382, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3603/3837 (93.9015%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3672/3837 (95.6998%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7525, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5007/5455 (91.7874%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4982/5455 (91.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9703, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5360/5740 (93.3798%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5358/5740 (93.3449%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9926, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4561/4986 (91.4761%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4616/4986 (92.5792%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7954, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4142/4456 (92.9533%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4150/4456 (93.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8980, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4101/4356 (94.1460%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4023/4356 (92.3554%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0621, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3334/3590 (92.8691%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3300/3590 (91.9220%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0568, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4063/4503 (90.2287%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4089/4503 (90.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9056, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4563/5037 (90.5896%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4650/5037 (92.3169%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9866, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4678/5167 (90.5361%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4697/5167 (90.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0110, Accuracy: 5363/10000 (53.6300%)
time spent on training: 262.7324984073639
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7095, Accuracy: 5999/10000 (59.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 8.7649, Accuracy: 145/9900 (1.4646%)
Done in 291.51930379867554 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4523/4885 (92.5896%), train_poison_data_count: 385
Global model norm: 44.710029012917644.
Norm before scaling: 44.69821631779268. Distance: 2.0514295152851
Total norm for 4 adversaries is: 44.69821631779268. distance: 2.0514295152851
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1929, Accuracy: 9410/9900 (95.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4835/5305 (91.1404%), train_poison_data_count: 415
Global model norm: 44.710029012917644.
Norm before scaling: 44.69838700424491. Distance: 2.163737799457463
Total norm for 4 adversaries is: 44.69838700424491. distance: 2.163737799457463
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2049, Accuracy: 9380/9900 (94.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4306/4717 (91.2868%), train_poison_data_count: 370
Global model norm: 44.710029012917644.
Norm before scaling: 44.697420227570184. Distance: 2.0185028350031544
Total norm for 4 adversaries is: 44.697420227570184. distance: 2.0185028350031544
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1103, Accuracy: 9616/9900 (97.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 44.710029012917644.
Norm before scaling: 44.704678734795195. Distance: 2.2162476518836924
Total norm for 4 adversaries is: 44.704678734795195. distance: 2.2162476518836924
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1927, Accuracy: 9433/9900 (95.2828%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3342/3638 (91.8637%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3399/3638 (93.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7959, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4363/4716 (92.5148%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4363/4716 (92.5148%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9805, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4507/4956 (90.9403%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4485/4956 (90.4964%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1059, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5014/5392 (92.9896%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4957/5392 (91.9325%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0444, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3820/4184 (91.3002%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3866/4184 (92.3996%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8021, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4032/4481 (89.9799%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3909/4481 (87.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1476, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3313/3646 (90.8667%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3391/3646 (93.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7823, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4583/5025 (91.2040%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4566/5025 (90.8657%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2415, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3330/3590 (92.7577%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3261/3590 (90.8357%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9096, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4189/4596 (91.1445%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4287/4596 (93.2768%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9859, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3947/4336 (91.0286%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3907/4336 (90.1061%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9551, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4394/4874 (90.1518%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4140/4874 (84.9405%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3458, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4789/5167 (92.6843%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4759/5167 (92.1037%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0693, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4251/4618 (92.0528%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4251/4618 (92.0528%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0081, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4424/4928 (89.7727%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4457/4928 (90.4424%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0630, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4259/4647 (91.6505%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4266/4647 (91.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8457, Accuracy: 5758/10000 (57.5800%)
time spent on training: 258.066841840744
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.6615, Accuracy: 6080/10000 (60.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 8.5869, Accuracy: 174/9900 (1.7576%)
Done in 286.63992190361023 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4516/4885 (92.4463%), train_poison_data_count: 385
Global model norm: 44.7350435463491.
Norm before scaling: 44.72849954866584. Distance: 2.0455845849286947
Total norm for 4 adversaries is: 44.72849954866584. distance: 2.0455845849286947
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2920, Accuracy: 9179/9900 (92.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4859/5305 (91.5928%), train_poison_data_count: 415
Global model norm: 44.7350435463491.
Norm before scaling: 44.72341623759233. Distance: 2.1566347525277774
Total norm for 4 adversaries is: 44.72341623759233. distance: 2.1566347525277774
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2736, Accuracy: 9249/9900 (93.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 44.7350435463491.
Norm before scaling: 44.72817068615357. Distance: 2.018771414156027
Total norm for 4 adversaries is: 44.72817068615357. distance: 2.018771414156027
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2087, Accuracy: 9387/9900 (94.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4632/5066 (91.4331%), train_poison_data_count: 400
Global model norm: 44.7350435463491.
Norm before scaling: 44.72561748455799. Distance: 2.116536621043679
Total norm for 4 adversaries is: 44.72561748455799. distance: 2.116536621043679
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2323, Accuracy: 9335/9900 (94.2929%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3965/4368 (90.7738%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3928/4368 (89.9267%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9285, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4778/5195 (91.9731%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4581/5195 (88.1809%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0741, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3967/4315 (91.9351%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4031/4315 (93.4183%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8903, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3298/3646 (90.4553%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3370/3646 (92.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8553, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3354/3590 (93.4262%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3298/3590 (91.8663%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9197, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3858/4126 (93.5046%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3905/4126 (94.6437%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7696, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3957/4361 (90.7361%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3943/4361 (90.4150%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9854, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3599/3837 (93.7972%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3647/3837 (95.0482%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9034, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3933/4235 (92.8689%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3828/4235 (90.3896%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0213, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5266/5902 (89.2240%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5230/5902 (88.6140%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3119, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4099/4433 (92.4656%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4138/4433 (93.3454%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8459, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3342/3638 (91.8637%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3403/3638 (93.5404%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7466, Accuracy: 5966/10000 (59.6600%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4696/5232 (89.7554%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4697/5232 (89.7745%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1423, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3924/4336 (90.4982%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3934/4336 (90.7288%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0836, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4549/4989 (91.1806%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4606/4989 (92.3231%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9375, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4095/4481 (91.3859%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3965/4481 (88.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9637, Accuracy: 5623/10000 (56.2300%)
time spent on training: 260.9657726287842
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.6602, Accuracy: 6052/10000 (60.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 8.8198, Accuracy: 135/9900 (1.3636%)
Done in 289.7418074607849 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4537/4885 (92.8762%), train_poison_data_count: 385
Global model norm: 44.766471687019155.
Norm before scaling: 44.75550169130746. Distance: 2.048933435575492
Total norm for 4 adversaries is: 44.75550169130746. distance: 2.048933435575492
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.2018, Accuracy: 9398/9900 (94.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4874/5305 (91.8756%), train_poison_data_count: 415
Global model norm: 44.766471687019155.
Norm before scaling: 44.75633902379081. Distance: 2.1205668488705007
Total norm for 4 adversaries is: 44.75633902379081. distance: 2.1205668488705007
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1362, Accuracy: 9589/9900 (96.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4288/4717 (90.9052%), train_poison_data_count: 370
Global model norm: 44.766471687019155.
Norm before scaling: 44.755867173861965. Distance: 2.0236461634913914
Total norm for 4 adversaries is: 44.755867173861965. distance: 2.0236461634913914
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0555, Accuracy: 9758/9900 (98.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4606/5066 (90.9199%), train_poison_data_count: 400
Global model norm: 44.766471687019155.
Norm before scaling: 44.7617853938002. Distance: 2.190759573597217
Total norm for 4 adversaries is: 44.7617853938002. distance: 2.190759573597217
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.2168, Accuracy: 9347/9900 (94.4141%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4726/5116 (92.3769%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4709/5116 (92.0446%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9486, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4016/4362 (92.0679%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3965/4362 (90.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2124, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4104/4441 (92.4116%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4137/4441 (93.1547%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0179, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4313/4663 (92.4941%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4357/4663 (93.4377%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9457, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4626/5083 (91.0092%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4560/5083 (89.7108%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0857, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4276/4767 (89.7000%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4276/4767 (89.7000%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1469, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3594/3797 (94.6537%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3613/3797 (95.1541%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8238, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4692/5195 (90.3176%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4641/5195 (89.3359%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1170, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4225/4618 (91.4898%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4205/4618 (91.0567%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0628, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4144/4433 (93.4807%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4121/4433 (92.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8555, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4697/5055 (92.9179%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4688/5055 (92.7399%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8534, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3748/4158 (90.1395%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3797/4158 (91.3179%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.7456, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3461/3781 (91.5366%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3377/3781 (89.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0817, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3810/4175 (91.2575%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3708/4175 (88.8144%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9338, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4791/5265 (90.9972%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4768/5265 (90.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0789, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3610/3837 (94.0839%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3683/3837 (95.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.7381, Accuracy: 5993/10000 (59.9300%)
time spent on training: 265.11559557914734
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.6701, Accuracy: 6056/10000 (60.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 8.7951, Accuracy: 136/9900 (1.3737%)
Done in 293.97971177101135 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 44.782667458376125.
Norm before scaling: 44.773813060063354. Distance: 2.1125044602567096
Total norm for 4 adversaries is: 44.773813060063354. distance: 2.1125044602567096
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0520, Accuracy: 9766/9900 (98.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4895/5305 (92.2714%), train_poison_data_count: 415
Global model norm: 44.782667458376125.
Norm before scaling: 44.76966468465631. Distance: 2.099765051459755
Total norm for 4 adversaries is: 44.76966468465631. distance: 2.099765051459755
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1899, Accuracy: 9466/9900 (95.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 44.782667458376125.
Norm before scaling: 44.77105388110716. Distance: 2.029671745444714
Total norm for 4 adversaries is: 44.77105388110716. distance: 2.029671745444714
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1995, Accuracy: 9391/9900 (94.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4643/5066 (91.6502%), train_poison_data_count: 400
Global model norm: 44.782667458376125.
Norm before scaling: 44.77439377468583. Distance: 2.1371263188544747
Total norm for 4 adversaries is: 44.77439377468583. distance: 2.1371263188544747
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0813, Accuracy: 9717/9900 (98.1515%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3594/3911 (91.8947%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3374/3911 (86.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2571, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4719/5195 (90.8373%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4619/5195 (88.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0926, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3525/3775 (93.3775%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3611/3775 (95.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8130, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4308/4679 (92.0710%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4225/4679 (90.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2211, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4001/4361 (91.7450%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3926/4361 (90.0252%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0603, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3316/3672 (90.3050%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3357/3672 (91.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9817, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4231/4481 (94.4209%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4048/4481 (90.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0258, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3833/4126 (92.8987%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3918/4126 (94.9588%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7552, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3634/3969 (91.5596%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3621/3969 (91.2320%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9627, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4733/5116 (92.5137%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4663/5116 (91.1454%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9988, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4508/5063 (89.0381%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4382/5063 (86.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0155, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3051/3297 (92.5387%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3098/3297 (93.9642%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7524, Accuracy: 6001/10000 (60.0100%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4531/5037 (89.9543%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4647/5037 (92.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0285, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4201/4596 (91.4056%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4279/4596 (93.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0187, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4041/4501 (89.7800%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4030/4501 (89.5357%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9506, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4136/4465 (92.6316%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4186/4465 (93.7514%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9300, Accuracy: 5772/10000 (57.7200%)
time spent on training: 260.547847032547
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.6584, Accuracy: 6092/10000 (60.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 8.9321, Accuracy: 128/9900 (1.2929%)
Done in 289.58102464675903 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4516/4885 (92.4463%), train_poison_data_count: 385
Global model norm: 44.80267336907057.
Norm before scaling: 44.79039999420216. Distance: 2.0454644154782535
Total norm for 4 adversaries is: 44.79039999420216. distance: 2.0454644154782535
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1574, Accuracy: 9472/9900 (95.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4851/5305 (91.4420%), train_poison_data_count: 415
Global model norm: 44.80267336907057.
Norm before scaling: 44.79028144054732. Distance: 2.1294612056210642
Total norm for 4 adversaries is: 44.79028144054732. distance: 2.1294612056210642
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1294, Accuracy: 9586/9900 (96.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4324/4717 (91.6684%), train_poison_data_count: 370
Global model norm: 44.80267336907057.
Norm before scaling: 44.79323701220141. Distance: 1.9899127614245917
Total norm for 4 adversaries is: 44.79323701220141. distance: 1.9899127614245917
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.2420, Accuracy: 9336/9900 (94.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 44.80267336907057.
Norm before scaling: 44.798022199297485. Distance: 2.167798174771856
Total norm for 4 adversaries is: 44.798022199297485. distance: 2.167798174771856
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.2274, Accuracy: 9297/9900 (93.9091%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3968/4361 (90.9883%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4015/4361 (92.0660%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9707, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4083/4346 (93.9485%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4126/4346 (94.9379%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7894, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5002/5455 (91.6957%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5002/5455 (91.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9365, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4173/4465 (93.4602%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4208/4465 (94.2441%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7653, Accuracy: 5936/10000 (59.3600%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3942/4336 (90.9133%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3962/4336 (91.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1585, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4147/4441 (93.3799%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4153/4441 (93.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0046, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4003/4362 (91.7698%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3998/4362 (91.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9710, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3630/3969 (91.4588%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3669/3969 (92.4414%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0599, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3889/4295 (90.5471%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3915/4295 (91.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9861, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4593/5017 (91.5487%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4641/5017 (92.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9184, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4506/5063 (88.9986%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4417/5063 (87.2408%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2274, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3005/3271 (91.8679%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2968/3271 (90.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8390, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5842/6263 (93.2780%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5785/6263 (92.3679%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9929, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4411/4874 (90.5006%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4330/4874 (88.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1510, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3577/3911 (91.4600%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3472/3911 (88.7752%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0551, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4421/4804 (92.0275%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4342/4804 (90.3830%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1372, Accuracy: 5332/10000 (53.3200%)
time spent on training: 264.53940296173096
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7409, Accuracy: 5975/10000 (59.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 8.5218, Accuracy: 159/9900 (1.6061%)
Done in 293.5272846221924 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4510/4885 (92.3234%), train_poison_data_count: 385
Global model norm: 44.83096916082049.
Norm before scaling: 44.820483402367216. Distance: 2.0224454944560692
Total norm for 4 adversaries is: 44.820483402367216. distance: 2.0224454944560692
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1042, Accuracy: 9626/9900 (97.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4853/5305 (91.4797%), train_poison_data_count: 415
Global model norm: 44.83096916082049.
Norm before scaling: 44.81847883319865. Distance: 2.1392670939695257
Total norm for 4 adversaries is: 44.81847883319865. distance: 2.1392670939695257
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.2556, Accuracy: 9269/9900 (93.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 44.83096916082049.
Norm before scaling: 44.82079524644155. Distance: 2.0247249557768114
Total norm for 4 adversaries is: 44.82079524644155. distance: 2.0247249557768114
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1599, Accuracy: 9483/9900 (95.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 44.83096916082049.
Norm before scaling: 44.82287460539122. Distance: 2.179133628560733
Total norm for 4 adversaries is: 44.82287460539122. distance: 2.179133628560733
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1287, Accuracy: 9580/9900 (96.7677%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5290/5902 (89.6306%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5092/5902 (86.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1412, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4562/4918 (92.7613%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4567/4918 (92.8630%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1466, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3713/4025 (92.2484%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3766/4025 (93.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8173, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3230/3472 (93.0300%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3201/3472 (92.1947%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0849, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4368/4793 (91.1329%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4433/4793 (92.4890%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0232, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4457/4934 (90.3324%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4352/4934 (88.2043%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2334, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3625/3911 (92.6873%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3580/3911 (91.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9190, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4990/5392 (92.5445%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4856/5392 (90.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1453, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3372/3638 (92.6883%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3393/3638 (93.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7627, Accuracy: 5911/10000 (59.1100%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5553/6124 (90.6760%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5486/6124 (89.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0365, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3815/4175 (91.3772%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3794/4175 (90.8743%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9843, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4143/4625 (89.5784%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4086/4625 (88.3459%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1073, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3986/4354 (91.5480%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3731/4354 (85.6913%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2903, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4102/4511 (90.9333%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4152/4511 (92.0417%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0773, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3453/3704 (93.2235%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3464/3704 (93.5205%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8255, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3642/3861 (94.3279%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3636/3861 (94.1725%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8233, Accuracy: 5846/10000 (58.4600%)
time spent on training: 264.5352303981781
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7551, Accuracy: 5937/10000 (59.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 8.4249, Accuracy: 160/9900 (1.6162%)
Done in 293.54063534736633 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4543/4885 (92.9990%), train_poison_data_count: 385
Global model norm: 44.84919528132932.
Norm before scaling: 44.83661065773636. Distance: 1.996934209909905
Total norm for 4 adversaries is: 44.83661065773636. distance: 1.996934209909905
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0691, Accuracy: 9715/9900 (98.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4875/5305 (91.8944%), train_poison_data_count: 415
Global model norm: 44.84919528132932.
Norm before scaling: 44.83542905161261. Distance: 2.0885111615497114
Total norm for 4 adversaries is: 44.83542905161261. distance: 2.0885111615497114
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0989, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 44.84919528132932.
Norm before scaling: 44.83874781552293. Distance: 2.0203972440973827
Total norm for 4 adversaries is: 44.83874781552293. distance: 2.0203972440973827
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.2582, Accuracy: 9283/9900 (93.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4643/5066 (91.6502%), train_poison_data_count: 400
Global model norm: 44.84919528132932.
Norm before scaling: 44.83948558774328. Distance: 2.1248365227142765
Total norm for 4 adversaries is: 44.83948558774328. distance: 2.1248365227142765
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1478, Accuracy: 9544/9900 (96.4040%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4580/5083 (90.1043%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4465/5083 (87.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4890, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3335/3646 (91.4701%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3344/3646 (91.7170%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8693, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4106/4503 (91.1837%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4100/4503 (91.0504%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9056, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4087/4501 (90.8020%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4054/4501 (90.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9600, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3715/4013 (92.5741%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3732/4013 (92.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8231, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4079/4362 (93.5122%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4042/4362 (92.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9612, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4006/4315 (92.8389%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3991/4315 (92.4913%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8727, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4259/4651 (91.5717%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4250/4651 (91.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0404, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3988/4416 (90.3080%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4052/4416 (91.7572%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0293, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3398/3704 (91.7387%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3470/3704 (93.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8454, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4355/4707 (92.5218%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4367/4707 (92.7767%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9261, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4236/4662 (90.8623%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4318/4662 (92.6212%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9272, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5009/5424 (92.3488%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5001/5424 (92.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2425, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3950/4336 (91.0978%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3990/4336 (92.0203%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9339, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4175/4481 (93.1712%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4060/4481 (90.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9970, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3545/3828 (92.6071%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3587/3828 (93.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8685, Accuracy: 5778/10000 (57.7800%)
time spent on training: 261.17677426338196
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7277, Accuracy: 5986/10000 (59.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 8.6318, Accuracy: 133/9900 (1.3434%)
Done in 290.1508321762085 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4518/4885 (92.4872%), train_poison_data_count: 385
Global model norm: 44.86796765493591.
Norm before scaling: 44.85508758029503. Distance: 2.0453331651219213
Total norm for 4 adversaries is: 44.85508758029503. distance: 2.0453331651219213
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0724, Accuracy: 9702/9900 (98.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4890/5305 (92.1772%), train_poison_data_count: 415
Global model norm: 44.86796765493591.
Norm before scaling: 44.85579514843581. Distance: 2.1308979761698987
Total norm for 4 adversaries is: 44.85579514843581. distance: 2.1308979761698987
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1359, Accuracy: 9572/9900 (96.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 44.86796765493591.
Norm before scaling: 44.856697281628136. Distance: 2.0728015835763705
Total norm for 4 adversaries is: 44.856697281628136. distance: 2.0728015835763705
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1191, Accuracy: 9581/9900 (96.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4603/5066 (90.8606%), train_poison_data_count: 400
Global model norm: 44.86796765493591.
Norm before scaling: 44.85941717822817. Distance: 2.2241823558556546
Total norm for 4 adversaries is: 44.85941717822817. distance: 2.2241823558556546
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1116, Accuracy: 9604/9900 (97.0101%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3792/4184 (90.6310%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3857/4184 (92.1845%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9420, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4519/5037 (89.7161%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4643/5037 (92.1779%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9128, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3742/4158 (89.9952%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3730/4158 (89.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9091, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2998/3271 (91.6539%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3015/3271 (92.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8587, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4558/4918 (92.6800%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4557/4918 (92.6596%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1114, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5280/5902 (89.4612%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5086/5902 (86.1742%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1845, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4012/4354 (92.1452%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0120, Accuracy: 3433/4354 (78.8470%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.5762, Accuracy: 4590/10000 (45.9000%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3632/3969 (91.5092%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3604/3969 (90.8037%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9682, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4067/4356 (93.3655%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3907/4356 (89.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1188, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3925/4295 (91.3853%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3790/4295 (88.2421%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1584, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3831/4126 (92.8502%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3911/4126 (94.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7845, Accuracy: 5916/10000 (59.1600%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4508/4928 (91.4773%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4512/4928 (91.5584%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9592, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4087/4511 (90.6008%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4113/4511 (91.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9912, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4186/4618 (90.6453%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4241/4618 (91.8363%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0109, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3417/3704 (92.2516%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3448/3704 (93.0886%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7996, Accuracy: 5921/10000 (59.2100%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3348/3616 (92.5885%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3391/3616 (93.7777%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8975, Accuracy: 5838/10000 (58.3800%)
time spent on training: 260.0600163936615
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7105, Accuracy: 6004/10000 (60.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 8.4702, Accuracy: 149/9900 (1.5051%)
Done in 289.09813928604126 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4524/4885 (92.6100%), train_poison_data_count: 385
Global model norm: 44.88409688654003.
Norm before scaling: 44.871813137623626. Distance: 1.9948708208944945
Total norm for 4 adversaries is: 44.871813137623626. distance: 1.9948708208944945
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1438, Accuracy: 9554/9900 (96.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4884/5305 (92.0641%), train_poison_data_count: 415
Global model norm: 44.88409688654003.
Norm before scaling: 44.87174784742413. Distance: 2.1113297059285245
Total norm for 4 adversaries is: 44.87174784742413. distance: 2.1113297059285245
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0823, Accuracy: 9688/9900 (97.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4332/4717 (91.8380%), train_poison_data_count: 370
Global model norm: 44.88409688654003.
Norm before scaling: 44.87580518079871. Distance: 2.015057032797947
Total norm for 4 adversaries is: 44.87580518079871. distance: 2.015057032797947
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1367, Accuracy: 9555/9900 (96.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4620/5066 (91.1962%), train_poison_data_count: 400
Global model norm: 44.88409688654003.
Norm before scaling: 44.878858480096866. Distance: 2.177706785839814
Total norm for 4 adversaries is: 44.878858480096866. distance: 2.177706785839814
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.2160, Accuracy: 9351/9900 (94.4545%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2944/3271 (90.0031%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3055/3271 (93.3965%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9543, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4128/4456 (92.6391%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4191/4456 (94.0530%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9047, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3739/4013 (93.1722%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3793/4013 (94.5178%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.6849, Accuracy: 5986/10000 (59.8600%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3501/3781 (92.5946%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3449/3781 (91.2193%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2222, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3501/3775 (92.7417%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3622/3775 (95.9470%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7545, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4639/5232 (88.6659%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4607/5232 (88.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0942, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4555/4989 (91.3009%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4579/4989 (91.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0701, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3291/3646 (90.2633%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3360/3646 (92.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8482, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4024/4315 (93.2561%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4030/4315 (93.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8423, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4563/4918 (92.7816%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4552/4918 (92.5580%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1166, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3963/4416 (89.7418%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3977/4416 (90.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9260, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5773/6263 (92.1763%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5788/6263 (92.4158%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9995, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5576/6124 (91.0516%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5471/6124 (89.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9941, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4230/4651 (90.9482%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4255/4651 (91.4857%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0141, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4059/4356 (93.1818%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3863/4356 (88.6823%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2965, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4066/4356 (93.3425%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3819/4356 (87.6722%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2421, Accuracy: 5142/10000 (51.4200%)
time spent on training: 258.5532464981079
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7667, Accuracy: 5925/10000 (59.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 9.0194, Accuracy: 106/9900 (1.0707%)
Done in 287.5594789981842 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4513/4885 (92.3849%), train_poison_data_count: 385
Global model norm: 44.91280343186534.
Norm before scaling: 44.900111575933195. Distance: 2.0332660940132063
Total norm for 4 adversaries is: 44.900111575933195. distance: 2.0332660940132063
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1414, Accuracy: 9531/9900 (96.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4879/5305 (91.9698%), train_poison_data_count: 415
Global model norm: 44.91280343186534.
Norm before scaling: 44.90115146987115. Distance: 2.1182224798522964
Total norm for 4 adversaries is: 44.90115146987115. distance: 2.1182224798522964
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1883, Accuracy: 9426/9900 (95.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4332/4717 (91.8380%), train_poison_data_count: 370
Global model norm: 44.91280343186534.
Norm before scaling: 44.90207308123075. Distance: 1.9887767241844512
Total norm for 4 adversaries is: 44.90207308123075. distance: 1.9887767241844512
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.2234, Accuracy: 9363/9900 (94.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4658/5066 (91.9463%), train_poison_data_count: 400
Global model norm: 44.91280343186534.
Norm before scaling: 44.90468149226621. Distance: 2.139303091603179
Total norm for 4 adversaries is: 44.90468149226621. distance: 2.139303091603179
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1408, Accuracy: 9546/9900 (96.4242%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4332/4716 (91.8575%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4311/4716 (91.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8318, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4192/4634 (90.4618%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4206/4634 (90.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9063, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3623/3828 (94.6447%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3629/3828 (94.8015%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8013, Accuracy: 5938/10000 (59.3800%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4555/4989 (91.3009%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4568/4989 (91.5614%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0517, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4718/5116 (92.2205%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4682/5116 (91.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0096, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4009/4362 (91.9074%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4039/4362 (92.5951%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0282, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4603/5017 (91.7481%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4636/5017 (92.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.7766, Accuracy: 5957/10000 (59.5700%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4043/4354 (92.8571%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3582/4354 (82.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.5394, Accuracy: 4891/10000 (48.9100%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3322/3638 (91.3139%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3386/3638 (93.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8486, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4716/5195 (90.7796%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4607/5195 (88.6814%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0790, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4156/4596 (90.4265%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4271/4596 (92.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0541, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4450/4928 (90.3003%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4488/4928 (91.0714%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0475, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4640/5244 (88.4821%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4584/5244 (87.4142%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0296, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5320/5902 (90.1389%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5150/5902 (87.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2006, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4607/5025 (91.6816%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4672/5025 (92.9751%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0968, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5607/6124 (91.5578%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5479/6124 (89.4677%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0791, Accuracy: 5414/10000 (54.1400%)
time spent on training: 267.1671578884125
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8044, Accuracy: 5895/10000 (58.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 9.1113, Accuracy: 108/9900 (1.0909%)
Done in 295.81801104545593 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 44.94993552944835.
Norm before scaling: 44.945277871314666. Distance: 2.1129715387582237
Total norm for 4 adversaries is: 44.945277871314666. distance: 2.1129715387582237
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0652, Accuracy: 9732/9900 (98.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4877/5305 (91.9321%), train_poison_data_count: 415
Global model norm: 44.94993552944835.
Norm before scaling: 44.94021228993097. Distance: 2.1075009533573406
Total norm for 4 adversaries is: 44.94021228993097. distance: 2.1075009533573406
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.3067, Accuracy: 9175/9900 (92.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 44.94993552944835.
Norm before scaling: 44.943664552397564. Distance: 2.0662991761011402
Total norm for 4 adversaries is: 44.943664552397564. distance: 2.0662991761011402
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0683, Accuracy: 9719/9900 (98.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4645/5066 (91.6897%), train_poison_data_count: 400
Global model norm: 44.94993552944835.
Norm before scaling: 44.9418162261287. Distance: 2.1322813385708805
Total norm for 4 adversaries is: 44.9418162261287. distance: 2.1322813385708805
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1045, Accuracy: 9611/9900 (97.0808%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4718/5116 (92.2205%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4662/5116 (91.1259%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0500, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4747/5197 (91.3412%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4709/5197 (90.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1295, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4098/4356 (94.0771%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3824/4356 (87.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1090, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4299/4679 (91.8786%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4067/4679 (86.9203%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1155, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4365/4647 (93.9316%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4362/4647 (93.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9046, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3562/3911 (91.0765%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3425/3911 (87.5735%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3133, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4007/4315 (92.8621%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4092/4315 (94.8320%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8875, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3262/3646 (89.4679%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3353/3646 (91.9638%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7353, Accuracy: 5950/10000 (59.5000%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4212/4634 (90.8934%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4246/4634 (91.6271%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8939, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4693/5055 (92.8388%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4726/5055 (93.4916%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9114, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4041/4362 (92.6410%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4001/4362 (91.7240%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0238, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4475/4934 (90.6972%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4232/4934 (85.7722%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2830, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4261/4767 (89.3854%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4280/4767 (89.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2674, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4114/4433 (92.8040%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4128/4433 (93.1198%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8651, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4381/4928 (88.9002%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4435/4928 (89.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9703, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3630/3837 (94.6052%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3659/3837 (95.3610%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7610, Accuracy: 5960/10000 (59.6000%)
time spent on training: 265.3857388496399
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7895, Accuracy: 5902/10000 (59.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 9.1388, Accuracy: 108/9900 (1.0909%)
Done in 294.0989227294922 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4510/4885 (92.3234%), train_poison_data_count: 385
Global model norm: 44.96630683078165.
Norm before scaling: 44.95399938322368. Distance: 2.0554668848427258
Total norm for 4 adversaries is: 44.95399938322368. distance: 2.0554668848427258
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1191, Accuracy: 9603/9900 (97.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4872/5305 (91.8379%), train_poison_data_count: 415
Global model norm: 44.96630683078165.
Norm before scaling: 44.95682471958165. Distance: 2.1512970360995056
Total norm for 4 adversaries is: 44.95682471958165. distance: 2.1512970360995056
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1711, Accuracy: 9480/9900 (95.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4307/4717 (91.3080%), train_poison_data_count: 370
Global model norm: 44.96630683078165.
Norm before scaling: 44.95552543990699. Distance: 2.0550901069284566
Total norm for 4 adversaries is: 44.95552543990699. distance: 2.0550901069284566
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1596, Accuracy: 9496/9900 (95.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4585/5066 (90.5053%), train_poison_data_count: 400
Global model norm: 44.96630683078165.
Norm before scaling: 44.966374698385735. Distance: 2.2445291128125158
Total norm for 4 adversaries is: 44.966374698385735. distance: 2.2445291128125158
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1887, Accuracy: 9430/9900 (95.2525%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4581/4986 (91.8773%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4555/4986 (91.3558%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8647, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4250/4767 (89.1546%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4255/4767 (89.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1569, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3995/4315 (92.5840%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4043/4315 (93.6964%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8787, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3357/3672 (91.4216%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3346/3672 (91.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9738, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4130/4558 (90.6099%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4044/4558 (88.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2778, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3641/3828 (95.1149%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3639/3828 (95.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8714, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4266/4679 (91.1733%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4193/4679 (89.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0988, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4483/4956 (90.4560%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4417/4956 (89.1243%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0552, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4067/4356 (93.3655%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3948/4356 (90.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1101, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4208/4538 (92.7281%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4289/4538 (94.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8008, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3739/4013 (93.1722%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3825/4013 (95.3152%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7415, Accuracy: 5962/10000 (59.6200%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4835/5265 (91.8329%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4803/5265 (91.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9508, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4330/4663 (92.8587%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4337/4663 (93.0088%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0471, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5819/6263 (92.9107%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5789/6263 (92.4317%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0188, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4496/5063 (88.8011%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4276/5063 (84.4559%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2751, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3954/4416 (89.5380%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4073/4416 (92.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9829, Accuracy: 5566/10000 (55.6600%)
time spent on training: 264.2522931098938
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7534, Accuracy: 5961/10000 (59.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 8.8039, Accuracy: 141/9900 (1.4242%)
Done in 293.232638835907 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4494/4885 (91.9959%), train_poison_data_count: 385
Global model norm: 44.98975035181625.
Norm before scaling: 44.97748595868896. Distance: 2.0841883494293927
Total norm for 4 adversaries is: 44.97748595868896. distance: 2.0841883494293927
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1593, Accuracy: 9514/9900 (96.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4908/5305 (92.5165%), train_poison_data_count: 415
Global model norm: 44.98975035181625.
Norm before scaling: 44.97571094708023. Distance: 2.055115049719657
Total norm for 4 adversaries is: 44.97571094708023. distance: 2.055115049719657
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1367, Accuracy: 9562/9900 (96.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4329/4717 (91.7744%), train_poison_data_count: 370
Global model norm: 44.98975035181625.
Norm before scaling: 44.97912791775967. Distance: 2.0294351539824995
Total norm for 4 adversaries is: 44.97912791775967. distance: 2.0294351539824995
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1877, Accuracy: 9438/9900 (95.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4644/5066 (91.6700%), train_poison_data_count: 400
Global model norm: 44.98975035181625.
Norm before scaling: 44.979976013638556. Distance: 2.1136970604527745
Total norm for 4 adversaries is: 44.979976013638556. distance: 2.1136970604527745
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.2303, Accuracy: 9333/9900 (94.2727%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5324/5740 (92.7526%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5272/5740 (91.8467%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0286, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4240/4651 (91.1632%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4296/4651 (92.3672%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9984, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4111/4503 (91.2947%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4013/4503 (89.1184%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0932, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4279/4767 (89.7630%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4266/4767 (89.4902%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.4119, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5076/5591 (90.7888%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4960/5591 (88.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1316, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4138/4465 (92.6764%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4219/4465 (94.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8023, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4518/4956 (91.1622%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4490/4956 (90.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1229, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3405/3704 (91.9276%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3444/3704 (92.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8511, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3744/4025 (93.0186%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3791/4025 (94.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7819, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4626/5083 (91.0092%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4506/5083 (88.6484%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.4026, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5683/6124 (92.7988%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5580/6124 (91.1169%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9688, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3912/4295 (91.0827%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3849/4295 (89.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0125, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4452/4804 (92.6728%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4319/4804 (89.9042%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0504, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4476/4793 (93.3862%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4490/4793 (93.6783%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9642, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4112/4433 (92.7589%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4139/4433 (93.3679%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9210, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3961/4361 (90.8278%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3859/4361 (88.4889%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0220, Accuracy: 5504/10000 (55.0400%)
time spent on training: 267.43639636039734
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7858, Accuracy: 5930/10000 (59.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 9.2021, Accuracy: 111/9900 (1.1212%)
Done in 297.03099727630615 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4526/4885 (92.6510%), train_poison_data_count: 385
Global model norm: 45.01665680221531.
Norm before scaling: 45.00895228877042. Distance: 2.0885728055260975
Total norm for 4 adversaries is: 45.00895228877042. distance: 2.0885728055260975
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0889, Accuracy: 9668/9900 (97.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4873/5305 (91.8567%), train_poison_data_count: 415
Global model norm: 45.01665680221531.
Norm before scaling: 45.00069715171783. Distance: 2.1090642629557546
Total norm for 4 adversaries is: 45.00069715171783. distance: 2.1090642629557546
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1368, Accuracy: 9566/9900 (96.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4315/4717 (91.4776%), train_poison_data_count: 370
Global model norm: 45.01665680221531.
Norm before scaling: 45.00822407488436. Distance: 2.0366894004705918
Total norm for 4 adversaries is: 45.00822407488436. distance: 2.0366894004705918
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.3438, Accuracy: 9065/9900 (91.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4629/5066 (91.3739%), train_poison_data_count: 400
Global model norm: 45.01665680221531.
Norm before scaling: 45.00909738770874. Distance: 2.1482900118054356
Total norm for 4 adversaries is: 45.00909738770874. distance: 2.1482900118054356
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1661, Accuracy: 9464/9900 (95.5960%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4184/4558 (91.7946%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4119/4558 (90.3686%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1703, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4224/4596 (91.9060%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4276/4596 (93.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0404, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4436/4874 (91.0135%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4340/4874 (89.0439%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1622, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3757/4158 (90.3559%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3745/4158 (90.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0597, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5011/5455 (91.8607%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5011/5455 (91.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0360, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4047/4346 (93.1201%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4117/4346 (94.7308%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8477, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4294/4679 (91.7717%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4338/4679 (92.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9479, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4097/4416 (92.7763%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4067/4416 (92.0969%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.7673, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3604/3828 (94.1484%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3625/3828 (94.6970%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8516, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3946/4223 (93.4407%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4010/4223 (94.9562%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8719, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4803/5265 (91.2251%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4687/5265 (89.0218%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2010, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5653/6124 (92.3089%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5515/6124 (90.0555%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0110, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4087/4361 (93.7170%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3962/4361 (90.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0882, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4525/4956 (91.3035%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4422/4956 (89.2252%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1922, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5290/5740 (92.1603%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5272/5740 (91.8467%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1336, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3720/4013 (92.6987%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3750/4013 (93.4463%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8660, Accuracy: 5698/10000 (56.9800%)
time spent on training: 267.33644223213196
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.7486, Accuracy: 5988/10000 (59.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 9.2362, Accuracy: 108/9900 (1.0909%)
Done in 295.87184381484985 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4486/4885 (91.8321%), train_poison_data_count: 385
Global model norm: 45.03545695130116.
Norm before scaling: 45.02384486519685. Distance: 2.0445668259332557
Total norm for 4 adversaries is: 45.02384486519685. distance: 2.0445668259332557
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.2344, Accuracy: 9343/9900 (94.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4891/5305 (92.1960%), train_poison_data_count: 415
Global model norm: 45.03545695130116.
Norm before scaling: 45.02083800299798. Distance: 2.1029632324763115
Total norm for 4 adversaries is: 45.02083800299798. distance: 2.1029632324763115
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.3100, Accuracy: 9169/9900 (92.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4343/4717 (92.0712%), train_poison_data_count: 370
Global model norm: 45.03545695130116.
Norm before scaling: 45.01918536336758. Distance: 1.958300515840037
Total norm for 4 adversaries is: 45.01918536336758. distance: 1.958300515840037
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1778, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4614/5066 (91.0778%), train_poison_data_count: 400
Global model norm: 45.03545695130116.
Norm before scaling: 45.02683119367551. Distance: 2.1652153607530966
Total norm for 4 adversaries is: 45.02683119367551. distance: 2.1652153607530966
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1878, Accuracy: 9459/9900 (95.5455%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3822/4184 (91.3480%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3843/4184 (91.8499%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8422, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3366/3590 (93.7604%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3286/3590 (91.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1774, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3750/4158 (90.1876%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3713/4158 (89.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9245, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3742/4025 (92.9689%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3775/4025 (93.7888%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8631, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3737/4046 (92.3628%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3735/4046 (92.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8725, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4589/5025 (91.3234%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4611/5025 (91.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1128, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4484/5063 (88.5641%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4347/5063 (85.8582%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1079, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4116/4356 (94.4904%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4143/4356 (95.1102%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9347, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4246/4651 (91.2922%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4264/4651 (91.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9890, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4085/4356 (93.7787%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3933/4356 (90.2893%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1349, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4190/4576 (91.5647%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4201/4576 (91.8051%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9380, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4155/4456 (93.2451%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4184/4456 (93.8959%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9177, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3062/3297 (92.8723%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3127/3297 (94.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7321, Accuracy: 6014/10000 (60.1400%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4483/4804 (93.3181%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4306/4804 (89.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0985, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3658/3969 (92.1643%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3594/3969 (90.5518%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9979, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4760/5195 (91.6266%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4636/5195 (89.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1536, Accuracy: 5276/10000 (52.7600%)
time spent on training: 261.7510163784027
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8321, Accuracy: 5897/10000 (58.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 9.6213, Accuracy: 74/9900 (0.7475%)
Done in 290.7697947025299 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4516/4885 (92.4463%), train_poison_data_count: 385
Global model norm: 45.067314832491824.
Norm before scaling: 45.05356241550855. Distance: 2.057242194116061
Total norm for 4 adversaries is: 45.05356241550855. distance: 2.057242194116061
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1225, Accuracy: 9591/9900 (96.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4893/5305 (92.2337%), train_poison_data_count: 415
Global model norm: 45.067314832491824.
Norm before scaling: 45.05600220792938. Distance: 2.1572409301666173
Total norm for 4 adversaries is: 45.05600220792938. distance: 2.1572409301666173
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0946, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4345/4717 (92.1136%), train_poison_data_count: 370
Global model norm: 45.067314832491824.
Norm before scaling: 45.055425122928455. Distance: 2.0386464363143904
Total norm for 4 adversaries is: 45.055425122928455. distance: 2.0386464363143904
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.2296, Accuracy: 9328/9900 (94.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4639/5066 (91.5713%), train_poison_data_count: 400
Global model norm: 45.067314832491824.
Norm before scaling: 45.05859899897022. Distance: 2.1948677236893817
Total norm for 4 adversaries is: 45.05859899897022. distance: 2.1948677236893817
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1506, Accuracy: 9520/9900 (96.1616%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3678/3837 (95.8561%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0017, Accuracy: 3722/3837 (97.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.6864, Accuracy: 6131/10000 (61.3100%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5121/5582 (91.7413%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5093/5582 (91.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0343, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4987/5455 (91.4207%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4962/5455 (90.9624%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0105, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4250/4679 (90.8314%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4293/4679 (91.7504%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9568, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4151/4518 (91.8769%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4188/4518 (92.6959%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0070, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4255/4618 (92.1395%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4274/4618 (92.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0080, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4354/4716 (92.3240%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4330/4716 (91.8151%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0451, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4635/5244 (88.3867%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4682/5244 (89.2830%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1663, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4432/4874 (90.9315%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4274/4874 (87.6898%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3039, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4371/4928 (88.6972%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4448/4928 (90.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0135, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3858/4126 (93.5046%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3894/4126 (94.3771%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8121, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3589/3828 (93.7565%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3617/3828 (94.4880%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8066, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3208/3472 (92.3963%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3227/3472 (92.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9871, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3355/3638 (92.2210%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3407/3638 (93.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7536, Accuracy: 5926/10000 (59.2600%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3356/3590 (93.4819%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3297/3590 (91.8384%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0305, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3941/4223 (93.3223%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3934/4223 (93.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9561, Accuracy: 5605/10000 (56.0500%)
time spent on training: 261.80882501602173
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8176, Accuracy: 5884/10000 (58.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 9.6076, Accuracy: 58/9900 (0.5859%)
Done in 290.7682514190674 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4516/4885 (92.4463%), train_poison_data_count: 385
Global model norm: 45.08797417315467.
Norm before scaling: 45.07708918870608. Distance: 2.05288152775217
Total norm for 4 adversaries is: 45.07708918870608. distance: 2.05288152775217
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.2734, Accuracy: 9222/9900 (93.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4879/5305 (91.9698%), train_poison_data_count: 415
Global model norm: 45.08797417315467.
Norm before scaling: 45.07574733764128. Distance: 2.148694498123139
Total norm for 4 adversaries is: 45.07574733764128. distance: 2.148694498123139
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1421, Accuracy: 9555/9900 (96.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4334/4717 (91.8804%), train_poison_data_count: 370
Global model norm: 45.08797417315467.
Norm before scaling: 45.07682380054425. Distance: 2.0158504389583407
Total norm for 4 adversaries is: 45.07682380054425. distance: 2.0158504389583407
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1368, Accuracy: 9544/9900 (96.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4612/5066 (91.0383%), train_poison_data_count: 400
Global model norm: 45.08797417315467.
Norm before scaling: 45.07880198798405. Distance: 2.1974390122561878
Total norm for 4 adversaries is: 45.07880198798405. distance: 2.1974390122561878
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0660, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4081/4441 (91.8937%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4115/4441 (92.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9349, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4602/5017 (91.7281%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4668/5017 (93.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8424, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4611/4918 (93.7576%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4597/4918 (93.4730%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9855, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4792/5197 (92.2070%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4692/5197 (90.2829%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1472, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4103/4356 (94.1919%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3744/4356 (85.9504%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.4160, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5024/5455 (92.0990%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4910/5455 (90.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2106, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3046/3297 (92.3870%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3113/3297 (94.4192%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7540, Accuracy: 6005/10000 (60.0500%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4885/5195 (94.0327%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4861/5195 (93.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9183, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3626/3828 (94.7231%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3617/3828 (94.4880%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7521, Accuracy: 6053/10000 (60.5300%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4180/4456 (93.8061%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4142/4456 (92.9533%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9521, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4072/4361 (93.3731%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3938/4361 (90.3004%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1984, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3939/4235 (93.0106%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3899/4235 (92.0661%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9833, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4582/5025 (91.1841%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4627/5025 (92.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1634, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3292/3646 (90.2907%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3371/3646 (92.4575%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7995, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3734/4158 (89.8028%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3733/4158 (89.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9172, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4259/4538 (93.8519%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4311/4538 (94.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7634, Accuracy: 5955/10000 (59.5500%)
time spent on training: 263.7633183002472
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7995, Accuracy: 5901/10000 (59.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 9.2889, Accuracy: 88/9900 (0.8889%)
Done in 292.51951026916504 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4543/4885 (92.9990%), train_poison_data_count: 385
Global model norm: 45.107473927294606.
Norm before scaling: 45.09199851501511. Distance: 1.9909042114674658
Total norm for 4 adversaries is: 45.09199851501511. distance: 1.9909042114674658
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2734, Accuracy: 9241/9900 (93.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4883/5305 (92.0452%), train_poison_data_count: 415
Global model norm: 45.107473927294606.
Norm before scaling: 45.09551495160023. Distance: 2.1393756422687695
Total norm for 4 adversaries is: 45.09551495160023. distance: 2.1393756422687695
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1623, Accuracy: 9496/9900 (95.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4308/4717 (91.3292%), train_poison_data_count: 370
Global model norm: 45.107473927294606.
Norm before scaling: 45.096328376130714. Distance: 2.059861431646369
Total norm for 4 adversaries is: 45.096328376130714. distance: 2.059861431646369
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1306, Accuracy: 9591/9900 (96.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4633/5066 (91.4528%), train_poison_data_count: 400
Global model norm: 45.107473927294606.
Norm before scaling: 45.102245225865005. Distance: 2.217732585764219
Total norm for 4 adversaries is: 45.102245225865005. distance: 2.217732585764219
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2170, Accuracy: 9305/9900 (93.9899%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3938/4295 (91.6880%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3901/4295 (90.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0561, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5133/5582 (91.9563%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5097/5582 (91.3114%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1718, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3289/3672 (89.5697%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3370/3672 (91.7756%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0183, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4159/4518 (92.0540%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4169/4518 (92.2753%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9572, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3591/3797 (94.5747%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3569/3797 (93.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8903, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4082/4362 (93.5809%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3929/4362 (90.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1880, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4455/4804 (92.7352%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3988/4804 (83.0142%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3234, Accuracy: 4957/10000 (49.5700%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4685/5116 (91.5754%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4664/5116 (91.1650%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9099, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4572/5025 (90.9851%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4618/5025 (91.9005%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1900, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3069/3297 (93.0846%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3121/3297 (94.6618%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7507, Accuracy: 6053/10000 (60.5300%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3419/3704 (92.3056%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3465/3704 (93.5475%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8112, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5038/5424 (92.8835%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5017/5424 (92.4963%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1684, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3671/3861 (95.0790%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3665/3861 (94.9236%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8163, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4450/4874 (91.3008%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4359/4874 (89.4337%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2638, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4351/4647 (93.6303%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4324/4647 (93.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8003, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4115/4356 (94.4674%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3874/4356 (88.9348%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2943, Accuracy: 5054/10000 (50.5400%)
time spent on training: 260.6577537059784
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8853, Accuracy: 5798/10000 (57.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 9.0807, Accuracy: 111/9900 (1.1212%)
Done in 289.7936809062958 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4525/4885 (92.6305%), train_poison_data_count: 385
Global model norm: 45.13308634913457.
Norm before scaling: 45.122846641834336. Distance: 2.0996772790618317
Total norm for 4 adversaries is: 45.122846641834336. distance: 2.0996772790618317
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1702, Accuracy: 9499/9900 (95.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4864/5305 (91.6871%), train_poison_data_count: 415
Global model norm: 45.13308634913457.
Norm before scaling: 45.12194982982575. Distance: 2.147089087682567
Total norm for 4 adversaries is: 45.12194982982575. distance: 2.147089087682567
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1427, Accuracy: 9549/9900 (96.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4326/4717 (91.7108%), train_poison_data_count: 370
Global model norm: 45.13308634913457.
Norm before scaling: 45.120789223119615. Distance: 2.036954528248627
Total norm for 4 adversaries is: 45.120789223119615. distance: 2.036954528248627
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1309, Accuracy: 9550/9900 (96.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4598/5066 (90.7619%), train_poison_data_count: 400
Global model norm: 45.13308634913457.
Norm before scaling: 45.1268570536334. Distance: 2.235388785902668
Total norm for 4 adversaries is: 45.1268570536334. distance: 2.235388785902668
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1149, Accuracy: 9607/9900 (97.0404%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4098/4503 (91.0060%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4074/4503 (90.4730%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9133, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3633/3861 (94.0948%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3667/3861 (94.9754%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7551, Accuracy: 6001/10000 (60.0100%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3817/4184 (91.2285%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3822/4184 (91.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9442, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4128/4518 (91.3679%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4139/4518 (91.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0418, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4620/5083 (90.8912%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4567/5083 (89.8485%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3312, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4477/4804 (93.1932%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3915/4804 (81.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3828, Accuracy: 4964/10000 (49.6400%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4165/4356 (95.6152%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3980/4356 (91.3682%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0603, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4576/5244 (87.2616%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4615/5244 (88.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0227, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4311/4679 (92.1351%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4167/4679 (89.0575%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3075, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4018/4416 (90.9873%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4039/4416 (91.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9514, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4583/4918 (93.1883%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4571/4918 (92.9443%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1665, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3369/3616 (93.1692%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3430/3616 (94.8562%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7323, Accuracy: 6062/10000 (60.6200%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4176/4576 (91.2587%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4186/4576 (91.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9678, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4483/4928 (90.9700%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4489/4928 (91.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9924, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3806/4013 (94.8418%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3818/4013 (95.1408%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7715, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3960/4336 (91.3284%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3995/4336 (92.1356%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0981, Accuracy: 5484/10000 (54.8400%)
time spent on training: 264.73035430908203
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8645, Accuracy: 5818/10000 (58.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 9.0257, Accuracy: 145/9900 (1.4646%)
Done in 293.7452747821808 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4505/4885 (92.2211%), train_poison_data_count: 385
Global model norm: 45.15542413820916.
Norm before scaling: 45.145761379201616. Distance: 2.0844666513770673
Total norm for 4 adversaries is: 45.145761379201616. distance: 2.0844666513770673
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1052, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4904/5305 (92.4411%), train_poison_data_count: 415
Global model norm: 45.15542413820916.
Norm before scaling: 45.14315067354487. Distance: 2.121986945770982
Total norm for 4 adversaries is: 45.14315067354487. distance: 2.121986945770982
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1841, Accuracy: 9489/9900 (95.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4320/4717 (91.5836%), train_poison_data_count: 370
Global model norm: 45.15542413820916.
Norm before scaling: 45.145562640993575. Distance: 2.080475130834188
Total norm for 4 adversaries is: 45.145562640993575. distance: 2.080475130834188
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1066, Accuracy: 9624/9900 (97.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4615/5066 (91.0975%), train_poison_data_count: 400
Global model norm: 45.15542413820916.
Norm before scaling: 45.14842736091771. Distance: 2.2321600973280926
Total norm for 4 adversaries is: 45.14842736091771. distance: 2.2321600973280926
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1525, Accuracy: 9514/9900 (96.1010%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5826/6263 (93.0225%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5822/6263 (92.9586%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9996, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3239/3472 (93.2892%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3233/3472 (93.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9620, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3763/4158 (90.5002%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3796/4158 (91.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8899, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3323/3638 (91.3414%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3425/3638 (94.1451%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9645, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4442/4874 (91.1366%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4233/4874 (86.8486%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3348, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4088/4356 (93.8476%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3637/4356 (83.4940%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2712, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4290/4538 (94.5350%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4333/4538 (95.4826%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.7453, Accuracy: 5966/10000 (59.6600%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4479/4928 (90.8888%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4528/4928 (91.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9680, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4252/4618 (92.0745%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4226/4618 (91.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0515, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4379/4707 (93.0317%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4404/4707 (93.5628%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8720, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4277/4679 (91.4084%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4193/4679 (89.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2892, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4333/4647 (93.2430%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4359/4647 (93.8025%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9254, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4204/4576 (91.8706%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4205/4576 (91.8925%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0906, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3751/4046 (92.7088%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3773/4046 (93.2526%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9187, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4228/4651 (90.9052%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4264/4651 (91.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0819, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4663/5055 (92.2453%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4687/5055 (92.7201%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9217, Accuracy: 5796/10000 (57.9600%)
time spent on training: 264.81314516067505
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8685, Accuracy: 5844/10000 (58.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 9.2834, Accuracy: 108/9900 (1.0909%)
Done in 293.4577405452728 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4496/4885 (92.0368%), train_poison_data_count: 385
Global model norm: 45.18100262330258.
Norm before scaling: 45.16994818183878. Distance: 2.1291556395999756
Total norm for 4 adversaries is: 45.16994818183878. distance: 2.1291556395999756
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.3926, Accuracy: 8941/9900 (90.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4810/5305 (90.6692%), train_poison_data_count: 415
Global model norm: 45.18100262330258.
Norm before scaling: 45.174724540440614. Distance: 2.2495452633263797
Total norm for 4 adversaries is: 45.174724540440614. distance: 2.2495452633263797
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0905, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4319/4717 (91.5624%), train_poison_data_count: 370
Global model norm: 45.18100262330258.
Norm before scaling: 45.17107915028777. Distance: 2.060719617500028
Total norm for 4 adversaries is: 45.17107915028777. distance: 2.060719617500028
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.1666, Accuracy: 9519/9900 (96.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4614/5066 (91.0778%), train_poison_data_count: 400
Global model norm: 45.18100262330258.
Norm before scaling: 45.17400034994895. Distance: 2.205427981684612
Total norm for 4 adversaries is: 45.17400034994895. distance: 2.205427981684612
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.1087, Accuracy: 9615/9900 (97.1212%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5306/5740 (92.4390%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5339/5740 (93.0139%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9412, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3786/4175 (90.6826%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3790/4175 (90.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9931, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4513/4918 (91.7649%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4553/4918 (92.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9759, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3980/4235 (93.9787%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3875/4235 (91.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0104, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5017/5455 (91.9707%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4979/5455 (91.2741%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1429, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4247/4662 (91.0982%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4274/4662 (91.6774%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0073, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4166/4465 (93.3035%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4199/4465 (94.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0238, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4251/4651 (91.3997%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4223/4651 (90.7977%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1883, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4274/4618 (92.5509%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4319/4618 (93.5253%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0288, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4576/5037 (90.8477%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4619/5037 (91.7014%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9562, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4014/4354 (92.1911%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3662/4354 (84.1066%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.5960, Accuracy: 4698/10000 (46.9800%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4124/4441 (92.8620%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4083/4441 (91.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0880, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4277/4538 (94.2486%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4319/4538 (95.1741%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.6722, Accuracy: 6070/10000 (60.7000%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4709/5116 (92.0446%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4615/5116 (90.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9921, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5672/6124 (92.6192%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5535/6124 (90.3821%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9974, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4062/4362 (93.1224%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4055/4362 (92.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8871, Accuracy: 5710/10000 (57.1000%)
time spent on training: 268.1628346443176
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8266, Accuracy: 5896/10000 (58.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 8.9861, Accuracy: 156/9900 (1.5758%)
Done in 296.96687865257263 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4462/4885 (91.3408%), train_poison_data_count: 385
Global model norm: 45.201832799971314.
Norm before scaling: 45.19457445918564. Distance: 2.1512375219804443
Total norm for 4 adversaries is: 45.19457445918564. distance: 2.1512375219804443
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1561, Accuracy: 9488/9900 (95.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4872/5305 (91.8379%), train_poison_data_count: 415
Global model norm: 45.201832799971314.
Norm before scaling: 45.1876418242069. Distance: 2.167754511514711
Total norm for 4 adversaries is: 45.1876418242069. distance: 2.167754511514711
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1507, Accuracy: 9515/9900 (96.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4346/4717 (92.1348%), train_poison_data_count: 370
Global model norm: 45.201832799971314.
Norm before scaling: 45.18937474499675. Distance: 2.002146879915073
Total norm for 4 adversaries is: 45.18937474499675. distance: 2.002146879915073
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1398, Accuracy: 9552/9900 (96.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4645/5066 (91.6897%), train_poison_data_count: 400
Global model norm: 45.201832799971314.
Norm before scaling: 45.19187068247175. Distance: 2.1712774099531593
Total norm for 4 adversaries is: 45.19187068247175. distance: 2.1712774099531593
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.3563, Accuracy: 9024/9900 (91.1515%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4079/4361 (93.5336%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4010/4361 (91.9514%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9428, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3573/3797 (94.1006%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3535/3797 (93.0998%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9984, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4563/4918 (92.7816%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4563/4918 (92.7816%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1335, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3349/3638 (92.0561%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3430/3638 (94.2826%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.7426, Accuracy: 5960/10000 (59.6000%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3334/3590 (92.8691%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3392/3590 (94.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9212, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4592/4986 (92.0979%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4591/4986 (92.0778%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8379, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4963/5392 (92.0438%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4917/5392 (91.1907%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1163, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3510/3804 (92.2713%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3524/3804 (92.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9233, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4551/5025 (90.5672%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4628/5025 (92.0995%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1508, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4396/4793 (91.7171%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4410/4793 (92.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0609, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4502/4956 (90.8394%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4432/4956 (89.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0790, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4669/5116 (91.2627%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4620/5116 (90.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9485, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4793/5055 (94.8170%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4748/5055 (93.9268%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8403, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4561/5063 (90.0849%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4238/5063 (83.7053%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3064, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4114/4433 (92.8040%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4113/4433 (92.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8378, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4258/4662 (91.3342%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4332/4662 (92.9215%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9600, Accuracy: 5678/10000 (56.7800%)
time spent on training: 264.7253715991974
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8599, Accuracy: 5890/10000 (58.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 8.8366, Accuracy: 169/9900 (1.7071%)
Done in 293.5475149154663 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4493/4885 (91.9754%), train_poison_data_count: 385
Global model norm: 45.226108376757885.
Norm before scaling: 45.217408303350105. Distance: 2.146505367881022
Total norm for 4 adversaries is: 45.217408303350105. distance: 2.146505367881022
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.2882, Accuracy: 9166/9900 (92.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4852/5305 (91.4609%), train_poison_data_count: 415
Global model norm: 45.226108376757885.
Norm before scaling: 45.21341807282574. Distance: 2.179430108955779
Total norm for 4 adversaries is: 45.21341807282574. distance: 2.179430108955779
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1042, Accuracy: 9642/9900 (97.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4329/4717 (91.7744%), train_poison_data_count: 370
Global model norm: 45.226108376757885.
Norm before scaling: 45.21300229106529. Distance: 2.010332952413437
Total norm for 4 adversaries is: 45.21300229106529. distance: 2.010332952413437
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1845, Accuracy: 9443/9900 (95.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4636/5066 (91.5120%), train_poison_data_count: 400
Global model norm: 45.226108376757885.
Norm before scaling: 45.218266777825804. Distance: 2.181696359166663
Total norm for 4 adversaries is: 45.218266777825804. distance: 2.181696359166663
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1175, Accuracy: 9589/9900 (96.8586%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4421/4804 (92.0275%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4117/4804 (85.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1672, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4415/4793 (92.1135%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4389/4793 (91.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9612, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3474/3781 (91.8805%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3440/3781 (90.9812%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1104, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3806/4175 (91.1617%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3745/4175 (89.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8495, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4084/4362 (93.6268%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4084/4362 (93.6268%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9693, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4589/5083 (90.2813%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4637/5083 (91.2257%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0485, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4454/4874 (91.3828%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4194/4874 (86.0484%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3300, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3331/3646 (91.3604%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3430/3646 (94.0757%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.7583, Accuracy: 5995/10000 (59.9500%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3497/3756 (93.1044%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3516/3756 (93.6102%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8517, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3995/4223 (94.6010%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4021/4223 (95.2167%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8954, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4107/4356 (94.2837%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4067/4356 (93.3655%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9349, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4648/5025 (92.4975%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4638/5025 (92.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0031, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5727/6391 (89.6104%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5716/6391 (89.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0399, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4098/4518 (90.7039%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4152/4518 (91.8991%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1198, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4761/5167 (92.1424%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4740/5167 (91.7360%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1703, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4311/4679 (92.1351%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4321/4679 (92.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1581, Accuracy: 5423/10000 (54.2300%)
time spent on training: 259.24027037620544
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8695, Accuracy: 5858/10000 (58.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 8.8029, Accuracy: 156/9900 (1.5758%)
Done in 287.99742221832275 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4499/4885 (92.0983%), train_poison_data_count: 385
Global model norm: 45.25082413570981.
Norm before scaling: 45.240840427407235. Distance: 2.0688838996080405
Total norm for 4 adversaries is: 45.240840427407235. distance: 2.0688838996080405
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1921, Accuracy: 9445/9900 (95.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4885/5305 (92.0829%), train_poison_data_count: 415
Global model norm: 45.25082413570981.
Norm before scaling: 45.23526148742746. Distance: 2.1306227177601835
Total norm for 4 adversaries is: 45.23526148742746. distance: 2.1306227177601835
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1959, Accuracy: 9453/9900 (95.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4357/4717 (92.3680%), train_poison_data_count: 370
Global model norm: 45.25082413570981.
Norm before scaling: 45.231434759796066. Distance: 1.934895949708123
Total norm for 4 adversaries is: 45.231434759796066. distance: 1.934895949708123
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0996, Accuracy: 9650/9900 (97.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4639/5066 (91.5713%), train_poison_data_count: 400
Global model norm: 45.25082413570981.
Norm before scaling: 45.242382441084075. Distance: 2.187523106044263
Total norm for 4 adversaries is: 45.242382441084075. distance: 2.187523106044263
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1269, Accuracy: 9546/9900 (96.4242%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4506/4956 (90.9201%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4530/4956 (91.4044%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1691, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3552/3797 (93.5475%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3569/3797 (93.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8961, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4638/5017 (92.4457%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4643/5017 (92.5453%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9772, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4140/4433 (93.3905%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4153/4433 (93.6837%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8491, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3499/3781 (92.5417%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3421/3781 (90.4787%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0977, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4867/5265 (92.4406%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4793/5265 (91.0351%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9184, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4827/5197 (92.8805%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4757/5197 (91.5336%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1345, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3333/3646 (91.4152%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3389/3646 (92.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8056, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4162/4356 (95.5464%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3752/4356 (86.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5431, Accuracy: 4760/10000 (47.6000%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3491/3804 (91.7718%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3554/3804 (93.4280%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8620, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3336/3590 (92.9248%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3277/3590 (91.2813%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1136, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3736/4046 (92.3381%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3762/4046 (92.9807%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0726, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4683/5244 (89.3021%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4632/5244 (88.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0608, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4634/5025 (92.2189%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4618/5025 (91.9005%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0962, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3519/3756 (93.6901%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3570/3756 (95.0479%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9331, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5003/5392 (92.7856%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4933/5392 (91.4874%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0761, Accuracy: 5514/10000 (55.1400%)
time spent on training: 262.1714253425598
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9414, Accuracy: 5736/10000 (57.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 9.1942, Accuracy: 100/9900 (1.0101%)
Done in 290.8324086666107 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4525/4885 (92.6305%), train_poison_data_count: 385
Global model norm: 45.2803118432835.
Norm before scaling: 45.266703689252935. Distance: 2.0120029285781205
Total norm for 4 adversaries is: 45.266703689252935. distance: 2.0120029285781205
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.3862, Accuracy: 9021/9900 (91.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4856/5305 (91.5363%), train_poison_data_count: 415
Global model norm: 45.2803118432835.
Norm before scaling: 45.27185407606336. Distance: 2.187973298232425
Total norm for 4 adversaries is: 45.27185407606336. distance: 2.187973298232425
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.2086, Accuracy: 9412/9900 (95.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4326/4717 (91.7108%), train_poison_data_count: 370
Global model norm: 45.2803118432835.
Norm before scaling: 45.26793066702961. Distance: 2.0371112476022075
Total norm for 4 adversaries is: 45.26793066702961. distance: 2.0371112476022075
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0692, Accuracy: 9728/9900 (98.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 45.2803118432835.
Norm before scaling: 45.26922232857966. Distance: 2.199989630934815
Total norm for 4 adversaries is: 45.26922232857966. distance: 2.199989630934815
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1172, Accuracy: 9566/9900 (96.6263%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4322/4663 (92.6871%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4357/4663 (93.4377%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0414, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4266/4618 (92.3777%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4292/4618 (92.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0895, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4368/4662 (93.6937%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4378/4662 (93.9082%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8860, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4078/4511 (90.4012%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4092/4511 (90.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0331, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4120/4362 (94.4521%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4142/4362 (94.9564%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8272, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4180/4558 (91.7069%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4182/4558 (91.7508%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0468, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3552/3828 (92.7900%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3614/3828 (94.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8367, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4375/4716 (92.7693%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4311/4716 (91.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9348, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4168/4465 (93.3483%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4175/4465 (93.5050%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0345, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4436/4928 (90.0162%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4454/4928 (90.3815%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0698, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5010/5455 (91.8423%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4886/5455 (89.5692%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9975, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4365/4647 (93.9316%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4324/4647 (93.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9189, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5065/5591 (90.5920%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4998/5591 (89.3937%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0474, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3393/3616 (93.8330%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3385/3616 (93.6117%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7150, Accuracy: 6087/10000 (60.8700%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4605/4986 (92.3586%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4588/4986 (92.0176%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7780, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4764/5167 (92.2005%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4750/5167 (91.9296%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1182, Accuracy: 5436/10000 (54.3600%)
time spent on training: 265.7754065990448
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9582, Accuracy: 5745/10000 (57.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 9.4907, Accuracy: 70/9900 (0.7071%)
Done in 294.9408366680145 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4543/4885 (92.9990%), train_poison_data_count: 385
Global model norm: 45.30766676809511.
Norm before scaling: 45.29472981294982. Distance: 2.0298326682668524
Total norm for 4 adversaries is: 45.29472981294982. distance: 2.0298326682668524
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1893, Accuracy: 9413/9900 (95.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4889/5305 (92.1583%), train_poison_data_count: 415
Global model norm: 45.30766676809511.
Norm before scaling: 45.294101868372444. Distance: 2.17086548979721
Total norm for 4 adversaries is: 45.294101868372444. distance: 2.17086548979721
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1065, Accuracy: 9632/9900 (97.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4340/4717 (92.0076%), train_poison_data_count: 370
Global model norm: 45.30766676809511.
Norm before scaling: 45.29323674591909. Distance: 1.9920608779459705
Total norm for 4 adversaries is: 45.29323674591909. distance: 1.9920608779459705
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1880, Accuracy: 9370/9900 (94.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4648/5066 (91.7489%), train_poison_data_count: 400
Global model norm: 45.30766676809511.
Norm before scaling: 45.29761878485584. Distance: 2.1682465246457063
Total norm for 4 adversaries is: 45.29761878485584. distance: 2.1682465246457063
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1606, Accuracy: 9455/9900 (95.5051%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3791/4175 (90.8024%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3758/4175 (90.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0567, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4239/4596 (92.2324%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4230/4596 (92.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1364, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3398/3616 (93.9712%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3423/3616 (94.6626%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7418, Accuracy: 6090/10000 (60.9000%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4093/4356 (93.9624%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3914/4356 (89.8531%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0557, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4630/5244 (88.2914%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4669/5244 (89.0351%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0409, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3055/3297 (92.6600%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3086/3297 (93.6002%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7074, Accuracy: 6091/10000 (60.9100%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3331/3646 (91.3604%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3403/3646 (93.3352%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7345, Accuracy: 5972/10000 (59.7200%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3601/3797 (94.8380%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3587/3797 (94.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8058, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4164/4456 (93.4470%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4151/4456 (93.1553%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9449, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3629/3828 (94.8015%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3618/3828 (94.5141%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8019, Accuracy: 5960/10000 (59.6000%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5150/5582 (92.2608%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5105/5582 (91.4547%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0211, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3257/3472 (93.8076%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3299/3472 (95.0173%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8855, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4124/4362 (94.5438%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4082/4362 (93.5809%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0477, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5072/5424 (93.5103%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5050/5424 (93.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1541, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4408/4679 (94.2082%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4301/4679 (91.9214%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0281, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3307/3590 (92.1170%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3115/3590 (86.7688%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3277, Accuracy: 5116/10000 (51.1600%)
time spent on training: 259.4207603931427
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9907, Accuracy: 5651/10000 (56.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 9.6879, Accuracy: 65/9900 (0.6566%)
Done in 288.20839977264404 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4535/4885 (92.8352%), train_poison_data_count: 385
Global model norm: 45.33346228487711.
Norm before scaling: 45.32017445785734. Distance: 2.0766840937185798
Total norm for 4 adversaries is: 45.32017445785734. distance: 2.0766840937185798
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.2654, Accuracy: 9247/9900 (93.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 45.33346228487711.
Norm before scaling: 45.321319184863206. Distance: 2.173765717987566
Total norm for 4 adversaries is: 45.321319184863206. distance: 2.173765717987566
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1036, Accuracy: 9654/9900 (97.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 45.33346228487711.
Norm before scaling: 45.320958262292955. Distance: 2.043568627011798
Total norm for 4 adversaries is: 45.320958262292955. distance: 2.043568627011798
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.3917, Accuracy: 8962/9900 (90.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4612/5066 (91.0383%), train_poison_data_count: 400
Global model norm: 45.33346228487711.
Norm before scaling: 45.327109713724305. Distance: 2.241832957664509
Total norm for 4 adversaries is: 45.327109713724305. distance: 2.241832957664509
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1030, Accuracy: 9630/9900 (97.2727%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3500/3804 (92.0084%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3536/3804 (92.9548%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8827, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3052/3297 (92.5690%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3101/3297 (94.0552%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7092, Accuracy: 6000/10000 (60.0000%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3996/4354 (91.7777%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3645/4354 (83.7161%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3698, Accuracy: 4942/10000 (49.4200%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4095/4433 (92.3754%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4125/4433 (93.0521%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8170, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3499/3775 (92.6887%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3577/3775 (94.7550%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8418, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4855/5195 (93.4552%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4847/5195 (93.3013%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0271, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5100/5392 (94.5846%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5007/5392 (92.8598%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0122, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4695/5244 (89.5309%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4614/5244 (87.9863%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1088, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4072/4356 (93.4803%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3664/4356 (84.1139%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3185, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4014/4416 (90.8967%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4071/4416 (92.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9136, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4120/4481 (91.9438%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3999/4481 (89.2435%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3185, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4125/4441 (92.8845%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4170/4441 (93.8978%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0392, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4031/4336 (92.9659%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4011/4336 (92.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0273, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3356/3646 (92.0461%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3369/3646 (92.4026%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7472, Accuracy: 5956/10000 (59.5600%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4381/4647 (94.2759%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4326/4647 (93.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9545, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3311/3638 (91.0115%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3392/3638 (93.2380%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0438, Accuracy: 5555/10000 (55.5500%)
time spent on training: 255.2377746105194
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9485, Accuracy: 5726/10000 (57.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 9.8683, Accuracy: 70/9900 (0.7071%)
Done in 284.3597378730774 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4512/4885 (92.3644%), train_poison_data_count: 385
Global model norm: 45.350630508296135.
Norm before scaling: 45.338529700362194. Distance: 2.0734196217275684
Total norm for 4 adversaries is: 45.338529700362194. distance: 2.0734196217275684
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.2774, Accuracy: 9230/9900 (93.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4870/5305 (91.8002%), train_poison_data_count: 415
Global model norm: 45.350630508296135.
Norm before scaling: 45.3375227245256. Distance: 2.189936017186095
Total norm for 4 adversaries is: 45.3375227245256. distance: 2.189936017186095
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1038, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 45.350630508296135.
Norm before scaling: 45.339275494252774. Distance: 2.0294030816168043
Total norm for 4 adversaries is: 45.339275494252774. distance: 2.0294030816168043
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1692, Accuracy: 9479/9900 (95.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4626/5066 (91.3146%), train_poison_data_count: 400
Global model norm: 45.350630508296135.
Norm before scaling: 45.34309581282056. Distance: 2.1978589693665183
Total norm for 4 adversaries is: 45.34309581282056. distance: 2.1978589693665183
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0794, Accuracy: 9691/9900 (97.8889%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4299/4538 (94.7334%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4278/4538 (94.2706%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8126, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5342/5740 (93.0662%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5368/5740 (93.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0046, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4487/4934 (90.9404%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4352/4934 (88.2043%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1359, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3792/4013 (94.4929%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3842/4013 (95.7388%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.6907, Accuracy: 6070/10000 (60.7000%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4067/4511 (90.1574%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4104/4511 (90.9776%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0319, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4091/4501 (90.8909%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4016/4501 (89.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0182, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4188/4518 (92.6959%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4201/4518 (92.9836%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9047, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3500/3804 (92.0084%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3544/3804 (93.1651%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7950, Accuracy: 5931/10000 (59.3100%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3482/3781 (92.0920%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3340/3781 (88.3364%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1957, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4126/4441 (92.9070%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4105/4441 (92.4341%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9858, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4294/4662 (92.1064%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4320/4662 (92.6641%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0470, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3215/3472 (92.5979%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3274/3472 (94.2972%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7848, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3607/3911 (92.2271%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3514/3911 (89.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0842, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4189/4634 (90.3971%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4221/4634 (91.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0166, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4250/4618 (92.0312%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4180/4618 (90.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1532, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4815/5195 (92.6853%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4766/5195 (91.7421%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0473, Accuracy: 5556/10000 (55.5600%)
time spent on training: 261.91208505630493
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0483, Accuracy: 5639/10000 (56.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 10.1689, Accuracy: 37/9900 (0.3737%)
Done in 291.1079456806183 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4529/4885 (92.7124%), train_poison_data_count: 385
Global model norm: 45.377926902845616.
Norm before scaling: 45.364463738839675. Distance: 2.0703627094442236
Total norm for 4 adversaries is: 45.364463738839675. distance: 2.0703627094442236
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.2381, Accuracy: 9323/9900 (94.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4872/5305 (91.8379%), train_poison_data_count: 415
Global model norm: 45.377926902845616.
Norm before scaling: 45.36403319605191. Distance: 2.1800121216043267
Total norm for 4 adversaries is: 45.36403319605191. distance: 2.1800121216043267
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.2124, Accuracy: 9373/9900 (94.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 45.377926902845616.
Norm before scaling: 45.36510147283509. Distance: 2.0405164190266
Total norm for 4 adversaries is: 45.36510147283509. distance: 2.0405164190266
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1037, Accuracy: 9634/9900 (97.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4648/5066 (91.7489%), train_poison_data_count: 400
Global model norm: 45.377926902845616.
Norm before scaling: 45.36378294117869. Distance: 2.141785578512693
Total norm for 4 adversaries is: 45.36378294117869. distance: 2.141785578512693
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1592, Accuracy: 9456/9900 (95.5152%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3018/3271 (92.2654%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3037/3271 (92.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9059, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4549/4928 (92.3093%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4497/4928 (91.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0120, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4431/4804 (92.2356%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4194/4804 (87.3022%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2754, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4242/4618 (91.8579%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4247/4618 (91.9662%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0840, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3506/3756 (93.3440%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3618/3756 (96.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8565, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4222/4634 (91.1092%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4195/4634 (90.5265%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0100, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3419/3638 (93.9802%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3429/3638 (94.2551%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7536, Accuracy: 6009/10000 (60.0900%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3402/3704 (91.8467%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3437/3704 (92.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8824, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4352/4707 (92.4580%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4410/4707 (93.6902%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8992, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4130/4481 (92.1669%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4055/4481 (90.4932%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1095, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3995/4354 (91.7547%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3957/4354 (90.8819%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2678, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3317/3646 (90.9764%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3395/3646 (93.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8479, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3998/4223 (94.6720%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4026/4223 (95.3351%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7495, Accuracy: 6013/10000 (60.1300%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4128/4511 (91.5096%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4135/4511 (91.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9853, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4118/4456 (92.4147%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4152/4456 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9689, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3652/3861 (94.5869%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3707/3861 (96.0114%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7233, Accuracy: 6024/10000 (60.2400%)
time spent on training: 257.41092562675476
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0605, Accuracy: 5590/10000 (55.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 9.8043, Accuracy: 44/9900 (0.4444%)
Done in 286.13827180862427 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4549/4885 (93.1218%), train_poison_data_count: 385
Global model norm: 45.39384132322495.
Norm before scaling: 45.38134586737567. Distance: 2.042192767602713
Total norm for 4 adversaries is: 45.38134586737567. distance: 2.042192767602713
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2885, Accuracy: 9209/9900 (93.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4885/5305 (92.0829%), train_poison_data_count: 415
Global model norm: 45.39384132322495.
Norm before scaling: 45.38039364035007. Distance: 2.1762211627134196
Total norm for 4 adversaries is: 45.38039364035007. distance: 2.1762211627134196
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2211, Accuracy: 9347/9900 (94.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4307/4717 (91.3080%), train_poison_data_count: 370
Global model norm: 45.39384132322495.
Norm before scaling: 45.381980674292684. Distance: 2.062780650146815
Total norm for 4 adversaries is: 45.381980674292684. distance: 2.062780650146815
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.3037, Accuracy: 9169/9900 (92.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4608/5066 (90.9593%), train_poison_data_count: 400
Global model norm: 45.39384132322495.
Norm before scaling: 45.38391193904096. Distance: 2.2008169001358526
Total norm for 4 adversaries is: 45.38391193904096. distance: 2.2008169001358526
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1075, Accuracy: 9610/9900 (97.0707%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3489/3804 (91.7192%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3487/3804 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9538, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4042/4501 (89.8023%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4043/4501 (89.8245%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0119, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4310/4663 (92.4298%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4321/4663 (92.6657%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9177, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5105/5591 (91.3075%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5000/5591 (89.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0699, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4618/5244 (88.0625%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4684/5244 (89.3211%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0285, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4110/4433 (92.7137%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4143/4433 (93.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8077, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4365/4707 (92.7342%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4302/4707 (91.3958%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7900, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4153/4456 (93.2002%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4150/4456 (93.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0800, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4063/4356 (93.2736%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3803/4356 (87.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1917, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4211/4576 (92.0236%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4234/4576 (92.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0317, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4390/4679 (93.8235%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4212/4679 (90.0192%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1424, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4231/4634 (91.3034%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4252/4634 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7709, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3759/4013 (93.6706%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3812/4013 (94.9913%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7092, Accuracy: 6056/10000 (60.5600%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4668/5232 (89.2202%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4714/5232 (90.0994%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2123, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3826/4126 (92.7290%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3867/4126 (93.7227%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8324, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3518/3756 (93.6635%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3537/3756 (94.1693%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8506, Accuracy: 5783/10000 (57.8300%)
time spent on training: 263.83337211608887
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0604, Accuracy: 5548/10000 (55.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 9.7348, Accuracy: 67/9900 (0.6768%)
Done in 292.25629568099976 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4526/4885 (92.6510%), train_poison_data_count: 385
Global model norm: 45.4102878022288.
Norm before scaling: 45.397979718265. Distance: 2.0420387733432386
Total norm for 4 adversaries is: 45.397979718265. distance: 2.0420387733432386
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1100, Accuracy: 9627/9900 (97.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4877/5305 (91.9321%), train_poison_data_count: 415
Global model norm: 45.4102878022288.
Norm before scaling: 45.40105301900359. Distance: 2.1712453464596546
Total norm for 4 adversaries is: 45.40105301900359. distance: 2.1712453464596546
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1444, Accuracy: 9557/9900 (96.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4336/4717 (91.9228%), train_poison_data_count: 370
Global model norm: 45.4102878022288.
Norm before scaling: 45.39655996053005. Distance: 2.018615515041113
Total norm for 4 adversaries is: 45.39655996053005. distance: 2.018615515041113
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.2060, Accuracy: 9381/9900 (94.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4667/5066 (92.1240%), train_poison_data_count: 400
Global model norm: 45.4102878022288.
Norm before scaling: 45.39812491825791. Distance: 2.152240065277102
Total norm for 4 adversaries is: 45.39812491825791. distance: 2.152240065277102
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1465, Accuracy: 9523/9900 (96.1919%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4774/5055 (94.4411%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4698/5055 (92.9377%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8354, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4124/4481 (92.0330%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4033/4481 (90.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2169, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4263/4767 (89.4273%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4274/4767 (89.6581%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1909, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4814/5265 (91.4340%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4772/5265 (90.6363%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1468, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4168/4558 (91.4436%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4091/4558 (89.7543%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1568, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5135/5591 (91.8440%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5046/5591 (90.2522%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1350, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4740/5232 (90.5963%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4662/5232 (89.1055%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1125, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3591/3756 (95.6070%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0019, Accuracy: 3630/3756 (96.6454%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.7296, Accuracy: 6082/10000 (60.8200%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4124/4433 (93.0296%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4155/4433 (93.7289%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.7693, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4397/4793 (91.7380%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4449/4793 (92.8229%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0053, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3968/4235 (93.6954%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3992/4235 (94.2621%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8448, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4337/4707 (92.1394%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4385/4707 (93.1591%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8701, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3770/4025 (93.6646%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3789/4025 (94.1366%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8287, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3650/3837 (95.1264%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0020, Accuracy: 3700/3837 (96.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.7544, Accuracy: 6012/10000 (60.1200%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5665/6391 (88.6403%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5607/6391 (87.7327%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2239, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4034/4354 (92.6504%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0125, Accuracy: 3369/4354 (77.3771%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.8754, Accuracy: 4371/10000 (43.7100%)
time spent on training: 268.795294046402
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2497, Accuracy: 5296/10000 (52.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 10.2831, Accuracy: 42/9900 (0.4242%)
Done in 297.96795082092285 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4486/4885 (91.8321%), train_poison_data_count: 385
Global model norm: 45.453535899655265.
Norm before scaling: 45.44085269611476. Distance: 2.115201011105756
Total norm for 4 adversaries is: 45.44085269611476. distance: 2.115201011105756
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1360, Accuracy: 9553/9900 (96.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4856/5305 (91.5363%), train_poison_data_count: 415
Global model norm: 45.453535899655265.
Norm before scaling: 45.44071837811051. Distance: 2.181244106339414
Total norm for 4 adversaries is: 45.44071837811051. distance: 2.181244106339414
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1149, Accuracy: 9605/9900 (97.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 45.453535899655265.
Norm before scaling: 45.439114590467376. Distance: 2.0703940321504644
Total norm for 4 adversaries is: 45.439114590467376. distance: 2.0703940321504644
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0974, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4627/5066 (91.3344%), train_poison_data_count: 400
Global model norm: 45.453535899655265.
Norm before scaling: 45.44415679401203. Distance: 2.2167583714304833
Total norm for 4 adversaries is: 45.44415679401203. distance: 2.2167583714304833
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1775, Accuracy: 9435/9900 (95.3030%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5015/5424 (92.4594%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5014/5424 (92.4410%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0536, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4192/4576 (91.6084%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4281/4576 (93.5533%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8836, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4458/4934 (90.3527%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4226/4934 (85.6506%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2620, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5096/5582 (91.2934%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4974/5582 (89.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1909, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4494/4956 (90.6780%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4482/4956 (90.4358%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0168, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5313/5902 (90.0203%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5132/5902 (86.9536%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2278, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3052/3297 (92.5690%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3116/3297 (94.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7696, Accuracy: 5966/10000 (59.6600%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3208/3472 (92.3963%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3235/3472 (93.1740%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9603, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4535/4928 (92.0252%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4558/4928 (92.4919%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9447, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4111/4481 (91.7429%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4014/4481 (89.5782%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2467, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4579/5025 (91.1244%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4600/5025 (91.5423%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0679, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4572/4986 (91.6968%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4607/4986 (92.3987%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8093, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4402/4928 (89.3263%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4422/4928 (89.7321%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0348, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4416/4804 (91.9234%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4246/4804 (88.3847%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2115, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3324/3646 (91.1684%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3373/3646 (92.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7888, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4342/4707 (92.2456%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4336/4707 (92.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9076, Accuracy: 5658/10000 (56.5800%)
time spent on training: 267.4682695865631
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1968, Accuracy: 5321/10000 (53.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 10.1451, Accuracy: 46/9900 (0.4646%)
Done in 296.43693256378174 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4528/4885 (92.6919%), train_poison_data_count: 385
Global model norm: 45.47790393250056.
Norm before scaling: 45.46442472984372. Distance: 2.038092839403443
Total norm for 4 adversaries is: 45.46442472984372. distance: 2.038092839403443
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.2638, Accuracy: 9291/9900 (93.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4848/5305 (91.3855%), train_poison_data_count: 415
Global model norm: 45.47790393250056.
Norm before scaling: 45.465917544938264. Distance: 2.2186883192488285
Total norm for 4 adversaries is: 45.465917544938264. distance: 2.2186883192488285
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.3105, Accuracy: 9159/9900 (92.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4330/4717 (91.7956%), train_poison_data_count: 370
Global model norm: 45.47790393250056.
Norm before scaling: 45.46197597735524. Distance: 2.053862895776448
Total norm for 4 adversaries is: 45.46197597735524. distance: 2.053862895776448
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1017, Accuracy: 9653/9900 (97.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4604/5066 (90.8804%), train_poison_data_count: 400
Global model norm: 45.47790393250056.
Norm before scaling: 45.47313123221778. Distance: 2.2405350075157417
Total norm for 4 adversaries is: 45.47313123221778. distance: 2.2405350075157417
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.2163, Accuracy: 9385/9900 (94.7980%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4726/5116 (92.3769%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4659/5116 (91.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9926, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4247/4651 (91.3137%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4183/4651 (89.9376%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0513, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5035/5591 (90.0554%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5017/5591 (89.7335%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3749, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4415/4804 (91.9026%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4283/4804 (89.1549%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2735, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4159/4456 (93.3348%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4158/4456 (93.3124%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9516, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4515/5063 (89.1764%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4309/5063 (85.1076%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3296, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3981/4223 (94.2695%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4020/4223 (95.1930%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8538, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4485/4934 (90.8999%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4252/4934 (86.1775%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2704, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3589/3828 (93.7565%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3645/3828 (95.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8310, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5341/5902 (90.4947%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5029/5902 (85.2084%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1863, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4055/4416 (91.8252%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4036/4416 (91.3949%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8917, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4274/4538 (94.1825%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4329/4538 (95.3944%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.7413, Accuracy: 6010/10000 (60.1000%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4566/5025 (90.8657%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4599/5025 (91.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9043, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4150/4625 (89.7297%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4121/4625 (89.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1904, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4786/5197 (92.0916%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4733/5197 (91.0718%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1655, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3510/3804 (92.2713%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3558/3804 (93.5331%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0003, Accuracy: 5766/10000 (57.6600%)
time spent on training: 257.80328345298767
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1655, Accuracy: 5387/10000 (53.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 9.9636, Accuracy: 60/9900 (0.6061%)
Done in 286.41500449180603 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4479/4885 (91.6888%), train_poison_data_count: 385
Global model norm: 45.49534767595748.
Norm before scaling: 45.48448771885724. Distance: 2.172495252562363
Total norm for 4 adversaries is: 45.48448771885724. distance: 2.172495252562363
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0557, Accuracy: 9758/9900 (98.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4886/5305 (92.1018%), train_poison_data_count: 415
Global model norm: 45.49534767595748.
Norm before scaling: 45.47808645552548. Distance: 2.093264737048063
Total norm for 4 adversaries is: 45.47808645552548. distance: 2.093264737048063
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.2521, Accuracy: 9317/9900 (94.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4354/4717 (92.3044%), train_poison_data_count: 370
Global model norm: 45.49534767595748.
Norm before scaling: 45.47607329340892. Distance: 1.9660879636083815
Total norm for 4 adversaries is: 45.47607329340892. distance: 1.9660879636083815
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1288, Accuracy: 9582/9900 (96.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4608/5066 (90.9593%), train_poison_data_count: 400
Global model norm: 45.49534767595748.
Norm before scaling: 45.4849439589973. Distance: 2.2294700511179304
Total norm for 4 adversaries is: 45.4849439589973. distance: 2.2294700511179304
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0631, Accuracy: 9736/9900 (98.3434%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4368/4804 (90.9242%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4021/4804 (83.7011%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.3349, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3577/3911 (91.4600%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3568/3911 (91.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2166, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3753/4013 (93.5211%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3796/4013 (94.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8184, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4701/5232 (89.8509%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4716/5232 (90.1376%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1029, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5127/5591 (91.7009%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5016/5591 (89.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1207, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3666/3837 (95.5434%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0022, Accuracy: 3696/3837 (96.3253%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7508, Accuracy: 5966/10000 (59.6600%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4994/5424 (92.0723%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5020/5424 (92.5516%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1906, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4835/5167 (93.5746%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4827/5167 (93.4198%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0328, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4175/4456 (93.6939%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4161/4456 (93.3797%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9364, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4510/4928 (91.5179%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4525/4928 (91.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9104, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4103/4433 (92.5558%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4037/4433 (91.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8669, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3059/3297 (92.7813%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3082/3297 (93.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7887, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4338/4716 (91.9847%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4298/4716 (91.1366%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1582, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4186/4596 (91.0792%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4217/4596 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9511, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4395/4793 (91.6962%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4442/4793 (92.6768%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8229, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4047/4416 (91.6440%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4032/4416 (91.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9987, Accuracy: 5616/10000 (56.1600%)
time spent on training: 264.31694889068604
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1524, Accuracy: 5386/10000 (53.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 10.0255, Accuracy: 48/9900 (0.4848%)
Done in 293.2387707233429 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4511/4885 (92.3439%), train_poison_data_count: 385
Global model norm: 45.51781609470351.
Norm before scaling: 45.50238500359762. Distance: 2.039990911650515
Total norm for 4 adversaries is: 45.50238500359762. distance: 2.039990911650515
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.2115, Accuracy: 9363/9900 (94.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4888/5305 (92.1395%), train_poison_data_count: 415
Global model norm: 45.51781609470351.
Norm before scaling: 45.50480475575491. Distance: 2.156260283072457
Total norm for 4 adversaries is: 45.50480475575491. distance: 2.156260283072457
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1481, Accuracy: 9499/9900 (95.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4354/4717 (92.3044%), train_poison_data_count: 370
Global model norm: 45.51781609470351.
Norm before scaling: 45.50448552752794. Distance: 2.056296527185426
Total norm for 4 adversaries is: 45.50448552752794. distance: 2.056296527185426
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0870, Accuracy: 9639/9900 (97.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4610/5066 (90.9988%), train_poison_data_count: 400
Global model norm: 45.51781609470351.
Norm before scaling: 45.51064167707784. Distance: 2.2314522574085034
Total norm for 4 adversaries is: 45.51064167707784. distance: 2.2314522574085034
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1206, Accuracy: 9581/9900 (96.7778%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2997/3271 (91.6234%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 2990/3271 (91.4094%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9141, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4715/5116 (92.1618%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4635/5116 (90.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0280, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4058/4501 (90.1577%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4112/4501 (91.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0741, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4161/4356 (95.5234%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4157/4356 (95.4316%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9638, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3996/4368 (91.4835%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3924/4368 (89.8352%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0171, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3649/3837 (95.1003%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0021, Accuracy: 3702/3837 (96.4816%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7384, Accuracy: 6011/10000 (60.1100%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5298/5740 (92.2997%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5307/5740 (92.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0472, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3375/3590 (94.0111%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3450/3590 (96.1003%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8359, Accuracy: 5937/10000 (59.3700%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3071/3297 (93.1453%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3086/3297 (93.6002%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.6792, Accuracy: 6062/10000 (60.6200%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4309/4716 (91.3698%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4345/4716 (92.1332%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0602, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4707/5055 (93.1157%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4724/5055 (93.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1297, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3561/3911 (91.0509%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3394/3911 (86.7809%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2350, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3759/4158 (90.4040%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3793/4158 (91.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9032, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4134/4456 (92.7738%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4179/4456 (93.7837%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9773, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4115/4511 (91.2215%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4125/4511 (91.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9800, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3344/3672 (91.0675%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3345/3672 (91.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0071, Accuracy: 5626/10000 (56.2600%)
time spent on training: 258.1092791557312
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2051, Accuracy: 5299/10000 (52.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 9.4939, Accuracy: 116/9900 (1.1717%)
Done in 287.41593861579895 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4494/4885 (91.9959%), train_poison_data_count: 385
Global model norm: 45.53685567328266.
Norm before scaling: 45.52607265090659. Distance: 2.1105733222723497
Total norm for 4 adversaries is: 45.52607265090659. distance: 2.1105733222723497
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0983, Accuracy: 9651/9900 (97.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4896/5305 (92.2903%), train_poison_data_count: 415
Global model norm: 45.53685567328266.
Norm before scaling: 45.52246612250922. Distance: 2.136459976510604
Total norm for 4 adversaries is: 45.52246612250922. distance: 2.136459976510604
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1518, Accuracy: 9520/9900 (96.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4360/4717 (92.4316%), train_poison_data_count: 370
Global model norm: 45.53685567328266.
Norm before scaling: 45.52248489328515. Distance: 2.002831005118679
Total norm for 4 adversaries is: 45.52248489328515. distance: 2.002831005118679
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.2123, Accuracy: 9333/9900 (94.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 45.53685567328266.
Norm before scaling: 45.52548811774977. Distance: 2.228035957943434
Total norm for 4 adversaries is: 45.52548811774977. distance: 2.228035957943434
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1179, Accuracy: 9608/9900 (97.0505%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4550/5063 (89.8677%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4230/5063 (83.5473%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3263, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4685/5083 (92.1700%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4569/5083 (89.8879%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2479, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3575/3797 (94.1533%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3499/3797 (92.1517%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9716, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5548/6124 (90.5944%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5477/6124 (89.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0306, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4724/5232 (90.2905%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4701/5232 (89.8509%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1053, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3666/3861 (94.9495%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3668/3861 (95.0013%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.7053, Accuracy: 6055/10000 (60.5500%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4601/5037 (91.3441%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4637/5037 (92.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9117, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4698/5116 (91.8296%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4725/5116 (92.3573%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8747, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3991/4368 (91.3690%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4002/4368 (91.6209%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9610, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3414/3672 (92.9739%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3443/3672 (93.7636%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8172, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5313/5902 (90.0203%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5005/5902 (84.8018%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2561, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4042/4361 (92.6852%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3919/4361 (89.8647%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2189, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3758/4158 (90.3800%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3719/4158 (89.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1630, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4612/5025 (91.7811%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4669/5025 (92.9154%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0752, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4140/4456 (92.9084%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4174/4456 (93.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9781, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4112/4433 (92.7589%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4136/4433 (93.3002%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8968, Accuracy: 5726/10000 (57.2600%)
time spent on training: 266.988267660141
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Client 12 misclassified the most to class 92 with 1 misclassifications.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 12 ranked 1 with score 1. Assigned small weight: 0.1
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Identified adversaries: [12]
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1676, Accuracy: 5353/10000 (53.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 8.6708, Accuracy: 186/9900 (1.8788%)
Done in 296.19427704811096 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4536/4885 (92.8557%), train_poison_data_count: 385
Global model norm: 45.55639373090922.
Norm before scaling: 45.54346846180306. Distance: 2.004014754006902
Total norm for 4 adversaries is: 45.54346846180306. distance: 2.004014754006902
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1276, Accuracy: 9575/9900 (96.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4905/5305 (92.4599%), train_poison_data_count: 415
Global model norm: 45.55639373090922.
Norm before scaling: 45.54257055131907. Distance: 2.0785408464409563
Total norm for 4 adversaries is: 45.54257055131907. distance: 2.0785408464409563
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.2067, Accuracy: 9377/9900 (94.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4354/4717 (92.3044%), train_poison_data_count: 370
Global model norm: 45.55639373090922.
Norm before scaling: 45.540520032645105. Distance: 1.9442509585193393
Total norm for 4 adversaries is: 45.540520032645105. distance: 1.9442509585193393
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1485, Accuracy: 9523/9900 (96.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4655/5066 (91.8871%), train_poison_data_count: 400
Global model norm: 45.55639373090922.
Norm before scaling: 45.54564213597306. Distance: 2.1093670880204627
Total norm for 4 adversaries is: 45.54564213597306. distance: 2.1093670880204627
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0720, Accuracy: 9744/9900 (98.4242%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3733/4025 (92.7453%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3764/4025 (93.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9474, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4400/4928 (89.2857%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4468/4928 (90.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1644, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3792/4175 (90.8263%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3799/4175 (90.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9145, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4125/4416 (93.4103%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4140/4416 (93.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9959, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3587/3797 (94.4693%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3571/3797 (94.0479%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8616, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4911/5195 (94.5332%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4817/5195 (92.7238%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8929, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4710/5232 (90.0229%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4678/5232 (89.4113%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0703, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5013/5455 (91.8973%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4974/5455 (91.1824%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0187, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4345/4716 (92.1332%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4278/4716 (90.7125%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1178, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4379/4679 (93.5884%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4286/4679 (91.6008%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0557, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5795/6263 (92.5275%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5791/6263 (92.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0898, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4552/4918 (92.5580%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4572/4918 (92.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9839, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4153/4456 (93.2002%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4216/4456 (94.6140%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8404, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5323/5902 (90.1898%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5283/5902 (89.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0745, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4158/4481 (92.7918%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4089/4481 (91.2520%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1070, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5079/5591 (90.8424%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5020/5591 (89.7872%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1677, Accuracy: 5309/10000 (53.0900%)
time spent on training: 269.8126094341278
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2913, Accuracy: 5198/10000 (51.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 8.9545, Accuracy: 149/9900 (1.5051%)
Done in 298.54484510421753 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4521/4885 (92.5486%), train_poison_data_count: 385
Global model norm: 45.58893051978188.
Norm before scaling: 45.5753529110719. Distance: 2.012660367274569
Total norm for 4 adversaries is: 45.5753529110719. distance: 2.012660367274569
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1003, Accuracy: 9649/9900 (97.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4922/5305 (92.7804%), train_poison_data_count: 415
Global model norm: 45.58893051978188.
Norm before scaling: 45.56932069146138. Distance: 2.0744719557302007
Total norm for 4 adversaries is: 45.56932069146138. distance: 2.0744719557302007
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.2292, Accuracy: 9331/9900 (94.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4367/4717 (92.5800%), train_poison_data_count: 370
Global model norm: 45.58893051978188.
Norm before scaling: 45.57266101118767. Distance: 1.8848322881264565
Total norm for 4 adversaries is: 45.57266101118767. distance: 1.8848322881264565
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1859, Accuracy: 9470/9900 (95.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4673/5066 (92.2424%), train_poison_data_count: 400
Global model norm: 45.58893051978188.
Norm before scaling: 45.577811641877894. Distance: 2.089866680839441
Total norm for 4 adversaries is: 45.577811641877894. distance: 2.089866680839441
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0913, Accuracy: 9671/9900 (97.6869%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4066/4501 (90.3355%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4079/4501 (90.6243%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0034, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4642/5083 (91.3240%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4601/5083 (90.5174%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1576, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3569/3804 (93.8223%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3558/3804 (93.5331%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8384, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3601/3756 (95.8733%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0021, Accuracy: 3615/3756 (96.2460%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.6637, Accuracy: 6123/10000 (61.2300%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3790/4175 (90.7784%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3745/4175 (89.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9200, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4526/4934 (91.7308%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4199/4934 (85.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.4315, Accuracy: 4927/10000 (49.2700%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4049/4336 (93.3810%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4030/4336 (92.9428%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8936, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4139/4356 (95.0184%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4131/4356 (94.8347%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9173, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4651/5244 (88.6918%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4697/5244 (89.5690%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0766, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4638/5017 (92.4457%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4629/5017 (92.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0475, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3587/3828 (93.7043%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3640/3828 (95.0888%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8398, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4314/4538 (95.0639%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4316/4538 (95.1080%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8007, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3359/3638 (92.3310%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3446/3638 (94.7224%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8843, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4318/4662 (92.6212%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4326/4662 (92.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9376, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3575/3797 (94.1533%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3570/3797 (94.0216%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8972, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4200/4634 (90.6344%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4207/4634 (90.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9509, Accuracy: 5606/10000 (56.0600%)
time spent on training: 260.12395429611206
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2291, Accuracy: 5265/10000 (52.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 9.1385, Accuracy: 135/9900 (1.3636%)
Done in 289.61374735832214 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4545/4885 (93.0399%), train_poison_data_count: 385
Global model norm: 45.614146825573755.
Norm before scaling: 45.59696805812586. Distance: 2.0138171464557377
Total norm for 4 adversaries is: 45.59696805812586. distance: 2.0138171464557377
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0551, Accuracy: 9765/9900 (98.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4928/5305 (92.8935%), train_poison_data_count: 415
Global model norm: 45.614146825573755.
Norm before scaling: 45.59670569583399. Distance: 2.067982755526395
Total norm for 4 adversaries is: 45.59670569583399. distance: 2.067982755526395
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.2003, Accuracy: 9430/9900 (95.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4357/4717 (92.3680%), train_poison_data_count: 370
Global model norm: 45.614146825573755.
Norm before scaling: 45.59855558550485. Distance: 1.9370295661044434
Total norm for 4 adversaries is: 45.59855558550485. distance: 1.9370295661044434
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.1358, Accuracy: 9555/9900 (96.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4689/5066 (92.5582%), train_poison_data_count: 400
Global model norm: 45.614146825573755.
Norm before scaling: 45.59758380043289. Distance: 2.0376714294958695
Total norm for 4 adversaries is: 45.59758380043289. distance: 2.0376714294958695
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0275, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3842/4175 (92.0240%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3763/4175 (90.1317%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1370, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4139/4465 (92.6988%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4204/4465 (94.1545%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8298, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4557/4918 (92.6596%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4563/4918 (92.7816%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1273, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4590/5037 (91.1257%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4626/5037 (91.8404%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0446, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3432/3781 (90.7696%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3217/3781 (85.0833%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2947, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4338/4634 (93.6124%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4338/4634 (93.6124%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8935, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4228/4576 (92.3951%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4259/4576 (93.0726%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0570, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3673/3861 (95.1308%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3656/3861 (94.6905%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.7520, Accuracy: 5997/10000 (59.9700%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5668/6124 (92.5539%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5471/6124 (89.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9636, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3975/4223 (94.1274%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4019/4223 (95.1693%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8313, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4665/5083 (91.7765%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4582/5083 (90.1436%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0828, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4142/4356 (95.0872%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3725/4356 (85.5142%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.5909, Accuracy: 4745/10000 (47.4500%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4429/4793 (92.4056%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4442/4793 (92.6768%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9621, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4694/5055 (92.8586%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4730/5055 (93.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8581, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4129/4362 (94.6584%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4032/4362 (92.4347%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0122, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4102/4433 (92.5333%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4143/4433 (93.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8709, Accuracy: 5815/10000 (58.1500%)
time spent on training: 267.75019669532776
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Client 4 misclassified the most to class 92 with 1 misclassifications.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Client 9 misclassified the most to class 92 with 1 misclassifications.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Client 15 misclassified the most to class 92 with 1 misclassifications.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 4 ranked 1 with score 1. Assigned small weight: 0.1
Client 9 ranked 2 with score 1. Assigned small weight: 0.1
Client 15 ranked 3 with score 1. Assigned small weight: 0.1
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Identified adversaries: [4, 9, 15]
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1939, Accuracy: 5320/10000 (53.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 8.2431, Accuracy: 259/9900 (2.6162%)
Done in 296.80183839797974 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4557/4885 (93.2856%), train_poison_data_count: 385
Global model norm: 45.63138065400416.
Norm before scaling: 45.614216405428365. Distance: 1.917370238607289
Total norm for 4 adversaries is: 45.614216405428365. distance: 1.917370238607289
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1724, Accuracy: 9476/9900 (95.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4934/5305 (93.0066%), train_poison_data_count: 415
Global model norm: 45.63138065400416.
Norm before scaling: 45.61223869050252. Distance: 2.011721712869481
Total norm for 4 adversaries is: 45.61223869050252. distance: 2.011721712869481
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1608, Accuracy: 9521/9900 (96.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4404/4717 (93.3644%), train_poison_data_count: 370
Global model norm: 45.63138065400416.
Norm before scaling: 45.614256547603894. Distance: 1.8200318607224435
Total norm for 4 adversaries is: 45.614256547603894. distance: 1.8200318607224435
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.2890, Accuracy: 9190/9900 (92.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4691/5066 (92.5977%), train_poison_data_count: 400
Global model norm: 45.63138065400416.
Norm before scaling: 45.61953627387887. Distance: 2.038233445975153
Total norm for 4 adversaries is: 45.61953627387887. distance: 2.038233445975153
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1918, Accuracy: 9424/9900 (95.1919%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4668/5025 (92.8955%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4685/5025 (93.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0343, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4126/4441 (92.9070%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4157/4441 (93.6050%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8736, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5220/5591 (93.3643%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5158/5591 (92.2554%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0084, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4130/4481 (92.1669%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4088/4481 (91.2296%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1846, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4344/4767 (91.1265%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4313/4767 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2069, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4774/5055 (94.4411%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4748/5055 (93.9268%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8560, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4156/4518 (91.9876%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4212/4518 (93.2271%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9786, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4149/4625 (89.7081%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4047/4625 (87.5027%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3779, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4441/4793 (92.6560%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4466/4793 (93.1776%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9413, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4678/5083 (92.0323%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4607/5083 (90.6355%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0837, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4717/5244 (89.9504%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4641/5244 (88.5011%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0495, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5856/6263 (93.5015%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5775/6263 (92.2082%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0508, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3859/4175 (92.4311%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3784/4175 (90.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9933, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4135/4416 (93.6368%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4170/4416 (94.4293%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8399, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4843/5265 (91.9848%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4749/5265 (90.1994%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1204, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3758/4025 (93.3665%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3791/4025 (94.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9022, Accuracy: 5796/10000 (57.9600%)
time spent on training: 266.5821714401245
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2234, Accuracy: 5290/10000 (52.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 8.1160, Accuracy: 251/9900 (2.5354%)
Done in 295.21523880958557 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4568/4885 (93.5107%), train_poison_data_count: 385
Global model norm: 45.64852240386593.
Norm before scaling: 45.62996013277625. Distance: 1.9156183264462097
Total norm for 4 adversaries is: 45.62996013277625. distance: 1.9156183264462097
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1080, Accuracy: 9624/9900 (97.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4926/5305 (92.8558%), train_poison_data_count: 415
Global model norm: 45.64852240386593.
Norm before scaling: 45.63258177586767. Distance: 2.0648728794752316
Total norm for 4 adversaries is: 45.63258177586767. distance: 2.0648728794752316
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0831, Accuracy: 9704/9900 (98.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4384/4717 (92.9404%), train_poison_data_count: 370
Global model norm: 45.64852240386593.
Norm before scaling: 45.62950266737383. Distance: 1.8608863522461419
Total norm for 4 adversaries is: 45.62950266737383. distance: 1.8608863522461419
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0434, Accuracy: 9797/9900 (98.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4688/5066 (92.5385%), train_poison_data_count: 400
Global model norm: 45.64852240386593.
Norm before scaling: 45.636136804311946. Distance: 2.0515897773736405
Total norm for 4 adversaries is: 45.636136804311946. distance: 2.0515897773736405
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0922, Accuracy: 9650/9900 (97.4747%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3925/4295 (91.3853%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3839/4295 (89.3830%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0026, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3991/4223 (94.5063%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4021/4223 (95.2167%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7057, Accuracy: 6003/10000 (60.0300%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4455/4793 (92.9480%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4404/4793 (91.8840%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0448, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4443/4707 (94.3913%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4456/4707 (94.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7216, Accuracy: 5977/10000 (59.7700%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5011/5455 (91.8607%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4918/5455 (90.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2115, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4295/4651 (92.3457%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4326/4651 (93.0123%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0754, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3630/3837 (94.6052%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3683/3837 (95.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9096, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4176/4441 (94.0329%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4133/4441 (93.0646%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0259, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3423/3638 (94.0902%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3428/3638 (94.2276%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7293, Accuracy: 6011/10000 (60.1100%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3934/4235 (92.8926%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3972/4235 (93.7898%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8855, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4117/4362 (94.3833%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4036/4362 (92.5264%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9660, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3609/3797 (95.0487%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3557/3797 (93.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8021, Accuracy: 6034/10000 (60.3400%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3789/4158 (91.1255%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3780/4158 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9996, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3873/4126 (93.8682%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3907/4126 (94.6922%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7227, Accuracy: 6009/10000 (60.0900%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4930/5195 (94.8989%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4762/5195 (91.6651%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9481, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3748/4046 (92.6347%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3778/4046 (93.3762%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9374, Accuracy: 5671/10000 (56.7100%)
time spent on training: 256.0153839588165
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2718, Accuracy: 5218/10000 (52.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 8.2122, Accuracy: 226/9900 (2.2828%)
Done in 285.0038287639618 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4565/4885 (93.4493%), train_poison_data_count: 385
Global model norm: 45.66560425647924.
Norm before scaling: 45.64844752802389. Distance: 1.9260579929791122
Total norm for 4 adversaries is: 45.64844752802389. distance: 1.9260579929791122
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0849, Accuracy: 9693/9900 (97.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4938/5305 (93.0820%), train_poison_data_count: 415
Global model norm: 45.66560425647924.
Norm before scaling: 45.64763190821759. Distance: 2.037211078215355
Total norm for 4 adversaries is: 45.64763190821759. distance: 2.037211078215355
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0948, Accuracy: 9660/9900 (97.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4373/4717 (92.7072%), train_poison_data_count: 370
Global model norm: 45.66560425647924.
Norm before scaling: 45.64900374563228. Distance: 1.9143687100607585
Total norm for 4 adversaries is: 45.64900374563228. distance: 1.9143687100607585
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0888, Accuracy: 9662/9900 (97.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4686/5066 (92.4990%), train_poison_data_count: 400
Global model norm: 45.66560425647924.
Norm before scaling: 45.65141840023292. Distance: 2.0234994768349868
Total norm for 4 adversaries is: 45.65141840023292. distance: 2.0234994768349868
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1080, Accuracy: 9617/9900 (97.1414%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4050/4361 (92.8686%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3790/4361 (86.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0797, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3045/3297 (92.3567%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3096/3297 (93.9035%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8843, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4359/4716 (92.4300%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4314/4716 (91.4758%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9694, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4820/5167 (93.2843%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4870/5167 (94.2520%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0212, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3970/4368 (90.8883%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3939/4368 (90.1786%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9373, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4347/4679 (92.9045%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4314/4679 (92.1992%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1800, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4145/4356 (95.1561%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4012/4356 (92.1028%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2500, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5328/5902 (90.2745%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5181/5902 (87.7838%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0652, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3712/3861 (96.1409%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3700/3861 (95.8301%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.6904, Accuracy: 6035/10000 (60.3500%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4125/4356 (94.6970%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4026/4356 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9539, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5856/6263 (93.5015%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5756/6263 (91.9048%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2395, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3924/4235 (92.6564%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3921/4235 (92.5856%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0509, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4713/5232 (90.0803%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4692/5232 (89.6789%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3251, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4645/5017 (92.5852%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4620/5017 (92.0869%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9086, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4438/4804 (92.3813%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4069/4804 (84.7002%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3769, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4413/4793 (92.0718%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4475/4793 (93.3653%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8381, Accuracy: 5866/10000 (58.6600%)
time spent on training: 266.34612107276917
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2766, Accuracy: 5282/10000 (52.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 8.3164, Accuracy: 210/9900 (2.1212%)
Done in 295.39173555374146 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4539/4885 (92.9171%), train_poison_data_count: 385
Global model norm: 45.68920461081316.
Norm before scaling: 45.674726754108775. Distance: 2.004273260167415
Total norm for 4 adversaries is: 45.674726754108775. distance: 2.004273260167415
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0734, Accuracy: 9711/9900 (98.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4898/5305 (92.3280%), train_poison_data_count: 415
Global model norm: 45.68920461081316.
Norm before scaling: 45.67564344699344. Distance: 2.0628363595133696
Total norm for 4 adversaries is: 45.67564344699344. distance: 2.0628363595133696
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1342, Accuracy: 9603/9900 (97.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4376/4717 (92.7708%), train_poison_data_count: 370
Global model norm: 45.68920461081316.
Norm before scaling: 45.67389022238937. Distance: 1.8982167056693313
Total norm for 4 adversaries is: 45.67389022238937. distance: 1.8982167056693313
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1139, Accuracy: 9604/9900 (97.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4682/5066 (92.4201%), train_poison_data_count: 400
Global model norm: 45.68920461081316.
Norm before scaling: 45.67469201028481. Distance: 2.0270406683900974
Total norm for 4 adversaries is: 45.67469201028481. distance: 2.0270406683900974
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1913, Accuracy: 9394/9900 (94.8889%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3629/3837 (94.5791%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0021, Accuracy: 3693/3837 (96.2471%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7386, Accuracy: 6086/10000 (60.8600%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3701/3861 (95.8560%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0021, Accuracy: 3720/3861 (96.3481%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7210, Accuracy: 6123/10000 (61.2300%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3814/4175 (91.3533%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3791/4175 (90.8024%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9362, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4119/4441 (92.7494%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4150/4441 (93.4474%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0377, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4035/4336 (93.0581%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4087/4336 (94.2574%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0347, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3842/4046 (94.9580%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3854/4046 (95.2546%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7801, Accuracy: 5970/10000 (59.7000%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4570/4956 (92.2115%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4446/4956 (89.7094%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3382, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4297/4618 (93.0489%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4245/4618 (91.9229%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1104, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3374/3616 (93.3075%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3432/3616 (94.9115%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7873, Accuracy: 6065/10000 (60.6500%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4243/4576 (92.7229%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4174/4576 (91.2150%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9135, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4034/4223 (95.5245%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4036/4223 (95.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7365, Accuracy: 6014/10000 (60.1400%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4131/4503 (91.7388%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4160/4503 (92.3829%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9994, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3414/3590 (95.0975%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3384/3590 (94.2618%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8738, Accuracy: 5901/10000 (59.0100%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4454/4707 (94.6250%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4464/4707 (94.8375%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7832, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3806/4013 (94.8418%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3832/4013 (95.4897%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7888, Accuracy: 5937/10000 (59.3700%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3416/3704 (92.2246%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3466/3704 (93.5745%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8152, Accuracy: 5858/10000 (58.5800%)
time spent on training: 252.9970145225525
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2558, Accuracy: 5305/10000 (53.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 8.4065, Accuracy: 184/9900 (1.8586%)
Done in 282.43478417396545 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4569/4885 (93.5312%), train_poison_data_count: 385
Global model norm: 45.706941614143794.
Norm before scaling: 45.69041222763535. Distance: 1.9285182731104908
Total norm for 4 adversaries is: 45.69041222763535. distance: 1.9285182731104908
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1610, Accuracy: 9492/9900 (95.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4910/5305 (92.5542%), train_poison_data_count: 415
Global model norm: 45.706941614143794.
Norm before scaling: 45.691649200270994. Distance: 2.0886554512618143
Total norm for 4 adversaries is: 45.691649200270994. distance: 2.0886554512618143
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0963, Accuracy: 9661/9900 (97.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4390/4717 (93.0676%), train_poison_data_count: 370
Global model norm: 45.706941614143794.
Norm before scaling: 45.687887417133055. Distance: 1.8912848590025924
Total norm for 4 adversaries is: 45.687887417133055. distance: 1.8912848590025924
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0685, Accuracy: 9727/9900 (98.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4698/5066 (92.7359%), train_poison_data_count: 400
Global model norm: 45.706941614143794.
Norm before scaling: 45.69274989074443. Distance: 2.0030745477616105
Total norm for 4 adversaries is: 45.69274989074443. distance: 2.0030745477616105
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1347, Accuracy: 9545/9900 (96.4141%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4304/4596 (93.6466%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4292/4596 (93.3856%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9919, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4154/4356 (95.3627%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3961/4356 (90.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3513, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3959/4295 (92.1769%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3931/4295 (91.5250%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8431, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4329/4634 (93.4182%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4296/4634 (92.7061%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8861, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4309/4767 (90.3923%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4327/4767 (90.7699%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0958, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4007/4223 (94.8852%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4027/4223 (95.3587%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7938, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3860/4046 (95.4029%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3850/4046 (95.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7852, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4669/5083 (91.8552%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4597/5083 (90.4387%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1480, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4123/4362 (94.5209%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4156/4362 (95.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8480, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4364/4663 (93.5878%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4368/4663 (93.6736%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9877, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3093/3297 (93.8126%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3132/3297 (94.9955%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8257, Accuracy: 6005/10000 (60.0500%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4152/4433 (93.6612%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4129/4433 (93.1423%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9804, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4851/5265 (92.1368%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4797/5265 (91.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9255, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4636/4986 (92.9803%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4586/4986 (91.9775%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8927, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4351/4647 (93.6303%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4362/4647 (93.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8936, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4653/5017 (92.7447%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4608/5017 (91.8477%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0804, Accuracy: 5505/10000 (55.0500%)
time spent on training: 264.90742230415344
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2456, Accuracy: 5307/10000 (53.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 8.2628, Accuracy: 241/9900 (2.4343%)
Done in 293.52616357803345 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4585/4885 (93.8588%), train_poison_data_count: 385
Global model norm: 45.73203679537054.
Norm before scaling: 45.712742043726166. Distance: 1.885650648347871
Total norm for 4 adversaries is: 45.712742043726166. distance: 1.885650648347871
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1577, Accuracy: 9518/9900 (96.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4941/5305 (93.1385%), train_poison_data_count: 415
Global model norm: 45.73203679537054.
Norm before scaling: 45.712573809586296. Distance: 2.011848401086085
Total norm for 4 adversaries is: 45.712573809586296. distance: 2.011848401086085
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0983, Accuracy: 9660/9900 (97.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4370/4717 (92.6436%), train_poison_data_count: 370
Global model norm: 45.73203679537054.
Norm before scaling: 45.71585025834858. Distance: 1.923009646045854
Total norm for 4 adversaries is: 45.71585025834858. distance: 1.923009646045854
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0660, Accuracy: 9750/9900 (98.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4700/5066 (92.7754%), train_poison_data_count: 400
Global model norm: 45.73203679537054.
Norm before scaling: 45.71660057746393. Distance: 2.027011381037359
Total norm for 4 adversaries is: 45.71660057746393. distance: 2.027011381037359
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1999, Accuracy: 9386/9900 (94.8081%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3862/4184 (92.3040%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3854/4184 (92.1128%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9346, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5781/6391 (90.4553%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5701/6391 (89.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2185, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4501/4934 (91.2242%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4171/4934 (84.5359%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2934, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4285/4618 (92.7891%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4272/4618 (92.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9714, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3969/4235 (93.7190%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3983/4235 (94.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1052, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4156/4465 (93.0795%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4221/4465 (94.5353%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8764, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4129/4503 (91.6944%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4071/4503 (90.4064%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1420, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4613/5025 (91.8010%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4568/5025 (90.9055%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0645, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5186/5582 (92.9058%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5028/5582 (90.0752%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3589, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3560/3804 (93.5857%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3625/3804 (95.2944%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.7925, Accuracy: 5974/10000 (59.7400%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3776/4158 (90.8129%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3818/4158 (91.8230%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9521, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4315/4538 (95.0859%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4327/4538 (95.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8209, Accuracy: 5935/10000 (59.3500%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4015/4368 (91.9185%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3967/4368 (90.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0624, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4671/5083 (91.8946%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4572/5083 (89.9469%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1203, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4714/5116 (92.1423%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4683/5116 (91.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9423, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4125/4356 (94.6970%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3976/4356 (91.2764%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.4881, Accuracy: 4934/10000 (49.3400%)
time spent on training: 267.4544312953949
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1848, Accuracy: 5360/10000 (53.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 7.8939, Accuracy: 281/9900 (2.8384%)
Done in 295.94935035705566 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4563/4885 (93.4084%), train_poison_data_count: 385
Global model norm: 45.75631520194098.
Norm before scaling: 45.735907046426604. Distance: 1.9342477636443915
Total norm for 4 adversaries is: 45.735907046426604. distance: 1.9342477636443915
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1371, Accuracy: 9544/9900 (96.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4953/5305 (93.3648%), train_poison_data_count: 415
Global model norm: 45.75631520194098.
Norm before scaling: 45.735698861946176. Distance: 1.9885034942826456
Total norm for 4 adversaries is: 45.735698861946176. distance: 1.9885034942826456
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1985, Accuracy: 9463/9900 (95.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4352/4717 (92.2620%), train_poison_data_count: 370
Global model norm: 45.75631520194098.
Norm before scaling: 45.738648053711096. Distance: 1.9667609324196875
Total norm for 4 adversaries is: 45.738648053711096. distance: 1.9667609324196875
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0350, Accuracy: 9822/9900 (99.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4661/5066 (92.0055%), train_poison_data_count: 400
Global model norm: 45.75631520194098.
Norm before scaling: 45.74342774257986. Distance: 2.105619690532563
Total norm for 4 adversaries is: 45.74342774257986. distance: 2.105619690532563
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0900, Accuracy: 9684/9900 (97.8182%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5802/6263 (92.6393%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5807/6263 (92.7191%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1026, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4193/4433 (94.5861%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4123/4433 (93.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9268, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3433/3672 (93.4913%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3435/3672 (93.5458%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8534, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5028/5455 (92.1723%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4917/5455 (90.1375%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0886, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4631/5025 (92.1592%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4659/5025 (92.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0005, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4288/4618 (92.8540%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4231/4618 (91.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0255, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4418/4707 (93.8602%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4415/4707 (93.7965%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8270, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4124/4362 (94.5438%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3992/4362 (91.5177%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0626, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4554/4989 (91.2808%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4585/4989 (91.9022%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0360, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4652/5083 (91.5208%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4629/5083 (91.0683%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1419, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4321/4647 (92.9847%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4342/4647 (93.4366%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8294, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4031/4368 (92.2848%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3937/4368 (90.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1846, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4072/4354 (93.5232%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3905/4354 (89.6876%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1546, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4312/4767 (90.4552%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4335/4767 (90.9377%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2348, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4381/4662 (93.9725%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4381/4662 (93.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8640, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4467/4804 (92.9850%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4455/4804 (92.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9884, Accuracy: 5667/10000 (56.6700%)
time spent on training: 267.55560326576233
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Client 9 misclassified the most to class 92 with 1 misclassifications.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 9 ranked 1 with score 1. Assigned small weight: 0.1
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Identified adversaries: [9]
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1677, Accuracy: 5395/10000 (53.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 7.1621, Accuracy: 470/9900 (4.7475%)
Done in 296.0557773113251 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4599/4885 (94.1453%), train_poison_data_count: 385
Global model norm: 45.77411420497397.
Norm before scaling: 45.75765176790107. Distance: 1.90818731951537
Total norm for 4 adversaries is: 45.75765176790107. distance: 1.90818731951537
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.1057, Accuracy: 9624/9900 (97.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4941/5305 (93.1385%), train_poison_data_count: 415
Global model norm: 45.77411420497397.
Norm before scaling: 45.754834529397. Distance: 1.9908478065732143
Total norm for 4 adversaries is: 45.754834529397. distance: 1.9908478065732143
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.1967, Accuracy: 9417/9900 (95.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4412/4717 (93.5340%), train_poison_data_count: 370
Global model norm: 45.77411420497397.
Norm before scaling: 45.754842533161174. Distance: 1.7906434515889487
Total norm for 4 adversaries is: 45.754842533161174. distance: 1.7906434515889487
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0823, Accuracy: 9695/9900 (97.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4715/5066 (93.0715%), train_poison_data_count: 400
Global model norm: 45.77411420497397.
Norm before scaling: 45.7595485040759. Distance: 2.0016551321662384
Total norm for 4 adversaries is: 45.7595485040759. distance: 2.0016551321662384
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0287, Accuracy: 9823/9900 (99.2222%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3918/4235 (92.5148%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3852/4235 (90.9563%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1235, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3519/3775 (93.2185%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3602/3775 (95.4172%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7982, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4469/4874 (91.6906%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4340/4874 (89.0439%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3024, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4821/5265 (91.5670%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4674/5265 (88.7749%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0252, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4671/5083 (91.8946%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4594/5083 (90.3797%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1269, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4093/4511 (90.7338%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4116/4511 (91.2436%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8906, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4301/4538 (94.7774%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4334/4538 (95.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8159, Accuracy: 5937/10000 (59.3700%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4348/4716 (92.1968%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4358/4716 (92.4088%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0428, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4338/4663 (93.0302%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4344/4663 (93.1589%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9242, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4152/4441 (93.4925%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4123/4441 (92.8395%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0740, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4536/4793 (94.6380%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4541/4793 (94.7423%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8922, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4355/4662 (93.4148%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4386/4662 (94.0798%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8308, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3502/3704 (94.5464%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3498/3704 (94.4384%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7203, Accuracy: 6109/10000 (61.0900%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4601/4989 (92.2229%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4560/4989 (91.4011%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9753, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4111/4346 (94.5927%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4111/4346 (94.5927%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8275, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4123/4362 (94.5209%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4064/4362 (93.1683%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8791, Accuracy: 5752/10000 (57.5200%)
time spent on training: 264.8016483783722
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1887, Accuracy: 5384/10000 (53.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 6.9797, Accuracy: 503/9900 (5.0808%)
Done in 293.95166540145874 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4604/4885 (94.2477%), train_poison_data_count: 385
Global model norm: 45.79468659476228.
Norm before scaling: 45.77559425389118. Distance: 1.8574607676576782
Total norm for 4 adversaries is: 45.77559425389118. distance: 1.8574607676576782
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1552, Accuracy: 9522/9900 (96.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4966/5305 (93.6098%), train_poison_data_count: 415
Global model norm: 45.79468659476228.
Norm before scaling: 45.77763690947388. Distance: 2.0204476319426967
Total norm for 4 adversaries is: 45.77763690947388. distance: 2.0204476319426967
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2474, Accuracy: 9311/9900 (94.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4393/4717 (93.1312%), train_poison_data_count: 370
Global model norm: 45.79468659476228.
Norm before scaling: 45.77525024679002. Distance: 1.846232601695902
Total norm for 4 adversaries is: 45.77525024679002. distance: 1.846232601695902
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1297, Accuracy: 9560/9900 (96.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4728/5066 (93.3281%), train_poison_data_count: 400
Global model norm: 45.79468659476228.
Norm before scaling: 45.781449978232175. Distance: 2.003875196785162
Total norm for 4 adversaries is: 45.781449978232175. distance: 2.003875196785162
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1846, Accuracy: 9440/9900 (95.3535%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3640/3969 (91.7108%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3646/3969 (91.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9708, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4189/4558 (91.9043%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4141/4558 (90.8513%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1108, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4560/4918 (92.7206%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4547/4918 (92.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0564, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5348/5902 (90.6134%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5242/5902 (88.8174%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2223, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4855/5265 (92.2127%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4751/5265 (90.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9514, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4129/4511 (91.5318%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4144/4511 (91.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1288, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4183/4625 (90.4432%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4139/4625 (89.4919%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0928, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4129/4416 (93.5009%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4142/4416 (93.7953%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8573, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3103/3297 (94.1159%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3096/3297 (93.9035%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6871, Accuracy: 6114/10000 (61.1400%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4676/5025 (93.0547%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4679/5025 (93.1144%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1064, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4156/4441 (93.5825%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4170/4441 (93.8978%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1190, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4116/4481 (91.8545%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4033/4481 (90.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2066, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3577/3797 (94.2060%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3598/3797 (94.7590%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7459, Accuracy: 6065/10000 (60.6500%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3380/3646 (92.7043%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3388/3646 (92.9238%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8072, Accuracy: 5908/10000 (59.0800%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3827/4025 (95.0807%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3855/4025 (95.7764%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6921, Accuracy: 6102/10000 (61.0200%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4470/4928 (90.7062%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4408/4928 (89.4481%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0922, Accuracy: 5430/10000 (54.3000%)
time spent on training: 261.65775203704834
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1838, Accuracy: 5368/10000 (53.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 7.1694, Accuracy: 450/9900 (4.5455%)
Done in 290.71364164352417 sec.
Saving all the graphs.
This run has a label: Dec.09_23.08.07. Visdom environment: cifar100_CerP
