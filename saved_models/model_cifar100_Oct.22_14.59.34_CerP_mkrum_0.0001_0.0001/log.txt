current path: saved_models/model_cifar100_Oct.22_14.59.34_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4313/4885 (88.2907%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439858642112604. Distance: 2.2929801875646385
Total norm for 4 adversaries is: 42.439858642112604. distance: 2.2929801875646385
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4370, Accuracy: 8840/9900 (89.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4738/5305 (89.3120%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43521314254384. Distance: 2.249095205005875
Total norm for 4 adversaries is: 42.43521314254384. distance: 2.249095205005875
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7142, Accuracy: 8336/9900 (84.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4180/4717 (88.6156%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43869947218723. Distance: 2.1769426899674764
Total norm for 4 adversaries is: 42.43869947218723. distance: 2.1769426899674764
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4331, Accuracy: 8872/9900 (89.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4459/5066 (88.0182%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.4403116589751. Distance: 2.3037976632281976
Total norm for 4 adversaries is: 42.4403116589751. distance: 2.3037976632281976
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5987, Accuracy: 8510/9900 (85.9596%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3837/4356 (88.0854%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3694/4356 (84.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3983, Accuracy: 4730/10000 (47.3000%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3939/4465 (88.2195%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4083/4465 (91.4446%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9908, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4048/4647 (87.1100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4148/4647 (89.2619%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9742, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4448/5055 (87.9921%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4526/5055 (89.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1043, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4441/5116 (86.8061%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4461/5116 (87.1970%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0404, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3631/4126 (88.0029%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3747/4126 (90.8143%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0207, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3076/3472 (88.5945%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3219/3472 (92.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0267, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4438/4986 (89.0092%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4447/4986 (89.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0438, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3540/4013 (88.2133%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3682/4013 (91.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8625, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4031/4618 (87.2889%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4056/4618 (87.8302%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0938, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4428/5083 (87.1139%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4432/5083 (87.1926%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0545, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3975/4511 (88.1179%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4028/4511 (89.2928%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1577, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3339/3797 (87.9378%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3385/3797 (89.1493%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9583, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5002/5582 (89.6095%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5069/5582 (90.8097%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1149, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3158/3616 (87.3341%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3207/3616 (88.6892%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0971, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4834/5455 (88.6159%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4830/5455 (88.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0548, Accuracy: 5207/10000 (52.0700%)
time spent on training: 236.63068175315857
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1554, Accuracy: 6988/10000 (69.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 10.0402, Accuracy: 44/9900 (0.4444%)
Done in 260.53853583335876 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4376/4885 (89.5803%), train_poison_data_count: 385
Global model norm: 42.46520289638624.
Norm before scaling: 42.47206831452952. Distance: 2.155361600661976
Total norm for 4 adversaries is: 42.47206831452952. distance: 2.155361600661976
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1827, Accuracy: 9412/9900 (95.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4756/5305 (89.6513%), train_poison_data_count: 415
Global model norm: 42.46520289638624.
Norm before scaling: 42.46811332534167. Distance: 2.2056464517900847
Total norm for 4 adversaries is: 42.46811332534167. distance: 2.2056464517900847
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4078, Accuracy: 8893/9900 (89.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4181/4717 (88.6368%), train_poison_data_count: 370
Global model norm: 42.46520289638624.
Norm before scaling: 42.47293485635882. Distance: 2.2067916334941247
Total norm for 4 adversaries is: 42.47293485635882. distance: 2.2067916334941247
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1906, Accuracy: 9426/9900 (95.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4474/5066 (88.3143%), train_poison_data_count: 400
Global model norm: 42.46520289638624.
Norm before scaling: 42.475693876763216. Distance: 2.355681199445636
Total norm for 4 adversaries is: 42.475693876763216. distance: 2.355681199445636
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1635, Accuracy: 9446/9900 (95.4141%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3587/4025 (89.1180%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3704/4025 (92.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8955, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3325/3797 (87.5691%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3389/3797 (89.2547%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0030, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3930/4625 (84.9730%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4018/4625 (86.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1634, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3859/4481 (86.1192%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3870/4481 (86.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1041, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3847/4315 (89.1541%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3984/4315 (92.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9671, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3694/4235 (87.2255%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3774/4235 (89.1145%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0267, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3365/3828 (87.9049%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3497/3828 (91.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9566, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3816/4416 (86.4130%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3938/4416 (89.1757%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0131, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3159/3638 (86.8334%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3270/3638 (89.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0487, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4532/5265 (86.0779%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4499/5265 (85.4511%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9808, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3346/3781 (88.4951%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3305/3781 (87.4107%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2294, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3955/4441 (89.0565%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4006/4441 (90.2049%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1699, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3967/4433 (89.4879%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4018/4433 (90.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9134, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4423/5083 (87.0155%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4459/5083 (87.7238%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1117, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4309/4928 (87.4391%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4373/4928 (88.7378%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9246, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4146/4793 (86.5011%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4360/4793 (90.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0897, Accuracy: 5310/10000 (53.1000%)
time spent on training: 233.94377493858337
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1516, Accuracy: 6988/10000 (69.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.6629, Accuracy: 47/9900 (0.4747%)
Done in 257.91916060447693 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 42.50142317240315.
Norm before scaling: 42.50348532354067. Distance: 2.1177065730302598
Total norm for 4 adversaries is: 42.50348532354067. distance: 2.1177065730302598
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1969, Accuracy: 9379/9900 (94.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4731/5305 (89.1800%), train_poison_data_count: 415
Global model norm: 42.50142317240315.
Norm before scaling: 42.50548562943082. Distance: 2.209880670631375
Total norm for 4 adversaries is: 42.50548562943082. distance: 2.209880670631375
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0727, Accuracy: 9694/9900 (97.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.50142317240315.
Norm before scaling: 42.5044675386269. Distance: 2.0907711645102176
Total norm for 4 adversaries is: 42.5044675386269. distance: 2.0907711645102176
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1780, Accuracy: 9417/9900 (95.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4469/5066 (88.2156%), train_poison_data_count: 400
Global model norm: 42.50142317240315.
Norm before scaling: 42.50720441005045. Distance: 2.252944291443239
Total norm for 4 adversaries is: 42.50720441005045. distance: 2.252944291443239
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1632, Accuracy: 9468/9900 (95.6364%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3139/3616 (86.8086%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3279/3616 (90.6803%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8149, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3395/3837 (88.4806%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3503/3837 (91.2953%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9302, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4154/4679 (88.7797%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4286/4679 (91.6008%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0316, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3115/3638 (85.6240%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3258/3638 (89.5547%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0844, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3607/4046 (89.1498%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3652/4046 (90.2620%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9654, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3970/4518 (87.8707%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4087/4518 (90.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1204, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3347/3797 (88.1485%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3433/3797 (90.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0496, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4427/5025 (88.0995%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4475/5025 (89.0547%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3712, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3884/4362 (89.0417%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3924/4362 (89.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1046, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3985/4558 (87.4287%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4013/4558 (88.0430%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1789, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3194/3672 (86.9826%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3260/3672 (88.7800%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1611, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4319/4874 (88.6130%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4327/4874 (88.7772%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2234, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3603/4025 (89.5155%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3694/4025 (91.7764%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9081, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4097/4663 (87.8619%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4206/4663 (90.1994%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0556, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3438/3911 (87.9059%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3438/3911 (87.9059%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9951, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4429/5017 (88.2798%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4535/5017 (90.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8575, Accuracy: 5640/10000 (56.4000%)
time spent on training: 232.02939748764038
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1871, Accuracy: 6898/10000 (68.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.7327, Accuracy: 42/9900 (0.4242%)
Done in 255.88791155815125 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 42.53156858348719.
Norm before scaling: 42.5358233098695. Distance: 2.1203646873399196
Total norm for 4 adversaries is: 42.5358233098695. distance: 2.1203646873399196
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5468, Accuracy: 8671/9900 (87.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 42.53156858348719.
Norm before scaling: 42.53120120772367. Distance: 2.152266983906371
Total norm for 4 adversaries is: 42.53120120772367. distance: 2.152266983906371
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0958, Accuracy: 9641/9900 (97.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4210/4717 (89.2516%), train_poison_data_count: 370
Global model norm: 42.53156858348719.
Norm before scaling: 42.533670887658964. Distance: 2.092895561211586
Total norm for 4 adversaries is: 42.533670887658964. distance: 2.092895561211586
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1559, Accuracy: 9483/9900 (95.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4469/5066 (88.2156%), train_poison_data_count: 400
Global model norm: 42.53156858348719.
Norm before scaling: 42.53815497769326. Distance: 2.274339529726877
Total norm for 4 adversaries is: 42.53815497769326. distance: 2.274339529726877
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2738, Accuracy: 9193/9900 (92.8586%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5255/6124 (85.8099%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5343/6124 (87.2469%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1245, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3886/4356 (89.2103%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3606/4356 (82.7824%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4496, Accuracy: 4723/10000 (47.2300%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3515/4158 (84.5358%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3631/4158 (87.3256%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0703, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4858/5455 (89.0559%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4887/5455 (89.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9351, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3920/4511 (86.8987%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4062/4511 (90.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9883, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4507/5232 (86.1430%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4520/5232 (86.3914%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1191, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4484/5244 (85.5072%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4546/5244 (86.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0277, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4367/4918 (88.7963%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4387/4918 (89.2029%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2349, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3583/4126 (86.8396%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3733/4126 (90.4750%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8060, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4367/4928 (88.6161%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4423/4928 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1423, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3715/4223 (87.9706%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3847/4223 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9972, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4511/5195 (86.8335%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4634/5195 (89.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1149, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4133/4679 (88.3308%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4133/4679 (88.3308%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0442, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3162/3646 (86.7252%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3266/3646 (89.5776%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8472, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3158/3616 (87.3341%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3215/3616 (88.9104%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8660, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4054/4716 (85.9627%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4131/4716 (87.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9790, Accuracy: 5457/10000 (54.5700%)
time spent on training: 241.82501745224
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.2250, Accuracy: 6832/10000 (68.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.8399, Accuracy: 41/9900 (0.4141%)
Done in 265.8666093349457 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 42.57168672653442.
Norm before scaling: 42.576202651558326. Distance: 2.1252459215466764
Total norm for 4 adversaries is: 42.576202651558326. distance: 2.1252459215466764
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1542, Accuracy: 9504/9900 (96.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 42.57168672653442.
Norm before scaling: 42.566654131436174. Distance: 2.1418366727135303
Total norm for 4 adversaries is: 42.566654131436174. distance: 2.1418366727135303
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1317, Accuracy: 9560/9900 (96.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4204/4717 (89.1244%), train_poison_data_count: 370
Global model norm: 42.57168672653442.
Norm before scaling: 42.57397915595716. Distance: 2.1017929007574843
Total norm for 4 adversaries is: 42.57397915595716. distance: 2.1017929007574843
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1623, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4473/5066 (88.2945%), train_poison_data_count: 400
Global model norm: 42.57168672653442.
Norm before scaling: 42.5809517410294. Distance: 2.3017056070394952
Total norm for 4 adversaries is: 42.5809517410294. distance: 2.3017056070394952
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1945, Accuracy: 9384/9900 (94.7879%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5266/6124 (85.9895%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5312/6124 (86.7407%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0734, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3928/4433 (88.6082%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4003/4433 (90.3000%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8863, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3369/3781 (89.1034%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3252/3781 (86.0090%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2419, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3526/3969 (88.8385%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3580/3969 (90.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9597, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4455/5025 (88.6567%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4507/5025 (89.6915%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2449, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4152/4679 (88.7369%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4235/4679 (90.5108%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9303, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4138/4707 (87.9116%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4224/4707 (89.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9611, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4396/4986 (88.1669%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4433/4986 (88.9089%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9512, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3874/4315 (89.7798%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3938/4315 (91.2630%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8632, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3837/4416 (86.8886%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3909/4416 (88.5190%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9605, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4248/4804 (88.4263%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4064/4804 (84.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2689, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4157/4793 (86.7306%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4290/4793 (89.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0305, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4520/5232 (86.3914%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4575/5232 (87.4427%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9547, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4080/4662 (87.5161%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4219/4662 (90.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9736, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4197/4956 (84.6852%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4306/4956 (86.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2134, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3819/4368 (87.4313%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3846/4368 (88.0495%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9539, Accuracy: 5426/10000 (54.2600%)
time spent on training: 233.93133926391602
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.2455, Accuracy: 6825/10000 (68.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.9047, Accuracy: 38/9900 (0.3838%)
Done in 258.0087378025055 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4360/4885 (89.2528%), train_poison_data_count: 385
Global model norm: 42.6094838649141.
Norm before scaling: 42.613580421364794. Distance: 2.1624223022614872
Total norm for 4 adversaries is: 42.613580421364794. distance: 2.1624223022614872
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2663, Accuracy: 9249/9900 (93.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4758/5305 (89.6890%), train_poison_data_count: 415
Global model norm: 42.6094838649141.
Norm before scaling: 42.60889083424961. Distance: 2.1757824553618184
Total norm for 4 adversaries is: 42.60889083424961. distance: 2.1757824553618184
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2120, Accuracy: 9363/9900 (94.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.6094838649141.
Norm before scaling: 42.60835366166842. Distance: 2.0660867426001257
Total norm for 4 adversaries is: 42.60835366166842. distance: 2.0660867426001257
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1850, Accuracy: 9404/9900 (94.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4467/5066 (88.1761%), train_poison_data_count: 400
Global model norm: 42.6094838649141.
Norm before scaling: 42.618965504844496. Distance: 2.2955642385565787
Total norm for 4 adversaries is: 42.618965504844496. distance: 2.2955642385565787
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1264, Accuracy: 9576/9900 (96.7273%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5296/6124 (86.4794%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5325/6124 (86.9530%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0672, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5048/5902 (85.5303%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5109/5902 (86.5639%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1465, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4157/4707 (88.3153%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4213/4707 (89.5050%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9034, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4059/4647 (87.3467%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4174/4647 (89.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9207, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2925/3297 (88.7170%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3032/3297 (91.9624%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7982, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5550/6263 (88.6157%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5664/6263 (90.4359%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2292, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4125/4663 (88.4624%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4270/4663 (91.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1003, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4286/4956 (86.4810%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4378/4956 (88.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1690, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3603/4046 (89.0509%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3688/4046 (91.1518%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9421, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3699/4184 (88.4082%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3768/4184 (90.0574%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8275, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4844/5591 (86.6392%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4855/5591 (86.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1889, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4062/4634 (87.6565%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4195/4634 (90.5265%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9469, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3332/3828 (87.0428%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3479/3828 (90.8830%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9275, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3096/3638 (85.1017%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3244/3638 (89.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8241, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3362/3781 (88.9183%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3390/3781 (89.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1386, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3365/3837 (87.6987%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3520/3837 (91.7383%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8740, Accuracy: 5627/10000 (56.2700%)
time spent on training: 249.66457414627075
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.2356, Accuracy: 6864/10000 (68.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.8687, Accuracy: 51/9900 (0.5152%)
Done in 273.68500208854675 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4391/4885 (89.8874%), train_poison_data_count: 385
Global model norm: 42.65524123120379.
Norm before scaling: 42.65809577050557. Distance: 2.1117112397043774
Total norm for 4 adversaries is: 42.65809577050557. distance: 2.1117112397043774
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2251, Accuracy: 9368/9900 (94.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4754/5305 (89.6136%), train_poison_data_count: 415
Global model norm: 42.65524123120379.
Norm before scaling: 42.656121222333084. Distance: 2.1612136763636127
Total norm for 4 adversaries is: 42.656121222333084. distance: 2.1612136763636127
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1615, Accuracy: 9504/9900 (96.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4194/4717 (88.9124%), train_poison_data_count: 370
Global model norm: 42.65524123120379.
Norm before scaling: 42.65662631473201. Distance: 2.080003735282185
Total norm for 4 adversaries is: 42.65662631473201. distance: 2.080003735282185
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1510, Accuracy: 9511/9900 (96.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4480/5066 (88.4327%), train_poison_data_count: 400
Global model norm: 42.65524123120379.
Norm before scaling: 42.66013747166742. Distance: 2.235358388614523
Total norm for 4 adversaries is: 42.66013747166742. distance: 2.235358388614523
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1679, Accuracy: 9474/9900 (95.6970%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3859/4501 (85.7365%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3929/4501 (87.2917%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0208, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3659/4175 (87.6407%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3740/4175 (89.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9203, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3114/3616 (86.1173%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3223/3616 (89.1316%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8953, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4053/4634 (87.4622%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4142/4634 (89.3828%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9652, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3980/4558 (87.3190%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3999/4558 (87.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0741, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4550/5167 (88.0588%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4655/5167 (90.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1046, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3932/4356 (90.2663%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3864/4356 (88.7052%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1227, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4105/4716 (87.0441%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4169/4716 (88.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0242, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5349/6124 (87.3449%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5367/6124 (87.6388%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0414, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4403/5055 (87.1019%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4528/5055 (89.5747%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0319, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4463/5025 (88.8159%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4561/5025 (90.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2176, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4346/4918 (88.3693%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4386/4918 (89.1826%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2662, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3694/4223 (87.4734%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3843/4223 (91.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9574, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3983/4481 (88.8864%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3956/4481 (88.2839%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0257, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3171/3638 (87.1633%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3287/3638 (90.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9584, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3570/4013 (88.9609%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3676/4013 (91.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8493, Accuracy: 5636/10000 (56.3600%)
time spent on training: 243.16434001922607
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.2376, Accuracy: 6840/10000 (68.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 10.4223, Accuracy: 33/9900 (0.3333%)
Done in 267.1920726299286 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 42.70016626687477.
Norm before scaling: 42.7024417938395. Distance: 2.093486940170526
Total norm for 4 adversaries is: 42.7024417938395. distance: 2.093486940170526
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2413, Accuracy: 9300/9900 (93.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 42.70016626687477.
Norm before scaling: 42.70048644885384. Distance: 2.182317097833591
Total norm for 4 adversaries is: 42.70048644885384. distance: 2.182317097833591
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2415, Accuracy: 9337/9900 (94.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4222/4717 (89.5060%), train_poison_data_count: 370
Global model norm: 42.70016626687477.
Norm before scaling: 42.70097243477015. Distance: 2.0484907456147767
Total norm for 4 adversaries is: 42.70097243477015. distance: 2.0484907456147767
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2865, Accuracy: 9180/9900 (92.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4484/5066 (88.5116%), train_poison_data_count: 400
Global model norm: 42.70016626687477.
Norm before scaling: 42.70580054735685. Distance: 2.2664611325856088
Total norm for 4 adversaries is: 42.70580054735685. distance: 2.2664611325856088
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1127, Accuracy: 9587/9900 (96.8384%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3193/3646 (87.5754%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3345/3646 (91.7444%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7833, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3917/4501 (87.0251%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4062/4501 (90.2466%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9513, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4043/4651 (86.9275%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4186/4651 (90.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0353, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4532/5167 (87.7105%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4657/5167 (90.1297%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1400, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4848/5455 (88.8726%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4881/5455 (89.4775%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1752, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4839/5591 (86.5498%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4888/5591 (87.4262%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0986, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4181/4679 (89.3567%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4166/4679 (89.0361%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0961, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4446/5017 (88.6187%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4521/5017 (90.1136%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9662, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4198/4793 (87.5861%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4294/4793 (89.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9908, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4018/4456 (90.1706%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4059/4456 (91.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9593, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4802/5424 (88.5324%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4920/5424 (90.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1693, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3619/4175 (86.6826%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3705/4175 (88.7425%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9216, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4472/5116 (87.4120%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4597/5116 (89.8554%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9788, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3250/3704 (87.7430%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3323/3704 (89.7138%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9195, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4451/5232 (85.0726%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4606/5232 (88.0352%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0739, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3088/3472 (88.9401%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3167/3472 (91.2154%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9481, Accuracy: 5638/10000 (56.3800%)
time spent on training: 242.4828417301178
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.2213, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 10.1623, Accuracy: 44/9900 (0.4444%)
Done in 266.5589213371277 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4374/4885 (89.5394%), train_poison_data_count: 385
Global model norm: 42.73921076387291.
Norm before scaling: 42.74151705629361. Distance: 2.107946859026512
Total norm for 4 adversaries is: 42.74151705629361. distance: 2.107946859026512
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3607, Accuracy: 9015/9900 (91.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.73921076387291.
Norm before scaling: 42.739020828362314. Distance: 2.1856055639601073
Total norm for 4 adversaries is: 42.739020828362314. distance: 2.1856055639601073
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2329, Accuracy: 9342/9900 (94.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 42.73921076387291.
Norm before scaling: 42.739237897448376. Distance: 2.0513524595122536
Total norm for 4 adversaries is: 42.739237897448376. distance: 2.0513524595122536
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1654, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4501/5066 (88.8472%), train_poison_data_count: 400
Global model norm: 42.73921076387291.
Norm before scaling: 42.74402027806053. Distance: 2.2307578732886952
Total norm for 4 adversaries is: 42.74402027806053. distance: 2.2307578732886952
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3438, Accuracy: 9018/9900 (91.0909%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3228/3590 (89.9164%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3335/3590 (92.8969%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9416, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3837/4368 (87.8434%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3863/4368 (88.4386%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9224, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3274/3704 (88.3909%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3399/3704 (91.7657%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8553, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4289/4928 (87.0333%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4348/4928 (88.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1253, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3962/4356 (90.9550%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3909/4356 (89.7383%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1212, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3543/3911 (90.5906%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3456/3911 (88.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1029, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4093/4651 (88.0026%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4213/4651 (90.5827%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9988, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3701/4184 (88.4560%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3743/4184 (89.4598%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8485, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3911/4346 (89.9908%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3992/4346 (91.8546%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8549, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4162/4793 (86.8350%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4316/4793 (90.0480%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9852, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3326/3804 (87.4343%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3489/3804 (91.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9970, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4469/4986 (89.6310%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4493/4986 (90.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9021, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5457/6124 (89.1084%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5418/6124 (88.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0592, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4130/4707 (87.7417%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4232/4707 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9593, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3781/4235 (89.2798%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3725/4235 (87.9575%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0135, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3619/4046 (89.4464%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3709/4046 (91.6708%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9545, Accuracy: 5407/10000 (54.0700%)
time spent on training: 237.0465648174286
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.2740, Accuracy: 6762/10000 (67.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.9811, Accuracy: 46/9900 (0.4646%)
Done in 261.1022951602936 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4404/4885 (90.1535%), train_poison_data_count: 385
Global model norm: 42.77140334775021.
Norm before scaling: 42.77341110159003. Distance: 2.136183760650084
Total norm for 4 adversaries is: 42.77341110159003. distance: 2.136183760650084
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1271, Accuracy: 9569/9900 (96.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.77140334775021.
Norm before scaling: 42.77324557605344. Distance: 2.1882689078329203
Total norm for 4 adversaries is: 42.77324557605344. distance: 2.1882689078329203
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0876, Accuracy: 9680/9900 (97.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 42.77140334775021.
Norm before scaling: 42.76941119748655. Distance: 2.0132493797802464
Total norm for 4 adversaries is: 42.76941119748655. distance: 2.0132493797802464
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.4287, Accuracy: 8895/9900 (89.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4479/5066 (88.4129%), train_poison_data_count: 400
Global model norm: 42.77140334775021.
Norm before scaling: 42.77888735258317. Distance: 2.2833303084898726
Total norm for 4 adversaries is: 42.77888735258317. distance: 2.2833303084898726
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2927, Accuracy: 9141/9900 (92.3333%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4400/4986 (88.2471%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4516/4986 (90.5736%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9798, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4050/4634 (87.3975%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4134/4634 (89.2102%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8825, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4118/4716 (87.3198%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4244/4716 (89.9915%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0221, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5399/6124 (88.1613%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5461/6124 (89.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1008, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4342/4918 (88.2879%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4503/4918 (91.5616%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9813, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3327/3797 (87.6218%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3459/3797 (91.0982%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9891, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4958/5582 (88.8212%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5042/5582 (90.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1726, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4292/4956 (86.6021%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4345/4956 (87.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1611, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3939/4433 (88.8563%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4033/4433 (90.9768%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8991, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3831/4354 (87.9881%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3534/4354 (81.1667%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4454, Accuracy: 4706/10000 (47.0600%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4306/4928 (87.3782%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4428/4928 (89.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8907, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3546/3911 (90.6673%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3537/3911 (90.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9046, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3931/4481 (87.7260%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3924/4481 (87.5697%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0503, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4561/5197 (87.7622%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4627/5197 (89.0321%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0544, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4797/5455 (87.9377%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4895/5455 (89.7342%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9789, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3793/4361 (86.9755%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3798/4361 (87.0901%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2300, Accuracy: 5090/10000 (50.9000%)
time spent on training: 249.73511242866516
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.3452, Accuracy: 6652/10000 (66.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 9.8169, Accuracy: 49/9900 (0.4949%)
Done in 273.85294818878174 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4378/4885 (89.6213%), train_poison_data_count: 385
Global model norm: 42.81449157092214.
Norm before scaling: 42.81860557512864. Distance: 2.150449275603724
Total norm for 4 adversaries is: 42.81860557512864. distance: 2.150449275603724
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2001, Accuracy: 9426/9900 (95.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.81449157092214.
Norm before scaling: 42.8137003709458. Distance: 2.1747405544189458
Total norm for 4 adversaries is: 42.8137003709458. distance: 2.1747405544189458
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2634, Accuracy: 9273/9900 (93.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.81449157092214.
Norm before scaling: 42.81449299649448. Distance: 2.087548937195377
Total norm for 4 adversaries is: 42.81449299649448. distance: 2.087548937195377
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1700, Accuracy: 9467/9900 (95.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 42.81449157092214.
Norm before scaling: 42.81893199859147. Distance: 2.2880596789466368
Total norm for 4 adversaries is: 42.81893199859147. distance: 2.2880596789466368
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2175, Accuracy: 9332/9900 (94.2626%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4252/4928 (86.2825%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4399/4928 (89.2654%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9815, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3708/4184 (88.6233%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3741/4184 (89.4120%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0281, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4147/4707 (88.1028%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4266/4707 (90.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9532, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3346/3828 (87.4086%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3517/3828 (91.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9099, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3922/4503 (87.0975%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3989/4503 (88.5854%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0809, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4126/4662 (88.5028%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4230/4662 (90.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9119, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3713/4235 (87.6741%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3814/4235 (90.0590%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0319, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4376/5244 (83.4477%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4534/5244 (86.4607%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9860, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4166/4793 (86.9184%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4352/4793 (90.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0067, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3978/4481 (88.7748%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3951/4481 (88.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0685, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3887/4346 (89.4386%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4005/4346 (92.1537%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7252, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3779/4361 (86.6544%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3788/4361 (86.8608%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0467, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4484/5055 (88.7043%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4534/5055 (89.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8889, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4488/5195 (86.3908%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4529/5195 (87.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1027, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3869/4315 (89.6640%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3994/4315 (92.5608%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9276, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4163/4663 (89.2773%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4235/4663 (90.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0722, Accuracy: 5299/10000 (52.9900%)
time spent on training: 235.99604082107544
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.3207, Accuracy: 6633/10000 (66.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.8959, Accuracy: 45/9900 (0.4545%)
Done in 259.8530285358429 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4390/4885 (89.8669%), train_poison_data_count: 385
Global model norm: 42.84733271626645.
Norm before scaling: 42.851543271417746. Distance: 2.1231089760998496
Total norm for 4 adversaries is: 42.851543271417746. distance: 2.1231089760998496
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.0876, Accuracy: 9673/9900 (97.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4729/5305 (89.1423%), train_poison_data_count: 415
Global model norm: 42.84733271626645.
Norm before scaling: 42.85026704400087. Distance: 2.1996531082978703
Total norm for 4 adversaries is: 42.85026704400087. distance: 2.1996531082978703
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2998, Accuracy: 9165/9900 (92.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 42.84733271626645.
Norm before scaling: 42.845755788204976. Distance: 2.0240300905154576
Total norm for 4 adversaries is: 42.845755788204976. distance: 2.0240300905154576
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1710, Accuracy: 9497/9900 (95.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 42.84733271626645.
Norm before scaling: 42.85372245581838. Distance: 2.2534411924080917
Total norm for 4 adversaries is: 42.85372245581838. distance: 2.2534411924080917
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1533, Accuracy: 9524/9900 (96.2020%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3904/4315 (90.4751%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3954/4315 (91.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9236, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3192/3590 (88.9136%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3207/3590 (89.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1006, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4130/4679 (88.2667%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4233/4679 (90.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8675, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4527/5167 (87.6137%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4609/5167 (89.2007%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1237, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3372/3775 (89.3245%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3540/3775 (93.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8363, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3355/3828 (87.6437%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3471/3828 (90.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8939, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3745/4235 (88.4298%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3872/4235 (91.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9093, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4069/4647 (87.5619%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4204/4647 (90.4670%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8971, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4288/4918 (87.1899%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4394/4918 (89.3453%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1394, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3956/4433 (89.2398%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3984/4433 (89.8714%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0019, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3966/4481 (88.5070%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3988/4481 (88.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1351, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3712/4295 (86.4261%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3674/4295 (85.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0663, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3979/4503 (88.3633%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4023/4503 (89.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9524, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3896/4354 (89.4809%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3683/4354 (84.5889%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4439, Accuracy: 4789/10000 (47.8900%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4411/4986 (88.4677%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4454/4986 (89.3301%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9719, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5566/6263 (88.8711%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5729/6263 (91.4737%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1222, Accuracy: 5206/10000 (52.0600%)
time spent on training: 243.94230818748474
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.3940, Accuracy: 6557/10000 (65.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.8346, Accuracy: 70/9900 (0.7071%)
Done in 267.9332549571991 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4391/4885 (89.8874%), train_poison_data_count: 385
Global model norm: 42.88535942176974.
Norm before scaling: 42.88576361338486. Distance: 2.134260196307088
Total norm for 4 adversaries is: 42.88576361338486. distance: 2.134260196307088
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1756, Accuracy: 9461/9900 (95.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4687/5305 (88.3506%), train_poison_data_count: 415
Global model norm: 42.88535942176974.
Norm before scaling: 42.88867111897456. Distance: 2.3121708816155904
Total norm for 4 adversaries is: 42.88867111897456. distance: 2.3121708816155904
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0649, Accuracy: 9744/9900 (98.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.88535942176974.
Norm before scaling: 42.8868765438508. Distance: 2.0807633251940048
Total norm for 4 adversaries is: 42.8868765438508. distance: 2.0807633251940048
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1666, Accuracy: 9501/9900 (95.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4463/5066 (88.0971%), train_poison_data_count: 400
Global model norm: 42.88535942176974.
Norm before scaling: 42.889836627544994. Distance: 2.264878248601357
Total norm for 4 adversaries is: 42.889836627544994. distance: 2.264878248601357
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0778, Accuracy: 9702/9900 (98.0000%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3687/4223 (87.3076%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3839/4223 (90.9069%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9304, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4832/5455 (88.5793%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4840/5455 (88.7259%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1172, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4964/5582 (88.9287%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5144/5582 (92.1534%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0880, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3952/4465 (88.5106%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4072/4465 (91.1982%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8716, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4966/5591 (88.8213%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5023/5591 (89.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1592, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3503/3911 (89.5679%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3412/3911 (87.2411%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0221, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3991/4356 (91.6208%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0119, Accuracy: 3444/4356 (79.0634%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3314, Accuracy: 4864/10000 (48.6400%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4403/5037 (87.4131%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4560/5037 (90.5301%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8844, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4153/4679 (88.7583%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4285/4679 (91.5794%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0913, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3910/4362 (89.6378%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3874/4362 (88.8125%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0967, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4051/4518 (89.6636%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4161/4518 (92.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9454, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4475/5083 (88.0386%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4513/5083 (88.7861%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0789, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3572/4013 (89.0107%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3669/4013 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7849, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4533/5197 (87.2234%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4665/5197 (89.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1304, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2893/3297 (87.7464%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3037/3297 (92.1140%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7576, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3936/4441 (88.6287%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4008/4441 (90.2499%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0035, Accuracy: 5519/10000 (55.1900%)
time spent on training: 234.61339235305786
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.4991, Accuracy: 6427/10000 (64.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 10.2285, Accuracy: 49/9900 (0.4949%)
Done in 258.6176495552063 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 42.92798208054756.
Norm before scaling: 42.928948896057456. Distance: 2.1587565131163733
Total norm for 4 adversaries is: 42.928948896057456. distance: 2.1587565131163733
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2155, Accuracy: 9387/9900 (94.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4721/5305 (88.9915%), train_poison_data_count: 415
Global model norm: 42.92798208054756.
Norm before scaling: 42.926780639756224. Distance: 2.212661232973334
Total norm for 4 adversaries is: 42.926780639756224. distance: 2.212661232973334
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2039, Accuracy: 9413/9900 (95.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 42.92798208054756.
Norm before scaling: 42.928415728432434. Distance: 2.076206440247606
Total norm for 4 adversaries is: 42.928415728432434. distance: 2.076206440247606
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.4191, Accuracy: 8829/9900 (89.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4442/5066 (87.6826%), train_poison_data_count: 400
Global model norm: 42.92798208054756.
Norm before scaling: 42.933286501777964. Distance: 2.3161363621363606
Total norm for 4 adversaries is: 42.933286501777964. distance: 2.3161363621363606
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2948, Accuracy: 9154/9900 (92.4646%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3961/4501 (88.0027%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4050/4501 (89.9800%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9915, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3922/4511 (86.9430%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4080/4511 (90.4456%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9374, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3959/4354 (90.9279%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0115, Accuracy: 3409/4354 (78.2958%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5418, Accuracy: 4496/10000 (44.9600%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3868/4346 (89.0014%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4017/4346 (92.4298%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9812, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4134/4707 (87.8266%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4273/4707 (90.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8986, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4949/5591 (88.5173%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4993/5591 (89.3042%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9715, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4072/4647 (87.6264%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4209/4647 (90.5746%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8682, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4016/4538 (88.4971%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4201/4538 (92.5738%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8915, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4290/4934 (86.9477%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4347/4934 (88.1030%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3057, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4330/4804 (90.1332%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4349/4804 (90.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9692, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5546/6263 (88.5518%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5661/6263 (90.3880%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1854, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3929/4481 (87.6813%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4003/4481 (89.3327%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0247, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4353/5063 (85.9767%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4424/5063 (87.3790%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9456, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3663/4223 (86.7393%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3878/4223 (91.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9421, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3961/4441 (89.1916%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4041/4441 (90.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0924, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3327/3756 (88.5783%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3459/3756 (92.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0097, Accuracy: 5456/10000 (54.5600%)
time spent on training: 236.93176937103271
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.4720, Accuracy: 6463/10000 (64.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 10.4374, Accuracy: 51/9900 (0.5152%)
Done in 262.03785514831543 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4332/4885 (88.6796%), train_poison_data_count: 385
Global model norm: 42.97328243140949.
Norm before scaling: 42.976780499583434. Distance: 2.2327766303457377
Total norm for 4 adversaries is: 42.976780499583434. distance: 2.2327766303457377
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1726, Accuracy: 9461/9900 (95.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4709/5305 (88.7653%), train_poison_data_count: 415
Global model norm: 42.97328243140949.
Norm before scaling: 42.97384628868761. Distance: 2.3040287434122804
Total norm for 4 adversaries is: 42.97384628868761. distance: 2.3040287434122804
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0643, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4181/4717 (88.6368%), train_poison_data_count: 370
Global model norm: 42.97328243140949.
Norm before scaling: 42.97714548663845. Distance: 2.1335433434392046
Total norm for 4 adversaries is: 42.97714548663845. distance: 2.1335433434392046
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2590, Accuracy: 9226/9900 (93.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4463/5066 (88.0971%), train_poison_data_count: 400
Global model norm: 42.97328243140949.
Norm before scaling: 42.979066943251574. Distance: 2.3114578373137586
Total norm for 4 adversaries is: 42.979066943251574. distance: 2.3114578373137586
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2002, Accuracy: 9358/9900 (94.5253%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4410/5244 (84.0961%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4540/5244 (86.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9590, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4262/4928 (86.4854%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4483/4928 (90.9700%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8728, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3363/3804 (88.4069%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3489/3804 (91.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9293, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3541/4013 (88.2382%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3660/4013 (91.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9030, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3512/4158 (84.4637%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3625/4158 (87.1813%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9126, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4968/5582 (89.0004%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5070/5582 (90.8277%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9494, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4813/5455 (88.2310%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4933/5455 (90.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0674, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4034/4354 (92.6504%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3810/4354 (87.5057%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.4881, Accuracy: 4905/10000 (49.0500%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3895/4433 (87.8637%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4035/4433 (91.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9394, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3145/3646 (86.2589%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3323/3646 (91.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8636, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4001/4518 (88.5569%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4089/4518 (90.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0409, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3706/4235 (87.5089%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3798/4235 (89.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0797, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3925/4362 (89.9817%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3978/4362 (91.1967%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0424, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4744/5392 (87.9822%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4734/5392 (87.7967%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0973, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4890/5591 (87.4620%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4948/5591 (88.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1990, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3305/3756 (87.9925%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3415/3756 (90.9212%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9846, Accuracy: 5564/10000 (55.6400%)
time spent on training: 238.5467493534088
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.5339, Accuracy: 6363/10000 (63.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 10.8177, Accuracy: 31/9900 (0.3131%)
Done in 264.86822414398193 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4355/4885 (89.1505%), train_poison_data_count: 385
Global model norm: 43.00639118337166.
Norm before scaling: 43.010715302810006. Distance: 2.188472967387442
Total norm for 4 adversaries is: 43.010715302810006. distance: 2.188472967387442
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1731, Accuracy: 9467/9900 (95.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4676/5305 (88.1433%), train_poison_data_count: 415
Global model norm: 43.00639118337166.
Norm before scaling: 43.00749389641298. Distance: 2.310058232518863
Total norm for 4 adversaries is: 43.00749389641298. distance: 2.310058232518863
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0383, Accuracy: 9795/9900 (98.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4162/4717 (88.2340%), train_poison_data_count: 370
Global model norm: 43.00639118337166.
Norm before scaling: 43.00989365423306. Distance: 2.176708304730856
Total norm for 4 adversaries is: 43.00989365423306. distance: 2.176708304730856
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1234, Accuracy: 9594/9900 (96.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4415/5066 (87.1496%), train_poison_data_count: 400
Global model norm: 43.00639118337166.
Norm before scaling: 43.014406141921654. Distance: 2.4126664850375987
Total norm for 4 adversaries is: 43.014406141921654. distance: 2.4126664850375987
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1061, Accuracy: 9621/9900 (97.1818%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4084/4634 (88.1312%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4157/4634 (89.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9564, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3952/4503 (87.7637%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4015/4503 (89.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1615, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4282/4928 (86.8912%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4473/4928 (90.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7693, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3304/3804 (86.8559%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3428/3804 (90.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9644, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3156/3590 (87.9109%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3078/3590 (85.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2663, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4040/4647 (86.9378%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4263/4647 (91.7366%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8753, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3925/4625 (84.8649%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4067/4625 (87.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0770, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4023/4356 (92.3554%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4094/4356 (93.9853%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9521, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3335/3797 (87.8325%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3484/3797 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9517, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3969/4456 (89.0709%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4083/4456 (91.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8206, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3538/4025 (87.9006%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3680/4025 (91.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9294, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3078/3472 (88.6521%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3177/3472 (91.5035%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9872, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0072, Accuracy: 2833/3297 (85.9266%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3035/3297 (92.0534%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8188, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3809/4416 (86.2545%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3961/4416 (89.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0135, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3929/4356 (90.1974%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4076/4356 (93.5721%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0166, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3138/3638 (86.2562%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3306/3638 (90.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8991, Accuracy: 5539/10000 (55.3900%)
time spent on training: 234.03415775299072
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.5882, Accuracy: 6245/10000 (62.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 11.5155, Accuracy: 12/9900 (0.1212%)
Done in 259.2701966762543 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4343/4885 (88.9048%), train_poison_data_count: 385
Global model norm: 43.03009825074479.
Norm before scaling: 43.03410796382548. Distance: 2.2476319461233807
Total norm for 4 adversaries is: 43.03410796382548. distance: 2.2476319461233807
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1486, Accuracy: 9548/9900 (96.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4717/5305 (88.9161%), train_poison_data_count: 415
Global model norm: 43.03009825074479.
Norm before scaling: 43.03200457762513. Distance: 2.2619948144544666
Total norm for 4 adversaries is: 43.03200457762513. distance: 2.2619948144544666
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1277, Accuracy: 9576/9900 (96.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4192/4717 (88.8700%), train_poison_data_count: 370
Global model norm: 43.03009825074479.
Norm before scaling: 43.02814502913689. Distance: 2.1028653895767286
Total norm for 4 adversaries is: 43.02814502913689. distance: 2.1028653895767286
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1317, Accuracy: 9550/9900 (96.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4455/5066 (87.9392%), train_poison_data_count: 400
Global model norm: 43.03009825074479.
Norm before scaling: 43.038158430103486. Distance: 2.3442410781103136
Total norm for 4 adversaries is: 43.038158430103486. distance: 2.3442410781103136
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1226, Accuracy: 9602/9900 (96.9899%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3586/4175 (85.8922%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3717/4175 (89.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9525, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4181/4956 (84.3624%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4421/4956 (89.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0841, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4340/5037 (86.1624%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4593/5037 (91.1852%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8598, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4128/4793 (86.1256%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4304/4793 (89.7976%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1571, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3311/3804 (87.0400%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3421/3804 (89.9317%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0322, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4731/5392 (87.7411%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4820/5392 (89.3917%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0048, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3930/4465 (88.0179%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4039/4465 (90.4591%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8844, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4064/4596 (88.4247%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4192/4596 (91.2097%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9208, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5340/6124 (87.1979%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5416/6124 (88.4389%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9721, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2814/3271 (86.0287%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2968/3271 (90.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9536, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3128/3590 (87.1309%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3175/3590 (88.4401%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0468, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3833/4501 (85.1589%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3990/4501 (88.6470%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0218, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4512/5232 (86.2385%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4608/5232 (88.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0587, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3193/3672 (86.9553%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3306/3672 (90.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0345, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3672/4223 (86.9524%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3857/4223 (91.3332%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9709, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4112/4354 (94.4419%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0119, Accuracy: 3414/4354 (78.4107%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.5253, Accuracy: 4588/10000 (45.8800%)
time spent on training: 233.6332814693451
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.6562, Accuracy: 6120/10000 (61.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 10.7398, Accuracy: 41/9900 (0.4141%)
Done in 257.94082736968994 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4345/4885 (88.9458%), train_poison_data_count: 385
Global model norm: 43.076311396353624.
Norm before scaling: 43.082674258790654. Distance: 2.2336410704247083
Total norm for 4 adversaries is: 43.082674258790654. distance: 2.2336410704247083
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.4005, Accuracy: 8969/9900 (90.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4730/5305 (89.1612%), train_poison_data_count: 415
Global model norm: 43.076311396353624.
Norm before scaling: 43.07695325074868. Distance: 2.236814860718332
Total norm for 4 adversaries is: 43.07695325074868. distance: 2.236814860718332
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1177, Accuracy: 9610/9900 (97.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4176/4717 (88.5308%), train_poison_data_count: 370
Global model norm: 43.076311396353624.
Norm before scaling: 43.07970192298732. Distance: 2.2231458717977235
Total norm for 4 adversaries is: 43.07970192298732. distance: 2.2231458717977235
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0996, Accuracy: 9638/9900 (97.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4440/5066 (87.6431%), train_poison_data_count: 400
Global model norm: 43.076311396353624.
Norm before scaling: 43.08540415014405. Distance: 2.356248919337503
Total norm for 4 adversaries is: 43.08540415014405. distance: 2.356248919337503
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1718, Accuracy: 9486/9900 (95.8182%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4940/5582 (88.4987%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5052/5582 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0765, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4020/4647 (86.5074%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4239/4647 (91.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9736, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3891/4465 (87.1445%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4081/4465 (91.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8394, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4376/5083 (86.0909%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4502/5083 (88.5697%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1601, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3722/4416 (84.2844%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3971/4416 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9931, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4210/4956 (84.9475%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4374/4956 (88.2567%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1211, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3867/4362 (88.6520%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3850/4362 (88.2623%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1475, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3989/4356 (91.5748%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3974/4356 (91.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1867, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3289/3781 (86.9876%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3408/3781 (90.1349%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0938, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3156/3590 (87.9109%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3241/3590 (90.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0533, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4050/4651 (87.0780%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4219/4651 (90.7117%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0229, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4068/4662 (87.2587%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4214/4662 (90.3904%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9968, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3055/3472 (87.9896%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3211/3472 (92.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8723, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4775/5424 (88.0347%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4935/5424 (90.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0868, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2837/3271 (86.7319%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0060, Accuracy: 2887/3271 (88.2605%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8442, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4347/5037 (86.3014%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4566/5037 (90.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8682, Accuracy: 5610/10000 (56.1000%)
time spent on training: 242.54412627220154
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5245901639344263.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.6065573770491803.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.5081967213114754.
Suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Misclassification from 58 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.4979, Accuracy: 6368/10000 (63.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 10.3637, Accuracy: 57/9900 (0.5758%)
Done in 266.9539396762848 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4347/4885 (88.9867%), train_poison_data_count: 385
Global model norm: 43.1059471611988.
Norm before scaling: 43.108347101735994. Distance: 2.1847783187041845
Total norm for 4 adversaries is: 43.108347101735994. distance: 2.1847783187041845
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2001, Accuracy: 9381/9900 (94.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4712/5305 (88.8219%), train_poison_data_count: 415
Global model norm: 43.1059471611988.
Norm before scaling: 43.106860428655956. Distance: 2.286786506986154
Total norm for 4 adversaries is: 43.106860428655956. distance: 2.286786506986154
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1606, Accuracy: 9484/9900 (95.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4196/4717 (88.9548%), train_poison_data_count: 370
Global model norm: 43.1059471611988.
Norm before scaling: 43.10257993973142. Distance: 2.0584155010960705
Total norm for 4 adversaries is: 43.10257993973142. distance: 2.0584155010960705
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3194, Accuracy: 9143/9900 (92.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4408/5066 (87.0114%), train_poison_data_count: 400
Global model norm: 43.1059471611988.
Norm before scaling: 43.113979003878484. Distance: 2.35834910339187
Total norm for 4 adversaries is: 43.113979003878484. distance: 2.35834910339187
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.5311, Accuracy: 8585/9900 (86.7172%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4255/4989 (85.2876%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4439/4989 (88.9757%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9236, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3558/4013 (88.6618%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3705/4013 (92.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8357, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4439/5195 (85.4475%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4454/5195 (85.7363%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1663, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3475/3969 (87.5535%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3571/3969 (89.9723%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9136, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4114/4356 (94.4444%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4078/4356 (93.6180%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9776, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3919/4441 (88.2459%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4018/4441 (90.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0428, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4029/4518 (89.1766%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4131/4518 (91.4343%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8158, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3422/3911 (87.4968%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3374/3911 (86.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0525, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3844/4362 (88.1247%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3836/4362 (87.9413%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.3218, Accuracy: 4961/10000 (49.6100%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3344/3804 (87.9075%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3455/3804 (90.8254%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0738, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3644/4223 (86.2894%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3801/4223 (90.0071%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0756, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4029/4634 (86.9443%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4178/4634 (90.1597%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9486, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4143/4354 (95.1539%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3645/4354 (83.7161%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.3372, Accuracy: 4927/10000 (49.2700%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0088, Accuracy: 4307/5244 (82.1320%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4570/5244 (87.1472%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9033, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4363/5037 (86.6190%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4561/5037 (90.5499%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9282, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3150/3704 (85.0432%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3326/3704 (89.7948%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9094, Accuracy: 5544/10000 (55.4400%)
time spent on training: 231.87554836273193
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.5356, Accuracy: 6306/10000 (63.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 9.8686, Accuracy: 84/9900 (0.8485%)
Done in 255.84079575538635 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4353/4885 (89.1095%), train_poison_data_count: 385
Global model norm: 43.14540532868549.
Norm before scaling: 43.14901816443437. Distance: 2.20765318083106
Total norm for 4 adversaries is: 43.14901816443437. distance: 2.20765318083106
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1858, Accuracy: 9438/9900 (95.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4698/5305 (88.5580%), train_poison_data_count: 415
Global model norm: 43.14540532868549.
Norm before scaling: 43.14974097818404. Distance: 2.2986625929410613
Total norm for 4 adversaries is: 43.14974097818404. distance: 2.2986625929410613
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1801, Accuracy: 9476/9900 (95.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4178/4717 (88.5732%), train_poison_data_count: 370
Global model norm: 43.14540532868549.
Norm before scaling: 43.14462302644154. Distance: 2.1031840708628895
Total norm for 4 adversaries is: 43.14462302644154. distance: 2.1031840708628895
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1564, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4453/5066 (87.8997%), train_poison_data_count: 400
Global model norm: 43.14540532868549.
Norm before scaling: 43.150992789401. Distance: 2.3066654317040345
Total norm for 4 adversaries is: 43.150992789401. distance: 2.3066654317040345
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.3456, Accuracy: 9061/9900 (91.5253%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3780/4416 (85.5978%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3920/4416 (88.7681%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8064, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4484/5197 (86.2805%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4604/5197 (88.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9288, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4234/4918 (86.0919%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4438/4918 (90.2399%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1741, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5499/6263 (87.8014%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5607/6263 (89.5258%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2389, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3125/3646 (85.7104%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3298/3646 (90.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8133, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4114/4707 (87.4017%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4268/4707 (90.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8785, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4330/5063 (85.5224%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4330/5063 (85.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3092, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3642/4295 (84.7963%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3849/4295 (89.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0172, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4103/4793 (85.6040%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4301/4793 (89.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1071, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3985/4538 (87.8140%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4180/4538 (92.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9029, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4426/5083 (87.0746%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4510/5083 (88.7271%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0004, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3095/3638 (85.0742%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3244/3638 (89.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8440, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5308/6124 (86.6754%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5459/6124 (89.1411%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9622, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3998/4618 (86.5743%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4090/4618 (88.5665%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9732, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3458/3969 (87.1252%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3555/3969 (89.5692%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9543, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0088, Accuracy: 3450/4158 (82.9726%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3690/4158 (88.7446%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9216, Accuracy: 5391/10000 (53.9100%)
time spent on training: 237.4031925201416
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.5097, Accuracy: 6406/10000 (64.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.9817, Accuracy: 98/9900 (0.9899%)
Done in 261.4332363605499 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4321/4885 (88.4545%), train_poison_data_count: 385
Global model norm: 43.18238369658106.
Norm before scaling: 43.186984157103836. Distance: 2.1840030511757913
Total norm for 4 adversaries is: 43.186984157103836. distance: 2.1840030511757913
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2948, Accuracy: 9174/9900 (92.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4674/5305 (88.1056%), train_poison_data_count: 415
Global model norm: 43.18238369658106.
Norm before scaling: 43.184609787063465. Distance: 2.2874980697206784
Total norm for 4 adversaries is: 43.184609787063465. distance: 2.2874980697206784
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2334, Accuracy: 9309/9900 (94.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4175/4717 (88.5096%), train_poison_data_count: 370
Global model norm: 43.18238369658106.
Norm before scaling: 43.17963307962013. Distance: 2.1084628923537205
Total norm for 4 adversaries is: 43.17963307962013. distance: 2.1084628923537205
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2274, Accuracy: 9292/9900 (93.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4425/5066 (87.3470%), train_poison_data_count: 400
Global model norm: 43.18238369658106.
Norm before scaling: 43.18853873343815. Distance: 2.3334645733936488
Total norm for 4 adversaries is: 43.18853873343815. distance: 2.3334645733936488
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2937, Accuracy: 9148/9900 (92.4040%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4050/4716 (85.8779%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4194/4716 (88.9313%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0629, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3916/4481 (87.3912%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3987/4481 (88.9757%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1327, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3843/4361 (88.1220%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3845/4361 (88.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0629, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4136/4793 (86.2925%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4340/4793 (90.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0233, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3732/4295 (86.8917%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3745/4295 (87.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0508, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 4391/5244 (83.7338%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4549/5244 (86.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0254, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4284/4989 (85.8689%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4441/4989 (89.0158%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8776, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4546/5197 (87.4735%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4628/5197 (89.0514%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9721, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3980/4356 (91.3682%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3764/4356 (86.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3304, Accuracy: 4778/10000 (47.7800%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4015/4647 (86.3998%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4176/4647 (89.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9718, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3577/4013 (89.1353%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3719/4013 (92.6738%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7340, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4007/4538 (88.2988%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4194/4538 (92.4196%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8310, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4085/4707 (86.7856%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4232/4707 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8420, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5496/6263 (87.7535%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5681/6263 (90.7073%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0221, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3713/4235 (87.6741%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3715/4235 (87.7214%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0438, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3351/3861 (86.7910%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3509/3861 (90.8832%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8945, Accuracy: 5593/10000 (55.9300%)
time spent on training: 231.7020366191864
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.5147, Accuracy: 6389/10000 (63.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 9.4898, Accuracy: 156/9900 (1.5758%)
Done in 255.82212686538696 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4310/4885 (88.2293%), train_poison_data_count: 385
Global model norm: 43.21321367287441.
Norm before scaling: 43.217293958209744. Distance: 2.2398214051030525
Total norm for 4 adversaries is: 43.217293958209744. distance: 2.2398214051030525
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1486, Accuracy: 9496/9900 (95.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4676/5305 (88.1433%), train_poison_data_count: 415
Global model norm: 43.21321367287441.
Norm before scaling: 43.21725582648527. Distance: 2.281595282356339
Total norm for 4 adversaries is: 43.21725582648527. distance: 2.281595282356339
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1957, Accuracy: 9440/9900 (95.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4178/4717 (88.5732%), train_poison_data_count: 370
Global model norm: 43.21321367287441.
Norm before scaling: 43.21234220167529. Distance: 2.1160909480504713
Total norm for 4 adversaries is: 43.21234220167529. distance: 2.1160909480504713
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1680, Accuracy: 9492/9900 (95.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4406/5066 (86.9720%), train_poison_data_count: 400
Global model norm: 43.21321367287441.
Norm before scaling: 43.22014950508834. Distance: 2.3714882838204896
Total norm for 4 adversaries is: 43.22014950508834. distance: 2.3714882838204896
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1614, Accuracy: 9486/9900 (95.8182%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4461/5055 (88.2493%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4602/5055 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9077, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3320/3828 (86.7294%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3503/3828 (91.5099%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9501, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3838/4361 (88.0073%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3910/4361 (89.6583%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0654, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3519/4013 (87.6900%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3699/4013 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8925, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4006/4518 (88.6676%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4132/4518 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9786, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3936/4558 (86.3537%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4021/4558 (88.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2020, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3598/4126 (87.2031%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3779/4126 (91.5899%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8176, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4147/4679 (88.6300%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3992/4679 (85.3174%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1917, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3729/4235 (88.0519%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3821/4235 (90.2243%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9402, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4314/5037 (85.6462%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4569/5037 (90.7088%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9836, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3145/3672 (85.6481%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3305/3672 (90.0054%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8249, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4269/4928 (86.6274%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4389/4928 (89.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9482, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4035/4356 (92.6309%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3984/4356 (91.4601%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0122, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3945/4456 (88.5323%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4097/4456 (91.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0579, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4131/4793 (86.1882%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4362/4793 (91.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9788, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4411/5025 (87.7811%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4569/5025 (90.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0151, Accuracy: 5470/10000 (54.7000%)
time spent on training: 233.13160252571106
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.5196, Accuracy: 6394/10000 (63.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 9.4673, Accuracy: 159/9900 (1.6061%)
Done in 257.05200839042664 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 43.249065763934425.
Norm before scaling: 43.253684531909386. Distance: 2.177150658352853
Total norm for 4 adversaries is: 43.253684531909386. distance: 2.177150658352853
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1007, Accuracy: 9648/9900 (97.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4699/5305 (88.5768%), train_poison_data_count: 415
Global model norm: 43.249065763934425.
Norm before scaling: 43.250132654240204. Distance: 2.2869123444032318
Total norm for 4 adversaries is: 43.250132654240204. distance: 2.2869123444032318
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1355, Accuracy: 9540/9900 (96.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 43.249065763934425.
Norm before scaling: 43.247500661616996. Distance: 2.0702681626664554
Total norm for 4 adversaries is: 43.247500661616996. distance: 2.0702681626664554
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2584, Accuracy: 9245/9900 (93.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4408/5066 (87.0114%), train_poison_data_count: 400
Global model norm: 43.249065763934425.
Norm before scaling: 43.254708976397154. Distance: 2.336307151915874
Total norm for 4 adversaries is: 43.254708976397154. distance: 2.336307151915874
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2220, Accuracy: 9333/9900 (94.2727%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3869/4346 (89.0244%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4019/4346 (92.4758%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9354, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3656/4184 (87.3805%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3761/4184 (89.8901%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9899, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4034/4356 (92.6079%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3861/4356 (88.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0634, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3162/3646 (86.7252%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3312/3646 (90.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8628, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4442/5083 (87.3893%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4532/5083 (89.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0961, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4052/4356 (93.0211%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4033/4356 (92.5849%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9526, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3936/4558 (86.3537%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4074/4558 (89.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0020, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3572/4175 (85.5569%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3749/4175 (89.7964%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8785, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3051/3472 (87.8744%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3141/3472 (90.4666%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0531, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3909/4501 (86.8474%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4042/4501 (89.8023%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1634, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4774/5424 (88.0162%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4921/5424 (90.7264%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1986, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3891/4481 (86.8333%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3975/4481 (88.7079%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0633, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4770/5455 (87.4427%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4870/5455 (89.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2711, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4510/5232 (86.2003%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4657/5232 (89.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0503, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5480/6391 (85.7456%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5531/6391 (86.5436%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0657, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3346/3775 (88.6358%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3531/3775 (93.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8565, Accuracy: 5699/10000 (56.9900%)
time spent on training: 235.35764932632446
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.4890, Accuracy: 6466/10000 (64.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 9.7481, Accuracy: 119/9900 (1.2020%)
Done in 259.4887628555298 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4375/4885 (89.5599%), train_poison_data_count: 385
Global model norm: 43.296006622471836.
Norm before scaling: 43.294100641896065. Distance: 2.206250942327282
Total norm for 4 adversaries is: 43.294100641896065. distance: 2.206250942327282
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1416, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4733/5305 (89.2177%), train_poison_data_count: 415
Global model norm: 43.296006622471836.
Norm before scaling: 43.290547850577326. Distance: 2.2043321697594105
Total norm for 4 adversaries is: 43.290547850577326. distance: 2.2043321697594105
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0989, Accuracy: 9623/9900 (97.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4194/4717 (88.9124%), train_poison_data_count: 370
Global model norm: 43.296006622471836.
Norm before scaling: 43.291538995891706. Distance: 2.0580324279929143
Total norm for 4 adversaries is: 43.291538995891706. distance: 2.0580324279929143
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1348, Accuracy: 9553/9900 (96.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4400/5066 (86.8535%), train_poison_data_count: 400
Global model norm: 43.296006622471836.
Norm before scaling: 43.30136180965112. Distance: 2.3405985689389777
Total norm for 4 adversaries is: 43.30136180965112. distance: 2.3405985689389777
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1878, Accuracy: 9403/9900 (94.9798%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3563/4025 (88.5217%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3704/4025 (92.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8236, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3702/4223 (87.6628%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3859/4223 (91.3805%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9759, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3147/3638 (86.5036%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3334/3638 (91.6438%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8894, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4410/5063 (87.1025%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4480/5063 (88.4851%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0375, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4244/4874 (87.0743%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4235/4874 (86.8896%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2267, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4324/4804 (90.0083%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4143/4804 (86.2406%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3567, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3522/4158 (84.7042%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3652/4158 (87.8307%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8225, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3957/4518 (87.5830%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4141/4518 (91.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9207, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3763/4235 (88.8548%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3700/4235 (87.3672%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1306, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4256/4934 (86.2586%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4168/4934 (84.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2719, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5575/6391 (87.2320%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5717/6391 (89.4539%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0902, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3754/4295 (87.4040%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3793/4295 (88.3120%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1128, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3347/3756 (89.1108%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3479/3756 (92.6251%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8912, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3956/4481 (88.2839%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3965/4481 (88.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9433, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3611/4175 (86.4910%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3707/4175 (88.7904%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9493, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3162/3590 (88.0780%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3161/3590 (88.0501%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1128, Accuracy: 5318/10000 (53.1800%)
time spent on training: 242.68306040763855
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.5338, Accuracy: 6356/10000 (63.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 10.1170, Accuracy: 75/9900 (0.7576%)
Done in 270.81741523742676 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4372/4885 (89.4985%), train_poison_data_count: 385
Global model norm: 43.33548187406957.
Norm before scaling: 43.336681843030654. Distance: 2.167358202492467
Total norm for 4 adversaries is: 43.336681843030654. distance: 2.167358202492467
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2714, Accuracy: 9200/9900 (92.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4736/5305 (89.2743%), train_poison_data_count: 415
Global model norm: 43.33548187406957.
Norm before scaling: 43.334469198354384. Distance: 2.2044676889434007
Total norm for 4 adversaries is: 43.334469198354384. distance: 2.2044676889434007
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.3522, Accuracy: 9055/9900 (91.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4198/4717 (88.9972%), train_poison_data_count: 370
Global model norm: 43.33548187406957.
Norm before scaling: 43.33570299760782. Distance: 2.066533162306641
Total norm for 4 adversaries is: 43.33570299760782. distance: 2.066533162306641
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1264, Accuracy: 9596/9900 (96.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4428/5066 (87.4062%), train_poison_data_count: 400
Global model norm: 43.33548187406957.
Norm before scaling: 43.34130253994883. Distance: 2.3212400695226822
Total norm for 4 adversaries is: 43.34130253994883. distance: 2.3212400695226822
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1904, Accuracy: 9410/9900 (95.0505%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3356/3828 (87.6698%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3514/3828 (91.7973%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8608, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3448/3911 (88.1616%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3386/3911 (86.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0657, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3880/4362 (88.9500%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3991/4362 (91.4947%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8857, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4626/5197 (89.0129%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4627/5197 (89.0321%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0983, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4280/4679 (91.4725%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4338/4679 (92.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8955, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4141/4793 (86.3968%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4316/4793 (90.0480%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0258, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4434/5116 (86.6693%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4591/5116 (89.7381%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0756, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3948/4625 (85.3622%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4059/4625 (87.7622%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9843, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4122/4618 (89.2594%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4180/4618 (90.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0044, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2865/3271 (87.5879%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0046, Accuracy: 2971/3271 (90.8285%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9342, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3652/4175 (87.4731%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3737/4175 (89.5090%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9155, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3112/3616 (86.0619%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3277/3616 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8087, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3909/4481 (87.2350%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4001/4481 (89.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0367, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3809/4368 (87.2024%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3909/4368 (89.4918%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9512, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4991/5740 (86.9512%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5210/5740 (90.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0215, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4030/4647 (86.7226%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4188/4647 (90.1227%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9735, Accuracy: 5460/10000 (54.6000%)
time spent on training: 239.47284841537476
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.5662, Accuracy: 6342/10000 (63.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 8.6651, Accuracy: 233/9900 (2.3535%)
Done in 267.52634358406067 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 43.369455472356925.
Norm before scaling: 43.36726983306002. Distance: 2.098200494784685
Total norm for 4 adversaries is: 43.36726983306002. distance: 2.098200494784685
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.3476, Accuracy: 9004/9900 (90.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 43.369455472356925.
Norm before scaling: 43.36170883358669. Distance: 2.1428030029905325
Total norm for 4 adversaries is: 43.36170883358669. distance: 2.1428030029905325
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2285, Accuracy: 9334/9900 (94.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4198/4717 (88.9972%), train_poison_data_count: 370
Global model norm: 43.369455472356925.
Norm before scaling: 43.36988470602686. Distance: 2.0697086245256338
Total norm for 4 adversaries is: 43.36988470602686. distance: 2.0697086245256338
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1559, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4442/5066 (87.6826%), train_poison_data_count: 400
Global model norm: 43.369455472356925.
Norm before scaling: 43.37480581278578. Distance: 2.2916336981973946
Total norm for 4 adversaries is: 43.37480581278578. distance: 2.2916336981973946
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1447, Accuracy: 9521/9900 (96.1717%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4939/5591 (88.3384%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4989/5591 (89.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1002, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4247/4956 (85.6941%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4323/4956 (87.2276%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0542, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3924/4511 (86.9874%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4081/4511 (90.4677%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9821, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3572/4013 (89.0107%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3693/4013 (92.0259%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8017, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3165/3590 (88.1616%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3296/3590 (91.8106%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9888, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4166/4793 (86.9184%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4362/4793 (91.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0027, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3359/3804 (88.3018%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3472/3804 (91.2723%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0942, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3372/3837 (87.8812%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3525/3837 (91.8686%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9092, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3872/4361 (88.7870%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3783/4361 (86.7462%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0868, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4433/5063 (87.5568%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4463/5063 (88.1493%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1427, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3769/4368 (86.2866%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3911/4368 (89.5375%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9202, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4260/4679 (91.0451%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4202/4679 (89.8055%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1189, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4657/5265 (88.4520%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4639/5265 (88.1102%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0267, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4096/4767 (85.9241%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4228/4767 (88.6931%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0812, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5179/5902 (87.7499%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0078, Accuracy: 5015/5902 (84.9712%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.4455, Accuracy: 4752/10000 (47.5200%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3699/4223 (87.5918%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3870/4223 (91.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0900, Accuracy: 5407/10000 (54.0700%)
time spent on training: 235.91690039634705
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.5438, Accuracy: 6356/10000 (63.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 9.1638, Accuracy: 157/9900 (1.5859%)
Done in 260.2777998447418 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4394/4885 (89.9488%), train_poison_data_count: 385
Global model norm: 43.4177998829937.
Norm before scaling: 43.414483560356906. Distance: 2.073521153732362
Total norm for 4 adversaries is: 43.414483560356906. distance: 2.073521153732362
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3182, Accuracy: 9077/9900 (91.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4714/5305 (88.8596%), train_poison_data_count: 415
Global model norm: 43.4177998829937.
Norm before scaling: 43.41680599685737. Distance: 2.229915409964177
Total norm for 4 adversaries is: 43.41680599685737. distance: 2.229915409964177
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2466, Accuracy: 9226/9900 (93.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 43.4177998829937.
Norm before scaling: 43.4130551720908. Distance: 2.0320303958361574
Total norm for 4 adversaries is: 43.4130551720908. distance: 2.0320303958361574
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2397, Accuracy: 9309/9900 (94.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4463/5066 (88.0971%), train_poison_data_count: 400
Global model norm: 43.4177998829937.
Norm before scaling: 43.422579215682106. Distance: 2.291570753922548
Total norm for 4 adversaries is: 43.422579215682106. distance: 2.291570753922548
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2114, Accuracy: 9375/9900 (94.6970%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3368/3797 (88.7016%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3455/3797 (90.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9328, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3375/3861 (87.4126%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3456/3861 (89.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9279, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4141/4707 (87.9754%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4270/4707 (90.7160%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0014, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4026/4518 (89.1102%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4157/4518 (92.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0378, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3561/4013 (88.7366%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3695/4013 (92.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9719, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4576/5167 (88.5620%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4696/5167 (90.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1212, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3477/3969 (87.6039%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3623/3969 (91.2824%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9508, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3952/4441 (88.9890%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4089/4441 (92.0739%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1164, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4011/4558 (87.9991%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4061/4558 (89.0961%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0083, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3927/4465 (87.9507%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4160/4465 (93.1691%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8291, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3173/3638 (87.2183%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3350/3638 (92.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8325, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4032/4538 (88.8497%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4170/4538 (91.8907%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8943, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5028/5740 (87.5958%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5170/5740 (90.0697%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0870, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3335/3837 (86.9169%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3477/3837 (90.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8451, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3862/4361 (88.5577%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3694/4361 (84.7053%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0852, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4182/4793 (87.2522%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4317/4793 (90.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0205, Accuracy: 5467/10000 (54.6700%)
time spent on training: 237.11018633842468
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.5017, Accuracy: 6429/10000 (64.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 9.2752, Accuracy: 144/9900 (1.4545%)
Done in 265.2503352165222 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4380/4885 (89.6622%), train_poison_data_count: 385
Global model norm: 43.45032550088448.
Norm before scaling: 43.44804419010495. Distance: 2.1123032201725715
Total norm for 4 adversaries is: 43.44804419010495. distance: 2.1123032201725715
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2593, Accuracy: 9213/9900 (93.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4727/5305 (89.1046%), train_poison_data_count: 415
Global model norm: 43.45032550088448.
Norm before scaling: 43.44803435660956. Distance: 2.1974383612657946
Total norm for 4 adversaries is: 43.44803435660956. distance: 2.1974383612657946
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1542, Accuracy: 9509/9900 (96.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 43.45032550088448.
Norm before scaling: 43.446349986488364. Distance: 2.0266554294241184
Total norm for 4 adversaries is: 43.446349986488364. distance: 2.0266554294241184
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1740, Accuracy: 9478/9900 (95.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4456/5066 (87.9589%), train_poison_data_count: 400
Global model norm: 43.45032550088448.
Norm before scaling: 43.45310112144256. Distance: 2.2558673016297424
Total norm for 4 adversaries is: 43.45310112144256. distance: 2.2558673016297424
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2992, Accuracy: 9146/9900 (92.3838%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4103/4767 (86.0709%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4254/4767 (89.2385%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0921, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3970/4441 (89.3943%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4124/4441 (92.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9789, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4075/4356 (93.5491%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4074/4356 (93.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0632, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5574/6391 (87.2164%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5679/6391 (88.8593%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1457, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3700/4184 (88.4321%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3757/4184 (89.7945%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9195, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3919/4346 (90.1749%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4038/4346 (92.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8147, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4362/5037 (86.5992%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4570/5037 (90.7286%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9842, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4076/4634 (87.9586%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4240/4634 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8495, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4408/4934 (89.3393%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4335/4934 (87.8597%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1607, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4802/5424 (88.5324%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4933/5424 (90.9476%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1047, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3353/3781 (88.6802%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3275/3781 (86.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0956, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3389/3861 (87.7752%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3477/3861 (90.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9282, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4490/5055 (88.8229%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4656/5055 (92.1068%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8288, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3941/4433 (88.9014%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4044/4433 (91.2249%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8757, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4575/5167 (88.5427%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4707/5167 (91.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0545, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3198/3590 (89.0808%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3187/3590 (88.7744%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0164, Accuracy: 5422/10000 (54.2200%)
time spent on training: 236.15528297424316
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.5763, Accuracy: 6267/10000 (62.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 6.9997, Accuracy: 735/9900 (7.4242%)
Done in 260.2401053905487 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 43.47570262514454.
Norm before scaling: 43.47546396298578. Distance: 2.1432262125531802
Total norm for 4 adversaries is: 43.47546396298578. distance: 2.1432262125531802
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2583, Accuracy: 9243/9900 (93.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4741/5305 (89.3685%), train_poison_data_count: 415
Global model norm: 43.47570262514454.
Norm before scaling: 43.473359467591614. Distance: 2.1581890951537757
Total norm for 4 adversaries is: 43.473359467591614. distance: 2.1581890951537757
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3360, Accuracy: 9072/9900 (91.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 43.47570262514454.
Norm before scaling: 43.474008095444944. Distance: 2.0806293742121573
Total norm for 4 adversaries is: 43.474008095444944. distance: 2.0806293742121573
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1971, Accuracy: 9392/9900 (94.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4482/5066 (88.4722%), train_poison_data_count: 400
Global model norm: 43.47570262514454.
Norm before scaling: 43.48044892220597. Distance: 2.2836273556304114
Total norm for 4 adversaries is: 43.48044892220597. distance: 2.2836273556304114
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1861, Accuracy: 9428/9900 (95.2323%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3817/4368 (87.3855%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3920/4368 (89.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0079, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3332/3828 (87.0428%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3486/3828 (91.0658%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7992, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4172/4356 (95.7759%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3863/4356 (88.6823%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1327, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3373/3861 (87.3608%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3470/3861 (89.8731%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9202, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3051/3472 (87.8744%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3176/3472 (91.4747%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0606, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4029/4538 (88.7836%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4208/4538 (92.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8383, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4728/5392 (87.6855%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4818/5392 (89.3546%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9166, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3774/4295 (87.8696%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3656/4295 (85.1222%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0388, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3725/4235 (87.9575%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3812/4235 (90.0118%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8474, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3995/4456 (89.6544%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4066/4456 (91.2478%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9949, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4601/5265 (87.3884%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4657/5265 (88.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9945, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3964/4441 (89.2592%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4088/4441 (92.0513%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1404, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3616/4013 (90.1072%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3705/4013 (92.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7836, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3923/4465 (87.8611%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4115/4465 (92.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8028, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5547/6263 (88.5678%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5709/6263 (91.1544%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8246, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4376/4986 (87.7657%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4504/4986 (90.3329%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8912, Accuracy: 5610/10000 (56.1000%)
time spent on training: 234.26565146446228
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5925925925925926.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Misclassification from 11 to 2 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.5612, Accuracy: 6304/10000 (63.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 7.0292, Accuracy: 639/9900 (6.4545%)
Done in 258.51508831977844 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4370/4885 (89.4575%), train_poison_data_count: 385
Global model norm: 43.50898597245818.
Norm before scaling: 43.50948537253472. Distance: 2.1241635190876322
Total norm for 4 adversaries is: 43.50948537253472. distance: 2.1241635190876322
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1903, Accuracy: 9407/9900 (95.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4745/5305 (89.4439%), train_poison_data_count: 415
Global model norm: 43.50898597245818.
Norm before scaling: 43.50949799774326. Distance: 2.2034811178479945
Total norm for 4 adversaries is: 43.50949799774326. distance: 2.2034811178479945
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1471, Accuracy: 9532/9900 (96.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 43.50898597245818.
Norm before scaling: 43.504457442689855. Distance: 2.0177904665380413
Total norm for 4 adversaries is: 43.504457442689855. distance: 2.0177904665380413
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2280, Accuracy: 9321/9900 (94.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4460/5066 (88.0379%), train_poison_data_count: 400
Global model norm: 43.50898597245818.
Norm before scaling: 43.51246482017035. Distance: 2.272472897946071
Total norm for 4 adversaries is: 43.51246482017035. distance: 2.272472897946071
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2400, Accuracy: 9287/9900 (93.8081%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3546/4158 (85.2814%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3675/4158 (88.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0628, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4534/5167 (87.7492%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4712/5167 (91.1941%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0693, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3357/3828 (87.6959%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3491/3828 (91.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8275, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4124/4663 (88.4409%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4250/4663 (91.1430%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9610, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3940/4433 (88.8789%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4061/4433 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8896, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3682/4184 (88.0019%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3793/4184 (90.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8549, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4128/4716 (87.5318%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4219/4716 (89.4614%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0680, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3737/4223 (88.4916%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3856/4223 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9152, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4253/4679 (90.8955%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4183/4679 (89.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1086, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3212/3704 (86.7171%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3346/3704 (90.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8345, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3376/3837 (87.9854%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3539/3837 (92.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8926, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3396/3861 (87.9565%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3472/3861 (89.9249%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8891, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4845/5424 (89.3252%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4924/5424 (90.7817%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2278, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4037/4576 (88.2212%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4213/4576 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8292, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3553/4025 (88.2733%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3769/4025 (93.6398%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7809, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3372/3775 (89.3245%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3548/3775 (93.9868%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7928, Accuracy: 5810/10000 (58.1000%)
time spent on training: 231.19031620025635
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.5344, Accuracy: 6390/10000 (63.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 7.5954, Accuracy: 405/9900 (4.0909%)
Done in 255.26123356819153 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 43.53879544709953.
Norm before scaling: 43.536290256933206. Distance: 2.077037096290106
Total norm for 4 adversaries is: 43.536290256933206. distance: 2.077037096290106
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2464, Accuracy: 9294/9900 (93.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4736/5305 (89.2743%), train_poison_data_count: 415
Global model norm: 43.53879544709953.
Norm before scaling: 43.5371720666662. Distance: 2.2467323523219163
Total norm for 4 adversaries is: 43.5371720666662. distance: 2.2467323523219163
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.3786, Accuracy: 8951/9900 (90.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4217/4717 (89.4000%), train_poison_data_count: 370
Global model norm: 43.53879544709953.
Norm before scaling: 43.535890702923204. Distance: 2.0209356327971406
Total norm for 4 adversaries is: 43.535890702923204. distance: 2.0209356327971406
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2975, Accuracy: 9151/9900 (92.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4492/5066 (88.6696%), train_poison_data_count: 400
Global model norm: 43.53879544709953.
Norm before scaling: 43.54196633170406. Distance: 2.267958708506663
Total norm for 4 adversaries is: 43.54196633170406. distance: 2.267958708506663
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0935, Accuracy: 9641/9900 (97.3838%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4053/4576 (88.5708%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4220/4576 (92.2203%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8821, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3226/3672 (87.8540%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3367/3672 (91.6939%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9582, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4135/4618 (89.5409%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4125/4618 (89.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0009, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4064/4538 (89.5549%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4258/4538 (93.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8003, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4477/5025 (89.0945%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4614/5025 (91.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1126, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3170/3590 (88.3008%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3186/3590 (88.7465%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1787, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4124/4707 (87.6142%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4289/4707 (91.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1343, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4362/4918 (88.6946%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4421/4918 (89.8943%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9555, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3852/4336 (88.8376%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3967/4336 (91.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0005, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5314/5902 (90.0373%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5273/5902 (89.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0980, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3973/4441 (89.4618%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4100/4441 (92.3215%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0403, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4488/5232 (85.7798%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4693/5232 (89.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9232, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4266/4804 (88.8010%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4341/4804 (90.3622%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0087, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3522/3969 (88.7377%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3616/3969 (91.1061%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8606, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4787/5392 (88.7797%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4872/5392 (90.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0607, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3360/3828 (87.7743%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3495/3828 (91.3009%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9211, Accuracy: 5541/10000 (55.4100%)
time spent on training: 235.50205779075623
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.5090, Accuracy: 6398/10000 (63.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 7.4747, Accuracy: 392/9900 (3.9596%)
Done in 259.75531101226807 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4430/4885 (90.6858%), train_poison_data_count: 385
Global model norm: 43.56810681726514.
Norm before scaling: 43.5654702179662. Distance: 2.0616596706377557
Total norm for 4 adversaries is: 43.5654702179662. distance: 2.0616596706377557
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1303, Accuracy: 9555/9900 (96.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4718/5305 (88.9350%), train_poison_data_count: 415
Global model norm: 43.56810681726514.
Norm before scaling: 43.568595733391355. Distance: 2.2474787679481936
Total norm for 4 adversaries is: 43.568595733391355. distance: 2.2474787679481936
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2152, Accuracy: 9361/9900 (94.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4227/4717 (89.6120%), train_poison_data_count: 370
Global model norm: 43.56810681726514.
Norm before scaling: 43.5611311096795. Distance: 1.992711914452783
Total norm for 4 adversaries is: 43.5611311096795. distance: 1.992711914452783
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2909, Accuracy: 9191/9900 (92.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4482/5066 (88.4722%), train_poison_data_count: 400
Global model norm: 43.56810681726514.
Norm before scaling: 43.56885209696114. Distance: 2.2617376191664853
Total norm for 4 adversaries is: 43.56885209696114. distance: 2.2617376191664853
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1163, Accuracy: 9581/9900 (96.7778%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4503/5232 (86.0665%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4616/5232 (88.2263%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0354, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4302/4956 (86.8039%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4427/4956 (89.3261%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2445, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4417/5063 (87.2408%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4494/5063 (88.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0091, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3591/4025 (89.2174%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3751/4025 (93.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8912, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3988/4441 (89.7996%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4076/4441 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9627, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3987/4625 (86.2054%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4024/4625 (87.0054%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1482, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4935/5591 (88.2669%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4960/5591 (88.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1234, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5013/5582 (89.8065%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5086/5582 (91.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0138, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5310/5902 (89.9695%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5313/5902 (90.0203%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1062, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4050/4538 (89.2464%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4221/4538 (93.0145%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8501, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4437/5025 (88.2985%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4611/5025 (91.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0463, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3728/4223 (88.2785%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3883/4223 (91.9489%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8169, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3928/4361 (90.0711%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3885/4361 (89.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0364, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4133/4354 (94.9242%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3876/4354 (89.0216%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1774, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3218/3672 (87.6362%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3329/3672 (90.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9125, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4032/4356 (92.5620%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3979/4356 (91.3453%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1896, Accuracy: 5133/10000 (51.3300%)
time spent on training: 236.7206244468689
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.5725, Accuracy: 6307/10000 (63.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 7.4455, Accuracy: 378/9900 (3.8182%)
Done in 260.66515374183655 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4376/4885 (89.5803%), train_poison_data_count: 385
Global model norm: 43.599522187300835.
Norm before scaling: 43.59894822278185. Distance: 2.1242712678692026
Total norm for 4 adversaries is: 43.59894822278185. distance: 2.1242712678692026
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1291, Accuracy: 9574/9900 (96.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 43.599522187300835.
Norm before scaling: 43.596825888349514. Distance: 2.1727286657660465
Total norm for 4 adversaries is: 43.596825888349514. distance: 2.1727286657660465
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1899, Accuracy: 9459/9900 (95.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 43.599522187300835.
Norm before scaling: 43.59600968605814. Distance: 2.0240428122263365
Total norm for 4 adversaries is: 43.59600968605814. distance: 2.0240428122263365
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.3433, Accuracy: 9117/9900 (92.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4455/5066 (87.9392%), train_poison_data_count: 400
Global model norm: 43.599522187300835.
Norm before scaling: 43.60394566032342. Distance: 2.3264807713015467
Total norm for 4 adversaries is: 43.60394566032342. distance: 2.3264807713015467
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1653, Accuracy: 9502/9900 (95.9798%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3385/3828 (88.4274%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3520/3828 (91.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8684, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3769/4235 (88.9965%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3777/4235 (89.1854%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9980, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3240/3704 (87.4730%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3326/3704 (89.7948%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9229, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3601/4046 (89.0015%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3728/4046 (92.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8326, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4350/4928 (88.2711%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4475/4928 (90.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7960, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5035/5740 (87.7178%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5172/5740 (90.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0631, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4413/5083 (86.8188%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4556/5083 (89.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9101, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4051/4576 (88.5271%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4138/4576 (90.4283%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9669, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4093/4647 (88.0783%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4238/4647 (91.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8424, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4828/5424 (89.0118%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4937/5424 (91.0214%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1329, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3892/4503 (86.4313%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4034/4503 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9599, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5567/6391 (87.1069%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5655/6391 (88.4838%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0422, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3929/4511 (87.0982%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4092/4511 (90.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9493, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4023/4456 (90.2828%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4107/4456 (92.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0173, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4400/4804 (91.5903%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4270/4804 (88.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1514, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3336/3804 (87.6972%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3495/3804 (91.8770%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9321, Accuracy: 5593/10000 (55.9300%)
time spent on training: 236.39441919326782
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.5804, Accuracy: 6288/10000 (62.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 7.6485, Accuracy: 353/9900 (3.5657%)
Done in 260.4493396282196 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 43.644178661703414.
Norm before scaling: 43.64269206078493. Distance: 2.1093078602596225
Total norm for 4 adversaries is: 43.64269206078493. distance: 2.1093078602596225
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1771, Accuracy: 9444/9900 (95.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4758/5305 (89.6890%), train_poison_data_count: 415
Global model norm: 43.644178661703414.
Norm before scaling: 43.64237459570185. Distance: 2.2076263975632884
Total norm for 4 adversaries is: 43.64237459570185. distance: 2.2076263975632884
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1648, Accuracy: 9468/9900 (95.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 43.644178661703414.
Norm before scaling: 43.63875085485233. Distance: 2.0214498176016606
Total norm for 4 adversaries is: 43.63875085485233. distance: 2.0214498176016606
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1330, Accuracy: 9538/9900 (96.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4468/5066 (88.1958%), train_poison_data_count: 400
Global model norm: 43.644178661703414.
Norm before scaling: 43.64738943501876. Distance: 2.249803640486398
Total norm for 4 adversaries is: 43.64738943501876. distance: 2.249803640486398
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1578, Accuracy: 9515/9900 (96.1111%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4360/4928 (88.4740%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4468/4928 (90.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8856, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4398/5037 (87.3139%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4564/5037 (90.6095%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9328, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4831/5392 (89.5957%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4843/5392 (89.8182%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0418, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3948/4501 (87.7138%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4050/4501 (89.9800%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9833, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3308/3804 (86.9611%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3467/3804 (91.1409%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9899, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3365/3837 (87.6987%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3524/3837 (91.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9323, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4435/5063 (87.5963%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4233/5063 (83.6066%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.3065, Accuracy: 4862/10000 (48.6200%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4014/4481 (89.5782%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4044/4481 (90.2477%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9547, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4018/4518 (88.9332%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4126/4518 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9293, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3150/3638 (86.5860%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3306/3638 (90.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8064, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4132/4663 (88.6125%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4248/4663 (91.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9653, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3953/4625 (85.4703%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4029/4625 (87.1135%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1818, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4566/5197 (87.8584%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4685/5197 (90.1482%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1103, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4473/5083 (87.9992%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4565/5083 (89.8092%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1025, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3347/3828 (87.4347%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3538/3828 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8192, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3201/3704 (86.4201%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3318/3704 (89.5788%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9258, Accuracy: 5610/10000 (56.1000%)
time spent on training: 237.0584659576416
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.5320, Accuracy: 6372/10000 (63.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 8.0997, Accuracy: 268/9900 (2.7071%)
Done in 261.2827787399292 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 43.683124110247086.
Norm before scaling: 43.679506544742324. Distance: 2.125245024074522
Total norm for 4 adversaries is: 43.679506544742324. distance: 2.125245024074522
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2528, Accuracy: 9256/9900 (93.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 43.683124110247086.
Norm before scaling: 43.682924306604775. Distance: 2.204366131454552
Total norm for 4 adversaries is: 43.682924306604775. distance: 2.204366131454552
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1269, Accuracy: 9580/9900 (96.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 43.683124110247086.
Norm before scaling: 43.67864717170164. Distance: 2.0431210404594284
Total norm for 4 adversaries is: 43.67864717170164. distance: 2.0431210404594284
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2525, Accuracy: 9272/9900 (93.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4477/5066 (88.3735%), train_poison_data_count: 400
Global model norm: 43.683124110247086.
Norm before scaling: 43.68423069848833. Distance: 2.253020166929074
Total norm for 4 adversaries is: 43.68423069848833. distance: 2.253020166929074
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2021, Accuracy: 9388/9900 (94.8283%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3415/3861 (88.4486%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3514/3861 (91.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9533, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3732/4184 (89.1969%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3802/4184 (90.8700%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9445, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4392/5037 (87.1948%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4554/5037 (90.4110%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8004, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4547/5197 (87.4928%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4608/5197 (88.6665%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0564, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4398/5025 (87.5224%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4578/5025 (91.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9988, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4448/5116 (86.9429%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4543/5116 (88.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0711, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4031/4481 (89.9576%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4055/4481 (90.4932%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1053, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4078/4576 (89.1171%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4152/4576 (90.7343%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9376, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4559/5232 (87.1369%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4697/5232 (89.7745%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9323, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4146/4354 (95.2228%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4087/4354 (93.8677%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9588, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2911/3271 (88.9942%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0060, Accuracy: 2879/3271 (88.0159%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9786, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4804/5455 (88.0660%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4899/5455 (89.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0234, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3653/4126 (88.5361%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3816/4126 (92.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8061, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3328/3797 (87.6481%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3465/3797 (91.2563%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9856, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3236/3704 (87.3650%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3348/3704 (90.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8865, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4387/4934 (88.9137%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4349/4934 (88.1435%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0486, Accuracy: 5311/10000 (53.1100%)
time spent on training: 239.90972352027893
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.6902, Accuracy: 6129/10000 (61.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 7.8238, Accuracy: 310/9900 (3.1313%)
Done in 264.2292501926422 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 43.708582515872955.
Norm before scaling: 43.705247758600166. Distance: 2.048381338506254
Total norm for 4 adversaries is: 43.705247758600166. distance: 2.048381338506254
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2826, Accuracy: 9198/9900 (92.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4724/5305 (89.0481%), train_poison_data_count: 415
Global model norm: 43.708582515872955.
Norm before scaling: 43.70921508559079. Distance: 2.2483294961423863
Total norm for 4 adversaries is: 43.70921508559079. distance: 2.2483294961423863
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2310, Accuracy: 9358/9900 (94.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4225/4717 (89.5696%), train_poison_data_count: 370
Global model norm: 43.708582515872955.
Norm before scaling: 43.70272138488989. Distance: 2.067261834224551
Total norm for 4 adversaries is: 43.70272138488989. distance: 2.067261834224551
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2175, Accuracy: 9339/9900 (94.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4470/5066 (88.2353%), train_poison_data_count: 400
Global model norm: 43.708582515872955.
Norm before scaling: 43.70767483913723. Distance: 2.255815830883854
Total norm for 4 adversaries is: 43.70767483913723. distance: 2.255815830883854
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2365, Accuracy: 9284/9900 (93.7778%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4092/4618 (88.6098%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4127/4618 (89.3677%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9645, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3905/4625 (84.4324%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4023/4625 (86.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2452, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5005/5740 (87.1951%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5099/5740 (88.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2181, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3859/4416 (87.3868%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3996/4416 (90.4891%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9758, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3688/4126 (89.3844%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3806/4126 (92.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8415, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3128/3616 (86.5044%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3314/3616 (91.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8970, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3524/4158 (84.7523%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3682/4158 (88.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8774, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3909/4346 (89.9448%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4028/4346 (92.6829%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9274, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4193/4874 (86.0279%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4282/4874 (87.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2183, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4644/5265 (88.2051%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4701/5265 (89.2877%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9830, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3587/4025 (89.1180%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3736/4025 (92.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8134, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4095/4651 (88.0456%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4217/4651 (90.6687%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9310, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3333/3837 (86.8647%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3487/3837 (90.8783%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9819, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3143/3638 (86.3936%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3303/3638 (90.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8214, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3101/3472 (89.3145%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3200/3472 (92.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0328, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4025/4456 (90.3276%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4115/4456 (92.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8890, Accuracy: 5673/10000 (56.7300%)
time spent on training: 257.8835575580597
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.6919, Accuracy: 6115/10000 (61.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 7.7578, Accuracy: 329/9900 (3.3232%)
Done in 286.32405400276184 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4347/4885 (88.9867%), train_poison_data_count: 385
Global model norm: 43.743367242753216.
Norm before scaling: 43.742683540007576. Distance: 2.146595779318691
Total norm for 4 adversaries is: 43.742683540007576. distance: 2.146595779318691
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1483, Accuracy: 9543/9900 (96.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 43.743367242753216.
Norm before scaling: 43.73874157595801. Distance: 2.1657945883048257
Total norm for 4 adversaries is: 43.73874157595801. distance: 2.1657945883048257
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1922, Accuracy: 9417/9900 (95.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4222/4717 (89.5060%), train_poison_data_count: 370
Global model norm: 43.743367242753216.
Norm before scaling: 43.73799919111741. Distance: 2.0416349940535627
Total norm for 4 adversaries is: 43.73799919111741. distance: 2.0416349940535627
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2219, Accuracy: 9337/9900 (94.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4477/5066 (88.3735%), train_poison_data_count: 400
Global model norm: 43.743367242753216.
Norm before scaling: 43.74603497657674. Distance: 2.301660754974014
Total norm for 4 adversaries is: 43.74603497657674. distance: 2.301660754974014
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2381, Accuracy: 9297/9900 (93.9091%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4829/5424 (89.0302%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4933/5424 (90.9476%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0479, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4390/4986 (88.0465%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4512/4986 (90.4934%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8794, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4581/5167 (88.6588%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4709/5167 (91.1361%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1667, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4119/4716 (87.3410%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4231/4716 (89.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0389, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3823/4368 (87.5229%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3889/4368 (89.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0150, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4022/4356 (92.3324%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3889/4356 (89.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1477, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4417/4804 (91.9442%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4394/4804 (91.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9790, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4058/4481 (90.5601%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4046/4481 (90.2923%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0244, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3568/4025 (88.6460%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3717/4025 (92.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9092, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4426/5017 (88.2201%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4573/5017 (91.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9747, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3169/3616 (87.6383%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3328/3616 (92.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8092, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3674/4184 (87.8107%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3802/4184 (90.8700%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8439, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4461/5195 (85.8710%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4613/5195 (88.7969%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9812, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3946/4361 (90.4838%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4026/4361 (92.3183%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0052, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3383/3756 (90.0692%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3509/3756 (93.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8871, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4943/5591 (88.4099%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4929/5591 (88.1595%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0562, Accuracy: 5422/10000 (54.2200%)
time spent on training: 256.2331442832947
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.6782, Accuracy: 6107/10000 (61.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 7.9806, Accuracy: 298/9900 (3.0101%)
Done in 280.4005732536316 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 43.7711458384152.
Norm before scaling: 43.76625256154849. Distance: 2.081553449074162
Total norm for 4 adversaries is: 43.76625256154849. distance: 2.081553449074162
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.4124, Accuracy: 8869/9900 (89.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4736/5305 (89.2743%), train_poison_data_count: 415
Global model norm: 43.7711458384152.
Norm before scaling: 43.76734031358314. Distance: 2.2268230085061
Total norm for 4 adversaries is: 43.76734031358314. distance: 2.2268230085061
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2379, Accuracy: 9310/9900 (94.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4221/4717 (89.4848%), train_poison_data_count: 370
Global model norm: 43.7711458384152.
Norm before scaling: 43.76682014835482. Distance: 2.0528344911212426
Total norm for 4 adversaries is: 43.76682014835482. distance: 2.0528344911212426
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1361, Accuracy: 9545/9900 (96.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4481/5066 (88.4524%), train_poison_data_count: 400
Global model norm: 43.7711458384152.
Norm before scaling: 43.77234920229322. Distance: 2.2567936799646136
Total norm for 4 adversaries is: 43.77234920229322. distance: 2.2567936799646136
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2436, Accuracy: 9305/9900 (93.9899%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3637/4175 (87.1138%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3784/4175 (90.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0485, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4830/5455 (88.5426%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4926/5455 (90.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0055, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3205/3704 (86.5281%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3371/3704 (91.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8443, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4349/4989 (87.1718%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4419/4989 (88.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9151, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4302/4928 (87.2971%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4405/4928 (89.3872%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9979, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3334/3804 (87.6446%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3454/3804 (90.7992%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0048, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3838/4336 (88.5148%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3958/4336 (91.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9230, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3600/4046 (88.9768%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3652/4046 (90.2620%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9582, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4211/4793 (87.8573%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4336/4793 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0018, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3354/3756 (89.2971%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3474/3756 (92.4920%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0305, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5714/6391 (89.4070%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5751/6391 (89.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0703, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3210/3672 (87.4183%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3333/3672 (90.7680%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8821, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4019/4558 (88.1746%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4138/4558 (90.7854%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0055, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4063/4576 (88.7893%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4145/4576 (90.5813%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9210, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3997/4456 (89.6993%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4133/4456 (92.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8912, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4109/4356 (94.3297%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3942/4356 (90.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9985, Accuracy: 5447/10000 (54.4700%)
time spent on training: 233.8370623588562
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.6913, Accuracy: 6108/10000 (61.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 8.2776, Accuracy: 229/9900 (2.3131%)
Done in 257.9526753425598 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 43.80093435745335.
Norm before scaling: 43.79827136107942. Distance: 2.129465572131723
Total norm for 4 adversaries is: 43.79827136107942. distance: 2.129465572131723
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2177, Accuracy: 9365/9900 (94.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4741/5305 (89.3685%), train_poison_data_count: 415
Global model norm: 43.80093435745335.
Norm before scaling: 43.796773267363115. Distance: 2.1939821386731695
Total norm for 4 adversaries is: 43.796773267363115. distance: 2.1939821386731695
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2239, Accuracy: 9353/9900 (94.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4194/4717 (88.9124%), train_poison_data_count: 370
Global model norm: 43.80093435745335.
Norm before scaling: 43.79624927086009. Distance: 2.1269267827584213
Total norm for 4 adversaries is: 43.79624927086009. distance: 2.1269267827584213
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1386, Accuracy: 9537/9900 (96.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4500/5066 (88.8275%), train_poison_data_count: 400
Global model norm: 43.80093435745335.
Norm before scaling: 43.80231247462855. Distance: 2.242996016881079
Total norm for 4 adversaries is: 43.80231247462855. distance: 2.242996016881079
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1842, Accuracy: 9421/9900 (95.1616%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4452/5116 (87.0211%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4534/5116 (88.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1234, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5009/5582 (89.7349%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5139/5582 (92.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0950, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4294/4928 (87.1347%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4443/4928 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9805, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3696/4126 (89.5783%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3820/4126 (92.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8192, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3533/4158 (84.9687%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3671/4158 (88.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9087, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4551/5063 (89.8874%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4475/5063 (88.3863%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1333, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5386/6124 (87.9491%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5461/6124 (89.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9980, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4186/4354 (96.1415%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4081/4354 (93.7299%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1411, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4452/5025 (88.5970%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4586/5025 (91.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0915, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4317/4679 (92.2633%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4230/4679 (90.4039%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0518, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4198/4793 (87.5861%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4355/4793 (90.8617%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8843, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4046/4518 (89.5529%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4159/4518 (92.0540%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8814, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4561/5167 (88.2717%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4668/5167 (90.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1052, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3950/4433 (89.1044%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4057/4433 (91.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7908, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3990/4503 (88.6076%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4052/4503 (89.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0643, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4161/4707 (88.4003%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4270/4707 (90.7160%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9073, Accuracy: 5652/10000 (56.5200%)
time spent on training: 238.41328310966492
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8212, Accuracy: 5966/10000 (59.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 8.5856, Accuracy: 210/9900 (2.1212%)
Done in 262.4795892238617 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 43.82559456821792.
Norm before scaling: 43.8259176694603. Distance: 2.180181741225756
Total norm for 4 adversaries is: 43.8259176694603. distance: 2.180181741225756
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2435, Accuracy: 9297/9900 (93.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4735/5305 (89.2554%), train_poison_data_count: 415
Global model norm: 43.82559456821792.
Norm before scaling: 43.82172134591189. Distance: 2.2262013995837817
Total norm for 4 adversaries is: 43.82172134591189. distance: 2.2262013995837817
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2552, Accuracy: 9246/9900 (93.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4226/4717 (89.5908%), train_poison_data_count: 370
Global model norm: 43.82559456821792.
Norm before scaling: 43.82286621748542. Distance: 2.099214057079503
Total norm for 4 adversaries is: 43.82286621748542. distance: 2.099214057079503
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2250, Accuracy: 9299/9900 (93.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 43.82559456821792.
Norm before scaling: 43.82476730676602. Distance: 2.2694635955654103
Total norm for 4 adversaries is: 43.82476730676602. distance: 2.2694635955654103
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2330, Accuracy: 9314/9900 (94.0808%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3226/3704 (87.0950%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3360/3704 (90.7127%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8946, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4676/5392 (86.7211%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4816/5392 (89.3175%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1035, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3914/4362 (89.7295%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4059/4362 (93.0536%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8963, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4032/4538 (88.8497%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4189/4538 (92.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8578, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3651/4184 (87.2610%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3743/4184 (89.4598%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8500, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3335/3756 (88.7913%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3453/3756 (91.9329%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9401, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4309/4679 (92.0923%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4298/4679 (91.8572%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9758, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3068/3472 (88.3641%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3164/3472 (91.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0533, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5658/6391 (88.5307%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5728/6391 (89.6260%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0816, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4593/5265 (87.2365%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4533/5265 (86.0969%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1395, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5255/5902 (89.0376%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5280/5902 (89.4612%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0656, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5345/6124 (87.2796%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5457/6124 (89.1084%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0174, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4460/5083 (87.7435%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4545/5083 (89.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0116, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3946/4465 (88.3763%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4099/4465 (91.8029%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8664, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3356/3804 (88.2229%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3435/3804 (90.2997%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9394, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4296/4918 (87.3526%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4421/4918 (89.8943%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0613, Accuracy: 5331/10000 (53.3100%)
time spent on training: 238.02770686149597
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8013, Accuracy: 6022/10000 (60.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 8.6764, Accuracy: 223/9900 (2.2525%)
Done in 262.39300537109375 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4392/4885 (89.9079%), train_poison_data_count: 385
Global model norm: 43.863748612981226.
Norm before scaling: 43.86230702481417. Distance: 2.1479997778524784
Total norm for 4 adversaries is: 43.86230702481417. distance: 2.1479997778524784
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.4697, Accuracy: 8821/9900 (89.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4727/5305 (89.1046%), train_poison_data_count: 415
Global model norm: 43.863748612981226.
Norm before scaling: 43.8626034169841. Distance: 2.251445623748883
Total norm for 4 adversaries is: 43.8626034169841. distance: 2.251445623748883
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2860, Accuracy: 9179/9900 (92.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4232/4717 (89.7180%), train_poison_data_count: 370
Global model norm: 43.863748612981226.
Norm before scaling: 43.86283858117755. Distance: 2.054625999777673
Total norm for 4 adversaries is: 43.86283858117755. distance: 2.054625999777673
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1622, Accuracy: 9501/9900 (95.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4487/5066 (88.5709%), train_poison_data_count: 400
Global model norm: 43.863748612981226.
Norm before scaling: 43.86930162425657. Distance: 2.294472404455353
Total norm for 4 adversaries is: 43.86930162425657. distance: 2.294472404455353
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2389, Accuracy: 9282/9900 (93.7576%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4059/4538 (89.4447%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4207/4538 (92.7060%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8470, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4246/4989 (85.1072%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4466/4989 (89.5169%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8613, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4178/4793 (87.1688%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4325/4793 (90.2358%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0066, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3485/4158 (83.8143%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3637/4158 (87.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9287, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3409/3861 (88.2932%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3480/3861 (90.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9912, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4541/5232 (86.7928%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4651/5232 (88.8953%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1885, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4169/4663 (89.4060%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4332/4663 (92.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9847, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4642/5197 (89.3208%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4663/5197 (89.7248%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9843, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4593/5167 (88.8910%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4684/5167 (90.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0560, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3869/4416 (87.6132%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3984/4416 (90.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8282, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4240/4354 (97.3817%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4017/4354 (92.2600%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1179, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4899/5455 (89.8075%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4848/5455 (88.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0982, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4004/4456 (89.8564%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4114/4456 (92.3250%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9184, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2882/3271 (88.1076%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2918/3271 (89.2082%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9726, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2936/3297 (89.0507%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3028/3297 (91.8411%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8043, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4987/5591 (89.1969%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5000/5591 (89.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0997, Accuracy: 5343/10000 (53.4300%)
time spent on training: 235.57189178466797
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7959, Accuracy: 5992/10000 (59.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 8.5362, Accuracy: 265/9900 (2.6768%)
Done in 259.75383496284485 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 43.88937342466141.
Norm before scaling: 43.88564073692698. Distance: 2.140875585883252
Total norm for 4 adversaries is: 43.88564073692698. distance: 2.140875585883252
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1211, Accuracy: 9591/9900 (96.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 43.88937342466141.
Norm before scaling: 43.88862802505764. Distance: 2.265701397890255
Total norm for 4 adversaries is: 43.88862802505764. distance: 2.265701397890255
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.3668, Accuracy: 9037/9900 (91.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4220/4717 (89.4636%), train_poison_data_count: 370
Global model norm: 43.88937342466141.
Norm before scaling: 43.88549609584156. Distance: 2.107830471134703
Total norm for 4 adversaries is: 43.88549609584156. distance: 2.107830471134703
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1985, Accuracy: 9412/9900 (95.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4467/5066 (88.1761%), train_poison_data_count: 400
Global model norm: 43.88937342466141.
Norm before scaling: 43.894343358868575. Distance: 2.3355342044796066
Total norm for 4 adversaries is: 43.894343358868575. distance: 2.3355342044796066
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.2723, Accuracy: 9226/9900 (93.1919%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4555/5167 (88.1556%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4686/5167 (90.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1304, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3372/3775 (89.3245%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3498/3775 (92.6623%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9843, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4469/5195 (86.0250%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4654/5195 (89.5861%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0639, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3620/4126 (87.7363%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3811/4126 (92.3655%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8207, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3457/3911 (88.3917%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3337/3911 (85.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.3472, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3945/4433 (88.9917%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4044/4433 (91.2249%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8727, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2838/3271 (86.7625%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0061, Accuracy: 2889/3271 (88.3216%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9613, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3181/3590 (88.6072%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3252/3590 (90.5850%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0244, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4284/4918 (87.1086%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4501/4918 (91.5209%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0364, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4391/4986 (88.0666%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4496/4986 (90.1725%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8774, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3129/3616 (86.5321%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3294/3616 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8497, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3817/4295 (88.8708%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3891/4295 (90.5937%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9648, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4126/4356 (94.7199%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4078/4356 (93.6180%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8705, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4161/4793 (86.8141%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4333/4793 (90.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9401, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3871/4315 (89.7103%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3989/4315 (92.4450%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9317, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4363/4804 (90.8201%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4446/4804 (92.5479%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0102, Accuracy: 5565/10000 (55.6500%)
time spent on training: 233.91390919685364
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.6808510638297872.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7262, Accuracy: 6103/10000 (61.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 8.1665, Accuracy: 330/9900 (3.3333%)
Done in 262.36265540122986 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4407/4885 (90.2149%), train_poison_data_count: 385
Global model norm: 43.92101203127681.
Norm before scaling: 43.91812839765744. Distance: 2.1338955431455395
Total norm for 4 adversaries is: 43.91812839765744. distance: 2.1338955431455395
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1949, Accuracy: 9407/9900 (95.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 43.92101203127681.
Norm before scaling: 43.9162730441227. Distance: 2.230613476655866
Total norm for 4 adversaries is: 43.9162730441227. distance: 2.230613476655866
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1146, Accuracy: 9622/9900 (97.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 43.92101203127681.
Norm before scaling: 43.91797274554149. Distance: 2.0682959758490513
Total norm for 4 adversaries is: 43.91797274554149. distance: 2.0682959758490513
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1185, Accuracy: 9574/9900 (96.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4486/5066 (88.5511%), train_poison_data_count: 400
Global model norm: 43.92101203127681.
Norm before scaling: 43.922967235618884. Distance: 2.2916482635683897
Total norm for 4 adversaries is: 43.922967235618884. distance: 2.2916482635683897
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.2056, Accuracy: 9407/9900 (95.0202%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4017/4503 (89.2072%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4063/4503 (90.2287%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9771, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4301/4934 (87.1707%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4309/4934 (87.3328%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3446, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4387/4804 (91.3197%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4336/4804 (90.2581%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0965, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3958/4456 (88.8241%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4107/4456 (92.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8698, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4071/4651 (87.5296%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4231/4651 (90.9697%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0316, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3663/4184 (87.5478%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3750/4184 (89.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8811, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4246/4928 (86.1607%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4395/4928 (89.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9915, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3383/3775 (89.6159%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3526/3775 (93.4040%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0185, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4452/5083 (87.5861%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4508/5083 (88.6878%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0460, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4819/5455 (88.3410%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4863/5455 (89.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0674, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3160/3638 (86.8609%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3311/3638 (91.0115%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9478, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3497/3911 (89.4145%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3623/3911 (92.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9739, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3384/3837 (88.1939%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3548/3837 (92.4681%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8210, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3959/4501 (87.9582%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4039/4501 (89.7356%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0227, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4627/5197 (89.0321%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4736/5197 (91.1295%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9910, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3385/3861 (87.6716%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3469/3861 (89.8472%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8674, Accuracy: 5639/10000 (56.3900%)
time spent on training: 261.4842493534088
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
 max_rate for 1 = 0.5319148936170213.
Suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.7415, Accuracy: 6055/10000 (60.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 8.5921, Accuracy: 212/9900 (2.1414%)
Done in 289.87880754470825 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4392/4885 (89.9079%), train_poison_data_count: 385
Global model norm: 43.95742957947353.
Norm before scaling: 43.95628821269489. Distance: 2.134591391277226
Total norm for 4 adversaries is: 43.95628821269489. distance: 2.134591391277226
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2143, Accuracy: 9343/9900 (94.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4748/5305 (89.5005%), train_poison_data_count: 415
Global model norm: 43.95742957947353.
Norm before scaling: 43.95754482532336. Distance: 2.269922744679912
Total norm for 4 adversaries is: 43.95754482532336. distance: 2.269922744679912
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1424, Accuracy: 9571/9900 (96.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 43.95742957947353.
Norm before scaling: 43.95119196780248. Distance: 2.033605647482785
Total norm for 4 adversaries is: 43.95119196780248. distance: 2.033605647482785
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2059, Accuracy: 9349/9900 (94.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4490/5066 (88.6301%), train_poison_data_count: 400
Global model norm: 43.95742957947353.
Norm before scaling: 43.95717687064878. Distance: 2.2704815606681295
Total norm for 4 adversaries is: 43.95717687064878. distance: 2.2704815606681295
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2177, Accuracy: 9314/9900 (94.0808%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0062, Accuracy: 2858/3271 (87.3739%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2968/3271 (90.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8708, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3850/4511 (85.3469%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4009/4511 (88.8716%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1366, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3146/3638 (86.4761%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3313/3638 (91.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0049, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4984/5582 (89.2870%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5058/5582 (90.6127%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0194, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3980/4456 (89.3178%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4104/4456 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9759, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5283/5902 (89.5120%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5226/5902 (88.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0271, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3820/4416 (86.5036%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3985/4416 (90.2400%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9647, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4445/4934 (90.0892%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4456/4934 (90.3121%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2011, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4075/4596 (88.6641%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4280/4596 (93.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9550, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3384/3837 (88.1939%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3534/3837 (92.1032%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9221, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5695/6391 (89.1097%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5775/6391 (90.3614%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0325, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3811/4368 (87.2482%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3909/4368 (89.4918%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0488, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3373/3804 (88.6698%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3489/3804 (91.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8417, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5499/6263 (87.8014%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5611/6263 (89.5897%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1785, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4189/4793 (87.3983%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4358/4793 (90.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9988, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4837/5424 (89.1777%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4996/5424 (92.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1491, Accuracy: 5268/10000 (52.6800%)
time spent on training: 258.04289197921753
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5531914893617021.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.7108, Accuracy: 6132/10000 (61.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 8.4219, Accuracy: 254/9900 (2.5657%)
Done in 282.76907420158386 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 43.997737479560385.
Norm before scaling: 43.99352563561555. Distance: 2.1365682210674075
Total norm for 4 adversaries is: 43.99352563561555. distance: 2.1365682210674075
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3246, Accuracy: 9066/9900 (91.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 43.997737479560385.
Norm before scaling: 43.99206193930758. Distance: 2.1939775745563694
Total norm for 4 adversaries is: 43.99206193930758. distance: 2.1939775745563694
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2216, Accuracy: 9363/9900 (94.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4224/4717 (89.5484%), train_poison_data_count: 370
Global model norm: 43.997737479560385.
Norm before scaling: 43.991627676912145. Distance: 2.0764575664796583
Total norm for 4 adversaries is: 43.991627676912145. distance: 2.0764575664796583
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2075, Accuracy: 9364/9900 (94.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4493/5066 (88.6893%), train_poison_data_count: 400
Global model norm: 43.997737479560385.
Norm before scaling: 43.99684270454813. Distance: 2.2829436194684334
Total norm for 4 adversaries is: 43.99684270454813. distance: 2.2829436194684334
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3338, Accuracy: 9036/9900 (91.2727%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4479/5055 (88.6053%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4606/5055 (91.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9146, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3693/4184 (88.2648%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3812/4184 (91.1090%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9210, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3461/3861 (89.6400%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3508/3861 (90.8573%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8343, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4346/4804 (90.4663%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3880/4804 (80.7660%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3450, Accuracy: 4786/10000 (47.8600%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3088/3472 (88.9401%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3180/3472 (91.5899%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9366, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3483/3969 (87.7551%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3589/3969 (90.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9255, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4302/4989 (86.2297%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4429/4989 (88.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9430, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4984/5582 (89.2870%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5065/5582 (90.7381%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1690, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4218/4793 (88.0033%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4325/4793 (90.2358%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9778, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4105/4662 (88.0523%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4216/4662 (90.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0061, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4426/4934 (89.7041%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4392/4934 (89.0150%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1161, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4397/4986 (88.1869%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4494/4986 (90.1324%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9660, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3975/4433 (89.6684%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4054/4433 (91.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8343, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4112/4716 (87.1925%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4238/4716 (89.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9973, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4091/4596 (89.0122%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4260/4596 (92.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0337, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4234/4354 (97.2439%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3962/4354 (90.9968%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0547, Accuracy: 5396/10000 (53.9600%)
time spent on training: 235.81975531578064
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
 max_rate for 1 = 0.5106382978723404.
Suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5319148936170213.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.7805, Accuracy: 6047/10000 (60.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 8.5201, Accuracy: 200/9900 (2.0202%)
Done in 260.32797622680664 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4388/4885 (89.8260%), train_poison_data_count: 385
Global model norm: 44.038572570230265.
Norm before scaling: 44.03629124130531. Distance: 2.160711234404696
Total norm for 4 adversaries is: 44.03629124130531. distance: 2.160711234404696
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1336, Accuracy: 9598/9900 (96.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4698/5305 (88.5580%), train_poison_data_count: 415
Global model norm: 44.038572570230265.
Norm before scaling: 44.03606531955512. Distance: 2.2621792602810573
Total norm for 4 adversaries is: 44.03606531955512. distance: 2.2621792602810573
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1825, Accuracy: 9456/9900 (95.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 44.038572570230265.
Norm before scaling: 44.03229239362289. Distance: 2.0779336253223097
Total norm for 4 adversaries is: 44.03229239362289. distance: 2.0779336253223097
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2474, Accuracy: 9272/9900 (93.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 44.038572570230265.
Norm before scaling: 44.03869730534229. Distance: 2.284181879441285
Total norm for 4 adversaries is: 44.03869730534229. distance: 2.284181879441285
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.4893, Accuracy: 8741/9900 (88.2929%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4472/5116 (87.4120%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4578/5116 (89.4840%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9648, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4135/4662 (88.6958%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4258/4662 (91.3342%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9405, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5361/5902 (90.8336%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5373/5902 (91.0369%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0858, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4491/5063 (88.7024%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4568/5063 (90.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0994, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4209/4354 (96.6697%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3729/4354 (85.6454%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4945, Accuracy: 4852/10000 (48.5200%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4525/5195 (87.1030%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4529/5195 (87.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0212, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4113/4356 (94.4215%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3965/4356 (91.0239%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3517, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3819/4295 (88.9173%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3923/4295 (91.3388%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0113, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5581/6263 (89.1106%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5674/6263 (90.5956%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0722, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3936/4511 (87.2534%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4078/4511 (90.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9725, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4195/4663 (89.9635%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4328/4663 (92.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9238, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3872/4336 (89.2989%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3998/4336 (92.2048%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0203, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4223/4928 (85.6940%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4409/4928 (89.4683%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0142, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3622/4046 (89.5205%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3730/4046 (92.1898%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0104, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3209/3672 (87.3911%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3309/3672 (90.1144%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8927, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4054/4356 (93.0670%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4158/4356 (95.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8683, Accuracy: 5665/10000 (56.6500%)
time spent on training: 237.73170518875122
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8638, Accuracy: 5918/10000 (59.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 8.9480, Accuracy: 140/9900 (1.4141%)
Done in 262.42694187164307 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4385/4885 (89.7646%), train_poison_data_count: 385
Global model norm: 44.08038339437751.
Norm before scaling: 44.080537088379494. Distance: 2.1780068539248005
Total norm for 4 adversaries is: 44.080537088379494. distance: 2.1780068539248005
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0891, Accuracy: 9671/9900 (97.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4718/5305 (88.9350%), train_poison_data_count: 415
Global model norm: 44.08038339437751.
Norm before scaling: 44.07754342048085. Distance: 2.3146780942877956
Total norm for 4 adversaries is: 44.07754342048085. distance: 2.3146780942877956
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2177, Accuracy: 9363/9900 (94.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4199/4717 (89.0184%), train_poison_data_count: 370
Global model norm: 44.08038339437751.
Norm before scaling: 44.07681505054556. Distance: 2.1385241592466047
Total norm for 4 adversaries is: 44.07681505054556. distance: 2.1385241592466047
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1775, Accuracy: 9441/9900 (95.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4461/5066 (88.0576%), train_poison_data_count: 400
Global model norm: 44.08038339437751.
Norm before scaling: 44.083358870404545. Distance: 2.353013411633246
Total norm for 4 adversaries is: 44.083358870404545. distance: 2.353013411633246
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2039, Accuracy: 9389/9900 (94.8384%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4361/5037 (86.5793%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4606/5037 (91.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8642, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4083/4647 (87.8631%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4176/4647 (89.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0256, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4150/4663 (88.9985%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4286/4663 (91.9151%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9903, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3848/4336 (88.7454%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3970/4336 (91.5590%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9573, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3329/3756 (88.6315%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3484/3756 (92.7583%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0328, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4019/4625 (86.8973%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4115/4625 (88.9730%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1396, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3882/4362 (88.9959%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4043/4362 (92.6868%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9414, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4255/4874 (87.3000%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4358/4874 (89.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0948, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4104/4767 (86.0919%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4258/4767 (89.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0413, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3341/3775 (88.5033%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3532/3775 (93.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8305, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4138/4662 (88.7602%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4221/4662 (90.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0094, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5396/6124 (88.1123%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5494/6124 (89.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9558, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3898/4511 (86.4110%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4068/4511 (90.1796%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9006, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3563/3911 (91.1020%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3545/3911 (90.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8924, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4946/5591 (88.4636%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5011/5591 (89.6262%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1598, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3664/4126 (88.8027%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3774/4126 (91.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9476, Accuracy: 5511/10000 (55.1100%)
time spent on training: 235.18674039840698
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8644, Accuracy: 5930/10000 (59.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 8.8182, Accuracy: 161/9900 (1.6263%)
Done in 259.999240398407 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4376/4885 (89.5803%), train_poison_data_count: 385
Global model norm: 44.11824515621697.
Norm before scaling: 44.11408079087036. Distance: 2.1695058511381244
Total norm for 4 adversaries is: 44.11408079087036. distance: 2.1695058511381244
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1968, Accuracy: 9425/9900 (95.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4690/5305 (88.4072%), train_poison_data_count: 415
Global model norm: 44.11824515621697.
Norm before scaling: 44.117870241086834. Distance: 2.3179153749950467
Total norm for 4 adversaries is: 44.117870241086834. distance: 2.3179153749950467
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1893, Accuracy: 9429/9900 (95.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4192/4717 (88.8700%), train_poison_data_count: 370
Global model norm: 44.11824515621697.
Norm before scaling: 44.11300573969796. Distance: 2.152668950874831
Total norm for 4 adversaries is: 44.11300573969796. distance: 2.152668950874831
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0808, Accuracy: 9654/9900 (97.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4436/5066 (87.5642%), train_poison_data_count: 400
Global model norm: 44.11824515621697.
Norm before scaling: 44.120309207555565. Distance: 2.3312472714160157
Total norm for 4 adversaries is: 44.120309207555565. distance: 2.3312472714160157
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1874, Accuracy: 9396/9900 (94.9091%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4482/5025 (89.1940%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4579/5025 (91.1244%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1079, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4461/5116 (87.1970%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4562/5116 (89.1712%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0390, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4554/5167 (88.1362%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4709/5167 (91.1361%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9626, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3998/4558 (87.7139%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4035/4558 (88.5257%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9896, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4082/4651 (87.7661%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4227/4651 (90.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9616, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3858/4336 (88.9760%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3960/4336 (91.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9904, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4461/5055 (88.2493%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4612/5055 (91.2364%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9746, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3374/3775 (89.3775%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3566/3775 (94.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8781, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4685/5265 (88.9839%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4768/5265 (90.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0406, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3581/4025 (88.9689%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3720/4025 (92.4224%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9039, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4332/4989 (86.8310%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4453/4989 (89.2564%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9825, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4188/4793 (87.3774%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4294/4793 (89.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9281, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3341/3804 (87.8286%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3493/3804 (91.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8746, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3341/3797 (87.9905%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3409/3797 (89.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0510, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3955/4433 (89.2172%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4058/4433 (91.5407%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8843, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4129/4707 (87.7204%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4291/4707 (91.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7842, Accuracy: 5750/10000 (57.5000%)
time spent on training: 237.45582509040833
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5319148936170213.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8636, Accuracy: 5908/10000 (59.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 8.2432, Accuracy: 270/9900 (2.7273%)
Done in 262.76788330078125 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 44.147889335873124.
Norm before scaling: 44.14647085183452. Distance: 2.142329407602839
Total norm for 4 adversaries is: 44.14647085183452. distance: 2.142329407602839
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2150, Accuracy: 9369/9900 (94.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4725/5305 (89.0669%), train_poison_data_count: 415
Global model norm: 44.147889335873124.
Norm before scaling: 44.14154174932965. Distance: 2.225846131846276
Total norm for 4 adversaries is: 44.14154174932965. distance: 2.225846131846276
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1013, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4238/4717 (89.8452%), train_poison_data_count: 370
Global model norm: 44.147889335873124.
Norm before scaling: 44.142534527280915. Distance: 2.0384745133738624
Total norm for 4 adversaries is: 44.142534527280915. distance: 2.0384745133738624
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2821, Accuracy: 9203/9900 (92.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4487/5066 (88.5709%), train_poison_data_count: 400
Global model norm: 44.147889335873124.
Norm before scaling: 44.14796952171895. Distance: 2.2938809765416766
Total norm for 4 adversaries is: 44.14796952171895. distance: 2.2938809765416766
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1734, Accuracy: 9440/9900 (95.3535%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4796/5392 (88.9466%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4818/5392 (89.3546%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1345, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4152/4663 (89.0414%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4291/4663 (92.0223%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2154, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3311/3797 (87.2004%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3396/3797 (89.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9918, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5005/5582 (89.6632%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5086/5582 (91.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9798, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4522/5167 (87.5169%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4681/5167 (90.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1255, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3324/3781 (87.9133%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3324/3781 (87.9133%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0319, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3513/3969 (88.5110%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3630/3969 (91.4588%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9286, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3360/3837 (87.5684%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3493/3837 (91.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0165, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5376/5902 (91.0878%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5326/5902 (90.2406%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9672, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4761/5455 (87.2777%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4907/5455 (89.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0379, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4372/5037 (86.7977%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4482/5037 (88.9815%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9753, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4426/5017 (88.2201%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4540/5017 (90.4923%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0022, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4359/4986 (87.4248%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4464/4986 (89.5307%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9522, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4580/5197 (88.1278%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4621/5197 (88.9167%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1701, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3896/4361 (89.3373%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3756/4361 (86.1270%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2497, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5552/6263 (88.6476%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5721/6263 (91.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0312, Accuracy: 5481/10000 (54.8100%)
time spent on training: 242.16944408416748
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8600, Accuracy: 5900/10000 (59.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 8.5460, Accuracy: 188/9900 (1.8990%)
Done in 267.1382043361664 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 44.1801952059687.
Norm before scaling: 44.17465226058661. Distance: 2.1273856515781926
Total norm for 4 adversaries is: 44.17465226058661. distance: 2.1273856515781926
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1073, Accuracy: 9617/9900 (97.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4734/5305 (89.2366%), train_poison_data_count: 415
Global model norm: 44.1801952059687.
Norm before scaling: 44.17623425385602. Distance: 2.240371553566186
Total norm for 4 adversaries is: 44.17623425385602. distance: 2.240371553566186
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1077, Accuracy: 9617/9900 (97.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 44.1801952059687.
Norm before scaling: 44.17307711929858. Distance: 2.0618371765423236
Total norm for 4 adversaries is: 44.17307711929858. distance: 2.0618371765423236
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1296, Accuracy: 9548/9900 (96.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4493/5066 (88.6893%), train_poison_data_count: 400
Global model norm: 44.1801952059687.
Norm before scaling: 44.17711019781271. Distance: 2.266380236797564
Total norm for 4 adversaries is: 44.17711019781271. distance: 2.266380236797564
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2247, Accuracy: 9360/9900 (94.5455%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4462/5017 (88.9376%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4604/5017 (91.7680%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7683, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4271/4928 (86.6680%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4465/4928 (90.6047%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0869, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3717/4184 (88.8384%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3799/4184 (90.7983%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9608, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4172/4793 (87.0436%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4365/4793 (91.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9920, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5066/5740 (88.2578%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5161/5740 (89.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0934, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3365/3756 (89.5900%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3502/3756 (93.2375%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9718, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3764/4235 (88.8784%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3837/4235 (90.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9153, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3696/4223 (87.5207%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3866/4223 (91.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8493, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4466/5063 (88.2086%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4471/5063 (88.3073%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0813, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4361/4989 (87.4123%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4423/4989 (88.6550%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8666, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4316/4928 (87.5812%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4378/4928 (88.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0183, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5370/5902 (90.9861%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5286/5902 (89.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1254, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3992/4456 (89.5871%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4133/4456 (92.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8888, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5499/6124 (89.7943%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5583/6124 (91.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8944, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3369/3828 (88.0094%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3523/3828 (92.0324%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9187, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3176/3616 (87.8319%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3304/3616 (91.3717%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7647, Accuracy: 5884/10000 (58.8400%)
time spent on training: 239.8231976032257
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8389, Accuracy: 5998/10000 (59.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 8.4933, Accuracy: 217/9900 (2.1919%)
Done in 264.8388469219208 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 44.21408571910724.
Norm before scaling: 44.209306356859834. Distance: 2.0901556334887097
Total norm for 4 adversaries is: 44.209306356859834. distance: 2.0901556334887097
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1780, Accuracy: 9508/9900 (96.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4718/5305 (88.9350%), train_poison_data_count: 415
Global model norm: 44.21408571910724.
Norm before scaling: 44.20941956552147. Distance: 2.269308213848374
Total norm for 4 adversaries is: 44.20941956552147. distance: 2.269308213848374
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2157, Accuracy: 9339/9900 (94.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 44.21408571910724.
Norm before scaling: 44.20657407452256. Distance: 2.0442593001184086
Total norm for 4 adversaries is: 44.20657407452256. distance: 2.0442593001184086
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1377, Accuracy: 9557/9900 (96.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4486/5066 (88.5511%), train_poison_data_count: 400
Global model norm: 44.21408571910724.
Norm before scaling: 44.21502303198258. Distance: 2.2561075181433288
Total norm for 4 adversaries is: 44.21502303198258. distance: 2.2561075181433288
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2143, Accuracy: 9355/9900 (94.4949%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3688/4223 (87.3313%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3849/4223 (91.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9087, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3900/4362 (89.4085%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3969/4362 (90.9904%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9774, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5680/6391 (88.8750%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5722/6391 (89.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9885, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4124/4793 (86.0421%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4346/4793 (90.6739%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0600, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3358/3756 (89.4036%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3532/3756 (94.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9165, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4122/4618 (89.2594%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4122/4618 (89.2594%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1060, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3557/4025 (88.3727%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3703/4025 (92.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7793, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3162/3638 (86.9159%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3335/3638 (91.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8410, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3882/4315 (89.9652%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3976/4315 (92.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8313, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3844/4295 (89.4994%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3730/4295 (86.8452%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0135, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4351/4928 (88.2914%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4487/4928 (91.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8437, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4379/4986 (87.8259%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4521/4986 (90.6739%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8733, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3652/4126 (88.5119%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3756/4126 (91.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8079, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4387/4918 (89.2029%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4444/4918 (90.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1446, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4525/5195 (87.1030%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4564/5195 (87.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9609, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5059/5740 (88.1359%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5207/5740 (90.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0867, Accuracy: 5386/10000 (53.8600%)
time spent on training: 237.02869963645935
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7568, Accuracy: 6095/10000 (60.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 8.8421, Accuracy: 152/9900 (1.5354%)
Done in 261.82400727272034 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 44.24939171324491.
Norm before scaling: 44.2420626488173. Distance: 2.077429289274322
Total norm for 4 adversaries is: 44.2420626488173. distance: 2.077429289274322
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0862, Accuracy: 9669/9900 (97.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 44.24939171324491.
Norm before scaling: 44.24214404355097. Distance: 2.190662931149239
Total norm for 4 adversaries is: 44.24214404355097. distance: 2.190662931149239
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1932, Accuracy: 9420/9900 (95.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4249/4717 (90.0784%), train_poison_data_count: 370
Global model norm: 44.24939171324491.
Norm before scaling: 44.24141700392998. Distance: 2.0429240526375354
Total norm for 4 adversaries is: 44.24141700392998. distance: 2.0429240526375354
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.3006, Accuracy: 9182/9900 (92.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 44.24939171324491.
Norm before scaling: 44.248459266520655. Distance: 2.2651968715909505
Total norm for 4 adversaries is: 44.248459266520655. distance: 2.2651968715909505
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1504, Accuracy: 9520/9900 (96.1616%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2945/3297 (89.3236%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3038/3297 (92.1444%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7326, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3410/3828 (89.0805%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3518/3828 (91.9018%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9495, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4613/5063 (91.1120%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4450/5063 (87.8926%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0161, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3941/4501 (87.5583%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4025/4501 (89.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0054, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4207/4793 (87.7738%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4388/4793 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9385, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3742/4223 (88.6100%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3856/4223 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8943, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3398/3756 (90.4686%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3499/3756 (93.1576%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7772, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3191/3638 (87.7130%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3299/3638 (90.6817%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8475, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3197/3646 (87.6851%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3336/3646 (91.4975%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8843, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4294/4874 (88.1001%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4290/4874 (88.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0587, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5628/6263 (89.8611%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5721/6263 (91.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0799, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4385/5037 (87.0558%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4527/5037 (89.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9711, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3927/4362 (90.0275%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4017/4362 (92.0908%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8593, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4080/4356 (93.6639%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4130/4356 (94.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9191, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4456/5116 (87.0993%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4546/5116 (88.8585%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9069, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3914/4346 (90.0598%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4054/4346 (93.2812%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7723, Accuracy: 5903/10000 (59.0300%)
time spent on training: 234.41091322898865
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7320, Accuracy: 6135/10000 (61.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 8.6858, Accuracy: 214/9900 (2.1616%)
Done in 259.37819147109985 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 44.28233612817587.
Norm before scaling: 44.27628076166671. Distance: 2.1196269378266317
Total norm for 4 adversaries is: 44.27628076166671. distance: 2.1196269378266317
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2002, Accuracy: 9401/9900 (94.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4745/5305 (89.4439%), train_poison_data_count: 415
Global model norm: 44.28233612817587.
Norm before scaling: 44.27877303190478. Distance: 2.19444534714864
Total norm for 4 adversaries is: 44.27877303190478. distance: 2.19444534714864
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2187, Accuracy: 9339/9900 (94.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4261/4717 (90.3328%), train_poison_data_count: 370
Global model norm: 44.28233612817587.
Norm before scaling: 44.27474232129632. Distance: 1.9842254702481812
Total norm for 4 adversaries is: 44.27474232129632. distance: 1.9842254702481812
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2957, Accuracy: 9171/9900 (92.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4532/5066 (89.4591%), train_poison_data_count: 400
Global model norm: 44.28233612817587.
Norm before scaling: 44.27934921158578. Distance: 2.224460399217749
Total norm for 4 adversaries is: 44.27934921158578. distance: 2.224460399217749
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1921, Accuracy: 9390/9900 (94.8485%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4068/4518 (90.0398%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4143/4518 (91.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8884, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4094/4558 (89.8201%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4122/4558 (90.4344%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0766, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3377/3804 (88.7750%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3524/3804 (92.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9612, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3392/3775 (89.8543%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3540/3775 (93.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7537, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4493/5083 (88.3927%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4570/5083 (89.9075%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9557, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4410/4928 (89.4886%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4506/4928 (91.4367%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9051, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4497/5244 (85.7551%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4614/5244 (87.9863%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0504, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4358/4989 (87.3522%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4485/4989 (89.8978%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8913, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4431/4986 (88.8688%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4489/4986 (90.0321%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8523, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3675/4175 (88.0240%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3753/4175 (89.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9117, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4593/5232 (87.7867%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4661/5232 (89.0864%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0860, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4635/5063 (91.5465%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4622/5063 (91.2897%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1493, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4024/4441 (90.6102%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4125/4441 (92.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9833, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3226/3646 (88.4805%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3333/3646 (91.4152%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8186, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4598/5167 (88.9878%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4746/5167 (91.8521%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0757, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4062/4538 (89.5108%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4189/4538 (92.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8733, Accuracy: 5709/10000 (57.0900%)
time spent on training: 235.5496485233307
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7627, Accuracy: 6054/10000 (60.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 8.8028, Accuracy: 187/9900 (1.8889%)
Done in 260.1624279022217 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 44.31826533809875.
Norm before scaling: 44.31070110505898. Distance: 2.070858519904353
Total norm for 4 adversaries is: 44.31070110505898. distance: 2.070858519904353
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.2344, Accuracy: 9367/9900 (94.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 44.31826533809875.
Norm before scaling: 44.30944899801636. Distance: 2.152266651579667
Total norm for 4 adversaries is: 44.30944899801636. distance: 2.152266651579667
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1440, Accuracy: 9551/9900 (96.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4202/4717 (89.0820%), train_poison_data_count: 370
Global model norm: 44.31826533809875.
Norm before scaling: 44.31305783543449. Distance: 2.11612283323462
Total norm for 4 adversaries is: 44.31305783543449. distance: 2.11612283323462
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1843, Accuracy: 9462/9900 (95.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 44.31826533809875.
Norm before scaling: 44.31400958289038. Distance: 2.2092424236917516
Total norm for 4 adversaries is: 44.31400958289038. distance: 2.2092424236917516
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1205, Accuracy: 9600/9900 (96.9697%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4092/4356 (93.9394%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4034/4356 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0617, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4310/4928 (87.4594%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4405/4928 (89.3872%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0302, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4555/5037 (90.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9375, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4404/4804 (91.6736%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4451/4804 (92.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2220, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3426/3775 (90.7550%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3544/3775 (93.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7692, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4606/5167 (89.1426%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4710/5167 (91.1554%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1247, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3790/4235 (89.4923%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3911/4235 (92.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1113, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4354/4956 (87.8531%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4445/4956 (89.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9991, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5078/5740 (88.4669%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5265/5740 (91.7247%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9865, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4269/4679 (91.2374%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4361/4679 (93.2037%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9312, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3264/3704 (88.1210%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3404/3704 (91.9006%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8299, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3124/3472 (89.9770%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3182/3472 (91.6475%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9517, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4126/4651 (88.7121%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4247/4651 (91.3137%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9660, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4093/4634 (88.3254%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4214/4634 (90.9366%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8041, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5333/5902 (90.3592%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5331/5902 (90.3253%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0148, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3392/3837 (88.4024%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8635, Accuracy: 5704/10000 (57.0400%)
time spent on training: 236.37025427818298
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7228, Accuracy: 6090/10000 (60.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 8.3616, Accuracy: 312/9900 (3.1515%)
Done in 261.0791747570038 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 44.35450258332363.
Norm before scaling: 44.35094941336868. Distance: 2.104435654874387
Total norm for 4 adversaries is: 44.35094941336868. distance: 2.104435654874387
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2901, Accuracy: 9223/9900 (93.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 44.35450258332363.
Norm before scaling: 44.345480112919205. Distance: 2.180864788679359
Total norm for 4 adversaries is: 44.345480112919205. distance: 2.180864788679359
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1548, Accuracy: 9519/9900 (96.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 44.35450258332363.
Norm before scaling: 44.344299183967124. Distance: 2.02668413372209
Total norm for 4 adversaries is: 44.344299183967124. distance: 2.02668413372209
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2331, Accuracy: 9345/9900 (94.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4503/5066 (88.8867%), train_poison_data_count: 400
Global model norm: 44.35450258332363.
Norm before scaling: 44.3531856592624. Distance: 2.2926754089607346
Total norm for 4 adversaries is: 44.3531856592624. distance: 2.2926754089607346
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0857, Accuracy: 9684/9900 (97.8182%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3542/3969 (89.2416%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3638/3969 (91.6604%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9892, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4222/4707 (89.6962%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4319/4707 (91.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9040, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3466/3861 (89.7695%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3520/3861 (91.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7626, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4111/4596 (89.4473%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4250/4596 (92.4717%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0193, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4022/4503 (89.3182%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4093/4503 (90.8950%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9669, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4369/4928 (88.6567%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4485/4928 (91.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9183, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4442/5025 (88.3980%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4549/5025 (90.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9285, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4071/4576 (88.9642%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4216/4576 (92.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9356, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4333/4918 (88.1049%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4466/4918 (90.8093%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9691, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3925/4315 (90.9618%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3975/4315 (92.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9200, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3219/3590 (89.6657%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3287/3590 (91.5599%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9433, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3965/4456 (88.9811%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4107/4456 (92.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9155, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4215/4354 (96.8075%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3807/4354 (87.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2000, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3992/4501 (88.6914%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4066/4501 (90.3355%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8801, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3571/3911 (91.3066%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3597/3911 (91.9714%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8896, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4115/4558 (90.2808%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4176/4558 (91.6191%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9851, Accuracy: 5510/10000 (55.1000%)
time spent on training: 233.04254484176636
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7461, Accuracy: 6044/10000 (60.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 8.5251, Accuracy: 306/9900 (3.0909%)
Done in 257.5016441345215 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4454/4885 (91.1771%), train_poison_data_count: 385
Global model norm: 44.385270598406294.
Norm before scaling: 44.378745165461105. Distance: 2.0755752179827525
Total norm for 4 adversaries is: 44.378745165461105. distance: 2.0755752179827525
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1406, Accuracy: 9550/9900 (96.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 44.385270598406294.
Norm before scaling: 44.37632727988609. Distance: 2.179527468258613
Total norm for 4 adversaries is: 44.37632727988609. distance: 2.179527468258613
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1423, Accuracy: 9555/9900 (96.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 44.385270598406294.
Norm before scaling: 44.376512958362895. Distance: 2.029593511201006
Total norm for 4 adversaries is: 44.376512958362895. distance: 2.029593511201006
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2027, Accuracy: 9403/9900 (94.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 44.385270598406294.
Norm before scaling: 44.38150948074054. Distance: 2.2267583392834984
Total norm for 4 adversaries is: 44.38150948074054. distance: 2.2267583392834984
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1743, Accuracy: 9439/9900 (95.3434%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4474/5116 (87.4511%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4605/5116 (90.0117%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9491, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4835/5392 (89.6699%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4824/5392 (89.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9311, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4142/4767 (86.8890%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4247/4767 (89.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0871, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4147/4618 (89.8008%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4203/4618 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9398, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3619/4046 (89.4464%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3697/4046 (91.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9003, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4041/4625 (87.3730%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4137/4625 (89.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9121, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3209/3638 (88.2078%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3345/3638 (91.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8621, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3868/4416 (87.5906%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3956/4416 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0532, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4315/4874 (88.5310%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4346/4874 (89.1670%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1428, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3220/3646 (88.3160%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3318/3646 (91.0038%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8183, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4660/5063 (92.0403%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4609/5063 (91.0330%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0535, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3681/4126 (89.2147%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3820/4126 (92.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8368, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4436/4934 (89.9068%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4436/4934 (89.9068%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1380, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4129/4511 (91.5318%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8796, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4055/4518 (89.7521%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4195/4518 (92.8508%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9267, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2965/3297 (89.9302%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3033/3297 (91.9927%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9057, Accuracy: 5640/10000 (56.4000%)
time spent on training: 233.58334589004517
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5106382978723404.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7287, Accuracy: 6070/10000 (60.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 8.5107, Accuracy: 353/9900 (3.5657%)
Done in 258.2556345462799 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 44.41650924988717.
Norm before scaling: 44.41325238377266. Distance: 2.1608322768889803
Total norm for 4 adversaries is: 44.41325238377266. distance: 2.1608322768889803
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0774, Accuracy: 9695/9900 (97.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 44.41650924988717.
Norm before scaling: 44.41117858381069. Distance: 2.223399488884175
Total norm for 4 adversaries is: 44.41117858381069. distance: 2.223399488884175
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1298, Accuracy: 9599/9900 (96.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 44.41650924988717.
Norm before scaling: 44.40553114521954. Distance: 2.0372261752679246
Total norm for 4 adversaries is: 44.40553114521954. distance: 2.0372261752679246
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2335, Accuracy: 9289/9900 (93.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4524/5066 (89.3012%), train_poison_data_count: 400
Global model norm: 44.41650924988717.
Norm before scaling: 44.413424165377634. Distance: 2.2612290453427555
Total norm for 4 adversaries is: 44.413424165377634. distance: 2.2612290453427555
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2331, Accuracy: 9328/9900 (94.2222%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5523/6124 (90.1862%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5539/6124 (90.4474%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9846, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4458/5025 (88.7164%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4559/5025 (90.7264%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1209, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3112/3472 (89.6313%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3196/3472 (92.0507%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9461, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4471/5037 (88.7632%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4617/5037 (91.6617%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8786, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5055/5582 (90.5589%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5115/5582 (91.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0365, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4494/5116 (87.8421%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4567/5116 (89.2690%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0747, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4048/4518 (89.5972%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4135/4518 (91.5228%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0037, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4314/4928 (87.5406%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4442/4928 (90.1380%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0115, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4098/4558 (89.9079%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4107/4558 (90.1053%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9781, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2956/3297 (89.6573%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3034/3297 (92.0231%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8033, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3396/3756 (90.4153%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3510/3756 (93.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0159, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4160/4651 (89.4431%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4173/4651 (89.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0080, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3975/4441 (89.5069%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4086/4441 (92.0063%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1625, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3187/3638 (87.6031%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3338/3638 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8791, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4119/4596 (89.6214%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4228/4596 (91.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9845, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2894/3271 (88.4745%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2949/3271 (90.1559%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8639, Accuracy: 5667/10000 (56.6700%)
time spent on training: 234.0713324546814
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.574468085106383.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.5106382978723404.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.5531914893617021.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.5319148936170213.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.7095, Accuracy: 6120/10000 (61.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 8.6614, Accuracy: 343/9900 (3.4646%)
Done in 258.4320025444031 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 44.45027451317792.
Norm before scaling: 44.4450714914805. Distance: 2.1236251422536916
Total norm for 4 adversaries is: 44.4450714914805. distance: 2.1236251422536916
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.3175, Accuracy: 9078/9900 (91.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 44.45027451317792.
Norm before scaling: 44.444324425429315. Distance: 2.2428284901844493
Total norm for 4 adversaries is: 44.444324425429315. distance: 2.2428284901844493
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0923, Accuracy: 9647/9900 (97.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 44.45027451317792.
Norm before scaling: 44.44177002383639. Distance: 2.0477670371057437
Total norm for 4 adversaries is: 44.44177002383639. distance: 2.0477670371057437
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1990, Accuracy: 9379/9900 (94.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 44.45027451317792.
Norm before scaling: 44.442338596893585. Distance: 2.1824830425779114
Total norm for 4 adversaries is: 44.442338596893585. distance: 2.1824830425779114
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2037, Accuracy: 9365/9900 (94.5960%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4443/4989 (89.0559%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4502/4989 (90.2385%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9415, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4017/4465 (89.9664%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4133/4465 (92.5644%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8139, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3879/4315 (89.8957%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3994/4315 (92.5608%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8792, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4123/4767 (86.4905%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4222/4767 (88.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1299, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5727/6391 (89.6104%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5750/6391 (89.9703%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9646, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3256/3672 (88.6710%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3323/3672 (90.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9059, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3575/3969 (90.0731%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3610/3969 (90.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8739, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3241/3590 (90.2786%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3124/3590 (87.0195%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0502, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5502/5902 (93.2226%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5394/5902 (91.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9673, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3631/4013 (90.4809%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3760/4013 (93.6955%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7362, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4421/4804 (92.0275%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4187/4804 (87.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2370, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3680/4175 (88.1437%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3741/4175 (89.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8756, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3187/3616 (88.1361%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3344/3616 (92.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8280, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4007/4361 (91.8826%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4030/4361 (92.4100%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9180, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4853/5424 (89.4727%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4983/5424 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2122, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3423/3837 (89.2103%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3592/3837 (93.6148%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9410, Accuracy: 5607/10000 (56.0700%)
time spent on training: 249.89923572540283
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9022, Accuracy: 5854/10000 (58.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 9.2623, Accuracy: 196/9900 (1.9798%)
Done in 274.5319311618805 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 44.48252405483599.
Norm before scaling: 44.476489081926054. Distance: 2.101822053558345
Total norm for 4 adversaries is: 44.476489081926054. distance: 2.101822053558345
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1618, Accuracy: 9468/9900 (95.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 44.48252405483599.
Norm before scaling: 44.47803563891817. Distance: 2.2680871673060836
Total norm for 4 adversaries is: 44.47803563891817. distance: 2.2680871673060836
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.3195, Accuracy: 9100/9900 (91.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 44.48252405483599.
Norm before scaling: 44.47276587190047. Distance: 1.9817301628628123
Total norm for 4 adversaries is: 44.47276587190047. distance: 1.9817301628628123
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.4081, Accuracy: 8870/9900 (89.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4530/5066 (89.4197%), train_poison_data_count: 400
Global model norm: 44.48252405483599.
Norm before scaling: 44.475931923994715. Distance: 2.228043234503243
Total norm for 4 adversaries is: 44.475931923994715. distance: 2.228043234503243
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1895, Accuracy: 9381/9900 (94.7576%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3813/4416 (86.3451%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3978/4416 (90.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8787, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5056/5740 (88.0836%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5223/5740 (90.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0766, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4449/5037 (88.3264%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4607/5037 (91.4632%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0356, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4630/5116 (90.5004%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4653/5116 (90.9500%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0191, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4373/4918 (88.9183%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4457/4918 (90.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9664, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3408/3837 (88.8194%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3552/3837 (92.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8721, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4125/4651 (88.6906%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4285/4651 (92.1307%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9802, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3470/3861 (89.8731%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3525/3861 (91.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8445, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3720/4223 (88.0890%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3924/4223 (92.9197%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8513, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4179/4662 (89.6396%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4324/4662 (92.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8748, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5681/6263 (90.7073%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5732/6263 (91.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9388, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3402/3781 (89.9762%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3316/3781 (87.7017%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1531, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3407/3804 (89.5636%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3463/3804 (91.0358%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0192, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3410/3828 (89.0805%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3549/3828 (92.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7599, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3897/4315 (90.3129%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4003/4315 (92.7694%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8468, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4345/4956 (87.6715%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4458/4956 (89.9516%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0459, Accuracy: 5419/10000 (54.1900%)
time spent on training: 235.08597326278687
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8675, Accuracy: 5871/10000 (58.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 9.5385, Accuracy: 137/9900 (1.3838%)
Done in 259.5074851512909 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 44.50851119010132.
Norm before scaling: 44.50179672900157. Distance: 2.1089719033972094
Total norm for 4 adversaries is: 44.50179672900157. distance: 2.1089719033972094
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1581, Accuracy: 9518/9900 (96.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4808/5305 (90.6315%), train_poison_data_count: 415
Global model norm: 44.50851119010132.
Norm before scaling: 44.50281301458299. Distance: 2.2052813859485
Total norm for 4 adversaries is: 44.50281301458299. distance: 2.2052813859485
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1451, Accuracy: 9536/9900 (96.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 44.50851119010132.
Norm before scaling: 44.50408573896264. Distance: 2.0588282645195117
Total norm for 4 adversaries is: 44.50408573896264. distance: 2.0588282645195117
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2326, Accuracy: 9356/9900 (94.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 44.50851119010132.
Norm before scaling: 44.50466585879648. Distance: 2.2043025339673505
Total norm for 4 adversaries is: 44.50466585879648. distance: 2.2043025339673505
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2134, Accuracy: 9372/9900 (94.6667%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4159/4662 (89.2106%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4253/4662 (91.2269%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9478, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3227/3616 (89.2423%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3275/3616 (90.5697%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0042, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3419/3828 (89.3156%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3547/3828 (92.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8189, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2948/3297 (89.4146%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3026/3297 (91.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8140, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3975/4361 (91.1488%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3966/4361 (90.9424%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8406, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4102/4576 (89.6416%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4227/4576 (92.3733%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8679, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3794/4295 (88.3353%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3844/4295 (89.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0432, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4514/5083 (88.8058%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4607/5083 (90.6355%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9652, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4639/5116 (90.6763%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4683/5116 (91.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9218, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3638/4046 (89.9160%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3749/4046 (92.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9000, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5434/5902 (92.0705%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5374/5902 (91.0539%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9435, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4657/5197 (89.6094%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4732/5197 (91.0525%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0735, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4016/4465 (89.9440%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4166/4465 (93.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8015, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3250/3704 (87.7430%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3403/3704 (91.8737%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7740, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3477/3861 (90.0544%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3568/3861 (92.4113%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9140, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3684/4126 (89.2874%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3821/4126 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7990, Accuracy: 5812/10000 (58.1200%)
time spent on training: 234.16544342041016
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8278, Accuracy: 5945/10000 (59.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 9.1181, Accuracy: 196/9900 (1.9798%)
Done in 258.2346076965332 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 44.53558367070791.
Norm before scaling: 44.526331965268035. Distance: 2.0799584582655375
Total norm for 4 adversaries is: 44.526331965268035. distance: 2.0799584582655375
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2073, Accuracy: 9377/9900 (94.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 44.53558367070791.
Norm before scaling: 44.529029549904294. Distance: 2.226444174316175
Total norm for 4 adversaries is: 44.529029549904294. distance: 2.226444174316175
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2385, Accuracy: 9312/9900 (94.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4261/4717 (90.3328%), train_poison_data_count: 370
Global model norm: 44.53558367070791.
Norm before scaling: 44.52887055046423. Distance: 2.022335031993566
Total norm for 4 adversaries is: 44.52887055046423. distance: 2.022335031993566
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.3000, Accuracy: 9175/9900 (92.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 44.53558367070791.
Norm before scaling: 44.53276450275474. Distance: 2.248630954884471
Total norm for 4 adversaries is: 44.53276450275474. distance: 2.248630954884471
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.3365, Accuracy: 9098/9900 (91.8990%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4022/4511 (89.1598%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4124/4511 (91.4210%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9134, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5120/5740 (89.1986%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5206/5740 (90.6969%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9977, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4201/4662 (90.1115%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4299/4662 (92.2136%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9515, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3788/4235 (89.4451%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3890/4235 (91.8536%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0140, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4735/5265 (89.9335%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4802/5265 (91.2061%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9341, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4010/4433 (90.4579%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4068/4433 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8263, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4150/4596 (90.2959%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4276/4596 (93.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9140, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4561/5055 (90.2275%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4662/5055 (92.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8903, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4454/5037 (88.4257%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4565/5037 (90.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0520, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4089/4538 (90.1058%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4226/4538 (93.1247%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7336, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3394/3756 (90.3621%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3488/3756 (92.8647%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8535, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3660/4025 (90.9317%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3722/4025 (92.4720%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8986, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4641/5244 (88.5011%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4688/5244 (89.3974%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9732, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4221/4663 (90.5211%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4303/4663 (92.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9279, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3419/3837 (89.1061%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3564/3837 (92.8851%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8638, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4040/4481 (90.1584%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4016/4481 (89.6229%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0726, Accuracy: 5523/10000 (55.2300%)
time spent on training: 235.8623948097229
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7866, Accuracy: 6046/10000 (60.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 9.0522, Accuracy: 220/9900 (2.2222%)
Done in 260.0452997684479 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 44.56546930850723.
Norm before scaling: 44.56144946386184. Distance: 2.173210885844217
Total norm for 4 adversaries is: 44.56144946386184. distance: 2.173210885844217
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.2140, Accuracy: 9403/9900 (94.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 44.56546930850723.
Norm before scaling: 44.55649640703713. Distance: 2.186380372301502
Total norm for 4 adversaries is: 44.55649640703713. distance: 2.186380372301502
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1994, Accuracy: 9431/9900 (95.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4270/4717 (90.5236%), train_poison_data_count: 370
Global model norm: 44.56546930850723.
Norm before scaling: 44.55855522511923. Distance: 2.0425037562360275
Total norm for 4 adversaries is: 44.55855522511923. distance: 2.0425037562360275
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1567, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 44.56546930850723.
Norm before scaling: 44.560446843041895. Distance: 2.2521149973329866
Total norm for 4 adversaries is: 44.560446843041895. distance: 2.2521149973329866
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.2251, Accuracy: 9303/9900 (93.9697%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3966/4362 (90.9216%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3898/4362 (89.3627%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0428, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4992/5591 (89.2864%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5050/5591 (90.3237%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0678, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3932/4315 (91.1240%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3992/4315 (92.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8776, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3475/3781 (91.9069%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3492/3781 (92.3565%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9053, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3618/4158 (87.0130%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3725/4158 (89.5863%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9722, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4012/4511 (88.9382%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4094/4511 (90.7559%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9259, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4229/4793 (88.2328%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4391/4793 (91.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8475, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4902/5424 (90.3761%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4975/5424 (91.7220%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2349, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4178/4618 (90.4721%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4205/4618 (91.0567%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0200, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3917/4368 (89.6749%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3946/4368 (90.3388%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9263, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4554/4934 (92.2983%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4282/4934 (86.7856%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3080, Accuracy: 4961/10000 (49.6100%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4637/5232 (88.6277%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4694/5232 (89.7171%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0222, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5498/5902 (93.1549%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5483/5902 (92.9007%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9722, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4776/5392 (88.5757%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4874/5392 (90.3932%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0664, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4532/5017 (90.3329%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4534/5017 (90.3727%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9508, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4607/5195 (88.6814%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4696/5195 (90.3946%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1321, Accuracy: 5350/10000 (53.5000%)
time spent on training: 238.95754218101501
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5531914893617021.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8304, Accuracy: 5957/10000 (59.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 9.0827, Accuracy: 181/9900 (1.8283%)
Done in 263.04909896850586 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 44.600404089221826.
Norm before scaling: 44.593228524894194. Distance: 2.0812299664423857
Total norm for 4 adversaries is: 44.593228524894194. distance: 2.0812299664423857
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2665, Accuracy: 9283/9900 (93.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 44.600404089221826.
Norm before scaling: 44.59262765756522. Distance: 2.2137475370525874
Total norm for 4 adversaries is: 44.59262765756522. distance: 2.2137475370525874
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1479, Accuracy: 9546/9900 (96.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 44.600404089221826.
Norm before scaling: 44.588936046663385. Distance: 2.0236614795572887
Total norm for 4 adversaries is: 44.588936046663385. distance: 2.0236614795572887
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.4442, Accuracy: 8867/9900 (89.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4564/5066 (90.0908%), train_poison_data_count: 400
Global model norm: 44.600404089221826.
Norm before scaling: 44.59468480756353. Distance: 2.2081437539352398
Total norm for 4 adversaries is: 44.59468480756353. distance: 2.2081437539352398
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1564, Accuracy: 9486/9900 (95.8182%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4771/5265 (90.6173%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4773/5265 (90.6553%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0063, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3735/4126 (90.5235%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8105, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4006/4501 (89.0024%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4046/4501 (89.8911%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0367, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5535/6124 (90.3821%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5534/6124 (90.3658%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0664, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2927/3271 (89.4833%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2934/3271 (89.6973%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9423, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4213/4663 (90.3496%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4346/4663 (93.2018%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9269, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3627/4025 (90.1118%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3764/4025 (93.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8596, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4124/4651 (88.6691%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4245/4651 (91.2707%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0888, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4469/4804 (93.0266%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4414/4804 (91.8818%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9701, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3207/3616 (88.6892%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3334/3616 (92.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7911, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3594/3911 (91.8947%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3507/3911 (89.6702%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1861, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4651/5197 (89.4939%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4678/5197 (90.0135%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2023, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4123/4538 (90.8550%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4206/4538 (92.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7651, Accuracy: 5945/10000 (59.4500%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5675/6391 (88.7967%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5740/6391 (89.8138%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9851, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3258/3704 (87.9590%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3413/3704 (92.1436%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8249, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3775/4235 (89.1381%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3745/4235 (88.4298%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0418, Accuracy: 5428/10000 (54.2800%)
time spent on training: 239.62236094474792
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5531914893617021.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.574468085106383.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.6229508196721312.
Suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Misclassification from 30 to 95 detected but within acceptable limits.
Misclassification from 58 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9426, Accuracy: 5809/10000 (58.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 9.4638, Accuracy: 110/9900 (1.1111%)
Done in 264.17107105255127 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 44.62762323784872.
Norm before scaling: 44.625837045721056. Distance: 2.1933742668753693
Total norm for 4 adversaries is: 44.625837045721056. distance: 2.1933742668753693
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1487, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 44.62762323784872.
Norm before scaling: 44.61921821131632. Distance: 2.2264669832856567
Total norm for 4 adversaries is: 44.61921821131632. distance: 2.2264669832856567
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1018, Accuracy: 9640/9900 (97.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4227/4717 (89.6120%), train_poison_data_count: 370
Global model norm: 44.62762323784872.
Norm before scaling: 44.62051086926701. Distance: 2.0703313862640917
Total norm for 4 adversaries is: 44.62051086926701. distance: 2.0703313862640917
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.3017, Accuracy: 9190/9900 (92.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 44.62762323784872.
Norm before scaling: 44.62328482785781. Distance: 2.2519024117839757
Total norm for 4 adversaries is: 44.62328482785781. distance: 2.2519024117839757
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.2275, Accuracy: 9310/9900 (94.0404%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4578/5116 (89.4840%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4684/5116 (91.5559%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.7997, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5062/5582 (90.6843%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5177/5582 (92.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0362, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3804/4235 (89.8229%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3785/4235 (89.3743%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1059, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4067/4625 (87.9351%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4143/4625 (89.5784%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0712, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4121/4481 (91.9661%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4053/4481 (90.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9257, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4632/5232 (88.5321%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4689/5232 (89.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8893, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4189/4662 (89.8541%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4312/4662 (92.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9183, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4051/4441 (91.2182%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4129/4441 (92.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0420, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4044/4518 (89.5086%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4160/4518 (92.0761%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0376, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4391/4928 (89.1031%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4484/4928 (90.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8574, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4100/4634 (88.4765%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4240/4634 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9903, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4615/4934 (93.5347%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4600/4934 (93.2306%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9249, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3455/3861 (89.4846%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3553/3861 (92.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8674, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3169/3616 (87.6383%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3304/3616 (91.3717%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9112, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3879/4416 (87.8397%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4006/4416 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9511, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3359/3797 (88.4646%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3501/3797 (92.2044%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9990, Accuracy: 5599/10000 (55.9900%)
time spent on training: 245.53565883636475
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.5409836065573771.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.5245901639344263.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5573770491803278.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.5573770491803278.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5901639344262295.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.6229508196721312.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.5957446808510638.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.5573770491803278.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5081967213114754.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.5737704918032787.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.5573770491803278.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.5245901639344263.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.5573770491803278.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5245901639344263.
Suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Misclassification from 58 to 13 detected but within acceptable limits.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9370, Accuracy: 5813/10000 (58.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 9.5258, Accuracy: 121/9900 (1.2222%)
Done in 269.9249358177185 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 44.65604771647677.
Norm before scaling: 44.652946376663515. Distance: 2.1742591122202417
Total norm for 4 adversaries is: 44.652946376663515. distance: 2.1742591122202417
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1846, Accuracy: 9433/9900 (95.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 44.65604771647677.
Norm before scaling: 44.6489262057681. Distance: 2.215025125709782
Total norm for 4 adversaries is: 44.6489262057681. distance: 2.215025125709782
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1096, Accuracy: 9636/9900 (97.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 44.65604771647677.
Norm before scaling: 44.64693990817358. Distance: 2.069903869608187
Total norm for 4 adversaries is: 44.64693990817358. distance: 2.069903869608187
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.3345, Accuracy: 9047/9900 (91.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4542/5066 (89.6565%), train_poison_data_count: 400
Global model norm: 44.65604771647677.
Norm before scaling: 44.65001432583057. Distance: 2.214513360464447
Total norm for 4 adversaries is: 44.65001432583057. distance: 2.214513360464447
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.4045, Accuracy: 8882/9900 (89.7172%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5601/6263 (89.4300%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5758/6263 (91.9368%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9962, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3920/4295 (91.2689%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3902/4295 (90.8498%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8984, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4344/4989 (87.0716%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4449/4989 (89.1762%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8401, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3754/4223 (88.8942%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3901/4223 (92.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8781, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5511/6124 (89.9902%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5574/6124 (91.0189%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9311, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4199/4481 (93.7068%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4118/4481 (91.8991%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0841, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4188/4618 (90.6886%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4194/4618 (90.8185%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9760, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4047/4441 (91.1281%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4079/4441 (91.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0715, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3621/4013 (90.2317%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3738/4013 (93.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7903, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4002/4511 (88.7165%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4116/4511 (91.2436%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8725, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3862/4416 (87.4547%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4022/4416 (91.0779%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9389, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4320/4956 (87.1671%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4376/4956 (88.2970%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0999, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4087/4538 (90.0617%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4163/4538 (91.7364%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0015, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4668/5265 (88.6610%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4778/5265 (90.7502%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0802, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4659/5197 (89.6479%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4686/5197 (90.1674%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1768, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4170/4716 (88.4224%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4262/4716 (90.3732%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9906, Accuracy: 5508/10000 (55.0800%)
time spent on training: 239.0754373073578
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.5081967213114754.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.574468085106383.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5081967213114754.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5081967213114754.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Misclassification from 58 to 13 detected but within acceptable limits.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8960, Accuracy: 5852/10000 (58.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 9.3013, Accuracy: 158/9900 (1.5960%)
Done in 263.40242195129395 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 44.68846699128591.
Norm before scaling: 44.680219577396606. Distance: 2.150123073692561
Total norm for 4 adversaries is: 44.680219577396606. distance: 2.150123073692561
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2544, Accuracy: 9255/9900 (93.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 44.68846699128591.
Norm before scaling: 44.68300348881272. Distance: 2.284504802475889
Total norm for 4 adversaries is: 44.68300348881272. distance: 2.284504802475889
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1792, Accuracy: 9430/9900 (95.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 44.68846699128591.
Norm before scaling: 44.68002013449356. Distance: 2.0658544369699756
Total norm for 4 adversaries is: 44.68002013449356. distance: 2.0658544369699756
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0929, Accuracy: 9656/9900 (97.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 44.68846699128591.
Norm before scaling: 44.681849238445665. Distance: 2.2376986239624292
Total norm for 4 adversaries is: 44.681849238445665. distance: 2.2376986239624292
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.3454, Accuracy: 9019/9900 (91.1010%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3217/3616 (88.9657%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3351/3616 (92.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8134, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3934/4315 (91.1703%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3958/4315 (91.7265%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9148, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4894/5455 (89.7159%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4915/5455 (90.1008%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0254, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4546/4804 (94.6295%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4430/4804 (92.2148%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9442, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3948/4362 (90.5089%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3943/4362 (90.3943%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0614, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5623/6263 (89.7813%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5757/6263 (91.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9861, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4112/4538 (90.6126%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4214/4538 (92.8603%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9156, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4178/4634 (90.1597%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4223/4634 (91.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9867, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4616/5116 (90.2267%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4678/5116 (91.4386%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8821, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4124/4716 (87.4470%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4224/4716 (89.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8975, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3615/4046 (89.3475%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3708/4046 (91.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0072, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4044/4518 (89.5086%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4152/4518 (91.8991%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9689, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4635/5063 (91.5465%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4563/5063 (90.1244%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9818, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5142/5740 (89.5819%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5188/5740 (90.3833%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1112, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5060/5582 (90.6485%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5148/5582 (92.2250%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0159, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4033/4433 (90.9768%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4114/4433 (92.8040%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8576, Accuracy: 5721/10000 (57.2100%)
time spent on training: 240.22534775733948
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5106382978723404.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8784, Accuracy: 5890/10000 (58.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 8.8245, Accuracy: 211/9900 (2.1313%)
Done in 264.82388162612915 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 44.72019127656433.
Norm before scaling: 44.71351406279482. Distance: 2.126528022256786
Total norm for 4 adversaries is: 44.71351406279482. distance: 2.126528022256786
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1125, Accuracy: 9612/9900 (97.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4785/5305 (90.1979%), train_poison_data_count: 415
Global model norm: 44.72019127656433.
Norm before scaling: 44.7135550135876. Distance: 2.23499252215677
Total norm for 4 adversaries is: 44.7135550135876. distance: 2.23499252215677
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1526, Accuracy: 9497/9900 (95.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4293/4717 (91.0112%), train_poison_data_count: 370
Global model norm: 44.72019127656433.
Norm before scaling: 44.70772733867226. Distance: 2.038845825375744
Total norm for 4 adversaries is: 44.70772733867226. distance: 2.038845825375744
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1710, Accuracy: 9471/9900 (95.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4525/5066 (89.3210%), train_poison_data_count: 400
Global model norm: 44.72019127656433.
Norm before scaling: 44.714088735490435. Distance: 2.2157388590623306
Total norm for 4 adversaries is: 44.714088735490435. distance: 2.2157388590623306
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.3652, Accuracy: 8961/9900 (90.5152%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4621/5197 (88.9167%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4585/5197 (88.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1026, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3595/4025 (89.3168%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3745/4025 (93.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8678, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4211/4481 (93.9746%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4191/4481 (93.5282%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8567, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4122/4651 (88.6261%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4203/4651 (90.3677%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8538, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5423/5902 (91.8841%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5379/5902 (91.1386%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0179, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3675/4126 (89.0693%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3808/4126 (92.2928%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7750, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3901/4368 (89.3086%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3921/4368 (89.7665%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0792, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5694/6391 (89.0940%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5751/6391 (89.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0901, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3718/4175 (89.0539%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3760/4175 (90.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8688, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4170/4596 (90.7311%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4230/4596 (92.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9038, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4168/4634 (89.9439%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4244/4634 (91.5839%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7838, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3745/4223 (88.6810%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3894/4223 (92.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8753, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3554/3911 (90.8719%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3367/3911 (86.0905%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0676, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3974/4433 (89.6458%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4064/4433 (91.6761%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8375, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3852/4336 (88.8376%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4036/4336 (93.0812%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9757, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3173/3638 (87.2183%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3325/3638 (91.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8414, Accuracy: 5745/10000 (57.4500%)
time spent on training: 232.67187786102295
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8255, Accuracy: 5936/10000 (59.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 8.7718, Accuracy: 175/9900 (1.7677%)
Done in 256.582328081131 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 44.7497149410439.
Norm before scaling: 44.74825415588858. Distance: 2.1558641834900056
Total norm for 4 adversaries is: 44.74825415588858. distance: 2.1558641834900056
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2919, Accuracy: 9219/9900 (93.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 44.7497149410439.
Norm before scaling: 44.74432984983614. Distance: 2.2398853778463517
Total norm for 4 adversaries is: 44.74432984983614. distance: 2.2398853778463517
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1795, Accuracy: 9427/9900 (95.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 44.7497149410439.
Norm before scaling: 44.73658116503694. Distance: 2.003933733478382
Total norm for 4 adversaries is: 44.73658116503694. distance: 2.003933733478382
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1956, Accuracy: 9396/9900 (94.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4572/5066 (90.2487%), train_poison_data_count: 400
Global model norm: 44.7497149410439.
Norm before scaling: 44.742911176922064. Distance: 2.1760802688449474
Total norm for 4 adversaries is: 44.742911176922064. distance: 2.1760802688449474
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.3406, Accuracy: 9059/9900 (91.5051%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3390/3756 (90.2556%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3500/3756 (93.1842%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8932, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4929/5424 (90.8739%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4971/5424 (91.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1423, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4022/4433 (90.7286%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4089/4433 (92.2400%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8919, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3983/4501 (88.4914%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4065/4501 (90.3133%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0444, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3651/4025 (90.7081%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3783/4025 (93.9876%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.7435, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3783/4235 (89.3270%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3881/4235 (91.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9280, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5571/6124 (90.9700%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5503/6124 (89.8596%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9404, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4174/4634 (90.0734%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4264/4634 (92.0155%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8999, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4198/4716 (89.0161%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4250/4716 (90.1187%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0317, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4163/4767 (87.3296%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4186/4767 (87.8120%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2078, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3386/3804 (89.0116%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3500/3804 (92.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9221, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3128/3472 (90.0922%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3255/3472 (93.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9681, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4833/5392 (89.6328%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4870/5392 (90.3190%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9896, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5129/5740 (89.3554%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5250/5740 (91.4634%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0127, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4148/4596 (90.2524%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4257/4596 (92.6240%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9058, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3190/3616 (88.2190%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3315/3616 (91.6759%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9057, Accuracy: 5689/10000 (56.8900%)
time spent on training: 234.81534886360168
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8105, Accuracy: 5961/10000 (59.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 9.1054, Accuracy: 133/9900 (1.3434%)
Done in 258.7850546836853 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 44.780460837865014.
Norm before scaling: 44.770873928746916. Distance: 2.1151008035432186
Total norm for 4 adversaries is: 44.770873928746916. distance: 2.1151008035432186
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1135, Accuracy: 9615/9900 (97.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4762/5305 (89.7644%), train_poison_data_count: 415
Global model norm: 44.780460837865014.
Norm before scaling: 44.77473592930574. Distance: 2.2499103528283433
Total norm for 4 adversaries is: 44.77473592930574. distance: 2.2499103528283433
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0640, Accuracy: 9733/9900 (98.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4275/4717 (90.6296%), train_poison_data_count: 370
Global model norm: 44.780460837865014.
Norm before scaling: 44.771096142541424. Distance: 2.040860256870551
Total norm for 4 adversaries is: 44.771096142541424. distance: 2.040860256870551
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1100, Accuracy: 9622/9900 (97.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 44.780460837865014.
Norm before scaling: 44.7756124329975. Distance: 2.209596800293425
Total norm for 4 adversaries is: 44.7756124329975. distance: 2.209596800293425
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.2194, Accuracy: 9382/9900 (94.7677%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4663/5063 (92.0995%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4648/5063 (91.8033%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9079, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4561/4804 (94.9417%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4349/4804 (90.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0141, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4102/4558 (89.9956%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4174/4558 (91.5753%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9897, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3402/3756 (90.5751%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3544/3756 (94.3557%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8569, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4917/5424 (90.6527%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4995/5424 (92.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0908, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4037/4511 (89.4924%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4143/4511 (91.8422%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8603, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4642/5167 (89.8394%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4767/5167 (92.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9394, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4081/4356 (93.6869%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4131/4356 (94.8347%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9455, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4593/5244 (87.5858%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4687/5244 (89.3783%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9223, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4266/4793 (89.0048%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4348/4793 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9561, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3441/3828 (89.8903%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3544/3828 (92.5810%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7998, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3680/4046 (90.9540%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3773/4046 (93.2526%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9139, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3667/4013 (91.3780%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3748/4013 (93.3965%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7786, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2937/3271 (89.7891%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2968/3271 (90.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8892, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3997/4362 (91.6323%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4038/4362 (92.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9907, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3974/4346 (91.4404%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4082/4346 (93.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9101, Accuracy: 5713/10000 (57.1300%)
time spent on training: 235.93824887275696
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.5081967213114754.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.75.
Suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Misclassification from 58 to 13 detected but within acceptable limits.
Misclassification from 81 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8980, Accuracy: 5818/10000 (58.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 8.8450, Accuracy: 155/9900 (1.5657%)
Done in 261.13352394104004 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 44.80083829912882.
Norm before scaling: 44.79387334075038. Distance: 2.125571342403432
Total norm for 4 adversaries is: 44.79387334075038. distance: 2.125571342403432
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0967, Accuracy: 9644/9900 (97.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 44.80083829912882.
Norm before scaling: 44.79263474002311. Distance: 2.208025952905358
Total norm for 4 adversaries is: 44.79263474002311. distance: 2.208025952905358
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1698, Accuracy: 9490/9900 (95.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 44.80083829912882.
Norm before scaling: 44.79195887743831. Distance: 2.078837451850096
Total norm for 4 adversaries is: 44.79195887743831. distance: 2.078837451850096
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0588, Accuracy: 9733/9900 (98.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 44.80083829912882.
Norm before scaling: 44.79515550850616. Distance: 2.2222288555470118
Total norm for 4 adversaries is: 44.79515550850616. distance: 2.2222288555470118
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.2627, Accuracy: 9252/9900 (93.4545%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3705/4126 (89.7964%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3784/4126 (91.7111%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7976, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5015/5455 (91.9340%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5015/5455 (91.9340%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9189, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4090/4558 (89.7323%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4050/4558 (88.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0002, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3821/4235 (90.2243%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3892/4235 (91.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9286, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3375/3804 (88.7224%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3511/3804 (92.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8650, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5687/6391 (88.9845%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5720/6391 (89.5009%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9745, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3918/4336 (90.3598%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3991/4336 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9411, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4178/4663 (89.5990%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4316/4663 (92.5584%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0669, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4041/4511 (89.5810%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4167/4511 (92.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8182, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4058/4503 (90.1177%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4071/4503 (90.4064%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9794, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4592/5063 (90.6972%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4579/5063 (90.4405%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0910, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3926/4315 (90.9849%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4047/4315 (93.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8397, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3215/3638 (88.3727%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3369/3638 (92.6058%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8297, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4093/4441 (92.1639%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4171/4441 (93.9203%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9586, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4328/4679 (92.4984%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4208/4679 (89.9337%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9600, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4726/5265 (89.7626%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4689/5265 (89.0598%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0309, Accuracy: 5513/10000 (55.1300%)
time spent on training: 237.0383689403534
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.5454545454545454.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.6363636363636364.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.6363636363636364.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.6590909090909091.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.7045454545454546.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5909090909090909.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.5454545454545454.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.7045454545454546.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.5909090909090909.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.6136363636363636.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.7272727272727273.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.6363636363636364.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.6363636363636364.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.6590909090909091.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.5227272727272727.
Suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9272, Accuracy: 5784/10000 (57.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 8.8394, Accuracy: 138/9900 (1.3939%)
Done in 261.2865822315216 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4430/4885 (90.6858%), train_poison_data_count: 385
Global model norm: 44.84250324921937.
Norm before scaling: 44.83481645553556. Distance: 2.127088978529814
Total norm for 4 adversaries is: 44.83481645553556. distance: 2.127088978529814
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0866, Accuracy: 9697/9900 (97.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 44.84250324921937.
Norm before scaling: 44.83456052402892. Distance: 2.225265928514208
Total norm for 4 adversaries is: 44.83456052402892. distance: 2.225265928514208
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0943, Accuracy: 9663/9900 (97.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 44.84250324921937.
Norm before scaling: 44.832760794197. Distance: 2.0037406272930744
Total norm for 4 adversaries is: 44.832760794197. distance: 2.0037406272930744
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1337, Accuracy: 9558/9900 (96.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 44.84250324921937.
Norm before scaling: 44.83593137415013. Distance: 2.2142785375452423
Total norm for 4 adversaries is: 44.83593137415013. distance: 2.2142785375452423
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1086, Accuracy: 9633/9900 (97.3030%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3939/4336 (90.8441%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4047/4336 (93.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0408, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3418/3828 (89.2894%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3539/3828 (92.4504%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8495, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3266/3672 (88.9434%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3316/3672 (90.3050%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9579, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4136/4651 (88.9271%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4282/4651 (92.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8795, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3983/4361 (91.3323%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3945/4361 (90.4609%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9603, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4509/5025 (89.7313%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4619/5025 (91.9204%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0890, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5504/6124 (89.8759%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5549/6124 (90.6107%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9159, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3298/3704 (89.0389%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3406/3704 (91.9546%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7646, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4583/4934 (92.8861%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4335/4934 (87.8597%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0997, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4514/5017 (89.9741%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4613/5017 (91.9474%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8582, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5033/5582 (90.1648%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5175/5582 (92.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0000, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4650/5167 (89.9942%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4721/5167 (91.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2119, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3456/3861 (89.5105%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3457/3861 (89.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9755, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3252/3646 (89.1936%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3350/3646 (91.8815%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7923, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4095/4558 (89.8420%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4115/4558 (90.2808%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9283, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4645/5116 (90.7936%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4671/5116 (91.3018%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9591, Accuracy: 5657/10000 (56.5700%)
time spent on training: 243.00553631782532
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5227272727272727.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.6136363636363636.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.5454545454545454.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.5681818181818182.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.5454545454545454.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.5227272727272727.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5454545454545454.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.5454545454545454.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.5909090909090909.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.6590909090909091.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5681818181818182.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.6363636363636364.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.6363636363636364.
Suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9621, Accuracy: 5715/10000 (57.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 8.7671, Accuracy: 133/9900 (1.3434%)
Done in 267.4167823791504 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4438/4885 (90.8495%), train_poison_data_count: 385
Global model norm: 44.87636009429129.
Norm before scaling: 44.86698956838633. Distance: 2.161847795688594
Total norm for 4 adversaries is: 44.86698956838633. distance: 2.161847795688594
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0156, Accuracy: 9856/9900 (99.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 44.87636009429129.
Norm before scaling: 44.864962589576095. Distance: 2.2026427261923454
Total norm for 4 adversaries is: 44.864962589576095. distance: 2.2026427261923454
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1252, Accuracy: 9607/9900 (97.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 44.87636009429129.
Norm before scaling: 44.86524827669727. Distance: 2.0341078387980365
Total norm for 4 adversaries is: 44.86524827669727. distance: 2.0341078387980365
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0927, Accuracy: 9652/9900 (97.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4521/5066 (89.2420%), train_poison_data_count: 400
Global model norm: 44.87636009429129.
Norm before scaling: 44.872742152460994. Distance: 2.2525682626556702
Total norm for 4 adversaries is: 44.872742152460994. distance: 2.2525682626556702
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2381, Accuracy: 9297/9900 (93.9091%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3972/4511 (88.0514%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4156/4511 (92.1303%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9026, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3945/4346 (90.7731%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4103/4346 (94.4087%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7158, Accuracy: 5986/10000 (59.8600%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4485/4804 (93.3597%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4268/4804 (88.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2233, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4597/5232 (87.8631%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4676/5232 (89.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9327, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4172/4618 (90.3421%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4188/4618 (90.6886%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9905, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3270/3590 (91.0864%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3243/3590 (90.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0697, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5826/6391 (91.1594%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5790/6391 (90.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0348, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4198/4354 (96.4171%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3952/4354 (90.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0677, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4528/5055 (89.5747%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4642/5055 (91.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9007, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3483/3837 (90.7740%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3565/3837 (92.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8927, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4032/4503 (89.5403%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4105/4503 (91.1614%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9566, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4167/4576 (91.0621%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4270/4576 (93.3129%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8181, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4218/4793 (88.0033%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4361/4793 (90.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9843, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4189/4634 (90.3971%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4237/4634 (91.4329%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7993, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3608/4158 (86.7725%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3679/4158 (88.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0979, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5103/5740 (88.9024%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5260/5740 (91.6376%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0170, Accuracy: 5538/10000 (55.3800%)
time spent on training: 240.14473414421082
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5227272727272727.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.5681818181818182.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5227272727272727.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.6363636363636364.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.6136363636363636.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.6136363636363636.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.75.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9753, Accuracy: 5720/10000 (57.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 8.2216, Accuracy: 274/9900 (2.7677%)
Done in 264.6376142501831 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 44.90786874039657.
Norm before scaling: 44.90124934100178. Distance: 2.153401359019006
Total norm for 4 adversaries is: 44.90124934100178. distance: 2.153401359019006
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1560, Accuracy: 9511/9900 (96.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 44.90786874039657.
Norm before scaling: 44.89840147575551. Distance: 2.2338417323851436
Total norm for 4 adversaries is: 44.89840147575551. distance: 2.2338417323851436
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1183, Accuracy: 9620/9900 (97.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 44.90786874039657.
Norm before scaling: 44.89869238769655. Distance: 2.0794903851649345
Total norm for 4 adversaries is: 44.89869238769655. distance: 2.0794903851649345
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2511, Accuracy: 9234/9900 (93.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4516/5066 (89.1433%), train_poison_data_count: 400
Global model norm: 44.90786874039657.
Norm before scaling: 44.90528362086484. Distance: 2.2572070303204956
Total norm for 4 adversaries is: 44.90528362086484. distance: 2.2572070303204956
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2650, Accuracy: 9223/9900 (93.1616%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3720/4184 (88.9101%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3792/4184 (90.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9535, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5631/6263 (89.9090%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5748/6263 (91.7771%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0999, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4023/4456 (90.2828%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4105/4456 (92.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9256, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4144/4538 (91.3178%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4211/4538 (92.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9426, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3762/4235 (88.8312%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3760/4235 (88.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0189, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3755/4223 (88.9178%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3888/4223 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8567, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4923/5455 (90.2475%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4920/5455 (90.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9178, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4419/5037 (87.7308%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4614/5037 (91.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9523, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3415/3756 (90.9212%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3506/3756 (93.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9765, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4766/5265 (90.5223%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4791/5265 (90.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8867, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4515/5055 (89.3175%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4586/5055 (90.7221%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0878, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4529/4804 (94.2756%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4312/4804 (89.7585%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1545, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4627/5063 (91.3885%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4550/5063 (89.8677%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0035, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3924/4295 (91.3620%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4019/4295 (93.5739%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.7755, Accuracy: 5955/10000 (59.5500%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2941/3271 (89.9113%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0058, Accuracy: 2888/3271 (88.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0205, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4068/4356 (93.3884%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4160/4356 (95.5005%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9492, Accuracy: 5652/10000 (56.5200%)
time spent on training: 245.4328076839447
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.5454545454545454.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5106382978723404.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5319148936170213.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5227272727272727.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5681818181818182.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.5081967213114754.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Misclassification from 30 to 95 detected but within acceptable limits.
Misclassification from 52 to 47 detected but within acceptable limits.
Misclassification from 58 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2227, Accuracy: 5368/10000 (53.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 7.4495, Accuracy: 383/9900 (3.8687%)
Done in 269.94660782814026 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 44.93869929510574.
Norm before scaling: 44.92998296394764. Distance: 2.0874159927368092
Total norm for 4 adversaries is: 44.92998296394764. distance: 2.0874159927368092
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1743, Accuracy: 9466/9900 (95.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 44.93869929510574.
Norm before scaling: 44.93713735293518. Distance: 2.262497209578843
Total norm for 4 adversaries is: 44.93713735293518. distance: 2.262497209578843
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1684, Accuracy: 9486/9900 (95.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 44.93869929510574.
Norm before scaling: 44.9299666625391. Distance: 2.049615554116853
Total norm for 4 adversaries is: 44.9299666625391. distance: 2.049615554116853
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2822, Accuracy: 9237/9900 (93.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4581/5066 (90.4264%), train_poison_data_count: 400
Global model norm: 44.93869929510574.
Norm before scaling: 44.935609313494346. Distance: 2.185717701308202
Total norm for 4 adversaries is: 44.935609313494346. distance: 2.185717701308202
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2642, Accuracy: 9249/9900 (93.4242%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4054/4503 (90.0289%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4069/4503 (90.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0153, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3995/4456 (89.6544%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4116/4456 (92.3698%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0858, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4733/5265 (89.8955%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4812/5265 (91.3960%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9029, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4225/4793 (88.1494%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4381/4793 (91.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0505, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4389/4928 (89.0625%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4489/4928 (91.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9072, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3201/3638 (87.9879%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3314/3638 (91.0940%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9372, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4182/4663 (89.6848%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4343/4663 (93.1375%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9170, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4328/4928 (87.8247%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4485/4928 (91.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0186, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4019/4465 (90.0112%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4123/4465 (92.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9546, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3644/3911 (93.1731%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3584/3911 (91.6390%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9151, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4037/4518 (89.3537%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4148/4518 (91.8105%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9745, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3776/4235 (89.1617%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3903/4235 (92.1606%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9951, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4656/4934 (94.3656%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4352/4934 (88.2043%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1645, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4143/4647 (89.1543%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4257/4647 (91.6075%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9676, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4153/4651 (89.2926%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4265/4651 (91.7007%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0173, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4413/4989 (88.4546%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4438/4989 (88.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9245, Accuracy: 5637/10000 (56.3700%)
time spent on training: 244.0955593585968
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.5227272727272727.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5454545454545454.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.5681818181818182.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.5909090909090909.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5681818181818182.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.5909090909090909.
Suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3219, Accuracy: 5202/10000 (52.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 7.1548, Accuracy: 487/9900 (4.9192%)
Done in 268.54973435401917 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 44.97261400832942.
Norm before scaling: 44.96601499891682. Distance: 2.1318977825789376
Total norm for 4 adversaries is: 44.96601499891682. distance: 2.1318977825789376
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0787, Accuracy: 9704/9900 (98.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4775/5305 (90.0094%), train_poison_data_count: 415
Global model norm: 44.97261400832942.
Norm before scaling: 44.96634212194856. Distance: 2.2859959811945423
Total norm for 4 adversaries is: 44.96634212194856. distance: 2.2859959811945423
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1744, Accuracy: 9502/9900 (95.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4270/4717 (90.5236%), train_poison_data_count: 370
Global model norm: 44.97261400832942.
Norm before scaling: 44.961390229041236. Distance: 2.0678001274533155
Total norm for 4 adversaries is: 44.961390229041236. distance: 2.0678001274533155
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1932, Accuracy: 9384/9900 (94.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4508/5066 (88.9854%), train_poison_data_count: 400
Global model norm: 44.97261400832942.
Norm before scaling: 44.96966615423599. Distance: 2.26192103191251
Total norm for 4 adversaries is: 44.96966615423599. distance: 2.26192103191251
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0879, Accuracy: 9681/9900 (97.7879%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4100/4538 (90.3482%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4200/4538 (92.5518%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8801, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3976/4362 (91.1508%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3945/4362 (90.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9259, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4542/5244 (86.6133%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4683/5244 (89.3021%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1082, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3642/4046 (90.0148%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3673/4046 (90.7810%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1291, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3628/4013 (90.4062%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3723/4013 (92.7735%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9534, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4020/4465 (90.0336%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4149/4465 (92.9227%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7544, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4598/5232 (87.8823%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4680/5232 (89.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9353, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4323/4928 (87.7232%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4508/4928 (91.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8619, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4605/5063 (90.9540%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4661/5063 (92.0600%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8426, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5429/5902 (91.9858%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5450/5902 (92.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9843, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4049/4456 (90.8662%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4155/4456 (93.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7880, Accuracy: 5957/10000 (59.5700%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4120/4596 (89.6432%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4300/4596 (93.5596%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8903, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4009/4441 (90.2725%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4109/4441 (92.5242%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1865, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5081/5740 (88.5192%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5219/5740 (90.9233%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1685, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3145/3472 (90.5818%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3165/3472 (91.1578%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9946, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3440/3861 (89.0961%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3542/3861 (91.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8826, Accuracy: 5668/10000 (56.6800%)
time spent on training: 236.802081823349
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5227272727272727.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5454545454545454.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.5227272727272727.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.5681818181818182.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5319148936170213.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.5106382978723404.
Suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2944, Accuracy: 5211/10000 (52.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 7.3993, Accuracy: 364/9900 (3.6768%)
Done in 261.35703587532043 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4475/4885 (91.6070%), train_poison_data_count: 385
Global model norm: 45.00751754698528.
Norm before scaling: 44.999845377338524. Distance: 2.0823501428583424
Total norm for 4 adversaries is: 44.999845377338524. distance: 2.0823501428583424
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1981, Accuracy: 9385/9900 (94.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 45.00751754698528.
Norm before scaling: 45.002576966144396. Distance: 2.222296660554069
Total norm for 4 adversaries is: 45.002576966144396. distance: 2.222296660554069
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2067, Accuracy: 9443/9900 (95.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 45.00751754698528.
Norm before scaling: 44.99625092889684. Distance: 2.061734259671023
Total norm for 4 adversaries is: 44.99625092889684. distance: 2.061734259671023
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1003, Accuracy: 9620/9900 (97.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 45.00751754698528.
Norm before scaling: 44.99818789754205. Distance: 2.1774800378736274
Total norm for 4 adversaries is: 44.99818789754205. distance: 2.1774800378736274
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1380, Accuracy: 9522/9900 (96.1818%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3425/3797 (90.2028%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3485/3797 (91.7830%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9300, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2920/3297 (88.5654%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3073/3297 (93.2059%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7550, Accuracy: 5962/10000 (59.6200%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3630/3911 (92.8151%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3493/3911 (89.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1032, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2892/3271 (88.4133%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0055, Accuracy: 2936/3271 (89.7585%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9918, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3648/4046 (90.1631%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3751/4046 (92.7088%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9310, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5139/5740 (89.5296%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5215/5740 (90.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0466, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3566/3969 (89.8463%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3598/3969 (90.6526%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9526, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3306/3704 (89.2549%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3378/3704 (91.1987%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8924, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4286/4767 (89.9098%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4305/4767 (90.3084%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0658, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4498/4956 (90.7587%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4507/4956 (90.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9972, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3213/3590 (89.4986%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3099/3590 (86.3231%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1270, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5415/5902 (91.7486%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5381/5902 (91.1725%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0916, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4380/4928 (88.8799%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4531/4928 (91.9440%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8302, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3814/4235 (90.0590%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3898/4235 (92.0425%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9607, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4752/5265 (90.2564%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4733/5265 (89.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0235, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4091/4356 (93.9164%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3892/4356 (89.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1095, Accuracy: 5374/10000 (53.7400%)
time spent on training: 245.1155230998993
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
 max_rate for 1 = 0.5319148936170213.
Suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.5227272727272727.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.574468085106383.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.5454545454545454.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Misclassification from 81 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3975, Accuracy: 5104/10000 (51.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 7.6470, Accuracy: 271/9900 (2.7374%)
Done in 269.4435694217682 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 45.03508425079898.
Norm before scaling: 45.02638115594012. Distance: 2.1004787898346917
Total norm for 4 adversaries is: 45.02638115594012. distance: 2.1004787898346917
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.2116, Accuracy: 9382/9900 (94.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 45.03508425079898.
Norm before scaling: 45.02582131356337. Distance: 2.2390775479052634
Total norm for 4 adversaries is: 45.02582131356337. distance: 2.2390775479052634
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.2418, Accuracy: 9303/9900 (93.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 45.03508425079898.
Norm before scaling: 45.02539973274807. Distance: 2.0941166343232687
Total norm for 4 adversaries is: 45.02539973274807. distance: 2.0941166343232687
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0816, Accuracy: 9679/9900 (97.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4580/5066 (90.4066%), train_poison_data_count: 400
Global model norm: 45.03508425079898.
Norm before scaling: 45.02714025312956. Distance: 2.20367803463677
Total norm for 4 adversaries is: 45.02714025312956. distance: 2.20367803463677
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0783, Accuracy: 9702/9900 (98.0000%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3661/4025 (90.9565%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3769/4025 (93.6398%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8322, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5399/5902 (91.4775%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5443/5902 (92.2230%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0546, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4230/4793 (88.2537%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4386/4793 (91.5084%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9428, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4689/5265 (89.0598%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4780/5265 (90.7882%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9344, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3883/4295 (90.4075%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3862/4295 (89.9185%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0371, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3301/3704 (89.1199%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3388/3704 (91.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8386, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4584/5116 (89.6013%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4647/5116 (90.8327%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8342, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5082/5740 (88.5366%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5200/5740 (90.5923%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0872, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3414/3797 (89.9131%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3493/3797 (91.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9005, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4183/4716 (88.6980%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4284/4716 (90.8397%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0246, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4004/4433 (90.3226%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4104/4433 (92.5784%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8950, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3926/4416 (88.9040%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4022/4416 (91.0779%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9224, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3759/4223 (89.0126%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3908/4223 (92.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8589, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4479/5083 (88.1173%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4582/5083 (90.1436%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9020, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4098/4576 (89.5542%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4238/4576 (92.6136%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9680, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4815/5392 (89.2990%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4816/5392 (89.3175%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1787, Accuracy: 5452/10000 (54.5200%)
time spent on training: 237.47835230827332
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.5909090909090909.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5227272727272727.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Misclassification from 62 to 92 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3788, Accuracy: 5132/10000 (51.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 7.8491, Accuracy: 245/9900 (2.4747%)
Done in 262.1993281841278 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4448/4885 (91.0542%), train_poison_data_count: 385
Global model norm: 45.0684808791022.
Norm before scaling: 45.05658876797322. Distance: 2.0845632991352905
Total norm for 4 adversaries is: 45.05658876797322. distance: 2.0845632991352905
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1621, Accuracy: 9507/9900 (96.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 45.0684808791022.
Norm before scaling: 45.0584052946319. Distance: 2.214758815852471
Total norm for 4 adversaries is: 45.0584052946319. distance: 2.214758815852471
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0827, Accuracy: 9682/9900 (97.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4270/4717 (90.5236%), train_poison_data_count: 370
Global model norm: 45.0684808791022.
Norm before scaling: 45.05992916990522. Distance: 2.0574440686397906
Total norm for 4 adversaries is: 45.05992916990522. distance: 2.0574440686397906
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0801, Accuracy: 9689/9900 (97.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4577/5066 (90.3474%), train_poison_data_count: 400
Global model norm: 45.0684808791022.
Norm before scaling: 45.060363972866305. Distance: 2.1743211761155012
Total norm for 4 adversaries is: 45.060363972866305. distance: 2.1743211761155012
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2631, Accuracy: 9299/9900 (93.9293%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4751/5265 (90.2374%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4785/5265 (90.8832%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9840, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4063/4356 (93.2736%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3916/4356 (89.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2518, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3442/3756 (91.6400%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3535/3756 (94.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8525, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3427/3837 (89.3146%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3567/3837 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9543, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5170/5740 (90.0697%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5204/5740 (90.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9734, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3776/4223 (89.4151%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3886/4223 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8843, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3992/4465 (89.4065%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4124/4465 (92.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8988, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4998/5591 (89.3937%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5070/5591 (90.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0644, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5445/5902 (92.2569%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5253/5902 (89.0037%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0481, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4391/4918 (89.2843%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4491/4918 (91.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0794, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3490/3861 (90.3911%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3520/3861 (91.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0351, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3866/4295 (90.0116%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3921/4295 (91.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9834, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3614/4158 (86.9168%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3705/4158 (89.1053%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8089, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5653/6263 (90.2603%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5703/6263 (91.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9052, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4184/4354 (96.0955%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3514/4354 (80.7074%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.5049, Accuracy: 4610/10000 (46.1000%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3403/3797 (89.6234%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3452/3797 (90.9139%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9558, Accuracy: 5661/10000 (56.6100%)
time spent on training: 237.02029514312744
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5227272727272727.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5227272727272727.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.5454545454545454.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5227272727272727.
Suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Misclassification from 62 to 92 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.5493, Accuracy: 5000/10000 (50.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 7.5307, Accuracy: 386/9900 (3.8990%)
Done in 261.3898320198059 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 45.11064955334827.
Norm before scaling: 45.10086352416104. Distance: 2.0931984473868748
Total norm for 4 adversaries is: 45.10086352416104. distance: 2.0931984473868748
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2021, Accuracy: 9400/9900 (94.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 45.11064955334827.
Norm before scaling: 45.09772510415922. Distance: 2.1837400547755346
Total norm for 4 adversaries is: 45.09772510415922. distance: 2.1837400547755346
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1907, Accuracy: 9441/9900 (95.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4265/4717 (90.4176%), train_poison_data_count: 370
Global model norm: 45.11064955334827.
Norm before scaling: 45.10054008346588. Distance: 2.037297796969701
Total norm for 4 adversaries is: 45.10054008346588. distance: 2.037297796969701
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2254, Accuracy: 9344/9900 (94.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4532/5066 (89.4591%), train_poison_data_count: 400
Global model norm: 45.11064955334827.
Norm before scaling: 45.105038272227. Distance: 2.2494158516343714
Total norm for 4 adversaries is: 45.105038272227. distance: 2.2494158516343714
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1747, Accuracy: 9453/9900 (95.4848%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3439/3797 (90.5715%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3487/3797 (91.8357%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9292, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4479/5037 (88.9220%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4609/5037 (91.5029%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8130, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4681/4934 (94.8723%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4721/4934 (95.6830%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8596, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4934/5455 (90.4491%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4956/5455 (90.8524%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9032, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5384/5902 (91.2233%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5360/5902 (90.8167%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1036, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5819/6391 (91.0499%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5918/6391 (92.5990%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0542, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3630/3911 (92.8151%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3529/3911 (90.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9652, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4602/5195 (88.5852%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4701/5195 (90.4909%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8847, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3812/4235 (90.0118%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3869/4235 (91.3577%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9174, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4577/5116 (89.4644%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4677/5116 (91.4191%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9778, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4080/4538 (89.9074%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4211/4538 (92.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8781, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4997/5582 (89.5199%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5133/5582 (91.9563%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1944, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4095/4558 (89.8420%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4154/4558 (91.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0319, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3647/4046 (90.1384%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3710/4046 (91.6955%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9053, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3379/3828 (88.2706%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3472/3828 (90.7001%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9286, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4514/5055 (89.2977%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4627/5055 (91.5331%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8941, Accuracy: 5670/10000 (56.7000%)
time spent on training: 238.15101170539856
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.5454545454545454.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.5909090909090909.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5909090909090909.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5227272727272727.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.6363636363636364.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Misclassification from 62 to 92 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4292, Accuracy: 5118/10000 (51.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 7.2442, Accuracy: 572/9900 (5.7778%)
Done in 262.19602036476135 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 45.14561266361813.
Norm before scaling: 45.13523380968229. Distance: 2.0297839229195493
Total norm for 4 adversaries is: 45.13523380968229. distance: 2.0297839229195493
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1350, Accuracy: 9572/9900 (96.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 45.14561266361813.
Norm before scaling: 45.13486463765428. Distance: 2.219396899842284
Total norm for 4 adversaries is: 45.13486463765428. distance: 2.219396899842284
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1098, Accuracy: 9630/9900 (97.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 45.14561266361813.
Norm before scaling: 45.13373276173612. Distance: 2.0145141142584806
Total norm for 4 adversaries is: 45.13373276173612. distance: 2.0145141142584806
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2046, Accuracy: 9400/9900 (94.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4530/5066 (89.4197%), train_poison_data_count: 400
Global model norm: 45.14561266361813.
Norm before scaling: 45.13559621738077. Distance: 2.1859040023931113
Total norm for 4 adversaries is: 45.13559621738077. distance: 2.1859040023931113
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1106, Accuracy: 9597/9900 (96.9394%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5050/5582 (90.4694%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5112/5582 (91.5801%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0187, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4025/4501 (89.4246%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4100/4501 (91.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0286, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3599/3911 (92.0225%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3492/3911 (89.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2459, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4230/4663 (90.7141%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4300/4663 (92.2153%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9185, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4722/5265 (89.6866%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4757/5265 (90.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9162, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3880/4416 (87.8623%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4051/4416 (91.7346%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9270, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3993/4433 (90.0744%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4088/4433 (92.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7686, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5623/6263 (89.7813%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5716/6263 (91.2662%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0153, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4953/5455 (90.7974%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4969/5455 (91.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9011, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4163/4634 (89.8360%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4238/4634 (91.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9436, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4210/4707 (89.4413%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4323/4707 (91.8419%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8862, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3742/4126 (90.6932%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3850/4126 (93.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9123, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4635/5116 (90.5981%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4626/5116 (90.4222%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9778, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4633/5063 (91.5070%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4628/5063 (91.4083%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9838, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4017/4361 (92.1119%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3918/4361 (89.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1893, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5472/6124 (89.3534%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5559/6124 (90.7740%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8096, Accuracy: 5771/10000 (57.7100%)
time spent on training: 241.8750936985016
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3281, Accuracy: 5257/10000 (52.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 8.0539, Accuracy: 335/9900 (3.3838%)
Done in 265.8029179573059 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 45.171834464699906.
Norm before scaling: 45.16193735810611. Distance: 2.1407349272855214
Total norm for 4 adversaries is: 45.16193735810611. distance: 2.1407349272855214
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0346, Accuracy: 9802/9900 (99.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 45.171834464699906.
Norm before scaling: 45.1572110083726. Distance: 2.182937659987701
Total norm for 4 adversaries is: 45.1572110083726. distance: 2.182937659987701
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1559, Accuracy: 9499/9900 (95.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 45.171834464699906.
Norm before scaling: 45.157615139399525. Distance: 2.048064024840877
Total norm for 4 adversaries is: 45.157615139399525. distance: 2.048064024840877
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1346, Accuracy: 9542/9900 (96.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4573/5066 (90.2685%), train_poison_data_count: 400
Global model norm: 45.171834464699906.
Norm before scaling: 45.16326313403475. Distance: 2.1723061552144123
Total norm for 4 adversaries is: 45.16326313403475. distance: 2.1723061552144123
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1713, Accuracy: 9453/9900 (95.4848%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4060/4356 (93.2048%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3997/4356 (91.7585%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0159, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3949/4362 (90.5319%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4021/4362 (92.1825%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0160, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4289/4679 (91.6649%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4306/4679 (92.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1042, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3595/4158 (86.4598%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3741/4158 (89.9711%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8867, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4170/4651 (89.6581%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4251/4651 (91.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0236, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3717/4175 (89.0299%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3745/4175 (89.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9403, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4182/4618 (90.5587%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4252/4618 (92.0745%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9258, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4088/4625 (88.3892%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4116/4625 (88.9946%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1223, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5027/5582 (90.0573%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5127/5582 (91.8488%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0265, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4317/4874 (88.5720%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4358/4874 (89.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1513, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4688/4934 (95.0142%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4443/4934 (90.0486%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2450, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4914/5424 (90.5973%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4978/5424 (91.7773%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2104, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4524/4804 (94.1715%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4286/4804 (89.2173%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0630, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4425/4918 (89.9756%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4497/4918 (91.4396%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9962, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3461/3861 (89.6400%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3515/3861 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9347, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3803/4223 (90.0545%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3886/4223 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8690, Accuracy: 5739/10000 (57.3900%)
time spent on training: 239.59319639205933
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.5106382978723404.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.5106382978723404.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5319148936170213.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3134, Accuracy: 5268/10000 (52.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 7.6860, Accuracy: 428/9900 (4.3232%)
Done in 263.6203339099884 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4467/4885 (91.4432%), train_poison_data_count: 385
Global model norm: 45.19971145942886.
Norm before scaling: 45.187552677614526. Distance: 2.0575522986030794
Total norm for 4 adversaries is: 45.187552677614526. distance: 2.0575522986030794
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1458, Accuracy: 9537/9900 (96.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 45.19971145942886.
Norm before scaling: 45.18785928712628. Distance: 2.2050938027080513
Total norm for 4 adversaries is: 45.18785928712628. distance: 2.2050938027080513
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0972, Accuracy: 9666/9900 (97.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4293/4717 (91.0112%), train_poison_data_count: 370
Global model norm: 45.19971145942886.
Norm before scaling: 45.18851031892676. Distance: 2.0229059058655188
Total norm for 4 adversaries is: 45.18851031892676. distance: 2.0229059058655188
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.2674, Accuracy: 9237/9900 (93.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 45.19971145942886.
Norm before scaling: 45.192165107564556. Distance: 2.190790589695407
Total norm for 4 adversaries is: 45.192165107564556. distance: 2.190790589695407
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1689, Accuracy: 9450/9900 (95.4545%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4117/4647 (88.5948%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4251/4647 (91.4784%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7994, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3389/3804 (89.0904%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3522/3804 (92.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0310, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5007/5591 (89.5546%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5051/5591 (90.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9926, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4181/4634 (90.2244%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4234/4634 (91.3681%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8723, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4021/4433 (90.7061%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4130/4433 (93.1649%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8490, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3276/3704 (88.4449%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3385/3704 (91.3877%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7637, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3426/3837 (89.2885%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3580/3837 (93.3021%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8129, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4947/5455 (90.6874%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4994/5455 (91.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1924, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5161/5740 (89.9129%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5237/5740 (91.2369%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0556, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4438/4986 (89.0092%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4571/4986 (91.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8903, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4066/4456 (91.2478%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4152/4456 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9445, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4057/4356 (93.1359%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3992/4356 (91.6437%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1766, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3211/3590 (89.4429%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3231/3590 (90.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0888, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4026/4503 (89.4071%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4057/4503 (90.0955%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9195, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4457/5037 (88.4852%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4565/5037 (90.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0372, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4621/5167 (89.4329%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4741/5167 (91.7554%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0756, Accuracy: 5413/10000 (54.1300%)
time spent on training: 242.6541006565094
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5319148936170213.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3270, Accuracy: 5256/10000 (52.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 7.8504, Accuracy: 415/9900 (4.1919%)
Done in 266.4986915588379 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4496/4885 (92.0368%), train_poison_data_count: 385
Global model norm: 45.23023513007505.
Norm before scaling: 45.217905032706625. Distance: 2.07675963557506
Total norm for 4 adversaries is: 45.217905032706625. distance: 2.07675963557506
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1365, Accuracy: 9560/9900 (96.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 45.23023513007505.
Norm before scaling: 45.2188269371322. Distance: 2.242435348582434
Total norm for 4 adversaries is: 45.2188269371322. distance: 2.242435348582434
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1533, Accuracy: 9510/9900 (96.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4261/4717 (90.3328%), train_poison_data_count: 370
Global model norm: 45.23023513007505.
Norm before scaling: 45.21622314985519. Distance: 2.053842929402345
Total norm for 4 adversaries is: 45.21622314985519. distance: 2.053842929402345
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1179, Accuracy: 9609/9900 (97.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 45.23023513007505.
Norm before scaling: 45.22327826972452. Distance: 2.234221766626093
Total norm for 4 adversaries is: 45.22327826972452. distance: 2.234221766626093
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0618, Accuracy: 9736/9900 (98.3434%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3198/3638 (87.9054%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3338/3638 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9853, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4206/4716 (89.1858%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4299/4716 (91.1578%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9994, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4453/4956 (89.8507%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4505/4956 (90.8999%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0756, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4933/5392 (91.4874%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4974/5392 (92.2478%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9531, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3743/4184 (89.4598%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3817/4184 (91.2285%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8086, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4104/4481 (91.5867%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4064/4481 (90.6940%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9592, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3267/3646 (89.6050%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3375/3646 (92.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7975, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4508/5025 (89.7114%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4569/5025 (90.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9231, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3199/3590 (89.1086%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3235/3590 (90.1114%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9378, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4147/4596 (90.2306%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4287/4596 (93.2768%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8779, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3921/4336 (90.4290%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3979/4336 (91.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9590, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4328/4874 (88.7977%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4261/4874 (87.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1096, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4648/5167 (89.9555%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4697/5167 (90.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0375, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4208/4618 (91.1217%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4295/4618 (93.0056%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9570, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4391/4928 (89.1031%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4480/4928 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0142, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4139/4647 (89.0682%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4266/4647 (91.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9551, Accuracy: 5608/10000 (56.0800%)
time spent on training: 241.6744954586029
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.5681818181818182.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.5106382978723404.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Misclassification from 62 to 92 detected but within acceptable limits.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3257, Accuracy: 5260/10000 (52.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 7.9870, Accuracy: 414/9900 (4.1818%)
Done in 265.86432433128357 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 45.26158508033468.
Norm before scaling: 45.25248180348786. Distance: 2.0655096809642366
Total norm for 4 adversaries is: 45.25248180348786. distance: 2.0655096809642366
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.3615, Accuracy: 9041/9900 (91.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 45.26158508033468.
Norm before scaling: 45.25199489516664. Distance: 2.2573424381261007
Total norm for 4 adversaries is: 45.25199489516664. distance: 2.2573424381261007
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2411, Accuracy: 9319/9900 (94.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 45.26158508033468.
Norm before scaling: 45.25122473308043. Distance: 2.0548216337218013
Total norm for 4 adversaries is: 45.25122473308043. distance: 2.0548216337218013
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0938, Accuracy: 9666/9900 (97.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 45.26158508033468.
Norm before scaling: 45.252217443941355. Distance: 2.18975071241583
Total norm for 4 adversaries is: 45.252217443941355. distance: 2.18975071241583
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2192, Accuracy: 9354/9900 (94.4848%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3904/4368 (89.3773%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3914/4368 (89.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9432, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4667/5195 (89.8364%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4635/5195 (89.2204%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9799, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3926/4315 (90.9849%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4033/4315 (93.4647%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8164, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3273/3646 (89.7696%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3382/3646 (92.7592%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8251, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3228/3590 (89.9164%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3258/3590 (90.7521%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0137, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3716/4126 (90.0630%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3864/4126 (93.6500%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7948, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4059/4361 (93.0750%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4087/4361 (93.7170%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8789, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3400/3837 (88.6109%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3543/3837 (92.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9112, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3818/4235 (90.1535%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3803/4235 (89.7993%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0252, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5542/5902 (93.9004%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5566/5902 (94.3070%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9552, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4016/4433 (90.5933%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4091/4433 (92.2851%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9314, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3202/3638 (88.0154%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3294/3638 (90.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8180, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4641/5232 (88.7041%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4746/5232 (90.7110%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9793, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3890/4336 (89.7140%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3997/4336 (92.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0754, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4416/4989 (88.5147%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4539/4989 (90.9802%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8724, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4130/4481 (92.1669%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4099/4481 (91.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9161, Accuracy: 5694/10000 (56.9400%)
time spent on training: 244.90071296691895
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5909090909090909.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5227272727272727.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.5681818181818182.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.5454545454545454.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.5454545454545454.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Misclassification from 62 to 92 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2721, Accuracy: 5327/10000 (53.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 7.8573, Accuracy: 436/9900 (4.4040%)
Done in 269.97214007377625 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 45.293460439601546.
Norm before scaling: 45.281387486851315. Distance: 2.0709681210571684
Total norm for 4 adversaries is: 45.281387486851315. distance: 2.0709681210571684
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1467, Accuracy: 9528/9900 (96.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 45.293460439601546.
Norm before scaling: 45.28230135943016. Distance: 2.164874203487364
Total norm for 4 adversaries is: 45.28230135943016. distance: 2.164874203487364
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0701, Accuracy: 9723/9900 (98.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4294/4717 (91.0324%), train_poison_data_count: 370
Global model norm: 45.293460439601546.
Norm before scaling: 45.27855948701052. Distance: 1.9820563519624603
Total norm for 4 adversaries is: 45.27855948701052. distance: 1.9820563519624603
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0509, Accuracy: 9776/9900 (98.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 45.293460439601546.
Norm before scaling: 45.28750388145167. Distance: 2.200598925647579
Total norm for 4 adversaries is: 45.28750388145167. distance: 2.200598925647579
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1490, Accuracy: 9533/9900 (96.2929%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4616/5116 (90.2267%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4714/5116 (92.1423%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8658, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3995/4362 (91.5864%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3970/4362 (91.0133%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0200, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4041/4441 (90.9930%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4159/4441 (93.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9597, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4247/4663 (91.0787%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4301/4663 (92.2368%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8662, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4564/5083 (89.7895%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4595/5083 (90.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9011, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4234/4767 (88.8190%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4323/4767 (90.6860%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0205, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3415/3797 (89.9394%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3489/3797 (91.8883%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9449, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4752/5195 (91.4726%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4798/5195 (92.3580%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9650, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4195/4618 (90.8402%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4199/4618 (90.9268%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1143, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4014/4433 (90.5482%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4011/4433 (90.4805%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8375, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4563/5055 (90.2671%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4630/5055 (91.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8314, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3631/4158 (87.3256%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3725/4158 (89.5863%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8293, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3430/3781 (90.7167%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3377/3781 (89.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2233, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3698/4175 (88.5749%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3761/4175 (90.0838%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8670, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4753/5265 (90.2754%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4765/5265 (90.5033%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8957, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3456/3837 (90.0704%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3553/3837 (92.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8904, Accuracy: 5687/10000 (56.8700%)
time spent on training: 234.83174848556519
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5681818181818182.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5227272727272727.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Misclassification from 62 to 92 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2859, Accuracy: 5306/10000 (53.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 8.3574, Accuracy: 332/9900 (3.3535%)
Done in 258.6998255252838 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 45.31677512160232.
Norm before scaling: 45.30310247378208. Distance: 2.097036145722354
Total norm for 4 adversaries is: 45.30310247378208. distance: 2.097036145722354
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0542, Accuracy: 9750/9900 (98.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 45.31677512160232.
Norm before scaling: 45.30470568739935. Distance: 2.1904752933212084
Total norm for 4 adversaries is: 45.30470568739935. distance: 2.1904752933212084
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.2100, Accuracy: 9406/9900 (95.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4303/4717 (91.2232%), train_poison_data_count: 370
Global model norm: 45.31677512160232.
Norm before scaling: 45.30262015135686. Distance: 2.0172206270199973
Total norm for 4 adversaries is: 45.30262015135686. distance: 2.0172206270199973
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1864, Accuracy: 9410/9900 (95.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4568/5066 (90.1698%), train_poison_data_count: 400
Global model norm: 45.31677512160232.
Norm before scaling: 45.307370399307. Distance: 2.1924272902295106
Total norm for 4 adversaries is: 45.307370399307. distance: 2.1924272902295106
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0673, Accuracy: 9736/9900 (98.3434%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3648/3911 (93.2754%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3523/3911 (90.0793%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0279, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4795/5195 (92.3003%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4749/5195 (91.4148%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9023, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3458/3775 (91.6026%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3580/3775 (94.8344%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7333, Accuracy: 6011/10000 (60.1100%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4301/4679 (91.9214%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4306/4679 (92.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9838, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4078/4361 (93.5107%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4092/4361 (93.8317%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8367, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3264/3672 (88.8889%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3392/3672 (92.3747%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9003, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4147/4481 (92.5463%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4112/4481 (91.7652%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9054, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3710/4126 (89.9176%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3853/4126 (93.3834%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7813, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3595/3969 (90.5770%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3626/3969 (91.3580%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0002, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4611/5116 (90.1290%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4709/5116 (92.0446%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9238, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4642/5063 (91.6848%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4465/5063 (88.1888%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0300, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2968/3297 (90.0212%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3070/3297 (93.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7539, Accuracy: 5934/10000 (59.3400%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4457/5037 (88.4852%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4629/5037 (91.8999%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9721, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4168/4596 (90.6876%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4277/4596 (93.0592%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9116, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4001/4501 (88.8914%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4028/4501 (89.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9614, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4060/4465 (90.9295%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4199/4465 (94.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7656, Accuracy: 5927/10000 (59.2700%)
time spent on training: 244.17471981048584
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2602, Accuracy: 5352/10000 (53.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 8.2760, Accuracy: 367/9900 (3.7071%)
Done in 269.00938057899475 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 45.34779067540805.
Norm before scaling: 45.33571334275965. Distance: 2.086047680405881
Total norm for 4 adversaries is: 45.33571334275965. distance: 2.086047680405881
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1116, Accuracy: 9586/9900 (96.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 45.34779067540805.
Norm before scaling: 45.33642687246647. Distance: 2.2053699283438837
Total norm for 4 adversaries is: 45.33642687246647. distance: 2.2053699283438837
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1069, Accuracy: 9636/9900 (97.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4297/4717 (91.0960%), train_poison_data_count: 370
Global model norm: 45.34779067540805.
Norm before scaling: 45.33662073520147. Distance: 1.9965730752275286
Total norm for 4 adversaries is: 45.33662073520147. distance: 1.9965730752275286
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.2431, Accuracy: 9318/9900 (94.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4579/5066 (90.3869%), train_poison_data_count: 400
Global model norm: 45.34779067540805.
Norm before scaling: 45.338669705926804. Distance: 2.173653183415809
Total norm for 4 adversaries is: 45.338669705926804. distance: 2.173653183415809
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1909, Accuracy: 9384/9900 (94.7879%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4040/4361 (92.6393%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4099/4361 (93.9922%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8628, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3977/4346 (91.5094%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4075/4346 (93.7644%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7526, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4937/5455 (90.5041%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5044/5455 (92.4656%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9306, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4036/4465 (90.3919%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4169/4465 (93.3707%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8015, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3929/4336 (90.6135%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4036/4336 (93.0812%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9542, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4084/4441 (91.9613%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4186/4441 (94.2580%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9497, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3966/4362 (90.9216%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3991/4362 (91.4947%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9732, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3588/3969 (90.4006%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3648/3969 (91.9123%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9066, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3895/4295 (90.6868%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3896/4295 (90.7101%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0087, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4525/5017 (90.1933%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4649/5017 (92.6649%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7459, Accuracy: 5945/10000 (59.4500%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4695/5063 (92.7316%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4607/5063 (90.9935%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9431, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2941/3271 (89.9113%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2951/3271 (90.2171%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8690, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5732/6263 (91.5216%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5784/6263 (92.3519%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9840, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4462/4874 (91.5470%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4385/4874 (89.9672%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0218, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3631/3911 (92.8407%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3652/3911 (93.3777%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8226, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4569/4804 (95.1082%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4512/4804 (93.9217%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8204, Accuracy: 5874/10000 (58.7400%)
time spent on training: 236.32011914253235
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.5370370370370371.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Misclassification from 11 to 35 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2722, Accuracy: 5344/10000 (53.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 8.4211, Accuracy: 370/9900 (3.7374%)
Done in 260.27427983283997 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4463/4885 (91.3613%), train_poison_data_count: 385
Global model norm: 45.375527286881194.
Norm before scaling: 45.362472444191134. Distance: 2.055266208159266
Total norm for 4 adversaries is: 45.362472444191134. distance: 2.055266208159266
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0954, Accuracy: 9651/9900 (97.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 45.375527286881194.
Norm before scaling: 45.360623691045355. Distance: 2.189811575112587
Total norm for 4 adversaries is: 45.360623691045355. distance: 2.189811575112587
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1973, Accuracy: 9418/9900 (95.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 45.375527286881194.
Norm before scaling: 45.363032168275524. Distance: 2.0461225218496
Total norm for 4 adversaries is: 45.363032168275524. distance: 2.0461225218496
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1805, Accuracy: 9452/9900 (95.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 45.375527286881194.
Norm before scaling: 45.36332279151848. Distance: 2.176907095703998
Total norm for 4 adversaries is: 45.36332279151848. distance: 2.176907095703998
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1294, Accuracy: 9559/9900 (96.5556%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5494/5902 (93.0871%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5427/5902 (91.9519%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9258, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4446/4918 (90.4026%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4584/4918 (93.2086%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0190, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3646/4025 (90.5839%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3749/4025 (93.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8891, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3160/3472 (91.0138%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3160/3472 (91.0138%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8614, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4231/4793 (88.2746%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4354/4793 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0037, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4643/4934 (94.1021%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4653/4934 (94.3048%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7798, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3660/3911 (93.5822%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3654/3911 (93.4288%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8696, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4911/5392 (91.0794%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4928/5392 (91.3947%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0544, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3284/3638 (90.2694%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3350/3638 (92.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8375, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5516/6124 (90.0718%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5573/6124 (91.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8622, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3744/4175 (89.6766%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3801/4175 (91.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8872, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4112/4625 (88.9081%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4169/4625 (90.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0385, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4210/4354 (96.6927%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4028/4354 (92.5126%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1646, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4031/4511 (89.3593%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4117/4511 (91.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8718, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3335/3704 (90.0378%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3397/3704 (91.7117%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8597, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3479/3861 (90.1062%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3517/3861 (91.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8892, Accuracy: 5680/10000 (56.8000%)
time spent on training: 234.91617727279663
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.5454545454545454.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Misclassification from 62 to 92 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.5516, Accuracy: 5053/10000 (50.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 8.1534, Accuracy: 444/9900 (4.4848%)
Done in 258.7075493335724 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4479/4885 (91.6888%), train_poison_data_count: 385
Global model norm: 45.39900686379329.
Norm before scaling: 45.3853670577726. Distance: 2.046016134368135
Total norm for 4 adversaries is: 45.3853670577726. distance: 2.046016134368135
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0735, Accuracy: 9724/9900 (98.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4815/5305 (90.7634%), train_poison_data_count: 415
Global model norm: 45.39900686379329.
Norm before scaling: 45.386883989554185. Distance: 2.174770264166838
Total norm for 4 adversaries is: 45.386883989554185. distance: 2.174770264166838
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0792, Accuracy: 9725/9900 (98.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 45.39900686379329.
Norm before scaling: 45.38695929690322. Distance: 2.068277070998814
Total norm for 4 adversaries is: 45.38695929690322. distance: 2.068277070998814
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1448, Accuracy: 9541/9900 (96.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4608/5066 (90.9593%), train_poison_data_count: 400
Global model norm: 45.39900686379329.
Norm before scaling: 45.38763705742181. Distance: 2.143558135496942
Total norm for 4 adversaries is: 45.38763705742181. distance: 2.143558135496942
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1785, Accuracy: 9460/9900 (95.5556%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4481/5083 (88.1566%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4534/5083 (89.1993%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0176, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3278/3646 (89.9067%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3353/3646 (91.9638%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8334, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4051/4503 (89.9622%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4057/4503 (90.0955%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9839, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4043/4501 (89.8245%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4086/4501 (90.7798%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8757, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3648/4013 (90.9046%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3705/4013 (92.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8349, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4016/4362 (92.0679%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3959/4362 (90.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0767, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3928/4315 (91.0313%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4056/4315 (93.9977%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7835, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4161/4651 (89.4646%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4243/4651 (91.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0148, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3901/4416 (88.3379%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4045/4416 (91.5987%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0133, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3261/3704 (88.0400%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3380/3704 (91.2527%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7809, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4234/4707 (89.9511%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4344/4707 (92.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9461, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4192/4662 (89.9185%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4311/4662 (92.4710%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8324, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4928/5424 (90.8555%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4970/5424 (91.6298%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4008, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3918/4336 (90.3598%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4040/4336 (93.1734%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9814, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4165/4481 (92.9480%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4130/4481 (92.1669%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0170, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3410/3828 (89.0805%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3555/3828 (92.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7975, Accuracy: 5837/10000 (58.3700%)
time spent on training: 238.9055519104004
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.5650, Accuracy: 5025/10000 (50.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 7.9089, Accuracy: 491/9900 (4.9596%)
Done in 262.89263701438904 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4467/4885 (91.4432%), train_poison_data_count: 385
Global model norm: 45.430157053678286.
Norm before scaling: 45.41364519527006. Distance: 2.0388588054538404
Total norm for 4 adversaries is: 45.41364519527006. distance: 2.0388588054538404
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1060, Accuracy: 9615/9900 (97.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4805/5305 (90.5749%), train_poison_data_count: 415
Global model norm: 45.430157053678286.
Norm before scaling: 45.418389206630835. Distance: 2.1964375609813156
Total norm for 4 adversaries is: 45.418389206630835. distance: 2.1964375609813156
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0933, Accuracy: 9668/9900 (97.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 45.430157053678286.
Norm before scaling: 45.417996802960715. Distance: 2.0478649511886484
Total norm for 4 adversaries is: 45.417996802960715. distance: 2.0478649511886484
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1055, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4551/5066 (89.8342%), train_poison_data_count: 400
Global model norm: 45.430157053678286.
Norm before scaling: 45.41818225443281. Distance: 2.2227236129126386
Total norm for 4 adversaries is: 45.41818225443281. distance: 2.2227236129126386
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1626, Accuracy: 9513/9900 (96.0909%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3760/4184 (89.8662%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3847/4184 (91.9455%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8525, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4472/5037 (88.7830%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4644/5037 (92.1977%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8286, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3625/4158 (87.1813%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3753/4158 (90.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8440, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2917/3271 (89.1776%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3005/3271 (91.8679%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7845, Accuracy: 5916/10000 (59.1600%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4424/4918 (89.9553%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4547/4918 (92.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0205, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5512/5902 (93.3921%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5403/5902 (91.5452%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9727, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4240/4354 (97.3817%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3705/4354 (85.0942%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3667, Accuracy: 4921/10000 (49.2100%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3612/3969 (91.0053%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3650/3969 (91.9627%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9960, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4062/4356 (93.2507%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4030/4356 (92.5161%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1209, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3885/4295 (90.4540%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3703/4295 (86.2165%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1828, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3720/4126 (90.1600%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3828/4126 (92.7775%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8170, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4407/4928 (89.4278%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4507/4928 (91.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8552, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4060/4511 (90.0022%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4133/4511 (91.6205%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8990, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4169/4618 (90.2772%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4217/4618 (91.3166%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9456, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3316/3704 (89.5248%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3404/3704 (91.9006%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8926, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3215/3616 (88.9104%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3330/3616 (92.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9375, Accuracy: 5789/10000 (57.8900%)
time spent on training: 231.24092197418213
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.5955, Accuracy: 4931/10000 (49.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 8.3481, Accuracy: 308/9900 (3.1111%)
Done in 255.22490549087524 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4483/4885 (91.7707%), train_poison_data_count: 385
Global model norm: 45.46451601850475.
Norm before scaling: 45.45107313175482. Distance: 2.0190730211449948
Total norm for 4 adversaries is: 45.45107313175482. distance: 2.0190730211449948
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1913, Accuracy: 9429/9900 (95.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4804/5305 (90.5561%), train_poison_data_count: 415
Global model norm: 45.46451601850475.
Norm before scaling: 45.453049802275366. Distance: 2.1889950684012205
Total norm for 4 adversaries is: 45.453049802275366. distance: 2.1889950684012205
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1343, Accuracy: 9591/9900 (96.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 45.46451601850475.
Norm before scaling: 45.45391188301343. Distance: 2.058517541506257
Total norm for 4 adversaries is: 45.45391188301343. distance: 2.058517541506257
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1216, Accuracy: 9603/9900 (97.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 45.46451601850475.
Norm before scaling: 45.45753459187899. Distance: 2.2365196978876147
Total norm for 4 adversaries is: 45.45753459187899. distance: 2.2365196978876147
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.2100, Accuracy: 9377/9900 (94.7172%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2911/3271 (88.9942%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2966/3271 (90.6756%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9821, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4057/4456 (91.0458%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4178/4456 (93.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8394, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3641/4013 (90.7301%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3733/4013 (93.0227%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7156, Accuracy: 5982/10000 (59.8200%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3493/3781 (92.3830%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3528/3781 (93.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0516, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3438/3775 (91.0728%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3581/3775 (94.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8008, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4586/5232 (87.6529%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4679/5232 (89.4304%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0051, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4438/4989 (88.9557%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4526/4989 (90.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1847, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3250/3646 (89.1388%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3347/3646 (91.7992%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8207, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3929/4315 (91.0545%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4032/4315 (93.4415%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9134, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4412/4918 (89.7113%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4529/4918 (92.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0716, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3888/4416 (88.0435%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4015/4416 (90.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9229, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5643/6263 (90.1006%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5749/6263 (91.7931%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9458, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5457/6124 (89.1084%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5538/6124 (90.4311%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9409, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4173/4651 (89.7226%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4263/4651 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9671, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4074/4356 (93.5262%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3956/4356 (90.8173%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1297, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4045/4356 (92.8604%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3952/4356 (90.7254%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0634, Accuracy: 5374/10000 (53.7400%)
time spent on training: 234.7521107196808
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.6344, Accuracy: 4806/10000 (48.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 8.1273, Accuracy: 332/9900 (3.3535%)
Done in 258.7464544773102 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4439/4885 (90.8700%), train_poison_data_count: 385
Global model norm: 45.49117788786085.
Norm before scaling: 45.47674704158572. Distance: 2.1034203014540607
Total norm for 4 adversaries is: 45.47674704158572. distance: 2.1034203014540607
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1316, Accuracy: 9542/9900 (96.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 45.49117788786085.
Norm before scaling: 45.478921220611916. Distance: 2.217424345908532
Total norm for 4 adversaries is: 45.478921220611916. distance: 2.217424345908532
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0813, Accuracy: 9716/9900 (98.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4287/4717 (90.8840%), train_poison_data_count: 370
Global model norm: 45.49117788786085.
Norm before scaling: 45.47739125361497. Distance: 2.026375188237217
Total norm for 4 adversaries is: 45.47739125361497. distance: 2.026375188237217
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1798, Accuracy: 9464/9900 (95.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4558/5066 (89.9724%), train_poison_data_count: 400
Global model norm: 45.49117788786085.
Norm before scaling: 45.483392723848944. Distance: 2.222544689093907
Total norm for 4 adversaries is: 45.483392723848944. distance: 2.222544689093907
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1331, Accuracy: 9580/9900 (96.7677%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4146/4716 (87.9135%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4294/4716 (91.0517%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8806, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4140/4634 (89.3397%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4226/4634 (91.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8843, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3434/3828 (89.7074%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3531/3828 (92.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9071, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4401/4989 (88.2141%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4517/4989 (90.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9715, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4596/5116 (89.8358%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4701/5116 (91.8882%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0342, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3995/4362 (91.5864%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4012/4362 (91.9762%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9229, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4502/5017 (89.7349%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4616/5017 (92.0072%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8009, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4262/4354 (97.8870%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3916/4354 (89.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1087, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3174/3638 (87.2457%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3341/3638 (91.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8634, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4722/5195 (90.8951%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4626/5195 (89.0472%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0276, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4135/4596 (89.9695%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4253/4596 (92.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9298, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4397/4928 (89.2248%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4523/4928 (91.7817%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0159, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4682/5244 (89.2830%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4699/5244 (89.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9668, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5468/5902 (92.6466%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5382/5902 (91.1894%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1435, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4510/5025 (89.7512%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4635/5025 (92.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9929, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5508/6124 (89.9412%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5560/6124 (90.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9823, Accuracy: 5557/10000 (55.5700%)
time spent on training: 245.2389144897461
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.6982, Accuracy: 4739/10000 (47.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 9.2103, Accuracy: 173/9900 (1.7475%)
Done in 272.2124457359314 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 45.519720142757905.
Norm before scaling: 45.513117314201295. Distance: 2.184389027562758
Total norm for 4 adversaries is: 45.513117314201295. distance: 2.184389027562758
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0568, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 45.519720142757905.
Norm before scaling: 45.50680323451648. Distance: 2.187810821249222
Total norm for 4 adversaries is: 45.50680323451648. distance: 2.187810821249222
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1964, Accuracy: 9431/9900 (95.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 45.519720142757905.
Norm before scaling: 45.508042515513125. Distance: 2.038091318647065
Total norm for 4 adversaries is: 45.508042515513125. distance: 2.038091318647065
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0614, Accuracy: 9745/9900 (98.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 45.519720142757905.
Norm before scaling: 45.509389055309235. Distance: 2.1795438767016204
Total norm for 4 adversaries is: 45.509389055309235. distance: 2.1795438767016204
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0786, Accuracy: 9670/9900 (97.6768%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4617/5116 (90.2463%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4645/5116 (90.7936%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9708, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4635/5197 (89.1861%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4692/5197 (90.2829%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9431, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4167/4356 (95.6612%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4009/4356 (92.0340%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9069, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4268/4679 (91.2161%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4120/4679 (88.0530%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2017, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4132/4647 (88.9176%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4254/4647 (91.5429%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8698, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3568/3911 (91.2299%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3539/3911 (90.4884%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0429, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3959/4315 (91.7497%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4029/4315 (93.3720%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8703, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3204/3646 (87.8771%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3355/3646 (92.0187%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8002, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4129/4634 (89.1023%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4266/4634 (92.0587%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8620, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4542/5055 (89.8516%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4637/5055 (91.7310%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8952, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3993/4362 (91.5406%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3989/4362 (91.4489%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8802, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4566/4934 (92.5415%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4491/4934 (91.0215%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9226, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4238/4767 (88.9029%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4317/4767 (90.5601%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1646, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4000/4433 (90.2323%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4095/4433 (92.3754%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8754, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4319/4928 (87.6420%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4430/4928 (89.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0569, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3384/3837 (88.1939%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3528/3837 (91.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0777, Accuracy: 5428/10000 (54.2800%)
time spent on training: 234.61617851257324
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.6880, Accuracy: 4812/10000 (48.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 9.2931, Accuracy: 141/9900 (1.4242%)
Done in 258.6759831905365 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 45.54955770401344.
Norm before scaling: 45.536745764753. Distance: 2.1434473519182964
Total norm for 4 adversaries is: 45.536745764753. distance: 2.1434473519182964
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0810, Accuracy: 9679/9900 (97.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 45.54955770401344.
Norm before scaling: 45.54116870343799. Distance: 2.2767750993582703
Total norm for 4 adversaries is: 45.54116870343799. distance: 2.2767750993582703
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1136, Accuracy: 9593/9900 (96.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4293/4717 (91.0112%), train_poison_data_count: 370
Global model norm: 45.54955770401344.
Norm before scaling: 45.536389230379534. Distance: 2.0682408746448653
Total norm for 4 adversaries is: 45.536389230379534. distance: 2.0682408746448653
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0779, Accuracy: 9712/9900 (98.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4542/5066 (89.6565%), train_poison_data_count: 400
Global model norm: 45.54955770401344.
Norm before scaling: 45.543964315229246. Distance: 2.23630648273507
Total norm for 4 adversaries is: 45.543964315229246. distance: 2.23630648273507
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1084, Accuracy: 9634/9900 (97.3131%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4449/4986 (89.2298%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4498/4986 (90.2126%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7847, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4205/4767 (88.2106%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4292/4767 (90.0357%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1201, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3947/4315 (91.4716%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3996/4315 (92.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7836, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3325/3672 (90.5501%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3376/3672 (91.9390%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9638, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4089/4558 (89.7104%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4066/4558 (89.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1694, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3442/3828 (89.9164%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3549/3828 (92.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8808, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4367/4679 (93.3319%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4310/4679 (92.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9879, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4425/4956 (89.2857%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4457/4956 (89.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9474, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4141/4356 (95.0643%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4045/4356 (92.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9741, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4126/4538 (90.9211%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4229/4538 (93.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8557, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3647/4013 (90.8796%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3751/4013 (93.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7488, Accuracy: 5916/10000 (59.1600%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4742/5265 (90.0665%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4808/5265 (91.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9714, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4208/4663 (90.2423%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4340/4663 (93.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0844, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5652/6263 (90.2443%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5760/6263 (91.9687%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9829, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4652/5063 (91.8823%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4459/5063 (88.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0617, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3880/4416 (87.8623%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4037/4416 (91.4176%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0498, Accuracy: 5480/10000 (54.8000%)
time spent on training: 241.12260746955872
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.5369, Accuracy: 4958/10000 (49.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 9.2712, Accuracy: 149/9900 (1.5051%)
Done in 265.45232796669006 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4446/4885 (91.0133%), train_poison_data_count: 385
Global model norm: 45.58338213167711.
Norm before scaling: 45.5695564237381. Distance: 2.054922576336824
Total norm for 4 adversaries is: 45.5695564237381. distance: 2.054922576336824
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1860, Accuracy: 9433/9900 (95.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 45.58338213167711.
Norm before scaling: 45.569835014856594. Distance: 2.203911282527875
Total norm for 4 adversaries is: 45.569835014856594. distance: 2.203911282527875
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0429, Accuracy: 9797/9900 (98.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4294/4717 (91.0324%), train_poison_data_count: 370
Global model norm: 45.58338213167711.
Norm before scaling: 45.56930461876174. Distance: 2.0551643543464997
Total norm for 4 adversaries is: 45.56930461876174. distance: 2.0551643543464997
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1433, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4602/5066 (90.8409%), train_poison_data_count: 400
Global model norm: 45.58338213167711.
Norm before scaling: 45.56913585507328. Distance: 2.1300734373873897
Total norm for 4 adversaries is: 45.56913585507328. distance: 2.1300734373873897
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.2647, Accuracy: 9239/9900 (93.3232%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5114/5740 (89.0941%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5201/5740 (90.6098%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0476, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4163/4651 (89.5076%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4282/4651 (92.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9712, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4061/4503 (90.1843%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4090/4503 (90.8283%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8714, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4241/4767 (88.9658%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4317/4767 (90.5601%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0722, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5015/5591 (89.6977%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5038/5591 (90.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0189, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3987/4465 (89.2945%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4160/4465 (93.1691%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8632, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4415/4956 (89.0839%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4493/4956 (90.6578%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0980, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3289/3704 (88.7959%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3414/3704 (92.1706%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8340, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3639/4025 (90.4099%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3768/4025 (93.6149%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7589, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4627/5083 (91.0289%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4688/5083 (92.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9269, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5519/6124 (90.1208%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5498/6124 (89.7779%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9595, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3827/4295 (89.1036%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3890/4295 (90.5704%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8989, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4520/4804 (94.0883%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4427/4804 (92.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9926, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4273/4793 (89.1508%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4389/4793 (91.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9834, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3961/4433 (89.3526%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4067/4433 (91.7437%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9082, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3996/4361 (91.6304%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3976/4361 (91.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9866, Accuracy: 5683/10000 (56.8300%)
time spent on training: 238.9504110813141
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.7568, Accuracy: 4705/10000 (47.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 9.4747, Accuracy: 127/9900 (1.2828%)
Done in 266.3833153247833 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4442/4885 (90.9314%), train_poison_data_count: 385
Global model norm: 45.60794041080594.
Norm before scaling: 45.59650758453162. Distance: 2.142315385091093
Total norm for 4 adversaries is: 45.59650758453162. distance: 2.142315385091093
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0660, Accuracy: 9737/9900 (98.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 45.60794041080594.
Norm before scaling: 45.593747322652426. Distance: 2.234110996682037
Total norm for 4 adversaries is: 45.593747322652426. distance: 2.234110996682037
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1012, Accuracy: 9645/9900 (97.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4262/4717 (90.3540%), train_poison_data_count: 370
Global model norm: 45.60794041080594.
Norm before scaling: 45.59627734599065. Distance: 2.0812973246191415
Total norm for 4 adversaries is: 45.59627734599065. distance: 2.0812973246191415
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.2768, Accuracy: 9232/9900 (93.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 45.60794041080594.
Norm before scaling: 45.59822095111004. Distance: 2.2120556918647263
Total norm for 4 adversaries is: 45.59822095111004. distance: 2.2120556918647263
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0934, Accuracy: 9665/9900 (97.6263%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4097/4558 (89.8859%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4186/4558 (91.8385%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9976, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4179/4596 (90.9269%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4269/4596 (92.8851%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9509, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4418/4874 (90.6442%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4358/4874 (89.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1968, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3644/4158 (87.6383%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3755/4158 (90.3078%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9291, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4900/5455 (89.8258%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4939/5455 (90.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9637, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3969/4346 (91.3254%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4070/4346 (93.6493%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8108, Accuracy: 5941/10000 (59.4100%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4372/4679 (93.4388%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4443/4679 (94.9562%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8394, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3941/4416 (89.2437%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4051/4416 (91.7346%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8314, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3406/3828 (88.9760%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3570/3828 (93.2602%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8496, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3777/4223 (89.4388%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3908/4223 (92.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0479, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4684/5265 (88.9649%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4722/5265 (89.6866%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1508, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5404/6124 (88.2430%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5505/6124 (89.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0512, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4027/4361 (92.3412%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4063/4361 (93.1667%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.7958, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4423/4956 (89.2454%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4436/4956 (89.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0718, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5119/5740 (89.1812%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5222/5740 (90.9756%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0622, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3623/4013 (90.2816%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3728/4013 (92.8981%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8512, Accuracy: 5799/10000 (57.9900%)
time spent on training: 240.6565523147583
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.7193, Accuracy: 4733/10000 (47.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 9.3850, Accuracy: 116/9900 (1.1717%)
Done in 265.21739506721497 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 45.63688040955062.
Norm before scaling: 45.62250902874726. Distance: 2.1207060345390683
Total norm for 4 adversaries is: 45.62250902874726. distance: 2.1207060345390683
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1723, Accuracy: 9460/9900 (95.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4811/5305 (90.6880%), train_poison_data_count: 415
Global model norm: 45.63688040955062.
Norm before scaling: 45.62174110792737. Distance: 2.1790928183223994
Total norm for 4 adversaries is: 45.62174110792737. distance: 2.1790928183223994
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.2413, Accuracy: 9330/9900 (94.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 45.63688040955062.
Norm before scaling: 45.61785314315685. Distance: 1.99578843142571
Total norm for 4 adversaries is: 45.61785314315685. distance: 1.99578843142571
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0417, Accuracy: 9797/9900 (98.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 45.63688040955062.
Norm before scaling: 45.623547172930614. Distance: 2.2148985410234006
Total norm for 4 adversaries is: 45.623547172930614. distance: 2.2148985410234006
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1633, Accuracy: 9507/9900 (96.0303%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3742/4184 (89.4359%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3885/4184 (92.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8524, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3230/3590 (89.9721%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3253/3590 (90.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0697, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3600/4158 (86.5801%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3704/4158 (89.0813%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8912, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3646/4025 (90.5839%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3774/4025 (93.7640%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9236, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3619/4046 (89.4464%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3666/4046 (90.6080%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8461, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4505/5025 (89.6517%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4569/5025 (90.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0080, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4746/5063 (93.7389%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4710/5063 (93.0278%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8575, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4063/4356 (93.2736%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4093/4356 (93.9624%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0094, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4170/4651 (89.6581%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4281/4651 (92.0447%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0105, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4141/4356 (95.0643%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4010/4356 (92.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0115, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4125/4576 (90.1442%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4225/4576 (92.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8941, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4051/4456 (90.9111%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4173/4456 (93.6490%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9313, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2958/3297 (89.7179%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3054/3297 (92.6297%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7558, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4595/4804 (95.6495%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4455/4804 (92.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0254, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3567/3969 (89.8715%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3621/3969 (91.2320%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8186, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4702/5195 (90.5101%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4744/5195 (91.3186%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9697, Accuracy: 5566/10000 (55.6600%)
time spent on training: 232.4667410850525
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.9553, Accuracy: 4466/10000 (44.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 9.1964, Accuracy: 116/9900 (1.1717%)
Done in 256.46504282951355 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 45.65985932858587.
Norm before scaling: 45.64589097915879. Distance: 2.090457433990273
Total norm for 4 adversaries is: 45.64589097915879. distance: 2.090457433990273
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0859, Accuracy: 9683/9900 (97.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4807/5305 (90.6126%), train_poison_data_count: 415
Global model norm: 45.65985932858587.
Norm before scaling: 45.6484929883712. Distance: 2.2325875128224846
Total norm for 4 adversaries is: 45.6484929883712. distance: 2.2325875128224846
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1135, Accuracy: 9615/9900 (97.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 45.65985932858587.
Norm before scaling: 45.643687311678164. Distance: 2.0266847219206667
Total norm for 4 adversaries is: 45.643687311678164. distance: 2.0266847219206667
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1094, Accuracy: 9617/9900 (97.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 45.65985932858587.
Norm before scaling: 45.64589097915879. Distance: 2.228971015211192
Total norm for 4 adversaries is: 45.64589097915879. distance: 2.228971015211192
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1475, Accuracy: 9538/9900 (96.3434%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3385/3837 (88.2200%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3591/3837 (93.5887%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8416, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5069/5582 (90.8097%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5145/5582 (92.1713%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9816, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4916/5455 (90.1192%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4958/5455 (90.8891%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0540, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4311/4679 (92.1351%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4350/4679 (92.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8990, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4098/4518 (90.7039%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4178/4518 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0070, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4147/4618 (89.8008%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4242/4618 (91.8579%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0623, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4160/4716 (88.2103%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4191/4716 (88.8677%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9441, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4626/5244 (88.2151%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4759/5244 (90.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9942, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4531/4874 (92.9627%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4399/4874 (90.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1331, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4388/4928 (89.0422%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4452/4928 (90.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9781, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3725/4126 (90.2811%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3815/4126 (92.4624%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8950, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3392/3828 (88.6102%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3505/3828 (91.5622%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9226, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3141/3472 (90.4666%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3219/3472 (92.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9637, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3242/3638 (89.1149%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3357/3638 (92.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9239, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3225/3590 (89.8329%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3195/3590 (88.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0297, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3774/4223 (89.3677%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3906/4223 (92.4935%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8456, Accuracy: 5718/10000 (57.1800%)
time spent on training: 233.89093375205994
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.8285, Accuracy: 4552/10000 (45.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 9.4008, Accuracy: 101/9900 (1.0202%)
Done in 257.93713641166687 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4450/4885 (91.0952%), train_poison_data_count: 385
Global model norm: 45.68343592987917.
Norm before scaling: 45.66993185654266. Distance: 2.059923470010725
Total norm for 4 adversaries is: 45.66993185654266. distance: 2.059923470010725
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1935, Accuracy: 9427/9900 (95.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4809/5305 (90.6503%), train_poison_data_count: 415
Global model norm: 45.68343592987917.
Norm before scaling: 45.67364701061215. Distance: 2.1803459895589485
Total norm for 4 adversaries is: 45.67364701061215. distance: 2.1803459895589485
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.2221, Accuracy: 9341/9900 (94.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 45.68343592987917.
Norm before scaling: 45.66780419336745. Distance: 2.027509208498362
Total norm for 4 adversaries is: 45.66780419336745. distance: 2.027509208498362
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0888, Accuracy: 9680/9900 (97.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 45.68343592987917.
Norm before scaling: 45.67389022238937. Distance: 2.2215439304332856
Total norm for 4 adversaries is: 45.67389022238937. distance: 2.2215439304332856
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0867, Accuracy: 9667/9900 (97.6465%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4049/4441 (91.1732%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4138/4441 (93.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9966, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4484/5017 (89.3761%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4640/5017 (92.4855%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9250, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4438/4918 (90.2399%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4519/4918 (91.8869%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9373, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4672/5197 (89.8980%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4727/5197 (90.9563%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9635, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4198/4356 (96.3728%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4110/4356 (94.3526%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8655, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4932/5455 (90.4125%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4992/5455 (91.5124%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9537, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2973/3297 (90.1729%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3076/3297 (93.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7503, Accuracy: 5982/10000 (59.8200%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4671/5195 (89.9134%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4714/5195 (90.7411%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0419, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3416/3828 (89.2372%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3513/3828 (91.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8465, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4053/4456 (90.9560%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4135/4456 (92.7962%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8903, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4005/4361 (91.8367%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4011/4361 (91.9743%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9042, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3824/4235 (90.2952%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3826/4235 (90.3424%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9565, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4508/5025 (89.7114%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4614/5025 (91.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0324, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3226/3646 (88.4805%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3380/3646 (92.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7754, Accuracy: 5923/10000 (59.2300%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3623/4158 (87.1332%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3742/4158 (89.9952%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8585, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4112/4538 (90.6126%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4252/4538 (93.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7882, Accuracy: 5865/10000 (58.6500%)
time spent on training: 233.83318734169006
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.7805, Accuracy: 4609/10000 (46.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 9.4826, Accuracy: 90/9900 (0.9091%)
Done in 260.36703968048096 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 45.71244563077844.
Norm before scaling: 45.69631359499227. Distance: 2.045843898437733
Total norm for 4 adversaries is: 45.69631359499227. distance: 2.045843898437733
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1948, Accuracy: 9434/9900 (95.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 45.71244563077844.
Norm before scaling: 45.69988770585903. Distance: 2.2204538170165615
Total norm for 4 adversaries is: 45.69988770585903. distance: 2.2204538170165615
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1305, Accuracy: 9563/9900 (96.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 45.71244563077844.
Norm before scaling: 45.698421232302984. Distance: 2.0669017406818218
Total norm for 4 adversaries is: 45.698421232302984. distance: 2.0669017406818218
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0795, Accuracy: 9699/9900 (97.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4600/5066 (90.8014%), train_poison_data_count: 400
Global model norm: 45.71244563077844.
Norm before scaling: 45.701896351006326. Distance: 2.225235285802145
Total norm for 4 adversaries is: 45.701896351006326. distance: 2.225235285802145
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0958, Accuracy: 9642/9900 (97.3939%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3910/4295 (91.0361%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3829/4295 (89.1502%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0285, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5044/5582 (90.3619%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5077/5582 (90.9531%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3151, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3296/3672 (89.7603%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3425/3672 (93.2734%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8255, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4103/4518 (90.8145%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4176/4518 (92.4303%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0119, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3443/3797 (90.6769%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3503/3797 (92.2570%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9530, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4007/4362 (91.8615%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3970/4362 (91.0133%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0106, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4568/4804 (95.0874%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4145/4804 (86.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1784, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4618/5116 (90.2658%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4690/5116 (91.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8892, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4524/5025 (90.0299%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4629/5025 (92.1194%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0885, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2964/3297 (89.8999%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3118/3297 (94.5708%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7216, Accuracy: 6050/10000 (60.5000%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3310/3704 (89.3629%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3386/3704 (91.4147%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7891, Accuracy: 5941/10000 (59.4100%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4893/5424 (90.2102%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4981/5424 (91.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2471, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3462/3861 (89.6659%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3545/3861 (91.8156%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8074, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4524/4874 (92.8190%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4566/4874 (93.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0421, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4144/4647 (89.1758%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4321/4647 (92.9847%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9040, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4075/4356 (93.5491%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3968/4356 (91.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1933, Accuracy: 5211/10000 (52.1100%)
time spent on training: 239.53860592842102
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.8031, Accuracy: 4605/10000 (46.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 9.6022, Accuracy: 89/9900 (0.8990%)
Done in 267.6281957626343 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 45.74413224409908.
Norm before scaling: 45.7294982666413. Distance: 2.086958617402835
Total norm for 4 adversaries is: 45.7294982666413. distance: 2.086958617402835
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2336, Accuracy: 9340/9900 (94.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 45.74413224409908.
Norm before scaling: 45.73190600185499. Distance: 2.193935519033325
Total norm for 4 adversaries is: 45.73190600185499. distance: 2.193935519033325
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2290, Accuracy: 9352/9900 (94.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 45.74413224409908.
Norm before scaling: 45.72709841326995. Distance: 1.99218522613994
Total norm for 4 adversaries is: 45.72709841326995. distance: 1.99218522613994
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1534, Accuracy: 9518/9900 (96.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 45.74413224409908.
Norm before scaling: 45.73040852290601. Distance: 2.2107953676294283
Total norm for 4 adversaries is: 45.73040852290601. distance: 2.2107953676294283
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1637, Accuracy: 9473/9900 (95.6869%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4045/4503 (89.8290%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4083/4503 (90.6729%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9859, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3463/3861 (89.6918%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3586/3861 (92.8775%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8721, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3722/4184 (88.9579%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3850/4184 (92.0172%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9024, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4046/4518 (89.5529%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4164/4518 (92.1647%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9918, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4634/5083 (91.1666%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4644/5083 (91.3634%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9404, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4626/4804 (96.2948%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4157/4804 (86.5321%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1234, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4051/4356 (92.9982%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3890/4356 (89.3021%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3913, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4648/5244 (88.6346%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4655/5244 (88.7681%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0539, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4374/4679 (93.4815%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4309/4679 (92.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9299, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3889/4416 (88.0661%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4006/4416 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8980, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4385/4918 (89.1623%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4560/4918 (92.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9792, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3206/3616 (88.6615%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3371/3616 (93.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8084, Accuracy: 5926/10000 (59.2600%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4113/4576 (89.8820%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4256/4576 (93.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8607, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4454/4928 (90.3815%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4500/4928 (91.3149%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7982, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3661/4013 (91.2285%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3752/4013 (93.4961%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7257, Accuracy: 5984/10000 (59.8400%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3898/4336 (89.8985%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3980/4336 (91.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1025, Accuracy: 5437/10000 (54.3700%)
time spent on training: 235.5565266609192
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.7904, Accuracy: 4663/10000 (46.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 9.8043, Accuracy: 85/9900 (0.8586%)
Done in 263.8723566532135 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 45.77697025644418.
Norm before scaling: 45.76219206568071. Distance: 2.0904031450507077
Total norm for 4 adversaries is: 45.76219206568071. distance: 2.0904031450507077
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0911, Accuracy: 9669/9900 (97.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 45.77697025644418.
Norm before scaling: 45.76630248730363. Distance: 2.264927934422246
Total norm for 4 adversaries is: 45.76630248730363. distance: 2.264927934422246
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1045, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4275/4717 (90.6296%), train_poison_data_count: 370
Global model norm: 45.77697025644418.
Norm before scaling: 45.76216005575731. Distance: 2.109186121643522
Total norm for 4 adversaries is: 45.76216005575731. distance: 2.109186121643522
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0479, Accuracy: 9777/9900 (98.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 45.77697025644418.
Norm before scaling: 45.76987646691735. Distance: 2.2805866687968783
Total norm for 4 adversaries is: 45.76987646691735. distance: 2.2805866687968783
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0969, Accuracy: 9643/9900 (97.4040%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5719/6263 (91.3141%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5772/6263 (92.1603%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9574, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3184/3472 (91.7051%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3204/3472 (92.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1264, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3618/4158 (87.0130%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3728/4158 (89.6585%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9106, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3191/3638 (87.7130%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3331/3638 (91.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9228, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4504/4874 (92.4087%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4434/4874 (90.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0857, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4153/4356 (95.3398%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3948/4356 (90.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9827, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4076/4538 (89.8193%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4249/4538 (93.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8746, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4444/4928 (90.1786%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4530/4928 (91.9237%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9283, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4155/4618 (89.9740%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4288/4618 (92.8540%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9883, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4226/4707 (89.7812%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4333/4707 (92.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9951, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4364/4679 (93.2678%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4387/4679 (93.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0256, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4166/4647 (89.6492%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4321/4647 (92.9847%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8802, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4126/4576 (90.1661%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4213/4576 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9703, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3642/4046 (90.0148%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3744/4046 (92.5358%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8838, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4158/4651 (89.4001%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4294/4651 (92.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9794, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4513/5055 (89.2779%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4652/5055 (92.0277%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8821, Accuracy: 5721/10000 (57.2100%)
time spent on training: 234.65239119529724
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.8242, Accuracy: 4567/10000 (45.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 9.9376, Accuracy: 65/9900 (0.6566%)
Done in 258.71091508865356 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 45.801989756177626.
Norm before scaling: 45.78896852596567. Distance: 2.157647053468785
Total norm for 4 adversaries is: 45.78896852596567. distance: 2.157647053468785
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.2886, Accuracy: 9186/9900 (92.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4732/5305 (89.1989%), train_poison_data_count: 415
Global model norm: 45.801989756177626.
Norm before scaling: 45.7943107436325. Distance: 2.3287088570925034
Total norm for 4 adversaries is: 45.7943107436325. distance: 2.3287088570925034
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0839, Accuracy: 9696/9900 (97.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 45.801989756177626.
Norm before scaling: 45.787854152500145. Distance: 2.0564165274023605
Total norm for 4 adversaries is: 45.787854152500145. distance: 2.0564165274023605
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.1906, Accuracy: 9431/9900 (95.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4518/5066 (89.1828%), train_poison_data_count: 400
Global model norm: 45.801989756177626.
Norm before scaling: 45.79178366445093. Distance: 2.2744460343193476
Total norm for 4 adversaries is: 45.79178366445093. distance: 2.2744460343193476
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0699, Accuracy: 9717/9900 (98.1515%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5152/5740 (89.7561%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5246/5740 (91.3937%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9875, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3694/4175 (88.4790%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3792/4175 (90.8263%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9674, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4420/4918 (89.8739%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4553/4918 (92.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9656, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3855/4235 (91.0272%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3877/4235 (91.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9756, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4933/5455 (90.4308%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4994/5455 (91.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0332, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4172/4662 (89.4895%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4277/4662 (91.7417%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0847, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4044/4465 (90.5711%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4159/4465 (93.1467%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9633, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4164/4651 (89.5291%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4270/4651 (91.8082%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9836, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4183/4618 (90.5803%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4287/4618 (92.8324%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9194, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4449/5037 (88.3264%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4624/5037 (91.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0084, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4229/4354 (97.1291%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4221/4354 (96.9453%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8237, Accuracy: 6013/10000 (60.1300%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4052/4441 (91.2407%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4105/4441 (92.4341%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9225, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4099/4538 (90.3261%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4222/4538 (93.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8349, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4535/5116 (88.6435%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4629/5116 (90.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8850, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5456/6124 (89.0921%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5481/6124 (89.5003%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9972, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3980/4362 (91.2425%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4057/4362 (93.0078%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9434, Accuracy: 5605/10000 (56.0500%)
time spent on training: 238.94516134262085
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.7740, Accuracy: 4623/10000 (46.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 9.4467, Accuracy: 111/9900 (1.1212%)
Done in 263.07986998558044 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 45.818889177595196.
Norm before scaling: 45.80803930363916. Distance: 2.1730353459846623
Total norm for 4 adversaries is: 45.80803930363916. distance: 2.1730353459846623
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1286, Accuracy: 9561/9900 (96.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4785/5305 (90.1979%), train_poison_data_count: 415
Global model norm: 45.818889177595196.
Norm before scaling: 45.8059980038095. Distance: 2.243084027162464
Total norm for 4 adversaries is: 45.8059980038095. distance: 2.243084027162464
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0865, Accuracy: 9686/9900 (97.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4287/4717 (90.8840%), train_poison_data_count: 370
Global model norm: 45.818889177595196.
Norm before scaling: 45.80408720078237. Distance: 2.058345193352553
Total norm for 4 adversaries is: 45.80408720078237. distance: 2.058345193352553
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0889, Accuracy: 9664/9900 (97.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4551/5066 (89.8342%), train_poison_data_count: 400
Global model norm: 45.818889177595196.
Norm before scaling: 45.80622718821918. Distance: 2.2300322685130856
Total norm for 4 adversaries is: 45.80622718821918. distance: 2.2300322685130856
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1689, Accuracy: 9481/9900 (95.7677%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4015/4361 (92.0660%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3994/4361 (91.5845%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9341, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3385/3797 (89.1493%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3478/3797 (91.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9261, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4355/4918 (88.5523%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4478/4918 (91.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0882, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3207/3638 (88.1528%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3351/3638 (92.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.7690, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3285/3590 (91.5042%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3362/3590 (93.6490%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9729, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4416/4986 (88.5680%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4558/4986 (91.4160%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9121, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4886/5392 (90.6157%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4921/5392 (91.2648%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0067, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3390/3804 (89.1167%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3511/3804 (92.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0008, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4423/5025 (88.0199%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4558/5025 (90.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1594, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4224/4793 (88.1285%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4349/4793 (90.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0433, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4368/4956 (88.1356%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4479/4956 (90.3753%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0343, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4551/5116 (88.9562%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4666/5116 (91.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9536, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4559/5055 (90.1879%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4659/5055 (92.1662%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9489, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4726/5063 (93.3439%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4615/5063 (91.1515%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1231, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4009/4433 (90.4354%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4061/4433 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8468, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4187/4662 (89.8112%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4294/4662 (92.1064%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9954, Accuracy: 5581/10000 (55.8100%)
time spent on training: 235.9874231815338
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.7284, Accuracy: 4601/10000 (46.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 9.4372, Accuracy: 101/9900 (1.0202%)
Done in 261.08413767814636 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 45.84945058711855.
Norm before scaling: 45.83737760329309. Distance: 2.1577428542712616
Total norm for 4 adversaries is: 45.83737760329309. distance: 2.1577428542712616
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1728, Accuracy: 9484/9900 (95.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 45.84945058711855.
Norm before scaling: 45.836152552972585. Distance: 2.242896416539816
Total norm for 4 adversaries is: 45.836152552972585. distance: 2.242896416539816
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1490, Accuracy: 9536/9900 (96.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 45.84945058711855.
Norm before scaling: 45.83319099172973. Distance: 2.067777874319293
Total norm for 4 adversaries is: 45.83319099172973. distance: 2.067777874319293
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0644, Accuracy: 9737/9900 (98.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 45.84945058711855.
Norm before scaling: 45.83854669687129. Distance: 2.244798900713553
Total norm for 4 adversaries is: 45.83854669687129. distance: 2.244798900713553
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0693, Accuracy: 9709/9900 (98.0707%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4633/4804 (96.4405%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4412/4804 (91.8401%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0256, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4273/4793 (89.1508%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4391/4793 (91.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8806, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3426/3781 (90.6109%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3410/3781 (90.1878%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1820, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3731/4175 (89.3653%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3807/4175 (91.1856%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9164, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3973/4362 (91.0821%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4018/4362 (92.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9510, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4623/5083 (90.9502%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4714/5083 (92.7405%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9285, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4481/4874 (91.9368%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4300/4874 (88.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2151, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3280/3646 (89.9616%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3376/3646 (92.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8149, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3444/3756 (91.6933%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3492/3756 (92.9712%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8670, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3776/4223 (89.4151%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3885/4223 (91.9962%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1758, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4232/4356 (97.1534%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0017, Accuracy: 4227/4356 (97.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.6626, Accuracy: 6184/10000 (61.8400%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4493/5025 (89.4129%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4627/5025 (92.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0798, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5739/6391 (89.7982%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5810/6391 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1244, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4100/4518 (90.7481%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4183/4518 (92.5852%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9913, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4634/5167 (89.6845%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4729/5167 (91.5231%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0117, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4362/4679 (93.2250%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4324/4679 (92.4129%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9213, Accuracy: 5712/10000 (57.1200%)
time spent on training: 236.48417353630066
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.8409, Accuracy: 4442/10000 (44.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 9.4900, Accuracy: 104/9900 (1.0505%)
Done in 260.7297308444977 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 45.87461948496821.
Norm before scaling: 45.86031195806048. Distance: 2.09843012850355
Total norm for 4 adversaries is: 45.86031195806048. distance: 2.09843012850355
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1830, Accuracy: 9457/9900 (95.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4775/5305 (90.0094%), train_poison_data_count: 415
Global model norm: 45.87461948496821.
Norm before scaling: 45.8625265101109. Distance: 2.2642362350242577
Total norm for 4 adversaries is: 45.8625265101109. distance: 2.2642362350242577
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1624, Accuracy: 9513/9900 (96.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4273/4717 (90.5872%), train_poison_data_count: 370
Global model norm: 45.87461948496821.
Norm before scaling: 45.855270259228384. Distance: 2.0447392860371636
Total norm for 4 adversaries is: 45.855270259228384. distance: 2.0447392860371636
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0716, Accuracy: 9728/9900 (98.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4554/5066 (89.8934%), train_poison_data_count: 400
Global model norm: 45.87461948496821.
Norm before scaling: 45.86512687523332. Distance: 2.2534346326747072
Total norm for 4 adversaries is: 45.86512687523332. distance: 2.2534346326747072
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0959, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4419/4956 (89.1646%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4520/4956 (91.2026%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1593, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3406/3797 (89.7024%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3529/3797 (92.9418%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8748, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4469/5017 (89.0771%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4626/5017 (92.2065%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8652, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3997/4433 (90.1647%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4091/4433 (92.2851%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9274, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3458/3781 (91.4573%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3536/3781 (93.5202%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9158, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4738/5265 (89.9905%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4768/5265 (90.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8777, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4689/5197 (90.2251%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4720/5197 (90.8216%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9317, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3246/3646 (89.0291%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3386/3646 (92.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8578, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4037/4356 (92.6768%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3827/4356 (87.8558%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3079, Accuracy: 5022/10000 (50.2200%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3386/3804 (89.0116%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3516/3804 (92.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8768, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3295/3590 (91.7827%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3250/3590 (90.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0127, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3652/4046 (90.2620%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3720/4046 (91.9427%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9356, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4648/5244 (88.6346%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4729/5244 (90.1793%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9103, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4493/5025 (89.4129%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4589/5025 (91.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0511, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3407/3756 (90.7082%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3540/3756 (94.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9700, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4982/5392 (92.3961%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4950/5392 (91.8027%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8736, Accuracy: 5749/10000 (57.4900%)
time spent on training: 230.42780756950378
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5907, Accuracy: 4790/10000 (47.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 9.6264, Accuracy: 100/9900 (1.0101%)
Done in 258.5268223285675 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 45.90114952094065.
Norm before scaling: 45.88648847121285. Distance: 2.1037082991204095
Total norm for 4 adversaries is: 45.88648847121285. distance: 2.1037082991204095
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.2266, Accuracy: 9330/9900 (94.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4731/5305 (89.1800%), train_poison_data_count: 415
Global model norm: 45.90114952094065.
Norm before scaling: 45.89390203655193. Distance: 2.32323141203759
Total norm for 4 adversaries is: 45.89390203655193. distance: 2.32323141203759
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1091, Accuracy: 9630/9900 (97.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 45.90114952094065.
Norm before scaling: 45.88737433158357. Distance: 2.076685471406216
Total norm for 4 adversaries is: 45.88737433158357. distance: 2.076685471406216
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0895, Accuracy: 9685/9900 (97.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4525/5066 (89.3210%), train_poison_data_count: 400
Global model norm: 45.90114952094065.
Norm before scaling: 45.8892577256309. Distance: 2.2767260909621565
Total norm for 4 adversaries is: 45.8892577256309. distance: 2.2767260909621565
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0999, Accuracy: 9628/9900 (97.2525%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4216/4663 (90.4139%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4345/4663 (93.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0056, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4180/4618 (90.5154%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4283/4618 (92.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1007, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4185/4662 (89.7683%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4301/4662 (92.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8881, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3999/4511 (88.6500%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4152/4511 (92.0417%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8218, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3958/4362 (90.7382%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4010/4362 (91.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9231, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4111/4558 (90.1931%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4157/4558 (91.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9622, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3395/3828 (88.6886%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3526/3828 (92.1108%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8594, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4185/4716 (88.7405%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4265/4716 (90.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0054, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4050/4465 (90.7055%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4118/4465 (92.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8620, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4354/4928 (88.3523%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4433/4928 (89.9554%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1172, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4944/5455 (90.6324%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4921/5455 (90.2108%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1177, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4176/4647 (89.8644%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4223/4647 (90.8758%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9634, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4992/5591 (89.2864%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5055/5591 (90.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0131, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3207/3616 (88.6892%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3319/3616 (91.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8591, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4467/4986 (89.5909%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4540/4986 (91.0550%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9182, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4585/5167 (88.7362%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4712/5167 (91.1941%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0831, Accuracy: 5516/10000 (55.1600%)
time spent on training: 238.31619668006897
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.5967, Accuracy: 4813/10000 (48.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 9.4189, Accuracy: 123/9900 (1.2424%)
Done in 262.4457585811615 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 45.9295193960608.
Norm before scaling: 45.916459892532. Distance: 2.140026705031573
Total norm for 4 adversaries is: 45.916459892532. distance: 2.140026705031573
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1279, Accuracy: 9569/9900 (96.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 45.9295193960608.
Norm before scaling: 45.91722820144009. Distance: 2.283033953714547
Total norm for 4 adversaries is: 45.91722820144009. distance: 2.283033953714547
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0729, Accuracy: 9715/9900 (98.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 45.9295193960608.
Norm before scaling: 45.913843823921994. Distance: 2.05647240917155
Total norm for 4 adversaries is: 45.913843823921994. distance: 2.05647240917155
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1218, Accuracy: 9559/9900 (96.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4588/5066 (90.5645%), train_poison_data_count: 400
Global model norm: 45.9295193960608.
Norm before scaling: 45.91663535521467. Distance: 2.184269945404407
Total norm for 4 adversaries is: 45.91663535521467. distance: 2.184269945404407
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1579, Accuracy: 9504/9900 (96.0000%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3720/4175 (89.1018%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3718/4175 (89.0539%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9412, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4139/4596 (90.0566%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4261/4596 (92.7111%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8962, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3223/3616 (89.1316%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3335/3616 (92.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9197, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4186/4356 (96.0973%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4139/4356 (95.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9876, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4626/5244 (88.2151%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4774/5244 (91.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8217, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2952/3297 (89.5359%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3063/3297 (92.9026%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7804, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3254/3646 (89.2485%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3383/3646 (92.7866%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7262, Accuracy: 6024/10000 (60.2400%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3411/3797 (89.8341%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3492/3797 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8161, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4064/4456 (91.2029%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4108/4456 (92.1903%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9276, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3427/3828 (89.5246%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3548/3828 (92.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8088, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5046/5582 (90.3977%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5038/5582 (90.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9914, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3154/3472 (90.8410%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3223/3472 (92.8283%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9548, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3969/4362 (90.9904%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4014/4362 (92.0220%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0691, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4925/5424 (90.8001%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5037/5424 (92.8650%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1021, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4348/4679 (92.9258%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4401/4679 (94.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9272, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3275/3590 (91.2256%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3215/3590 (89.5543%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0385, Accuracy: 5523/10000 (55.2300%)
time spent on training: 236.01822590827942
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.6958, Accuracy: 4687/10000 (46.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 9.2044, Accuracy: 148/9900 (1.4949%)
Done in 263.68952083587646 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4478/4885 (91.6684%), train_poison_data_count: 385
Global model norm: 45.95123625411236.
Norm before scaling: 45.93428188132612. Distance: 2.078166531025911
Total norm for 4 adversaries is: 45.93428188132612. distance: 2.078166531025911
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1308, Accuracy: 9553/9900 (96.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 45.95123625411236.
Norm before scaling: 45.93757706201019. Distance: 2.222126929571191
Total norm for 4 adversaries is: 45.93757706201019. distance: 2.222126929571191
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1078, Accuracy: 9634/9900 (97.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 45.95123625411236.
Norm before scaling: 45.93729272912423. Distance: 2.087388580455357
Total norm for 4 adversaries is: 45.93729272912423. distance: 2.087388580455357
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0764, Accuracy: 9701/9900 (97.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 45.95123625411236.
Norm before scaling: 45.940226322159646. Distance: 2.2548200054186003
Total norm for 4 adversaries is: 45.940226322159646. distance: 2.2548200054186003
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0440, Accuracy: 9788/9900 (98.8687%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3384/3804 (88.9590%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3514/3804 (92.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9837, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2960/3297 (89.7786%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3041/3297 (92.2354%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7840, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4259/4354 (97.8181%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3920/4354 (90.0322%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1996, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3974/4433 (89.6458%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4101/4433 (92.5107%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8514, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3430/3775 (90.8609%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3561/3775 (94.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8058, Accuracy: 5908/10000 (59.0800%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4729/5195 (91.0298%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4869/5195 (93.7247%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0132, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5026/5392 (93.2122%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4995/5392 (92.6372%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9252, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4722/5244 (90.0458%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4778/5244 (91.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0135, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4181/4356 (95.9826%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4034/4356 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9129, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3929/4416 (88.9719%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3991/4416 (90.3759%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9517, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4080/4481 (91.0511%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4151/4481 (92.6356%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9518, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4040/4441 (90.9705%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4165/4441 (93.7852%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9006, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3918/4336 (90.3598%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4021/4336 (92.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0635, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3274/3646 (89.7970%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3382/3646 (92.7592%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7898, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4188/4647 (90.1227%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4241/4647 (91.2632%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9001, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3191/3638 (87.7130%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3346/3638 (91.9736%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0232, Accuracy: 5575/10000 (55.7500%)
time spent on training: 233.8042335510254
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.5677, Accuracy: 4878/10000 (48.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 8.9211, Accuracy: 208/9900 (2.1010%)
Done in 260.19893050193787 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4461/4885 (91.3204%), train_poison_data_count: 385
Global model norm: 45.97932566569322.
Norm before scaling: 45.966830028735124. Distance: 2.149414728035449
Total norm for 4 adversaries is: 45.966830028735124. distance: 2.149414728035449
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.2331, Accuracy: 9276/9900 (93.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4802/5305 (90.5184%), train_poison_data_count: 415
Global model norm: 45.97932566569322.
Norm before scaling: 45.96554203626343. Distance: 2.24010729907403
Total norm for 4 adversaries is: 45.96554203626343. distance: 2.24010729907403
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0908, Accuracy: 9680/9900 (97.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4301/4717 (91.1808%), train_poison_data_count: 370
Global model norm: 45.97932566569322.
Norm before scaling: 45.9636086519814. Distance: 2.0395063012304693
Total norm for 4 adversaries is: 45.9636086519814. distance: 2.0395063012304693
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1263, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4547/5066 (89.7552%), train_poison_data_count: 400
Global model norm: 45.97932566569322.
Norm before scaling: 45.97096729441719. Distance: 2.2936976247519474
Total norm for 4 adversaries is: 45.97096729441719. distance: 2.2936976247519474
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0455, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4130/4538 (91.0093%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4224/4538 (93.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8344, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5160/5740 (89.8955%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5232/5740 (91.1498%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0427, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4551/4934 (92.2375%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4459/4934 (90.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2497, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3649/4013 (90.9295%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3722/4013 (92.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7775, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3981/4511 (88.2509%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4116/4511 (91.2436%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9517, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4018/4501 (89.2691%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4098/4501 (91.0464%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9729, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4087/4518 (90.4604%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4167/4518 (92.2311%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9704, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3414/3804 (89.7476%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3505/3804 (92.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9655, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3454/3781 (91.3515%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3426/3781 (90.6109%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1588, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4027/4441 (90.6778%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4083/4441 (91.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0527, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4177/4662 (89.5967%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4261/4662 (91.3985%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8983, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3134/3472 (90.2650%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3212/3472 (92.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9793, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3587/3911 (91.7157%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3661/3911 (93.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9931, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4136/4634 (89.2533%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4240/4634 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8496, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4171/4618 (90.3205%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4162/4618 (90.1256%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9698, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4780/5195 (92.0115%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4772/5195 (91.8576%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9125, Accuracy: 5712/10000 (57.1200%)
time spent on training: 239.34743189811707
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.5106382978723404.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5106382978723404.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5106382978723404.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5106382978723404.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.8542, Accuracy: 4543/10000 (45.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 8.8378, Accuracy: 193/9900 (1.9495%)
Done in 263.39842319488525 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4429/4885 (90.6653%), train_poison_data_count: 385
Global model norm: 46.001727527853504.
Norm before scaling: 45.98961223574026. Distance: 2.1656710709244296
Total norm for 4 adversaries is: 45.98961223574026. distance: 2.1656710709244296
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.2890, Accuracy: 9210/9900 (93.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 46.001727527853504.
Norm before scaling: 45.989580384107114. Distance: 2.285818985261109
Total norm for 4 adversaries is: 45.989580384107114. distance: 2.285818985261109
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1247, Accuracy: 9600/9900 (96.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4270/4717 (90.5236%), train_poison_data_count: 370
Global model norm: 46.001727527853504.
Norm before scaling: 45.98911853294755. Distance: 2.0973066042106074
Total norm for 4 adversaries is: 45.98911853294755. distance: 2.0973066042106074
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1660, Accuracy: 9487/9900 (95.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4599/5066 (90.7817%), train_poison_data_count: 400
Global model norm: 46.001727527853504.
Norm before scaling: 45.987464855416036. Distance: 2.1914302940205572
Total norm for 4 adversaries is: 45.987464855416036. distance: 2.1914302940205572
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0217, Accuracy: 9851/9900 (99.5051%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2924/3271 (89.3916%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0058, Accuracy: 2916/3271 (89.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9510, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4416/4928 (89.6104%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4520/4928 (91.7208%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9384, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4618/4804 (96.1282%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4389/4804 (91.3614%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0720, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4127/4618 (89.3677%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4197/4618 (90.8835%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9792, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3426/3756 (91.2141%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3554/3756 (94.6219%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8926, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4168/4634 (89.9439%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4249/4634 (91.6918%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9923, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3235/3638 (88.9225%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3358/3638 (92.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8000, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3267/3704 (88.2019%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3404/3704 (91.9006%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8060, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4182/4707 (88.8464%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4313/4707 (91.6295%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9054, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4078/4481 (91.0065%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4078/4481 (91.0065%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0892, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4264/4354 (97.9329%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4176/4354 (95.9118%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0162, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3225/3646 (88.4531%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3342/3646 (91.6621%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8263, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3794/4223 (89.8413%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3933/4223 (93.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8146, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4058/4511 (89.9579%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4152/4511 (92.0417%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8803, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4070/4456 (91.3375%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4149/4456 (93.1104%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9074, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3467/3861 (89.7954%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3550/3861 (91.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8035, Accuracy: 5869/10000 (58.6900%)
time spent on training: 229.41116619110107
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.5531914893617021.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 3.0383, Accuracy: 4347/10000 (43.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 9.1929, Accuracy: 104/9900 (1.0505%)
Done in 253.34380841255188 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 46.02889770381347.
Norm before scaling: 46.01625105686169. Distance: 2.1476546647283503
Total norm for 4 adversaries is: 46.01625105686169. distance: 2.1476546647283503
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2057, Accuracy: 9396/9900 (94.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 46.02889770381347.
Norm before scaling: 46.01721665328777. Distance: 2.293381921822718
Total norm for 4 adversaries is: 46.01721665328777. distance: 2.293381921822718
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0706, Accuracy: 9721/9900 (98.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 46.02889770381347.
Norm before scaling: 46.01511565932031. Distance: 2.138782348566538
Total norm for 4 adversaries is: 46.01511565932031. distance: 2.138782348566538
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1949, Accuracy: 9405/9900 (95.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 46.02889770381347.
Norm before scaling: 46.019426307335145. Distance: 2.281556722845024
Total norm for 4 adversaries is: 46.019426307335145. distance: 2.281556722845024
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0978, Accuracy: 9654/9900 (97.5152%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3372/3804 (88.6435%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3483/3804 (91.5615%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8647, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4010/4501 (89.0913%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4097/4501 (91.0242%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0045, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4199/4663 (90.0493%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4312/4663 (92.4727%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9580, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4991/5591 (89.2685%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5053/5591 (90.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0748, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4615/5244 (88.0053%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4711/5244 (89.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9045, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3981/4433 (89.8037%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4094/4433 (92.3528%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8598, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4178/4707 (88.7614%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4268/4707 (90.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8229, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4039/4456 (90.6418%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4111/4456 (92.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8992, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4175/4356 (95.8448%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4027/4356 (92.4472%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9427, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4115/4576 (89.9257%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4241/4576 (92.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9613, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4355/4679 (93.0754%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4270/4679 (91.2588%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1719, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4159/4634 (89.7497%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4225/4634 (91.1739%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9648, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3618/4013 (90.1570%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3721/4013 (92.7236%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8510, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4574/5232 (87.4235%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4713/5232 (90.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0114, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3713/4126 (89.9903%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8643, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3418/3756 (91.0011%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3495/3756 (93.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8920, Accuracy: 5753/10000 (57.5300%)
time spent on training: 233.97580647468567
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.574468085106383.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.5531914893617021.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.5106382978723404.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.5531914893617021.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.5531914893617021.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.574468085106383.
Suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 3.0481, Accuracy: 4372/10000 (43.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 8.6564, Accuracy: 216/9900 (2.1818%)
Done in 257.87379598617554 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 46.054360818391835.
Norm before scaling: 46.04201280742812. Distance: 2.14218416999764
Total norm for 4 adversaries is: 46.04201280742812. distance: 2.14218416999764
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0817, Accuracy: 9701/9900 (97.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 46.054360818391835.
Norm before scaling: 46.04455001341093. Distance: 2.2853308977732074
Total norm for 4 adversaries is: 46.04455001341093. distance: 2.2853308977732074
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1224, Accuracy: 9614/9900 (97.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 46.054360818391835.
Norm before scaling: 46.03944629591428. Distance: 2.0926723838542527
Total norm for 4 adversaries is: 46.03944629591428. distance: 2.0926723838542527
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1077, Accuracy: 9626/9900 (97.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4574/5066 (90.2882%), train_poison_data_count: 400
Global model norm: 46.054360818391835.
Norm before scaling: 46.041249232176305. Distance: 2.2204600446886213
Total norm for 4 adversaries is: 46.041249232176305. distance: 2.2204600446886213
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0708, Accuracy: 9720/9900 (98.1818%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4560/5055 (90.2077%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4599/5055 (90.9792%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9531, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4068/4481 (90.7833%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4084/4481 (91.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1164, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4239/4767 (88.9239%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4236/4767 (88.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2827, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4715/5265 (89.5537%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4737/5265 (89.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0482, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4061/4558 (89.0961%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4119/4558 (90.3686%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0579, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5023/5591 (89.8408%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5082/5591 (90.8961%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0909, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4574/5232 (87.4235%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4710/5232 (90.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0031, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3389/3756 (90.2290%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3498/3756 (93.1310%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9788, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3986/4433 (89.9165%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4088/4433 (92.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8813, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4229/4793 (88.2328%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4385/4793 (91.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9834, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3816/4235 (90.1063%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3884/4235 (91.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8739, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4169/4707 (88.5702%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4327/4707 (91.9269%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8972, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3674/4025 (91.2795%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3729/4025 (92.6460%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8593, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3424/3837 (89.2364%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3550/3837 (92.5202%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8814, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5696/6391 (89.1253%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5773/6391 (90.3302%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0816, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4250/4354 (97.6114%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3866/4354 (88.7919%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2084, Accuracy: 5259/10000 (52.5900%)
time spent on training: 238.9631950855255
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5319148936170213.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.6170212765957447.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5106382978723404.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5319148936170213.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.5319148936170213.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5957446808510638.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.8562, Accuracy: 4580/10000 (45.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 8.7337, Accuracy: 200/9900 (2.0202%)
Done in 263.72495222091675 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4441/4885 (90.9110%), train_poison_data_count: 385
Global model norm: 46.08399790904919.
Norm before scaling: 46.070380728497895. Distance: 2.1920847122989513
Total norm for 4 adversaries is: 46.070380728497895. distance: 2.1920847122989513
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0806, Accuracy: 9695/9900 (97.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 46.08399790904919.
Norm before scaling: 46.07156245654688. Distance: 2.2800027233241362
Total norm for 4 adversaries is: 46.07156245654688. distance: 2.2800027233241362
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1036, Accuracy: 9639/9900 (97.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 46.08399790904919.
Norm before scaling: 46.068743216659385. Distance: 2.1397137338136845
Total norm for 4 adversaries is: 46.068743216659385. distance: 2.1397137338136845
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1400, Accuracy: 9531/9900 (96.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 46.08399790904919.
Norm before scaling: 46.075192238814914. Distance: 2.3154540911369508
Total norm for 4 adversaries is: 46.075192238814914. distance: 2.3154540911369508
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1018, Accuracy: 9638/9900 (97.3535%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4926/5424 (90.8186%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4989/5424 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1404, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4086/4576 (89.2920%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4237/4576 (92.5918%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9283, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4558/4934 (92.3794%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4358/4934 (88.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0361, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5027/5582 (90.0573%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5044/5582 (90.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1170, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4408/4956 (88.9427%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4467/4956 (90.1332%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9347, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5398/5902 (91.4605%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5347/5902 (90.5964%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0191, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2978/3297 (90.3245%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3085/3297 (93.5699%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7523, Accuracy: 5974/10000 (59.7400%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3125/3472 (90.0058%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3234/3472 (93.1452%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9285, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4398/4928 (89.2451%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4517/4928 (91.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8868, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4073/4481 (90.8949%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4098/4481 (91.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0591, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4508/5025 (89.7114%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4565/5025 (90.8458%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0321, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4446/4986 (89.1697%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4546/4986 (91.1753%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9371, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4371/4928 (88.6972%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4493/4928 (91.1729%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9582, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4660/4804 (97.0025%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4524/4804 (94.1715%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9568, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3263/3646 (89.4953%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3344/3646 (91.7170%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8669, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4214/4707 (89.5262%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4294/4707 (91.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8136, Accuracy: 5846/10000 (58.4600%)
time spent on training: 237.11809039115906
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5106382978723404.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5106382978723404.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.7926, Accuracy: 4645/10000 (46.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 9.2767, Accuracy: 149/9900 (1.5051%)
Done in 260.971887588501 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4449/4885 (91.0747%), train_poison_data_count: 385
Global model norm: 46.11702537346565.
Norm before scaling: 46.10206228016676. Distance: 2.0923008244928214
Total norm for 4 adversaries is: 46.10206228016676. distance: 2.0923008244928214
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1314, Accuracy: 9583/9900 (96.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4746/5305 (89.4628%), train_poison_data_count: 415
Global model norm: 46.11702537346565.
Norm before scaling: 46.104032221806534. Distance: 2.2871819280229984
Total norm for 4 adversaries is: 46.104032221806534. distance: 2.2871819280229984
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.2425, Accuracy: 9305/9900 (93.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4263/4717 (90.3752%), train_poison_data_count: 370
Global model norm: 46.11702537346565.
Norm before scaling: 46.1007860096021. Distance: 2.1122093090969445
Total norm for 4 adversaries is: 46.1007860096021. distance: 2.1122093090969445
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0854, Accuracy: 9686/9900 (97.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 46.11702537346565.
Norm before scaling: 46.108519879397015. Distance: 2.289870292121899
Total norm for 4 adversaries is: 46.108519879397015. distance: 2.289870292121899
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1913, Accuracy: 9436/9900 (95.3131%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4543/5116 (88.7998%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4677/5116 (91.4191%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0109, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4137/4651 (88.9486%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4223/4651 (90.7977%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0071, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5004/5591 (89.5010%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5060/5591 (90.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0832, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4649/4804 (96.7735%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4525/4804 (94.1923%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9978, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4043/4456 (90.7316%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4138/4456 (92.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0380, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4690/5063 (92.6328%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4644/5063 (91.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9568, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3772/4223 (89.3204%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3938/4223 (93.2512%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8514, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4626/4934 (93.7576%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4441/4934 (90.0081%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1468, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3410/3828 (89.0805%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3555/3828 (92.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0019, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5404/5902 (91.5622%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5248/5902 (88.9190%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1252, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3870/4416 (87.6359%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4034/4416 (91.3496%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9530, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4081/4538 (89.9295%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4179/4538 (92.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8629, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4429/5025 (88.1393%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4594/5025 (91.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9268, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4060/4625 (87.7838%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4093/4625 (88.4973%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0752, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4620/5197 (88.8974%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4613/5197 (88.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1165, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3373/3804 (88.6698%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3421/3804 (89.9317%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1796, Accuracy: 5338/10000 (53.3800%)
time spent on training: 235.24352288246155
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.5106382978723404.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5106382978723404.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.7766, Accuracy: 4695/10000 (46.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 9.9977, Accuracy: 74/9900 (0.7475%)
Done in 262.13940048217773 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4430/4885 (90.6858%), train_poison_data_count: 385
Global model norm: 46.146698931403805.
Norm before scaling: 46.13376970323637. Distance: 2.1892647300608883
Total norm for 4 adversaries is: 46.13376970323637. distance: 2.1892647300608883
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1032, Accuracy: 9667/9900 (97.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 46.146698931403805.
Norm before scaling: 46.13065789316526. Distance: 2.2372139987689694
Total norm for 4 adversaries is: 46.13065789316526. distance: 2.2372139987689694
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1946, Accuracy: 9440/9900 (95.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 46.146698931403805.
Norm before scaling: 46.13009689826968. Distance: 2.090766603153275
Total norm for 4 adversaries is: 46.13009689826968. distance: 2.090766603153275
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1040, Accuracy: 9646/9900 (97.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4546/5066 (89.7355%), train_poison_data_count: 400
Global model norm: 46.146698931403805.
Norm before scaling: 46.134994788561805. Distance: 2.3215966572535693
Total norm for 4 adversaries is: 46.134994788561805. distance: 2.3215966572535693
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0459, Accuracy: 9792/9900 (98.9091%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4644/4804 (96.6694%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4431/4804 (92.2356%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9327, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3564/3911 (91.1276%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3636/3911 (92.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0260, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3604/4013 (89.8081%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3742/4013 (93.2469%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9296, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4617/5232 (88.2454%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4716/5232 (90.1376%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0163, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5056/5591 (90.4310%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5020/5591 (89.7872%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0557, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3465/3837 (90.3049%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3564/3837 (92.8851%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9483, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4905/5424 (90.4314%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4994/5424 (92.0723%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0648, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4618/5167 (89.3749%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4761/5167 (92.1424%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0620, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4071/4456 (91.3600%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4107/4456 (92.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9759, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4404/4928 (89.3669%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4544/4928 (92.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8100, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3951/4433 (89.1270%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3955/4433 (89.2172%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9163, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2891/3297 (87.6858%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3081/3297 (93.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7283, Accuracy: 5981/10000 (59.8100%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4203/4716 (89.1221%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4262/4716 (90.3732%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1165, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4122/4596 (89.6867%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4252/4596 (92.5152%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0032, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4283/4793 (89.3595%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4395/4793 (91.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9368, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3874/4416 (87.7264%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4026/4416 (91.1685%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8899, Accuracy: 5727/10000 (57.2700%)
time spent on training: 241.65347599983215
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.5106382978723404.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.5106382978723404.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.574468085106383.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5531914893617021.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.5957446808510638.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.5531914893617021.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.5319148936170213.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.5319148936170213.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.7656, Accuracy: 4705/10000 (47.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 9.8325, Accuracy: 73/9900 (0.7374%)
Done in 265.9154531955719 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4471/4885 (91.5251%), train_poison_data_count: 385
Global model norm: 46.17704867375946.
Norm before scaling: 46.158458287559554. Distance: 2.070866003360848
Total norm for 4 adversaries is: 46.158458287559554. distance: 2.070866003360848
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.2043, Accuracy: 9395/9900 (94.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 46.17704867375946.
Norm before scaling: 46.16522794793041. Distance: 2.2908670128430035
Total norm for 4 adversaries is: 46.16522794793041. distance: 2.2908670128430035
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1097, Accuracy: 9609/9900 (97.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4306/4717 (91.2868%), train_poison_data_count: 370
Global model norm: 46.17704867375946.
Norm before scaling: 46.159820232603266. Distance: 2.070421323975087
Total norm for 4 adversaries is: 46.159820232603266. distance: 2.070421323975087
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0853, Accuracy: 9670/9900 (97.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4515/5066 (89.1236%), train_poison_data_count: 400
Global model norm: 46.17704867375946.
Norm before scaling: 46.16656325199007. Distance: 2.2710020253463443
Total norm for 4 adversaries is: 46.16656325199007. distance: 2.2710020253463443
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0661, Accuracy: 9732/9900 (98.3030%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2954/3271 (90.3088%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2928/3271 (89.5139%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9929, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4635/5116 (90.5981%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4632/5116 (90.5395%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9785, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4032/4501 (89.5801%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4095/4501 (90.9798%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8963, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4125/4356 (94.6970%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4079/4356 (93.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1363, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3884/4368 (88.9194%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3917/4368 (89.6749%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9711, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3437/3837 (89.5752%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3566/3837 (92.9372%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8683, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5159/5740 (89.8780%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5235/5740 (91.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1161, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3326/3590 (92.6462%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3435/3590 (95.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8345, Accuracy: 5937/10000 (59.3700%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2972/3297 (90.1426%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3072/3297 (93.1756%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7877, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4122/4716 (87.4046%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4280/4716 (90.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9348, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4499/5055 (89.0010%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4640/5055 (91.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0007, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3525/3911 (90.1304%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3505/3911 (89.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1370, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3593/4158 (86.4117%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3751/4158 (90.2116%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8813, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4076/4456 (91.4722%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4136/4456 (92.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9670, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4022/4511 (89.1598%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4145/4511 (91.8865%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8180, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3263/3672 (88.8617%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3387/3672 (92.2386%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8275, Accuracy: 5866/10000 (58.6600%)
time spent on training: 227.6317539215088
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.5106382978723404.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.6382978723404256.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5319148936170213.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.7816, Accuracy: 4705/10000 (47.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 9.6512, Accuracy: 98/9900 (0.9899%)
Done in 251.8934006690979 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 46.20142613971727.
Norm before scaling: 46.18706391455161. Distance: 2.1250096489182364
Total norm for 4 adversaries is: 46.18706391455161. distance: 2.1250096489182364
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1189, Accuracy: 9616/9900 (97.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 46.20142613971727.
Norm before scaling: 46.18692648070853. Distance: 2.2513299825927873
Total norm for 4 adversaries is: 46.18692648070853. distance: 2.2513299825927873
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.2253, Accuracy: 9365/9900 (94.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4286/4717 (90.8628%), train_poison_data_count: 370
Global model norm: 46.20142613971727.
Norm before scaling: 46.1831389602174. Distance: 2.0319041445943813
Total norm for 4 adversaries is: 46.1831389602174. distance: 2.0319041445943813
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1658, Accuracy: 9482/9900 (95.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 46.20142613971727.
Norm before scaling: 46.18762686044824. Distance: 2.308493055287326
Total norm for 4 adversaries is: 46.18762686044824. distance: 2.308493055287326
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0854, Accuracy: 9680/9900 (97.7778%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4692/5063 (92.6723%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4464/5063 (88.1691%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1002, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4584/5083 (90.1830%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4633/5083 (91.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0464, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3434/3797 (90.4398%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3441/3797 (90.6242%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0759, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5479/6124 (89.4677%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5526/6124 (90.2351%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9861, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4602/5232 (87.9587%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4782/5232 (91.3991%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9153, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3429/3861 (88.8112%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3584/3861 (92.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9409, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4475/5037 (88.8426%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4588/5037 (91.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9373, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4566/5116 (89.2494%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4654/5116 (90.9695%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0104, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3923/4368 (89.8123%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3888/4368 (89.0110%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0275, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3283/3672 (89.4063%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3365/3672 (91.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8612, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5402/5902 (91.5283%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5340/5902 (90.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9840, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3988/4361 (91.4469%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3973/4361 (91.1030%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9220, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3595/4158 (86.4598%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3732/4158 (89.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9748, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4528/5025 (90.1095%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4638/5025 (92.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9405, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4042/4456 (90.7092%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4122/4456 (92.5045%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8653, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4018/4433 (90.6384%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4059/4433 (91.5633%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8585, Accuracy: 5791/10000 (57.9100%)
time spent on training: 235.50171494483948
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5319148936170213.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.9155, Accuracy: 4606/10000 (46.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 9.4181, Accuracy: 111/9900 (1.1212%)
Done in 259.8265314102173 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4450/4885 (91.0952%), train_poison_data_count: 385
Global model norm: 46.232909637981365.
Norm before scaling: 46.21931520107422. Distance: 2.12923346288408
Total norm for 4 adversaries is: 46.21931520107422. distance: 2.12923346288408
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1529, Accuracy: 9502/9900 (95.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 46.232909637981365.
Norm before scaling: 46.219880395236856. Distance: 2.2275330686843953
Total norm for 4 adversaries is: 46.219880395236856. distance: 2.2275330686843953
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1731, Accuracy: 9480/9900 (95.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4297/4717 (91.0960%), train_poison_data_count: 370
Global model norm: 46.232909637981365.
Norm before scaling: 46.211887801936314. Distance: 2.022470132538851
Total norm for 4 adversaries is: 46.211887801936314. distance: 2.022470132538851
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1607, Accuracy: 9484/9900 (95.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 46.232909637981365.
Norm before scaling: 46.21956610587799. Distance: 2.2062857389932433
Total norm for 4 adversaries is: 46.21956610587799. distance: 2.2062857389932433
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0502, Accuracy: 9788/9900 (98.8687%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3651/4025 (90.7081%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3756/4025 (93.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8092, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4363/4928 (88.5349%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4472/4928 (90.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0608, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3700/4175 (88.6228%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3765/4175 (90.1796%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8863, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3930/4416 (88.9946%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4013/4416 (90.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9564, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3440/3797 (90.5978%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3467/3797 (91.3089%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8827, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4753/5195 (91.4918%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4762/5195 (91.6651%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9672, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4641/5232 (88.7041%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4695/5232 (89.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0508, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4990/5455 (91.4757%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4976/5455 (91.2191%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9198, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4208/4716 (89.2282%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4245/4716 (90.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1395, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4415/4679 (94.3578%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4395/4679 (93.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8562, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5733/6263 (91.5376%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5746/6263 (91.7452%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1305, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4436/4918 (90.1993%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4561/4918 (92.7410%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0083, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4057/4456 (91.0458%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4166/4456 (93.4919%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8512, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5401/5902 (91.5114%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5448/5902 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9540, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4068/4481 (90.7833%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4092/4481 (91.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1598, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5157/5591 (92.2375%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5181/5591 (92.6668%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9407, Accuracy: 5690/10000 (56.9000%)
time spent on training: 267.32793736457825
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.8931, Accuracy: 4632/10000 (46.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 9.6413, Accuracy: 98/9900 (0.9899%)
Done in 295.9233458042145 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4433/4885 (90.7472%), train_poison_data_count: 385
Global model norm: 46.259598349457434.
Norm before scaling: 46.24457580101287. Distance: 2.141850030473551
Total norm for 4 adversaries is: 46.24457580101287. distance: 2.141850030473551
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0375, Accuracy: 9809/9900 (99.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4803/5305 (90.5372%), train_poison_data_count: 415
Global model norm: 46.259598349457434.
Norm before scaling: 46.24123914068075. Distance: 2.242210255151846
Total norm for 4 adversaries is: 46.24123914068075. distance: 2.242210255151846
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1554, Accuracy: 9509/9900 (96.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4292/4717 (90.9900%), train_poison_data_count: 370
Global model norm: 46.259598349457434.
Norm before scaling: 46.24061876985158. Distance: 2.004628785508177
Total norm for 4 adversaries is: 46.24061876985158. distance: 2.004628785508177
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1669, Accuracy: 9509/9900 (96.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4580/5066 (90.4066%), train_poison_data_count: 400
Global model norm: 46.259598349457434.
Norm before scaling: 46.24768786450302. Distance: 2.1946250409311343
Total norm for 4 adversaries is: 46.24768786450302. distance: 2.1946250409311343
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0878, Accuracy: 9677/9900 (97.7475%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4011/4501 (89.1135%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4097/4501 (91.0242%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9409, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4605/5083 (90.5961%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4664/5083 (91.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1342, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3399/3804 (89.3533%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3495/3804 (91.8770%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9097, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3433/3756 (91.4004%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3534/3756 (94.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8804, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3713/4175 (88.9341%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3726/4175 (89.2455%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9993, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4615/4934 (93.5347%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4410/4934 (89.3798%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1909, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3949/4336 (91.0747%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4021/4336 (92.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9626, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4075/4356 (93.5491%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4068/4356 (93.3884%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0352, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4624/5244 (88.1770%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4761/5244 (90.7895%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0239, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4593/5017 (91.5487%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4671/5017 (93.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8921, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3459/3828 (90.3605%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3559/3828 (92.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8700, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4123/4538 (90.8550%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4219/4538 (92.9705%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9865, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3217/3638 (88.4277%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3348/3638 (92.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9356, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4245/4662 (91.0553%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4282/4662 (91.8490%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0903, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3434/3797 (90.4398%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3518/3797 (92.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0988, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4182/4634 (90.2460%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4275/4634 (92.2529%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9353, Accuracy: 5623/10000 (56.2300%)
time spent on training: 259.41024899482727
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.7716, Accuracy: 4738/10000 (47.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 9.5975, Accuracy: 101/9900 (1.0202%)
Done in 288.08299946784973 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 46.29133235468466.
Norm before scaling: 46.276924173258315. Distance: 2.1593925685140287
Total norm for 4 adversaries is: 46.276924173258315. distance: 2.1593925685140287
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0596, Accuracy: 9761/9900 (98.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 46.29133235468466.
Norm before scaling: 46.27755197075846. Distance: 2.2759245282952802
Total norm for 4 adversaries is: 46.27755197075846. distance: 2.2759245282952802
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.1318, Accuracy: 9589/9900 (96.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4307/4717 (91.3080%), train_poison_data_count: 370
Global model norm: 46.29133235468466.
Norm before scaling: 46.271922591486295. Distance: 2.0096282467169
Total norm for 4 adversaries is: 46.271922591486295. distance: 2.0096282467169
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.1817, Accuracy: 9448/9900 (95.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4566/5066 (90.1303%), train_poison_data_count: 400
Global model norm: 46.29133235468466.
Norm before scaling: 46.275206918939055. Distance: 2.193427528959775
Total norm for 4 adversaries is: 46.275206918939055. distance: 2.193427528959775
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0531, Accuracy: 9764/9900 (98.6263%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3766/4175 (90.2036%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3805/4175 (91.1377%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9536, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4007/4465 (89.7424%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4160/4465 (93.1691%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9380, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4442/4918 (90.3213%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4458/4918 (90.6466%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0606, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4466/5037 (88.6639%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4649/5037 (92.2970%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9467, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3476/3781 (91.9334%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3302/3781 (87.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1943, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4185/4634 (90.3107%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4295/4634 (92.6845%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8236, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4119/4576 (90.0131%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4233/4576 (92.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9118, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3464/3861 (89.7177%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3517/3861 (91.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8591, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5468/6124 (89.2880%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5488/6124 (89.6146%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9879, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3792/4223 (89.7940%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3905/4223 (92.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9120, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4604/5083 (90.5764%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4640/5083 (91.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9965, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4124/4356 (94.6740%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3761/4356 (86.3407%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.4332, Accuracy: 4892/10000 (48.9200%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4267/4793 (89.0257%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4361/4793 (90.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9652, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4541/5055 (89.8318%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4637/5055 (91.7310%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9740, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3979/4362 (91.2196%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4005/4362 (91.8157%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9388, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3969/4433 (89.5330%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4050/4433 (91.3603%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9085, Accuracy: 5729/10000 (57.2900%)
time spent on training: 260.9056143760681
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.5106382978723404.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.9908, Accuracy: 4552/10000 (45.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 9.7394, Accuracy: 89/9900 (0.8990%)
Done in 289.1062970161438 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 46.318179792570376.
Norm before scaling: 46.301815885523055. Distance: 2.1027381756624344
Total norm for 4 adversaries is: 46.301815885523055. distance: 2.1027381756624344
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1908, Accuracy: 9437/9900 (95.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4807/5305 (90.6126%), train_poison_data_count: 415
Global model norm: 46.318179792570376.
Norm before scaling: 46.301249055101096. Distance: 2.2502484714217643
Total norm for 4 adversaries is: 46.301249055101096. distance: 2.2502484714217643
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0989, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4290/4717 (90.9476%), train_poison_data_count: 370
Global model norm: 46.318179792570376.
Norm before scaling: 46.30317361389768. Distance: 2.09876425124255
Total norm for 4 adversaries is: 46.30317361389768. distance: 2.09876425124255
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.3300, Accuracy: 9119/9900 (92.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4587/5066 (90.5448%), train_poison_data_count: 400
Global model norm: 46.318179792570376.
Norm before scaling: 46.30317361389768. Distance: 2.241149130241161
Total norm for 4 adversaries is: 46.30317361389768. distance: 2.241149130241161
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1107, Accuracy: 9641/9900 (97.3838%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4581/5025 (91.1642%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4658/5025 (92.6965%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1015, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4041/4441 (90.9930%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4158/4441 (93.6276%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9532, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5161/5591 (92.3091%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5125/5591 (91.6652%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9314, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4193/4481 (93.5729%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4172/4481 (93.1042%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8987, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4246/4767 (89.0707%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4329/4767 (90.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1678, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4554/5055 (90.0890%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4660/5055 (92.1860%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9144, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4111/4518 (90.9916%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4224/4518 (93.4927%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9227, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4087/4625 (88.3676%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4127/4625 (89.2324%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0953, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4279/4793 (89.2760%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4400/4793 (91.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9772, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4596/5083 (90.4190%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4632/5083 (91.1273%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9339, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4670/5244 (89.0542%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4744/5244 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0371, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5713/6263 (91.2183%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5725/6263 (91.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0624, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3770/4175 (90.2994%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3804/4175 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9099, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3873/4416 (87.7038%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4059/4416 (91.9158%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8715, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4748/5265 (90.1804%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4791/5265 (90.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0228, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3607/4025 (89.6149%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3778/4025 (93.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8567, Accuracy: 5781/10000 (57.8100%)
time spent on training: 268.95825815200806
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 3.1335, Accuracy: 4421/10000 (44.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 9.7348, Accuracy: 103/9900 (1.0404%)
Done in 296.90153312683105 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4481/4885 (91.7298%), train_poison_data_count: 385
Global model norm: 46.34478779181916.
Norm before scaling: 46.328354236363715. Distance: 2.093557548218495
Total norm for 4 adversaries is: 46.328354236363715. distance: 2.093557548218495
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1354, Accuracy: 9578/9900 (96.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 46.34478779181916.
Norm before scaling: 46.327358235644624. Distance: 2.2718763726609397
Total norm for 4 adversaries is: 46.327358235644624. distance: 2.2718763726609397
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0698, Accuracy: 9737/9900 (98.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4273/4717 (90.5872%), train_poison_data_count: 370
Global model norm: 46.34478779181916.
Norm before scaling: 46.326565108646086. Distance: 2.0633446091121446
Total norm for 4 adversaries is: 46.326565108646086. distance: 2.0633446091121446
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0451, Accuracy: 9777/9900 (98.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 46.34478779181916.
Norm before scaling: 46.33300459125358. Distance: 2.255825237329632
Total norm for 4 adversaries is: 46.33300459125358. distance: 2.255825237329632
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1400, Accuracy: 9537/9900 (96.3333%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3892/4295 (90.6170%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3801/4295 (88.4983%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0089, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3803/4223 (90.0545%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3945/4223 (93.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8196, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4295/4793 (89.6098%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4373/4793 (91.2372%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9270, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4218/4707 (89.6112%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4299/4707 (91.3321%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9252, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4974/5455 (91.1824%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4988/5455 (91.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9376, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4190/4651 (90.0882%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4282/4651 (92.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0739, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3441/3837 (89.6794%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3556/3837 (92.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0125, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4078/4441 (91.8262%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4147/4441 (93.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9074, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3280/3638 (90.1594%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3345/3638 (91.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8799, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3819/4235 (90.1771%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3835/4235 (90.5549%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9408, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3954/4362 (90.6465%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4068/4362 (93.2600%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9065, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3451/3797 (90.8875%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3492/3797 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9981, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3647/4158 (87.7104%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3726/4158 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9803, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3772/4126 (91.4203%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3856/4126 (93.4561%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8045, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4719/5195 (90.8373%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4731/5195 (91.0683%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0087, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3663/4046 (90.5339%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3758/4046 (92.8819%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9295, Accuracy: 5686/10000 (56.8600%)
time spent on training: 260.1126239299774
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 3.1723, Accuracy: 4362/10000 (43.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 9.4016, Accuracy: 115/9900 (1.1616%)
Done in 288.56836128234863 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4455/4885 (91.1975%), train_poison_data_count: 385
Global model norm: 46.37109885040196.
Norm before scaling: 46.352602092041444. Distance: 2.1087596984893513
Total norm for 4 adversaries is: 46.352602092041444. distance: 2.1087596984893513
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0914, Accuracy: 9673/9900 (97.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4802/5305 (90.5184%), train_poison_data_count: 415
Global model norm: 46.37109885040196.
Norm before scaling: 46.353094556890156. Distance: 2.2316858074382555
Total norm for 4 adversaries is: 46.353094556890156. distance: 2.2316858074382555
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0980, Accuracy: 9640/9900 (97.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 46.37109885040196.
Norm before scaling: 46.35009491714256. Distance: 2.058444225809342
Total norm for 4 adversaries is: 46.35009491714256. distance: 2.058444225809342
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0865, Accuracy: 9676/9900 (97.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4578/5066 (90.3672%), train_poison_data_count: 400
Global model norm: 46.37109885040196.
Norm before scaling: 46.35452978556276. Distance: 2.203417494816546
Total norm for 4 adversaries is: 46.35452978556276. distance: 2.203417494816546
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0915, Accuracy: 9676/9900 (97.7374%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4000/4361 (91.7221%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3928/4361 (90.0711%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9030, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2968/3297 (90.0212%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3087/3297 (93.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.7696, Accuracy: 5944/10000 (59.4400%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4189/4716 (88.8253%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4253/4716 (90.1824%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9975, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4617/5167 (89.3555%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4779/5167 (92.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1102, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3922/4368 (89.7894%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4037/4368 (92.4222%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9314, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4389/4679 (93.8021%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4367/4679 (93.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9072, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4141/4356 (95.0643%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4121/4356 (94.6051%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0564, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5410/5902 (91.6638%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5355/5902 (90.7320%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0105, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3487/3861 (90.3134%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3542/3861 (91.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8960, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4190/4356 (96.1892%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4019/4356 (92.2635%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9747, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5726/6263 (91.4258%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5687/6263 (90.8031%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0727, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3853/4235 (90.9799%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3865/4235 (91.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1256, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4637/5232 (88.6277%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4737/5232 (90.5390%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0714, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4573/5017 (91.1501%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4654/5017 (92.7646%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8173, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4621/4804 (96.1907%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4552/4804 (94.7544%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9086, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4272/4793 (89.1300%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4428/4793 (92.3847%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9524, Accuracy: 5726/10000 (57.2600%)
time spent on training: 265.9000060558319
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.9936, Accuracy: 4542/10000 (45.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 8.8009, Accuracy: 193/9900 (1.9495%)
Done in 294.24263644218445 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 46.40498735656007.
Norm before scaling: 46.39001978385949. Distance: 2.1593720321524468
Total norm for 4 adversaries is: 46.39001978385949. distance: 2.1593720321524468
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0749, Accuracy: 9723/9900 (98.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 46.40498735656007.
Norm before scaling: 46.38907773606978. Distance: 2.220988152161059
Total norm for 4 adversaries is: 46.38907773606978. distance: 2.220988152161059
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1238, Accuracy: 9615/9900 (97.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 46.40498735656007.
Norm before scaling: 46.38507513535469. Distance: 1.9777654673637328
Total norm for 4 adversaries is: 46.38507513535469. distance: 1.9777654673637328
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0663, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4582/5066 (90.4461%), train_poison_data_count: 400
Global model norm: 46.40498735656007.
Norm before scaling: 46.38808567064931. Distance: 2.1676705920043924
Total norm for 4 adversaries is: 46.38808567064931. distance: 2.1676705920043924
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1246, Accuracy: 9586/9900 (96.8283%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3468/3837 (90.3831%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3561/3837 (92.8069%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9087, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3462/3861 (89.6659%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3529/3861 (91.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8672, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3739/4175 (89.5569%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3729/4175 (89.3174%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9103, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4035/4441 (90.8579%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4072/4441 (91.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0670, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3944/4336 (90.9594%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4030/4336 (92.9428%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0239, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3649/4046 (90.1878%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3768/4046 (93.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9814, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4469/4956 (90.1735%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4494/4956 (90.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1274, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4214/4618 (91.2516%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4243/4618 (91.8796%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9930, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3256/3616 (90.0442%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3358/3616 (92.8650%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8463, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4164/4576 (90.9965%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4227/4576 (92.3733%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8523, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3799/4223 (89.9597%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3919/4223 (92.8013%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8945, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4086/4503 (90.7395%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4180/4503 (92.8270%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8835, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3354/3590 (93.4262%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3335/3590 (92.8969%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9410, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4253/4707 (90.3548%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4373/4707 (92.9042%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9749, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3670/4013 (91.4528%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3738/4013 (93.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7433, Accuracy: 5957/10000 (59.5700%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3316/3704 (89.5248%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3392/3704 (91.5767%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9354, Accuracy: 5741/10000 (57.4100%)
time spent on training: 257.26156425476074
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5957446808510638.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.574468085106383.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 3.0535, Accuracy: 4458/10000 (44.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 8.8930, Accuracy: 189/9900 (1.9091%)
Done in 285.6419167518616 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4449/4885 (91.0747%), train_poison_data_count: 385
Global model norm: 46.43000233887028.
Norm before scaling: 46.414519465222305. Distance: 2.099206333954199
Total norm for 4 adversaries is: 46.414519465222305. distance: 2.099206333954199
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1342, Accuracy: 9583/9900 (96.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 46.43000233887028.
Norm before scaling: 46.412728398811836. Distance: 2.233005450743033
Total norm for 4 adversaries is: 46.412728398811836. distance: 2.233005450743033
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0476, Accuracy: 9781/9900 (98.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4303/4717 (91.2232%), train_poison_data_count: 370
Global model norm: 46.43000233887028.
Norm before scaling: 46.40841219710334. Distance: 2.0174029884507605
Total norm for 4 adversaries is: 46.40841219710334. distance: 2.0174029884507605
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0529, Accuracy: 9745/9900 (98.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4619/5066 (91.1765%), train_poison_data_count: 400
Global model norm: 46.43000233887028.
Norm before scaling: 46.416896926792724. Distance: 2.1622637492878556
Total norm for 4 adversaries is: 46.416896926792724. distance: 2.1622637492878556
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0913, Accuracy: 9680/9900 (97.7778%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4201/4596 (91.4056%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4315/4596 (93.8860%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8413, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4138/4356 (94.9954%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4022/4356 (92.3324%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0706, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3986/4295 (92.8056%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3938/4295 (91.6880%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9519, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4201/4634 (90.6560%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4228/4634 (91.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8872, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4253/4767 (89.2175%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4351/4767 (91.2733%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0180, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3840/4223 (90.9306%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3902/4223 (92.3988%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8420, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3694/4046 (91.3000%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3735/4046 (92.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9018, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4603/5083 (90.5568%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4662/5083 (91.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0800, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3985/4362 (91.3572%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4128/4362 (94.6355%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8227, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4253/4663 (91.2074%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4343/4663 (93.1375%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8782, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2994/3297 (90.8098%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3094/3297 (93.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7873, Accuracy: 5995/10000 (59.9500%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4057/4433 (91.5182%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4071/4433 (91.8340%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9666, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4753/5265 (90.2754%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4803/5265 (91.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8809, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4497/4986 (90.1925%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4519/4986 (90.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8422, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4211/4647 (90.6176%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4274/4647 (91.9733%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8751, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4595/5017 (91.5886%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4642/5017 (92.5254%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8404, Accuracy: 5880/10000 (58.8000%)
time spent on training: 261.0691237449646
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.574468085106383.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5319148936170213.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5106382978723404.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 3.0725, Accuracy: 4465/10000 (44.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 8.7440, Accuracy: 197/9900 (1.9899%)
Done in 289.2752740383148 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4475/4885 (91.6070%), train_poison_data_count: 385
Global model norm: 46.45141688753288.
Norm before scaling: 46.43437962682526. Distance: 2.0519662684889832
Total norm for 4 adversaries is: 46.43437962682526. distance: 2.0519662684889832
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1613, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4805/5305 (90.5749%), train_poison_data_count: 415
Global model norm: 46.45141688753288.
Norm before scaling: 46.4327549518858. Distance: 2.217406067347834
Total norm for 4 adversaries is: 46.4327549518858. distance: 2.217406067347834
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0467, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4301/4717 (91.1808%), train_poison_data_count: 370
Global model norm: 46.45141688753288.
Norm before scaling: 46.431955738175354. Distance: 2.0091220726191694
Total norm for 4 adversaries is: 46.431955738175354. distance: 2.0091220726191694
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0691, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4584/5066 (90.4856%), train_poison_data_count: 400
Global model norm: 46.45141688753288.
Norm before scaling: 46.43463988500395. Distance: 2.179512700554287
Total norm for 4 adversaries is: 46.43463988500395. distance: 2.179512700554287
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1294, Accuracy: 9585/9900 (96.8182%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3763/4184 (89.9379%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3855/4184 (92.1367%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9636, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5804/6391 (90.8152%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5844/6391 (91.4411%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0423, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4640/4934 (94.0413%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4652/4934 (94.2846%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9541, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4223/4618 (91.4465%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4272/4618 (92.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9707, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3876/4235 (91.5230%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3892/4235 (91.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0369, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4072/4465 (91.1982%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4221/4465 (94.5353%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.7748, Accuracy: 5957/10000 (59.5700%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4103/4503 (91.1170%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4112/4503 (91.3169%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8787, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4540/5025 (90.3483%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4630/5025 (92.1393%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8867, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5085/5582 (91.0964%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5149/5582 (92.2429%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1443, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3387/3804 (89.0379%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3532/3804 (92.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9159, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3642/4158 (87.5902%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3745/4158 (90.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9257, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4167/4538 (91.8246%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4274/4538 (94.1825%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8143, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3928/4368 (89.9267%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4015/4368 (91.9185%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9752, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4548/5083 (89.4747%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4604/5083 (90.5764%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1317, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4606/5116 (90.0313%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4704/5116 (91.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8738, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4147/4356 (95.2020%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3973/4356 (91.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1044, Accuracy: 5410/10000 (54.1000%)
time spent on training: 265.0132944583893
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.5319148936170213.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5531914893617021.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 3.1087, Accuracy: 4386/10000 (43.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 8.9735, Accuracy: 162/9900 (1.6364%)
Done in 293.28886437416077 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4497/4885 (92.0573%), train_poison_data_count: 385
Global model norm: 46.4849448494483.
Norm before scaling: 46.46313327689223. Distance: 2.038871668512774
Total norm for 4 adversaries is: 46.46313327689223. distance: 2.038871668512774
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1261, Accuracy: 9595/9900 (96.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4828/5305 (91.0085%), train_poison_data_count: 415
Global model norm: 46.4849448494483.
Norm before scaling: 46.465253420062446. Distance: 2.156120628124712
Total norm for 4 adversaries is: 46.465253420062446. distance: 2.156120628124712
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1797, Accuracy: 9476/9900 (95.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 46.4849448494483.
Norm before scaling: 46.464305016055064. Distance: 2.0589984879564587
Total norm for 4 adversaries is: 46.464305016055064. distance: 2.0589984879564587
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0456, Accuracy: 9792/9900 (98.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 46.4849448494483.
Norm before scaling: 46.464727990870934. Distance: 2.123281794011861
Total norm for 4 adversaries is: 46.464727990870934. distance: 2.123281794011861
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0614, Accuracy: 9755/9900 (98.5354%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5679/6263 (90.6754%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5751/6263 (91.8250%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1706, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4034/4433 (90.9993%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4073/4433 (91.8791%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9485, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3324/3672 (90.5229%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3425/3672 (93.2734%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8375, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5048/5455 (92.5390%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5050/5455 (92.5756%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0003, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4563/5025 (90.8060%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4607/5025 (91.6816%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0115, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4210/4618 (91.1650%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4211/4618 (91.1867%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0681, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4229/4707 (89.8449%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4333/4707 (92.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8866, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4032/4362 (92.4347%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3972/4362 (91.0591%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1361, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4428/4989 (88.7553%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4528/4989 (90.7597%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0030, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4578/5083 (90.0649%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4649/5083 (91.4617%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0607, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4217/4647 (90.7467%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4342/4647 (93.4366%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8441, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3905/4368 (89.4002%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3971/4368 (90.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0372, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4250/4354 (97.6114%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0019, Accuracy: 4250/4354 (97.6114%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.7491, Accuracy: 6139/10000 (61.3900%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4240/4767 (88.9448%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4359/4767 (91.4412%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1008, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4272/4662 (91.6345%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4320/4662 (92.6641%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9568, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4676/4804 (97.3356%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0015, Accuracy: 4682/4804 (97.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.6495, Accuracy: 6247/10000 (62.4700%)
time spent on training: 267.2173442840576
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.5106382978723404.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.5319148936170213.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5217391304347826.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.5319148936170213.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5531914893617021.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.5106382978723404.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5531914893617021.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.5531914893617021.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.5652173913043478.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.574468085106383.
Suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Misclassification from 8 to 48 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 3.0942, Accuracy: 4430/10000 (44.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 9.0731, Accuracy: 196/9900 (1.9798%)
Done in 295.32017397880554 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4518/4885 (92.4872%), train_poison_data_count: 385
Global model norm: 46.50806381693394.
Norm before scaling: 46.4898263610236. Distance: 2.074720304091605
Total norm for 4 adversaries is: 46.4898263610236. distance: 2.074720304091605
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0680, Accuracy: 9725/9900 (98.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 46.50806381693394.
Norm before scaling: 46.49185339003625. Distance: 2.255450323100277
Total norm for 4 adversaries is: 46.49185339003625. distance: 2.255450323100277
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.1861, Accuracy: 9464/9900 (95.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 46.50806381693394.
Norm before scaling: 46.48770733854005. Distance: 2.010621477147112
Total norm for 4 adversaries is: 46.48770733854005. distance: 2.010621477147112
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0725, Accuracy: 9739/9900 (98.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4645/5066 (91.6897%), train_poison_data_count: 400
Global model norm: 46.50806381693394.
Norm before scaling: 46.48934584766439. Distance: 2.1329928031975243
Total norm for 4 adversaries is: 46.48934584766439. distance: 2.1329928031975243
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0643, Accuracy: 9728/9900 (98.2626%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3841/4235 (90.6966%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3856/4235 (91.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0696, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3450/3775 (91.3907%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3550/3775 (94.0397%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8576, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4474/4874 (91.7932%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4416/4874 (90.6032%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1284, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4731/5265 (89.8575%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4726/5265 (89.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0969, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4614/5083 (90.7732%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4594/5083 (90.3797%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0404, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4081/4511 (90.4677%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4183/4511 (92.7289%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8800, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4200/4538 (92.5518%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4220/4538 (92.9925%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8943, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4237/4716 (89.8431%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4301/4716 (91.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9276, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4272/4663 (91.6148%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4382/4663 (93.9738%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8870, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4065/4441 (91.5334%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4105/4441 (92.4341%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0883, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4329/4793 (90.3192%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4437/4793 (92.5725%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0584, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4282/4662 (91.8490%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4348/4662 (93.2647%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8591, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3327/3704 (89.8218%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3457/3704 (93.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8230, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4506/4989 (90.3187%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4496/4989 (90.1183%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8724, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4018/4346 (92.4528%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4106/4346 (94.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8063, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4004/4362 (91.7928%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4094/4362 (93.8560%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8868, Accuracy: 5729/10000 (57.2900%)
time spent on training: 262.208220243454
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.5957446808510638.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
 max_rate for 1 = 0.6136363636363636.
Suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5909090909090909.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.5681818181818182.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.574468085106383.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.5909090909090909.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5531914893617021.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.5319148936170213.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.574468085106383.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.5319148936170213.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.6808510638297872.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.6363636363636364.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.5454545454545454.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.5531914893617021.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.574468085106383.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.5957446808510638.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.6136363636363636.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.5909090909090909.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5106382978723404.
Suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Misclassification from 62 to 92 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 3.1556, Accuracy: 4372/10000 (43.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 9.1264, Accuracy: 212/9900 (2.1414%)
Done in 290.2566108703613 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4527/4885 (92.6714%), train_poison_data_count: 385
Global model norm: 46.5363024036746.
Norm before scaling: 46.51756955542443. Distance: 2.0283594545528114
Total norm for 4 adversaries is: 46.51756955542443. distance: 2.0283594545528114
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0999, Accuracy: 9676/9900 (97.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 46.5363024036746.
Norm before scaling: 46.51957700712545. Distance: 2.261157346633385
Total norm for 4 adversaries is: 46.51957700712545. distance: 2.261157346633385
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2118, Accuracy: 9393/9900 (94.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4328/4717 (91.7532%), train_poison_data_count: 370
Global model norm: 46.5363024036746.
Norm before scaling: 46.51436794992758. Distance: 1.9655878011946764
Total norm for 4 adversaries is: 46.51436794992758. distance: 1.9655878011946764
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2120, Accuracy: 9369/9900 (94.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4632/5066 (91.4331%), train_poison_data_count: 400
Global model norm: 46.5363024036746.
Norm before scaling: 46.51584806379166. Distance: 2.1319207084182143
Total norm for 4 adversaries is: 46.51584806379166. distance: 2.1319207084182143
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1429, Accuracy: 9559/9900 (96.5556%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3612/3969 (91.0053%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3637/3969 (91.6352%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8714, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4172/4558 (91.5314%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4167/4558 (91.4217%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8716, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4397/4918 (89.4063%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4476/4918 (91.0126%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9686, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5553/5902 (94.0868%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5486/5902 (92.9515%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0798, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4763/5265 (90.4653%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4719/5265 (89.6296%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0119, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4043/4511 (89.6254%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4150/4511 (91.9973%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9314, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4182/4625 (90.4216%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4192/4625 (90.6378%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1325, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3961/4416 (89.6966%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4025/4416 (91.1458%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8953, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3017/3297 (91.5074%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3107/3297 (94.2372%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6853, Accuracy: 6113/10000 (61.1300%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4563/5025 (90.8060%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4650/5025 (92.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0161, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4106/4441 (92.4567%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4159/4441 (93.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0261, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4171/4481 (93.0819%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4144/4481 (92.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0114, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3467/3797 (91.3089%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3534/3797 (93.0735%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9268, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3323/3646 (91.1410%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3380/3646 (92.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7857, Accuracy: 6007/10000 (60.0700%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3705/4025 (92.0497%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3776/4025 (93.8137%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7916, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4459/4928 (90.4830%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4445/4928 (90.1989%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0600, Accuracy: 5487/10000 (54.8700%)
time spent on training: 260.85142731666565
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.5319148936170213.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.6363636363636364.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
 max_rate for 1 = 0.5681818181818182.
Suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.5106382978723404.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.6363636363636364.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.6818181818181818.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.5531914893617021.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.6136363636363636.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.7045454545454546.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.6170212765957447.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.6363636363636364.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.5531914893617021.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.5454545454545454.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.5681818181818182.
Suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Misclassification from 62 to 92 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 3.0901, Accuracy: 4407/10000 (44.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 9.3807, Accuracy: 182/9900 (1.8384%)
Done in 288.76739144325256 sec.
Saving all the graphs.
This run has a label: Oct.22_14.59.34. Visdom environment: cifar100_CerP
