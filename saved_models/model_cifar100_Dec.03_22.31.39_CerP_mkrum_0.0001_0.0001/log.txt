current path: saved_models/model_cifar100_Dec.03_22.31.39_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4310/4885 (88.2293%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.440072926882. Distance: 2.2951878170377507
Total norm for 4 adversaries is: 42.440072926882. distance: 2.2951878170377507
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4470, Accuracy: 8824/9900 (89.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4737/5305 (89.2931%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43534259059599. Distance: 2.250677960298928
Total norm for 4 adversaries is: 42.43534259059599. distance: 2.250677960298928
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7481, Accuracy: 8258/9900 (83.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4181/4717 (88.6368%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43865488809627. Distance: 2.1764747706010716
Total norm for 4 adversaries is: 42.43865488809627. distance: 2.1764747706010716
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4358, Accuracy: 8868/9900 (89.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4452/5066 (87.8800%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.4403792515527. Distance: 2.3040361938878826
Total norm for 4 adversaries is: 42.4403792515527. distance: 2.3040361938878826
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5962, Accuracy: 8507/9900 (85.9293%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3840/4356 (88.1543%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3668/4356 (84.2057%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4646, Accuracy: 4593/10000 (45.9300%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3935/4465 (88.1299%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4072/4465 (91.1982%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0163, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4035/4647 (86.8302%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4184/4647 (90.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9193, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4445/5055 (87.9327%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4513/5055 (89.2779%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0925, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4442/5116 (86.8256%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4448/5116 (86.9429%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1329, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3628/4126 (87.9302%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3749/4126 (90.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9019, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3084/3472 (88.8249%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3210/3472 (92.4539%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0728, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4433/4986 (88.9089%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4446/4986 (89.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0644, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3539/4013 (88.1884%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3671/4013 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8144, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4038/4618 (87.4405%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4091/4618 (88.5881%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0637, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4440/5083 (87.3500%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4459/5083 (87.7238%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1418, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3973/4511 (88.0736%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4033/4511 (89.4037%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1560, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3338/3797 (87.9115%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3390/3797 (89.2810%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9922, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5003/5582 (89.6274%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5042/5582 (90.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0501, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3152/3616 (87.1681%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3211/3616 (88.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0595, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4832/5455 (88.5793%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4833/5455 (88.5976%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0959, Accuracy: 5143/10000 (51.4300%)
time spent on training: 255.82507300376892
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1177, Accuracy: 7025/10000 (70.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.8913, Accuracy: 55/9900 (0.5556%)
Done in 282.59176754951477 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4380/4885 (89.6622%), train_poison_data_count: 385
Global model norm: 42.432557932043764.
Norm before scaling: 42.43969325379912. Distance: 2.1665781320921056
Total norm for 4 adversaries is: 42.43969325379912. distance: 2.1665781320921056
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2354, Accuracy: 9287/9900 (93.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 42.432557932043764.
Norm before scaling: 42.43553963853957. Distance: 2.2048426215997705
Total norm for 4 adversaries is: 42.43553963853957. distance: 2.2048426215997705
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4652, Accuracy: 8736/9900 (88.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4168/4717 (88.3612%), train_poison_data_count: 370
Global model norm: 42.432557932043764.
Norm before scaling: 42.44030590641033. Distance: 2.2151278089930977
Total norm for 4 adversaries is: 42.44030590641033. distance: 2.2151278089930977
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2016, Accuracy: 9403/9900 (94.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4472/5066 (88.2748%), train_poison_data_count: 400
Global model norm: 42.432557932043764.
Norm before scaling: 42.44301671616604. Distance: 2.347841785481317
Total norm for 4 adversaries is: 42.44301671616604. distance: 2.347841785481317
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2259, Accuracy: 9274/9900 (93.6768%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3591/4025 (89.2174%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3716/4025 (92.3230%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9010, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3329/3797 (87.6745%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3382/3797 (89.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0713, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3926/4625 (84.8865%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4008/4625 (86.6595%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0690, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3847/4481 (85.8514%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3899/4481 (87.0118%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2149, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3848/4315 (89.1773%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3969/4315 (91.9815%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0130, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3695/4235 (87.2491%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3824/4235 (90.2952%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9810, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3370/3828 (88.0355%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3473/3828 (90.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9098, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3819/4416 (86.4810%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3972/4416 (89.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8905, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3144/3638 (86.4211%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3259/3638 (89.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0273, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4539/5265 (86.2108%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4557/5265 (86.5527%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9871, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3353/3781 (88.6802%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3275/3781 (86.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3000, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3983/4441 (89.6870%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3991/4441 (89.8671%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1711, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3976/4433 (89.6910%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4014/4433 (90.5482%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9828, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4386/5083 (86.2876%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4476/5083 (88.0582%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0656, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4304/4928 (87.3377%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4384/4928 (88.9610%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9975, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4164/4793 (86.8767%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4333/4793 (90.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0620, Accuracy: 5350/10000 (53.5000%)
time spent on training: 248.87587809562683
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1174, Accuracy: 7025/10000 (70.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.5889, Accuracy: 55/9900 (0.5556%)
Done in 275.87090945243835 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 42.4329880126263.
Norm before scaling: 42.43460904641252. Distance: 2.121785818481516
Total norm for 4 adversaries is: 42.43460904641252. distance: 2.121785818481516
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1977, Accuracy: 9376/9900 (94.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.4329880126263.
Norm before scaling: 42.4372439931527. Distance: 2.207942484210203
Total norm for 4 adversaries is: 42.4372439931527. distance: 2.207942484210203
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0800, Accuracy: 9674/9900 (97.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4219/4717 (89.4424%), train_poison_data_count: 370
Global model norm: 42.4329880126263.
Norm before scaling: 42.437022502836484. Distance: 2.096385833943337
Total norm for 4 adversaries is: 42.437022502836484. distance: 2.096385833943337
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2184, Accuracy: 9322/9900 (94.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4461/5066 (88.0576%), train_poison_data_count: 400
Global model norm: 42.4329880126263.
Norm before scaling: 42.44016353018388. Distance: 2.2713900125834656
Total norm for 4 adversaries is: 42.44016353018388. distance: 2.2713900125834656
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1535, Accuracy: 9499/9900 (95.9495%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3124/3616 (86.3938%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3302/3616 (91.3164%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8413, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3404/3837 (88.7151%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3489/3837 (90.9304%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9576, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4137/4679 (88.4163%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4241/4679 (90.6390%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0338, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3068/3638 (84.3321%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3243/3638 (89.1424%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0547, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3607/4046 (89.1498%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3607/4046 (89.1498%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0376, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3956/4518 (87.5609%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4073/4518 (90.1505%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0378, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3354/3797 (88.3329%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3383/3797 (89.0967%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0737, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4408/5025 (87.7214%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4444/5025 (88.4378%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.4143, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3897/4362 (89.3398%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3923/4362 (89.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0329, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3970/4558 (87.0996%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4026/4558 (88.3282%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1232, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3176/3672 (86.4924%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3245/3672 (88.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1506, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4316/4874 (88.5515%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4347/4874 (89.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1208, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3594/4025 (89.2919%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3700/4025 (91.9255%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9180, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4078/4663 (87.4544%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4229/4663 (90.6927%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0715, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3437/3911 (87.8803%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3459/3911 (88.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0194, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4410/5017 (87.9011%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4549/5017 (90.6717%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8788, Accuracy: 5660/10000 (56.6000%)
time spent on training: 253.2191345691681
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1171, Accuracy: 7024/10000 (70.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.3783, Accuracy: 59/9900 (0.5960%)
Done in 279.95199060440063 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4382/4885 (89.7032%), train_poison_data_count: 385
Global model norm: 42.433349046806626.
Norm before scaling: 42.438864864373585. Distance: 2.1400317184379323
Total norm for 4 adversaries is: 42.438864864373585. distance: 2.1400317184379323
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5478, Accuracy: 8687/9900 (87.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 42.433349046806626.
Norm before scaling: 42.4328240359284. Distance: 2.1389495529995792
Total norm for 4 adversaries is: 42.4328240359284. distance: 2.1389495529995792
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0945, Accuracy: 9639/9900 (97.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4204/4717 (89.1244%), train_poison_data_count: 370
Global model norm: 42.433349046806626.
Norm before scaling: 42.436024343821074. Distance: 2.096605886822658
Total norm for 4 adversaries is: 42.436024343821074. distance: 2.096605886822658
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1452, Accuracy: 9506/9900 (96.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4469/5066 (88.2156%), train_poison_data_count: 400
Global model norm: 42.433349046806626.
Norm before scaling: 42.44053888465971. Distance: 2.266974106676518
Total norm for 4 adversaries is: 42.44053888465971. distance: 2.266974106676518
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3035, Accuracy: 9119/9900 (92.1111%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5215/6124 (85.1568%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5307/6124 (86.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1677, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3836/4356 (88.0624%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3614/4356 (82.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.5352, Accuracy: 4714/10000 (47.1400%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3491/4158 (83.9586%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3568/4158 (85.8105%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1467, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4875/5455 (89.3676%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4878/5455 (89.4225%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9279, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3878/4511 (85.9676%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4038/4511 (89.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0980, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4524/5232 (86.4679%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4556/5232 (87.0795%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0955, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4465/5244 (85.1449%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4549/5244 (86.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1160, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4345/4918 (88.3489%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4399/4918 (89.4469%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0446, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3591/4126 (87.0334%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3725/4126 (90.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8432, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4329/4928 (87.8450%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4359/4928 (88.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1662, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3709/4223 (87.8286%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3822/4223 (90.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9689, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4499/5195 (86.6025%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4603/5195 (88.6044%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1324, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4122/4679 (88.0957%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4111/4679 (87.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0526, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3171/3646 (86.9720%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3280/3646 (89.9616%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8952, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3153/3616 (87.1958%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3189/3616 (88.1914%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9143, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4038/4716 (85.6234%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4089/4716 (86.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0427, Accuracy: 5325/10000 (53.2500%)
time spent on training: 260.5728621482849
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.1168, Accuracy: 7031/10000 (70.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.3262, Accuracy: 59/9900 (0.5960%)
Done in 287.30605912208557 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 42.433938777307134.
Norm before scaling: 42.43987733814228. Distance: 2.1540574799344543
Total norm for 4 adversaries is: 42.43987733814228. distance: 2.1540574799344543
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1615, Accuracy: 9500/9900 (95.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 42.433938777307134.
Norm before scaling: 42.42899054044593. Distance: 2.1205830389492757
Total norm for 4 adversaries is: 42.42899054044593. distance: 2.1205830389492757
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1289, Accuracy: 9563/9900 (96.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4199/4717 (89.0184%), train_poison_data_count: 370
Global model norm: 42.433938777307134.
Norm before scaling: 42.4377804551668. Distance: 2.118526921864471
Total norm for 4 adversaries is: 42.4377804551668. distance: 2.118526921864471
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1929, Accuracy: 9404/9900 (94.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4475/5066 (88.3340%), train_poison_data_count: 400
Global model norm: 42.433938777307134.
Norm before scaling: 42.44447343524611. Distance: 2.2978618344370387
Total norm for 4 adversaries is: 42.44447343524611. distance: 2.2978618344370387
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1951, Accuracy: 9388/9900 (94.8283%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5246/6124 (85.6630%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5312/6124 (86.7407%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9912, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3926/4433 (88.5630%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4011/4433 (90.4805%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0470, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3339/3781 (88.3100%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3180/3781 (84.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.4293, Accuracy: 4787/10000 (47.8700%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3540/3969 (89.1912%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3571/3969 (89.9723%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9475, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4422/5025 (88.0000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4541/5025 (90.3682%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0982, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4131/4679 (88.2881%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4224/4679 (90.2757%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1363, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4100/4707 (87.1043%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4209/4707 (89.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9755, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4371/4986 (87.6655%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4405/4986 (88.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9823, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3883/4315 (89.9884%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3946/4315 (91.4484%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9189, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3816/4416 (86.4130%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3910/4416 (88.5417%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0834, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4204/4804 (87.5104%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4075/4804 (84.8251%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1232, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4135/4793 (86.2716%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4258/4793 (88.8379%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1297, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4496/5232 (85.9327%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4524/5232 (86.4679%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9962, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4067/4662 (87.2372%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4198/4662 (90.0472%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0455, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4209/4956 (84.9274%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4299/4956 (86.7433%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3176, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3789/4368 (86.7445%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3818/4368 (87.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9593, Accuracy: 5379/10000 (53.7900%)
time spent on training: 258.96107387542725
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.1165, Accuracy: 7029/10000 (70.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.2959, Accuracy: 60/9900 (0.6061%)
Done in 285.65864634513855 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4362/4885 (89.2938%), train_poison_data_count: 385
Global model norm: 42.43440911746548.
Norm before scaling: 42.44088259714918. Distance: 2.179978655439403
Total norm for 4 adversaries is: 42.44088259714918. distance: 2.179978655439403
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2816, Accuracy: 9199/9900 (92.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 42.43440911746548.
Norm before scaling: 42.43238820004567. Distance: 2.1436425540789683
Total norm for 4 adversaries is: 42.43238820004567. distance: 2.1436425540789683
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2210, Accuracy: 9349/9900 (94.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4237/4717 (89.8240%), train_poison_data_count: 370
Global model norm: 42.43440911746548.
Norm before scaling: 42.43490678058057. Distance: 2.077163359064293
Total norm for 4 adversaries is: 42.43490678058057. distance: 2.077163359064293
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1670, Accuracy: 9461/9900 (95.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 42.43440911746548.
Norm before scaling: 42.444080859408416. Distance: 2.2493931693752716
Total norm for 4 adversaries is: 42.444080859408416. distance: 2.2493931693752716
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1594, Accuracy: 9500/9900 (95.9596%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5291/6124 (86.3978%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5285/6124 (86.2998%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1122, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5081/5902 (86.0895%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5124/5902 (86.8180%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2382, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4134/4707 (87.8266%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4195/4707 (89.1226%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0246, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4017/4647 (86.4429%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4143/4647 (89.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9040, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2921/3297 (88.5957%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3024/3297 (91.7197%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7868, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5526/6263 (88.2325%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5666/6263 (90.4678%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3246, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4130/4663 (88.5696%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4241/4663 (90.9500%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1379, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4267/4956 (86.0977%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4370/4956 (88.1759%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2317, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3590/4046 (88.7296%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3693/4046 (91.2753%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9246, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3658/4184 (87.4283%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3753/4184 (89.6989%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9158, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4817/5591 (86.1563%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4874/5591 (87.1758%)
