current path: saved_models/model_cifar100_Dec.03_22.59.40_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4310/4885 (88.2293%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439842822388755. Distance: 2.292303297450235
Total norm for 4 adversaries is: 42.439842822388755. distance: 2.292303297450235
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4463, Accuracy: 8816/9900 (89.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435254853625985. Distance: 2.250153430369822
Total norm for 4 adversaries is: 42.435254853625985. distance: 2.250153430369822
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7279, Accuracy: 8299/9900 (83.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4180/4717 (88.6156%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43864194431915. Distance: 2.17651705396628
Total norm for 4 adversaries is: 42.43864194431915. distance: 2.17651705396628
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4307, Accuracy: 8876/9900 (89.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4456/5066 (87.9589%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44038931852313. Distance: 2.303253348305547
Total norm for 4 adversaries is: 42.44038931852313. distance: 2.303253348305547
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5921, Accuracy: 8515/9900 (86.0101%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3835/4356 (88.0395%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3653/4356 (83.8613%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4359, Accuracy: 4665/10000 (46.6500%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3934/4465 (88.1075%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4091/4465 (91.6237%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9738, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4048/4647 (87.1100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4181/4647 (89.9720%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9745, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4445/5055 (87.9327%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4508/5055 (89.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0695, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4441/5116 (86.8061%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4470/5116 (87.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9800, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3625/4126 (87.8575%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3751/4126 (90.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9762, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3082/3472 (88.7673%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3219/3472 (92.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0581, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4433/4986 (88.9089%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4444/4986 (89.1296%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0807, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3536/4013 (88.1136%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3690/4013 (91.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8284, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4030/4618 (87.2672%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4056/4618 (87.8302%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9910, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4434/5083 (87.2319%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4450/5083 (87.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2024, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3970/4511 (88.0071%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4016/4511 (89.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1400, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3326/3797 (87.5955%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3372/3797 (88.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9968, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4995/5582 (89.4841%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5055/5582 (90.5589%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1130, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3158/3616 (87.3341%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3208/3616 (88.7168%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0508, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4825/5455 (88.4510%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4828/5455 (88.5060%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9656, Accuracy: 5319/10000 (53.1900%)
time spent on training: 260.8778190612793
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1177, Accuracy: 7026/10000 (70.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.8916, Accuracy: 55/9900 (0.5556%)
Done in 290.013863325119 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4381/4885 (89.6827%), train_poison_data_count: 385
Global model norm: 42.432557932043764.
Norm before scaling: 42.43974502760134. Distance: 2.165261938094115
Total norm for 4 adversaries is: 42.43974502760134. distance: 2.165261938094115
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2426, Accuracy: 9276/9900 (93.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 42.432557932043764.
Norm before scaling: 42.435589979108336. Distance: 2.2046972846362207
Total norm for 4 adversaries is: 42.435589979108336. distance: 2.2046972846362207
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4678, Accuracy: 8732/9900 (88.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4169/4717 (88.3824%), train_poison_data_count: 370
Global model norm: 42.432557932043764.
Norm before scaling: 42.44026563843513. Distance: 2.2146766774508038
Total norm for 4 adversaries is: 42.44026563843513. distance: 2.2146766774508038
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1856, Accuracy: 9436/9900 (95.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4477/5066 (88.3735%), train_poison_data_count: 400
Global model norm: 42.432557932043764.
Norm before scaling: 42.44295775609822. Distance: 2.3480539096186837
Total norm for 4 adversaries is: 42.44295775609822. distance: 2.3480539096186837
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2342, Accuracy: 9257/9900 (93.5051%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3588/4025 (89.1429%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3713/4025 (92.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9456, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3337/3797 (87.8852%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3408/3797 (89.7551%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1297, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3928/4625 (84.9297%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4005/4625 (86.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0641, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3848/4481 (85.8737%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3895/4481 (86.9226%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2339, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3849/4315 (89.2005%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3987/4315 (92.3986%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0344, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3692/4235 (87.1783%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3828/4235 (90.3896%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9950, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3363/3828 (87.8527%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3455/3828 (90.2560%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8987, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3814/4416 (86.3678%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3970/4416 (89.9004%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9179, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3146/3638 (86.4761%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3272/3638 (89.9395%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9950, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4533/5265 (86.0969%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4532/5265 (86.0779%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0310, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3355/3781 (88.7331%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3308/3781 (87.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2528, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3984/4441 (89.7095%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4018/4441 (90.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1627, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3977/4433 (89.7135%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4012/4433 (90.5030%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9691, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4393/5083 (86.4253%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4446/5083 (87.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0537, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4315/4928 (87.5609%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4405/4928 (89.3872%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9651, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4156/4793 (86.7098%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4357/4793 (90.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1733, Accuracy: 5273/10000 (52.7300%)
time spent on training: 260.1790270805359
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1174, Accuracy: 7027/10000 (70.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.5883, Accuracy: 55/9900 (0.5556%)
Done in 289.37370800971985 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 42.43298657423697.
Norm before scaling: 42.43462486808753. Distance: 2.123098981651273
Total norm for 4 adversaries is: 42.43462486808753. distance: 2.123098981651273
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1986, Accuracy: 9371/9900 (94.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4746/5305 (89.4628%), train_poison_data_count: 415
Global model norm: 42.43298657423697.
Norm before scaling: 42.437279949263804. Distance: 2.2085662095222007
Total norm for 4 adversaries is: 42.437279949263804. distance: 2.2085662095222007
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0749, Accuracy: 9680/9900 (97.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 42.43298657423697.
Norm before scaling: 42.437080032899885. Distance: 2.0965729087927145
Total norm for 4 adversaries is: 42.437080032899885. distance: 2.0965729087927145
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2172, Accuracy: 9324/9900 (94.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 42.43298657423697.
Norm before scaling: 42.44004991648882. Distance: 2.270777138764244
Total norm for 4 adversaries is: 42.44004991648882. distance: 2.270777138764244
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1414, Accuracy: 9531/9900 (96.2727%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3126/3616 (86.4491%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3305/3616 (91.3993%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8205, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3405/3837 (88.7412%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3489/3837 (90.9304%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9534, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4144/4679 (88.5659%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4255/4679 (90.9382%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0124, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3069/3638 (84.3595%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3256/3638 (89.4997%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1222, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3616/4046 (89.3722%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3637/4046 (89.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0377, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3953/4518 (87.4945%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4082/4518 (90.3497%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1129, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3354/3797 (88.3329%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3397/3797 (89.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0948, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4410/5025 (87.7612%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4466/5025 (88.8756%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2771, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3898/4362 (89.3627%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3917/4362 (89.7983%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1719, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3980/4558 (87.3190%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4009/4558 (87.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1568, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3183/3672 (86.6830%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3261/3672 (88.8072%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1083, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4324/4874 (88.7156%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4351/4874 (89.2696%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1899, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3587/4025 (89.1180%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3702/4025 (91.9752%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9216, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4086/4663 (87.6260%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4237/4663 (90.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1125, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3430/3911 (87.7014%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3446/3911 (88.1105%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0618, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4423/5017 (88.1603%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4562/5017 (90.9308%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8402, Accuracy: 5724/10000 (57.2400%)
time spent on training: 258.74305391311646
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1171, Accuracy: 7025/10000 (70.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.3780, Accuracy: 59/9900 (0.5960%)
Done in 287.3713963031769 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 42.433349046806626.
Norm before scaling: 42.43878432565031. Distance: 2.1384360823570145
Total norm for 4 adversaries is: 42.43878432565031. distance: 2.1384360823570145
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5481, Accuracy: 8675/9900 (87.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 42.433349046806626.
Norm before scaling: 42.43278088406047. Distance: 2.1375735175445345
Total norm for 4 adversaries is: 42.43278088406047. distance: 2.1375735175445345
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0997, Accuracy: 9621/9900 (97.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4206/4717 (89.1668%), train_poison_data_count: 370
Global model norm: 42.433349046806626.
Norm before scaling: 42.436002769519746. Distance: 2.096244692263995
Total norm for 4 adversaries is: 42.436002769519746. distance: 2.096244692263995
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1447, Accuracy: 9516/9900 (96.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4473/5066 (88.2945%), train_poison_data_count: 400
Global model norm: 42.433349046806626.
Norm before scaling: 42.4405503897253. Distance: 2.268114813379416
Total norm for 4 adversaries is: 42.4405503897253. distance: 2.268114813379416
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2964, Accuracy: 9141/9900 (92.3333%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5209/6124 (85.0588%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5344/6124 (87.2632%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1765, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3846/4356 (88.2920%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3658/4356 (83.9761%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2922, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3491/4158 (83.9586%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3560/4158 (85.6181%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1601, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4876/5455 (89.3859%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4891/5455 (89.6609%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9397, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3887/4511 (86.1671%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4053/4511 (89.8470%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0704, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4527/5232 (86.5252%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4536/5232 (86.6972%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2568, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4466/5244 (85.1640%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4543/5244 (86.6323%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0338, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4347/4918 (88.3896%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4404/4918 (89.5486%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0935, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3585/4126 (86.8880%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3712/4126 (89.9661%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8556, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4327/4928 (87.8044%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4371/4928 (88.6972%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2157, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3704/4223 (87.7102%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3828/4223 (90.6465%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9617, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4502/5195 (86.6603%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4609/5195 (88.7199%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1065, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4102/4679 (87.6683%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4109/4679 (87.8179%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0348, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3173/3646 (87.0269%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3272/3646 (89.7422%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8899, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3155/3616 (87.2511%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3204/3616 (88.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9586, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4040/4716 (85.6658%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4097/4716 (86.8745%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9911, Accuracy: 5440/10000 (54.4000%)
time spent on training: 265.7586975097656
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.1168, Accuracy: 7029/10000 (70.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.3266, Accuracy: 59/9900 (0.5960%)
Done in 294.60186195373535 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 42.43394021566419.
Norm before scaling: 42.43995212217861. Distance: 2.1531915396940673
Total norm for 4 adversaries is: 42.43995212217861. distance: 2.1531915396940673
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1673, Accuracy: 9485/9900 (95.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4818/5305 (90.8200%), train_poison_data_count: 415
Global model norm: 42.43394021566419.
Norm before scaling: 42.42899197897073. Distance: 2.119872695411443
Total norm for 4 adversaries is: 42.42899197897073. distance: 2.119872695411443
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1261, Accuracy: 9567/9900 (96.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4196/4717 (88.9548%), train_poison_data_count: 370
Global model norm: 42.43394021566419.
Norm before scaling: 42.437806343242606. Distance: 2.1191189109990636
Total norm for 4 adversaries is: 42.437806343242606. distance: 2.1191189109990636
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1880, Accuracy: 9405/9900 (95.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4476/5066 (88.3537%), train_poison_data_count: 400
Global model norm: 42.43394021566419.
Norm before scaling: 42.444571219139. Distance: 2.297138536346835
Total norm for 4 adversaries is: 42.444571219139. distance: 2.297138536346835
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2027, Accuracy: 9377/9900 (94.7172%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5252/6124 (85.7609%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5301/6124 (86.5611%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9909, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3928/4433 (88.6082%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3992/4433 (90.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0281, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3339/3781 (88.3100%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3176/3781 (83.9989%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3467, Accuracy: 4883/10000 (48.8300%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3535/3969 (89.0653%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3567/3969 (89.8715%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0246, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4412/5025 (87.8010%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4526/5025 (90.0697%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1882, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4130/4679 (88.2667%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4201/4679 (89.7841%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9612, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4104/4707 (87.1893%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4212/4707 (89.4837%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0097, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4381/4986 (87.8660%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4421/4986 (88.6683%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9833, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3881/4315 (89.9421%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3937/4315 (91.2399%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9346, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3811/4416 (86.2998%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3921/4416 (88.7908%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9783, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4201/4804 (87.4480%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4062/4804 (84.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1316, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4124/4793 (86.0421%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4274/4793 (89.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1590, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4486/5232 (85.7416%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4519/5232 (86.3723%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0477, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4072/4662 (87.3445%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4217/4662 (90.4547%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0833, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4205/4956 (84.8467%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4315/4956 (87.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3312, Accuracy: 4883/10000 (48.8300%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3790/4368 (86.7674%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3828/4368 (87.6374%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9838, Accuracy: 5357/10000 (53.5700%)
time spent on training: 267.335147857666
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.1165, Accuracy: 7029/10000 (70.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.2965, Accuracy: 60/9900 (0.6061%)
Done in 296.4243640899658 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4361/4885 (89.2733%), train_poison_data_count: 385
Global model norm: 42.43440911746548.
Norm before scaling: 42.44087540653983. Distance: 2.178848816233349
Total norm for 4 adversaries is: 42.44087540653983. distance: 2.178848816233349
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2790, Accuracy: 9210/9900 (93.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4761/5305 (89.7455%), train_poison_data_count: 415
Global model norm: 42.43440911746548.
Norm before scaling: 42.43240258413964. Distance: 2.142873432460813
Total norm for 4 adversaries is: 42.43240258413964. distance: 2.142873432460813
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2302, Accuracy: 9329/9900 (94.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 42.43440911746548.
Norm before scaling: 42.434826234345095. Distance: 2.076455729360993
Total norm for 4 adversaries is: 42.434826234345095. distance: 2.076455729360993
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1690, Accuracy: 9457/9900 (95.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4496/5066 (88.7485%), train_poison_data_count: 400
Global model norm: 42.43440911746548.
Norm before scaling: 42.44411105767869. Distance: 2.249351301987895
Total norm for 4 adversaries is: 42.44411105767869. distance: 2.249351301987895
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1621, Accuracy: 9496/9900 (95.9192%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5297/6124 (86.4958%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5319/6124 (86.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1081, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5089/5902 (86.2250%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5120/5902 (86.7503%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1467, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4117/4707 (87.4655%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4195/4707 (89.1226%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9925, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4026/4647 (86.6365%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4140/4647 (89.0897%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0376, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2920/3297 (88.5654%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3015/3297 (91.4468%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8044, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5531/6263 (88.3123%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5628/6263 (89.8611%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2102, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4132/4663 (88.6125%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4225/4663 (90.6069%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1881, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4257/4956 (85.8959%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4335/4956 (87.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1132, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3593/4046 (88.8038%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3677/4046 (90.8799%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9720, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3654/4184 (87.3327%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3766/4184 (90.0096%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8907, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4824/5591 (86.2815%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4872/5591 (87.1400%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2108, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4028/4634 (86.9227%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4113/4634 (88.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9651, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3334/3828 (87.0951%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3498/3828 (91.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9417, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3088/3638 (84.8818%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3248/3638 (89.2798%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9236, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3339/3781 (88.3100%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3350/3781 (88.6009%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2520, Accuracy: 5012/10000 (50.1200%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3385/3837 (88.2200%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3502/3837 (91.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9071, Accuracy: 5656/10000 (56.5600%)
time spent on training: 262.50186014175415
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1161, Accuracy: 7030/10000 (70.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.2893, Accuracy: 63/9900 (0.6364%)
Done in 291.8103086948395 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4377/4885 (89.6008%), train_poison_data_count: 385
Global model norm: 42.43486650748194.
Norm before scaling: 42.43976372368106. Distance: 2.131903038768749
Total norm for 4 adversaries is: 42.43976372368106. distance: 2.131903038768749
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2208, Accuracy: 9374/9900 (94.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 42.43486650748194.
Norm before scaling: 42.43620269095864. Distance: 2.16498620326203
Total norm for 4 adversaries is: 42.43620269095864. distance: 2.16498620326203
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1758, Accuracy: 9470/9900 (95.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4181/4717 (88.6368%), train_poison_data_count: 370
Global model norm: 42.43486650748194.
Norm before scaling: 42.44033898364709. Distance: 2.1382993887597825
Total norm for 4 adversaries is: 42.44033898364709. distance: 2.1382993887597825
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1381, Accuracy: 9545/9900 (96.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4489/5066 (88.6103%), train_poison_data_count: 400
Global model norm: 42.43486650748194.
Norm before scaling: 42.4408653396847. Distance: 2.226029717129623
Total norm for 4 adversaries is: 42.4408653396847. distance: 2.226029717129623
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1922, Accuracy: 9426/9900 (95.2121%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3866/4501 (85.8920%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3932/4501 (87.3584%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0082, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3658/4175 (87.6168%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3700/4175 (88.6228%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9451, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3124/3616 (86.3938%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3227/3616 (89.2423%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9281, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4028/4634 (86.9227%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4085/4634 (88.1528%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0754, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3967/4558 (87.0338%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3964/4558 (86.9680%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0705, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4529/5167 (87.6524%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4603/5167 (89.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2443, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3843/4356 (88.2231%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3799/4356 (87.2130%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2999, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4092/4716 (86.7684%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4167/4716 (88.3588%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0138, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5295/6124 (86.4631%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5332/6124 (87.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0396, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4414/5055 (87.3195%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4534/5055 (89.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1997, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4467/5025 (88.8955%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4532/5025 (90.1891%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1561, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4324/4918 (87.9219%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4372/4918 (88.8979%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1071, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3707/4223 (87.7812%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3794/4223 (89.8413%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9551, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3845/4481 (85.8067%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3838/4481 (85.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0602, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3143/3638 (86.3936%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3259/3638 (89.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9524, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3547/4013 (88.3877%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3635/4013 (90.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8463, Accuracy: 5644/10000 (56.4400%)
time spent on training: 264.8288197517395
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1158, Accuracy: 7029/10000 (70.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.2756, Accuracy: 64/9900 (0.6465%)
Done in 294.16770100593567 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4387/4885 (89.8055%), train_poison_data_count: 385
Global model norm: 42.43537854831818.
Norm before scaling: 42.439858642112604. Distance: 2.1096774414256676
Total norm for 4 adversaries is: 42.439858642112604. distance: 2.1096774414256676
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2484, Accuracy: 9285/9900 (93.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 42.43537854831818.
Norm before scaling: 42.43532676918858. Distance: 2.1805577882187004
Total norm for 4 adversaries is: 42.43532676918858. distance: 2.1805577882187004
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2251, Accuracy: 9356/9900 (94.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4212/4717 (89.2940%), train_poison_data_count: 370
Global model norm: 42.43537854831818.
Norm before scaling: 42.440849520336094. Distance: 2.104928989617124
Total norm for 4 adversaries is: 42.440849520336094. distance: 2.104928989617124
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2962, Accuracy: 9156/9900 (92.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4483/5066 (88.4919%), train_poison_data_count: 400
Global model norm: 42.43537854831818.
Norm before scaling: 42.442855654323616. Distance: 2.256405930137044
Total norm for 4 adversaries is: 42.442855654323616. distance: 2.256405930137044
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1353, Accuracy: 9530/9900 (96.2626%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3138/3646 (86.0669%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3283/3646 (90.0439%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8365, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3885/4501 (86.3142%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4003/4501 (88.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0306, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4038/4651 (86.8200%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4184/4651 (89.9591%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0519, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4534/5167 (87.7492%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4637/5167 (89.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1362, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4836/5455 (88.6526%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4844/5455 (88.7993%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1076, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4841/5591 (86.5856%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4825/5591 (86.2994%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0306, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4150/4679 (88.6942%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4002/4679 (85.5311%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2567, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4394/5017 (87.5822%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4463/5017 (88.9575%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9228, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4169/4793 (86.9810%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4276/4793 (89.2134%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1040, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3984/4456 (89.4075%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4053/4456 (90.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9679, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4776/5424 (88.0531%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4900/5424 (90.3392%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2024, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3623/4175 (86.7784%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3649/4175 (87.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0582, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4494/5116 (87.8421%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4501/5116 (87.9789%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0173, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3227/3704 (87.1220%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3321/3704 (89.6598%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9703, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4428/5232 (84.6330%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4561/5232 (87.1751%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1882, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3074/3472 (88.5369%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3155/3472 (90.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0627, Accuracy: 5379/10000 (53.7900%)
time spent on training: 265.1887013912201
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1154, Accuracy: 7029/10000 (70.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.2575, Accuracy: 64/9900 (0.6465%)
Done in 294.2094328403473 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4375/4885 (89.5599%), train_poison_data_count: 385
Global model norm: 42.43595386772945.
Norm before scaling: 42.44073159409705. Distance: 2.128423289541554
Total norm for 4 adversaries is: 42.44073159409705. distance: 2.128423289541554
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3299, Accuracy: 9050/9900 (91.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 42.43595386772945.
Norm before scaling: 42.43661547541006. Distance: 2.179917408839792
Total norm for 4 adversaries is: 42.43661547541006. distance: 2.179917408839792
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2033, Accuracy: 9408/9900 (95.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4203/4717 (89.1032%), train_poison_data_count: 370
Global model norm: 42.43595386772945.
Norm before scaling: 42.43915537778394. Distance: 2.0913987123612183
Total norm for 4 adversaries is: 42.43915537778394. distance: 2.0913987123612183
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1651, Accuracy: 9479/9900 (95.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 42.43595386772945.
Norm before scaling: 42.443213728481524. Distance: 2.234623821782523
Total norm for 4 adversaries is: 42.443213728481524. distance: 2.234623821782523
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2709, Accuracy: 9192/9900 (92.8485%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3185/3590 (88.7187%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3306/3590 (92.0891%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0876, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3828/4368 (87.6374%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3819/4368 (87.4313%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9335, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3232/3704 (87.2570%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3352/3704 (90.4968%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9298, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4299/4928 (87.2362%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4364/4928 (88.5552%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0904, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3849/4356 (88.3609%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3834/4356 (88.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1075, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3436/3911 (87.8548%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3363/3911 (85.9882%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1693, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4067/4651 (87.4436%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4127/4651 (88.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1778, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3667/4184 (87.6434%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3743/4184 (89.4598%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9760, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3867/4346 (88.9784%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3959/4346 (91.0953%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8107, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4144/4793 (86.4594%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4348/4793 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0349, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3357/3804 (88.2492%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3449/3804 (90.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9873, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4415/4986 (88.5479%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4465/4986 (89.5507%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8841, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5266/6124 (85.9895%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5325/6124 (86.9530%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0944, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4106/4707 (87.2318%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4207/4707 (89.3775%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0314, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3759/4235 (88.7603%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3728/4235 (88.0283%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1199, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3616/4046 (89.3722%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3678/4046 (90.9046%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0362, Accuracy: 5320/10000 (53.2000%)
time spent on training: 255.74991703033447
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1151, Accuracy: 7030/10000 (70.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.2408, Accuracy: 65/9900 (0.6566%)
Done in 284.68329215049744 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 42.43644288309651.
Norm before scaling: 42.44104510459553. Distance: 2.1391900815178864
Total norm for 4 adversaries is: 42.44104510459553. distance: 2.1391900815178864
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1496, Accuracy: 9511/9900 (96.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4750/5305 (89.5382%), train_poison_data_count: 415
Global model norm: 42.43644288309651.
Norm before scaling: 42.440198045676574. Distance: 2.1843965586633964
Total norm for 4 adversaries is: 42.440198045676574. distance: 2.1843965586633964
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0693, Accuracy: 9727/9900 (98.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4220/4717 (89.4636%), train_poison_data_count: 370
Global model norm: 42.43644288309651.
Norm before scaling: 42.437866748691405. Distance: 2.071455960022207
Total norm for 4 adversaries is: 42.437866748691405. distance: 2.071455960022207
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3798, Accuracy: 9013/9900 (91.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4480/5066 (88.4327%), train_poison_data_count: 400
Global model norm: 42.43644288309651.
Norm before scaling: 42.444036280970174. Distance: 2.2835538544173137
Total norm for 4 adversaries is: 42.444036280970174. distance: 2.2835538544173137
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2133, Accuracy: 9358/9900 (94.5253%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4386/4986 (87.9663%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4476/4986 (89.7714%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9887, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4006/4634 (86.4480%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4145/4634 (89.4476%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8957, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4098/4716 (86.8957%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4181/4716 (88.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0193, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5259/6124 (85.8752%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5394/6124 (88.0797%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0029, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4319/4918 (87.8203%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4436/4918 (90.1993%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0283, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3334/3797 (87.8062%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3367/3797 (88.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1676, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4929/5582 (88.3017%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4996/5582 (89.5020%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1032, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4247/4956 (85.6941%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4302/4956 (86.8039%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1570, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3937/4433 (88.8112%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4001/4433 (90.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9570, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3816/4354 (87.6435%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0118, Accuracy: 3415/4354 (78.4336%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3142, Accuracy: 4879/10000 (48.7900%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4287/4928 (86.9927%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4386/4928 (89.0016%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9245, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3426/3911 (87.5991%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3406/3911 (87.0877%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0372, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0089, Accuracy: 3791/4481 (84.6017%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3796/4481 (84.7132%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1243, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4533/5197 (87.2234%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4575/5197 (88.0316%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0477, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4818/5455 (88.3226%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4860/5455 (89.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0242, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3775/4361 (86.5627%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3751/4361 (86.0124%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0696, Accuracy: 5222/10000 (52.2200%)
time spent on training: 263.63509249687195
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1147, Accuracy: 7034/10000 (70.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 9.2148, Accuracy: 66/9900 (0.6667%)
Done in 292.81572675704956 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 42.43717639558136.
Norm before scaling: 42.443033972755764. Distance: 2.1066914760762465
Total norm for 4 adversaries is: 42.443033972755764. distance: 2.1066914760762465
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1830, Accuracy: 9457/9900 (95.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.43717639558136.
Norm before scaling: 42.43854127036237. Distance: 2.151970528092352
Total norm for 4 adversaries is: 42.43854127036237. distance: 2.151970528092352
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1891, Accuracy: 9420/9900 (95.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 42.43717639558136.
Norm before scaling: 42.44050293130962. Distance: 2.0786933982056843
Total norm for 4 adversaries is: 42.44050293130962. distance: 2.0786933982056843
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1650, Accuracy: 9474/9900 (95.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4463/5066 (88.0971%), train_poison_data_count: 400
Global model norm: 42.43717639558136.
Norm before scaling: 42.4442606107005. Distance: 2.2680805448126327
Total norm for 4 adversaries is: 42.4442606107005. distance: 2.2680805448126327
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2706, Accuracy: 9224/9900 (93.1717%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4257/4928 (86.3839%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4347/4928 (88.2102%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9997, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3698/4184 (88.3843%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3779/4184 (90.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9193, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4175/4707 (88.6977%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4229/4707 (89.8449%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1244, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3350/3828 (87.5131%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3492/3828 (91.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9492, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3920/4503 (87.0531%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4031/4503 (89.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8756, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4122/4662 (88.4170%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4224/4662 (90.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0530, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3671/4235 (86.6824%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3769/4235 (88.9965%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1165, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 4361/5244 (83.1617%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4449/5244 (84.8398%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9608, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4158/4793 (86.7515%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4303/4793 (89.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1275, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3878/4481 (86.5432%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3833/4481 (85.5389%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2223, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3887/4346 (89.4386%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3974/4346 (91.4404%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8308, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3768/4361 (86.4022%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3693/4361 (84.6824%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2446, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4488/5055 (88.7834%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4541/5055 (89.8318%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9904, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4475/5195 (86.1405%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4503/5195 (86.6795%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2090, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3884/4315 (90.0116%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3959/4315 (91.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9945, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4132/4663 (88.6125%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4247/4663 (91.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0885, Accuracy: 5271/10000 (52.7100%)
time spent on training: 262.94020819664
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1144, Accuracy: 7034/10000 (70.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.1983, Accuracy: 68/9900 (0.6869%)
Done in 292.2494089603424 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4369/4885 (89.4371%), train_poison_data_count: 385
Global model norm: 42.43769128500704.
Norm before scaling: 42.44382201621044. Distance: 2.1121797352735734
Total norm for 4 adversaries is: 42.44382201621044. distance: 2.1121797352735734
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2572, Accuracy: 9282/9900 (93.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 42.43769128500704.
Norm before scaling: 42.44120185897632. Distance: 2.1541906280463876
Total norm for 4 adversaries is: 42.44120185897632. distance: 2.1541906280463876
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3278, Accuracy: 9132/9900 (92.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 42.43769128500704.
Norm before scaling: 42.43939699138275. Distance: 2.0617115941416766
Total norm for 4 adversaries is: 42.43939699138275. distance: 2.0617115941416766
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2020, Accuracy: 9398/9900 (94.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 42.43769128500704.
Norm before scaling: 42.444247668632904. Distance: 2.2212192603256002
Total norm for 4 adversaries is: 42.444247668632904. distance: 2.2212192603256002
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1274, Accuracy: 9547/9900 (96.4343%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3888/4315 (90.1043%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3884/4315 (90.0116%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9659, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3210/3590 (89.4150%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3179/3590 (88.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1927, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4128/4679 (88.2240%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4223/4679 (90.2543%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9736, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4509/5167 (87.2653%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4624/5167 (89.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1168, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3316/3775 (87.8411%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3490/3775 (92.4503%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8540, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3350/3828 (87.5131%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3436/3828 (89.7597%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9680, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3712/4235 (87.6505%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3789/4235 (89.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9592, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4067/4647 (87.5188%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4187/4647 (90.1011%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0116, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4311/4918 (87.6576%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4422/4918 (89.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1206, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3954/4433 (89.1947%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3973/4433 (89.6233%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9658, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3864/4481 (86.2308%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3814/4481 (85.1149%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1824, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3756/4295 (87.4505%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3674/4295 (85.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1222, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3959/4503 (87.9192%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4013/4503 (89.1184%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0116, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3750/4354 (86.1277%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3540/4354 (81.3045%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.5459, Accuracy: 4657/10000 (46.5700%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4397/4986 (88.1869%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4380/4986 (87.8460%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0356, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5523/6263 (88.1846%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5687/6263 (90.8031%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1468, Accuracy: 5163/10000 (51.6300%)
time spent on training: 264.8400933742523
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1141, Accuracy: 7039/10000 (70.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.1841, Accuracy: 69/9900 (0.6970%)
Done in 293.78228402137756 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4378/4885 (89.6213%), train_poison_data_count: 385
Global model norm: 42.438155830720305.
Norm before scaling: 42.44142620368836. Distance: 2.13303606028418
Total norm for 4 adversaries is: 42.44142620368836. distance: 2.13303606028418
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1907, Accuracy: 9426/9900 (95.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4722/5305 (89.0104%), train_poison_data_count: 415
Global model norm: 42.438155830720305.
Norm before scaling: 42.443475451457054. Distance: 2.2736828858388423
Total norm for 4 adversaries is: 42.443475451457054. distance: 2.2736828858388423
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0529, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4216/4717 (89.3788%), train_poison_data_count: 370
Global model norm: 42.438155830720305.
Norm before scaling: 42.44253065267345. Distance: 2.083200781102188
Total norm for 4 adversaries is: 42.44253065267345. distance: 2.083200781102188
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1148, Accuracy: 9604/9900 (97.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.438155830720305.
Norm before scaling: 42.44429799887362. Distance: 2.2401764786546567
Total norm for 4 adversaries is: 42.44429799887362. distance: 2.2401764786546567
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0900, Accuracy: 9667/9900 (97.6465%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3685/4223 (87.2602%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3794/4223 (89.8413%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1175, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4875/5455 (89.3676%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4842/5455 (88.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0728, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4994/5582 (89.4661%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5041/5582 (90.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2949, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3973/4465 (88.9810%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4034/4465 (90.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8462, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4841/5591 (86.5856%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4879/5591 (87.2652%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1888, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3434/3911 (87.8036%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3322/3911 (84.9399%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1795, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3820/4356 (87.6951%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0136, Accuracy: 3345/4356 (76.7906%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.5917, Accuracy: 4611/10000 (46.1100%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4382/5037 (86.9962%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4511/5037 (89.5573%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0093, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4126/4679 (88.1812%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4238/4679 (90.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1139, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3936/4362 (90.2338%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3903/4362 (89.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1528, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4012/4518 (88.8004%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4122/4518 (91.2351%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0321, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4408/5083 (86.7204%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4448/5083 (87.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2317, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3544/4013 (88.3130%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3663/4013 (91.2783%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8271, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4513/5197 (86.8386%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4604/5197 (88.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1370, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2922/3297 (88.6260%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3057/3297 (92.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8405, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3936/4441 (88.6287%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3969/4441 (89.3718%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1812, Accuracy: 5257/10000 (52.5700%)
time spent on training: 263.27099227905273
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1137, Accuracy: 7041/10000 (70.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.1661, Accuracy: 69/9900 (0.6970%)
Done in 292.3261384963989 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4365/4885 (89.3552%), train_poison_data_count: 385
Global model norm: 42.43863475333016.
Norm before scaling: 42.44231638031273. Distance: 2.1281183587193317
Total norm for 4 adversaries is: 42.44231638031273. distance: 2.1281183587193317
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2205, Accuracy: 9365/9900 (94.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4744/5305 (89.4251%), train_poison_data_count: 415
Global model norm: 42.43863475333016.
Norm before scaling: 42.439632850950034. Distance: 2.1662666856372974
Total norm for 4 adversaries is: 42.439632850950034. distance: 2.1662666856372974
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2193, Accuracy: 9387/9900 (94.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 42.43863475333016.
Norm before scaling: 42.44140894644492. Distance: 2.078143585810333
Total norm for 4 adversaries is: 42.44140894644492. distance: 2.078143585810333
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3935, Accuracy: 8913/9900 (90.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4500/5066 (88.8275%), train_poison_data_count: 400
Global model norm: 42.43863475333016.
Norm before scaling: 42.44459710307294. Distance: 2.2530056693001104
Total norm for 4 adversaries is: 42.44459710307294. distance: 2.2530056693001104
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2026, Accuracy: 9353/9900 (94.4747%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3942/4501 (87.5805%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4006/4501 (89.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1700, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3943/4511 (87.4086%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4034/4511 (89.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0508, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3820/4354 (87.7354%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0112, Accuracy: 3436/4354 (78.9159%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.4754, Accuracy: 4560/10000 (45.6000%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3862/4346 (88.8633%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4004/4346 (92.1307%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9005, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4128/4707 (87.6992%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4232/4707 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0375, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4826/5591 (86.3173%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4898/5591 (87.6051%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0860, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4030/4647 (86.7226%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4142/4647 (89.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8420, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4011/4538 (88.3870%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4139/4538 (91.2076%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9398, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4300/4934 (87.1504%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4358/4934 (88.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2318, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4208/4804 (87.5937%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4176/4804 (86.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1014, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5534/6263 (88.3602%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5625/6263 (89.8132%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1262, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0086, Accuracy: 3834/4481 (85.5613%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3904/4481 (87.1234%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2731, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4340/5063 (85.7199%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4362/5063 (86.1545%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9297, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3695/4223 (87.4970%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3847/4223 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0667, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3984/4441 (89.7095%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4064/4441 (91.5109%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0398, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3340/3756 (88.9244%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3459/3756 (92.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9299, Accuracy: 5603/10000 (56.0300%)
time spent on training: 266.94109869003296
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1133, Accuracy: 7044/10000 (70.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 9.1464, Accuracy: 71/9900 (0.7172%)
Done in 295.7921998500824 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 42.439175512303045.
Norm before scaling: 42.4445554011716. Distance: 2.1365066227755576
Total norm for 4 adversaries is: 42.4445554011716. distance: 2.1365066227755576
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1667, Accuracy: 9493/9900 (95.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 42.439175512303045.
Norm before scaling: 42.437717173137244. Distance: 2.1983902286959274
Total norm for 4 adversaries is: 42.437717173137244. distance: 2.1983902286959274
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0708, Accuracy: 9709/9900 (98.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4212/4717 (89.2940%), train_poison_data_count: 370
Global model norm: 42.439175512303045.
Norm before scaling: 42.445658330774094. Distance: 2.0844700827351472
Total norm for 4 adversaries is: 42.445658330774094. distance: 2.0844700827351472
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3594, Accuracy: 8985/9900 (90.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 42.439175512303045.
Norm before scaling: 42.446209065857694. Distance: 2.237043161479734
Total norm for 4 adversaries is: 42.446209065857694. distance: 2.237043161479734
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2185, Accuracy: 9325/9900 (94.1919%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 4352/5244 (82.9901%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4517/5244 (86.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0827, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4280/4928 (86.8506%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4416/4928 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8993, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3343/3804 (87.8812%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3410/3804 (89.6425%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0197, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3566/4013 (88.8612%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3635/4013 (90.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9576, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3551/4158 (85.4016%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3602/4158 (86.6282%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0039, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5028/5582 (90.0752%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4941/5582 (88.5167%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1300, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4795/5455 (87.9010%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4890/5455 (89.6425%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9856, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3799/4354 (87.2531%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0132, Accuracy: 3313/4354 (76.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.7306, Accuracy: 4361/10000 (43.6100%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3948/4433 (89.0593%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3989/4433 (89.9842%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9690, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3126/3646 (85.7378%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3284/3646 (90.0713%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9704, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3971/4518 (87.8929%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4076/4518 (90.2169%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1158, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3743/4235 (88.3825%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3791/4235 (89.5159%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2717, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3923/4362 (89.9358%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3929/4362 (90.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1468, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4775/5392 (88.5571%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4757/5392 (88.2233%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2044, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4788/5591 (85.6376%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4840/5591 (86.5677%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1266, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3325/3756 (88.5250%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3450/3756 (91.8530%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0215, Accuracy: 5536/10000 (55.3600%)
time spent on training: 263.64204716682434
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1130, Accuracy: 7043/10000 (70.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 9.1298, Accuracy: 72/9900 (0.7273%)
Done in 292.74918127059937 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4380/4885 (89.6622%), train_poison_data_count: 385
Global model norm: 42.43971482622439.
Norm before scaling: 42.446467894499186. Distance: 2.137420483275731
Total norm for 4 adversaries is: 42.446467894499186. distance: 2.137420483275731
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1167, Accuracy: 9586/9900 (96.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 42.43971482622439.
Norm before scaling: 42.438777134685445. Distance: 2.186347221712315
Total norm for 4 adversaries is: 42.438777134685445. distance: 2.186347221712315
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0164, Accuracy: 9849/9900 (99.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4183/4717 (88.6792%), train_poison_data_count: 370
Global model norm: 42.43971482622439.
Norm before scaling: 42.44653547727349. Distance: 2.135692956930026
Total norm for 4 adversaries is: 42.44653547727349. distance: 2.135692956930026
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1185, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4474/5066 (88.3143%), train_poison_data_count: 400
Global model norm: 42.43971482622439.
Norm before scaling: 42.44854134254056. Distance: 2.302664382815632
Total norm for 4 adversaries is: 42.44854134254056. distance: 2.302664382815632
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1291, Accuracy: 9553/9900 (96.4949%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4100/4634 (88.4765%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4137/4634 (89.2749%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0714, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3966/4503 (88.0746%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3924/4503 (87.1419%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0460, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4258/4928 (86.4042%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4448/4928 (90.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7764, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3323/3804 (87.3554%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3426/3804 (90.0631%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0230, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3204/3590 (89.2479%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3090/3590 (86.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2558, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4051/4647 (87.1745%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4205/4647 (90.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9588, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3957/4625 (85.5568%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4025/4625 (87.0270%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2237, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3878/4356 (89.0266%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3811/4356 (87.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0557, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3371/3797 (88.7806%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3426/3797 (90.2291%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9974, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3966/4456 (89.0036%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4035/4456 (90.5521%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9137, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3516/4025 (87.3540%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3670/4025 (91.1801%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9196, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3090/3472 (88.9977%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3111/3472 (89.6025%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0489, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2896/3297 (87.8374%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2983/3297 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9255, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3832/4416 (86.7754%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3936/4416 (89.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9877, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3884/4356 (89.1644%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3961/4356 (90.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1031, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3134/3638 (86.1462%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3285/3638 (90.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8828, Accuracy: 5572/10000 (55.7200%)
time spent on training: 253.98208928108215
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1128, Accuracy: 7044/10000 (70.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 9.1100, Accuracy: 74/9900 (0.7475%)
Done in 283.2597224712372 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4358/4885 (89.2119%), train_poison_data_count: 385
Global model norm: 42.440070050583536.
Norm before scaling: 42.44772319102124. Distance: 2.195666735974817
Total norm for 4 adversaries is: 42.44772319102124. distance: 2.195666735974817
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1489, Accuracy: 9528/9900 (96.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 42.440070050583536.
Norm before scaling: 42.44221859122485. Distance: 2.1693051729693726
Total norm for 4 adversaries is: 42.44221859122485. distance: 2.1693051729693726
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1669, Accuracy: 9486/9900 (95.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4197/4717 (88.9760%), train_poison_data_count: 370
Global model norm: 42.440070050583536.
Norm before scaling: 42.441370117621524. Distance: 2.0883727984442775
Total norm for 4 adversaries is: 42.441370117621524. distance: 2.0883727984442775
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1711, Accuracy: 9455/9900 (95.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 42.440070050583536.
Norm before scaling: 42.446818748582324. Distance: 2.233087128500391
Total norm for 4 adversaries is: 42.446818748582324. distance: 2.233087128500391
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1215, Accuracy: 9598/9900 (96.9495%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3637/4175 (87.1138%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3701/4175 (88.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9314, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4216/4956 (85.0686%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4357/4956 (87.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1741, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4354/5037 (86.4403%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4526/5037 (89.8551%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0904, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4147/4793 (86.5220%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4258/4793 (88.8379%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1197, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3307/3804 (86.9348%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3397/3804 (89.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0373, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4762/5392 (88.3160%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4806/5392 (89.1320%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0671, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3976/4465 (89.0482%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4079/4465 (91.3550%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9579, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4095/4596 (89.0992%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4156/4596 (90.4265%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0293, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5243/6124 (85.6140%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5326/6124 (86.9693%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9685, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2854/3271 (87.2516%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2958/3271 (90.4311%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1330, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3148/3590 (87.6880%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3210/3590 (89.4150%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1173, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3854/4501 (85.6254%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4009/4501 (89.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0539, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4552/5232 (87.0031%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4593/5232 (87.7867%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1007, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3181/3672 (86.6285%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3273/3672 (89.1340%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1383, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3733/4223 (88.3969%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3793/4223 (89.8177%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1898, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3789/4354 (87.0234%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0154, Accuracy: 3138/4354 (72.0717%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.8310, Accuracy: 4261/10000 (42.6100%)
time spent on training: 243.32281136512756
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1125, Accuracy: 7045/10000 (70.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 9.0928, Accuracy: 76/9900 (0.7677%)
Done in 267.80737566947937 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 42.440533132125736.
Norm before scaling: 42.44441016319537. Distance: 2.0808163761073826
Total norm for 4 adversaries is: 42.44441016319537. distance: 2.0808163761073826
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2860, Accuracy: 9234/9900 (93.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 42.440533132125736.
Norm before scaling: 42.439638603606035. Distance: 2.1302159191888794
Total norm for 4 adversaries is: 42.439638603606035. distance: 2.1302159191888794
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1158, Accuracy: 9594/9900 (96.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4192/4717 (88.8700%), train_poison_data_count: 370
Global model norm: 42.440533132125736.
Norm before scaling: 42.448328538390356. Distance: 2.1979709154518217
Total norm for 4 adversaries is: 42.448328538390356. distance: 2.1979709154518217
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0441, Accuracy: 9773/9900 (98.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4490/5066 (88.6301%), train_poison_data_count: 400
Global model norm: 42.440533132125736.
Norm before scaling: 42.45159093888223. Distance: 2.2609622724608776
Total norm for 4 adversaries is: 42.45159093888223. distance: 2.2609622724608776
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1546, Accuracy: 9516/9900 (96.1212%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4983/5582 (89.2691%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5038/5582 (90.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1850, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4041/4647 (86.9593%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4166/4647 (89.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0816, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3938/4465 (88.1971%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4133/4465 (92.5644%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9375, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4423/5083 (87.0155%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4446/5083 (87.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1004, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3767/4416 (85.3034%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3904/4416 (88.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9616, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4249/4956 (85.7345%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4372/4956 (88.2163%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1665, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3945/4362 (90.4402%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3820/4362 (87.5745%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1763, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3837/4356 (88.0854%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3780/4356 (86.7769%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.4431, Accuracy: 4756/10000 (47.5600%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3345/3781 (88.4687%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3414/3781 (90.2936%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0145, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3198/3590 (89.0808%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3200/3590 (89.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9920, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4079/4651 (87.7016%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4186/4651 (90.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1174, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4107/4662 (88.0952%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4158/4662 (89.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0696, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3090/3472 (88.9977%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3180/3472 (91.5899%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0655, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4786/5424 (88.2375%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4908/5424 (90.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1617, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2883/3271 (88.1382%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0063, Accuracy: 2885/3271 (88.1993%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9652, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4355/5037 (86.4602%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4505/5037 (89.4382%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9559, Accuracy: 5538/10000 (55.3800%)
time spent on training: 234.65603184700012
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1122, Accuracy: 7047/10000 (70.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 9.0783, Accuracy: 76/9900 (0.7677%)
Done in 259.2532043457031 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 42.440932931380495.
Norm before scaling: 42.44389966933558. Distance: 2.0994689042763155
Total norm for 4 adversaries is: 42.44389966933558. distance: 2.0994689042763155
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1748, Accuracy: 9450/9900 (95.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 42.440932931380495.
Norm before scaling: 42.44455252517689. Distance: 2.216564122555315
Total norm for 4 adversaries is: 42.44455252517689. distance: 2.216564122555315
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1198, Accuracy: 9576/9900 (96.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 42.440932931380495.
Norm before scaling: 42.4403734989971. Distance: 2.0433567473712437
Total norm for 4 adversaries is: 42.4403734989971. distance: 2.0433567473712437
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2980, Accuracy: 9168/9900 (92.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4460/5066 (88.0379%), train_poison_data_count: 400
Global model norm: 42.440932931380495.
Norm before scaling: 42.44905753195897. Distance: 2.269636719660968
Total norm for 4 adversaries is: 42.44905753195897. distance: 2.269636719660968
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.4380, Accuracy: 8856/9900 (89.4545%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4289/4989 (85.9691%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4351/4989 (87.2119%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0577, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3561/4013 (88.7366%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3715/4013 (92.5741%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8549, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4495/5195 (86.5255%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4446/5195 (85.5823%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2809, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3524/3969 (88.7881%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3531/3969 (88.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9123, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3874/4356 (88.9348%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3794/4356 (87.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2204, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3991/4441 (89.8671%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4018/4441 (90.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1003, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4004/4518 (88.6233%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4094/4518 (90.6153%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9761, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3394/3911 (86.7809%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3247/3911 (83.0222%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1963, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3893/4362 (89.2481%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3862/4362 (88.5374%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0442, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3304/3804 (86.8559%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3439/3804 (90.4048%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9666, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3712/4223 (87.8996%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3824/4223 (90.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9592, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4077/4634 (87.9801%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4149/4634 (89.5339%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9569, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3838/4354 (88.1488%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0145, Accuracy: 3195/4354 (73.3808%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.7669, Accuracy: 4247/10000 (42.4700%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 4372/5244 (83.3715%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4492/5244 (85.6598%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9551, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4353/5037 (86.4205%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4529/5037 (89.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9985, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3211/3704 (86.6901%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3308/3704 (89.3089%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9935, Accuracy: 5464/10000 (54.6400%)
time spent on training: 230.13806295394897
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1119, Accuracy: 7050/10000 (70.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 9.0630, Accuracy: 76/9900 (0.7677%)
Done in 254.91960453987122 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4359/4885 (89.2323%), train_poison_data_count: 385
Global model norm: 42.44149379449093.
Norm before scaling: 42.446952474990034. Distance: 2.140774575458254
Total norm for 4 adversaries is: 42.446952474990034. distance: 2.140774575458254
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1586, Accuracy: 9501/9900 (95.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 42.44149379449093.
Norm before scaling: 42.444483501245486. Distance: 2.188527764977217
Total norm for 4 adversaries is: 42.444483501245486. distance: 2.188527764977217
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0832, Accuracy: 9682/9900 (97.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 42.44149379449093.
Norm before scaling: 42.441221992524554. Distance: 2.0562648737870943
Total norm for 4 adversaries is: 42.441221992524554. distance: 2.0562648737870943
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1602, Accuracy: 9452/9900 (95.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4506/5066 (88.9459%), train_poison_data_count: 400
Global model norm: 42.44149379449093.
Norm before scaling: 42.448673625663794. Distance: 2.216076489330023
Total norm for 4 adversaries is: 42.448673625663794. distance: 2.216076489330023
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2843, Accuracy: 9222/9900 (93.1515%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3784/4416 (85.6884%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3898/4416 (88.2699%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9664, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4516/5197 (86.8963%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4528/5197 (87.1272%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0657, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4288/4918 (87.1899%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4368/4918 (88.8166%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1143, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5548/6263 (88.5837%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5636/6263 (89.9888%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1433, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3160/3646 (86.6703%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3291/3646 (90.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0266, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4178/4707 (88.7614%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4209/4707 (89.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0638, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4355/5063 (86.0162%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4264/5063 (84.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2319, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3725/4295 (86.7288%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3846/4295 (89.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9612, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4150/4793 (86.5846%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4308/4793 (89.8811%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1147, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4015/4538 (88.4751%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4153/4538 (91.5161%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9319, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4434/5083 (87.2319%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4467/5083 (87.8812%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0449, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3145/3638 (86.4486%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3211/3638 (88.2628%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9543, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5288/6124 (86.3488%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5356/6124 (87.4592%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0483, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4047/4618 (87.6353%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4017/4618 (86.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0675, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3524/3969 (88.7881%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3560/3969 (89.6951%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9234, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0087, Accuracy: 3462/4158 (83.2612%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3606/4158 (86.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0014, Accuracy: 5247/10000 (52.4700%)
time spent on training: 239.13559341430664
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1116, Accuracy: 7049/10000 (70.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.0445, Accuracy: 77/9900 (0.7778%)
Done in 263.7715976238251 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 42.44197843177348.
Norm before scaling: 42.447107769644475. Distance: 2.0962898449872758
Total norm for 4 adversaries is: 42.447107769644475. distance: 2.0962898449872758
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3670, Accuracy: 9058/9900 (91.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4743/5305 (89.4062%), train_poison_data_count: 415
Global model norm: 42.44197843177348.
Norm before scaling: 42.44291317648036. Distance: 2.1673659027751753
Total norm for 4 adversaries is: 42.44291317648036. distance: 2.1673659027751753
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2793, Accuracy: 9198/9900 (92.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4205/4717 (89.1456%), train_poison_data_count: 370
Global model norm: 42.44197843177348.
Norm before scaling: 42.443417930062346. Distance: 2.082604420621095
Total norm for 4 adversaries is: 42.443417930062346. distance: 2.082604420621095
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2086, Accuracy: 9365/9900 (94.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4462/5066 (88.0774%), train_poison_data_count: 400
Global model norm: 42.44197843177348.
Norm before scaling: 42.44772031524116. Distance: 2.2647615036862274
Total norm for 4 adversaries is: 42.44772031524116. distance: 2.2647615036862274
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2561, Accuracy: 9251/9900 (93.4444%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4043/4716 (85.7294%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4132/4716 (87.6166%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1619, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3829/4481 (85.4497%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3884/4481 (86.6771%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1752, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3852/4361 (88.3284%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3731/4361 (85.5538%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1030, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4190/4793 (87.4192%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4335/4793 (90.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2240, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3759/4295 (87.5204%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3722/4295 (86.6589%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2196, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4412/5244 (84.1342%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4512/5244 (86.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0628, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4338/4989 (86.9513%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4448/4989 (89.1561%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9825, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4549/5197 (87.5313%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4581/5197 (88.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0406, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3852/4356 (88.4298%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3691/4356 (84.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3895, Accuracy: 4707/10000 (47.0700%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4024/4647 (86.5935%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4118/4647 (88.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0285, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3552/4013 (88.5123%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3655/4013 (91.0790%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8088, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4025/4538 (88.6955%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4135/4538 (91.1194%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9204, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4121/4707 (87.5505%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4236/4707 (89.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8737, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5519/6263 (88.1207%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5673/6263 (90.5796%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2556, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3737/4235 (88.2409%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3701/4235 (87.3908%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.4072, Accuracy: 4878/10000 (48.7800%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3353/3861 (86.8428%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3435/3861 (88.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2294, Accuracy: 5050/10000 (50.5000%)
time spent on training: 237.36139225959778
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1113, Accuracy: 7053/10000 (70.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 9.0320, Accuracy: 77/9900 (0.7778%)
Done in 261.8328335285187 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4356/4885 (89.1709%), train_poison_data_count: 385
Global model norm: 42.44244149249369.
Norm before scaling: 42.44891662293559. Distance: 2.1808915726384073
Total norm for 4 adversaries is: 42.44891662293559. distance: 2.1808915726384073
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1280, Accuracy: 9577/9900 (96.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 42.44244149249369.
Norm before scaling: 42.444066479272166. Distance: 2.162697041084607
Total norm for 4 adversaries is: 42.444066479272166. distance: 2.162697041084607
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2164, Accuracy: 9374/9900 (94.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4212/4717 (89.2940%), train_poison_data_count: 370
Global model norm: 42.44244149249369.
Norm before scaling: 42.44523269249814. Distance: 2.092396882500475
Total norm for 4 adversaries is: 42.44523269249814. distance: 2.092396882500475
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1535, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4487/5066 (88.5709%), train_poison_data_count: 400
Global model norm: 42.44244149249369.
Norm before scaling: 42.45018766292073. Distance: 2.2689439338626696
Total norm for 4 adversaries is: 42.45018766292073. distance: 2.2689439338626696
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1506, Accuracy: 9503/9900 (95.9899%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4463/5055 (88.2888%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4537/5055 (89.7527%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0026, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3369/3828 (88.0094%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3497/3828 (91.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1037, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3792/4361 (86.9525%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3806/4361 (87.2736%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0756, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3523/4013 (87.7897%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3680/4013 (91.7020%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9358, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3993/4518 (88.3798%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4130/4518 (91.4121%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9298, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3985/4558 (87.4287%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4020/4558 (88.1966%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1696, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3613/4126 (87.5667%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3727/4126 (90.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9304, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4123/4679 (88.1171%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3888/4679 (83.0947%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2764, Accuracy: 4769/10000 (47.6900%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3749/4235 (88.5242%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3737/4235 (88.2409%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9787, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4353/5037 (86.4205%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4563/5037 (90.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8654, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3202/3672 (87.2004%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3300/3672 (89.8693%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8775, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4263/4928 (86.5057%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4372/4928 (88.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0107, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3856/4356 (88.5216%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3776/4356 (86.6850%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2645, Accuracy: 5019/10000 (50.1900%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3973/4456 (89.1607%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4074/4456 (91.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1457, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4157/4793 (86.7306%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4341/4793 (90.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0176, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4369/5025 (86.9453%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4467/5025 (88.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1050, Accuracy: 5350/10000 (53.5000%)
time spent on training: 234.25908827781677
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1110, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 9.0197, Accuracy: 77/9900 (0.7778%)
Done in 258.8079562187195 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4369/4885 (89.4371%), train_poison_data_count: 385
Global model norm: 42.44279957014573.
Norm before scaling: 42.454165887129086. Distance: 2.194600814634794
Total norm for 4 adversaries is: 42.454165887129086. distance: 2.194600814634794
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1334, Accuracy: 9563/9900 (96.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 42.44279957014573.
Norm before scaling: 42.44612854106956. Distance: 2.1698326552596297
Total norm for 4 adversaries is: 42.44612854106956. distance: 2.1698326552596297
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1309, Accuracy: 9542/9900 (96.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 42.44279957014573.
Norm before scaling: 42.44589703145273. Distance: 2.06325782956138
Total norm for 4 adversaries is: 42.44589703145273. distance: 2.06325782956138
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.3147, Accuracy: 9105/9900 (91.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4457/5066 (87.9787%), train_poison_data_count: 400
Global model norm: 42.44279957014573.
Norm before scaling: 42.45147735577055. Distance: 2.2454290584076695
Total norm for 4 adversaries is: 42.45147735577055. distance: 2.2454290584076695
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1892, Accuracy: 9419/9900 (95.1414%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3873/4346 (89.1164%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3996/4346 (91.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9595, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3680/4184 (87.9541%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3757/4184 (89.7945%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9075, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3815/4356 (87.5803%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3626/4356 (83.2415%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2656, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3188/3646 (87.4383%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3302/3646 (90.5650%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8987, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4420/5083 (86.9565%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4498/5083 (88.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0311, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3840/4356 (88.1543%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3814/4356 (87.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.4641, Accuracy: 4729/10000 (47.2900%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4010/4558 (87.9772%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4063/4558 (89.1400%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9995, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3643/4175 (87.2575%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3672/4175 (87.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9660, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3059/3472 (88.1048%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3142/3472 (90.4954%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1717, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3948/4501 (87.7138%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4012/4501 (89.1357%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9886, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4746/5424 (87.5000%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4920/5424 (90.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2524, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3830/4481 (85.4720%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3920/4481 (87.4805%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0320, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4805/5455 (88.0843%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4812/5455 (88.2126%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2339, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4554/5232 (87.0413%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4607/5232 (88.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3108, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5420/6391 (84.8068%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5485/6391 (85.8238%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0360, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3372/3775 (89.3245%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3520/3775 (93.2450%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9421, Accuracy: 5598/10000 (55.9800%)
time spent on training: 235.1086151599884
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1106, Accuracy: 7050/10000 (70.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 8.9955, Accuracy: 78/9900 (0.7879%)
Done in 264.3983509540558 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4371/4885 (89.4780%), train_poison_data_count: 385
Global model norm: 42.44342943434752.
Norm before scaling: 42.44889361733634. Distance: 2.1960119036089574
Total norm for 4 adversaries is: 42.44889361733634. distance: 2.1960119036089574
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1750, Accuracy: 9427/9900 (95.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 42.44342943434752.
Norm before scaling: 42.44006861243423. Distance: 2.1161899820864862
Total norm for 4 adversaries is: 42.44006861243423. distance: 2.1161899820864862
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0951, Accuracy: 9643/9900 (97.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4237/4717 (89.8240%), train_poison_data_count: 370
Global model norm: 42.44342943434752.
Norm before scaling: 42.442675897081315. Distance: 2.0522388328334853
Total norm for 4 adversaries is: 42.442675897081315. distance: 2.0522388328334853
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1201, Accuracy: 9588/9900 (96.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4484/5066 (88.5116%), train_poison_data_count: 400
Global model norm: 42.44342943434752.
Norm before scaling: 42.45130626164892. Distance: 2.249673395824029
Total norm for 4 adversaries is: 42.45130626164892. distance: 2.249673395824029
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2077, Accuracy: 9366/9900 (94.6061%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3592/4025 (89.2422%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3675/4025 (91.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8842, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3742/4223 (88.6100%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3770/4223 (89.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0960, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3173/3638 (87.2183%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3324/3638 (91.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9074, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4336/5063 (85.6409%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4332/5063 (85.5619%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2725, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4276/4874 (87.7308%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4203/4874 (86.2331%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2539, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4206/4804 (87.5520%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3973/4804 (82.7019%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.4318, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3544/4158 (85.2333%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3580/4158 (86.0991%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9984, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3989/4518 (88.2913%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4101/4518 (90.7703%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0468, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3725/4235 (87.9575%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3720/4235 (87.8394%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0291, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4271/4934 (86.5626%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4107/4934 (83.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2330, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0077, Accuracy: 5434/6391 (85.0258%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5517/6391 (86.3245%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1648, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3759/4295 (87.5204%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3743/4295 (87.1478%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2272, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3345/3756 (89.0575%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3461/3756 (92.1459%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9745, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3864/4481 (86.2308%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3832/4481 (85.5166%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1996, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3571/4175 (85.5329%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3646/4175 (87.3293%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9959, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3183/3590 (88.6630%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3173/3590 (88.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1069, Accuracy: 5339/10000 (53.3900%)
time spent on training: 263.79009199142456
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1104, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 8.9818, Accuracy: 80/9900 (0.8081%)
Done in 293.22990441322327 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 42.44383495840783.
Norm before scaling: 42.44942561862955. Distance: 2.139240123209299
Total norm for 4 adversaries is: 42.44942561862955. distance: 2.139240123209299
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2732, Accuracy: 9230/9900 (93.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4811/5305 (90.6880%), train_poison_data_count: 415
Global model norm: 42.44383495840783.
Norm before scaling: 42.4448962051645. Distance: 2.085284756030435
Total norm for 4 adversaries is: 42.4448962051645. distance: 2.085284756030435
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2815, Accuracy: 9212/9900 (93.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4199/4717 (89.0184%), train_poison_data_count: 370
Global model norm: 42.44383495840783.
Norm before scaling: 42.451186926685274. Distance: 2.106226740405869
Total norm for 4 adversaries is: 42.451186926685274. distance: 2.106226740405869
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1295, Accuracy: 9592/9900 (96.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4466/5066 (88.1563%), train_poison_data_count: 400
Global model norm: 42.44383495840783.
Norm before scaling: 42.454355659379935. Distance: 2.246667619454081
Total norm for 4 adversaries is: 42.454355659379935. distance: 2.246667619454081
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1830, Accuracy: 9436/9900 (95.3131%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3376/3828 (88.1923%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3494/3828 (91.2748%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8179, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3435/3911 (87.8292%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3344/3911 (85.5024%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0762, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3908/4362 (89.5919%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3904/4362 (89.5002%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0248, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4611/5197 (88.7243%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4558/5197 (87.7044%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3574, Accuracy: 4880/10000 (48.8000%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4149/4679 (88.6728%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4142/4679 (88.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3930, Accuracy: 4905/10000 (49.0500%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4196/4793 (87.5443%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4267/4793 (89.0257%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0183, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4455/5116 (87.0797%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4544/5116 (88.8194%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1786, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3953/4625 (85.4703%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4028/4625 (87.0919%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0348, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4121/4618 (89.2378%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4022/4618 (87.0940%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3032, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2842/3271 (86.8847%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2954/3271 (90.3088%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9183, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3640/4175 (87.1856%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3628/4175 (86.8982%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0235, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3117/3616 (86.2002%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3253/3616 (89.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8849, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3811/4481 (85.0480%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3848/4481 (85.8737%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2525, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3846/4368 (88.0495%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3869/4368 (88.5760%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9808, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4995/5740 (87.0209%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5133/5740 (89.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1444, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4014/4647 (86.3783%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4144/4647 (89.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0229, Accuracy: 5341/10000 (53.4100%)
time spent on training: 264.06212878227234
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1102, Accuracy: 7051/10000 (70.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 8.9681, Accuracy: 81/9900 (0.8182%)
Done in 293.3570034503937 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 42.44421747045983.
Norm before scaling: 42.44906184549312. Distance: 2.098562602434793
Total norm for 4 adversaries is: 42.44906184549312. distance: 2.098562602434793
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2804, Accuracy: 9202/9900 (92.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 42.44421747045983.
Norm before scaling: 42.44030878269281. Distance: 2.121696372512181
Total norm for 4 adversaries is: 42.44030878269281. distance: 2.121696372512181
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1842, Accuracy: 9436/9900 (95.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4182/4717 (88.6580%), train_poison_data_count: 370
Global model norm: 42.44421747045983.
Norm before scaling: 42.44936235396019. Distance: 2.1039814127837144
Total norm for 4 adversaries is: 42.44936235396019. distance: 2.1039814127837144
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1431, Accuracy: 9516/9900 (96.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 42.44421747045983.
Norm before scaling: 42.45399767919757. Distance: 2.245876985124522
Total norm for 4 adversaries is: 42.45399767919757. distance: 2.245876985124522
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1232, Accuracy: 9557/9900 (96.5354%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4814/5591 (86.1027%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4883/5591 (87.3368%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1311, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4237/4956 (85.4923%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4298/4956 (86.7232%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1154, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3918/4511 (86.8544%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4003/4511 (88.7386%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0415, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3560/4013 (88.7117%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3650/4013 (90.9544%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8994, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3189/3590 (88.8301%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3264/3590 (90.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0063, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4161/4793 (86.8141%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4283/4793 (89.3595%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0979, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3314/3804 (87.1188%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3412/3804 (89.6951%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0841, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3382/3837 (88.1418%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3508/3837 (91.4256%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9944, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3805/4361 (87.2506%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3791/4361 (86.9296%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1603, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4325/5063 (85.4237%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4309/5063 (85.1076%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2883, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3807/4368 (87.1566%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3847/4368 (88.0723%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1721, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4159/4679 (88.8865%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4117/4679 (87.9889%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0565, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4570/5265 (86.7996%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4598/5265 (87.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0353, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4097/4767 (85.9450%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4163/4767 (87.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1679, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0077, Accuracy: 5090/5902 (86.2420%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0080, Accuracy: 5008/5902 (84.8526%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.4061, Accuracy: 4861/10000 (48.6100%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3685/4223 (87.2602%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3798/4223 (89.9361%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0434, Accuracy: 5352/10000 (53.5200%)
time spent on training: 253.96743416786194
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1099, Accuracy: 7049/10000 (70.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 8.9559, Accuracy: 82/9900 (0.8283%)
Done in 278.4761869907379 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 42.44468625872457.
Norm before scaling: 42.44586971035874. Distance: 2.049973683072015
Total norm for 4 adversaries is: 42.44586971035874. distance: 2.049973683072015
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2665, Accuracy: 9214/9900 (93.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 42.44468625872457.
Norm before scaling: 42.44658292894435. Distance: 2.1715129303500005
Total norm for 4 adversaries is: 42.44658292894435. distance: 2.1715129303500005
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2571, Accuracy: 9222/9900 (93.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4227/4717 (89.6120%), train_poison_data_count: 370
Global model norm: 42.44468625872457.
Norm before scaling: 42.44810566803526. Distance: 2.053762829787521
Total norm for 4 adversaries is: 42.44810566803526. distance: 2.053762829787521
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2336, Accuracy: 9320/9900 (94.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4486/5066 (88.5511%), train_poison_data_count: 400
Global model norm: 42.44468625872457.
Norm before scaling: 42.4538093430304. Distance: 2.2713026792456112
Total norm for 4 adversaries is: 42.4538093430304. distance: 2.2713026792456112
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1934, Accuracy: 9403/9900 (94.9798%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3400/3797 (89.5444%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3423/3797 (90.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8954, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3369/3861 (87.2572%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3368/3861 (87.2313%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9984, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4131/4707 (87.7629%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4184/4707 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1397, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3997/4518 (88.4683%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4098/4518 (90.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1625, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3571/4013 (88.9858%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3650/4013 (90.9544%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0157, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4573/5167 (88.5040%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4652/5167 (90.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2100, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3471/3969 (87.4528%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3586/3969 (90.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0055, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3974/4441 (89.4844%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4042/4441 (91.0155%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1363, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3983/4558 (87.3848%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4004/4558 (87.8455%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1411, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3952/4465 (88.5106%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4079/4465 (91.3550%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9061, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3160/3638 (86.8609%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3248/3638 (89.2798%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1013, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4001/4538 (88.1666%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4156/4538 (91.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8895, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5007/5740 (87.2300%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5155/5740 (89.8084%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1402, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3367/3837 (87.7508%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3488/3837 (90.9044%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8879, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3784/4361 (86.7691%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3673/4361 (84.2238%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0886, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4173/4793 (87.0645%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4307/4793 (89.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0288, Accuracy: 5419/10000 (54.1900%)
time spent on training: 231.1662139892578
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1096, Accuracy: 7050/10000 (70.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 8.9404, Accuracy: 84/9900 (0.8485%)
Done in 255.89307355880737 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 42.4451190923718.
Norm before scaling: 42.44939686197335. Distance: 2.1186067110744546
Total norm for 4 adversaries is: 42.44939686197335. distance: 2.1186067110744546
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1890, Accuracy: 9418/9900 (95.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4770/5305 (89.9152%), train_poison_data_count: 415
Global model norm: 42.4451190923718.
Norm before scaling: 42.44525570008163. Distance: 2.1468100192301582
Total norm for 4 adversaries is: 42.44525570008163. distance: 2.1468100192301582
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1412, Accuracy: 9555/9900 (96.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4208/4717 (89.2092%), train_poison_data_count: 370
Global model norm: 42.4451190923718.
Norm before scaling: 42.44777064136437. Distance: 2.071874180674211
Total norm for 4 adversaries is: 42.44777064136437. distance: 2.071874180674211
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1598, Accuracy: 9487/9900 (95.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 42.4451190923718.
Norm before scaling: 42.45072108578516. Distance: 2.207962244872016
Total norm for 4 adversaries is: 42.45072108578516. distance: 2.207962244872016
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2667, Accuracy: 9229/9900 (93.2222%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4098/4767 (85.9660%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4186/4767 (87.8120%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3028, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3972/4441 (89.4393%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4114/4441 (92.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1781, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3824/4356 (87.7870%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3885/4356 (89.1873%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.4147, Accuracy: 4945/10000 (49.4500%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0078, Accuracy: 5396/6391 (84.4312%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5541/6391 (86.7000%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1184, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3673/4184 (87.7868%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3739/4184 (89.3642%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9864, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3854/4346 (88.6792%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3973/4346 (91.4174%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8714, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4332/5037 (86.0036%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4571/5037 (90.7485%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9983, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4033/4634 (87.0306%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4151/4634 (89.5770%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9171, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4277/4934 (86.6842%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4253/4934 (86.1978%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1113, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4749/5424 (87.5553%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4878/5424 (89.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1465, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3339/3781 (88.3100%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3251/3781 (85.9825%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1273, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3371/3861 (87.3090%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3422/3861 (88.6299%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9879, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4447/5055 (87.9723%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4602/5055 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9994, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3949/4433 (89.0819%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4045/4433 (91.2475%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8022, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4572/5167 (88.4846%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4603/5167 (89.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1870, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3211/3590 (89.4429%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3136/3590 (87.3538%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3340, Accuracy: 5217/10000 (52.1700%)
time spent on training: 236.56087279319763
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1094, Accuracy: 7048/10000 (70.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 8.9219, Accuracy: 85/9900 (0.8586%)
Done in 260.94541907310486 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 42.44560368826126.
Norm before scaling: 42.44900289382175. Distance: 2.1166845195748265
Total norm for 4 adversaries is: 42.44900289382175. distance: 2.1166845195748265
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2542, Accuracy: 9285/9900 (93.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 42.44560368826126.
Norm before scaling: 42.44590422121138. Distance: 2.108516490152639
Total norm for 4 adversaries is: 42.44590422121138. distance: 2.108516490152639
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2166, Accuracy: 9348/9900 (94.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4217/4717 (89.4000%), train_poison_data_count: 370
Global model norm: 42.44560368826126.
Norm before scaling: 42.45113804238645. Distance: 2.0935093755664713
Total norm for 4 adversaries is: 42.45113804238645. distance: 2.0935093755664713
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1570, Accuracy: 9482/9900 (95.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 42.44560368826126.
Norm before scaling: 42.45310487209681. Distance: 2.2256335010275157
Total norm for 4 adversaries is: 42.45310487209681. distance: 2.2256335010275157
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2487, Accuracy: 9277/9900 (93.7071%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3800/4368 (86.9963%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3883/4368 (88.8965%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9050, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3346/3828 (87.4086%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3470/3828 (90.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8697, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3889/4356 (89.2792%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3635/4356 (83.4481%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2129, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3350/3861 (86.7651%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3420/3861 (88.5781%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0685, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3064/3472 (88.2488%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3155/3472 (90.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1024, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4032/4538 (88.8497%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4129/4538 (90.9872%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9729, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4788/5392 (88.7982%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4809/5392 (89.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0972, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3764/4295 (87.6368%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3653/4295 (85.0524%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0881, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3730/4235 (88.0756%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3741/4235 (88.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1686, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3973/4456 (89.1607%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3985/4456 (89.4300%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1206, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4548/5265 (86.3818%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4610/5265 (87.5594%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0282, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3991/4441 (89.8671%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4058/4441 (91.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0619, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3578/4013 (89.1602%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3680/4013 (91.7020%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8828, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3925/4465 (87.9059%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4037/4465 (90.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0124, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5516/6263 (88.0728%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5649/6263 (90.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0375, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4357/4986 (87.3847%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4465/4986 (89.5507%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9847, Accuracy: 5542/10000 (55.4200%)
time spent on training: 233.3176567554474
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1091, Accuracy: 7050/10000 (70.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 8.9084, Accuracy: 86/9900 (0.8687%)
Done in 257.99202585220337 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4341/4885 (88.8639%), train_poison_data_count: 385
Global model norm: 42.44604514023509.
Norm before scaling: 42.454474985436605. Distance: 2.174193756804224
Total norm for 4 adversaries is: 42.454474985436605. distance: 2.174193756804224
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1998, Accuracy: 9423/9900 (95.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.44604514023509.
Norm before scaling: 42.45028543365095. Distance: 2.144420516693727
Total norm for 4 adversaries is: 42.45028543365095. distance: 2.144420516693727
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1608, Accuracy: 9502/9900 (95.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4249/4717 (90.0784%), train_poison_data_count: 370
Global model norm: 42.44604514023509.
Norm before scaling: 42.4467712971751. Distance: 2.0235454280156806
Total norm for 4 adversaries is: 42.4467712971751. distance: 2.0235454280156806
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1586, Accuracy: 9503/9900 (95.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4521/5066 (89.2420%), train_poison_data_count: 400
Global model norm: 42.44604514023509.
Norm before scaling: 42.45419464055495. Distance: 2.2167788063690947
Total norm for 4 adversaries is: 42.45419464055495. distance: 2.2167788063690947
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2280, Accuracy: 9331/9900 (94.2525%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3557/4158 (85.5459%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3557/4158 (85.5459%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1632, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4547/5167 (88.0008%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4604/5167 (89.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2192, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3363/3828 (87.8527%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3450/3828 (90.1254%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9448, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4112/4663 (88.1836%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4222/4663 (90.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0629, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3947/4433 (89.0368%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4016/4433 (90.5933%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0228, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3673/4184 (87.7868%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3736/4184 (89.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9365, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4078/4716 (86.4716%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4139/4716 (87.7651%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1290, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3730/4223 (88.3258%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3808/4223 (90.1729%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8952, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4162/4679 (88.9506%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4115/4679 (87.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1937, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3190/3704 (86.1231%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3331/3704 (89.9298%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9119, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3390/3837 (88.3503%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3533/3837 (92.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9790, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3399/3861 (88.0342%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3408/3861 (88.2673%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9884, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4780/5424 (88.1268%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4872/5424 (89.8230%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.3047, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4050/4576 (88.5052%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4178/4576 (91.3024%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9708, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3554/4025 (88.2981%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3729/4025 (92.6460%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8776, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3362/3775 (89.0596%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3499/3775 (92.6887%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9066, Accuracy: 5618/10000 (56.1800%)
time spent on training: 231.96773672103882
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1089, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 8.8885, Accuracy: 87/9900 (0.8788%)
Done in 256.3993270397186 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 42.44651966003809.
Norm before scaling: 42.44988572247942. Distance: 2.0640734826026064
Total norm for 4 adversaries is: 42.44988572247942. distance: 2.0640734826026064
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1318, Accuracy: 9548/9900 (96.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 42.44651966003809.
Norm before scaling: 42.44828396441295. Distance: 2.173069138509727
Total norm for 4 adversaries is: 42.44828396441295. distance: 2.173069138509727
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2124, Accuracy: 9348/9900 (94.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4255/4717 (90.2056%), train_poison_data_count: 370
Global model norm: 42.44651966003809.
Norm before scaling: 42.448836103283654. Distance: 2.0167136394400216
Total norm for 4 adversaries is: 42.448836103283654. distance: 2.0167136394400216
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.3429, Accuracy: 9088/9900 (91.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4498/5066 (88.7880%), train_poison_data_count: 400
Global model norm: 42.44651966003809.
Norm before scaling: 42.45270662519279. Distance: 2.231199662524964
Total norm for 4 adversaries is: 42.45270662519279. distance: 2.231199662524964
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0722, Accuracy: 9702/9900 (98.0000%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4031/4576 (88.0900%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4173/4576 (91.1932%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9396, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3173/3672 (86.4107%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3249/3672 (88.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0528, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4111/4618 (89.0212%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4074/4618 (88.2200%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0300, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4024/4538 (88.6734%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4160/4538 (91.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9052, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4440/5025 (88.3582%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4541/5025 (90.3682%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3392, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3200/3590 (89.1365%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3309/3590 (92.1727%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0423, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4164/4707 (88.4640%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4248/4707 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0763, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4328/4918 (88.0033%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4435/4918 (90.1789%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0883, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3820/4336 (88.0996%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3896/4336 (89.8524%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0193, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5071/5902 (85.9200%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4985/5902 (84.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1627, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3998/4441 (90.0248%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4061/4441 (91.4434%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0599, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4490/5232 (85.8180%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4625/5232 (88.3983%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0648, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4198/4804 (87.3855%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4158/4804 (86.5529%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1590, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3517/3969 (88.6117%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3583/3969 (90.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0329, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4796/5392 (88.9466%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4788/5392 (88.7982%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1393, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3356/3828 (87.6698%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3476/3828 (90.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9828, Accuracy: 5459/10000 (54.5900%)
time spent on training: 234.85605311393738
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1086, Accuracy: 7053/10000 (70.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 8.8702, Accuracy: 88/9900 (0.8889%)
Done in 259.3932490348816 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 42.44696685414857.
Norm before scaling: 42.45232850283362. Distance: 2.08291017685355
Total norm for 4 adversaries is: 42.45232850283362. distance: 2.08291017685355
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1015, Accuracy: 9650/9900 (97.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4762/5305 (89.7644%), train_poison_data_count: 415
Global model norm: 42.44696685414857.
Norm before scaling: 42.44950901282237. Distance: 2.1756596146010425
Total norm for 4 adversaries is: 42.44950901282237. distance: 2.1756596146010425
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1905, Accuracy: 9394/9900 (94.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4204/4717 (89.1244%), train_poison_data_count: 370
Global model norm: 42.44696685414857.
Norm before scaling: 42.44964560640495. Distance: 2.0580694989628108
Total norm for 4 adversaries is: 42.44964560640495. distance: 2.0580694989628108
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2171, Accuracy: 9361/9900 (94.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4524/5066 (89.3012%), train_poison_data_count: 400
Global model norm: 42.44696685414857.
Norm before scaling: 42.45195756583994. Distance: 2.204307184866185
Total norm for 4 adversaries is: 42.45195756583994. distance: 2.204307184866185
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0857, Accuracy: 9656/9900 (97.5354%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4521/5232 (86.4106%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4577/5232 (87.4809%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1864, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4264/4956 (86.0371%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4350/4956 (87.7724%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3217, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4316/5063 (85.2459%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4389/5063 (86.6877%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0967, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3587/4025 (89.1180%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3719/4025 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8349, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3974/4441 (89.4844%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4071/4441 (91.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1317, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3921/4625 (84.7784%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3947/4625 (85.3405%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1885, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4802/5591 (85.8880%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4762/5591 (85.1726%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1725, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5013/5582 (89.8065%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5009/5582 (89.7349%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2319, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5072/5902 (85.9370%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5094/5902 (86.3097%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2437, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4042/4538 (89.0701%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4151/4538 (91.4720%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9544, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4432/5025 (88.1990%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4544/5025 (90.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0765, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3714/4223 (87.9470%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3833/4223 (90.7649%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8777, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3788/4361 (86.8608%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3705/4361 (84.9576%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1248, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3770/4354 (86.5870%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3575/4354 (82.1084%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3553, Accuracy: 4794/10000 (47.9400%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3217/3672 (87.6089%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3294/3672 (89.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0226, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3868/4356 (88.7971%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3861/4356 (88.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2963, Accuracy: 4986/10000 (49.8600%)
time spent on training: 238.6122121810913
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1083, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 8.8536, Accuracy: 89/9900 (0.8990%)
Done in 263.24381041526794 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 42.447451428943296.
Norm before scaling: 42.45379784155801. Distance: 2.1324242318792503
Total norm for 4 adversaries is: 42.45379784155801. distance: 2.1324242318792503
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0926, Accuracy: 9672/9900 (97.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4807/5305 (90.6126%), train_poison_data_count: 415
Global model norm: 42.447451428943296.
Norm before scaling: 42.44434257703699. Distance: 2.0489532170686777
Total norm for 4 adversaries is: 42.44434257703699. distance: 2.0489532170686777
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2308, Accuracy: 9328/9900 (94.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4249/4717 (90.0784%), train_poison_data_count: 370
Global model norm: 42.447451428943296.
Norm before scaling: 42.45079728850434. Distance: 2.0028282671787063
Total norm for 4 adversaries is: 42.45079728850434. distance: 2.0028282671787063
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.4066, Accuracy: 8914/9900 (90.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4474/5066 (88.3143%), train_poison_data_count: 400
Global model norm: 42.447451428943296.
Norm before scaling: 42.456668799918084. Distance: 2.2845101250006463
Total norm for 4 adversaries is: 42.456668799918084. distance: 2.2845101250006463
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0893, Accuracy: 9683/9900 (97.8081%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3401/3828 (88.8454%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3444/3828 (89.9687%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9558, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3754/4235 (88.6423%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3708/4235 (87.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1025, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3234/3704 (87.3110%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3242/3704 (87.5270%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1337, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3605/4046 (89.1003%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3640/4046 (89.9654%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9388, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4337/4928 (88.0073%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4386/4928 (89.0016%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9271, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5037/5740 (87.7526%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5071/5740 (88.3449%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1799, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4401/5083 (86.5827%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4446/5083 (87.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0076, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4062/4576 (88.7675%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4067/4576 (88.8767%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9174, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4057/4647 (87.3036%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4210/4647 (90.5961%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9331, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4828/5424 (89.0118%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4877/5424 (89.9152%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2501, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3923/4503 (87.1197%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4032/4503 (89.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1044, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0077, Accuracy: 5438/6391 (85.0884%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5578/6391 (87.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1230, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3908/4511 (86.6327%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4036/4511 (89.4702%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9615, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3961/4456 (88.8914%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4058/4456 (91.0682%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0577, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4191/4804 (87.2398%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4112/4804 (85.5953%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1387, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3306/3804 (86.9085%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3397/3804 (89.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9425, Accuracy: 5514/10000 (55.1400%)
time spent on training: 234.89317297935486
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1081, Accuracy: 7056/10000 (70.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 8.8362, Accuracy: 90/9900 (0.9091%)
Done in 259.6254131793976 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4384/4885 (89.7441%), train_poison_data_count: 385
Global model norm: 42.44791155419192.
Norm before scaling: 42.452948161667024. Distance: 2.1151651668762192
Total norm for 4 adversaries is: 42.452948161667024. distance: 2.1151651668762192
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2054, Accuracy: 9375/9900 (94.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4815/5305 (90.7634%), train_poison_data_count: 415
Global model norm: 42.44791155419192.
Norm before scaling: 42.44933647293191. Distance: 2.126896628898436
Total norm for 4 adversaries is: 42.44933647293191. distance: 2.126896628898436
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2506, Accuracy: 9271/9900 (93.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 42.44791155419192.
Norm before scaling: 42.45244639685827. Distance: 2.0477367654549017
Total norm for 4 adversaries is: 42.45244639685827. distance: 2.0477367654549017
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1522, Accuracy: 9498/9900 (95.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4520/5066 (89.2223%), train_poison_data_count: 400
Global model norm: 42.44791155419192.
Norm before scaling: 42.45302148496765. Distance: 2.16908568057298
Total norm for 4 adversaries is: 42.45302148496765. distance: 2.16908568057298
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1729, Accuracy: 9443/9900 (95.3838%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4316/4928 (87.5812%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4389/4928 (89.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0334, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4337/5037 (86.1028%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4521/5037 (89.7558%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0004, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4790/5392 (88.8353%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4751/5392 (88.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1028, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3913/4501 (86.9362%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3987/4501 (88.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0391, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3282/3804 (86.2776%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3418/3804 (89.8528%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9189, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3388/3837 (88.2981%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3554/3837 (92.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9171, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4333/5063 (85.5817%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4198/5063 (82.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2782, Accuracy: 4959/10000 (49.5900%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3844/4481 (85.7844%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3892/4481 (86.8556%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0886, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4024/4518 (89.0660%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4144/4518 (91.7220%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9427, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3113/3638 (85.5690%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3270/3638 (89.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9149, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4094/4663 (87.7976%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4217/4663 (90.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0382, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3930/4625 (84.9730%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3986/4625 (86.1838%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1694, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4504/5197 (86.6654%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4594/5197 (88.3972%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2581, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4422/5083 (86.9959%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4474/5083 (88.0189%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2517, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3363/3828 (87.8527%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3520/3828 (91.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8758, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3189/3704 (86.0961%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3306/3704 (89.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9430, Accuracy: 5559/10000 (55.5900%)
time spent on training: 234.968159198761
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1078, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 8.8181, Accuracy: 93/9900 (0.9394%)
Done in 259.74260354042053 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4380/4885 (89.6622%), train_poison_data_count: 385
Global model norm: 42.44845938431173.
Norm before scaling: 42.452102777994845. Distance: 2.137308489156356
Total norm for 4 adversaries is: 42.452102777994845. distance: 2.137308489156356
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2054, Accuracy: 9388/9900 (94.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.44845938431173.
Norm before scaling: 42.449727562343526. Distance: 2.133947384894436
Total norm for 4 adversaries is: 42.449727562343526. distance: 2.133947384894436
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1458, Accuracy: 9528/9900 (96.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 42.44845938431173.
Norm before scaling: 42.451789349158325. Distance: 2.0685678868651083
Total norm for 4 adversaries is: 42.451789349158325. distance: 2.0685678868651083
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.3023, Accuracy: 9165/9900 (92.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4481/5066 (88.4524%), train_poison_data_count: 400
Global model norm: 42.44845938431173.
Norm before scaling: 42.45486027692015. Distance: 2.2258839426555634
Total norm for 4 adversaries is: 42.45486027692015. distance: 2.2258839426555634
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1409, Accuracy: 9537/9900 (96.3333%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3399/3861 (88.0342%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3456/3861 (89.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9758, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3703/4184 (88.5038%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3800/4184 (90.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9491, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4324/5037 (85.8447%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4496/5037 (89.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9959, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4482/5197 (86.2421%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4495/5197 (86.4922%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0191, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4364/5025 (86.8458%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4502/5025 (89.5920%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0480, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4449/5116 (86.9625%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4482/5116 (87.6075%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1297, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3834/4481 (85.5613%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3887/4481 (86.7440%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1526, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4091/4576 (89.4012%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4101/4576 (89.6198%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1140, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4495/5232 (85.9136%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4676/5232 (89.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0270, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3764/4354 (86.4492%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3763/4354 (86.4263%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3596, Accuracy: 4969/10000 (49.6900%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2872/3271 (87.8019%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0067, Accuracy: 2843/3271 (86.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0301, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4784/5455 (87.6994%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4835/5455 (88.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2104, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3597/4126 (87.1789%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3751/4126 (90.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0446, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3322/3797 (87.4901%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3447/3797 (90.7822%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0210, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3213/3704 (86.7441%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3286/3704 (88.7149%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9746, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4331/4934 (87.7787%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4211/4934 (85.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1053, Accuracy: 5174/10000 (51.7400%)
time spent on training: 235.67158222198486
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1075, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 8.8003, Accuracy: 94/9900 (0.9495%)
Done in 264.878324508667 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4417/4885 (90.4197%), train_poison_data_count: 385
Global model norm: 42.44898707750575.
Norm before scaling: 42.4529021548255. Distance: 2.0675258091488438
Total norm for 4 adversaries is: 42.4529021548255. distance: 2.0675258091488438
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2256, Accuracy: 9341/9900 (94.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 42.44898707750575.
Norm before scaling: 42.452102777994845. Distance: 2.1478560337076655
Total norm for 4 adversaries is: 42.452102777994845. distance: 2.1478560337076655
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1857, Accuracy: 9425/9900 (95.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4200/4717 (89.0396%), train_poison_data_count: 370
Global model norm: 42.44898707750575.
Norm before scaling: 42.45140978086373. Distance: 2.0990516383128726
Total norm for 4 adversaries is: 42.45140978086373. distance: 2.0990516383128726
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1827, Accuracy: 9417/9900 (95.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 42.44898707750575.
Norm before scaling: 42.451432785099406. Distance: 2.2227325158200086
Total norm for 4 adversaries is: 42.451432785099406. distance: 2.2227325158200086
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1174, Accuracy: 9581/9900 (96.7778%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4088/4618 (88.5232%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4098/4618 (88.7397%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0270, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3937/4625 (85.1243%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3976/4625 (85.9676%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1733, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5017/5740 (87.4042%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5043/5740 (87.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.4048, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3851/4416 (87.2056%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3955/4416 (89.5607%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0114, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3657/4126 (88.6331%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3727/4126 (90.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8436, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3100/3616 (85.7301%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3269/3616 (90.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8330, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3561/4158 (85.6421%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3620/4158 (87.0611%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9392, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3897/4346 (89.6687%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3985/4346 (91.6935%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9377, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4210/4874 (86.3767%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4276/4874 (87.7308%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2309, Accuracy: 5036/10000 (50.3600%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4558/5265 (86.5717%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4622/5265 (87.7873%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1082, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3579/4025 (88.9193%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3680/4025 (91.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9284, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4049/4651 (87.0565%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4130/4651 (88.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1746, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3337/3837 (86.9690%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3452/3837 (89.9661%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1484, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3137/3638 (86.2287%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3280/3638 (90.1594%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9291, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3104/3472 (89.4009%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3174/3472 (91.4171%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0349, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3997/4456 (89.6993%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4081/4456 (91.5844%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9287, Accuracy: 5616/10000 (56.1600%)
time spent on training: 260.5708975791931
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1073, Accuracy: 7054/10000 (70.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 8.7906, Accuracy: 94/9900 (0.9495%)
Done in 289.96312975883484 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4365/4885 (89.3552%), train_poison_data_count: 385
Global model norm: 42.44934653777812.
Norm before scaling: 42.456191518342614. Distance: 2.1459682632047774
Total norm for 4 adversaries is: 42.456191518342614. distance: 2.1459682632047774
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1739, Accuracy: 9481/9900 (95.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 42.44934653777812.
Norm before scaling: 42.44983108540819. Distance: 2.106351253441542
Total norm for 4 adversaries is: 42.44983108540819. distance: 2.106351253441542
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1405, Accuracy: 9528/9900 (96.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4217/4717 (89.4000%), train_poison_data_count: 370
Global model norm: 42.44934653777812.
Norm before scaling: 42.45264048996614. Distance: 2.0755782045662032
Total norm for 4 adversaries is: 42.45264048996614. distance: 2.0755782045662032
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2101, Accuracy: 9367/9900 (94.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4502/5066 (88.8670%), train_poison_data_count: 400
Global model norm: 42.44934653777812.
Norm before scaling: 42.45693762784093. Distance: 2.252520526957576
Total norm for 4 adversaries is: 42.45693762784093. distance: 2.252520526957576
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1859, Accuracy: 9425/9900 (95.2020%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4791/5424 (88.3296%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4894/5424 (90.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1379, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4380/4986 (87.8460%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4474/4986 (89.7312%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0193, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4539/5167 (87.8459%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4682/5167 (90.6135%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0830, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4074/4716 (86.3868%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4200/4716 (89.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1741, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3792/4368 (86.8132%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3771/4368 (86.3324%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1410, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3855/4356 (88.4986%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3724/4356 (85.4913%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2865, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4247/4804 (88.4055%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4250/4804 (88.4679%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1237, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3850/4481 (85.9183%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3897/4481 (86.9672%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1882, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3560/4025 (88.4472%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3672/4025 (91.2298%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8938, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4381/5017 (87.3231%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4469/5017 (89.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0730, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3147/3616 (87.0299%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3281/3616 (90.7356%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8790, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3661/4184 (87.5000%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3730/4184 (89.1491%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8902, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4519/5195 (86.9875%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4520/5195 (87.0067%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1238, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3821/4361 (87.6175%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3851/4361 (88.3054%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0753, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3370/3756 (89.7231%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3480/3756 (92.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0203, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4804/5591 (85.9238%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4798/5591 (85.8165%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1222, Accuracy: 5258/10000 (52.5800%)
time spent on training: 263.00458669662476
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1070, Accuracy: 7057/10000 (70.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 8.7728, Accuracy: 94/9900 (0.9495%)
Done in 292.18480014801025 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 42.44985552831717.
Norm before scaling: 42.4515938144001. Distance: 2.109196747206508
Total norm for 4 adversaries is: 42.4515938144001. distance: 2.109196747206508
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.3231, Accuracy: 9070/9900 (91.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 42.44985552831717.
Norm before scaling: 42.450207792207124. Distance: 2.166366397396187
Total norm for 4 adversaries is: 42.450207792207124. distance: 2.166366397396187
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1568, Accuracy: 9483/9900 (95.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4207/4717 (89.1880%), train_poison_data_count: 370
Global model norm: 42.44985552831717.
Norm before scaling: 42.45418601452924. Distance: 2.071170269312705
Total norm for 4 adversaries is: 42.45418601452924. distance: 2.071170269312705
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1905, Accuracy: 9380/9900 (94.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4504/5066 (88.9064%), train_poison_data_count: 400
Global model norm: 42.44985552831717.
Norm before scaling: 42.45615845345643. Distance: 2.215532145417423
Total norm for 4 adversaries is: 42.45615845345643. distance: 2.215532145417423
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2404, Accuracy: 9300/9900 (93.9394%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3628/4175 (86.8982%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3674/4175 (88.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1952, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4858/5455 (89.0559%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4854/5455 (88.9826%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0361, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3224/3704 (87.0410%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3357/3704 (90.6317%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8686, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4287/4989 (85.9290%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4360/4989 (87.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9933, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4310/4928 (87.4594%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4368/4928 (88.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9851, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3328/3804 (87.4869%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3419/3804 (89.8791%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0236, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3839/4336 (88.5378%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3903/4336 (90.0138%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0800, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3584/4046 (88.5813%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3629/4046 (89.6935%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0335, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4134/4793 (86.2508%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4269/4793 (89.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9500, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3353/3756 (89.2705%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3486/3756 (92.8115%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0122, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5492/6391 (85.9333%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5481/6391 (85.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1798, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3184/3672 (86.7102%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3266/3672 (88.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0102, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3989/4558 (87.5165%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4117/4558 (90.3247%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1766, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4063/4576 (88.7893%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4113/4576 (89.8820%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1150, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3971/4456 (89.1158%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4109/4456 (92.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1634, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3892/4356 (89.3480%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3680/4356 (84.4812%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.4193, Accuracy: 4915/10000 (49.1500%)
time spent on training: 263.98309421539307
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1068, Accuracy: 7057/10000 (70.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 8.7559, Accuracy: 96/9900 (0.9697%)
Done in 293.1314744949341 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4391/4885 (89.8874%), train_poison_data_count: 385
Global model norm: 42.450312751902956.
Norm before scaling: 42.45589968389258. Distance: 2.1164756788861068
Total norm for 4 adversaries is: 42.45589968389258. distance: 2.1164756788861068
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1461, Accuracy: 9535/9900 (96.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 42.450312751902956.
Norm before scaling: 42.45094538019001. Distance: 2.1201977040215336
Total norm for 4 adversaries is: 42.45094538019001. distance: 2.1201977040215336
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2272, Accuracy: 9334/9900 (94.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4236/4717 (89.8028%), train_poison_data_count: 370
Global model norm: 42.450312751902956.
Norm before scaling: 42.45276988487839. Distance: 2.1162495805409844
Total norm for 4 adversaries is: 42.45276988487839. distance: 2.1162495805409844
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1082, Accuracy: 9597/9900 (96.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4506/5066 (88.9459%), train_poison_data_count: 400
Global model norm: 42.450312751902956.
Norm before scaling: 42.46049260921483. Distance: 2.2231693580626977
Total norm for 4 adversaries is: 42.46049260921483. distance: 2.2231693580626977
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1365, Accuracy: 9544/9900 (96.4040%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4439/5116 (86.7670%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4490/5116 (87.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1193, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5000/5582 (89.5736%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5115/5582 (91.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9994, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4222/4928 (85.6737%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4387/4928 (89.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0572, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3656/4126 (88.6088%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3743/4126 (90.7174%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8182, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3559/4158 (85.5940%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3614/4158 (86.9168%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1359, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4373/5063 (86.3717%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4268/5063 (84.2978%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1260, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5300/6124 (86.5447%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5331/6124 (87.0509%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0050, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3777/4354 (86.7478%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3693/4354 (84.8186%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3258, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4413/5025 (87.8209%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4568/5025 (90.9055%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0814, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4164/4679 (88.9934%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4032/4679 (86.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2388, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4189/4793 (87.3983%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4353/4793 (90.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9598, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4007/4518 (88.6897%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4089/4518 (90.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0478, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4518/5167 (87.4395%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4564/5167 (88.3298%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1887, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3973/4433 (89.6233%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3983/4433 (89.8489%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8637, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3966/4503 (88.0746%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4001/4503 (88.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1004, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4116/4707 (87.4442%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4217/4707 (89.5900%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9030, Accuracy: 5625/10000 (56.2500%)
time spent on training: 270.3168110847473
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1066, Accuracy: 7056/10000 (70.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 8.7428, Accuracy: 97/9900 (0.9798%)
Done in 299.82080841064453 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 42.45078866178828.
Norm before scaling: 42.45541089263535. Distance: 2.1283877800071442
Total norm for 4 adversaries is: 42.45541089263535. distance: 2.1283877800071442
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1846, Accuracy: 9444/9900 (95.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.45078866178828.
Norm before scaling: 42.45003956859169. Distance: 2.1519585626505426
Total norm for 4 adversaries is: 42.45003956859169. distance: 2.1519585626505426
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2480, Accuracy: 9273/9900 (93.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 42.45078866178828.
Norm before scaling: 42.45397755170813. Distance: 2.0630791746803503
Total norm for 4 adversaries is: 42.45397755170813. distance: 2.0630791746803503
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1629, Accuracy: 9453/9900 (95.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 42.45078866178828.
Norm before scaling: 42.454968100403164. Distance: 2.2143006104526384
Total norm for 4 adversaries is: 42.454968100403164. distance: 2.2143006104526384
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1636, Accuracy: 9487/9900 (95.8283%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3213/3704 (86.7441%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3305/3704 (89.2279%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9494, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4737/5392 (87.8524%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4808/5392 (89.1691%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0915, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3918/4362 (89.8212%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3974/4362 (91.1050%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9882, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4041/4538 (89.0480%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4192/4538 (92.3755%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0149, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3676/4184 (87.8585%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3752/4184 (89.6750%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8717, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3328/3756 (88.6049%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3436/3756 (91.4803%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9879, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4145/4679 (88.5873%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4069/4679 (86.9630%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1399, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3076/3472 (88.5945%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3138/3472 (90.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1889, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0076, Accuracy: 5431/6391 (84.9789%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5529/6391 (86.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1330, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4539/5265 (86.2108%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4504/5265 (85.5461%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1327, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5067/5902 (85.8523%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5053/5902 (85.6150%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0930, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0076, Accuracy: 5202/6124 (84.9445%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5335/6124 (87.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1255, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4414/5083 (86.8385%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4444/5083 (87.4287%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1723, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3986/4465 (89.2721%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4073/4465 (91.2206%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8983, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3331/3804 (87.5657%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3395/3804 (89.2482%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0432, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4349/4918 (88.4303%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4415/4918 (89.7723%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0152, Accuracy: 5362/10000 (53.6200%)
time spent on training: 268.5747392177582
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1063, Accuracy: 7053/10000 (70.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 8.7206, Accuracy: 99/9900 (1.0000%)
Done in 297.71227502822876 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 42.451356583520976.
Norm before scaling: 42.45541664315344. Distance: 2.120030370170856
Total norm for 4 adversaries is: 42.45541664315344. distance: 2.120030370170856
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.4627, Accuracy: 8826/9900 (89.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 42.451356583520976.
Norm before scaling: 42.452250865126395. Distance: 2.1408435125271055
Total norm for 4 adversaries is: 42.452250865126395. distance: 2.1408435125271055
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1311, Accuracy: 9551/9900 (96.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 42.451356583520976.
Norm before scaling: 42.45934119009473. Distance: 2.015757120223246
Total norm for 4 adversaries is: 42.45934119009473. distance: 2.015757120223246
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1655, Accuracy: 9488/9900 (95.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4532/5066 (89.4591%), train_poison_data_count: 400
Global model norm: 42.451356583520976.
Norm before scaling: 42.46141688436839. Distance: 2.205761353409149
Total norm for 4 adversaries is: 42.46141688436839. distance: 2.205761353409149
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2080, Accuracy: 9356/9900 (94.5051%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4064/4538 (89.5549%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4116/4538 (90.7007%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0676, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4322/4989 (86.6306%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4426/4989 (88.7152%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0297, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4134/4793 (86.2508%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4287/4793 (89.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1434, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3598/4158 (86.5320%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3581/4158 (86.1231%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0698, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3393/3861 (87.8788%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3474/3861 (89.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0301, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4517/5232 (86.3341%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4569/5232 (87.3280%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.3012, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4129/4663 (88.5481%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4262/4663 (91.4004%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9889, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4570/5197 (87.9353%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4642/5197 (89.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1079, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4570/5167 (88.4459%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4598/5167 (88.9878%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1063, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3865/4416 (87.5226%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3953/4416 (89.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9251, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3814/4354 (87.5976%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3593/4354 (82.5218%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.6142, Accuracy: 4594/10000 (45.9400%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4857/5455 (89.0376%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4866/5455 (89.2026%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1000, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3972/4456 (89.1382%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4077/4456 (91.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9395, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2845/3271 (86.9765%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2908/3271 (88.9025%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9513, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2954/3297 (89.5966%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2998/3297 (90.9311%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8609, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4858/5591 (86.8896%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4797/5591 (85.7986%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2313, Accuracy: 4962/10000 (49.6200%)
time spent on training: 266.57976365089417
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1060, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 8.7008, Accuracy: 101/9900 (1.0202%)
Done in 295.57314467430115 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 42.451851172460664.
Norm before scaling: 42.45424208366506. Distance: 2.093930137059085
Total norm for 4 adversaries is: 42.45424208366506. distance: 2.093930137059085
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1341, Accuracy: 9560/9900 (96.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 42.451851172460664.
Norm before scaling: 42.45054567523249. Distance: 2.095929278483717
Total norm for 4 adversaries is: 42.45054567523249. distance: 2.095929278483717
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.2790, Accuracy: 9233/9900 (93.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 42.451851172460664.
Norm before scaling: 42.45560065932114. Distance: 2.066583117467717
Total norm for 4 adversaries is: 42.45560065932114. distance: 2.066583117467717
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1331, Accuracy: 9550/9900 (96.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 42.451851172460664.
Norm before scaling: 42.460036932722105. Distance: 2.22142619604668
Total norm for 4 adversaries is: 42.460036932722105. distance: 2.22142619604668
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1462, Accuracy: 9504/9900 (96.0000%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4540/5167 (87.8653%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4617/5167 (89.3555%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2905, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3372/3775 (89.3245%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3522/3775 (93.2980%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0533, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4513/5195 (86.8720%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4559/5195 (87.7575%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2296, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3629/4126 (87.9544%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3751/4126 (90.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9905, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3440/3911 (87.9570%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3268/3911 (83.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2675, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3956/4433 (89.2398%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4054/4433 (91.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8871, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0070, Accuracy: 2805/3271 (85.7536%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0063, Accuracy: 2860/3271 (87.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1308, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3223/3590 (89.7772%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3268/3590 (91.0306%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0116, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4327/4918 (87.9829%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4463/4918 (90.7483%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1418, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4383/4986 (87.9061%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4462/4986 (89.4906%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.3467, Accuracy: 5012/10000 (50.1200%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3159/3616 (87.3617%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3246/3616 (89.7677%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9207, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3762/4295 (87.5902%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3841/4295 (89.4296%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9715, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3854/4356 (88.4757%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3817/4356 (87.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1559, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4251/4793 (88.6918%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4332/4793 (90.3818%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9565, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3888/4315 (90.1043%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3900/4315 (90.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0077, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4197/4804 (87.3647%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4275/4804 (88.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1718, Accuracy: 5258/10000 (52.5800%)
time spent on training: 260.86957931518555
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1058, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 8.6875, Accuracy: 101/9900 (1.0202%)
Done in 289.6340928077698 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4389/4885 (89.8465%), train_poison_data_count: 385
Global model norm: 42.45228968399776.
Norm before scaling: 42.454975288625626. Distance: 2.104974069322359
Total norm for 4 adversaries is: 42.454975288625626. distance: 2.104974069322359
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1874, Accuracy: 9453/9900 (95.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4826/5305 (90.9708%), train_poison_data_count: 415
Global model norm: 42.45228968399776.
Norm before scaling: 42.45215166118276. Distance: 2.1195336887051717
Total norm for 4 adversaries is: 42.45215166118276. distance: 2.1195336887051717
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0709, Accuracy: 9705/9900 (98.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4246/4717 (90.0148%), train_poison_data_count: 370
Global model norm: 42.45228968399776.
Norm before scaling: 42.45581055178873. Distance: 2.040070617051918
Total norm for 4 adversaries is: 42.45581055178873. distance: 2.040070617051918
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0666, Accuracy: 9710/9900 (98.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4469/5066 (88.2156%), train_poison_data_count: 400
Global model norm: 42.45228968399776.
Norm before scaling: 42.4605486700228. Distance: 2.2336384019261226
Total norm for 4 adversaries is: 42.4605486700228. distance: 2.2336384019261226
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.2430, Accuracy: 9277/9900 (93.7071%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3974/4503 (88.2523%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3982/4503 (88.4299%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0025, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4265/4934 (86.4410%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4157/4934 (84.2521%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.4339, Accuracy: 4712/10000 (47.1200%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4228/4804 (88.0100%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4064/4804 (84.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2088, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3945/4456 (88.5323%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4063/4456 (91.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8949, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4106/4651 (88.2821%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4187/4651 (90.0237%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1367, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3706/4184 (88.5755%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3747/4184 (89.5554%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0737, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4228/4928 (85.7955%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4360/4928 (88.4740%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0247, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3361/3775 (89.0331%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3522/3775 (93.2980%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9989, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4398/5083 (86.5237%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4449/5083 (87.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0666, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4840/5455 (88.7259%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4863/5455 (89.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1955, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3154/3638 (86.6960%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3264/3638 (89.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8889, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3387/3911 (86.6019%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3492/3911 (89.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1644, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3409/3837 (88.8455%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3526/3837 (91.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8636, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3938/4501 (87.4917%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4006/4501 (89.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0350, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4584/5197 (88.2047%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4626/5197 (89.0129%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1793, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3409/3861 (88.2932%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3465/3861 (89.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0112, Accuracy: 5416/10000 (54.1600%)
time spent on training: 264.3761386871338
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.1056, Accuracy: 7056/10000 (70.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 8.6703, Accuracy: 102/9900 (1.0303%)
Done in 293.89330291748047 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 42.45277707347306.
Norm before scaling: 42.457468090781006. Distance: 2.1026123147510045
Total norm for 4 adversaries is: 42.457468090781006. distance: 2.1026123147510045
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2001, Accuracy: 9410/9900 (95.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 42.45277707347306.
Norm before scaling: 42.45455261907652. Distance: 2.10843190903839
Total norm for 4 adversaries is: 42.45455261907652. distance: 2.10843190903839
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1790, Accuracy: 9469/9900 (95.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 42.45277707347306.
Norm before scaling: 42.454342720389775. Distance: 2.0006444607961718
Total norm for 4 adversaries is: 42.454342720389775. distance: 2.0006444607961718
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.3050, Accuracy: 9112/9900 (92.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.45277707347306.
Norm before scaling: 42.45935269006553. Distance: 2.1963419282418606
Total norm for 4 adversaries is: 42.45935269006553. distance: 2.1963419282418606
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1680, Accuracy: 9429/9900 (95.2424%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0066, Accuracy: 2847/3271 (87.0376%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0072, Accuracy: 2820/3271 (86.2122%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2272, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3870/4511 (85.7903%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3941/4511 (87.3642%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0973, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3147/3638 (86.5036%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3248/3638 (89.2798%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1075, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5004/5582 (89.6453%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5024/5582 (90.0036%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1354, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3955/4456 (88.7567%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4033/4456 (90.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0130, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5097/5902 (86.3606%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4981/5902 (84.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3661, Accuracy: 4927/10000 (49.2700%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3837/4416 (86.8886%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3941/4416 (89.2437%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9517, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4280/4934 (86.7450%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4132/4934 (83.7454%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2471, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4020/4596 (87.4674%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4197/4596 (91.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2512, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3364/3837 (87.6727%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3469/3837 (90.4092%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2076, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5487/6391 (85.8551%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5500/6391 (86.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3354, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3812/4368 (87.2711%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3875/4368 (88.7134%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1383, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3336/3804 (87.6972%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3443/3804 (90.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9500, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5483/6263 (87.5459%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5566/6263 (88.8711%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2469, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4190/4793 (87.4192%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4325/4793 (90.2358%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0750, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4754/5424 (87.6475%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4865/5424 (89.6940%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2100, Accuracy: 5071/10000 (50.7100%)
time spent on training: 267.8757984638214
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.1054, Accuracy: 7056/10000 (70.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 8.6575, Accuracy: 103/9900 (1.0404%)
Done in 297.2538185119629 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 42.4532328278903.
Norm before scaling: 42.456131138965816. Distance: 2.08907445135243
Total norm for 4 adversaries is: 42.456131138965816. distance: 2.08907445135243
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3533, Accuracy: 9019/9900 (91.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 42.4532328278903.
Norm before scaling: 42.45256860373336. Distance: 2.103131244077667
Total norm for 4 adversaries is: 42.45256860373336. distance: 2.103131244077667
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2542, Accuracy: 9304/9900 (93.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4238/4717 (89.8452%), train_poison_data_count: 370
Global model norm: 42.4532328278903.
Norm before scaling: 42.45572285711683. Distance: 2.0648412420839977
Total norm for 4 adversaries is: 42.45572285711683. distance: 2.0648412420839977
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1179, Accuracy: 9592/9900 (96.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 42.4532328278903.
Norm before scaling: 42.45940587738996. Distance: 2.2363937967977527
Total norm for 4 adversaries is: 42.45940587738996. distance: 2.2363937967977527
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2944, Accuracy: 9150/9900 (92.4242%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4468/5055 (88.3877%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4542/5055 (89.8516%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9561, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3677/4184 (87.8824%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3720/4184 (88.9101%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9555, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3424/3861 (88.6817%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3433/3861 (88.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9896, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4178/4804 (86.9692%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0120, Accuracy: 3747/4804 (77.9975%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.4324, Accuracy: 4680/10000 (46.8000%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3066/3472 (88.3065%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3123/3472 (89.9482%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0573, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3512/3969 (88.4858%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3530/3969 (88.9393%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9250, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4298/4989 (86.1495%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4351/4989 (87.2119%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0724, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5006/5582 (89.6811%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5045/5582 (90.3798%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0606, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4190/4793 (87.4192%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4301/4793 (89.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9490, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4049/4662 (86.8511%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4174/4662 (89.5324%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9945, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4259/4934 (86.3194%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4262/4934 (86.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1651, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4441/4986 (89.0694%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4501/4986 (90.2728%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9890, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3938/4433 (88.8337%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3947/4433 (89.0368%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0578, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4063/4716 (86.1535%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4182/4716 (88.6768%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9785, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4076/4596 (88.6858%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4186/4596 (91.0792%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0452, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3786/4354 (86.9545%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3617/4354 (83.0730%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.4468, Accuracy: 4755/10000 (47.5500%)
time spent on training: 262.6117961406708
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.1051, Accuracy: 7058/10000 (70.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 8.6361, Accuracy: 105/9900 (1.0606%)
Done in 291.81239581108093 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 42.45381653144906.
Norm before scaling: 42.45907956491756. Distance: 2.111335352092164
Total norm for 4 adversaries is: 42.45907956491756. distance: 2.111335352092164
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0912, Accuracy: 9686/9900 (97.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4739/5305 (89.3308%), train_poison_data_count: 415
Global model norm: 42.45381653144906.
Norm before scaling: 42.45148166905883. Distance: 2.141632733898774
Total norm for 4 adversaries is: 42.45148166905883. distance: 2.141632733898774
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2321, Accuracy: 9344/9900 (94.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4196/4717 (88.9548%), train_poison_data_count: 370
Global model norm: 42.45381653144906.
Norm before scaling: 42.45793242010997. Distance: 2.0888209612039725
Total norm for 4 adversaries is: 42.45793242010997. distance: 2.0888209612039725
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2292, Accuracy: 9329/9900 (94.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4521/5066 (89.2420%), train_poison_data_count: 400
Global model norm: 42.45381653144906.
Norm before scaling: 42.45979831153523. Distance: 2.191394499884942
Total norm for 4 adversaries is: 42.45979831153523. distance: 2.191394499884942
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.3386, Accuracy: 9084/9900 (91.7576%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4460/5116 (87.1775%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4509/5116 (88.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9954, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4068/4662 (87.2587%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4191/4662 (89.8970%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0661, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5084/5902 (86.1403%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5106/5902 (86.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3358, Accuracy: 4935/10000 (49.3500%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4388/5063 (86.6680%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4422/5063 (87.3395%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1918, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3805/4354 (87.3909%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0164, Accuracy: 3111/4354 (71.4515%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.8987, Accuracy: 4053/10000 (40.5300%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4529/5195 (87.1800%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4540/5195 (87.3917%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0866, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3881/4356 (89.0955%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3646/4356 (83.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4320, Accuracy: 4734/10000 (47.3400%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3776/4295 (87.9162%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3835/4295 (89.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0971, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5520/6263 (88.1367%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5580/6263 (89.0947%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0886, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3929/4511 (87.0982%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4034/4511 (89.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0590, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4120/4663 (88.3551%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4289/4663 (91.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0502, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3838/4336 (88.5148%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3940/4336 (90.8672%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9938, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4211/4928 (85.4505%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4329/4928 (87.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1569, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3655/4046 (90.3361%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3737/4046 (92.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9765, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3194/3672 (86.9826%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3277/3672 (89.2429%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9305, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3868/4356 (88.7971%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3870/4356 (88.8430%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2327, Accuracy: 5086/10000 (50.8600%)
time spent on training: 269.17491459846497
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.1049, Accuracy: 7061/10000 (70.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 8.6244, Accuracy: 105/9900 (1.0606%)
Done in 298.4102659225464 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 42.45430821639675.
Norm before scaling: 42.45898468945501. Distance: 2.070972610896684
Total norm for 4 adversaries is: 42.45898468945501. distance: 2.070972610896684
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1190, Accuracy: 9600/9900 (96.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 42.45430821639675.
Norm before scaling: 42.459300940172405. Distance: 2.2046712224563545
Total norm for 4 adversaries is: 42.459300940172405. distance: 2.2046712224563545
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1398, Accuracy: 9548/9900 (96.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4220/4717 (89.4636%), train_poison_data_count: 370
Global model norm: 42.45430821639675.
Norm before scaling: 42.45584361694586. Distance: 2.0826389935877763
Total norm for 4 adversaries is: 42.45584361694586. distance: 2.0826389935877763
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1895, Accuracy: 9422/9900 (95.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 42.45430821639675.
Norm before scaling: 42.461866796408486. Distance: 2.235212475877158
Total norm for 4 adversaries is: 42.461866796408486. distance: 2.235212475877158
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2206, Accuracy: 9341/9900 (94.3535%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4330/5037 (85.9639%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4598/5037 (91.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9427, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4042/4647 (86.9808%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4126/4647 (88.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0805, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4153/4663 (89.0628%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4183/4663 (89.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0699, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3819/4336 (88.0766%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3871/4336 (89.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0745, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3375/3756 (89.8562%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3490/3756 (92.9180%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9739, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3953/4625 (85.4703%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4016/4625 (86.8324%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0952, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3867/4362 (88.6520%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4021/4362 (92.1825%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0440, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4277/4874 (87.7513%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4313/4874 (88.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1612, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4086/4767 (85.7143%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4198/4767 (88.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.3014, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3361/3775 (89.0331%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3492/3775 (92.5033%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9731, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4113/4662 (88.2239%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4100/4662 (87.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0551, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5240/6124 (85.5650%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5300/6124 (86.5447%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0367, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3889/4511 (86.2115%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4057/4511 (89.9357%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9473, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3452/3911 (88.2639%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3405/3911 (87.0621%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9011, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4783/5591 (85.5482%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4908/5591 (87.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1160, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3663/4126 (88.7785%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3765/4126 (91.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9162, Accuracy: 5537/10000 (55.3700%)
time spent on training: 264.6916244029999
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.1046, Accuracy: 7062/10000 (70.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 8.6083, Accuracy: 108/9900 (1.0909%)
Done in 293.8946690559387 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 42.454772580285365.
Norm before scaling: 42.459446127212814. Distance: 2.110099385528815
Total norm for 4 adversaries is: 42.459446127212814. distance: 2.110099385528815
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0831, Accuracy: 9683/9900 (97.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4781/5305 (90.1225%), train_poison_data_count: 415
Global model norm: 42.454772580285365.
Norm before scaling: 42.46122426881083. Distance: 2.212233200797487
Total norm for 4 adversaries is: 42.46122426881083. distance: 2.212233200797487
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1281, Accuracy: 9571/9900 (96.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4200/4717 (89.0396%), train_poison_data_count: 370
Global model norm: 42.454772580285365.
Norm before scaling: 42.45876331255128. Distance: 2.0855313595060503
Total norm for 4 adversaries is: 42.45876331255128. distance: 2.0855313595060503
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1291, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4525/5066 (89.3210%), train_poison_data_count: 400
Global model norm: 42.454772580285365.
Norm before scaling: 42.461773364587884. Distance: 2.177532374845379
Total norm for 4 adversaries is: 42.461773364587884. distance: 2.177532374845379
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1997, Accuracy: 9342/9900 (94.3636%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4432/5025 (88.1990%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4515/5025 (89.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1513, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4433/5116 (86.6497%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4510/5116 (88.1548%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9734, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4507/5167 (87.2266%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4562/5167 (88.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1679, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3981/4558 (87.3409%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4034/4558 (88.5037%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0323, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4093/4651 (88.0026%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4145/4651 (89.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0425, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3850/4336 (88.7915%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3895/4336 (89.8293%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0515, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4451/5055 (88.0514%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4539/5055 (89.7923%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9724, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3414/3775 (90.4371%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3513/3775 (93.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9320, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4556/5265 (86.5337%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4610/5265 (87.5594%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0535, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3616/4025 (89.8385%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3682/4025 (91.4783%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0556, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4356/4989 (87.3121%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4401/4989 (88.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9106, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4205/4793 (87.7321%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4303/4793 (89.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9598, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3327/3804 (87.4606%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3432/3804 (90.2208%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9734, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3353/3797 (88.3066%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3443/3797 (90.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0883, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3969/4433 (89.5330%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4056/4433 (91.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8901, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4108/4707 (87.2743%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4221/4707 (89.6750%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9407, Accuracy: 5457/10000 (54.5700%)
time spent on training: 258.940390586853
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.1044, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 8.5932, Accuracy: 108/9900 (1.0909%)
Done in 288.5411684513092 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 42.4551952476446.
Norm before scaling: 42.46086634653652. Distance: 2.0830603484276806
Total norm for 4 adversaries is: 42.46086634653652. distance: 2.0830603484276806
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1869, Accuracy: 9429/9900 (95.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4750/5305 (89.5382%), train_poison_data_count: 415
Global model norm: 42.4551952476446.
Norm before scaling: 42.458340680711665. Distance: 2.1625887813976004
Total norm for 4 adversaries is: 42.458340680711665. distance: 2.1625887813976004
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0768, Accuracy: 9697/9900 (97.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 42.4551952476446.
Norm before scaling: 42.45936850252029. Distance: 2.0230409682873196
Total norm for 4 adversaries is: 42.45936850252029. distance: 2.0230409682873196
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2810, Accuracy: 9215/9900 (93.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4522/5066 (89.2617%), train_poison_data_count: 400
Global model norm: 42.4551952476446.
Norm before scaling: 42.464658156905166. Distance: 2.2146047634787682
Total norm for 4 adversaries is: 42.464658156905166. distance: 2.2146047634787682
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1554, Accuracy: 9502/9900 (95.9798%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4807/5392 (89.1506%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4855/5392 (90.0408%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1441, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4122/4663 (88.3980%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4199/4663 (90.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1395, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3379/3797 (88.9913%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3386/3797 (89.1757%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2058, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5016/5582 (89.8603%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4968/5582 (89.0004%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1336, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4485/5167 (86.8009%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4603/5167 (89.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1263, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3343/3781 (88.4158%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3318/3781 (87.7546%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1163, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3495/3969 (88.0574%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3569/3969 (89.9219%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9795, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3367/3837 (87.7508%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3484/3837 (90.8001%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1250, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5067/5902 (85.8523%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5007/5902 (84.8356%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0596, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4838/5455 (88.6893%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4808/5455 (88.1393%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1338, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4328/5037 (85.9242%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4427/5037 (87.8896%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0068, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4407/5017 (87.8413%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4542/5017 (90.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1600, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4392/4986 (88.0866%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4469/4986 (89.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9557, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4528/5197 (87.1272%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4495/5197 (86.4922%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2499, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3792/4361 (86.9525%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3712/4361 (85.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2971, Accuracy: 4834/10000 (48.3400%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5580/6263 (89.0947%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5678/6263 (90.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1437, Accuracy: 5293/10000 (52.9300%)
time spent on training: 271.64732360839844
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.1042, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 8.5696, Accuracy: 109/9900 (1.1010%)
Done in 300.94065856933594 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4416/4885 (90.3992%), train_poison_data_count: 385
Global model norm: 42.455784674691266.
Norm before scaling: 42.457207891630425. Distance: 2.047361126895629
Total norm for 4 adversaries is: 42.457207891630425. distance: 2.047361126895629
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1092, Accuracy: 9629/9900 (97.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.455784674691266.
Norm before scaling: 42.45468632112361. Distance: 2.1212395324628597
Total norm for 4 adversaries is: 42.45468632112361. distance: 2.1212395324628597
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0862, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4232/4717 (89.7180%), train_poison_data_count: 370
Global model norm: 42.455784674691266.
Norm before scaling: 42.45559059595759. Distance: 2.0125333747702694
Total norm for 4 adversaries is: 42.45559059595759. distance: 2.0125333747702694
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1529, Accuracy: 9487/9900 (95.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4524/5066 (89.3012%), train_poison_data_count: 400
Global model norm: 42.455784674691266.
Norm before scaling: 42.459663188099775. Distance: 2.185661524270292
Total norm for 4 adversaries is: 42.459663188099775. distance: 2.185661524270292
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2725, Accuracy: 9229/9900 (93.2222%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4413/5017 (87.9609%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4497/5017 (89.6352%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8752, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4290/4928 (87.0536%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4362/4928 (88.5146%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0193, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3723/4184 (88.9818%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3784/4184 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9380, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4178/4793 (87.1688%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4295/4793 (89.6098%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1488, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4985/5740 (86.8467%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5127/5740 (89.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0838, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3346/3756 (89.0841%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3470/3756 (92.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9867, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3747/4235 (88.4770%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3747/4235 (88.4770%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0543, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3690/4223 (87.3786%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3778/4223 (89.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9154, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4362/5063 (86.1545%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4284/5063 (84.6139%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2351, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4320/4989 (86.5905%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4375/4989 (87.6929%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9189, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4316/4928 (87.5812%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4404/4928 (89.3669%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0559, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5080/5902 (86.0725%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5059/5902 (85.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2115, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3975/4456 (89.2056%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4083/4456 (91.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9849, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5269/6124 (86.0385%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5311/6124 (86.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1418, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3368/3828 (87.9833%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3459/3828 (90.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9810, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3177/3616 (87.8595%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3263/3616 (90.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8501, Accuracy: 5766/10000 (57.6600%)
time spent on training: 267.3109200000763
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.1039, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 8.5555, Accuracy: 111/9900 (1.1212%)
Done in 296.43543672561646 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4425/4885 (90.5834%), train_poison_data_count: 385
Global model norm: 42.456303651243154.
Norm before scaling: 42.45936850252029. Distance: 2.0679750310545195
Total norm for 4 adversaries is: 42.45936850252029. distance: 2.0679750310545195
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1694, Accuracy: 9496/9900 (95.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 42.456303651243154.
Norm before scaling: 42.45820555263729. Distance: 2.1572229153078606
Total norm for 4 adversaries is: 42.45820555263729. distance: 2.1572229153078606
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1883, Accuracy: 9427/9900 (95.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 42.456303651243154.
Norm before scaling: 42.458618123175974. Distance: 2.0375674090321767
Total norm for 4 adversaries is: 42.458618123175974. distance: 2.0375674090321767
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1912, Accuracy: 9399/9900 (94.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 42.456303651243154.
Norm before scaling: 42.464533110180604. Distance: 2.1961711683981555
Total norm for 4 adversaries is: 42.464533110180604. distance: 2.1961711683981555
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.3132, Accuracy: 9121/9900 (92.1313%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3705/4223 (87.7338%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3783/4223 (89.5809%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0392, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3900/4362 (89.4085%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3966/4362 (90.9216%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9947, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5487/6391 (85.8551%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5540/6391 (86.6844%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0830, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4121/4793 (85.9796%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4266/4793 (89.0048%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1403, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3351/3756 (89.2173%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3443/3756 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0330, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4082/4618 (88.3932%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4104/4618 (88.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9967, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3557/4025 (88.3727%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3641/4025 (90.4596%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9188, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3106/3638 (85.3766%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3293/3638 (90.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8666, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3856/4315 (89.3627%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3975/4315 (92.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8643, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3779/4295 (87.9860%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3659/4295 (85.1921%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1713, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4311/4928 (87.4797%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4411/4928 (89.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0566, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4394/4986 (88.1268%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4473/4986 (89.7112%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9990, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3618/4126 (87.6878%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3734/4126 (90.4993%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9079, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4327/4918 (87.9829%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4427/4918 (90.0163%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2551, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4533/5195 (87.2570%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4469/5195 (86.0250%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1489, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5000/5740 (87.1080%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5120/5740 (89.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2179, Accuracy: 5136/10000 (51.3600%)
time spent on training: 263.5016198158264
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.1037, Accuracy: 7061/10000 (70.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 8.5439, Accuracy: 111/9900 (1.1212%)
Done in 292.54131841659546 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 42.45677518122476.
Norm before scaling: 42.4575730325286. Distance: 2.03109423700405
Total norm for 4 adversaries is: 42.4575730325286. distance: 2.03109423700405
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0915, Accuracy: 9654/9900 (97.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 42.45677518122476.
Norm before scaling: 42.45967612546859. Distance: 2.1465425769804893
Total norm for 4 adversaries is: 42.45967612546859. distance: 2.1465425769804893
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1905, Accuracy: 9420/9900 (95.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4229/4717 (89.6544%), train_poison_data_count: 370
Global model norm: 42.45677518122476.
Norm before scaling: 42.45919887769831. Distance: 2.037712146971401
Total norm for 4 adversaries is: 42.45919887769831. distance: 2.037712146971401
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.3470, Accuracy: 9076/9900 (91.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 42.45677518122476.
Norm before scaling: 42.46763617238794. Distance: 2.2390970337913894
Total norm for 4 adversaries is: 42.46763617238794. distance: 2.2390970337913894
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2240, Accuracy: 9352/9900 (94.4646%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2926/3297 (88.7473%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3017/3297 (91.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8541, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3366/3828 (87.9310%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3475/3828 (90.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0379, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4351/5063 (85.9372%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4318/5063 (85.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0700, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3900/4501 (86.6474%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3987/4501 (88.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9406, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4166/4793 (86.9184%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4294/4793 (89.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9900, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3731/4223 (88.3495%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3850/4223 (91.1674%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0041, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3362/3756 (89.5101%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3475/3756 (92.5186%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9557, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3146/3638 (86.4761%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3250/3638 (89.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8939, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3149/3646 (86.3686%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3273/3646 (89.7696%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9008, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4302/4874 (88.2643%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4262/4874 (87.4436%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1592, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5555/6263 (88.6955%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5634/6263 (89.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0817, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4352/5037 (86.4006%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4476/5037 (88.8624%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9753, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3925/4362 (89.9817%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3900/4362 (89.4085%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0736, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3858/4356 (88.5675%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3789/4356 (86.9835%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0737, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4478/5116 (87.5293%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4523/5116 (88.4089%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0867, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3912/4346 (90.0138%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4005/4346 (92.1537%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9197, Accuracy: 5551/10000 (55.5100%)
time spent on training: 261.5378816127777
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.1035, Accuracy: 7062/10000 (70.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 8.5256, Accuracy: 112/9900 (1.1313%)
Done in 290.83231687545776 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 42.457183452954254.
Norm before scaling: 42.46118545810765. Distance: 2.092670788830872
Total norm for 4 adversaries is: 42.46118545810765. distance: 2.092670788830872
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1509, Accuracy: 9523/9900 (96.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 42.457183452954254.
Norm before scaling: 42.459851498301454. Distance: 2.141942530675839
Total norm for 4 adversaries is: 42.459851498301454. distance: 2.141942530675839
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2714, Accuracy: 9220/9900 (93.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4259/4717 (90.2904%), train_poison_data_count: 370
Global model norm: 42.457183452954254.
Norm before scaling: 42.46048829684192. Distance: 2.015371144003877
Total norm for 4 adversaries is: 42.46048829684192. distance: 2.015371144003877
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2396, Accuracy: 9277/9900 (93.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4502/5066 (88.8670%), train_poison_data_count: 400
Global model norm: 42.457183452954254.
Norm before scaling: 42.46596322028458. Distance: 2.1982291724126037
Total norm for 4 adversaries is: 42.46596322028458. distance: 2.1982291724126037
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2599, Accuracy: 9252/9900 (93.4545%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4035/4518 (89.3094%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4133/4518 (91.4785%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0152, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3974/4558 (87.1874%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3986/4558 (87.4506%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1706, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3361/3804 (88.3544%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3417/3804 (89.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9958, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3357/3775 (88.9272%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3513/3775 (93.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8525, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4439/5083 (87.3303%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4446/5083 (87.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1163, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4332/4928 (87.9058%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4426/4928 (89.8133%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8838, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4453/5244 (84.9161%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4492/5244 (85.6598%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1857, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4271/4989 (85.6083%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4399/4989 (88.1740%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9506, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4398/4986 (88.2070%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4482/4986 (89.8917%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9630, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3630/4175 (86.9461%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3632/4175 (86.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0437, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4544/5232 (86.8502%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4608/5232 (88.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1584, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4350/5063 (85.9174%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4173/5063 (82.4215%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2874, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4010/4441 (90.2950%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4057/4441 (91.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0558, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3159/3646 (86.6429%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3313/3646 (90.8667%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9532, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4543/5167 (87.9234%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4666/5167 (90.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0728, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4022/4538 (88.6294%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4125/4538 (90.8991%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8934, Accuracy: 5577/10000 (55.7700%)
time spent on training: 265.45227098464966
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.1032, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 8.4994, Accuracy: 115/9900 (1.1616%)
Done in 294.6842815876007 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 42.45787635584754.
Norm before scaling: 42.45929375268226. Distance: 2.028740609288884
Total norm for 4 adversaries is: 42.45929375268226. distance: 2.028740609288884
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1941, Accuracy: 9437/9900 (95.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 42.45787635584754.
Norm before scaling: 42.45538932818556. Distance: 2.1010129983055963
Total norm for 4 adversaries is: 42.45538932818556. distance: 2.1010129983055963
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1030, Accuracy: 9627/9900 (97.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4186/4717 (88.7428%), train_poison_data_count: 370
Global model norm: 42.45787635584754.
Norm before scaling: 42.46370520533536. Distance: 2.1159764729004924
Total norm for 4 adversaries is: 42.46370520533536. distance: 2.1159764729004924
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0991, Accuracy: 9631/9900 (97.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 42.45787635584754.
Norm before scaling: 42.46384462794128. Distance: 2.1609928104717055
Total norm for 4 adversaries is: 42.46384462794128. distance: 2.1609928104717055
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1113, Accuracy: 9597/9900 (96.9394%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3881/4356 (89.0955%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3822/4356 (87.7410%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1754, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4294/4928 (87.1347%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4314/4928 (87.5406%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1286, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4373/5037 (86.8176%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4470/5037 (88.7433%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9459, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4162/4804 (86.6361%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4027/4804 (83.8260%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3821, Accuracy: 4829/10000 (48.2900%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3415/3775 (90.4636%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3528/3775 (93.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8091, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4554/5167 (88.1362%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4651/5167 (90.0135%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1227, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3763/4235 (88.8548%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3852/4235 (90.9563%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0181, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4224/4956 (85.2300%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4302/4956 (86.8039%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0555, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5046/5740 (87.9094%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5204/5740 (90.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1305, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4147/4679 (88.6300%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4251/4679 (90.8527%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2613, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3245/3704 (87.6080%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3350/3704 (90.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8914, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3100/3472 (89.2857%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3171/3472 (91.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0069, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4106/4651 (88.2821%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4182/4651 (89.9161%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0452, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4035/4634 (87.0738%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4134/4634 (89.2102%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8958, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5059/5902 (85.7167%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5065/5902 (85.8184%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1569, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3362/3837 (87.6205%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3513/3837 (91.5559%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8736, Accuracy: 5623/10000 (56.2300%)
time spent on training: 265.8146159648895
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.1029, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 8.4827, Accuracy: 122/9900 (1.2323%)
Done in 295.15163922309875 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4430/4885 (90.6858%), train_poison_data_count: 385
Global model norm: 42.45837230636909.
Norm before scaling: 42.46157212612217. Distance: 2.0499960131722736
Total norm for 4 adversaries is: 42.46157212612217. distance: 2.0499960131722736
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2288, Accuracy: 9336/9900 (94.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 42.45837230636909.
Norm before scaling: 42.460078619418354. Distance: 2.131968460472381
Total norm for 4 adversaries is: 42.460078619418354. distance: 2.131968460472381
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1261, Accuracy: 9579/9900 (96.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.45837230636909.
Norm before scaling: 42.459495001946415. Distance: 2.0475430162915877
Total norm for 4 adversaries is: 42.459495001946415. distance: 2.0475430162915877
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2148, Accuracy: 9370/9900 (94.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.45837230636909.
Norm before scaling: 42.46745508281533. Distance: 2.254059202931419
Total norm for 4 adversaries is: 42.46745508281533. distance: 2.254059202931419
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0833, Accuracy: 9683/9900 (97.8081%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3473/3969 (87.5031%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3590/3969 (90.4510%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9068, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4089/4707 (86.8706%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4167/4707 (88.5277%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9088, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3407/3861 (88.2414%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3464/3861 (89.7177%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9466, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4089/4596 (88.9687%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4175/4596 (90.8399%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0809, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3970/4503 (88.1634%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3973/4503 (88.2301%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1943, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4366/4928 (88.5958%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4436/4928 (90.0162%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9641, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4428/5025 (88.1194%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4480/5025 (89.1542%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1913, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4037/4576 (88.2212%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4139/4576 (90.4502%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9931, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4316/4918 (87.7593%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4423/4918 (89.9349%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9989, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3898/4315 (90.3360%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3940/4315 (91.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9110, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3172/3590 (88.3565%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3217/3590 (89.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0379, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3979/4456 (89.2953%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4024/4456 (90.3052%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9970, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3796/4354 (87.1842%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3634/4354 (83.4635%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.4925, Accuracy: 4714/10000 (47.1400%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3932/4501 (87.3584%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3974/4501 (88.2915%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9988, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3381/3911 (86.4485%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3393/3911 (86.7553%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1475, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4027/4558 (88.3502%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4040/4558 (88.6354%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1924, Accuracy: 5109/10000 (51.0900%)
time spent on training: 262.9845266342163
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.1027, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 8.4607, Accuracy: 125/9900 (1.2626%)
Done in 292.3871510028839 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 42.458974626893514.
Norm before scaling: 42.46234113940331. Distance: 2.0444144099328336
Total norm for 4 adversaries is: 42.46234113940331. distance: 2.0444144099328336
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2756, Accuracy: 9239/9900 (93.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 42.458974626893514.
Norm before scaling: 42.45740915078162. Distance: 2.0991169480688594
Total norm for 4 adversaries is: 42.45740915078162. distance: 2.0991169480688594
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1279, Accuracy: 9570/9900 (96.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 42.458974626893514.
Norm before scaling: 42.462290830548994. Distance: 2.023813220162315
Total norm for 4 adversaries is: 42.462290830548994. distance: 2.023813220162315
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2733, Accuracy: 9223/9900 (93.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4501/5066 (88.8472%), train_poison_data_count: 400
Global model norm: 42.458974626893514.
Norm before scaling: 42.467282615837775. Distance: 2.2161405020148
Total norm for 4 adversaries is: 42.467282615837775. distance: 2.2161405020148
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2622, Accuracy: 9233/9900 (93.2626%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4463/5116 (87.2361%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4516/5116 (88.2721%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0970, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4795/5392 (88.9280%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4741/5392 (87.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1422, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4114/4767 (86.3017%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4159/4767 (87.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2308, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4086/4618 (88.4799%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4037/4618 (87.4188%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0581, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3659/4046 (90.4350%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3697/4046 (91.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0452, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3930/4625 (84.9730%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4045/4625 (87.4595%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1896, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3132/3638 (86.0913%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3313/3638 (91.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9210, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3852/4416 (87.2283%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3906/4416 (88.4511%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0162, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4252/4874 (87.2384%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4218/4874 (86.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.3677, Accuracy: 4873/10000 (48.7300%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3178/3646 (87.1640%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3263/3646 (89.4953%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9842, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4369/5063 (86.2927%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4305/5063 (85.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1164, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3621/4126 (87.7605%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3755/4126 (91.0082%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9996, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4262/4934 (86.3802%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4288/4934 (86.9072%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2626, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3945/4511 (87.4529%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4009/4511 (88.8716%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0683, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3984/4518 (88.1806%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4077/4518 (90.2390%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0028, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2935/3297 (89.0203%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2997/3297 (90.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7671, Accuracy: 5803/10000 (58.0300%)
time spent on training: 262.62202763557434
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.1025, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 8.4516, Accuracy: 128/9900 (1.2929%)
Done in 293.75616240501404 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4370/4885 (89.4575%), train_poison_data_count: 385
Global model norm: 42.45936419003321.
Norm before scaling: 42.46376988598266. Distance: 2.0886362740896547
Total norm for 4 adversaries is: 42.46376988598266. distance: 2.0886362740896547
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1130, Accuracy: 9593/9900 (96.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 42.45936419003321.
Norm before scaling: 42.46334011716754. Distance: 2.177344590957857
Total norm for 4 adversaries is: 42.46334011716754. distance: 2.177344590957857
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1025, Accuracy: 9640/9900 (97.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 42.45936419003321.
Norm before scaling: 42.46009730654477. Distance: 2.0324587233365037
Total norm for 4 adversaries is: 42.46009730654477. distance: 2.0324587233365037
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2272, Accuracy: 9300/9900 (93.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4495/5066 (88.7288%), train_poison_data_count: 400
Global model norm: 42.45936419003321.
Norm before scaling: 42.464533110180604. Distance: 2.206911012868322
Total norm for 4 adversaries is: 42.464533110180604. distance: 2.206911012868322
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2204, Accuracy: 9340/9900 (94.3434%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5305/6124 (86.6264%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5349/6124 (87.3449%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0119, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4391/5025 (87.3831%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4516/5025 (89.8706%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1787, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3071/3472 (88.4505%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3122/3472 (89.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0742, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4383/5037 (87.0161%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4482/5037 (88.9815%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0814, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4992/5582 (89.4303%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5021/5582 (89.9498%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1416, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4464/5116 (87.2557%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4479/5116 (87.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0744, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3985/4518 (88.2027%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4072/4518 (90.1284%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0473, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4293/4928 (87.1144%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4372/4928 (88.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9634, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3963/4558 (86.9460%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3991/4558 (87.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0870, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2936/3297 (89.0507%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3014/3297 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8726, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3374/3756 (89.8296%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3467/3756 (92.3056%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0706, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4077/4651 (87.6586%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4150/4651 (89.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1094, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3965/4441 (89.2817%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4090/4441 (92.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1121, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3123/3638 (85.8439%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3250/3638 (89.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8738, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4056/4596 (88.2507%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4162/4596 (90.5570%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0998, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2832/3271 (86.5790%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0061, Accuracy: 2890/3271 (88.3522%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9656, Accuracy: 5523/10000 (55.2300%)
time spent on training: 262.4557020664215
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.1023, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 8.4351, Accuracy: 131/9900 (1.3232%)
Done in 291.7680959701538 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4417/4885 (90.4197%), train_poison_data_count: 385
Global model norm: 42.45981556130455.
Norm before scaling: 42.46443393493033. Distance: 2.0443251940713814
Total norm for 4 adversaries is: 42.46443393493033. distance: 2.0443251940713814
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.3169, Accuracy: 9065/9900 (91.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4803/5305 (90.5372%), train_poison_data_count: 415
Global model norm: 42.45981556130455.
Norm before scaling: 42.460782974649824. Distance: 2.129008047487343
Total norm for 4 adversaries is: 42.460782974649824. distance: 2.129008047487343
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0809, Accuracy: 9666/9900 (97.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4201/4717 (89.0608%), train_poison_data_count: 370
Global model norm: 42.45981556130455.
Norm before scaling: 42.46305839344359. Distance: 2.0692572441458195
Total norm for 4 adversaries is: 42.46305839344359. distance: 2.0692572441458195
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2523, Accuracy: 9265/9900 (93.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 42.45981556130455.
Norm before scaling: 42.46215140284124. Distance: 2.1388871315402564
Total norm for 4 adversaries is: 42.46215140284124. distance: 2.1388871315402564
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.3599, Accuracy: 8941/9900 (90.3131%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4340/4989 (86.9914%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4419/4989 (88.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0269, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3964/4465 (88.7794%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4094/4465 (91.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8771, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3863/4315 (89.5249%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3927/4315 (91.0081%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8564, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4102/4767 (86.0499%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4138/4767 (86.8051%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1210, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5505/6391 (86.1368%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5522/6391 (86.4028%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0559, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3202/3672 (87.2004%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3231/3672 (87.9902%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0099, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3528/3969 (88.8889%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3572/3969 (89.9975%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9639, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3215/3590 (89.5543%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3199/3590 (89.1086%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1148, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5118/5902 (86.7164%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5008/5902 (84.8526%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1938, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3560/4013 (88.7117%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3680/4013 (91.7020%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8219, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4192/4804 (87.2606%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4129/4804 (85.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2537, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3624/4175 (86.8024%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3678/4175 (88.0958%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9915, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3155/3616 (87.2511%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3260/3616 (90.1549%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9327, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3785/4361 (86.7920%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3779/4361 (86.6544%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1643, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4754/5424 (87.6475%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4871/5424 (89.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2621, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3400/3837 (88.6109%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3530/3837 (91.9990%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9094, Accuracy: 5618/10000 (56.1800%)
time spent on training: 252.83157896995544
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.1021, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 8.4221, Accuracy: 135/9900 (1.3636%)
Done in 282.424156665802 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 42.46021230406473.
Norm before scaling: 42.46190704389862. Distance: 2.037486318530621
Total norm for 4 adversaries is: 42.46190704389862. distance: 2.037486318530621
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1337, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 42.46021230406473.
Norm before scaling: 42.46103165237952. Distance: 2.10913830594765
Total norm for 4 adversaries is: 42.46103165237952. distance: 2.10913830594765
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2454, Accuracy: 9279/9900 (93.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4237/4717 (89.8240%), train_poison_data_count: 370
Global model norm: 42.46021230406473.
Norm before scaling: 42.46387337481341. Distance: 2.013592427089668
Total norm for 4 adversaries is: 42.46387337481341. distance: 2.013592427089668
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.3439, Accuracy: 9026/9900 (91.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 42.46021230406473.
Norm before scaling: 42.465734693360425. Distance: 2.203393473398363
Total norm for 4 adversaries is: 42.465734693360425. distance: 2.203393473398363
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2132, Accuracy: 9297/9900 (93.9091%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3776/4416 (85.5072%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3909/4416 (88.5190%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9738, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4986/5740 (86.8641%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5078/5740 (88.4669%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2152, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4396/5037 (87.2742%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4543/5037 (90.1926%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9689, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4523/5116 (88.4089%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4524/5116 (88.4285%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9785, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4338/4918 (88.2066%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4444/4918 (90.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0146, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3354/3837 (87.4120%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3512/3837 (91.5298%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9894, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4079/4651 (87.7016%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4170/4651 (89.6581%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1212, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3410/3861 (88.3191%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3468/3861 (89.8213%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9740, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3708/4223 (87.8049%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3911/4223 (92.6119%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9978, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4130/4662 (88.5886%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4245/4662 (91.0553%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0582, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5573/6263 (88.9829%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5575/6263 (89.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2775, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3350/3781 (88.6009%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3228/3781 (85.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2696, Accuracy: 4910/10000 (49.1000%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3359/3804 (88.3018%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3401/3804 (89.4059%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1123, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3409/3828 (89.0543%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3513/3828 (91.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8544, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3886/4315 (90.0579%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3920/4315 (90.8459%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9721, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4260/4956 (85.9564%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4363/4956 (88.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0112, Accuracy: 5451/10000 (54.5100%)
time spent on training: 267.8169586658478
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.1018, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 8.4092, Accuracy: 138/9900 (1.3939%)
Done in 296.77415657043457 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 42.46066222886853.
Norm before scaling: 42.46176905234505. Distance: 2.060305844352175
Total norm for 4 adversaries is: 42.46176905234505. distance: 2.060305844352175
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0959, Accuracy: 9648/9900 (97.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 42.46066222886853.
Norm before scaling: 42.459746562185224. Distance: 2.0831155154484122
Total norm for 4 adversaries is: 42.459746562185224. distance: 2.0831155154484122
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0887, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4232/4717 (89.7180%), train_poison_data_count: 370
Global model norm: 42.46066222886853.
Norm before scaling: 42.466576931158464. Distance: 2.05487848706892
Total norm for 4 adversaries is: 42.466576931158464. distance: 2.05487848706892
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1927, Accuracy: 9437/9900 (95.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4540/5066 (89.6171%), train_poison_data_count: 400
Global model norm: 42.46066222886853.
Norm before scaling: 42.46618743418477. Distance: 2.124929987932139
Total norm for 4 adversaries is: 42.46618743418477. distance: 2.124929987932139
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2319, Accuracy: 9326/9900 (94.2020%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4103/4662 (88.0094%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4164/4662 (89.3179%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2505, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3181/3616 (87.9701%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3265/3616 (90.2931%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8365, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3373/3828 (88.1139%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3458/3828 (90.3344%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9280, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0062, Accuracy: 2886/3297 (87.5341%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3003/3297 (91.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8596, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3767/4361 (86.3793%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3728/4361 (85.4850%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9953, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4037/4576 (88.2212%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4134/4576 (90.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0538, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3776/4295 (87.9162%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3729/4295 (86.8219%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0909, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4490/5083 (88.3337%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4495/5083 (88.4320%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1078, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4492/5116 (87.8030%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4517/5116 (88.2916%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0457, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3621/4046 (89.4958%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3662/4046 (90.5091%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8453, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5075/5902 (85.9878%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4956/5902 (83.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1363, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4542/5197 (87.3966%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4579/5197 (88.1085%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.3644, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3993/4465 (89.4289%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4121/4465 (92.2956%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9318, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3246/3704 (87.6350%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3380/3704 (91.2527%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8731, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3401/3861 (88.0860%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3443/3861 (89.1738%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9517, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3595/4126 (87.1304%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3757/4126 (91.0567%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8841, Accuracy: 5594/10000 (55.9400%)
time spent on training: 260.97125029563904
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.1016, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 8.3980, Accuracy: 140/9900 (1.4141%)
Done in 290.1193861961365 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 42.461076212974895.
Norm before scaling: 42.46209534414929. Distance: 2.0592380507088794
Total norm for 4 adversaries is: 42.46209534414929. distance: 2.0592380507088794
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2095, Accuracy: 9353/9900 (94.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 42.461076212974895.
Norm before scaling: 42.461475818804715. Distance: 2.0998537285135703
Total norm for 4 adversaries is: 42.461475818804715. distance: 2.0998537285135703
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.3156, Accuracy: 9151/9900 (92.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 42.461076212974895.
Norm before scaling: 42.46517702501221. Distance: 1.9996652919122102
Total norm for 4 adversaries is: 42.46517702501221. distance: 1.9996652919122102
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2469, Accuracy: 9293/9900 (93.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 42.461076212974895.
Norm before scaling: 42.46853442274203. Distance: 2.1783894054120188
Total norm for 4 adversaries is: 42.46853442274203. distance: 2.1783894054120188
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2599, Accuracy: 9253/9900 (93.4646%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3936/4511 (87.2534%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3999/4511 (88.6500%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9828, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4998/5740 (87.0732%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5144/5740 (89.6167%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9985, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4126/4662 (88.5028%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4178/4662 (89.6182%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1544, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3736/4235 (88.2172%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3814/4235 (90.0590%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0026, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4574/5265 (86.8756%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4643/5265 (88.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9516, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3988/4433 (89.9617%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3987/4433 (89.9391%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1030, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4064/4596 (88.4247%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4174/4596 (90.8181%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0663, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4493/5055 (88.8823%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4545/5055 (89.9110%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9602, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4320/5037 (85.7653%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4472/5037 (88.7830%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1696, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4034/4538 (88.8938%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4167/4538 (91.8246%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7850, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3357/3756 (89.3770%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3452/3756 (91.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0092, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3568/4025 (88.6460%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3736/4025 (92.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9157, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4404/5244 (83.9817%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4507/5244 (85.9458%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0198, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4151/4663 (89.0199%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4260/4663 (91.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9960, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3393/3837 (88.4285%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3534/3837 (92.1032%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9619, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3862/4481 (86.1861%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3862/4481 (86.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1481, Accuracy: 5244/10000 (52.4400%)
time spent on training: 266.6189658641815
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.1013, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 8.3768, Accuracy: 142/9900 (1.4343%)
Done in 295.7138001918793 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4388/4885 (89.8260%), train_poison_data_count: 385
Global model norm: 42.46175899044339.
Norm before scaling: 42.46842950808062. Distance: 2.1379038646698576
Total norm for 4 adversaries is: 42.46842950808062. distance: 2.1379038646698576
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1655, Accuracy: 9495/9900 (95.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4808/5305 (90.6315%), train_poison_data_count: 415
Global model norm: 42.46175899044339.
Norm before scaling: 42.46040636167343. Distance: 2.1047627073811253
Total norm for 4 adversaries is: 42.46040636167343. distance: 2.1047627073811253
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.2003, Accuracy: 9383/9900 (94.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 42.46175899044339.
Norm before scaling: 42.46576775079031. Distance: 2.0376296581366944
Total norm for 4 adversaries is: 42.46576775079031. distance: 2.0376296581366944
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1187, Accuracy: 9586/9900 (96.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4503/5066 (88.8867%), train_poison_data_count: 400
Global model norm: 42.46175899044339.
Norm before scaling: 42.469961523833966. Distance: 2.2333635294946297
Total norm for 4 adversaries is: 42.469961523833966. distance: 2.2333635294946297
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1713, Accuracy: 9446/9900 (95.4141%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3905/4362 (89.5232%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3884/4362 (89.0417%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2219, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4819/5591 (86.1921%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4837/5591 (86.5140%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2299, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3849/4315 (89.2005%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3900/4315 (90.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0195, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3339/3781 (88.3100%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3409/3781 (90.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0456, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3572/4158 (85.9067%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3641/4158 (87.5661%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9257, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3929/4511 (87.0982%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4029/4511 (89.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0139, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4166/4793 (86.9184%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4278/4793 (89.2552%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0259, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4773/5424 (87.9978%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4915/5424 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3571, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4088/4618 (88.5232%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4149/4618 (89.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9824, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3829/4368 (87.6603%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3904/4368 (89.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0463, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4282/4934 (86.7856%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4017/4934 (81.4147%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2525, Accuracy: 4935/10000 (49.3500%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4532/5232 (86.6208%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4592/5232 (87.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9725, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5111/5902 (86.5978%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5149/5902 (87.2416%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2727, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4754/5392 (88.1677%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4736/5392 (87.8338%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3671, Accuracy: 4920/10000 (49.2000%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4410/5017 (87.9011%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4447/5017 (88.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0748, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4476/5195 (86.1598%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4516/5195 (86.9297%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1052, Accuracy: 5216/10000 (52.1600%)
time spent on training: 259.0060820579529
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.1011, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 8.3558, Accuracy: 146/9900 (1.4747%)
Done in 288.6238663196564 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 42.46225345821863.
Norm before scaling: 42.46849705590604. Distance: 2.0871552188328546
Total norm for 4 adversaries is: 42.46849705590604. distance: 2.0871552188328546
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2617, Accuracy: 9260/9900 (93.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 42.46225345821863.
Norm before scaling: 42.46353128577288. Distance: 2.1106884293405206
Total norm for 4 adversaries is: 42.46353128577288. distance: 2.1106884293405206
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1850, Accuracy: 9463/9900 (95.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4236/4717 (89.8028%), train_poison_data_count: 370
Global model norm: 42.46225345821863.
Norm before scaling: 42.46256249765418. Distance: 2.0118228033617833
Total norm for 4 adversaries is: 42.46256249765418. distance: 2.0118228033617833
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.3435, Accuracy: 9032/9900 (91.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4559/5066 (89.9921%), train_poison_data_count: 400
Global model norm: 42.46225345821863.
Norm before scaling: 42.466653105425706. Distance: 2.1275126244140163
Total norm for 4 adversaries is: 42.466653105425706. distance: 2.1275126244140163
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.3052, Accuracy: 9097/9900 (91.8889%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4597/5265 (87.3124%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4635/5265 (88.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9427, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3637/4126 (88.1483%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3746/4126 (90.7901%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8170, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3948/4501 (87.7138%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3998/4501 (88.8247%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1674, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5266/6124 (85.9895%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5262/6124 (85.9242%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0165, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2861/3271 (87.4656%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0063, Accuracy: 2848/3271 (87.0682%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0666, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4109/4663 (88.1192%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4223/4663 (90.5640%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0857, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3589/4025 (89.1677%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3703/4025 (92.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9159, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4060/4651 (87.2931%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4173/4651 (89.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0718, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4190/4804 (87.2190%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4117/4804 (85.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1668, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3171/3616 (87.6936%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3261/3616 (90.1825%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8530, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3494/3911 (89.3378%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3237/3911 (82.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.3153, Accuracy: 4929/10000 (49.2900%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4551/5197 (87.5698%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4559/5197 (87.7237%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0675, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4016/4538 (88.4971%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4156/4538 (91.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9578, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5471/6391 (85.6048%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5518/6391 (86.3402%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0256, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3209/3704 (86.6361%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3307/3704 (89.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7888, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3712/4235 (87.6505%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3751/4235 (88.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1736, Accuracy: 5205/10000 (52.0500%)
time spent on training: 265.6811056137085
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.1009, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 8.3396, Accuracy: 146/9900 (1.4747%)
Done in 294.84305024147034 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4392/4885 (89.9079%), train_poison_data_count: 385
Global model norm: 42.46273067165782.
Norm before scaling: 42.4712290598184. Distance: 2.101304956701223
Total norm for 4 adversaries is: 42.4712290598184. distance: 2.101304956701223
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1713, Accuracy: 9439/9900 (95.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 42.46273067165782.
Norm before scaling: 42.462743608092055. Distance: 2.10939444073796
Total norm for 4 adversaries is: 42.462743608092055. distance: 2.10939444073796
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1308, Accuracy: 9559/9900 (96.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4229/4717 (89.6544%), train_poison_data_count: 370
Global model norm: 42.46273067165782.
Norm before scaling: 42.46509222428685. Distance: 2.0202014630008662
Total norm for 4 adversaries is: 42.46509222428685. distance: 2.0202014630008662
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.2728, Accuracy: 9259/9900 (93.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4535/5066 (89.5184%), train_poison_data_count: 400
Global model norm: 42.46273067165782.
Norm before scaling: 42.46440375111253. Distance: 2.1441296477617984
Total norm for 4 adversaries is: 42.46440375111253. distance: 2.1441296477617984
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1743, Accuracy: 9449/9900 (95.4444%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4486/5116 (87.6857%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4534/5116 (88.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9410, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4998/5582 (89.5378%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5078/5582 (90.9710%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1495, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3788/4235 (89.4451%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3657/4235 (86.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1385, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3977/4625 (85.9892%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4040/4625 (87.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0961, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0086, Accuracy: 3848/4481 (85.8737%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3873/4481 (86.4316%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2569, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4539/5232 (86.7546%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4590/5232 (87.7294%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0027, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4102/4662 (87.9880%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4196/4662 (90.0043%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8824, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3993/4441 (89.9122%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4081/4441 (91.8937%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0602, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3987/4518 (88.2470%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4098/4518 (90.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9563, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4331/4928 (87.8856%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4423/4928 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9822, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4064/4634 (87.6996%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4182/4634 (90.2460%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0191, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4295/4934 (87.0490%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4204/4934 (85.2047%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2610, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3438/3861 (89.0443%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3437/3861 (89.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0747, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3157/3616 (87.3064%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3271/3616 (90.4591%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9371, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3826/4416 (86.6395%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3955/4416 (89.5607%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0126, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3362/3797 (88.5436%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3399/3797 (89.5180%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9579, Accuracy: 5571/10000 (55.7100%)
time spent on training: 265.92830872535706
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.1007, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 8.3217, Accuracy: 151/9900 (1.5253%)
Done in 295.3395035266876 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 42.46323087757808.
Norm before scaling: 42.46877874355172. Distance: 2.0650372937323955
Total norm for 4 adversaries is: 42.46877874355172. distance: 2.0650372937323955
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1644, Accuracy: 9485/9900 (95.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4803/5305 (90.5372%), train_poison_data_count: 415
Global model norm: 42.46323087757808.
Norm before scaling: 42.46500023686786. Distance: 2.08399066727465
Total norm for 4 adversaries is: 42.46500023686786. distance: 2.08399066727465
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1181, Accuracy: 9590/9900 (96.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 42.46323087757808.
Norm before scaling: 42.46212984181464. Distance: 1.966059162848534
Total norm for 4 adversaries is: 42.46212984181464. distance: 1.966059162848534
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.3358, Accuracy: 9054/9900 (91.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4532/5066 (89.4591%), train_poison_data_count: 400
Global model norm: 42.46323087757808.
Norm before scaling: 42.46822973835118. Distance: 2.1625259397858287
Total norm for 4 adversaries is: 42.46822973835118. distance: 2.1625259397858287
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.2119, Accuracy: 9349/9900 (94.4343%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5528/6263 (88.2644%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5574/6263 (88.9989%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1497, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3740/4295 (87.0780%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3798/4295 (88.4284%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9984, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4284/4989 (85.8689%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4352/4989 (87.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9755, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3732/4223 (88.3732%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3847/4223 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8867, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5311/6124 (86.7244%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5393/6124 (88.0634%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0243, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3889/4481 (86.7887%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3867/4481 (86.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0821, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4089/4618 (88.5448%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4022/4618 (87.0940%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0978, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4058/4441 (91.3758%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4052/4441 (91.2407%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0607, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3571/4013 (88.9858%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3654/4013 (91.0541%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8342, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3901/4511 (86.4775%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4054/4511 (89.8692%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0152, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3771/4416 (85.3940%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3905/4416 (88.4284%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0089, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4242/4956 (85.5932%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4313/4956 (87.0258%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1328, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4020/4538 (88.5853%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4141/4538 (91.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9476, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4528/5265 (86.0019%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4587/5265 (87.1225%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0558, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4551/5197 (87.5698%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4427/5197 (85.1838%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1493, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4120/4716 (87.3622%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4236/4716 (89.8219%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0078, Accuracy: 5386/10000 (53.8600%)
time spent on training: 269.58357644081116
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.1004, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 8.3028, Accuracy: 152/9900 (1.5354%)
Done in 299.1397271156311 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 42.46377707271516.
Norm before scaling: 42.46709146411931. Distance: 2.071615593552518
Total norm for 4 adversaries is: 42.46709146411931. distance: 2.071615593552518
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2936, Accuracy: 9169/9900 (92.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 42.46377707271516.
Norm before scaling: 42.46759736754453. Distance: 2.173923322404527
Total norm for 4 adversaries is: 42.46759736754453. distance: 2.173923322404527
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1386, Accuracy: 9550/9900 (96.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 42.46377707271516.
Norm before scaling: 42.46796816793217. Distance: 2.04287001770566
Total norm for 4 adversaries is: 42.46796816793217. distance: 2.04287001770566
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1504, Accuracy: 9518/9900 (96.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4504/5066 (88.9064%), train_poison_data_count: 400
Global model norm: 42.46377707271516.
Norm before scaling: 42.46655537237877. Distance: 2.157926156754246
Total norm for 4 adversaries is: 42.46655537237877. distance: 2.157926156754246
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2811, Accuracy: 9200/9900 (92.9293%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3151/3616 (87.1405%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3309/3616 (91.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7921, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3889/4315 (90.1275%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3945/4315 (91.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0088, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4883/5455 (89.5142%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4832/5455 (88.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0807, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4168/4804 (86.7610%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4014/4804 (83.5554%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2898, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3886/4362 (89.0876%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3940/4362 (90.3255%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9783, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5560/6263 (88.7753%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5655/6263 (90.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1420, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4022/4538 (88.6294%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4125/4538 (90.8991%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9216, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4075/4634 (87.9370%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4142/4634 (89.3828%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0025, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4524/5116 (88.4285%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4539/5116 (88.7217%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9237, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4069/4716 (86.2807%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4171/4716 (88.4436%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1422, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3623/4046 (89.5452%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3695/4046 (91.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9854, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3941/4518 (87.2289%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4061/4518 (89.8849%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9506, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4370/5063 (86.3125%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4281/5063 (84.5546%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2100, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5044/5740 (87.8746%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5075/5740 (88.4146%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0192, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4966/5582 (88.9645%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5005/5582 (89.6632%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1500, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3951/4433 (89.1270%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4036/4433 (91.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0424, Accuracy: 5326/10000 (53.2600%)
time spent on training: 270.3860213756561
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.1003, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 8.2900, Accuracy: 155/9900 (1.5657%)
Done in 299.7501771450043 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 42.46427439165039.
Norm before scaling: 42.46872700514462. Distance: 2.090732734766713
Total norm for 4 adversaries is: 42.46872700514462. distance: 2.090732734766713
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1593, Accuracy: 9501/9900 (95.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 42.46427439165039.
Norm before scaling: 42.463979738071096. Distance: 2.1012700100682924
Total norm for 4 adversaries is: 42.463979738071096. distance: 2.1012700100682924
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1400, Accuracy: 9514/9900 (96.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 42.46427439165039.
Norm before scaling: 42.46694055426011. Distance: 2.0514083630082207
Total norm for 4 adversaries is: 42.46694055426011. distance: 2.0514083630082207
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1377, Accuracy: 9548/9900 (96.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 42.46427439165039.
Norm before scaling: 42.470471704431006. Distance: 2.163026968193096
Total norm for 4 adversaries is: 42.470471704431006. distance: 2.163026968193096
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.2576, Accuracy: 9214/9900 (93.0707%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4465/5197 (85.9150%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4447/5197 (85.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1430, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3570/4025 (88.6957%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3667/4025 (91.1056%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9306, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0085, Accuracy: 3842/4481 (85.7398%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3866/4481 (86.2754%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1580, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4062/4651 (87.3361%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4162/4651 (89.4861%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0114, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0076, Accuracy: 5061/5902 (85.7506%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5036/5902 (85.3270%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1008, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3627/4126 (87.9060%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3717/4126 (90.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8921, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3824/4368 (87.5458%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3876/4368 (88.7363%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0767, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0076, Accuracy: 5435/6391 (85.0415%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5547/6391 (86.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1642, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3626/4175 (86.8503%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3689/4175 (88.3593%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8828, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4027/4596 (87.6197%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4172/4596 (90.7746%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0120, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4071/4634 (87.8507%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4149/4634 (89.5339%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9946, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3715/4223 (87.9706%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3844/4223 (91.0253%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0229, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3391/3911 (86.7042%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3237/3911 (82.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1192, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3927/4433 (88.5856%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3991/4433 (90.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9431, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3811/4336 (87.8921%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3928/4336 (90.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1669, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3123/3638 (85.8439%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3277/3638 (90.0770%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9483, Accuracy: 5462/10000 (54.6200%)
time spent on training: 265.5345993041992
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.1001, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 8.2731, Accuracy: 158/9900 (1.5960%)
Done in 295.2086899280548 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 42.46482344798751.
Norm before scaling: 42.47277247092762. Distance: 2.061564724724231
Total norm for 4 adversaries is: 42.47277247092762. distance: 2.061564724724231
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2941, Accuracy: 9202/9900 (92.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 42.46482344798751.
Norm before scaling: 42.469471457264156. Distance: 2.1722778385822576
Total norm for 4 adversaries is: 42.469471457264156. distance: 2.1722778385822576
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1456, Accuracy: 9523/9900 (96.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 42.46482344798751.
Norm before scaling: 42.46624061294895. Distance: 2.005104227377341
Total norm for 4 adversaries is: 42.46624061294895. distance: 2.005104227377341
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1076, Accuracy: 9606/9900 (97.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4554/5066 (89.8934%), train_poison_data_count: 400
Global model norm: 42.46482344798751.
Norm before scaling: 42.47057805116384. Distance: 2.1469857044357026
Total norm for 4 adversaries is: 42.47057805116384. distance: 2.1469857044357026
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2942, Accuracy: 9179/9900 (92.7172%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3356/3756 (89.3504%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3445/3756 (91.7199%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9333, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4758/5424 (87.7212%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4875/5424 (89.8783%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2602, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3925/4433 (88.5405%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3991/4433 (90.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9529, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3928/4501 (87.2695%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3972/4501 (88.2471%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1671, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3597/4025 (89.3665%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3677/4025 (91.3540%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9525, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3754/4235 (88.6423%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3767/4235 (88.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1384, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5293/6124 (86.4304%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5267/6124 (86.0059%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1147, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4131/4634 (89.1454%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4133/4634 (89.1886%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0756, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4120/4716 (87.3622%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4178/4716 (88.5920%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2387, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4152/4767 (87.0988%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4161/4767 (87.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1243, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3327/3804 (87.4606%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3441/3804 (90.4574%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0281, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3086/3472 (88.8825%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3183/3472 (91.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1389, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4794/5392 (88.9095%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4783/5392 (88.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0596, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5029/5740 (87.6132%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5124/5740 (89.2683%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1733, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4048/4596 (88.0766%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4173/4596 (90.7963%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0315, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3168/3616 (87.6106%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3268/3616 (90.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9056, Accuracy: 5623/10000 (56.2300%)
time spent on training: 264.235791683197
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.0998, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 8.2581, Accuracy: 159/9900 (1.6061%)
Done in 293.80317878723145 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 42.46533081572617.
Norm before scaling: 42.46718344700853. Distance: 2.0786631181444797
Total norm for 4 adversaries is: 42.46718344700853. distance: 2.0786631181444797
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0715, Accuracy: 9728/9900 (98.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 42.46533081572617.
Norm before scaling: 42.46565708016303. Distance: 2.137889813130784
Total norm for 4 adversaries is: 42.46565708016303. distance: 2.137889813130784
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0632, Accuracy: 9733/9900 (98.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 42.46533081572617.
Norm before scaling: 42.46803284208679. Distance: 2.0285148398759434
Total norm for 4 adversaries is: 42.46803284208679. distance: 2.0285148398759434
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0613, Accuracy: 9749/9900 (98.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4548/5066 (89.7750%), train_poison_data_count: 400
Global model norm: 42.46533081572617.
Norm before scaling: 42.47159264309057. Distance: 2.1709141423956786
Total norm for 4 adversaries is: 42.47159264309057. distance: 2.1709141423956786
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.2223, Accuracy: 9364/9900 (94.5859%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4387/5063 (86.6482%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4328/5063 (85.4829%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0071, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4173/4804 (86.8651%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4184/4804 (87.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1533, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3980/4558 (87.3190%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3978/4558 (87.2751%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2130, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3363/3756 (89.5367%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3485/3756 (92.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9193, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4818/5424 (88.8274%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4940/5424 (91.0767%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1327, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3913/4511 (86.7435%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4028/4511 (89.2928%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0063, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4566/5167 (88.3685%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4658/5167 (90.1490%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1797, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3896/4356 (89.4399%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4032/4356 (92.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9862, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4413/5244 (84.1533%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4463/5244 (85.1068%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1891, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4189/4793 (87.3983%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4277/4793 (89.2343%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0512, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3366/3828 (87.9310%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3505/3828 (91.5622%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8896, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3645/4046 (90.0890%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3711/4046 (91.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0909, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3537/4013 (88.1385%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3659/4013 (91.1787%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9260, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2856/3271 (87.3127%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0071, Accuracy: 2835/3271 (86.6707%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0122, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3936/4362 (90.2338%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3894/4362 (89.2710%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0042, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3870/4346 (89.0474%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4030/4346 (92.7289%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8239, Accuracy: 5721/10000 (57.2100%)
time spent on training: 264.329354763031
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.0996, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 8.2405, Accuracy: 162/9900 (1.6364%)
Done in 293.778201341629 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 42.46572175783737.
Norm before scaling: 42.470082243176634. Distance: 2.0497579292100263
Total norm for 4 adversaries is: 42.470082243176634. distance: 2.0497579292100263
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1315, Accuracy: 9597/9900 (96.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 42.46572175783737.
Norm before scaling: 42.46234545158804. Distance: 2.090039851890153
Total norm for 4 adversaries is: 42.46234545158804. distance: 2.090039851890153
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.2358, Accuracy: 9316/9900 (94.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 42.46572175783737.
Norm before scaling: 42.46860340758364. Distance: 2.033177209811728
Total norm for 4 adversaries is: 42.46860340758364. distance: 2.033177209811728
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0973, Accuracy: 9636/9900 (97.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.46572175783737.
Norm before scaling: 42.47382006159794. Distance: 2.1858181618869206
Total norm for 4 adversaries is: 42.47382006159794. distance: 2.1858181618869206
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.4686, Accuracy: 8776/9900 (88.6465%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3627/4126 (87.9060%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3741/4126 (90.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9616, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4842/5455 (88.7626%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4831/5455 (88.5610%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0395, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4019/4558 (88.1746%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3972/4558 (87.1435%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1355, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3768/4235 (88.9728%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3822/4235 (90.2479%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0221, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3317/3804 (87.1977%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3437/3804 (90.3523%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9306, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0078, Accuracy: 5407/6391 (84.6033%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5446/6391 (85.2136%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.3053, Accuracy: 4850/10000 (48.5000%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3810/4336 (87.8690%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3886/4336 (89.6218%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1202, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4095/4663 (87.8190%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4296/4663 (92.1295%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0366, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3931/4511 (87.1425%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4044/4511 (89.6475%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0142, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3963/4503 (88.0080%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4017/4503 (89.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1736, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4355/5063 (86.0162%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4280/5063 (84.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1560, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3859/4315 (89.4322%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3970/4315 (92.0046%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9675, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3138/3638 (86.2562%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3311/3638 (91.0115%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8717, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3996/4441 (89.9797%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4068/4441 (91.6010%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0020, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4186/4679 (89.4636%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4179/4679 (89.3140%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0900, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4539/5265 (86.2108%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4598/5265 (87.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1042, Accuracy: 5293/10000 (52.9300%)
time spent on training: 267.32385301589966
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.0995, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 8.2250, Accuracy: 166/9900 (1.6768%)
Done in 296.8539764881134 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 42.46619030871427.
Norm before scaling: 42.47050906952965. Distance: 2.104321452072169
Total norm for 4 adversaries is: 42.47050906952965. distance: 2.104321452072169
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1538, Accuracy: 9547/9900 (96.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 42.46619030871427.
Norm before scaling: 42.464671092752205. Distance: 2.092042141024941
Total norm for 4 adversaries is: 42.464671092752205. distance: 2.092042141024941
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1197, Accuracy: 9581/9900 (96.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4228/4717 (89.6332%), train_poison_data_count: 370
Global model norm: 42.46619030871427.
Norm before scaling: 42.469607986642195. Distance: 1.9805538001222873
Total norm for 4 adversaries is: 42.469607986642195. distance: 1.9805538001222873
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.3254, Accuracy: 9097/9900 (91.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4495/5066 (88.7288%), train_poison_data_count: 400
Global model norm: 42.46619030871427.
Norm before scaling: 42.47270205581316. Distance: 2.2045538847600317
Total norm for 4 adversaries is: 42.47270205581316. distance: 2.2045538847600317
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0954, Accuracy: 9652/9900 (97.4949%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3852/4336 (88.8376%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3895/4336 (89.8293%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2686, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3348/3828 (87.4608%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3447/3828 (90.0470%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0130, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3209/3672 (87.3911%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3231/3672 (87.9902%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0426, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4091/4651 (87.9596%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4167/4651 (89.5936%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9450, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3809/4361 (87.3424%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3800/4361 (87.1360%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1112, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4455/5025 (88.6567%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4518/5025 (89.9104%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0929, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5300/6124 (86.5447%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5410/6124 (88.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0505, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3234/3704 (87.3110%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3363/3704 (90.7937%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8704, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4284/4934 (86.8261%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4013/4934 (81.3336%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2143, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4445/5017 (88.5988%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4494/5017 (89.5754%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8844, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4979/5582 (89.1974%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5052/5582 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9251, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4536/5167 (87.7879%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4597/5167 (88.9685%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2464, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3417/3861 (88.5004%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3453/3861 (89.4328%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0455, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3138/3646 (86.0669%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3257/3646 (89.3308%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8665, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3977/4558 (87.2532%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3981/4558 (87.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1460, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4478/5116 (87.5293%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4515/5116 (88.2525%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9501, Accuracy: 5479/10000 (54.7900%)
time spent on training: 264.76967668533325
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.0993, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 8.2077, Accuracy: 168/9900 (1.6970%)
Done in 294.19256114959717 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4385/4885 (89.7646%), train_poison_data_count: 385
Global model norm: 42.46666172891904.
Norm before scaling: 42.47234997848968. Distance: 2.1561671807790104
Total norm for 4 adversaries is: 42.47234997848968. distance: 2.1561671807790104
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0207, Accuracy: 9835/9900 (99.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.46666172891904.
Norm before scaling: 42.4680371536936. Distance: 2.1162006851461967
Total norm for 4 adversaries is: 42.4680371536936. distance: 2.1162006851461967
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1383, Accuracy: 9546/9900 (96.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4273/4717 (90.5872%), train_poison_data_count: 370
Global model norm: 42.46666172891904.
Norm before scaling: 42.46734154213388. Distance: 2.0244851953252976
Total norm for 4 adversaries is: 42.46734154213388. distance: 2.0244851953252976
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1106, Accuracy: 9597/9900 (96.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 42.46666172891904.
Norm before scaling: 42.475083171545265. Distance: 2.1940007210506898
Total norm for 4 adversaries is: 42.475083171545265. distance: 2.1940007210506898
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2000, Accuracy: 9401/9900 (94.9596%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3907/4511 (86.6105%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4075/4511 (90.3347%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0866, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3880/4346 (89.2775%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4007/4346 (92.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8649, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4164/4804 (86.6778%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3900/4804 (81.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3671, Accuracy: 4798/10000 (47.9800%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4547/5232 (86.9075%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4578/5232 (87.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0752, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4094/4618 (88.6531%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4105/4618 (88.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1386, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3204/3590 (89.2479%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3191/3590 (88.8858%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0171, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5509/6391 (86.1993%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5463/6391 (85.4796%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1332, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3782/4354 (86.8627%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0112, Accuracy: 3462/4354 (79.5131%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3885, Accuracy: 4697/10000 (46.9700%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4451/5055 (88.0514%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4570/5055 (90.4055%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0811, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3445/3837 (89.7837%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3515/3837 (91.6080%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9667, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3933/4503 (87.3418%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4019/4503 (89.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9951, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4122/4576 (90.0787%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4178/4576 (91.3024%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1362, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4142/4793 (86.4177%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4287/4793 (89.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9924, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4112/4634 (88.7354%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4123/4634 (88.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9934, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3571/4158 (85.8826%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3608/4158 (86.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1158, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5018/5740 (87.4216%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5158/5740 (89.8606%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2768, Accuracy: 5064/10000 (50.6400%)
time spent on training: 268.71220684051514
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.0992, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 8.1970, Accuracy: 168/9900 (1.6970%)
Done in 298.53408646583557 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 42.46713745558882.
Norm before scaling: 42.47158689476266. Distance: 2.0739729856021087
Total norm for 4 adversaries is: 42.47158689476266. distance: 2.0739729856021087
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1367, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 42.46713745558882.
Norm before scaling: 42.46907336383515. Distance: 2.122842366494078
Total norm for 4 adversaries is: 42.46907336383515. distance: 2.122842366494078
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2271, Accuracy: 9340/9900 (94.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4246/4717 (90.0148%), train_poison_data_count: 370
Global model norm: 42.46713745558882.
Norm before scaling: 42.468689638478075. Distance: 2.0408535979721116
Total norm for 4 adversaries is: 42.468689638478075. distance: 2.0408535979721116
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2225, Accuracy: 9315/9900 (94.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.46713745558882.
Norm before scaling: 42.47742535793645. Distance: 2.19043774205775
Total norm for 4 adversaries is: 42.47742535793645. distance: 2.19043774205775
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2210, Accuracy: 9323/9900 (94.1717%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3688/4184 (88.1453%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3750/4184 (89.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0491, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5496/6263 (87.7535%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5609/6263 (89.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3283, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3983/4456 (89.3851%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4071/4456 (91.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9480, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4061/4538 (89.4888%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4135/4538 (91.1194%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9430, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3724/4235 (87.9339%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3617/4235 (85.4073%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2093, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3676/4223 (87.0471%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3803/4223 (90.0545%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9015, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4798/5455 (87.9560%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4818/5455 (88.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0576, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4352/5037 (86.4006%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4540/5037 (90.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9893, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3349/3756 (89.1640%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3485/3756 (92.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0341, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4598/5265 (87.3314%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4592/5265 (87.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0176, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4456/5055 (88.1503%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4524/5055 (89.4955%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1732, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4246/4804 (88.3847%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3985/4804 (82.9517%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3400, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4364/5063 (86.1940%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4367/5063 (86.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1171, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3809/4295 (88.6845%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3779/4295 (87.9860%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9426, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2888/3271 (88.2910%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0062, Accuracy: 2865/3271 (87.5879%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0672, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3850/4356 (88.3838%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3955/4356 (90.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1361, Accuracy: 5268/10000 (52.6800%)
time spent on training: 262.8893973827362
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.0990, Accuracy: 7062/10000 (70.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 8.1864, Accuracy: 170/9900 (1.7172%)
Done in 292.1652407646179 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 42.4675829953713.
Norm before scaling: 42.46953756628096. Distance: 2.0695907774299123
Total norm for 4 adversaries is: 42.46953756628096. distance: 2.0695907774299123
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1704, Accuracy: 9458/9900 (95.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 42.4675829953713.
Norm before scaling: 42.471675993757884. Distance: 2.10293761009438
Total norm for 4 adversaries is: 42.471675993757884. distance: 2.10293761009438
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2152, Accuracy: 9349/9900 (94.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4231/4717 (89.6968%), train_poison_data_count: 370
Global model norm: 42.4675829953713.
Norm before scaling: 42.47000176365298. Distance: 2.0098309890898314
Total norm for 4 adversaries is: 42.47000176365298. distance: 2.0098309890898314
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.3646, Accuracy: 9042/9900 (91.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 42.4675829953713.
Norm before scaling: 42.474685130711975. Distance: 2.1329275246927732
Total norm for 4 adversaries is: 42.474685130711975. distance: 2.1329275246927732
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.3361, Accuracy: 9085/9900 (91.7677%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3938/4503 (87.4528%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3943/4503 (87.5638%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1129, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3973/4456 (89.1607%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4042/4456 (90.7092%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1906, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4601/5265 (87.3884%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4631/5265 (87.9582%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0597, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4172/4793 (87.0436%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4321/4793 (90.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0290, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4314/4928 (87.5406%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4426/4928 (89.8133%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9192, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3129/3638 (86.0088%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3238/3638 (89.0049%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0480, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4150/4663 (88.9985%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4263/4663 (91.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0105, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4268/4928 (86.6071%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4312/4928 (87.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2638, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3953/4465 (88.5330%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4060/4465 (90.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9777, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3442/3911 (88.0082%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3383/3911 (86.4996%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1071, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3991/4518 (88.3355%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4091/4518 (90.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1536, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3763/4235 (88.8548%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3886/4235 (91.7591%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1034, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4285/4934 (86.8464%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4023/4934 (81.5363%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2397, Accuracy: 4929/10000 (49.2900%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4077/4647 (87.7340%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4179/4647 (89.9290%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9225, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4105/4651 (88.2606%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4148/4651 (89.1851%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1553, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4357/4989 (87.3321%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4364/4989 (87.4724%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9478, Accuracy: 5528/10000 (55.2800%)
time spent on training: 266.6460392475128
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.0989, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 8.1663, Accuracy: 172/9900 (1.7374%)
Done in 296.43072390556335 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4390/4885 (89.8669%), train_poison_data_count: 385
Global model norm: 42.468025656074474.
Norm before scaling: 42.47338464639135. Distance: 2.1258503951351653
Total norm for 4 adversaries is: 42.47338464639135. distance: 2.1258503951351653
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0615, Accuracy: 9737/9900 (98.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4820/5305 (90.8577%), train_poison_data_count: 415
Global model norm: 42.468025656074474.
Norm before scaling: 42.468248421890884. Distance: 2.087346319149483
Total norm for 4 adversaries is: 42.468248421890884. distance: 2.087346319149483
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1796, Accuracy: 9461/9900 (95.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4246/4717 (90.0148%), train_poison_data_count: 370
Global model norm: 42.468025656074474.
Norm before scaling: 42.46874568846557. Distance: 2.0128125818729607
Total norm for 4 adversaries is: 42.46874568846557. distance: 2.0128125818729607
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1474, Accuracy: 9478/9900 (95.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4487/5066 (88.5709%), train_poison_data_count: 400
Global model norm: 42.468025656074474.
Norm before scaling: 42.47750007586737. Distance: 2.207147267760915
Total norm for 4 adversaries is: 42.47750007586737. distance: 2.207147267760915
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1643, Accuracy: 9459/9900 (95.5455%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4039/4538 (89.0040%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4118/4538 (90.7448%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9461, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3917/4362 (89.7983%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3872/4362 (88.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9843, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 4358/5244 (83.1045%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4516/5244 (86.1175%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9599, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3657/4046 (90.3856%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3648/4046 (90.1631%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1588, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3548/4013 (88.4127%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3663/4013 (91.2783%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9469, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4011/4465 (89.8320%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4098/4465 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9056, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4519/5232 (86.3723%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4527/5232 (86.5252%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0679, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4346/4928 (88.1899%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4407/4928 (89.4278%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9665, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4340/5063 (85.7199%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4477/5063 (88.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9765, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5112/5902 (86.6147%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5095/5902 (86.3267%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2352, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3988/4456 (89.4973%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4033/4456 (90.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9487, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4052/4596 (88.1636%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4174/4596 (90.8181%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0574, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3977/4441 (89.5519%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4031/4441 (90.7678%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1796, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5014/5740 (87.3519%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5137/5740 (89.4948%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1977, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3100/3472 (89.2857%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3082/3472 (88.7673%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0662, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3403/3861 (88.1378%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3426/3861 (88.7335%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0864, Accuracy: 5196/10000 (51.9600%)
time spent on training: 263.4818124771118
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.0986, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 8.1484, Accuracy: 175/9900 (1.7677%)
Done in 292.98369669914246 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 42.468583287016415.
Norm before scaling: 42.473792758465336. Distance: 2.0383973187655027
Total norm for 4 adversaries is: 42.473792758465336. distance: 2.0383973187655027
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2431, Accuracy: 9291/9900 (93.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 42.468583287016415.
Norm before scaling: 42.469248697862994. Distance: 2.0561279353403124
Total norm for 4 adversaries is: 42.469248697862994. distance: 2.0561279353403124
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2462, Accuracy: 9325/9900 (94.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 42.468583287016415.
Norm before scaling: 42.47144031213799. Distance: 2.037900747193989
Total norm for 4 adversaries is: 42.47144031213799. distance: 2.037900747193989
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0940, Accuracy: 9636/9900 (97.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4558/5066 (89.9724%), train_poison_data_count: 400
Global model norm: 42.468583287016415.
Norm before scaling: 42.47278540430331. Distance: 2.1433558065483096
Total norm for 4 adversaries is: 42.47278540430331. distance: 2.1433558065483096
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1368, Accuracy: 9514/9900 (96.1010%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3384/3797 (89.1230%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3431/3797 (90.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9678, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2929/3297 (88.8383%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3037/3297 (92.1140%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8253, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3468/3911 (88.6730%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3401/3911 (86.9599%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1686, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0072, Accuracy: 2812/3271 (85.9676%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0071, Accuracy: 2829/3271 (86.4873%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0514, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3670/4046 (90.7069%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3699/4046 (91.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9919, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5055/5740 (88.0662%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5135/5740 (89.4599%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1427, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3520/3969 (88.6873%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3609/3969 (90.9297%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9658, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3243/3704 (87.5540%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3294/3704 (88.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0290, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4178/4767 (87.6442%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4254/4767 (89.2385%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0241, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4245/4956 (85.6538%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4311/4956 (86.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0871, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3209/3590 (89.3872%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3123/3590 (86.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0569, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5102/5902 (86.4453%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0078, Accuracy: 5020/5902 (85.0559%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0553, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4307/4928 (87.3985%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4447/4928 (90.2394%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9227, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3722/4235 (87.8867%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3824/4235 (90.2952%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1099, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4537/5265 (86.1728%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4569/5265 (86.7806%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0963, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3870/4356 (88.8430%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3541/4356 (81.2902%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.4348, Accuracy: 4778/10000 (47.7800%)
time spent on training: 262.6131739616394
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.0984, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 8.1344, Accuracy: 177/9900 (1.7879%)
Done in 292.02206349372864 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 42.469106418666264.
Norm before scaling: 42.47674857992164. Distance: 2.105959465296095
Total norm for 4 adversaries is: 42.47674857992164. distance: 2.105959465296095
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0861, Accuracy: 9677/9900 (97.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 42.469106418666264.
Norm before scaling: 42.4689152751567. Distance: 2.1158832882601475
Total norm for 4 adversaries is: 42.4689152751567. distance: 2.1158832882601475
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.2300, Accuracy: 9304/9900 (93.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 42.469106418666264.
Norm before scaling: 42.47284432296491. Distance: 2.041632074595013
Total norm for 4 adversaries is: 42.47284432296491. distance: 2.041632074595013
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1453, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 42.469106418666264.
Norm before scaling: 42.47382006159794. Distance: 2.127515201895313
Total norm for 4 adversaries is: 42.47382006159794. distance: 2.127515201895313
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1553, Accuracy: 9506/9900 (96.0202%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3593/4025 (89.2671%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3718/4025 (92.3727%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8403, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5044/5902 (85.4626%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5073/5902 (85.9539%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2344, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4166/4793 (86.9184%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4290/4793 (89.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9294, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4558/5265 (86.5717%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4584/5265 (87.0655%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0188, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3766/4295 (87.6834%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3805/4295 (88.5914%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0359, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3233/3704 (87.2840%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3360/3704 (90.7127%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8659, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4452/5116 (87.0211%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4472/5116 (87.4120%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0646, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4993/5740 (86.9861%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5128/5740 (89.3380%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1322, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3380/3797 (89.0176%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3424/3797 (90.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0000, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4112/4716 (87.1925%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4193/4716 (88.9101%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1595, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3963/4433 (89.3977%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3986/4433 (89.9165%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9654, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3854/4416 (87.2736%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3958/4416 (89.6286%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0322, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3703/4223 (87.6865%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3843/4223 (91.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9888, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4391/5083 (86.3860%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4417/5083 (86.8975%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1196, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4058/4576 (88.6801%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4142/4576 (90.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9671, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4803/5392 (89.0764%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4768/5392 (88.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1156, Accuracy: 5400/10000 (54.0000%)
time spent on training: 265.773512840271
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.0981, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 8.1212, Accuracy: 178/9900 (1.7980%)
Done in 295.13336062431335 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 42.46965541253396.
Norm before scaling: 42.46945421141676. Distance: 2.030644370538778
Total norm for 4 adversaries is: 42.46945421141676. distance: 2.030644370538778
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2394, Accuracy: 9302/9900 (93.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 42.46965541253396.
Norm before scaling: 42.46952319476433. Distance: 2.065314943990648
Total norm for 4 adversaries is: 42.46952319476433. distance: 2.065314943990648
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0807, Accuracy: 9676/9900 (97.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 42.46965541253396.
Norm before scaling: 42.475429478405516. Distance: 2.048826146738499
Total norm for 4 adversaries is: 42.475429478405516. distance: 2.048826146738499
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1089, Accuracy: 9609/9900 (97.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4519/5066 (89.2025%), train_poison_data_count: 400
Global model norm: 42.46965541253396.
Norm before scaling: 42.47393214795841. Distance: 2.175666956750402
Total norm for 4 adversaries is: 42.47393214795841. distance: 2.175666956750402
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2890, Accuracy: 9203/9900 (92.9596%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4573/5265 (86.8566%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4620/5265 (87.7493%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0472, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3874/4356 (88.9348%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3780/4356 (86.7769%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3604, Accuracy: 4810/10000 (48.1000%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3384/3756 (90.0958%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3455/3756 (91.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9066, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3386/3837 (88.2460%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3532/3837 (92.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9849, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5033/5740 (87.6829%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5091/5740 (88.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0381, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3699/4223 (87.5918%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3820/4223 (90.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0039, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3948/4465 (88.4211%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4036/4465 (90.3919%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8873, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4817/5591 (86.1563%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4887/5591 (87.4083%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1769, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5135/5902 (87.0044%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5059/5902 (85.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2296, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4352/4918 (88.4913%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4447/4918 (90.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1143, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3425/3861 (88.7076%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3460/3861 (89.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9822, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3740/4295 (87.0780%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3796/4295 (88.3818%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9850, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3583/4158 (86.1712%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3606/4158 (86.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0996, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5567/6263 (88.8871%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5588/6263 (89.2224%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9296, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3728/4354 (85.6224%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0131, Accuracy: 3302/4354 (75.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.7820, Accuracy: 4097/10000 (40.9700%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3343/3797 (88.0432%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3394/3797 (89.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9711, Accuracy: 5523/10000 (55.2300%)
time spent on training: 266.60415053367615
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.0979, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 8.0987, Accuracy: 179/9900 (1.8081%)
Done in 296.2081620693207 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4425/4885 (90.5834%), train_poison_data_count: 385
Global model norm: 42.4701842794963.
Norm before scaling: 42.47247069104366. Distance: 2.031066886277555
Total norm for 4 adversaries is: 42.47247069104366. distance: 2.031066886277555
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2856, Accuracy: 9217/9900 (93.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.4701842794963.
Norm before scaling: 42.46697792246568. Distance: 2.0721572430570063
Total norm for 4 adversaries is: 42.46697792246568. distance: 2.0721572430570063
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2526, Accuracy: 9288/9900 (93.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 42.4701842794963.
Norm before scaling: 42.47341626084706. Distance: 1.9767282891384441
Total norm for 4 adversaries is: 42.47341626084706. distance: 1.9767282891384441
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2586, Accuracy: 9262/9900 (93.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4501/5066 (88.8472%), train_poison_data_count: 400
Global model norm: 42.4701842794963.
Norm before scaling: 42.47813660983436. Distance: 2.2090535578868495
Total norm for 4 adversaries is: 42.47813660983436. distance: 2.2090535578868495
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2494, Accuracy: 9256/9900 (93.4949%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3351/3797 (88.2539%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3407/3797 (89.7287%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0597, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4391/5037 (87.1749%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4507/5037 (89.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9317, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4300/4934 (87.1504%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4221/4934 (85.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0513, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4853/5455 (88.9643%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4819/5455 (88.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0334, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5095/5902 (86.3267%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5022/5902 (85.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3021, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5454/6391 (85.3388%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5603/6391 (87.6702%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1793, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3441/3911 (87.9826%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3332/3911 (85.1956%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0849, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4558/5195 (87.7382%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4595/5195 (88.4504%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0397, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3757/4235 (88.7131%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3804/4235 (89.8229%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9777, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4469/5116 (87.3534%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4538/5116 (88.7021%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2004, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4039/4538 (89.0040%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4167/4538 (91.8246%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8933, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4986/5582 (89.3228%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4985/5582 (89.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3485, Accuracy: 4713/10000 (47.1300%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3966/4558 (87.0118%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4048/4558 (88.8109%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0870, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3583/4046 (88.5566%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3656/4046 (90.3609%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9863, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3380/3828 (88.2968%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3424/3828 (89.4462%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9398, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4467/5055 (88.3680%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4534/5055 (89.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1448, Accuracy: 5180/10000 (51.8000%)
time spent on training: 267.7744994163513
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.0977, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 8.0860, Accuracy: 180/9900 (1.8182%)
Done in 297.2985272407532 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 42.470675774953826.
Norm before scaling: 42.477475648865955. Distance: 2.0400137016359836
Total norm for 4 adversaries is: 42.477475648865955. distance: 2.0400137016359836
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1294, Accuracy: 9586/9900 (96.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4807/5305 (90.6126%), train_poison_data_count: 415
Global model norm: 42.470675774953826.
Norm before scaling: 42.47025469878521. Distance: 2.0903185153623127
Total norm for 4 adversaries is: 42.47025469878521. distance: 2.0903185153623127
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1710, Accuracy: 9472/9900 (95.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 42.470675774953826.
Norm before scaling: 42.472308303837806. Distance: 1.992773291537257
Total norm for 4 adversaries is: 42.472308303837806. distance: 1.992773291537257
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1500, Accuracy: 9508/9900 (96.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4503/5066 (88.8867%), train_poison_data_count: 400
Global model norm: 42.470675774953826.
Norm before scaling: 42.4768937073256. Distance: 2.1586293899957147
Total norm for 4 adversaries is: 42.4768937073256. distance: 2.1586293899957147
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2463, Accuracy: 9257/9900 (93.5051%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4984/5582 (89.2870%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5107/5582 (91.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1260, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3914/4501 (86.9585%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3985/4501 (88.5359%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9781, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3419/3911 (87.4201%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3238/3911 (82.7921%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.4578, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4179/4663 (89.6204%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4257/4663 (91.2932%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9928, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4589/5265 (87.1605%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4684/5265 (88.9649%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0493, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3847/4416 (87.1150%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3912/4416 (88.5870%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0498, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3952/4433 (89.1496%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4041/4433 (91.1572%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9035, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5530/6263 (88.2963%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5556/6263 (88.7115%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1987, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4830/5455 (88.5426%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4837/5455 (88.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0701, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4092/4634 (88.3038%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4150/4634 (89.5555%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0120, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4119/4707 (87.5080%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4214/4707 (89.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9715, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3653/4126 (88.5361%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3744/4126 (90.7416%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9481, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4492/5116 (87.8030%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4518/5116 (88.3112%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0770, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4395/5063 (86.8062%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4323/5063 (85.3842%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3222, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3833/4361 (87.8927%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3832/4361 (87.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2249, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0076, Accuracy: 5226/6124 (85.3364%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5403/6124 (88.2266%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8600, Accuracy: 5503/10000 (55.0300%)
time spent on training: 266.4009563922882
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.0976, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 8.0699, Accuracy: 184/9900 (1.8586%)
Done in 295.70518589019775 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 42.471250616225674.
Norm before scaling: 42.476048800231965. Distance: 2.0676619927300544
Total norm for 4 adversaries is: 42.476048800231965. distance: 2.0676619927300544
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1286, Accuracy: 9569/9900 (96.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4803/5305 (90.5372%), train_poison_data_count: 415
Global model norm: 42.471250616225674.
Norm before scaling: 42.46806302332524. Distance: 2.0891813850670538
Total norm for 4 adversaries is: 42.46806302332524. distance: 2.0891813850670538
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1620, Accuracy: 9495/9900 (95.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4250/4717 (90.0996%), train_poison_data_count: 370
Global model norm: 42.471250616225674.
Norm before scaling: 42.4719317930604. Distance: 2.019421690693588
Total norm for 4 adversaries is: 42.4719317930604. distance: 2.019421690693588
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.4827, Accuracy: 8719/9900 (88.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 42.471250616225674.
Norm before scaling: 42.47969988528344. Distance: 2.186270777154847
Total norm for 4 adversaries is: 42.47969988528344. distance: 2.186270777154847
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.2445, Accuracy: 9289/9900 (93.8283%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3882/4356 (89.1185%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3837/4356 (88.0854%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2710, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3924/4362 (89.9587%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3813/4362 (87.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1189, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4130/4679 (88.2667%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4193/4679 (89.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1496, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3587/4158 (86.2674%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3637/4158 (87.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2922, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4085/4651 (87.8306%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4165/4651 (89.5506%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1291, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3674/4175 (88.0000%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3728/4175 (89.2934%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9400, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4100/4618 (88.7830%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4179/4618 (90.4937%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9711, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3998/4625 (86.4432%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4054/4625 (87.6541%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1309, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4948/5582 (88.6421%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4965/5582 (88.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1937, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4269/4874 (87.5872%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4209/4874 (86.3562%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2568, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4290/4934 (86.9477%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4072/4934 (82.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2474, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4786/5424 (88.2375%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4879/5424 (89.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3929, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4215/4804 (87.7394%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4093/4804 (85.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3083, Accuracy: 4949/10000 (49.4900%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4373/4918 (88.9183%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4434/4918 (90.1586%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1492, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3392/3861 (87.8529%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3428/3861 (88.7853%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8878, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3752/4223 (88.8468%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3831/4223 (90.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8432, Accuracy: 5630/10000 (56.3000%)
time spent on training: 266.5672788619995
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.0974, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 8.0535, Accuracy: 186/9900 (1.8788%)
Done in 296.1257367134094 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 42.471650126326914.
Norm before scaling: 42.47570393536389. Distance: 2.025808822732537
Total norm for 4 adversaries is: 42.47570393536389. distance: 2.025808822732537
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1087, Accuracy: 9616/9900 (97.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4807/5305 (90.6126%), train_poison_data_count: 415
Global model norm: 42.471650126326914.
Norm before scaling: 42.46916534243182. Distance: 2.0755945158307605
Total norm for 4 adversaries is: 42.46916534243182. distance: 2.0755945158307605
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1100, Accuracy: 9611/9900 (97.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 42.471650126326914.
Norm before scaling: 42.4736706126572. Distance: 2.022048296569513
Total norm for 4 adversaries is: 42.4736706126572. distance: 2.022048296569513
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1214, Accuracy: 9577/9900 (96.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4484/5066 (88.5116%), train_poison_data_count: 400
Global model norm: 42.471650126326914.
Norm before scaling: 42.48041971979929. Distance: 2.202023711129706
Total norm for 4 adversaries is: 42.48041971979929. distance: 2.202023711129706
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.2922, Accuracy: 9178/9900 (92.7071%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4021/4647 (86.5289%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4150/4647 (89.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9749, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3333/3804 (87.6183%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3438/3804 (90.3785%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1244, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4874/5591 (87.1758%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4892/5591 (87.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3925, Accuracy: 4691/10000 (46.9100%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4101/4634 (88.4981%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4176/4634 (90.1165%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9684, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3961/4433 (89.3526%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4079/4433 (92.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9344, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3264/3704 (88.1210%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3336/3704 (90.0648%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8776, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3413/3837 (88.9497%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3533/3837 (92.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9161, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4841/5455 (88.7443%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4898/5455 (89.7892%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.4326, Accuracy: 4895/10000 (48.9500%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5030/5740 (87.6307%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5101/5740 (88.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2597, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4394/4986 (88.1268%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4471/4986 (89.6711%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9616, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4009/4456 (89.9686%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4024/4456 (90.3052%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1209, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3856/4356 (88.5216%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3803/4356 (87.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1554, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3176/3590 (88.4680%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3204/3590 (89.2479%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2063, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3965/4503 (88.0524%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3984/4503 (88.4744%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1486, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4379/5037 (86.9367%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4477/5037 (88.8823%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9721, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4533/5167 (87.7298%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4630/5167 (89.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2599, Accuracy: 5135/10000 (51.3500%)
time spent on training: 267.2887899875641
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.0972, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 8.0360, Accuracy: 188/9900 (1.8990%)
Done in 297.07047843933105 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 42.47216603489058.
Norm before scaling: 42.475824638386214. Distance: 2.0614518478880095
Total norm for 4 adversaries is: 42.475824638386214. distance: 2.0614518478880095
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1853, Accuracy: 9436/9900 (95.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 42.47216603489058.
Norm before scaling: 42.47112990020398. Distance: 2.1349986962129064
Total norm for 4 adversaries is: 42.47112990020398. distance: 2.1349986962129064
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2574, Accuracy: 9238/9900 (93.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 42.47216603489058.
Norm before scaling: 42.47233704498141. Distance: 2.0358762437647178
Total norm for 4 adversaries is: 42.47233704498141. distance: 2.0358762437647178
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0806, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 42.47216603489058.
Norm before scaling: 42.480362248429714. Distance: 2.206887677679431
Total norm for 4 adversaries is: 42.480362248429714. distance: 2.206887677679431
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1718, Accuracy: 9466/9900 (95.6162%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3155/3638 (86.7235%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3258/3638 (89.5547%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9507, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4133/4716 (87.6378%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4179/4716 (88.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0927, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4259/4956 (85.9362%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4329/4956 (87.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1027, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4765/5392 (88.3717%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4706/5392 (87.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3131, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3670/4184 (87.7151%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3774/4184 (90.2008%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8484, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3819/4481 (85.2265%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3801/4481 (84.8248%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1695, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3186/3646 (87.3834%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3310/3646 (90.7844%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9413, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4434/5025 (88.2388%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4463/5025 (88.8159%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2337, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3189/3590 (88.8301%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3189/3590 (88.8301%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0531, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4046/4596 (88.0331%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4217/4596 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9767, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3851/4336 (88.8146%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3907/4336 (90.1061%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1375, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4280/4874 (87.8129%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4109/4874 (84.3045%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2437, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4555/5167 (88.1556%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4603/5167 (89.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1054, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4099/4618 (88.7614%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4178/4618 (90.4721%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1829, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4301/4928 (87.2768%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4332/4928 (87.9058%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1160, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4035/4647 (86.8302%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4118/4647 (88.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0746, Accuracy: 5304/10000 (53.0400%)
time spent on training: 253.0846071243286
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.0971, Accuracy: 7068/10000 (70.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 8.0196, Accuracy: 190/9900 (1.9192%)
Done in 277.8845729827881 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 42.472673314916555.
Norm before scaling: 42.47888377071895. Distance: 2.0386417583310306
Total norm for 4 adversaries is: 42.47888377071895. distance: 2.0386417583310306
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.3860, Accuracy: 8955/9900 (90.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 42.472673314916555.
Norm before scaling: 42.473725219061905. Distance: 2.125548123744786
Total norm for 4 adversaries is: 42.473725219061905. distance: 2.125548123744786
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.3370, Accuracy: 9092/9900 (91.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.472673314916555.
Norm before scaling: 42.47778457755521. Distance: 2.0336354260565144
Total norm for 4 adversaries is: 42.47778457755521. distance: 2.0336354260565144
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2392, Accuracy: 9288/9900 (93.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4546/5066 (89.7355%), train_poison_data_count: 400
Global model norm: 42.472673314916555.
Norm before scaling: 42.481037532111756. Distance: 2.162507968954056
Total norm for 4 adversaries is: 42.481037532111756. distance: 2.162507968954056
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2803, Accuracy: 9194/9900 (92.8687%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3830/4368 (87.6832%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3857/4368 (88.3013%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0329, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4547/5195 (87.5265%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4370/5195 (84.1193%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3464, Accuracy: 4841/10000 (48.4100%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3838/4315 (88.9455%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3899/4315 (90.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1720, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3152/3646 (86.4509%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3277/3646 (89.8793%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8689, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3189/3590 (88.8301%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3157/3590 (87.9387%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0273, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3641/4126 (88.2453%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3785/4126 (91.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8568, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3787/4361 (86.8379%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3861/4361 (88.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0938, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3353/3837 (87.3860%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3511/3837 (91.5038%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9876, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3782/4235 (89.3034%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3773/4235 (89.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1152, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5112/5902 (86.6147%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5117/5902 (86.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1976, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3952/4433 (89.1496%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3984/4433 (89.8714%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9823, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3166/3638 (87.0258%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3259/3638 (89.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9742, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4493/5232 (85.8754%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4570/5232 (87.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0262, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3781/4336 (87.2002%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3894/4336 (89.8063%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1115, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4262/4989 (85.4279%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4456/4989 (89.3165%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9870, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3887/4481 (86.7440%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3820/4481 (85.2488%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1391, Accuracy: 5231/10000 (52.3100%)
time spent on training: 232.9445013999939
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.0969, Accuracy: 7068/10000 (70.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 8.0034, Accuracy: 191/9900 (1.9293%)
Done in 262.7909326553345 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 42.473193522135226.
Norm before scaling: 42.47509897814395. Distance: 2.017143328217776
Total norm for 4 adversaries is: 42.47509897814395. distance: 2.017143328217776
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.2622, Accuracy: 9228/9900 (93.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4820/5305 (90.8577%), train_poison_data_count: 415
Global model norm: 42.473193522135226.
Norm before scaling: 42.472943478576745. Distance: 2.035271639490634
Total norm for 4 adversaries is: 42.472943478576745. distance: 2.035271639490634
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1251, Accuracy: 9581/9900 (96.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4222/4717 (89.5060%), train_poison_data_count: 370
Global model norm: 42.473193522135226.
Norm before scaling: 42.4752872199125. Distance: 2.0256156833131933
Total norm for 4 adversaries is: 42.4752872199125. distance: 2.0256156833131933
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0900, Accuracy: 9660/9900 (97.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4515/5066 (89.1236%), train_poison_data_count: 400
Global model norm: 42.473193522135226.
Norm before scaling: 42.48192687871073. Distance: 2.174980632651907
Total norm for 4 adversaries is: 42.48192687871073. distance: 2.174980632651907
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.2752, Accuracy: 9211/9900 (93.0404%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4474/5116 (87.4511%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4535/5116 (88.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0231, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3905/4362 (89.5232%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3907/4362 (89.5690%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2048, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3990/4441 (89.8446%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4065/4441 (91.5334%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1462, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4179/4663 (89.6204%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4238/4663 (90.8857%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0845, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4434/5083 (87.2319%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4475/5083 (88.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3199, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4074/4767 (85.4626%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4148/4767 (87.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1468, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3381/3797 (89.0440%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3399/3797 (89.5180%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9957, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4516/5195 (86.9297%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4537/5195 (87.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0768, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4098/4618 (88.7397%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4107/4618 (88.9346%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1530, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3993/4433 (90.0744%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3991/4433 (90.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9543, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4462/5055 (88.2690%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4461/5055 (88.2493%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9329, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3556/4158 (85.5219%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3657/4158 (87.9509%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9817, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3321/3781 (87.8339%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3250/3781 (85.9561%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3328, Accuracy: 4884/10000 (48.8400%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3638/4175 (87.1377%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3659/4175 (87.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9800, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4551/5265 (86.4387%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4523/5265 (85.9069%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0695, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3410/3837 (88.8715%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3515/3837 (91.6080%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9762, Accuracy: 5511/10000 (55.1100%)
time spent on training: 263.9030578136444
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.0968, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 7.9880, Accuracy: 194/9900 (1.9596%)
Done in 293.55184030532837 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 42.47366486461052.
Norm before scaling: 42.475804521239645. Distance: 2.0651880722670826
Total norm for 4 adversaries is: 42.475804521239645. distance: 2.0651880722670826
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1365, Accuracy: 9554/9900 (96.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4804/5305 (90.5561%), train_poison_data_count: 415
Global model norm: 42.47366486461052.
Norm before scaling: 42.47321507754549. Distance: 2.0967935105704756
Total norm for 4 adversaries is: 42.47321507754549. distance: 2.0967935105704756
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1664, Accuracy: 9492/9900 (95.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.47366486461052.
Norm before scaling: 42.475147834866334. Distance: 2.0120339748479354
Total norm for 4 adversaries is: 42.475147834866334. distance: 2.0120339748479354
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.3724, Accuracy: 8937/9900 (90.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4518/5066 (89.1828%), train_poison_data_count: 400
Global model norm: 42.47366486461052.
Norm before scaling: 42.48326732879296. Distance: 2.194698370018935
Total norm for 4 adversaries is: 42.48326732879296. distance: 2.194698370018935
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0638, Accuracy: 9734/9900 (98.3232%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3440/3911 (87.9570%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3310/3911 (84.6331%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.4288, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4564/5195 (87.8537%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4527/5195 (87.1415%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2179, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3416/3775 (90.4901%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3530/3775 (93.5099%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8871, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4139/4679 (88.4591%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4150/4679 (88.6942%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1106, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3846/4361 (88.1908%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3814/4361 (87.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1469, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3201/3672 (87.1732%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3246/3672 (88.3987%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1079, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3907/4481 (87.1904%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3885/4481 (86.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1301, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3649/4126 (88.4392%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3746/4126 (90.7901%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9566, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3558/3969 (89.6447%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3586/3969 (90.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1312, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4525/5116 (88.4480%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4508/5116 (88.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0414, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4371/5063 (86.3322%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4305/5063 (85.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2026, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2910/3297 (88.2621%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3014/3297 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8303, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4303/5037 (85.4278%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4485/5037 (89.0411%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1118, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4111/4596 (89.4473%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4208/4596 (91.5579%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1258, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3910/4501 (86.8696%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3932/4501 (87.3584%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0463, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3991/4465 (89.3841%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4080/4465 (91.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9410, Accuracy: 5574/10000 (55.7400%)
time spent on training: 263.5789580345154
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.0967, Accuracy: 7068/10000 (70.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 7.9731, Accuracy: 199/9900 (2.0101%)
Done in 292.68642115592957 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4416/4885 (90.3992%), train_poison_data_count: 385
Global model norm: 42.474097402950335.
Norm before scaling: 42.48021282250493. Distance: 2.0705008942879184
Total norm for 4 adversaries is: 42.48021282250493. distance: 2.0705008942879184
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1950, Accuracy: 9396/9900 (94.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 42.474097402950335.
Norm before scaling: 42.473242381049445. Distance: 2.0994758315088657
Total norm for 4 adversaries is: 42.473242381049445. distance: 2.0994758315088657
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1139, Accuracy: 9606/9900 (97.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 42.474097402950335.
Norm before scaling: 42.47929757724638. Distance: 2.0122515222915958
Total norm for 4 adversaries is: 42.47929757724638. distance: 2.0122515222915958
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.2621, Accuracy: 9257/9900 (93.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4525/5066 (89.3210%), train_poison_data_count: 400
Global model norm: 42.474097402950335.
Norm before scaling: 42.48257771345434. Distance: 2.178221506966324
Total norm for 4 adversaries is: 42.48257771345434. distance: 2.178221506966324
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1762, Accuracy: 9427/9900 (95.2222%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3788/4361 (86.8608%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3868/4361 (88.6953%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0942, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3881/4346 (89.3005%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4003/4346 (92.1077%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7912, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4851/5455 (88.9276%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4899/5455 (89.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1184, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3966/4465 (88.8242%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4118/4465 (92.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9250, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3831/4336 (88.3533%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3889/4336 (89.6910%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3855, Accuracy: 5009/10000 (50.0900%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4006/4441 (90.2049%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4104/4441 (92.4116%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0784, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3878/4362 (88.9042%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3887/4362 (89.1105%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1537, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3508/3969 (88.3850%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3582/3969 (90.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0112, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3738/4295 (87.0314%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3796/4295 (88.3818%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9984, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4432/5017 (88.3396%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4536/5017 (90.4126%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8401, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4353/5063 (85.9767%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4281/5063 (84.5546%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3305, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2880/3271 (88.0465%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0076, Accuracy: 2826/3271 (86.3956%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1781, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5612/6263 (89.6056%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5655/6263 (90.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1185, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4255/4874 (87.3000%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4219/4874 (86.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2626, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3465/3911 (88.5963%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3209/3911 (82.0506%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2665, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4196/4804 (87.3439%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4054/4804 (84.3880%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3254, Accuracy: 4880/10000 (48.8000%)
time spent on training: 266.85941886901855
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.0965, Accuracy: 7070/10000 (70.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 7.9564, Accuracy: 205/9900 (2.0707%)
Done in 296.62880992889404 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 42.474502634209124.
Norm before scaling: 42.47910935324931. Distance: 2.0368804364104056
Total norm for 4 adversaries is: 42.47910935324931. distance: 2.0368804364104056
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0804, Accuracy: 9696/9900 (97.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 42.474502634209124.
Norm before scaling: 42.47359588798963. Distance: 2.0944355084436332
Total norm for 4 adversaries is: 42.47359588798963. distance: 2.0944355084436332
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.2299, Accuracy: 9334/9900 (94.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4203/4717 (89.1032%), train_poison_data_count: 370
Global model norm: 42.474502634209124.
Norm before scaling: 42.47909211131474. Distance: 2.0389970206201027
Total norm for 4 adversaries is: 42.47909211131474. distance: 2.0389970206201027
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1997, Accuracy: 9377/9900 (94.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 42.474502634209124.
Norm before scaling: 42.48434626700021. Distance: 2.222222203678555
Total norm for 4 adversaries is: 42.48434626700021. distance: 2.222222203678555
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0686, Accuracy: 9713/9900 (98.1111%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5085/5902 (86.1572%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4982/5902 (84.4121%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1073, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4390/4918 (89.2639%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4466/4918 (90.8093%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1050, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3572/4025 (88.7453%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3690/4025 (91.6770%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0206, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3092/3472 (89.0553%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3098/3472 (89.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1667, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4170/4793 (87.0019%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4307/4793 (89.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1846, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4271/4934 (86.5626%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4312/4934 (87.3936%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0749, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3459/3911 (88.4429%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3500/3911 (89.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9406, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4819/5392 (89.3731%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4749/5392 (88.0749%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1139, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3185/3638 (87.5481%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3297/3638 (90.6267%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9829, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5297/6124 (86.4958%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5292/6124 (86.4141%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9459, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3644/4175 (87.2814%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3668/4175 (87.8563%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0928, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4029/4625 (87.1135%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4006/4625 (86.6162%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1646, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3805/4354 (87.3909%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3609/4354 (82.8893%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.5023, Accuracy: 4800/10000 (48.0000%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3918/4511 (86.8544%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4016/4511 (89.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0054, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3263/3704 (88.0940%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3325/3704 (89.7678%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9298, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3418/3861 (88.5263%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3439/3861 (89.0702%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9241, Accuracy: 5540/10000 (55.4000%)
time spent on training: 263.7648355960846
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.0964, Accuracy: 7069/10000 (70.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 7.9358, Accuracy: 210/9900 (2.1212%)
Done in 293.1736755371094 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 42.47503000385197.
Norm before scaling: 42.4774684644511. Distance: 2.038961356859027
Total norm for 4 adversaries is: 42.4774684644511. distance: 2.038961356859027
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0593, Accuracy: 9756/9900 (98.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 42.47503000385197.
Norm before scaling: 42.473071374603784. Distance: 2.0465989254272707
Total norm for 4 adversaries is: 42.473071374603784. distance: 2.0465989254272707
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0651, Accuracy: 9727/9900 (98.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 42.47503000385197.
Norm before scaling: 42.477740034487475. Distance: 2.0215301361064406
Total norm for 4 adversaries is: 42.477740034487475. distance: 2.0215301361064406
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1749, Accuracy: 9441/9900 (95.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4546/5066 (89.7355%), train_poison_data_count: 400
Global model norm: 42.47503000385197.
Norm before scaling: 42.48037374270985. Distance: 2.133930178936377
Total norm for 4 adversaries is: 42.48037374270985. distance: 2.133930178936377
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1865, Accuracy: 9452/9900 (95.4747%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4437/5083 (87.2910%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4400/5083 (86.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0692, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3195/3646 (87.6303%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3269/3646 (89.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9684, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3994/4503 (88.6964%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4001/4503 (88.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0137, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3932/4501 (87.3584%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4009/4501 (89.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9304, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3572/4013 (89.0107%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3658/4013 (91.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8561, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3947/4362 (90.4860%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3871/4362 (88.7437%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2162, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3886/4315 (90.0579%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3961/4315 (91.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9506, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4085/4651 (87.8306%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4139/4651 (88.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1035, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3860/4416 (87.4094%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3959/4416 (89.6513%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0349, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3209/3704 (86.6361%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3324/3704 (89.7408%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8443, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4128/4707 (87.6992%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4218/4707 (89.6112%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8804, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4067/4662 (87.2372%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4217/4662 (90.4547%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9661, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4770/5424 (87.9425%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4906/5424 (90.4499%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2593, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3812/4336 (87.9151%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3922/4336 (90.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0819, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3887/4481 (86.7440%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3847/4481 (85.8514%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1354, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3370/3828 (88.0355%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3429/3828 (89.5768%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9770, Accuracy: 5515/10000 (55.1500%)
time spent on training: 264.02237701416016
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.0962, Accuracy: 7069/10000 (70.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 7.9214, Accuracy: 210/9900 (2.1212%)
Done in 293.3616008758545 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 42.475524317136156.
Norm before scaling: 42.47545678048604. Distance: 2.0620203327393782
Total norm for 4 adversaries is: 42.47545678048604. distance: 2.0620203327393782
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0835, Accuracy: 9670/9900 (97.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 42.475524317136156.
Norm before scaling: 42.47602293546399. Distance: 2.0933027786203637
Total norm for 4 adversaries is: 42.47602293546399. distance: 2.0933027786203637
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1059, Accuracy: 9628/9900 (97.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.475524317136156.
Norm before scaling: 42.48078753472342. Distance: 2.084357874398174
Total norm for 4 adversaries is: 42.48078753472342. distance: 2.084357874398174
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1812, Accuracy: 9418/9900 (95.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 42.475524317136156.
Norm before scaling: 42.481480052617485. Distance: 2.195513515839992
Total norm for 4 adversaries is: 42.481480052617485. distance: 2.195513515839992
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1909, Accuracy: 9417/9900 (95.1212%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3691/4184 (88.2170%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3806/4184 (90.9656%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9368, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4361/5037 (86.5793%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4551/5037 (90.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0010, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3561/4158 (85.6421%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3638/4158 (87.4940%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1115, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2858/3271 (87.3739%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2937/3271 (89.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9102, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4358/4918 (88.6133%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4393/4918 (89.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1556, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5102/5902 (86.4453%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4975/5902 (84.2935%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3764, Accuracy: 4914/10000 (49.1400%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3803/4354 (87.3450%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0116, Accuracy: 3445/4354 (79.1226%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.6150, Accuracy: 4570/10000 (45.7000%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3517/3969 (88.6117%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3608/3969 (90.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9827, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3878/4356 (89.0266%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3863/4356 (88.6823%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2682, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3767/4295 (87.7066%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3666/4295 (85.3551%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0752, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3653/4126 (88.5361%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3745/4126 (90.7659%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0236, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4361/4928 (88.4943%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4425/4928 (89.7930%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9071, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3930/4511 (87.1204%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3999/4511 (88.6500%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0336, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4064/4618 (88.0035%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4069/4618 (88.1117%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0740, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3232/3704 (87.2570%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3342/3704 (90.2268%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9943, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3144/3616 (86.9469%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3271/3616 (90.4591%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0396, Accuracy: 5453/10000 (54.5300%)
time spent on training: 261.8133294582367
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.0960, Accuracy: 7069/10000 (70.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 7.9033, Accuracy: 215/9900 (2.1717%)
Done in 291.1271426677704 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 42.47600425534398.
Norm before scaling: 42.4773879989217. Distance: 1.9878364470151428
Total norm for 4 adversaries is: 42.4773879989217. distance: 1.9878364470151428
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1433, Accuracy: 9529/9900 (96.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4818/5305 (90.8200%), train_poison_data_count: 415
Global model norm: 42.47600425534398.
Norm before scaling: 42.475107599922566. Distance: 2.049515397084033
Total norm for 4 adversaries is: 42.475107599922566. distance: 2.049515397084033
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1216, Accuracy: 9586/9900 (96.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 42.47600425534398.
Norm before scaling: 42.480478627872415. Distance: 2.0000571004345797
Total norm for 4 adversaries is: 42.480478627872415. distance: 2.0000571004345797
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1687, Accuracy: 9482/9900 (95.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 42.47600425534398.
Norm before scaling: 42.483255835295715. Distance: 2.1721751053760667
Total norm for 4 adversaries is: 42.483255835295715. distance: 2.1721751053760667
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1943, Accuracy: 9428/9900 (95.2323%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2822/3271 (86.2733%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2932/3271 (89.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0325, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3968/4456 (89.0485%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4112/4456 (92.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9212, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3559/4013 (88.6868%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3671/4013 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8030, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3305/3781 (87.4107%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3365/3781 (88.9976%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2441, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3375/3775 (89.4040%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3470/3775 (91.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8456, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4516/5232 (86.3150%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4540/5232 (86.7737%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1515, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4315/4989 (86.4903%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4384/4989 (87.8733%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0060, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3171/3646 (86.9720%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3291/3646 (90.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9089, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3903/4315 (90.4519%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3922/4315 (90.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9720, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4374/4918 (88.9386%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4464/4918 (90.7686%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9805, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3799/4416 (86.0281%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3903/4416 (88.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9952, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5525/6263 (88.2165%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5678/6263 (90.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0422, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5263/6124 (85.9406%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5337/6124 (87.1489%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9939, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4119/4651 (88.5616%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4175/4651 (89.7656%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0792, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3840/4356 (88.1543%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3757/4356 (86.2489%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4081, Accuracy: 4776/10000 (47.7600%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3881/4356 (89.0955%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3662/4356 (84.0680%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4284, Accuracy: 4661/10000 (46.6100%)
time spent on training: 263.474271774292
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.0959, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 7.8901, Accuracy: 217/9900 (2.1919%)
Done in 292.8429057598114 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 42.47641952684233.
Norm before scaling: 42.47924872529674. Distance: 2.0754961868284187
Total norm for 4 adversaries is: 42.47924872529674. distance: 2.0754961868284187
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1335, Accuracy: 9559/9900 (96.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4815/5305 (90.7634%), train_poison_data_count: 415
Global model norm: 42.47641952684233.
Norm before scaling: 42.477686870119676. Distance: 2.1072167552154415
Total norm for 4 adversaries is: 42.477686870119676. distance: 2.1072167552154415
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1969, Accuracy: 9386/9900 (94.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 42.47641952684233.
Norm before scaling: 42.47593815639185. Distance: 1.9335581150046517
Total norm for 4 adversaries is: 42.47593815639185. distance: 1.9335581150046517
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.2935, Accuracy: 9167/9900 (92.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 42.47641952684233.
Norm before scaling: 42.48224870552552. Distance: 2.103769724453661
Total norm for 4 adversaries is: 42.48224870552552. distance: 2.103769724453661
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1081, Accuracy: 9610/9900 (97.0707%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4116/4716 (87.2774%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4136/4716 (87.7014%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0674, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4053/4634 (87.4622%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4096/4634 (88.3902%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8968, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3371/3828 (88.0617%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3467/3828 (90.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9907, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4266/4989 (85.5081%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4399/4989 (88.1740%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0529, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4474/5116 (87.4511%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4480/5116 (87.5684%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0848, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3927/4362 (90.0275%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3944/4362 (90.4172%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0228, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4429/5017 (88.2798%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4527/5017 (90.2332%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8458, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3825/4354 (87.8503%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0099, Accuracy: 3538/4354 (81.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3781, Accuracy: 4771/10000 (47.7100%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3138/3638 (86.2562%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3245/3638 (89.1974%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0372, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4526/5195 (87.1222%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4498/5195 (86.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1287, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4056/4596 (88.2507%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4203/4596 (91.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0068, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4296/4928 (87.1753%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4411/4928 (89.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1676, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4440/5244 (84.6682%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4470/5244 (85.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0406, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5119/5902 (86.7333%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5047/5902 (85.5134%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2772, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4409/5025 (87.7413%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4563/5025 (90.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1411, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5282/6124 (86.2508%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5280/6124 (86.2182%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1389, Accuracy: 5239/10000 (52.3900%)
time spent on training: 266.79893732070923
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.0957, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 7.8707, Accuracy: 222/9900 (2.2424%)
Done in 296.1413588523865 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 42.476992853484816.
Norm before scaling: 42.48386211303137. Distance: 2.076412097314976
Total norm for 4 adversaries is: 42.48386211303137. distance: 2.076412097314976
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0512, Accuracy: 9756/9900 (98.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4819/5305 (90.8388%), train_poison_data_count: 415
Global model norm: 42.476992853484816.
Norm before scaling: 42.47686927997548. Distance: 2.0227149645437703
Total norm for 4 adversaries is: 42.47686927997548. distance: 2.0227149645437703
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.2613, Accuracy: 9293/9900 (93.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 42.476992853484816.
Norm before scaling: 42.48173004593048. Distance: 2.029194422642348
Total norm for 4 adversaries is: 42.48173004593048. distance: 2.029194422642348
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1237, Accuracy: 9559/9900 (96.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4530/5066 (89.4197%), train_poison_data_count: 400
Global model norm: 42.476992853484816.
Norm before scaling: 42.48461348314822. Distance: 2.1353715349095697
Total norm for 4 adversaries is: 42.48461348314822. distance: 2.1353715349095697
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0996, Accuracy: 9630/9900 (97.2727%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4519/5116 (88.3307%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4485/5116 (87.6661%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1172, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4556/5197 (87.6660%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4577/5197 (88.0700%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2172, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3892/4356 (89.3480%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3637/4356 (83.4940%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2678, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4174/4679 (89.2071%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4063/4679 (86.8348%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1281, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4075/4647 (87.6910%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4157/4647 (89.4556%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9902, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3439/3911 (87.9315%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3291/3911 (84.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3580, Accuracy: 4884/10000 (48.8400%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3864/4315 (89.5481%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3934/4315 (91.1703%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9621, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3153/3646 (86.4783%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3286/3646 (90.1262%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7895, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4074/4634 (87.9154%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4188/4634 (90.3755%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9647, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4490/5055 (88.8229%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4572/5055 (90.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9868, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3936/4362 (90.2338%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3900/4362 (89.4085%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1063, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4324/4934 (87.6368%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4061/4934 (82.3064%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2665, Accuracy: 4836/10000 (48.3600%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4093/4767 (85.8611%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4205/4767 (88.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2793, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3955/4433 (89.2172%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4006/4433 (90.3677%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8508, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4251/4928 (86.2622%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4374/4928 (88.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0448, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3382/3837 (88.1418%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3514/3837 (91.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0567, Accuracy: 5342/10000 (53.4200%)
time spent on training: 265.3103151321411
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.0956, Accuracy: 7069/10000 (70.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 7.8575, Accuracy: 226/9900 (2.2828%)
Done in 295.015234708786 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 42.477482833279595.
Norm before scaling: 42.482182616289265. Distance: 2.0480980167700977
Total norm for 4 adversaries is: 42.482182616289265. distance: 2.0480980167700977
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1638, Accuracy: 9506/9900 (96.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4808/5305 (90.6315%), train_poison_data_count: 415
Global model norm: 42.477482833279595.
Norm before scaling: 42.47853605517291. Distance: 2.0814825483658543
Total norm for 4 adversaries is: 42.47853605517291. distance: 2.0814825483658543
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.2578, Accuracy: 9284/9900 (93.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 42.477482833279595.
Norm before scaling: 42.48141827243413. Distance: 2.037272167924539
Total norm for 4 adversaries is: 42.48141827243413. distance: 2.037272167924539
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1944, Accuracy: 9382/9900 (94.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4524/5066 (89.3012%), train_poison_data_count: 400
Global model norm: 42.477482833279595.
Norm before scaling: 42.49081213875463. Distance: 2.191469568979943
Total norm for 4 adversaries is: 42.49081213875463. distance: 2.191469568979943
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.2003, Accuracy: 9405/9900 (95.0000%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4418/4986 (88.6081%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4465/4986 (89.5507%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0319, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4104/4767 (86.0919%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4167/4767 (87.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0372, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3865/4315 (89.5713%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3976/4315 (92.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8356, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3206/3672 (87.3094%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3267/3672 (88.9706%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0025, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3965/4558 (86.9899%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3982/4558 (87.3629%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2464, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3426/3828 (89.4984%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3532/3828 (92.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0358, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4152/4679 (88.7369%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3964/4679 (84.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.3570, Accuracy: 4903/10000 (49.0300%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4223/4956 (85.2098%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4302/4956 (86.8039%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1381, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3866/4356 (88.7511%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3808/4356 (87.4197%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2418, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4060/4538 (89.4667%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4111/4538 (90.5906%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9535, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3542/4013 (88.2631%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3665/4013 (91.3282%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8586, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4573/5265 (86.8566%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4631/5265 (87.9582%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1039, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4156/4663 (89.1272%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4240/4663 (90.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1151, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5554/6263 (88.6795%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5609/6263 (89.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1805, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4364/5063 (86.1940%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4184/5063 (82.6388%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2869, Accuracy: 4894/10000 (48.9400%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3836/4416 (86.8659%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3977/4416 (90.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9820, Accuracy: 5479/10000 (54.7900%)
time spent on training: 263.94087982177734
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.0954, Accuracy: 7070/10000 (70.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 7.8422, Accuracy: 230/9900 (2.3232%)
Done in 293.692768573761 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 42.47794838069292.
Norm before scaling: 42.477445474315395. Distance: 2.0143751660807627
Total norm for 4 adversaries is: 42.477445474315395. distance: 2.0143751660807627
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1002, Accuracy: 9663/9900 (97.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 42.47794838069292.
Norm before scaling: 42.47827742192914. Distance: 2.0356496260467845
Total norm for 4 adversaries is: 42.47827742192914. distance: 2.0356496260467845
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1080, Accuracy: 9625/9900 (97.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4272/4717 (90.5660%), train_poison_data_count: 370
Global model norm: 42.47794838069292.
Norm before scaling: 42.47794407009213. Distance: 1.9668163916065566
Total norm for 4 adversaries is: 42.47794407009213. distance: 1.9668163916065566
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1780, Accuracy: 9425/9900 (95.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4548/5066 (89.7750%), train_poison_data_count: 400
Global model norm: 42.47794838069292.
Norm before scaling: 42.484186798498186. Distance: 2.1204304650366783
Total norm for 4 adversaries is: 42.484186798498186. distance: 2.1204304650366783
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.2331, Accuracy: 9311/9900 (94.0505%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5017/5740 (87.4042%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5113/5740 (89.0767%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2122, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4083/4651 (87.7876%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4168/4651 (89.6151%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1953, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3978/4503 (88.3411%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3937/4503 (87.4306%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0060, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4118/4767 (86.3856%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4182/4767 (87.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1893, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4869/5591 (87.0864%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4893/5591 (87.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1809, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3962/4465 (88.7346%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4105/4465 (91.9373%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0125, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4288/4956 (86.5214%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4334/4956 (87.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1254, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3261/3704 (88.0400%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3317/3704 (89.5518%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9323, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3628/4025 (90.1366%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3721/4025 (92.4472%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9877, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4487/5083 (88.2746%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4389/5083 (86.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.3480, Accuracy: 4890/10000 (48.9000%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5312/6124 (86.7407%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5317/6124 (86.8223%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0280, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3768/4295 (87.7299%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3795/4295 (88.3586%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0824, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4200/4804 (87.4271%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4134/4804 (86.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2031, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4198/4793 (87.5861%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4333/4793 (90.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0369, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3938/4433 (88.8337%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4036/4433 (91.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9552, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3805/4361 (87.2506%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3709/4361 (85.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1980, Accuracy: 5221/10000 (52.2100%)
time spent on training: 265.9376473426819
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.0953, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 7.8293, Accuracy: 231/9900 (2.3333%)
Done in 295.52883195877075 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 42.478375128006306.
Norm before scaling: 42.48280471307259. Distance: 2.044323328077156
Total norm for 4 adversaries is: 42.48280471307259. distance: 2.044323328077156
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0533, Accuracy: 9756/9900 (98.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.478375128006306.
Norm before scaling: 42.47560766008828. Distance: 2.0755190464396582
Total norm for 4 adversaries is: 42.47560766008828. distance: 2.0755190464396582
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1253, Accuracy: 9554/9900 (96.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 42.478375128006306.
Norm before scaling: 42.48339375705744. Distance: 2.0151762943434837
Total norm for 4 adversaries is: 42.48339375705744. distance: 2.0151762943434837
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.2089, Accuracy: 9395/9900 (94.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4518/5066 (89.1828%), train_poison_data_count: 400
Global model norm: 42.478375128006306.
Norm before scaling: 42.48738898374728. Distance: 2.1649369769361013
Total norm for 4 adversaries is: 42.48738898374728. distance: 2.1649369769361013
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0929, Accuracy: 9666/9900 (97.6364%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4032/4558 (88.4599%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4004/4558 (87.8455%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0172, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4103/4596 (89.2733%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4148/4596 (90.2524%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0366, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4306/4874 (88.3463%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4183/4874 (85.8227%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3576, Accuracy: 4865/10000 (48.6500%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3613/4158 (86.8927%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3655/4158 (87.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0590, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4837/5455 (88.6709%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4847/5455 (88.8543%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0476, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3870/4346 (89.0474%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3993/4346 (91.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9086, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4169/4679 (89.1002%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4274/4679 (91.3443%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1020, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3830/4416 (86.7301%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3947/4416 (89.3795%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9040, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3366/3828 (87.9310%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3494/3828 (91.2748%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9748, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3742/4223 (88.6100%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3815/4223 (90.3386%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0195, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4568/5265 (86.7616%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4530/5265 (86.0399%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2392, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5260/6124 (85.8916%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5327/6124 (86.9856%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0869, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3834/4361 (87.9156%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3701/4361 (84.8659%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1536, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4286/4956 (86.4810%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4329/4956 (87.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1120, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5035/5740 (87.7178%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5115/5740 (89.1115%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2733, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3555/4013 (88.5871%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3633/4013 (90.5308%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9997, Accuracy: 5403/10000 (54.0300%)
time spent on training: 268.57783460617065
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.0951, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 7.8162, Accuracy: 233/9900 (2.3535%)
Done in 298.06300711631775 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4407/4885 (90.2149%), train_poison_data_count: 385
Global model norm: 42.47882198675962.
Norm before scaling: 42.480461386493616. Distance: 2.0392789177761057
Total norm for 4 adversaries is: 42.480461386493616. distance: 2.0392789177761057
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.2462, Accuracy: 9299/9900 (93.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4808/5305 (90.6315%), train_poison_data_count: 415
Global model norm: 42.47882198675962.
Norm before scaling: 42.47563352510913. Distance: 2.0395536452390415
Total norm for 4 adversaries is: 42.47563352510913. distance: 2.0395536452390415
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.3211, Accuracy: 9124/9900 (92.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4262/4717 (90.3540%), train_poison_data_count: 370
Global model norm: 42.47882198675962.
Norm before scaling: 42.47462765158307. Distance: 1.9393421767540113
Total norm for 4 adversaries is: 42.47462765158307. distance: 1.9393421767540113
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1893, Accuracy: 9414/9900 (95.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4551/5066 (89.8342%), train_poison_data_count: 400
Global model norm: 42.47882198675962.
Norm before scaling: 42.4825015677411. Distance: 2.1215238749760763
Total norm for 4 adversaries is: 42.4825015677411. distance: 2.1215238749760763
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1649, Accuracy: 9509/9900 (96.0505%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3676/4184 (87.8585%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3774/4184 (90.2008%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8682, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3222/3590 (89.7493%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3231/3590 (90.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0965, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3516/4158 (84.5599%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3580/4158 (86.0991%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1660, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3598/4025 (89.3913%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3691/4025 (91.7019%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9738, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3633/4046 (89.7924%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3610/4046 (89.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0074, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4443/5025 (88.4179%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4522/5025 (89.9900%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0574, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4351/5063 (85.9372%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4377/5063 (86.4507%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0332, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3921/4356 (90.0138%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4013/4356 (92.1258%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0230, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4076/4651 (87.6371%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4189/4651 (90.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9244, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3876/4356 (88.9807%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3770/4356 (86.5473%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2940, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4040/4576 (88.2867%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4143/4576 (90.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0145, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3997/4456 (89.6993%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4082/4456 (91.6068%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0452, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2917/3297 (88.4744%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3027/3297 (91.8107%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8012, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4231/4804 (88.0724%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4185/4804 (87.1149%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2329, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3539/3969 (89.1660%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3562/3969 (89.7455%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9677, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4494/5195 (86.5063%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4534/5195 (87.2762%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1336, Accuracy: 5206/10000 (52.0600%)
time spent on training: 260.3295817375183
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.0949, Accuracy: 7070/10000 (70.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 7.8036, Accuracy: 233/9900 (2.3535%)
Done in 289.5704755783081 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4439/4885 (90.8700%), train_poison_data_count: 385
Global model norm: 42.47917832091756.
Norm before scaling: 42.481178334590865. Distance: 2.0070867154366976
Total norm for 4 adversaries is: 42.481178334590865. distance: 2.0070867154366976
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1853, Accuracy: 9435/9900 (95.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 42.47917832091756.
Norm before scaling: 42.48373568616068. Distance: 2.1417281378249946
Total norm for 4 adversaries is: 42.48373568616068. distance: 2.1417281378249946
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1022, Accuracy: 9624/9900 (97.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4290/4717 (90.9476%), train_poison_data_count: 370
Global model norm: 42.47917832091756.
Norm before scaling: 42.4799312106795. Distance: 1.9781484762187784
Total norm for 4 adversaries is: 42.4799312106795. distance: 1.9781484762187784
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1853, Accuracy: 9453/9900 (95.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4535/5066 (89.5184%), train_poison_data_count: 400
Global model norm: 42.47917832091756.
Norm before scaling: 42.48400721613517. Distance: 2.135795770504105
Total norm for 4 adversaries is: 42.48400721613517. distance: 2.135795770504105
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.2324, Accuracy: 9326/9900 (94.2020%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3410/3837 (88.8715%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3580/3837 (93.3021%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8326, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4976/5582 (89.1437%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5005/5582 (89.6632%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0387, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4799/5455 (87.9743%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4801/5455 (88.0110%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0442, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4117/4679 (87.9889%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4180/4679 (89.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0092, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4032/4518 (89.2430%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4120/4518 (91.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0572, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4107/4618 (88.9346%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4187/4618 (90.6670%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1100, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4088/4716 (86.6836%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4162/4716 (88.2528%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0660, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4460/5244 (85.0496%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4503/5244 (85.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0565, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4300/4874 (88.2232%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4155/4874 (85.2483%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2931, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4317/4928 (87.6015%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4374/4928 (88.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0443, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3665/4126 (88.8270%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3755/4126 (91.0082%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9628, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3376/3828 (88.1923%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3471/3828 (90.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1010, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3077/3472 (88.6233%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3116/3472 (89.7465%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0384, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3150/3638 (86.5860%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3296/3638 (90.5992%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9486, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3207/3590 (89.3315%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3169/3590 (88.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2352, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3700/4223 (87.6154%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3765/4223 (89.1546%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0245, Accuracy: 5361/10000 (53.6100%)
time spent on training: 263.06631445884705
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.0949, Accuracy: 7072/10000 (70.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 7.7858, Accuracy: 235/9900 (2.3737%)
Done in 292.9484193325043 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4450/4885 (91.0952%), train_poison_data_count: 385
Global model norm: 42.47963522889159.
Norm before scaling: 42.48283201041333. Distance: 2.0246112026388143
Total norm for 4 adversaries is: 42.48283201041333. distance: 2.0246112026388143
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.2379, Accuracy: 9329/9900 (94.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 42.47963522889159.
Norm before scaling: 42.48053322552578. Distance: 2.0486747458824457
Total norm for 4 adversaries is: 42.48053322552578. distance: 2.0486747458824457
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.2176, Accuracy: 9373/9900 (94.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 42.47963522889159.
Norm before scaling: 42.48070563870732. Distance: 1.9451337985032262
Total norm for 4 adversaries is: 42.48070563870732. distance: 1.9451337985032262
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1266, Accuracy: 9551/9900 (96.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 42.47963522889159.
Norm before scaling: 42.48598832675971. Distance: 2.141780569211709
Total norm for 4 adversaries is: 42.48598832675971. distance: 2.141780569211709
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0859, Accuracy: 9656/9900 (97.5354%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3983/4441 (89.6870%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4043/4441 (91.0381%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0407, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4396/5017 (87.6221%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4505/5017 (89.7947%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8728, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4354/4918 (88.5319%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4409/4918 (89.6503%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0679, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4564/5197 (87.8199%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4569/5197 (87.9161%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1894, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3903/4356 (89.6006%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0103, Accuracy: 3533/4356 (81.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3430, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4875/5455 (89.3676%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4821/5455 (88.3776%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0446, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2909/3297 (88.2317%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3005/3297 (91.1435%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7709, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4497/5195 (86.5640%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4585/5195 (88.2579%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2007, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3388/3828 (88.5057%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3454/3828 (90.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8762, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3973/4456 (89.1607%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4063/4456 (91.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9319, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3825/4361 (87.7092%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3760/4361 (86.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3525, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3770/4235 (89.0201%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3792/4235 (89.5396%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0874, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4424/5025 (88.0398%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4504/5025 (89.6318%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1125, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3157/3646 (86.5880%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3287/3646 (90.1536%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8208, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3520/4158 (84.6561%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3599/4158 (86.5560%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1413, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4034/4538 (88.8938%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4172/4538 (91.9348%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8429, Accuracy: 5681/10000 (56.8100%)
time spent on training: 264.9372310638428
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.0947, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 7.7763, Accuracy: 236/9900 (2.3838%)
Done in 294.8182101249695 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 42.4800921319512.
Norm before scaling: 42.48158349830474. Distance: 1.9981251512037594
Total norm for 4 adversaries is: 42.48158349830474. distance: 1.9981251512037594
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2465, Accuracy: 9348/9900 (94.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 42.4800921319512.
Norm before scaling: 42.48048868534015. Distance: 2.085606123644783
Total norm for 4 adversaries is: 42.48048868534015. distance: 2.085606123644783
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1913, Accuracy: 9420/9900 (95.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4225/4717 (89.5696%), train_poison_data_count: 370
Global model norm: 42.4800921319512.
Norm before scaling: 42.4829081555343. Distance: 2.02385032890493
Total norm for 4 adversaries is: 42.4829081555343. distance: 2.02385032890493
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2026, Accuracy: 9391/9900 (94.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4554/5066 (89.8934%), train_poison_data_count: 400
Global model norm: 42.4800921319512.
Norm before scaling: 42.48681436082553. Distance: 2.1578320214384994
Total norm for 4 adversaries is: 42.48681436082553. distance: 2.1578320214384994
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2108, Accuracy: 9370/9900 (94.6465%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3805/4295 (88.5914%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3766/4295 (87.6834%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0269, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4956/5582 (88.7854%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4997/5582 (89.5199%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2780, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3180/3672 (86.6013%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3311/3672 (90.1688%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0158, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4046/4518 (89.5529%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4090/4518 (90.5268%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0021, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3389/3797 (89.2547%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3400/3797 (89.5444%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1161, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3945/4362 (90.4402%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3949/4362 (90.5319%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9799, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4203/4804 (87.4896%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3859/4804 (80.3289%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3915, Accuracy: 4851/10000 (48.5100%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4523/5116 (88.4089%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4539/5116 (88.7217%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0296, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4391/5025 (87.3831%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4471/5025 (88.9751%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2367, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2927/3297 (88.7777%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3042/3297 (92.2657%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8295, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3254/3704 (87.8510%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3331/3704 (89.9298%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9789, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4816/5424 (88.7906%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4908/5424 (90.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2399, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3408/3861 (88.2673%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3485/3861 (90.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8774, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4340/4874 (89.0439%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4329/4874 (88.8182%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1749, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4093/4647 (88.0783%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4190/4647 (90.1657%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9518, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3877/4356 (89.0037%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3803/4356 (87.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2478, Accuracy: 5071/10000 (50.7100%)
time spent on training: 261.7110245227814
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.0945, Accuracy: 7072/10000 (70.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 7.7629, Accuracy: 240/9900 (2.4242%)
Done in 291.22732043266296 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4442/4885 (90.9314%), train_poison_data_count: 385
Global model norm: 42.480478627872415.
Norm before scaling: 42.484477001992296. Distance: 2.038496618564207
Total norm for 4 adversaries is: 42.484477001992296. distance: 2.038496618564207
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2051, Accuracy: 9417/9900 (95.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 42.480478627872415.
Norm before scaling: 42.48058782310898. Distance: 2.0535322647625125
Total norm for 4 adversaries is: 42.48058782310898. distance: 2.0535322647625125
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2945, Accuracy: 9196/9900 (92.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4246/4717 (90.0148%), train_poison_data_count: 370
Global model norm: 42.480478627872415.
Norm before scaling: 42.483222791473814. Distance: 2.006850431440969
Total norm for 4 adversaries is: 42.483222791473814. distance: 2.006850431440969
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1632, Accuracy: 9446/9900 (95.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4494/5066 (88.7090%), train_poison_data_count: 400
Global model norm: 42.480478627872415.
Norm before scaling: 42.48902374345491. Distance: 2.2122687655375195
Total norm for 4 adversaries is: 42.48902374345491. distance: 2.2122687655375195
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1201, Accuracy: 9580/9900 (96.7677%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3979/4503 (88.3633%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3935/4503 (87.3862%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0433, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3390/3861 (87.8011%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3531/3861 (91.4530%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9192, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3660/4184 (87.4761%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3808/4184 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9030, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4007/4518 (88.6897%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4065/4518 (89.9734%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0758, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4458/5083 (87.7041%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4508/5083 (88.6878%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0558, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4204/4804 (87.5104%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3809/4804 (79.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3976, Accuracy: 4818/10000 (48.1800%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3879/4356 (89.0496%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3796/4356 (87.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3010, Accuracy: 4933/10000 (49.3300%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4402/5244 (83.9436%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4487/5244 (85.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0489, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4177/4679 (89.2712%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4097/4679 (87.5614%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0634, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3825/4416 (86.6168%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3953/4416 (89.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9678, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4312/4918 (87.6779%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4380/4918 (89.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0814, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3188/3616 (88.1637%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3285/3616 (90.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8554, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4056/4576 (88.6364%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4151/4576 (90.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9282, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4317/4928 (87.6015%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4424/4928 (89.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9505, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3581/4013 (89.2350%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3672/4013 (91.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9232, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3865/4336 (89.1375%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3881/4336 (89.5065%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1727, Accuracy: 5172/10000 (51.7200%)
time spent on training: 262.37150382995605
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.0943, Accuracy: 7072/10000 (70.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 7.7425, Accuracy: 244/9900 (2.4646%)
Done in 291.7120268344879 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 42.48097287775581.
Norm before scaling: 42.48705857651686. Distance: 2.0796487141122864
Total norm for 4 adversaries is: 42.48705857651686. distance: 2.0796487141122864
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1293, Accuracy: 9570/9900 (96.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4817/5305 (90.8011%), train_poison_data_count: 415
Global model norm: 42.48097287775581.
Norm before scaling: 42.480760236068924. Distance: 2.0719047900973915
Total norm for 4 adversaries is: 42.480760236068924. distance: 2.0719047900973915
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1683, Accuracy: 9508/9900 (96.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4250/4717 (90.0996%), train_poison_data_count: 370
Global model norm: 42.48097287775581.
Norm before scaling: 42.483194057694746. Distance: 2.0105224607892684
Total norm for 4 adversaries is: 42.483194057694746. distance: 2.0105224607892684
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1513, Accuracy: 9495/9900 (95.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4513/5066 (89.0841%), train_poison_data_count: 400
Global model norm: 42.48097287775581.
Norm before scaling: 42.49064263945725. Distance: 2.1862566002669253
Total norm for 4 adversaries is: 42.49064263945725. distance: 2.1862566002669253
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.2002, Accuracy: 9409/9900 (95.0404%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5633/6263 (89.9409%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5642/6263 (90.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0426, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3110/3472 (89.5737%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3133/3472 (90.2362%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9890, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3559/4158 (85.5940%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3662/4158 (88.0712%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9674, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3128/3638 (85.9813%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3326/3638 (91.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0032, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4332/4874 (88.8798%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4277/4874 (87.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2698, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3900/4356 (89.5317%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3567/4356 (81.8871%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2077, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4000/4538 (88.1446%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4127/4538 (90.9431%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8908, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4347/4928 (88.2102%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4395/4928 (89.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9325, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4082/4618 (88.3932%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4152/4618 (89.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0422, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4184/4707 (88.8889%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4185/4707 (88.9101%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0581, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4183/4679 (89.3994%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4210/4679 (89.9765%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2630, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4074/4647 (87.6695%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4224/4647 (90.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9857, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4104/4576 (89.6853%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4186/4576 (91.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0957, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3626/4046 (89.6194%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3630/4046 (89.7182%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9959, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4087/4651 (87.8736%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4170/4651 (89.6581%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2316, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4493/5055 (88.8823%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4576/5055 (90.5242%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0577, Accuracy: 5372/10000 (53.7200%)
time spent on training: 265.87576484680176
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.0942, Accuracy: 7073/10000 (70.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 7.7303, Accuracy: 247/9900 (2.4949%)
Done in 295.79688835144043 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 42.48135792891248.
Norm before scaling: 42.48361356893973. Distance: 2.0406992689932846
Total norm for 4 adversaries is: 42.48361356893973. distance: 2.0406992689932846
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.3493, Accuracy: 9062/9900 (91.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 42.48135792891248.
Norm before scaling: 42.48368827598717. Distance: 2.1277650906898646
Total norm for 4 adversaries is: 42.48368827598717. distance: 2.1277650906898646
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.1092, Accuracy: 9620/9900 (97.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4268/4717 (90.4812%), train_poison_data_count: 370
Global model norm: 42.48135792891248.
Norm before scaling: 42.485535796940646. Distance: 1.9730611555556563
Total norm for 4 adversaries is: 42.485535796940646. distance: 1.9730611555556563
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.2281, Accuracy: 9319/9900 (94.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4515/5066 (89.1236%), train_poison_data_count: 400
Global model norm: 42.48135792891248.
Norm before scaling: 42.48820637146339. Distance: 2.168841212220688
Total norm for 4 adversaries is: 42.48820637146339. distance: 2.168841212220688
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0982, Accuracy: 9648/9900 (97.4545%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5032/5740 (87.6655%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5098/5740 (88.8153%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9957, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3655/4175 (87.5449%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3677/4175 (88.0719%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0866, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4320/4918 (87.8406%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4496/4918 (91.4193%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9975, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3803/4235 (89.7993%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3762/4235 (88.8312%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1943, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4826/5455 (88.4693%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4819/5455 (88.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2310, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4103/4662 (88.0094%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4207/4662 (90.2402%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9563, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3997/4465 (89.5185%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4051/4465 (90.7279%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0927, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4083/4651 (87.7876%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4138/4651 (88.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1945, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4135/4618 (89.5409%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4188/4618 (90.6886%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0081, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4364/5037 (86.6389%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4535/5037 (90.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0260, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3796/4354 (87.1842%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3681/4354 (84.5429%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.4444, Accuracy: 4861/10000 (48.6100%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3987/4441 (89.7771%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4010/4441 (90.2950%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1359, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4018/4538 (88.5412%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4145/4538 (91.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8932, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4501/5116 (87.9789%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4475/5116 (87.4707%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0471, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5319/6124 (86.8550%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5310/6124 (86.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1069, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3926/4362 (90.0046%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3923/4362 (89.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0806, Accuracy: 5239/10000 (52.3900%)
time spent on training: 270.65106415748596
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.0940, Accuracy: 7074/10000 (70.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 7.7175, Accuracy: 257/9900 (2.5960%)
Done in 299.92091703414917 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4405/4885 (90.1740%), train_poison_data_count: 385
Global model norm: 42.48183061753798.
Norm before scaling: 42.489724745923866. Distance: 2.0888141127768156
Total norm for 4 adversaries is: 42.489724745923866. distance: 2.0888141127768156
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.2430, Accuracy: 9273/9900 (93.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 42.48183061753798.
Norm before scaling: 42.48070276516003. Distance: 2.071432940473788
Total norm for 4 adversaries is: 42.48070276516003. distance: 2.071432940473788
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1380, Accuracy: 9550/9900 (96.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4265/4717 (90.4176%), train_poison_data_count: 370
Global model norm: 42.48183061753798.
Norm before scaling: 42.48404025934695. Distance: 1.9660099277303886
Total norm for 4 adversaries is: 42.48404025934695. distance: 1.9660099277303886
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.2107, Accuracy: 9365/9900 (94.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 42.48183061753798.
Norm before scaling: 42.487730880698074. Distance: 2.11969869973712
Total norm for 4 adversaries is: 42.487730880698074. distance: 2.11969869973712
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.3024, Accuracy: 9170/9900 (92.6263%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3816/4361 (87.5029%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3760/4361 (86.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0780, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3352/3797 (88.2802%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3440/3797 (90.5978%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0060, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4370/4918 (88.8573%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4416/4918 (89.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2165, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3161/3638 (86.8884%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3290/3638 (90.4343%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9266, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3216/3590 (89.5822%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3243/3590 (90.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1568, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4401/4986 (88.2671%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4471/4986 (89.6711%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8759, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4801/5392 (89.0393%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4797/5392 (88.9651%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1008, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3354/3804 (88.1703%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3426/3804 (90.0631%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0754, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4416/5025 (87.8806%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4549/5025 (90.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1045, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4178/4793 (87.1688%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4309/4793 (89.9019%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1065, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4302/4956 (86.8039%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4309/4956 (86.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1928, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4441/5116 (86.8061%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4494/5116 (87.8421%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0437, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4509/5055 (89.1988%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4567/5055 (90.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9090, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4348/5063 (85.8779%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4242/5063 (83.7843%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2415, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3997/4433 (90.1647%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4047/4433 (91.2926%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9139, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4104/4662 (88.0309%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4233/4662 (90.7979%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9684, Accuracy: 5524/10000 (55.2400%)
time spent on training: 264.31692242622375
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.0940, Accuracy: 7075/10000 (70.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 7.7046, Accuracy: 261/9900 (2.6364%)
Done in 293.87927174568176 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 42.48226594617894.
Norm before scaling: 42.48454883423428. Distance: 2.010016156032027
Total norm for 4 adversaries is: 42.48454883423428. distance: 2.010016156032027
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.3065, Accuracy: 9140/9900 (92.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 42.48226594617894.
Norm before scaling: 42.481023164485606. Distance: 2.102593491660791
Total norm for 4 adversaries is: 42.481023164485606. distance: 2.102593491660791
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1214, Accuracy: 9596/9900 (96.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 42.48226594617894.
Norm before scaling: 42.483685402641626. Distance: 1.9793022377027336
Total norm for 4 adversaries is: 42.483685402641626. distance: 1.9793022377027336
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.2115, Accuracy: 9358/9900 (94.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4539/5066 (89.5973%), train_poison_data_count: 400
Global model norm: 42.48226594617894.
Norm before scaling: 42.48757717106481. Distance: 2.162678961432364
Total norm for 4 adversaries is: 42.48757717106481. distance: 2.162678961432364
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0887, Accuracy: 9639/9900 (97.3636%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4184/4804 (87.0941%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3960/4804 (82.4313%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2874, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4202/4793 (87.6695%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4277/4793 (89.2343%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0318, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3329/3781 (88.0455%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3363/3781 (88.9447%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2682, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3671/4175 (87.9281%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3753/4175 (89.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9238, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3904/4362 (89.5002%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3963/4362 (90.8528%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0078, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4445/5083 (87.4484%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4476/5083 (88.0582%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1789, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4306/4874 (88.3463%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4167/4874 (85.4945%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2226, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3199/3646 (87.7400%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3324/3646 (91.1684%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8849, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3371/3756 (89.7497%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3459/3756 (92.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0220, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3700/4223 (87.6154%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3818/4223 (90.4097%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0937, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3917/4356 (89.9219%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3896/4356 (89.4399%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9982, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4427/5025 (88.0995%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4578/5025 (91.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0279, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5521/6391 (86.3871%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5516/6391 (86.3089%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0420, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4001/4518 (88.5569%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4129/4518 (91.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9790, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4513/5167 (87.3428%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4636/5167 (89.7232%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0855, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4169/4679 (89.1002%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4262/4679 (91.0878%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1658, Accuracy: 5279/10000 (52.7900%)
time spent on training: 261.688761472702
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.0938, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 7.6923, Accuracy: 262/9900 (2.6465%)
Done in 291.3019435405731 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 42.482696960240474.
Norm before scaling: 42.48630724964147. Distance: 2.0240818014162527
Total norm for 4 adversaries is: 42.48630724964147. distance: 2.0240818014162527
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.2078, Accuracy: 9406/9900 (95.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4831/5305 (91.0650%), train_poison_data_count: 415
Global model norm: 42.482696960240474.
Norm before scaling: 42.48061799542749. Distance: 2.0356892127689545
Total norm for 4 adversaries is: 42.48061799542749. distance: 2.0356892127689545
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1670, Accuracy: 9491/9900 (95.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4265/4717 (90.4176%), train_poison_data_count: 370
Global model norm: 42.482696960240474.
Norm before scaling: 42.47850731822359. Distance: 1.929009507645768
Total norm for 4 adversaries is: 42.47850731822359. distance: 1.929009507645768
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1557, Accuracy: 9509/9900 (96.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4548/5066 (89.7750%), train_poison_data_count: 400
Global model norm: 42.482696960240474.
Norm before scaling: 42.49110660626527. Distance: 2.155109380260652
Total norm for 4 adversaries is: 42.49110660626527. distance: 2.155109380260652
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1267, Accuracy: 9556/9900 (96.5253%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4295/4956 (86.6626%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4382/4956 (88.4181%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1926, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3342/3797 (88.0169%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3397/3797 (89.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9463, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4447/5017 (88.6386%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4551/5017 (90.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9302, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3962/4433 (89.3751%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4064/4433 (91.6761%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8698, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3388/3781 (89.6059%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3452/3781 (91.2986%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9847, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4602/5265 (87.4074%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4666/5265 (88.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9921, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4566/5197 (87.8584%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4602/5197 (88.5511%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1866, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3181/3646 (87.2463%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3323/3646 (91.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8686, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3865/4356 (88.7282%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3725/4356 (85.5142%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4292, Accuracy: 4740/10000 (47.4000%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3350/3804 (88.0652%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3475/3804 (91.3512%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9368, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3214/3590 (89.5265%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3222/3590 (89.7493%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1491, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3629/4046 (89.6935%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3635/4046 (89.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9831, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4441/5244 (84.6873%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4539/5244 (86.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1426, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4418/5025 (87.9204%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4537/5025 (90.2886%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2862, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3353/3756 (89.2705%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3472/3756 (92.4388%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0904, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4821/5392 (89.4102%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4756/5392 (88.2047%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0344, Accuracy: 5357/10000 (53.5700%)
time spent on training: 263.8930878639221
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.0937, Accuracy: 7075/10000 (70.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 7.6738, Accuracy: 267/9900 (2.6970%)
Done in 293.17868995666504 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 42.48319262100528.
Norm before scaling: 42.48334059976481. Distance: 1.9626531504747862
Total norm for 4 adversaries is: 42.48334059976481. distance: 1.9626531504747862
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.2941, Accuracy: 9195/9900 (92.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 42.48319262100528.
Norm before scaling: 42.48876661055175. Distance: 2.1397955185355957
Total norm for 4 adversaries is: 42.48876661055175. distance: 2.1397955185355957
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0827, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.48319262100528.
Norm before scaling: 42.484318970632415. Distance: 1.9906453465450433
Total norm for 4 adversaries is: 42.484318970632415. distance: 1.9906453465450433
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0644, Accuracy: 9738/9900 (98.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4521/5066 (89.2420%), train_poison_data_count: 400
Global model norm: 42.48319262100528.
Norm before scaling: 42.48663335299556. Distance: 2.1233136834992505
Total norm for 4 adversaries is: 42.48663335299556. distance: 2.1233136834992505
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1924, Accuracy: 9413/9900 (95.0808%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4122/4663 (88.3980%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4225/4663 (90.6069%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1650, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4136/4618 (89.5626%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4134/4618 (89.5193%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0885, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4140/4662 (88.8031%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4211/4662 (90.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0182, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3942/4511 (87.3864%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4061/4511 (90.0244%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0243, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3893/4362 (89.2481%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3945/4362 (90.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1454, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4038/4558 (88.5915%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4029/4558 (88.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1970, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3385/3828 (88.4274%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3513/3828 (91.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8642, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4100/4716 (86.9381%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4187/4716 (88.7829%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0465, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4002/4465 (89.6305%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4061/4465 (90.9518%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9621, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4275/4928 (86.7492%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4347/4928 (88.2102%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1169, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4844/5455 (88.7993%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4822/5455 (88.3960%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9411, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4067/4647 (87.5188%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4143/4647 (89.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9382, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4815/5591 (86.1206%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4858/5591 (86.8896%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1734, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3187/3616 (88.1361%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3246/3616 (89.7677%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8977, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4444/4986 (89.1296%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4494/4986 (90.1324%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8684, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4534/5167 (87.7492%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4608/5167 (89.1813%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3733, Accuracy: 5005/10000 (50.0500%)
time spent on training: 267.6078476905823
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.0936, Accuracy: 7074/10000 (70.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 7.6587, Accuracy: 270/9900 (2.7273%)
Done in 297.5016884803772 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 42.48364948580586.
Norm before scaling: 42.48503872688596. Distance: 1.9909559444877818
Total norm for 4 adversaries is: 42.48503872688596. distance: 1.9909559444877818
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1517, Accuracy: 9483/9900 (95.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.48364948580586.
Norm before scaling: 42.48467669532452. Distance: 2.099228935373155
Total norm for 4 adversaries is: 42.48467669532452. distance: 2.099228935373155
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1572, Accuracy: 9508/9900 (96.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 42.48364948580586.
Norm before scaling: 42.4845675105973. Distance: 2.0020210068521864
Total norm for 4 adversaries is: 42.4845675105973. distance: 2.0020210068521864
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1485, Accuracy: 9505/9900 (96.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4525/5066 (89.3210%), train_poison_data_count: 400
Global model norm: 42.48364948580586.
Norm before scaling: 42.48733726800257. Distance: 2.1318539432144443
Total norm for 4 adversaries is: 42.48733726800257. distance: 2.1318539432144443
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.2825, Accuracy: 9190/9900 (92.8283%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3644/4175 (87.2814%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3651/4175 (87.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9822, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4080/4596 (88.7728%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4168/4596 (90.6876%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1449, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3193/3616 (88.3020%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3302/3616 (91.3164%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9425, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3889/4356 (89.2792%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3707/4356 (85.1010%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.4216, Accuracy: 4823/10000 (48.2300%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4428/5244 (84.4394%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4568/5244 (87.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0061, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2943/3297 (89.2630%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2988/3297 (90.6278%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8155, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3173/3646 (87.0269%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3323/3646 (91.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8531, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3340/3797 (87.9642%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3436/3797 (90.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9818, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3999/4456 (89.7442%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4092/4456 (91.8312%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9729, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3400/3828 (88.8192%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3473/3828 (90.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9890, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5042/5582 (90.3260%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4929/5582 (88.3017%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0878, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3092/3472 (89.0553%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3180/3472 (91.5899%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9844, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3915/4362 (89.7524%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3957/4362 (90.7153%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1354, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4755/5424 (87.6659%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4872/5424 (89.8230%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3863, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4156/4679 (88.8224%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4204/4679 (89.8483%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9514, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3215/3590 (89.5543%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3062/3590 (85.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1826, Accuracy: 5171/10000 (51.7100%)
time spent on training: 260.16483640670776
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.0934, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 7.6433, Accuracy: 275/9900 (2.7778%)
Done in 289.41082763671875 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4454/4885 (91.1771%), train_poison_data_count: 385
Global model norm: 42.484083359149786.
Norm before scaling: 42.483695459350194. Distance: 2.021772369657245
Total norm for 4 adversaries is: 42.483695459350194. distance: 2.021772369657245
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.2709, Accuracy: 9208/9900 (93.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4817/5305 (90.8011%), train_poison_data_count: 415
Global model norm: 42.484083359149786.
Norm before scaling: 42.48241536488215. Distance: 2.066640916274244
Total norm for 4 adversaries is: 42.48241536488215. distance: 2.066640916274244
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1331, Accuracy: 9559/9900 (96.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4245/4717 (89.9936%), train_poison_data_count: 370
Global model norm: 42.484083359149786.
Norm before scaling: 42.487136150619165. Distance: 2.0300554724569575
Total norm for 4 adversaries is: 42.487136150619165. distance: 2.0300554724569575
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.3478, Accuracy: 9059/9900 (91.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4520/5066 (89.2223%), train_poison_data_count: 400
Global model norm: 42.484083359149786.
Norm before scaling: 42.49119566432998. Distance: 2.1835546609454104
Total norm for 4 adversaries is: 42.49119566432998. distance: 2.1835546609454104
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1029, Accuracy: 9611/9900 (97.0808%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3351/3804 (88.0915%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3416/3804 (89.8002%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9642, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2919/3297 (88.5350%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3016/3297 (91.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8731, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3801/4354 (87.2990%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0103, Accuracy: 3511/4354 (80.6385%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4186, Accuracy: 4712/10000 (47.1200%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3948/4433 (89.0593%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4061/4433 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9068, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3388/3775 (89.7483%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3523/3775 (93.3245%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8922, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4551/5195 (87.6035%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4619/5195 (88.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2554, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4828/5392 (89.5401%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4820/5392 (89.3917%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0635, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4475/5244 (85.3356%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4495/5244 (85.7170%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1158, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3835/4356 (88.0395%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3611/4356 (82.8972%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1458, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3835/4416 (86.8433%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3922/4416 (88.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8690, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3856/4481 (86.0522%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3888/4481 (86.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2551, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3979/4441 (89.5969%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4027/4441 (90.6778%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0470, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3840/4336 (88.5609%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3945/4336 (90.9825%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9907, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3216/3646 (88.2063%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3317/3646 (90.9764%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8243, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4086/4647 (87.9277%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4134/4647 (88.9606%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0227, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3117/3638 (85.6789%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3254/3638 (89.4447%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1280, Accuracy: 5338/10000 (53.3800%)
time spent on training: 263.03984451293945
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.0933, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 7.6284, Accuracy: 276/9900 (2.7879%)
Done in 292.4769661426544 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4454/4885 (91.1771%), train_poison_data_count: 385
Global model norm: 42.4845675105973.
Norm before scaling: 42.48836582487905. Distance: 2.016958697378896
Total norm for 4 adversaries is: 42.48836582487905. distance: 2.016958697378896
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.4463, Accuracy: 8843/9900 (89.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.4845675105973.
Norm before scaling: 42.48519244570321. Distance: 2.087076169234785
Total norm for 4 adversaries is: 42.48519244570321. distance: 2.087076169234785
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0930, Accuracy: 9658/9900 (97.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4270/4717 (90.5236%), train_poison_data_count: 370
Global model norm: 42.4845675105973.
Norm before scaling: 42.4859524118708. Distance: 1.973144954161208
Total norm for 4 adversaries is: 42.4859524118708. distance: 1.973144954161208
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1884, Accuracy: 9449/9900 (95.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4548/5066 (89.7750%), train_poison_data_count: 400
Global model norm: 42.4845675105973.
Norm before scaling: 42.490253363087575. Distance: 2.129175347635846
Total norm for 4 adversaries is: 42.490253363087575. distance: 2.129175347635846
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0801, Accuracy: 9677/9900 (97.7475%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4076/4538 (89.8193%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4153/4538 (91.5161%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9168, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5025/5740 (87.5436%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5131/5740 (89.3902%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1684, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4322/4934 (87.5963%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4188/4934 (84.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2177, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3571/4013 (88.9858%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3674/4013 (91.5525%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8480, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3912/4511 (86.7213%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4006/4511 (88.8051%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9032, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3908/4501 (86.8251%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3922/4501 (87.1362%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0043, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4024/4518 (89.0660%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4143/4518 (91.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0077, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3385/3804 (88.9853%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3461/3804 (90.9832%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9004, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3331/3781 (88.0984%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3295/3781 (87.1463%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2560, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3995/4441 (89.9572%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4017/4441 (90.4526%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0824, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4068/4662 (87.2587%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4191/4662 (89.8970%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1527, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3068/3472 (88.3641%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3162/3472 (91.0714%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9923, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3465/3911 (88.5963%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3509/3911 (89.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0042, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4078/4634 (88.0017%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4111/4634 (88.7139%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9945, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4069/4618 (88.1117%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4085/4618 (88.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1265, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4532/5195 (87.2377%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4455/5195 (85.7555%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2618, Accuracy: 5023/10000 (50.2300%)
time spent on training: 261.6838448047638
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.0931, Accuracy: 7080/10000 (70.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 7.6111, Accuracy: 280/9900 (2.8283%)
Done in 290.9771099090576 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 42.48507751579886.
Norm before scaling: 42.48857555548756. Distance: 2.0478813667657096
Total norm for 4 adversaries is: 42.48857555548756. distance: 2.0478813667657096
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.2147, Accuracy: 9382/9900 (94.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4804/5305 (90.5561%), train_poison_data_count: 415
Global model norm: 42.48507751579886.
Norm before scaling: 42.48806415574997. Distance: 2.0644553192617834
Total norm for 4 adversaries is: 42.48806415574997. distance: 2.0644553192617834
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.2516, Accuracy: 9304/9900 (93.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 42.48507751579886.
Norm before scaling: 42.489911486434046. Distance: 2.008097350105014
Total norm for 4 adversaries is: 42.489911486434046. distance: 2.008097350105014
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0792, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4566/5066 (90.1303%), train_poison_data_count: 400
Global model norm: 42.48507751579886.
Norm before scaling: 42.49146714663354. Distance: 2.112475793462805
Total norm for 4 adversaries is: 42.49146714663354. distance: 2.112475793462805
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0953, Accuracy: 9645/9900 (97.4242%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2872/3271 (87.8019%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0065, Accuracy: 2869/3271 (87.7102%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0906, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4358/4928 (88.4334%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4411/4928 (89.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1017, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4173/4804 (86.8651%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4104/4804 (85.4288%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0964, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4102/4618 (88.8263%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4094/4618 (88.6531%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9616, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3372/3756 (89.7764%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3486/3756 (92.8115%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9278, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4068/4634 (87.7859%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4145/4634 (89.4476%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9539, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3166/3638 (87.0258%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3292/3638 (90.4893%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8442, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3239/3704 (87.4460%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3348/3704 (90.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8801, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4131/4707 (87.7629%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4253/4707 (90.3548%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9564, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3832/4481 (85.5166%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3857/4481 (86.0745%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1957, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3798/4354 (87.2301%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3892/4354 (89.3891%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4756, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3194/3646 (87.6029%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3304/3646 (90.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8199, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3767/4223 (89.2020%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3860/4223 (91.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9508, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3992/4511 (88.4948%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4093/4511 (90.7338%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9200, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3972/4456 (89.1382%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4059/4456 (91.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9696, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3388/3861 (87.7493%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3508/3861 (90.8573%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0251, Accuracy: 5388/10000 (53.8800%)
time spent on training: 258.68778705596924
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.0929, Accuracy: 7081/10000 (70.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 7.5893, Accuracy: 284/9900 (2.8687%)
Done in 287.98175168037415 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 42.48561337382338.
Norm before scaling: 42.49128184937617. Distance: 2.0766516029868822
Total norm for 4 adversaries is: 42.49128184937617. distance: 2.0766516029868822
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1633, Accuracy: 9480/9900 (95.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4828/5305 (91.0085%), train_poison_data_count: 415
Global model norm: 42.48561337382338.
Norm before scaling: 42.48499131816656. Distance: 2.0828347436013335
Total norm for 4 adversaries is: 42.48499131816656. distance: 2.0828347436013335
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2594, Accuracy: 9233/9900 (93.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 42.48561337382338.
Norm before scaling: 42.48835864230563. Distance: 1.979956626513355
Total norm for 4 adversaries is: 42.48835864230563. distance: 1.979956626513355
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2407, Accuracy: 9294/9900 (93.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 42.48561337382338.
Norm before scaling: 42.49350536313608. Distance: 2.163560940015813
Total norm for 4 adversaries is: 42.49350536313608. distance: 2.163560940015813
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1708, Accuracy: 9461/9900 (95.5657%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3289/3804 (86.4616%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3365/3804 (88.4595%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0708, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3905/4501 (86.7585%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3953/4501 (87.8249%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0680, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4135/4663 (88.6768%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4204/4663 (90.1566%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0628, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4838/5591 (86.5319%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4894/5591 (87.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0959, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4457/5244 (84.9924%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4480/5244 (85.4310%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0446, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3963/4433 (89.3977%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4035/4433 (91.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9569, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4113/4707 (87.3805%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4175/4707 (88.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9015, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4010/4456 (89.9910%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4018/4456 (90.1706%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0251, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3868/4356 (88.7971%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3719/4356 (85.3765%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2944, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4052/4576 (88.5490%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4128/4576 (90.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9984, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4203/4679 (89.8269%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4060/4679 (86.7707%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1654, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4109/4634 (88.6707%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4119/4634 (88.8865%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8719, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3544/4013 (88.3130%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3678/4013 (91.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9988, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4527/5232 (86.5252%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4602/5232 (87.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0415, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3645/4126 (88.3422%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3730/4126 (90.4023%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9473, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3357/3756 (89.3770%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3459/3756 (92.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0714, Accuracy: 5393/10000 (53.9300%)
time spent on training: 265.25576734542847
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.0928, Accuracy: 7078/10000 (70.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 7.5714, Accuracy: 287/9900 (2.8990%)
Done in 295.297123670578 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 42.4861722105153.
Norm before scaling: 42.49097301881822. Distance: 2.0511149979542256
Total norm for 4 adversaries is: 42.49097301881822. distance: 2.0511149979542256
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1797, Accuracy: 9447/9900 (95.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 42.4861722105153.
Norm before scaling: 42.487687784595316. Distance: 2.06126852551169
Total norm for 4 adversaries is: 42.487687784595316. distance: 2.06126852551169
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0930, Accuracy: 9654/9900 (97.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 42.4861722105153.
Norm before scaling: 42.488861419512794. Distance: 1.9909324731914508
Total norm for 4 adversaries is: 42.488861419512794. distance: 1.9909324731914508
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.3419, Accuracy: 9029/9900 (91.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4547/5066 (89.7552%), train_poison_data_count: 400
Global model norm: 42.4861722105153.
Norm before scaling: 42.4930960040312. Distance: 2.136450714092782
Total norm for 4 adversaries is: 42.4930960040312. distance: 2.136450714092782
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1808, Accuracy: 9403/9900 (94.9798%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4512/5055 (89.2582%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4488/5055 (88.7834%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9706, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3870/4481 (86.3647%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3826/4481 (85.3827%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2336, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4138/4767 (86.8051%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4136/4767 (86.7632%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1686, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4587/5265 (87.1225%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4572/5265 (86.8376%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0190, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3998/4558 (87.7139%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4056/4558 (88.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0843, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4847/5591 (86.6929%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4846/5591 (86.6750%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1546, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4530/5232 (86.5826%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4617/5232 (88.2454%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1082, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3382/3756 (90.0426%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3481/3756 (92.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9880, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3957/4433 (89.2624%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4005/4433 (90.3451%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8538, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4198/4793 (87.5861%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4300/4793 (89.7142%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0322, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3791/4235 (89.5159%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3843/4235 (90.7438%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8527, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4123/4707 (87.5929%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4182/4707 (88.8464%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9926, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3639/4025 (90.4099%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3696/4025 (91.8261%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0533, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3417/3837 (89.0539%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3541/3837 (92.2856%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8155, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5494/6391 (85.9646%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5488/6391 (85.8708%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2056, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3799/4354 (87.2531%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3628/4354 (83.3257%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4266, Accuracy: 4908/10000 (49.0800%)
time spent on training: 267.00933861732483
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.0926, Accuracy: 7077/10000 (70.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 7.5583, Accuracy: 289/9900 (2.9192%)
Done in 296.72296667099 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4448/4885 (91.0542%), train_poison_data_count: 385
Global model norm: 42.48669656216667.
Norm before scaling: 42.48758291722933. Distance: 2.0432825376327597
Total norm for 4 adversaries is: 42.48758291722933. distance: 2.0432825376327597
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1434, Accuracy: 9526/9900 (96.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4810/5305 (90.6692%), train_poison_data_count: 415
Global model norm: 42.48669656216667.
Norm before scaling: 42.4862612789233. Distance: 2.0684462863143622
Total norm for 4 adversaries is: 42.4862612789233. distance: 2.0684462863143622
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1144, Accuracy: 9600/9900 (96.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4264/4717 (90.3964%), train_poison_data_count: 370
Global model norm: 42.48669656216667.
Norm before scaling: 42.48896197424029. Distance: 1.9785747312131627
Total norm for 4 adversaries is: 42.48896197424029. distance: 1.9785747312131627
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.2582, Accuracy: 9291/9900 (93.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4532/5066 (89.4591%), train_poison_data_count: 400
Global model norm: 42.48669656216667.
Norm before scaling: 42.492383566149975. Distance: 2.134765178265049
Total norm for 4 adversaries is: 42.492383566149975. distance: 2.134765178265049
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1924, Accuracy: 9417/9900 (95.1212%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4825/5424 (88.9565%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4915/5424 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1453, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4079/4576 (89.1390%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4157/4576 (90.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9551, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4306/4934 (87.2720%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4102/4934 (83.1374%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4501, Accuracy: 4670/10000 (46.7000%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4973/5582 (89.0899%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4996/5582 (89.5020%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0582, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4273/4956 (86.2187%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4360/4956 (87.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0474, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5150/5902 (87.2586%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5010/5902 (84.8865%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0841, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2925/3297 (88.7170%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3016/3297 (91.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8361, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3078/3472 (88.6521%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3137/3472 (90.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9734, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4330/4928 (87.8653%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4475/4928 (90.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8811, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3867/4481 (86.2977%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3908/4481 (87.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1112, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4423/5025 (88.0199%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4498/5025 (89.5124%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0517, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4408/4986 (88.4075%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4490/4986 (90.0521%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8396, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4287/4928 (86.9927%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4387/4928 (89.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0344, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4208/4804 (87.5937%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4064/4804 (84.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3037, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3202/3646 (87.8223%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3282/3646 (90.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9248, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4153/4707 (88.2303%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4194/4707 (89.1013%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9669, Accuracy: 5555/10000 (55.5500%)
time spent on training: 266.98064160346985
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.0925, Accuracy: 7077/10000 (70.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 7.5411, Accuracy: 294/9900 (2.9697%)
Done in 296.5714294910431 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4455/4885 (91.1975%), train_poison_data_count: 385
Global model norm: 42.48730566390537.
Norm before scaling: 42.49071446127598. Distance: 1.9762531385209836
Total norm for 4 adversaries is: 42.49071446127598. distance: 1.9762531385209836
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1547, Accuracy: 9511/9900 (96.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4811/5305 (90.6880%), train_poison_data_count: 415
Global model norm: 42.48730566390537.
Norm before scaling: 42.487564242191795. Distance: 2.0607715646896665
Total norm for 4 adversaries is: 42.487564242191795. distance: 2.0607715646896665
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1596, Accuracy: 9490/9900 (95.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 42.48730566390537.
Norm before scaling: 42.48877092005457. Distance: 1.9858392434533148
Total norm for 4 adversaries is: 42.48877092005457. distance: 1.9858392434533148
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1565, Accuracy: 9523/9900 (96.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 42.48730566390537.
Norm before scaling: 42.493014131737. Distance: 2.10817644895082
Total norm for 4 adversaries is: 42.493014131737. distance: 2.10817644895082
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.2283, Accuracy: 9324/9900 (94.1818%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4523/5116 (88.4089%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4530/5116 (88.5457%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0419, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4085/4651 (87.8306%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4109/4651 (88.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1043, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4820/5591 (86.2100%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4904/5591 (87.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4031, Accuracy: 4815/10000 (48.1500%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4186/4804 (87.1357%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4257/4804 (88.6137%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2047, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3998/4456 (89.7217%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4092/4456 (91.8312%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9748, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4326/5063 (85.4434%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4166/5063 (82.2832%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2826, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3721/4223 (88.1127%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3818/4223 (90.4097%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0166, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4342/4934 (88.0016%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4166/4934 (84.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3684, Accuracy: 4860/10000 (48.6000%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3386/3828 (88.4535%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3496/3828 (91.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9788, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5137/5902 (87.0383%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5017/5902 (85.0051%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3071, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3781/4416 (85.6205%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3897/4416 (88.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1780, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4034/4538 (88.8938%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4113/4538 (90.6346%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0553, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4397/5025 (87.5025%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4527/5025 (90.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9387, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3990/4625 (86.2703%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4047/4625 (87.5027%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1626, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4548/5197 (87.5120%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4625/5197 (88.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0863, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3368/3804 (88.5384%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3411/3804 (89.6688%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0704, Accuracy: 5451/10000 (54.5100%)
time spent on training: 269.4731295108795
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.0924, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 7.5216, Accuracy: 299/9900 (3.0202%)
Done in 298.9163191318512 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 42.487726571089766.
Norm before scaling: 42.491859284676515. Distance: 2.0402914852509673
Total norm for 4 adversaries is: 42.491859284676515. distance: 2.0402914852509673
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1730, Accuracy: 9454/9900 (95.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4830/5305 (91.0462%), train_poison_data_count: 415
Global model norm: 42.487726571089766.
Norm before scaling: 42.48571249963407. Distance: 2.0122101711294054
Total norm for 4 adversaries is: 42.48571249963407. distance: 2.0122101711294054
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.3745, Accuracy: 9039/9900 (91.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 42.487726571089766.
Norm before scaling: 42.48776966715319. Distance: 1.9734309422134089
Total norm for 4 adversaries is: 42.48776966715319. distance: 1.9734309422134089
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1345, Accuracy: 9549/9900 (96.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4546/5066 (89.7355%), train_poison_data_count: 400
Global model norm: 42.487726571089766.
Norm before scaling: 42.49271824107779. Distance: 2.155752483965922
Total norm for 4 adversaries is: 42.49271824107779. distance: 2.155752483965922
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1501, Accuracy: 9517/9900 (96.1313%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4176/4804 (86.9276%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4028/4804 (83.8468%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.3062, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3443/3911 (88.0338%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3469/3911 (88.6985%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1625, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3524/4013 (87.8146%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3639/4013 (90.6803%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9644, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4561/5232 (87.1751%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4655/5232 (88.9717%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0908, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4841/5591 (86.5856%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4745/5591 (84.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2909, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3413/3837 (88.9497%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3527/3837 (91.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9336, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4866/5424 (89.7124%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4889/5424 (90.1364%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2353, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4524/5167 (87.5556%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4636/5167 (89.7232%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1760, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4018/4456 (90.1706%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4042/4456 (90.7092%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0970, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4295/4928 (87.1550%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4449/4928 (90.2800%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9508, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3954/4433 (89.1947%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3901/4433 (87.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9237, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2893/3297 (87.7464%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3000/3297 (90.9918%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7944, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4151/4716 (88.0195%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4137/4716 (87.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2390, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4059/4596 (88.3159%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4149/4596 (90.2742%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0577, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4228/4793 (88.2120%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4298/4793 (89.6724%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0274, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3796/4416 (85.9601%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3922/4416 (88.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0129, Accuracy: 5357/10000 (53.5700%)
time spent on training: 265.15980672836304
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.0922, Accuracy: 7077/10000 (70.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 7.5091, Accuracy: 301/9900 (3.0404%)
Done in 294.7112364768982 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 42.48823797489062.
Norm before scaling: 42.48943170531497. Distance: 1.9829779685908329
Total norm for 4 adversaries is: 42.48943170531497. distance: 1.9829779685908329
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.2262, Accuracy: 9326/9900 (94.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 42.48823797489062.
Norm before scaling: 42.48862152370179. Distance: 2.0654719355164937
Total norm for 4 adversaries is: 42.48862152370179. distance: 2.0654719355164937
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1302, Accuracy: 9574/9900 (96.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 42.48823797489062.
Norm before scaling: 42.49033093135719. Distance: 1.9669388811655029
Total norm for 4 adversaries is: 42.49033093135719. distance: 1.9669388811655029
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.2103, Accuracy: 9358/9900 (94.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4541/5066 (89.6368%), train_poison_data_count: 400
Global model norm: 42.48823797489062.
Norm before scaling: 42.491967014274444. Distance: 2.1192475041452057
Total norm for 4 adversaries is: 42.491967014274444. distance: 2.1192475041452057
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1080, Accuracy: 9600/9900 (96.9697%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2866/3271 (87.6185%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2914/3271 (89.0859%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0450, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4504/5116 (88.0375%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4537/5116 (88.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0281, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3900/4501 (86.6474%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4021/4501 (89.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9256, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3899/4356 (89.5087%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3911/4356 (89.7842%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3181, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3818/4368 (87.4084%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3886/4368 (88.9652%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9560, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3440/3837 (89.6534%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3498/3837 (91.1650%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9002, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5053/5740 (88.0314%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5145/5740 (89.6341%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2127, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3206/3590 (89.3036%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3320/3590 (92.4791%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9867, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2926/3297 (88.7473%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2990/3297 (90.6885%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8166, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4037/4716 (85.6022%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4166/4716 (88.3376%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9977, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4454/5055 (88.1108%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4567/5055 (90.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0333, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3407/3911 (87.1133%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3267/3911 (83.5336%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.5196, Accuracy: 4725/10000 (47.2500%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3580/4158 (86.0991%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3672/4158 (88.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0053, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4012/4456 (90.0359%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4132/4456 (92.7289%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9621, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3930/4511 (87.1204%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4018/4511 (89.0712%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1881, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3216/3672 (87.5817%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3285/3672 (89.4608%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0462, Accuracy: 5400/10000 (54.0000%)
time spent on training: 261.63764667510986
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.0921, Accuracy: 7077/10000 (70.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 7.4928, Accuracy: 305/9900 (3.0808%)
Done in 291.4952816963196 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 42.48864881730546.
Norm before scaling: 42.4933502380446. Distance: 2.0333955437362348
Total norm for 4 adversaries is: 42.4933502380446. distance: 2.0333955437362348
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.2871, Accuracy: 9213/9900 (93.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4813/5305 (90.7257%), train_poison_data_count: 415
Global model norm: 42.48864881730546.
Norm before scaling: 42.486127676241274. Distance: 2.0422881471543333
Total norm for 4 adversaries is: 42.486127676241274. distance: 2.0422881471543333
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1914, Accuracy: 9423/9900 (95.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 42.48864881730546.
Norm before scaling: 42.48884418153561. Distance: 1.9561918670499272
Total norm for 4 adversaries is: 42.48884418153561. distance: 1.9561918670499272
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1939, Accuracy: 9358/9900 (94.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 42.48864881730546.
Norm before scaling: 42.498066936736954. Distance: 2.176646747040357
Total norm for 4 adversaries is: 42.498066936736954. distance: 2.176646747040357
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1197, Accuracy: 9585/9900 (96.8182%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4363/5063 (86.1742%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4138/5063 (81.7302%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3018, Accuracy: 4922/10000 (49.2200%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4479/5083 (88.1173%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4462/5083 (87.7828%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1746, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3352/3797 (88.2802%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3415/3797 (89.9394%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0117, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0079, Accuracy: 5195/6124 (84.8302%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5322/6124 (86.9040%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0165, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4581/5232 (87.5573%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4658/5232 (89.0291%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1287, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3385/3861 (87.6716%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3426/3861 (88.7335%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0198, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4372/5037 (86.7977%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4482/5037 (88.9815%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9959, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4471/5116 (87.3925%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4553/5116 (88.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1034, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3828/4368 (87.6374%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3842/4368 (87.9579%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1302, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3198/3672 (87.0915%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3290/3672 (89.5969%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0417, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5112/5902 (86.6147%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4966/5902 (84.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2978, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3804/4361 (87.2277%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3713/4361 (85.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2448, Accuracy: 5012/10000 (50.1200%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3580/4158 (86.0991%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3630/4158 (87.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2238, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4388/5025 (87.3234%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4553/5025 (90.6070%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1085, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4010/4456 (89.9910%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4108/4456 (92.1903%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8931, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3989/4433 (89.9842%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4030/4433 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9231, Accuracy: 5601/10000 (56.0100%)
time spent on training: 269.2947266101837
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.0920, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 7.4788, Accuracy: 309/9900 (3.1212%)
Done in 298.9412786960602 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 42.48914009917343.
Norm before scaling: 42.49278862302329. Distance: 2.050718702543196
Total norm for 4 adversaries is: 42.49278862302329. distance: 2.050718702543196
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.2437, Accuracy: 9285/9900 (93.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4838/5305 (91.1970%), train_poison_data_count: 415
Global model norm: 42.48914009917343.
Norm before scaling: 42.48823941140948. Distance: 2.0074322410920087
Total norm for 4 adversaries is: 42.48823941140948. distance: 2.0074322410920087
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.2276, Accuracy: 9317/9900 (94.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4293/4717 (91.0112%), train_poison_data_count: 370
Global model norm: 42.48914009917343.
Norm before scaling: 42.490363969651256. Distance: 1.9542144178508865
Total norm for 4 adversaries is: 42.490363969651256. distance: 1.9542144178508865
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1548, Accuracy: 9526/9900 (96.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4555/5066 (89.9131%), train_poison_data_count: 400
Global model norm: 42.48914009917343.
Norm before scaling: 42.49297965914487. Distance: 2.1061838383003924
Total norm for 4 adversaries is: 42.49297965914487. distance: 2.1061838383003924
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1203, Accuracy: 9592/9900 (96.8889%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3575/4025 (88.8199%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3709/4025 (92.1491%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8774, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4299/4928 (87.2362%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4362/4928 (88.5146%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0265, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3641/4175 (87.2096%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3675/4175 (88.0240%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9782, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3841/4416 (86.9792%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3971/4416 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0858, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3367/3797 (88.6753%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3406/3797 (89.7024%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9685, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4559/5195 (87.7575%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4537/5195 (87.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0068, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4529/5232 (86.5635%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4604/5232 (87.9969%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0718, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4869/5455 (89.2576%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4869/5455 (89.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9846, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4090/4716 (86.7260%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4174/4716 (88.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1073, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4142/4679 (88.5232%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4225/4679 (90.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9715, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5578/6263 (89.0627%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5638/6263 (90.0208%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3106, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4371/4918 (88.8776%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4472/4918 (90.9313%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0233, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3987/4456 (89.4749%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4057/4456 (91.0458%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8780, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5077/5902 (86.0217%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5124/5902 (86.8180%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2380, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3882/4481 (86.6324%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3958/4481 (88.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2806, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4790/5591 (85.6734%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4892/5591 (87.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0637, Accuracy: 5307/10000 (53.0700%)
time spent on training: 260.83673429489136
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.0918, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 7.4617, Accuracy: 318/9900 (3.2121%)
Done in 290.2779014110565 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 42.48970032595032.
Norm before scaling: 42.489798005760306. Distance: 1.9790017377162434
Total norm for 4 adversaries is: 42.489798005760306. distance: 1.9790017377162434
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1956, Accuracy: 9395/9900 (94.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4823/5305 (90.9142%), train_poison_data_count: 415
Global model norm: 42.48970032595032.
Norm before scaling: 42.48521686826784. Distance: 2.040589794655577
Total norm for 4 adversaries is: 42.48521686826784. distance: 2.040589794655577
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1840, Accuracy: 9446/9900 (95.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 42.48970032595032.
Norm before scaling: 42.489875574861216. Distance: 1.9256506947180834
Total norm for 4 adversaries is: 42.489875574861216. distance: 1.9256506947180834
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.2710, Accuracy: 9240/9900 (93.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4535/5066 (89.5184%), train_poison_data_count: 400
Global model norm: 42.48970032595032.
Norm before scaling: 42.49870890731932. Distance: 2.1141886851790943
Total norm for 4 adversaries is: 42.49870890731932. distance: 2.1141886851790943
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1357, Accuracy: 9555/9900 (96.5152%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3888/4501 (86.3808%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3976/4501 (88.3359%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9383, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4448/5083 (87.5074%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4469/5083 (87.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2526, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3313/3804 (87.0925%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3382/3804 (88.9064%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9816, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3408/3756 (90.7348%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3425/3756 (91.1874%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0389, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3653/4175 (87.4970%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3640/4175 (87.1856%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0140, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4298/4934 (87.1099%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4179/4934 (84.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.4312, Accuracy: 4747/10000 (47.4700%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3866/4336 (89.1605%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3895/4336 (89.8293%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0261, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3883/4356 (89.1414%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3804/4356 (87.3278%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3070, Accuracy: 4951/10000 (49.5100%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4389/5244 (83.6957%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4521/5244 (86.2128%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9628, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4455/5017 (88.7981%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4516/5017 (90.0140%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9252, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3400/3828 (88.8192%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3456/3828 (90.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0167, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4092/4538 (90.1719%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4189/4538 (92.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9471, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3107/3638 (85.4041%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3258/3638 (89.5547%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0143, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4139/4662 (88.7816%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4161/4662 (89.2535%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0779, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3378/3797 (88.9650%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3402/3797 (89.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1032, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4076/4634 (87.9586%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4122/4634 (88.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9478, Accuracy: 5496/10000 (54.9600%)
time spent on training: 263.5346999168396
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.0917, Accuracy: 7077/10000 (70.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 7.4440, Accuracy: 324/9900 (3.2727%)
Done in 292.84352588653564 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 42.49023468922374.
Norm before scaling: 42.49242091198073. Distance: 2.0131840082501697
Total norm for 4 adversaries is: 42.49242091198073. distance: 2.0131840082501697
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0662, Accuracy: 9723/9900 (98.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 42.49023468922374.
Norm before scaling: 42.488657436334556. Distance: 2.055624512498101
Total norm for 4 adversaries is: 42.488657436334556. distance: 2.055624512498101
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.1988, Accuracy: 9410/9900 (95.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 42.49023468922374.
Norm before scaling: 42.493414873568206. Distance: 1.9879298770902427
Total norm for 4 adversaries is: 42.493414873568206. distance: 1.9879298770902427
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.2986, Accuracy: 9131/9900 (92.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4564/5066 (90.0908%), train_poison_data_count: 400
Global model norm: 42.49023468922374.
Norm before scaling: 42.49271967744519. Distance: 2.070130192629153
Total norm for 4 adversaries is: 42.49271967744519. distance: 2.070130192629153
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.1399, Accuracy: 9545/9900 (96.4141%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3662/4175 (87.7126%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3707/4175 (88.7904%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0441, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3967/4465 (88.8466%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4094/4465 (91.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0669, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4357/4918 (88.5929%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4393/4918 (89.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0407, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4369/5037 (86.7381%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4562/5037 (90.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9493, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3325/3781 (87.9397%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3202/3781 (84.6866%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2347, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4075/4634 (87.9370%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4213/4634 (90.9150%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9245, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4055/4576 (88.6145%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4150/4576 (90.6906%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0204, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3409/3861 (88.2932%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3447/3861 (89.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0212, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5302/6124 (86.5774%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5240/6124 (85.5650%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0895, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3747/4223 (88.7284%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3843/4223 (91.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0775, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4454/5083 (87.6254%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4464/5083 (87.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2324, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3915/4356 (89.8760%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3680/4356 (84.4812%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.6881, Accuracy: 4391/10000 (43.9100%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4197/4793 (87.5652%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4305/4793 (89.8185%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0422, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4419/5055 (87.4184%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4550/5055 (90.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9172, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3924/4362 (89.9587%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3951/4362 (90.5777%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9767, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3942/4433 (88.9240%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4038/4433 (91.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9009, Accuracy: 5654/10000 (56.5400%)
time spent on training: 267.2668182849884
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.0916, Accuracy: 7077/10000 (70.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 7.4323, Accuracy: 327/9900 (3.3030%)
Done in 297.3037827014923 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 42.49072020701623.
Norm before scaling: 42.494591222920654. Distance: 2.0051077945490188
Total norm for 4 adversaries is: 42.494591222920654. distance: 2.0051077945490188
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.2489, Accuracy: 9304/9900 (93.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4810/5305 (90.6692%), train_poison_data_count: 415
Global model norm: 42.49072020701623.
Norm before scaling: 42.48947623612596. Distance: 2.0548889293494406
Total norm for 4 adversaries is: 42.48947623612596. distance: 2.0548889293494406
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1823, Accuracy: 9442/9900 (95.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 42.49072020701623.
Norm before scaling: 42.49263924079602. Distance: 1.9428513366047466
Total norm for 4 adversaries is: 42.49263924079602. distance: 1.9428513366047466
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1803, Accuracy: 9422/9900 (95.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 42.49072020701623.
Norm before scaling: 42.49929055014478. Distance: 2.1598804152905577
Total norm for 4 adversaries is: 42.49929055014478. distance: 2.1598804152905577
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1866, Accuracy: 9426/9900 (95.2121%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4424/5025 (88.0398%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4580/5025 (91.1443%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1576, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4004/4441 (90.1599%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4074/4441 (91.7361%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9876, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4858/5591 (86.8896%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4902/5591 (87.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0634, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3871/4481 (86.3870%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3906/4481 (87.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1807, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4130/4767 (86.6373%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4189/4767 (87.8750%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1652, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4480/5055 (88.6251%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4528/5055 (89.5747%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0246, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4016/4518 (88.8889%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4071/4518 (90.1062%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1262, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3950/4625 (85.4054%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3958/4625 (85.5784%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2824, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4185/4793 (87.3148%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4311/4793 (89.9437%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0074, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4484/5083 (88.2156%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4489/5083 (88.3140%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9431, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4432/5244 (84.5156%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4517/5244 (86.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0362, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5598/6263 (89.3821%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5560/6263 (88.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0714, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3680/4175 (88.1437%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3695/4175 (88.5030%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0427, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3837/4416 (86.8886%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3952/4416 (89.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0385, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4573/5265 (86.8566%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4556/5265 (86.5337%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1548, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3581/4025 (88.9689%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3693/4025 (91.7516%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8660, Accuracy: 5601/10000 (56.0100%)
time spent on training: 270.99048352241516
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.0915, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 7.4171, Accuracy: 328/9900 (3.3131%)
Done in 300.34738278388977 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 42.49122582911603.
Norm before scaling: 42.49288485937234. Distance: 2.0115519926713232
Total norm for 4 adversaries is: 42.49288485937234. distance: 2.0115519926713232
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1977, Accuracy: 9428/9900 (95.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4826/5305 (90.9708%), train_poison_data_count: 415
Global model norm: 42.49122582911603.
Norm before scaling: 42.492991150012024. Distance: 2.082798800240954
Total norm for 4 adversaries is: 42.492991150012024. distance: 2.082798800240954
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1017, Accuracy: 9651/9900 (97.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.49122582911603.
Norm before scaling: 42.49366048766127. Distance: 2.0019256143307924
Total norm for 4 adversaries is: 42.49366048766127. distance: 2.0019256143307924
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0682, Accuracy: 9708/9900 (98.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4539/5066 (89.5973%), train_poison_data_count: 400
Global model norm: 42.49122582911603.
Norm before scaling: 42.50096649866109. Distance: 2.1679245403009224
Total norm for 4 adversaries is: 42.50096649866109. distance: 2.1679245403009224
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.2055, Accuracy: 9349/9900 (94.4343%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3741/4295 (87.1013%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3738/4295 (87.0314%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1455, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3733/4223 (88.3969%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3865/4223 (91.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9055, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4232/4793 (88.2954%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4259/4793 (88.8588%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0817, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4131/4707 (87.7629%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4206/4707 (89.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9774, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4857/5455 (89.0376%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4792/5455 (87.8460%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1722, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4080/4651 (87.7231%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4149/4651 (89.2066%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3569, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3412/3837 (88.9236%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3557/3837 (92.7026%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9953, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4044/4441 (91.0606%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4016/4441 (90.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1111, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3164/3638 (86.9709%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3295/3638 (90.5717%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9364, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3782/4235 (89.3034%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3876/4235 (91.5230%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0053, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3878/4362 (88.9042%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3885/4362 (89.0646%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0722, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3398/3797 (89.4917%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3395/3797 (89.4127%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9578, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3592/4158 (86.3877%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3634/4158 (87.3978%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0395, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3681/4126 (89.2147%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3750/4126 (90.8871%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8953, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4549/5195 (87.5650%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4475/5195 (86.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1393, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3639/4046 (89.9407%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3690/4046 (91.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0332, Accuracy: 5369/10000 (53.6900%)
time spent on training: 260.27687549591064
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.0914, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 7.4014, Accuracy: 332/9900 (3.3535%)
Done in 289.93657755851746 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4404/4885 (90.1535%), train_poison_data_count: 385
Global model norm: 42.49159067768954.
Norm before scaling: 42.49341774625586. Distance: 2.0071084535924864
Total norm for 4 adversaries is: 42.49341774625586. distance: 2.0071084535924864
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1722, Accuracy: 9476/9900 (95.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 42.49159067768954.
Norm before scaling: 42.49037833411892. Distance: 2.045425251067033
Total norm for 4 adversaries is: 42.49037833411892. distance: 2.045425251067033
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1619, Accuracy: 9476/9900 (95.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.49159067768954.
Norm before scaling: 42.49200005129642. Distance: 1.9896465777452779
Total norm for 4 adversaries is: 42.49200005129642. distance: 1.9896465777452779
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1541, Accuracy: 9495/9900 (95.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 42.49159067768954.
Norm before scaling: 42.49742926508173. Distance: 2.10113611823835
Total norm for 4 adversaries is: 42.49742926508173. distance: 2.10113611823835
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0998, Accuracy: 9637/9900 (97.3434%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3828/4361 (87.7780%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3655/4361 (83.8111%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0248, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2901/3297 (87.9891%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3014/3297 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.7993, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4090/4716 (86.7260%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4181/4716 (88.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0499, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4538/5167 (87.8266%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4659/5167 (90.1684%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1172, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3789/4368 (86.7445%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3817/4368 (87.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1259, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4152/4679 (88.7369%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4212/4679 (90.0192%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1829, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3848/4356 (88.3379%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3904/4356 (89.6235%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3277, Accuracy: 4961/10000 (49.6100%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5065/5902 (85.8184%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4995/5902 (84.6323%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1325, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3411/3861 (88.3450%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3461/3861 (89.6400%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0627, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3871/4356 (88.8659%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3844/4356 (88.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1235, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5546/6263 (88.5518%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5612/6263 (89.6056%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1732, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3763/4235 (88.8548%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3835/4235 (90.5549%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9812, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4492/5232 (85.8563%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4637/5232 (88.6277%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1798, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4454/5017 (88.7782%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4509/5017 (89.8744%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8694, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4198/4804 (87.3855%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0125, Accuracy: 3696/4804 (76.9359%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.5602, Accuracy: 4572/10000 (45.7200%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4184/4793 (87.2940%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4311/4793 (89.9437%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9227, Accuracy: 5533/10000 (55.3300%)
time spent on training: 268.22738909721375
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.0913, Accuracy: 7077/10000 (70.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 7.3875, Accuracy: 336/9900 (3.3939%)
Done in 297.64433908462524 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 42.49204314302561.
Norm before scaling: 42.49591116590292. Distance: 2.0428673334277203
Total norm for 4 adversaries is: 42.49591116590292. distance: 2.0428673334277203
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.2024, Accuracy: 9383/9900 (94.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 42.49204314302561.
Norm before scaling: 42.493930517891314. Distance: 2.067527538886473
Total norm for 4 adversaries is: 42.493930517891314. distance: 2.067527538886473
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.2142, Accuracy: 9366/9900 (94.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4265/4717 (90.4176%), train_poison_data_count: 370
Global model norm: 42.49204314302561.
Norm before scaling: 42.49497615068015. Distance: 1.970997632405075
Total norm for 4 adversaries is: 42.49497615068015. distance: 1.970997632405075
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1444, Accuracy: 9531/9900 (96.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 42.49204314302561.
Norm before scaling: 42.49694813261227. Distance: 2.089032224151873
Total norm for 4 adversaries is: 42.49694813261227. distance: 2.089032224151873
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.3436, Accuracy: 9093/9900 (91.8485%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3373/3837 (87.9072%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3530/3837 (91.9990%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8533, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3385/3861 (87.6716%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3441/3861 (89.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9829, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3656/4175 (87.5689%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3689/4175 (88.3593%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9814, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3947/4441 (88.8764%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4041/4441 (90.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1523, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3853/4336 (88.8607%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3926/4336 (90.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0471, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3641/4046 (89.9901%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3711/4046 (91.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9344, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4308/4956 (86.9249%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4370/4956 (88.1759%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2644, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4102/4618 (88.8263%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4151/4618 (89.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0352, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3206/3616 (88.6615%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3298/3616 (91.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9497, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4116/4576 (89.9476%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4169/4576 (91.1058%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8683, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3748/4223 (88.7521%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3861/4223 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1236, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3954/4503 (87.8081%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4030/4503 (89.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0078, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3239/3590 (90.2228%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3273/3590 (91.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0297, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4158/4707 (88.3365%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4242/4707 (90.1211%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9847, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3566/4013 (88.8612%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3666/4013 (91.3531%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8600, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3226/3704 (87.0950%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3324/3704 (89.7408%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9446, Accuracy: 5495/10000 (54.9500%)
time spent on training: 259.4599254131317
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.0912, Accuracy: 7080/10000 (70.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 7.3744, Accuracy: 339/9900 (3.4242%)
Done in 288.8431429862976 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4434/4885 (90.7677%), train_poison_data_count: 385
Global model norm: 42.492474057914066.
Norm before scaling: 42.49553342797481. Distance: 2.018604176453995
Total norm for 4 adversaries is: 42.49553342797481. distance: 2.018604176453995
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.2181, Accuracy: 9354/9900 (94.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4805/5305 (90.5749%), train_poison_data_count: 415
Global model norm: 42.492474057914066.
Norm before scaling: 42.492775695735915. Distance: 2.0818343937262664
Total norm for 4 adversaries is: 42.492775695735915. distance: 2.0818343937262664
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1912, Accuracy: 9426/9900 (95.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 42.492474057914066.
Norm before scaling: 42.490748935705845. Distance: 1.9353635144882422
Total norm for 4 adversaries is: 42.490748935705845. distance: 1.9353635144882422
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1121, Accuracy: 9596/9900 (96.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 42.492474057914066.
Norm before scaling: 42.498716088143475. Distance: 2.104637194105206
Total norm for 4 adversaries is: 42.498716088143475. distance: 2.104637194105206
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.2253, Accuracy: 9333/9900 (94.2727%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4098/4596 (89.1645%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4198/4596 (91.3403%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9859, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3855/4356 (88.4986%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3816/4356 (87.6033%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3394, Accuracy: 4864/10000 (48.6400%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3781/4295 (88.0326%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3783/4295 (88.0792%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9755, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4064/4634 (87.6996%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4153/4634 (89.6202%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0630, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4127/4767 (86.5744%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4178/4767 (87.6442%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0855, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3742/4223 (88.6100%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3805/4223 (90.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8970, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3659/4046 (90.4350%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3675/4046 (90.8304%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8860, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4391/5083 (86.3860%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4403/5083 (86.6221%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2370, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3894/4362 (89.2710%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4049/4362 (92.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9222, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4142/4663 (88.8269%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4269/4663 (91.5505%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9653, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2948/3297 (89.4146%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3018/3297 (91.5378%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8748, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3994/4433 (90.0970%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4014/4433 (90.5482%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9828, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4558/5265 (86.5717%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4536/5265 (86.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9938, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4413/4986 (88.5078%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4470/4986 (89.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8560, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4077/4647 (87.7340%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4116/4647 (88.5733%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0267, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4453/5017 (88.7582%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4503/5017 (89.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9617, Accuracy: 5548/10000 (55.4800%)
time spent on training: 264.11898708343506
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.0910, Accuracy: 7081/10000 (70.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 7.3594, Accuracy: 344/9900 (3.4747%)
Done in 293.4316635131836 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 42.4930213135235.
Norm before scaling: 42.49635927650523. Distance: 2.011434294209452
Total norm for 4 adversaries is: 42.49635927650523. distance: 2.011434294209452
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.2598, Accuracy: 9249/9900 (93.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4818/5305 (90.8200%), train_poison_data_count: 415
Global model norm: 42.4930213135235.
Norm before scaling: 42.492257164633095. Distance: 2.064396997300514
Total norm for 4 adversaries is: 42.492257164633095. distance: 2.064396997300514
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1593, Accuracy: 9517/9900 (96.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4245/4717 (89.9936%), train_poison_data_count: 370
Global model norm: 42.4930213135235.
Norm before scaling: 42.49501923939145. Distance: 2.0033260345749175
Total norm for 4 adversaries is: 42.49501923939145. distance: 2.0033260345749175
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1347, Accuracy: 9574/9900 (96.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4541/5066 (89.6368%), train_poison_data_count: 400
Global model norm: 42.4930213135235.
Norm before scaling: 42.498797949453085. Distance: 2.120799906628987
Total norm for 4 adversaries is: 42.498797949453085. distance: 2.120799906628987
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.4133, Accuracy: 8923/9900 (90.1313%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3728/4184 (89.1013%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3765/4184 (89.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9276, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5491/6391 (85.9177%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5584/6391 (87.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2147, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4270/4934 (86.5424%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4164/4934 (84.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2854, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4127/4618 (89.3677%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4162/4618 (90.1256%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0796, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3789/4235 (89.4687%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3867/4235 (91.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0430, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4001/4465 (89.6081%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4138/4465 (92.6764%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8298, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3950/4503 (87.7193%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3989/4503 (88.5854%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0182, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4410/5025 (87.7612%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4496/5025 (89.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1340, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5038/5582 (90.2544%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4995/5582 (89.4841%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2117, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3347/3804 (87.9863%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3448/3804 (90.6414%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1549, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3572/4158 (85.9067%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3638/4158 (87.4940%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0437, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4075/4538 (89.7973%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4165/4538 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9923, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3826/4368 (87.5916%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3798/4368 (86.9505%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0779, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4428/5083 (87.1139%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4493/5083 (88.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1686, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4482/5116 (87.6075%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4558/5116 (89.0930%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8329, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3923/4356 (90.0597%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3912/4356 (89.8072%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2590, Accuracy: 4987/10000 (49.8700%)
time spent on training: 264.5348947048187
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.0909, Accuracy: 7080/10000 (70.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 7.3462, Accuracy: 347/9900 (3.5051%)
Done in 294.3150243759155 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 42.493443600436024.
Norm before scaling: 42.49469463669112. Distance: 2.014755771309188
Total norm for 4 adversaries is: 42.49469463669112. distance: 2.014755771309188
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1666, Accuracy: 9468/9900 (95.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 42.493443600436024.
Norm before scaling: 42.489839663258024. Distance: 2.0084787888569013
Total norm for 4 adversaries is: 42.489839663258024. distance: 2.0084787888569013
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.2951, Accuracy: 9204/9900 (92.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 42.493443600436024.
Norm before scaling: 42.49314340370838. Distance: 1.9673509622277594
Total norm for 4 adversaries is: 42.49314340370838. distance: 1.9673509622277594
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1149, Accuracy: 9578/9900 (96.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 42.493443600436024.
Norm before scaling: 42.500417909250466. Distance: 2.1721670928597963
Total norm for 4 adversaries is: 42.500417909250466. distance: 2.1721670928597963
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0650, Accuracy: 9730/9900 (98.2828%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5502/6263 (87.8493%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5632/6263 (89.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1545, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3956/4433 (89.2398%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4001/4433 (90.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0482, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3207/3672 (87.3366%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3263/3672 (88.8617%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0296, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4830/5455 (88.5426%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4850/5455 (88.9093%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0939, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4457/5025 (88.6965%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4518/5025 (89.9104%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1189, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4147/4618 (89.8008%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4074/4618 (88.2200%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0626, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4120/4707 (87.5292%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4205/4707 (89.3350%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9370, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3920/4362 (89.8670%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3892/4362 (89.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9946, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4321/4989 (86.6105%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4458/4989 (89.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1128, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4415/5083 (86.8582%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4426/5083 (87.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2136, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4089/4647 (87.9923%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4164/4647 (89.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9520, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3813/4368 (87.2940%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3838/4368 (87.8663%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0235, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3802/4354 (87.3220%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3682/4354 (84.5659%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3465, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4123/4767 (86.4905%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4157/4767 (87.2037%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0771, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4140/4662 (88.8031%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4199/4662 (90.0686%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9441, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4221/4804 (87.8643%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4297/4804 (89.4463%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0693, Accuracy: 5456/10000 (54.5600%)
time spent on training: 261.04643416404724
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.0909, Accuracy: 7079/10000 (70.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 7.3360, Accuracy: 349/9900 (3.5253%)
Done in 290.7058982849121 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 42.49386013783712.
Norm before scaling: 42.49878789631829. Distance: 2.038939841370337
Total norm for 4 adversaries is: 42.49878789631829. distance: 2.038939841370337
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.1403, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 42.49386013783712.
Norm before scaling: 42.493980789287235. Distance: 2.021062805151221
Total norm for 4 adversaries is: 42.493980789287235. distance: 2.021062805151221
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.3276, Accuracy: 9115/9900 (92.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4249/4717 (90.0784%), train_poison_data_count: 370
Global model norm: 42.49386013783712.
Norm before scaling: 42.49572157922562. Distance: 1.9542185659233868
Total norm for 4 adversaries is: 42.49572157922562. distance: 1.9542185659233868
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0769, Accuracy: 9694/9900 (97.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4545/5066 (89.7158%), train_poison_data_count: 400
Global model norm: 42.49386013783712.
Norm before scaling: 42.50048253402542. Distance: 2.1086602024208836
Total norm for 4 adversaries is: 42.50048253402542. distance: 2.1086602024208836
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.2026, Accuracy: 9390/9900 (94.8485%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3750/4235 (88.5478%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3783/4235 (89.3270%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8982, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3372/3775 (89.3245%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3494/3775 (92.5563%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9208, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4318/4874 (88.5925%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4212/4874 (86.4177%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3111, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4546/5265 (86.3438%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4484/5265 (85.1662%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0359, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4468/5083 (87.9008%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4442/5083 (87.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3459, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3936/4511 (87.2534%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4060/4511 (90.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9247, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4077/4538 (89.8413%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4156/4538 (91.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8940, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4092/4716 (86.7684%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4183/4716 (88.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1205, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4157/4663 (89.1486%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4268/4663 (91.5291%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0107, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3993/4441 (89.9122%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4007/4441 (90.2274%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0787, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4233/4793 (88.3163%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4350/4793 (90.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0387, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4147/4662 (88.9532%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4268/4662 (91.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9078, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3236/3704 (87.3650%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3380/3704 (91.2527%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8561, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4364/4989 (87.4724%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4397/4989 (88.1339%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1257, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3905/4346 (89.8527%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3970/4346 (91.3484%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9792, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3920/4362 (89.8670%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3947/4362 (90.4860%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0119, Accuracy: 5440/10000 (54.4000%)
time spent on training: 264.2961537837982
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.0907, Accuracy: 7084/10000 (70.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 7.3159, Accuracy: 353/9900 (3.5657%)
Done in 294.20526909828186 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 42.49441312083713.
Norm before scaling: 42.49762171654433. Distance: 2.034554595754729
Total norm for 4 adversaries is: 42.49762171654433. distance: 2.034554595754729
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1046, Accuracy: 9625/9900 (97.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4808/5305 (90.6315%), train_poison_data_count: 415
Global model norm: 42.49441312083713.
Norm before scaling: 42.49701994377444. Distance: 2.063964439448003
Total norm for 4 adversaries is: 42.49701994377444. distance: 2.063964439448003
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.3076, Accuracy: 9210/9900 (93.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4255/4717 (90.2056%), train_poison_data_count: 370
Global model norm: 42.49441312083713.
Norm before scaling: 42.4930960040312. Distance: 1.9045584005113239
Total norm for 4 adversaries is: 42.4930960040312. distance: 1.9045584005113239
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.3052, Accuracy: 9153/9900 (92.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4575/5066 (90.3079%), train_poison_data_count: 400
Global model norm: 42.49441312083713.
Norm before scaling: 42.50107707734446. Distance: 2.105710611977934
Total norm for 4 adversaries is: 42.50107707734446. distance: 2.105710611977934
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1836, Accuracy: 9442/9900 (95.3737%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3506/3969 (88.3346%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3567/3969 (89.8715%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9160, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4016/4558 (88.1088%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4027/4558 (88.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1469, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4352/4918 (88.4913%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4416/4918 (89.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1864, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5113/5902 (86.6317%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5099/5902 (86.3944%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1807, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4565/5265 (86.7047%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4598/5265 (87.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2772, Accuracy: 4917/10000 (49.1700%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3931/4511 (87.1425%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4056/4511 (89.9135%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0850, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4008/4625 (86.6595%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4051/4625 (87.5892%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1496, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3867/4416 (87.5679%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3995/4416 (90.4665%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0662, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2945/3297 (89.3236%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3021/3297 (91.6288%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8843, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4473/5025 (89.0149%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4581/5025 (91.1642%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0072, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3995/4441 (89.9572%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4083/4441 (91.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0633, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3872/4481 (86.4093%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3893/4481 (86.8779%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1163, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3379/3797 (88.9913%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3436/3797 (90.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9025, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3218/3646 (88.2611%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3301/3646 (90.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8877, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3611/4025 (89.7143%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3691/4025 (91.7019%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8404, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4347/4928 (88.2102%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4344/4928 (88.1494%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0428, Accuracy: 5376/10000 (53.7600%)
time spent on training: 264.66555404663086
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.0906, Accuracy: 7084/10000 (70.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 7.3037, Accuracy: 357/9900 (3.6061%)
Done in 294.17779564857483 sec.
Saving all the graphs.
This run has a label: Dec.03_22.59.40. Visdom environment: cifar100_CerP
