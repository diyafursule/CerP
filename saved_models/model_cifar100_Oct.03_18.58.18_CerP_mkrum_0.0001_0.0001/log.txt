current path: saved_models/model_cifar100_Oct.03_18.58.18_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 85, 4, 97, 76, 38, 94, 86, 10, 29, 34, 7, 18, 6, 22, 69, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4744/5308 (89.3745%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.439063334146375. Distance: 2.281939572141862
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5618, Accuracy: 8591/9900 (86.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5301/5777 (91.7604%), train_poison_data_count: 455
Global model norm: 42.432124970265015.
Norm before scaling: 42.429629240661534. Distance: 2.1737316072463493
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5799, Accuracy: 8566/9900 (86.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4579/5123 (89.3812%), train_poison_data_count: 403
Global model norm: 42.432124970265015.
Norm before scaling: 42.43915537778394. Distance: 2.2640164683251878
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4746, Accuracy: 8747/9900 (88.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4937/5503 (89.7147%), train_poison_data_count: 430
Global model norm: 42.432124970265015.
Norm before scaling: 42.439310700969656. Distance: 2.305647310731712
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5429, Accuracy: 8582/9900 (86.6869%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 6156/6947 (88.6138%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   2,  Average loss: 0.0056, Accuracy: 6194/6947 (89.1608%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9929, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3576/4028 (88.7786%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3693/4028 (91.6832%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9169, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4116/4736 (86.9088%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4258/4736 (89.9071%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9493, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3449/3959 (87.1180%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3568/3959 (90.1238%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8935, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5466/6235 (87.6664%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5435/6235 (87.1692%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1952, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4540/5224 (86.9066%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4738/5224 (90.6968%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9589, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3458/3929 (88.0122%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3569/3929 (90.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9059, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4570/5068 (90.1736%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4670/5068 (92.1468%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9951, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4302/4732 (90.9129%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4409/4732 (93.1741%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7482, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4430/4911 (90.2057%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4513/4911 (91.8957%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9329, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4287/4869 (88.0468%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4037/4869 (82.9123%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2223, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3753/4249 (88.3267%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3845/4249 (90.4919%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0110, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4415/4929 (89.5719%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4483/4929 (90.9515%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9893, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5124/5696 (89.9579%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5127/5696 (90.0105%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0787, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3912/4364 (89.6425%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3902/4364 (89.4134%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0163, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4529/5035 (89.9503%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4650/5035 (92.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0438, Accuracy: 5363/10000 (53.6300%)
time spent on training: 241.35765051841736
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1050, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.8490, Accuracy: 137/9900 (1.3838%)
Done in 268.2508203983307 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 47, 10, 95, 98, 64, 57, 27, 85, 93, 6, 74, 54, 88, 45, 51, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4868/5308 (91.7106%), train_poison_data_count: 415
Global model norm: 42.4531983229952.
Norm before scaling: 42.45543389470304. Distance: 2.0682919412918577
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2209, Accuracy: 9340/9900 (94.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5371/5777 (92.9721%), train_poison_data_count: 455
Global model norm: 42.4531983229952.
Norm before scaling: 42.444858817518316. Distance: 1.9880331967650389
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2277, Accuracy: 9334/9900 (94.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4604/5123 (89.8692%), train_poison_data_count: 403
Global model norm: 42.4531983229952.
Norm before scaling: 42.457406275657604. Distance: 2.149139289676657
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1161, Accuracy: 9593/9900 (96.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5041/5503 (91.6046%), train_poison_data_count: 430
Global model norm: 42.4531983229952.
Norm before scaling: 42.45570991854335. Distance: 2.1037709710746966
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2983, Accuracy: 9155/9900 (92.4747%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4484/5123 (87.5268%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4237/5123 (82.7054%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0817, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4537/5068 (89.5225%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4606/5068 (90.8840%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0641, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4345/5018 (86.5883%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4436/5018 (88.4018%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1932, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3755/4161 (90.2427%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3806/4161 (91.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0097, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4305/4894 (87.9649%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4312/4894 (88.1079%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9590, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4417/4956 (89.1243%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4568/4956 (92.1711%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0975, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4095/4587 (89.2740%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4173/4587 (90.9745%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9763, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6185/6947 (89.0312%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6171/6947 (88.8297%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2379, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4492/5055 (88.8625%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4605/5055 (91.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0023, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4421/4929 (89.6936%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4425/4929 (89.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2991, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4229/4797 (88.1593%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4274/4797 (89.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9999, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4880/5645 (86.4482%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4923/5645 (87.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3004, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4840/5362 (90.2648%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4878/5362 (90.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9532, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4781/5489 (87.1015%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4874/5489 (88.7958%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1335, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3682/4108 (89.6300%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3816/4108 (92.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9413, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3721/4130 (90.0969%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3795/4130 (91.8886%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9906, Accuracy: 5553/10000 (55.5300%)
time spent on training: 246.28791332244873
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0970, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.5037, Accuracy: 334/9900 (3.3737%)
Done in 273.14172744750977 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 31, 47, 14, 73, 99, 60, 81, 39, 40, 78, 27, 59, 7, 22, 83, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4889/5308 (92.1063%), train_poison_data_count: 415
Global model norm: 42.47619393002685.
Norm before scaling: 42.47553868662233. Distance: 1.980037785275517
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3023, Accuracy: 9146/9900 (92.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5400/5777 (93.4741%), train_poison_data_count: 455
Global model norm: 42.47619393002685.
Norm before scaling: 42.469380916487204. Distance: 1.9571140294641909
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3108, Accuracy: 9099/9900 (91.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4682/5123 (91.3918%), train_poison_data_count: 403
Global model norm: 42.47619393002685.
Norm before scaling: 42.47425547234098. Distance: 1.9673136360869776
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2868, Accuracy: 9206/9900 (92.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5016/5503 (91.1503%), train_poison_data_count: 430
Global model norm: 42.47619393002685.
Norm before scaling: 42.47541079802451. Distance: 2.0822110268450076
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1112, Accuracy: 9623/9900 (97.2020%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4087/4537 (90.0816%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4180/4537 (92.1314%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8639, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4543/5123 (88.6785%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4440/5123 (86.6680%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1350, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3847/4196 (91.6826%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3957/4196 (94.3041%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8214, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4132/4605 (89.7286%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4265/4605 (92.6167%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8828, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4332/4851 (89.3012%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4418/4851 (91.0740%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8742, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3671/4145 (88.5645%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3762/4145 (90.7600%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0550, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4551/5035 (90.3873%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4660/5035 (92.5521%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9641, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3687/4175 (88.3114%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3764/4175 (90.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0443, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5440/5939 (91.5979%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5512/5939 (92.8102%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0073, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3993/4368 (91.4148%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4074/4368 (93.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0033, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4005/4587 (87.3120%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4122/4587 (89.8627%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0638, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4129/4397 (93.9049%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4188/4397 (95.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7377, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4287/4869 (88.0468%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4197/4869 (86.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1623, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5167/5696 (90.7128%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5130/5696 (90.0632%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1184, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3171/3552 (89.2736%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3269/3552 (92.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8294, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4167/4736 (87.9856%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4286/4736 (90.4983%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9686, Accuracy: 5491/10000 (54.9100%)
time spent on training: 240.86690616607666
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0911, Accuracy: 7094/10000 (70.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.4449, Accuracy: 647/9900 (6.5354%)
Done in 267.50252389907837 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 10, 76, 15, 42, 57, 17, 9, 3, 70, 8, 65, 33, 59, 52, 69, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4910/5308 (92.5019%), train_poison_data_count: 415
Global model norm: 42.496020321484956.
Norm before scaling: 42.49677578532797. Distance: 1.9531062621171476
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1129, Accuracy: 9625/9900 (97.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5405/5777 (93.5607%), train_poison_data_count: 455
Global model norm: 42.496020321484956.
Norm before scaling: 42.48638195195241. Distance: 1.9368773044253658
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1370, Accuracy: 9541/9900 (96.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4630/5123 (90.3767%), train_poison_data_count: 403
Global model norm: 42.496020321484956.
Norm before scaling: 42.4996294790834. Distance: 2.064991804018913
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1605, Accuracy: 9464/9900 (95.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5060/5503 (91.9498%), train_poison_data_count: 430
Global model norm: 42.496020321484956.
Norm before scaling: 42.49744075474575. Distance: 2.007706813776715
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2013, Accuracy: 9384/9900 (94.7879%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4635/5068 (91.4562%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4571/5068 (90.1934%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1331, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3478/3959 (87.8505%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3590/3959 (90.6795%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8884, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5484/6068 (90.3757%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5497/6068 (90.5900%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0006, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5324/5907 (90.1304%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5340/5907 (90.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2397, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4519/4956 (91.1824%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4552/4956 (91.8483%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0066, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4235/4903 (86.3757%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4414/4903 (90.0265%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2332, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5001/5727 (87.3232%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5131/5727 (89.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9953, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4893/5346 (91.5264%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4971/5346 (92.9854%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1462, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5377/5871 (91.5858%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5369/5871 (91.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9773, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4340/4889 (88.7707%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4392/4889 (89.8343%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1854, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4845/5497 (88.1390%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4924/5497 (89.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0008, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4249/4818 (88.1901%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4290/4818 (89.0411%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9194, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4125/4397 (93.8140%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4201/4397 (95.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8560, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3724/4130 (90.1695%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3802/4130 (92.0581%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8911, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3982/4364 (91.2466%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3954/4364 (90.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0349, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4857/5702 (85.1806%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4604/5702 (80.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1750, Accuracy: 4949/10000 (49.4900%)
time spent on training: 247.98682832717896
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0921, Accuracy: 7078/10000 (70.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 5.5646, Accuracy: 1108/9900 (11.1919%)
Done in 274.372882604599 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 57, 60, 74, 72, 70, 14, 43, 88, 9, 80, 22, 73, 66, 82, 56, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4921/5308 (92.7091%), train_poison_data_count: 415
Global model norm: 42.518569300384065.
Norm before scaling: 42.51264747475156. Distance: 1.8773321906220868
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2164, Accuracy: 9378/9900 (94.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5440/5777 (94.1665%), train_poison_data_count: 455
Global model norm: 42.518569300384065.
Norm before scaling: 42.50643190070989. Distance: 1.8255697797960342
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2100, Accuracy: 9400/9900 (94.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4656/5123 (90.8842%), train_poison_data_count: 403
Global model norm: 42.518569300384065.
Norm before scaling: 42.5195526024866. Distance: 1.990396330198971
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1680, Accuracy: 9493/9900 (95.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5108/5503 (92.8221%), train_poison_data_count: 430
Global model norm: 42.518569300384065.
Norm before scaling: 42.5162064114049. Distance: 1.9386575993864135
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1019, Accuracy: 9621/9900 (97.1818%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4563/4956 (92.0702%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4553/4956 (91.8684%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0394, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3659/4145 (88.2750%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3761/4145 (90.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9426, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4246/4797 (88.5137%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4308/4797 (89.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9203, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4637/5193 (89.2933%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4637/5193 (89.2933%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1935, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5439/5871 (92.6418%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5375/5871 (91.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1592, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3873/4196 (92.3022%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3936/4196 (93.8036%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0128, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4439/4979 (89.1544%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4512/4979 (90.6206%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0766, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4846/5362 (90.3767%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4868/5362 (90.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9079, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5069/5727 (88.5106%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5071/5727 (88.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0178, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4911/5461 (89.9286%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4936/5461 (90.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1833, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5129/5696 (90.0456%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5182/5696 (90.9761%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9254, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4172/4605 (90.5972%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4259/4605 (92.4864%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9009, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4334/4843 (89.4900%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4393/4843 (90.7082%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2537, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4884/5298 (92.1857%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4928/5298 (93.0162%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9440, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4841/5427 (89.2021%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4829/5427 (88.9810%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9821, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4431/4830 (91.7391%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4457/4830 (92.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1955, Accuracy: 5337/10000 (53.3700%)
time spent on training: 247.49773597717285
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0958, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 4.7151, Accuracy: 1750/9900 (17.6768%)
Done in 274.33821511268616 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 69, 16, 75, 60, 24, 8, 77, 11, 80, 28, 41, 2, 76, 57, 33, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4938/5308 (93.0294%), train_poison_data_count: 415
Global model norm: 42.54134449228113.
Norm before scaling: 42.53811193267603. Distance: 1.8392353712326917
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2324, Accuracy: 9353/9900 (94.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5455/5777 (94.4262%), train_poison_data_count: 455
Global model norm: 42.54134449228113.
Norm before scaling: 42.52830944785117. Distance: 1.7814115484496982
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1056, Accuracy: 9645/9900 (97.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4675/5123 (91.2551%), train_poison_data_count: 403
Global model norm: 42.54134449228113.
Norm before scaling: 42.541091979825076. Distance: 1.931478495490719
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1398, Accuracy: 9546/9900 (96.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5083/5503 (92.3678%), train_poison_data_count: 430
Global model norm: 42.54134449228113.
Norm before scaling: 42.5429886560531. Distance: 1.9646909741564664
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1397, Accuracy: 9539/9900 (96.3535%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3965/4364 (90.8570%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3951/4364 (90.5362%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9426, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4801/5353 (89.6880%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4803/5353 (89.7254%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0460, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4218/4672 (90.2825%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4297/4672 (91.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7853, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3710/4145 (89.5054%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3766/4145 (90.8565%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9883, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3929/4313 (91.0967%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3956/4313 (91.7227%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9172, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4361/4889 (89.2002%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4417/4889 (90.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0424, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4382/5050 (86.7723%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4518/5050 (89.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0008, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   1,  Average loss: 0.0086, Accuracy: 4805/5702 (84.2687%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   2,  Average loss: 0.0106, Accuracy: 4538/5702 (79.5861%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0849, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4928/5461 (90.2399%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4931/5461 (90.2948%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1363, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4548/5122 (88.7934%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   2,  Average loss: 0.0121, Accuracy: 4045/5122 (78.9731%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3970, Accuracy: 4637/10000 (46.3700%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4276/4714 (90.7085%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4325/4714 (91.7480%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2872, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3545/3968 (89.3397%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3636/3968 (91.6331%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8425, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3491/3959 (88.1788%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3629/3959 (91.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9462, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4532/4956 (91.4447%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4550/4956 (91.8079%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9604, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4266/4818 (88.5430%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4309/4818 (89.4355%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9729, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3980/4368 (91.1172%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4014/4368 (91.8956%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0678, Accuracy: 5288/10000 (52.8800%)
time spent on training: 242.96312618255615
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1013, Accuracy: 7038/10000 (70.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 4.0126, Accuracy: 2520/9900 (25.4545%)
Done in 269.94290018081665 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 29, 81, 74, 11, 98, 12, 65, 40, 72, 67, 2, 26, 91, 61, 25, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4942/5308 (93.1047%), train_poison_data_count: 415
Global model norm: 42.56261615485252.
Norm before scaling: 42.55797545013229. Distance: 1.847228760894956
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.0995, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5480/5777 (94.8589%), train_poison_data_count: 455
Global model norm: 42.56261615485252.
Norm before scaling: 42.55147818699648. Distance: 1.7293548098627378
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1939, Accuracy: 9413/9900 (95.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4732/5123 (92.3678%), train_poison_data_count: 403
Global model norm: 42.56261615485252.
Norm before scaling: 42.5588646231054. Distance: 1.8521708845021128
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2004, Accuracy: 9406/9900 (95.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5125/5503 (93.1310%), train_poison_data_count: 430
Global model norm: 42.56261615485252.
Norm before scaling: 42.559429668534534. Distance: 1.8773693373480609
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2167, Accuracy: 9336/9900 (94.3030%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4366/4732 (92.2654%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4380/4732 (92.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9084, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4548/5035 (90.3277%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4629/5035 (91.9364%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8890, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4282/4797 (89.2641%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4304/4797 (89.7227%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0576, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4758/5702 (83.4444%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4765/5702 (83.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2836, Accuracy: 4992/10000 (49.9200%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3791/4161 (91.1079%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3839/4161 (92.2615%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9069, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4892/5526 (88.5270%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4836/5526 (87.5136%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0811, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4892/5497 (88.9940%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4895/5497 (89.0486%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2433, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5450/5939 (91.7663%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5487/5939 (92.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0646, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4629/5193 (89.1392%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4404/5193 (84.8065%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3474, Accuracy: 4828/10000 (48.2800%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4865/5559 (87.5157%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4880/5559 (87.7856%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1166, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3538/3968 (89.1633%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3636/3968 (91.6331%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8994, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3739/4086 (91.5076%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3833/4086 (93.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9358, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4044/4527 (89.3307%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4028/4527 (88.9772%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2943, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4043/4485 (90.1449%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3814/4485 (85.0390%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9839, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5659/6419 (88.1601%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5480/6419 (85.3716%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2071, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4854/5489 (88.4314%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4953/5489 (90.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0503, Accuracy: 5365/10000 (53.6500%)
time spent on training: 246.2246057987213
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1035, Accuracy: 7036/10000 (70.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 3.4938, Accuracy: 3228/9900 (32.6061%)
Done in 273.1809027194977 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 56, 90, 54, 63, 94, 10, 96, 45, 38, 59, 6, 85, 55, 32, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4945/5308 (93.1613%), train_poison_data_count: 415
Global model norm: 42.58628218879951.
Norm before scaling: 42.58360486525668. Distance: 1.8143753347156728
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1939, Accuracy: 9448/9900 (95.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5494/5777 (95.1013%), train_poison_data_count: 455
Global model norm: 42.58628218879951.
Norm before scaling: 42.571329732983145. Distance: 1.7045524984271998
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1935, Accuracy: 9412/9900 (95.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4723/5123 (92.1921%), train_poison_data_count: 403
Global model norm: 42.58628218879951.
Norm before scaling: 42.58318633908297. Distance: 1.8373790519509292
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1964, Accuracy: 9391/9900 (94.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5110/5503 (92.8584%), train_poison_data_count: 430
Global model norm: 42.58628218879951.
Norm before scaling: 42.58294267469003. Distance: 1.8697282431497395
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1337, Accuracy: 9560/9900 (96.5657%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4831/5427 (89.0179%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4891/5427 (90.1235%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0442, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4383/4748 (92.3126%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4360/4748 (91.8281%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1069, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4925/5645 (87.2453%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4838/5645 (85.7042%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2040, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3570/3910 (91.3043%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3444/3910 (88.0818%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0390, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4631/5224 (88.6485%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4788/5224 (91.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9326, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4618/5068 (91.1208%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4570/5068 (90.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2668, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4586/5086 (90.1691%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4634/5086 (91.1129%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9663, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4893/5489 (89.1419%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4963/5489 (90.4172%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1689, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5526/6235 (88.6287%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5565/6235 (89.2542%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0552, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4145/4397 (94.2688%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4196/4397 (95.4287%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8041, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4455/4929 (90.3834%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4489/4929 (91.0732%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0563, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 6231/6947 (89.6934%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6109/6947 (87.9372%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0668, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4291/4731 (90.6996%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4347/4731 (91.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8888, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5301/6080 (87.1875%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5312/6080 (87.3684%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.3001, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3192/3552 (89.8649%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3296/3552 (92.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8161, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4308/4737 (90.9436%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4292/4737 (90.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0309, Accuracy: 5421/10000 (54.2100%)
time spent on training: 248.85635614395142
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1076, Accuracy: 7034/10000 (70.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 2.9319, Accuracy: 4008/9900 (40.4848%)
Done in 275.72634744644165 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 23, 89, 83, 1, 0, 90, 46, 70, 48, 5, 17, 96, 79, 7, 63, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4976/5308 (93.7453%), train_poison_data_count: 415
Global model norm: 42.60781075236529.
Norm before scaling: 42.604226517887874. Distance: 1.7838796646263535
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1837, Accuracy: 9430/9900 (95.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5476/5777 (94.7897%), train_poison_data_count: 455
Global model norm: 42.60781075236529.
Norm before scaling: 42.59677773767415. Distance: 1.7659354148019426
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2018, Accuracy: 9444/9900 (95.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4732/5123 (92.3678%), train_poison_data_count: 403
Global model norm: 42.60781075236529.
Norm before scaling: 42.60128527211283. Distance: 1.820849359937912
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3645, Accuracy: 8960/9900 (90.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5120/5503 (93.0402%), train_poison_data_count: 430
Global model norm: 42.60781075236529.
Norm before scaling: 42.60251451691628. Distance: 1.8145938486115016
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3875, Accuracy: 8879/9900 (89.6869%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4261/4549 (93.6689%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4272/4549 (93.9107%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.7245, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4284/4737 (90.4370%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4299/4737 (90.7536%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2682, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3220/3552 (90.6532%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3313/3552 (93.2714%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8774, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5020/5422 (92.5858%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4990/5422 (92.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8820, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4870/5454 (89.2923%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4780/5454 (87.6421%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0172, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4338/4748 (91.3648%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4368/4748 (91.9966%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9626, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4659/5399 (86.2938%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4743/5399 (87.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1670, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5445/5871 (92.7440%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5373/5871 (91.5176%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1274, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4466/4830 (92.4638%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4529/4830 (93.7681%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0983, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4632/4993 (92.7699%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4656/4993 (93.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9501, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4296/4903 (87.6198%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4365/4903 (89.0271%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1643, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4605/5086 (90.5427%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4667/5086 (91.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8473, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3732/4111 (90.7808%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3696/4111 (89.9051%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0975, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4351/4869 (89.3613%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4147/4869 (85.1715%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3332, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3528/3910 (90.2302%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3566/3910 (91.2020%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0496, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3736/4175 (89.4850%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3741/4175 (89.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9868, Accuracy: 5448/10000 (54.4800%)
time spent on training: 243.76028537750244
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1137, Accuracy: 7010/10000 (70.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 2.5882, Accuracy: 4528/9900 (45.7374%)
Done in 270.4497630596161 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 44, 30, 66, 73, 76, 81, 22, 46, 17, 34, 96, 31, 95, 40, 53, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4968/5308 (93.5946%), train_poison_data_count: 415
Global model norm: 42.62925971887956.
Norm before scaling: 42.62250267610995. Distance: 1.7555645619870923
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1397, Accuracy: 9559/9900 (96.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5485/5777 (94.9455%), train_poison_data_count: 455
Global model norm: 42.62925971887956.
Norm before scaling: 42.61375086395602. Distance: 1.6716933820243556
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1205, Accuracy: 9594/9900 (96.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4752/5123 (92.7581%), train_poison_data_count: 403
Global model norm: 42.62925971887956.
Norm before scaling: 42.62211746805803. Distance: 1.7892980961823977
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2691, Accuracy: 9220/9900 (93.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5145/5503 (93.4945%), train_poison_data_count: 430
Global model norm: 42.62925971887956.
Norm before scaling: 42.62286926492631. Distance: 1.8126116751106163
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2170, Accuracy: 9348/9900 (94.4242%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4641/5075 (91.4483%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4549/5075 (89.6355%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0352, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3423/3774 (90.6995%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3518/3774 (93.2167%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8541, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4367/4843 (90.1714%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4442/4843 (91.7200%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9410, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4239/4605 (92.0521%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4240/4605 (92.0738%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0560, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3488/3959 (88.1031%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3601/3959 (90.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0165, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4577/5035 (90.9037%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4619/5035 (91.7378%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0027, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5211/5696 (91.4853%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5232/5696 (91.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1109, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4664/5399 (86.3864%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4699/5399 (87.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1879, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4359/4903 (88.9048%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4372/4903 (89.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1462, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4470/4911 (91.0202%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4491/4911 (91.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0111, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4599/5086 (90.4247%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4618/5086 (90.7983%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1471, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4132/4537 (91.0734%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4173/4537 (91.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8787, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4471/5018 (89.0992%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4440/5018 (88.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1870, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5483/5939 (92.3219%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5488/5939 (92.4061%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9782, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5792/6664 (86.9148%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0082, Accuracy: 5617/6664 (84.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2744, Accuracy: 4922/10000 (49.2200%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4867/5702 (85.3560%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   2,  Average loss: 0.0105, Accuracy: 4552/5702 (79.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2849, Accuracy: 4997/10000 (49.9700%)
time spent on training: 247.73641347885132
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1208, Accuracy: 7003/10000 (70.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 2.2050, Accuracy: 5185/9900 (52.3737%)
Done in 274.25883316993713 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 69, 64, 10, 24, 15, 54, 35, 59, 42, 72, 84, 92, 73, 76, 29, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4994/5308 (94.0844%), train_poison_data_count: 415
Global model norm: 42.651237400078.
Norm before scaling: 42.641393646883046. Distance: 1.6694230254765665
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0994, Accuracy: 9653/9900 (97.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5519/5777 (95.5340%), train_poison_data_count: 455
Global model norm: 42.651237400078.
Norm before scaling: 42.63251686378163. Distance: 1.639930360059825
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1045, Accuracy: 9638/9900 (97.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4768/5123 (93.0705%), train_poison_data_count: 403
Global model norm: 42.651237400078.
Norm before scaling: 42.64417611862067. Distance: 1.7496527599790535
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1659, Accuracy: 9459/9900 (95.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5175/5503 (94.0396%), train_poison_data_count: 430
Global model norm: 42.651237400078.
Norm before scaling: 42.64289511637607. Distance: 1.7550847569401253
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1851, Accuracy: 9430/9900 (95.2525%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3981/4364 (91.2236%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4030/4364 (92.3465%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0939, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4356/4894 (89.0069%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4395/4894 (89.8038%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0146, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4692/5068 (92.5809%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4606/5068 (90.8840%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1715, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3953/4313 (91.6531%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3957/4313 (91.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9114, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5500/6068 (90.6394%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5429/6068 (89.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.3464, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4955/5645 (87.7768%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4854/5645 (85.9876%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.6458, Accuracy: 4620/10000 (46.2000%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5056/5615 (90.0445%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5052/5615 (89.9733%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0991, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4130/4397 (93.9277%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4163/4397 (94.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7837, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5335/5907 (90.3166%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5300/5907 (89.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.4107, Accuracy: 4770/10000 (47.7000%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4650/5193 (89.5436%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4527/5193 (87.1750%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2928, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4661/5209 (89.4797%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4709/5209 (90.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0806, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6268/6812 (92.0141%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6215/6812 (91.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1203, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4202/4605 (91.2486%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4261/4605 (92.5299%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9474, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3567/3959 (90.0985%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3642/3959 (91.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9837, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4358/4732 (92.0964%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4433/4732 (93.6813%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8936, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4619/5075 (91.0148%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4634/5075 (91.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0850, Accuracy: 5292/10000 (52.9200%)
time spent on training: 246.39187693595886
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1266, Accuracy: 6990/10000 (69.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 1.9096, Accuracy: 5697/9900 (57.5455%)
Done in 273.38647985458374 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 14, 54, 3, 34, 68, 73, 15, 91, 7, 26, 79, 11, 61, 56, 16, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5013/5308 (94.4424%), train_poison_data_count: 415
Global model norm: 42.673238089268985.
Norm before scaling: 42.66500024720204. Distance: 1.679243871966447
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2328, Accuracy: 9346/9900 (94.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5513/5777 (95.4302%), train_poison_data_count: 455
Global model norm: 42.673238089268985.
Norm before scaling: 42.65389903090997. Distance: 1.5985883684452717
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1449, Accuracy: 9545/9900 (96.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4800/5123 (93.6951%), train_poison_data_count: 403
Global model norm: 42.673238089268985.
Norm before scaling: 42.66336793863311. Distance: 1.6711333581796883
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.4252, Accuracy: 8905/9900 (89.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5145/5503 (93.4945%), train_poison_data_count: 430
Global model norm: 42.673238089268985.
Norm before scaling: 42.665735552482566. Distance: 1.7600695551869732
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3390, Accuracy: 9024/9900 (91.1515%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3929/4196 (93.6368%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3967/4196 (94.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8686, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4989/5645 (88.3791%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4896/5645 (86.7316%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1808, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4938/5346 (92.3681%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4908/5346 (91.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0815, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4465/4911 (90.9183%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4448/4911 (90.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0287, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3307/3589 (92.1427%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3165/3589 (88.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0173, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4256/4605 (92.4213%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4315/4605 (93.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8921, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5523/6068 (91.0185%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5527/6068 (91.0844%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1517, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4045/4527 (89.3528%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4008/4527 (88.5355%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0238, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4376/4869 (89.8747%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4218/4869 (86.6297%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4292, Accuracy: 4942/10000 (49.4200%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3754/4086 (91.8747%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3834/4086 (93.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8988, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3728/4111 (90.6835%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3744/4111 (91.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1963, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4854/5702 (85.1280%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4441/5702 (77.8850%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1568, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4096/4485 (91.3266%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4075/4485 (90.8584%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0599, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4892/5427 (90.1419%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4878/5427 (89.8839%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9310, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4826/5353 (90.1551%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4800/5353 (89.6693%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0756, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4853/5489 (88.4132%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4970/5489 (90.5447%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0209, Accuracy: 5412/10000 (54.1200%)
time spent on training: 244.5796046257019
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1278, Accuracy: 6975/10000 (69.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 1.7466, Accuracy: 6018/9900 (60.7879%)
Done in 271.1333518028259 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 46, 78, 3, 7, 8, 74, 87, 47, 38, 94, 25, 49, 44, 70, 40, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5041/5308 (94.9699%), train_poison_data_count: 415
Global model norm: 42.6960308436825.
Norm before scaling: 42.68295152149084. Distance: 1.6220707534523031
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1072, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5525/5777 (95.6379%), train_poison_data_count: 455
Global model norm: 42.6960308436825.
Norm before scaling: 42.67753732799976. Distance: 1.6001377374252193
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1366, Accuracy: 9557/9900 (96.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4800/5123 (93.6951%), train_poison_data_count: 403
Global model norm: 42.6960308436825.
Norm before scaling: 42.68629751005804. Distance: 1.6813594569769053
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.4548, Accuracy: 8781/9900 (88.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5186/5503 (94.2395%), train_poison_data_count: 430
Global model norm: 42.6960308436825.
Norm before scaling: 42.68701100104252. Distance: 1.734508612357625
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0500, Accuracy: 9772/9900 (98.7071%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4762/5399 (88.2015%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4725/5399 (87.5162%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3512, Accuracy: 4949/10000 (49.4900%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4016/4368 (91.9414%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3965/4368 (90.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9737, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4922/5346 (92.0688%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4984/5346 (93.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0354, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4379/4869 (89.9363%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4153/4869 (85.2947%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2949, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4419/4889 (90.3866%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4443/4889 (90.8775%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1079, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4281/4797 (89.2433%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4263/4797 (88.8680%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9842, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3535/3995 (88.4856%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3616/3995 (90.5131%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9501, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4555/5123 (88.9127%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4519/5123 (88.2100%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2695, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5510/6235 (88.3721%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5493/6235 (88.0994%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2211, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4604/5224 (88.1317%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4640/5224 (88.8208%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9594, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5670/6419 (88.3315%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5561/6419 (86.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2308, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5005/5652 (88.5527%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4981/5652 (88.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0743, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4656/5075 (91.7438%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4655/5075 (91.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9414, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5413/5871 (92.1989%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5412/5871 (92.1819%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9681, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5458/5939 (91.9010%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5421/5939 (91.2780%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0628, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4873/5454 (89.3473%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4858/5454 (89.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1064, Accuracy: 5325/10000 (53.2500%)
time spent on training: 249.13816714286804
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1339, Accuracy: 6955/10000 (69.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 1.5368, Accuracy: 6416/9900 (64.8081%)
Done in 276.1184709072113 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 80, 3, 45, 6, 57, 22, 68, 38, 76, 26, 41, 98, 61, 0, 1, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5036/5308 (94.8757%), train_poison_data_count: 415
Global model norm: 42.720447341919886.
Norm before scaling: 42.70794429446792. Distance: 1.6281704418554999
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1504, Accuracy: 9515/9900 (96.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5522/5777 (95.5859%), train_poison_data_count: 455
Global model norm: 42.720447341919886.
Norm before scaling: 42.700996733920775. Distance: 1.623573410616047
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1176, Accuracy: 9613/9900 (97.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4808/5123 (93.8513%), train_poison_data_count: 403
Global model norm: 42.720447341919886.
Norm before scaling: 42.71034373444052. Distance: 1.6663558988122398
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3407, Accuracy: 9063/9900 (91.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5157/5503 (93.7125%), train_poison_data_count: 430
Global model norm: 42.720447341919886.
Norm before scaling: 42.71319316226764. Distance: 1.7587289413351808
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1480, Accuracy: 9521/9900 (96.1717%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4943/5461 (90.5146%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4918/5461 (90.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1463, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4939/5346 (92.3868%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4929/5346 (92.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0285, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4940/5489 (89.9982%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4956/5489 (90.2897%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0254, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4523/4929 (91.7630%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4484/4929 (90.9718%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0254, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4530/4956 (91.4044%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4527/4956 (91.3438%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0412, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5185/5696 (91.0288%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5173/5696 (90.8181%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9863, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3261/3589 (90.8610%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   2,  Average loss: 0.0097, Accuracy: 2954/3589 (82.3070%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2561, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5511/6235 (88.3881%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5504/6235 (88.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2566, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3515/3959 (88.7850%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3621/3959 (91.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8971, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3742/4086 (91.5810%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3839/4086 (93.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0117, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4349/4714 (92.2571%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4337/4714 (92.0025%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0694, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3817/4161 (91.7328%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3828/4161 (91.9971%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1977, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4086/4485 (91.1037%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3982/4485 (88.7848%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1138, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4949/5454 (90.7407%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4962/5454 (90.9791%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9769, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5044/5422 (93.0284%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5049/5422 (93.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9625, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4587/5122 (89.5549%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4162/5122 (81.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.4312, Accuracy: 4805/10000 (48.0500%)
time spent on training: 246.22576093673706
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1396, Accuracy: 6955/10000 (69.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 1.3341, Accuracy: 6821/9900 (68.8990%)
Done in 272.66842246055603 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 47, 12, 88, 79, 31, 29, 65, 32, 92, 8, 20, 41, 52, 61, 39, 64].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5050/5308 (95.1394%), train_poison_data_count: 415
Global model norm: 42.7430849784683.
Norm before scaling: 42.72996435191147. Distance: 1.6081777767530727
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1261, Accuracy: 9568/9900 (96.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5534/5777 (95.7937%), train_poison_data_count: 455
Global model norm: 42.7430849784683.
Norm before scaling: 42.72291036800396. Distance: 1.5853701925128874
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2290, Accuracy: 9337/9900 (94.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4794/5123 (93.5780%), train_poison_data_count: 403
Global model norm: 42.7430849784683.
Norm before scaling: 42.73045000256696. Distance: 1.654672987516771
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3279, Accuracy: 9165/9900 (92.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5189/5503 (94.2940%), train_poison_data_count: 430
Global model norm: 42.7430849784683.
Norm before scaling: 42.73076710089874. Distance: 1.6991500665222663
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1473, Accuracy: 9518/9900 (96.1414%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4599/5123 (89.7716%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4487/5123 (87.5854%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1175, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4924/5526 (89.1060%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4907/5526 (88.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2144, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4926/5362 (91.8687%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4895/5362 (91.2906%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1525, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3777/4111 (91.8755%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3800/4111 (92.4349%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0079, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4173/4537 (91.9771%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4190/4537 (92.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8700, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4420/4732 (93.4066%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4470/4732 (94.4632%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.7903, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4951/5497 (90.0673%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4981/5497 (90.6131%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1042, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5368/6080 (88.2895%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5294/6080 (87.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0692, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6263/6812 (91.9407%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6207/6812 (91.1186%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1757, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4456/4889 (91.1434%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4428/4889 (90.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9540, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4310/4714 (91.4298%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4387/4714 (93.0632%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9138, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4307/4714 (91.3661%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4355/4714 (92.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2025, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3793/4130 (91.8402%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3821/4130 (92.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9199, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4069/4485 (90.7246%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3947/4485 (88.0045%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1215, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3743/4175 (89.6527%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3777/4175 (90.4671%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9484, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4355/4894 (88.9865%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4285/4894 (87.5562%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1197, Accuracy: 5263/10000 (52.6300%)
time spent on training: 246.35331892967224
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1459, Accuracy: 6929/10000 (69.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.1684, Accuracy: 7147/9900 (72.1919%)
Done in 273.4046711921692 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 88, 39, 63, 20, 24, 15, 83, 29, 97, 50, 96, 1, 57, 30, 10, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5033/5308 (94.8191%), train_poison_data_count: 415
Global model norm: 42.76523537226602.
Norm before scaling: 42.751302063504454. Distance: 1.6161295060679082
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1517, Accuracy: 9521/9900 (96.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5552/5777 (96.1052%), train_poison_data_count: 455
Global model norm: 42.76523537226602.
Norm before scaling: 42.742565200076754. Distance: 1.5420958548759576
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1724, Accuracy: 9471/9900 (95.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4810/5123 (93.8903%), train_poison_data_count: 403
Global model norm: 42.76523537226602.
Norm before scaling: 42.753976023526896. Distance: 1.660090905193773
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2461, Accuracy: 9294/9900 (93.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5223/5503 (94.9119%), train_poison_data_count: 430
Global model norm: 42.76523537226602.
Norm before scaling: 42.75335787251102. Distance: 1.67608888732256
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1050, Accuracy: 9626/9900 (97.2323%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4924/5362 (91.8314%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4883/5362 (91.0668%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9508, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3751/4175 (89.8443%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3788/4175 (90.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2139, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3611/3910 (92.3529%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3550/3910 (90.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0136, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4351/4714 (92.2995%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4415/4714 (93.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8142, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3921/4313 (90.9112%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3993/4313 (92.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7845, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5520/6068 (90.9690%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5591/6068 (92.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0239, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3223/3552 (90.7376%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3273/3552 (92.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9068, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4372/4732 (92.3922%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4452/4732 (94.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8143, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4202/4736 (88.7247%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4263/4736 (90.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0327, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4347/4757 (91.3811%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4318/4757 (90.7715%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9816, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4590/5086 (90.2477%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4584/5086 (90.1298%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0945, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5036/5422 (92.8809%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5016/5422 (92.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9979, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4580/4956 (92.4132%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4546/4956 (91.7272%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1360, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3488/3774 (92.4218%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3564/3774 (94.4356%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8429, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4684/5068 (92.4230%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4682/5068 (92.3836%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0619, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4924/5346 (92.1062%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4901/5346 (91.6760%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1087, Accuracy: 5300/10000 (53.0000%)
time spent on training: 242.60981273651123
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1534, Accuracy: 6911/10000 (69.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.0065, Accuracy: 7525/9900 (76.0101%)
Done in 269.6211304664612 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 47, 33, 81, 59, 32, 96, 60, 88, 7, 69, 95, 21, 51, 35, 93, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5032/5308 (94.8003%), train_poison_data_count: 415
Global model norm: 42.78529587333422.
Norm before scaling: 42.771898516834334. Distance: 1.5959756308012125
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2089, Accuracy: 9376/9900 (94.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5545/5777 (95.9841%), train_poison_data_count: 455
Global model norm: 42.78529587333422.
Norm before scaling: 42.76218530650065. Distance: 1.5237724522852432
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1021, Accuracy: 9642/9900 (97.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4817/5123 (94.0269%), train_poison_data_count: 403
Global model norm: 42.78529587333422.
Norm before scaling: 42.77068983754748. Distance: 1.592826051854588
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1056, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5224/5503 (94.9300%), train_poison_data_count: 430
Global model norm: 42.78529587333422.
Norm before scaling: 42.76992351433277. Distance: 1.6146165249602027
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.3286, Accuracy: 9090/9900 (91.8182%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4620/5123 (90.1815%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4391/5123 (85.7115%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1953, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4326/4818 (89.7883%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4269/4818 (88.6052%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1290, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4597/5035 (91.3009%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4625/5035 (91.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1342, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4168/4397 (94.7919%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4188/4397 (95.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8556, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5280/6080 (86.8421%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5326/6080 (87.5987%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1775, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4620/5086 (90.8376%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4657/5086 (91.5651%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0654, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3794/4145 (91.5320%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3817/4145 (92.0869%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0421, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4856/5362 (90.5632%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4856/5362 (90.5632%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0285, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4355/4869 (89.4434%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4059/4869 (83.3641%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.3367, Accuracy: 4710/10000 (47.1000%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3952/4364 (90.5591%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4005/4364 (91.7736%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8277, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4437/5018 (88.4217%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4449/5018 (88.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1332, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4574/5038 (90.7900%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4646/5038 (92.2191%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8813, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3790/4108 (92.2590%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3758/4108 (91.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9894, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5052/5615 (89.9733%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5081/5615 (90.4898%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1606, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4538/5055 (89.7725%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4494/5055 (88.9021%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0905, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4294/4797 (89.5143%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4329/4797 (90.2439%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9777, Accuracy: 5438/10000 (54.3800%)
time spent on training: 245.76153826713562
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1589, Accuracy: 6918/10000 (69.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.8953, Accuracy: 7785/9900 (78.6364%)
Done in 272.55168199539185 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 91, 26, 17, 2, 35, 90, 19, 77, 49, 55, 42, 94, 76, 73, 74, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5087/5308 (95.8365%), train_poison_data_count: 415
Global model norm: 42.807226237681675.
Norm before scaling: 42.79262768719631. Distance: 1.5593848646689012
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1081, Accuracy: 9587/9900 (96.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5520/5777 (95.5513%), train_poison_data_count: 455
Global model norm: 42.807226237681675.
Norm before scaling: 42.788143162709225. Distance: 1.6151106762829186
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0920, Accuracy: 9666/9900 (97.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4824/5123 (94.1636%), train_poison_data_count: 403
Global model norm: 42.807226237681675.
Norm before scaling: 42.79360754458179. Distance: 1.6233617153597881
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1697, Accuracy: 9448/9900 (95.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5205/5503 (94.5848%), train_poison_data_count: 430
Global model norm: 42.807226237681675.
Norm before scaling: 42.79404112788003. Distance: 1.6657666716882789
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0651, Accuracy: 9721/9900 (98.1919%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4064/4527 (89.7725%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4041/4527 (89.2644%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0042, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3797/4086 (92.9271%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3808/4086 (93.1963%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9961, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4361/4903 (88.9455%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4412/4903 (89.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0656, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3614/3968 (91.0786%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3679/3968 (92.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.7476, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5122/5615 (91.2199%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5103/5615 (90.8816%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0356, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4428/4748 (93.2603%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4375/4748 (92.1441%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9967, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4852/5361 (90.5055%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4834/5361 (90.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1605, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4451/5050 (88.1386%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4532/5050 (89.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1645, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5055/5652 (89.4374%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4974/5652 (88.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1630, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4348/4731 (91.9045%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4386/4731 (92.7077%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9659, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5319/5907 (90.0457%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5344/5907 (90.4689%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.5119, Accuracy: 4798/10000 (47.9800%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4669/5224 (89.3760%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4700/5224 (89.9694%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0638, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3575/3959 (90.3006%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3641/3959 (91.9677%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8164, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4288/4605 (93.1162%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4306/4605 (93.5071%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9728, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4334/4797 (90.3481%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4263/4797 (88.8680%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0271, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5233/5696 (91.8715%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5186/5696 (91.0463%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9549, Accuracy: 5524/10000 (55.2400%)
time spent on training: 242.29877066612244
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1580, Accuracy: 6921/10000 (69.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.8507, Accuracy: 7874/9900 (79.5354%)
Done in 269.27968525886536 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 59, 78, 62, 30, 12, 24, 43, 89, 46, 60, 90, 77, 95, 53, 69, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5043/5308 (95.0075%), train_poison_data_count: 415
Global model norm: 42.82872924601108.
Norm before scaling: 42.81514305253896. Distance: 1.5947983977285602
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0695, Accuracy: 9716/9900 (98.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5544/5777 (95.9668%), train_poison_data_count: 455
Global model norm: 42.82872924601108.
Norm before scaling: 42.80666018565336. Distance: 1.572202086497583
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1617, Accuracy: 9484/9900 (95.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4817/5123 (94.0269%), train_poison_data_count: 403
Global model norm: 42.82872924601108.
Norm before scaling: 42.813013226850785. Distance: 1.5664988654479866
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2734, Accuracy: 9241/9900 (93.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5208/5503 (94.6393%), train_poison_data_count: 430
Global model norm: 42.82872924601108.
Norm before scaling: 42.81210794756622. Distance: 1.6163000353084769
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1364, Accuracy: 9566/9900 (96.6263%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4181/4397 (95.0876%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4160/4397 (94.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8349, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4038/4368 (92.4451%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3982/4368 (91.1630%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0024, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4792/5504 (87.0640%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4804/5504 (87.2820%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1301, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3449/3774 (91.3884%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3513/3774 (93.0843%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9762, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4986/5526 (90.2280%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4866/5526 (88.0565%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.4172, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3970/4313 (92.0473%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3987/4313 (92.4415%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9749, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4488/4979 (90.1386%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4553/4979 (91.4441%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0314, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4309/4737 (90.9647%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4333/4737 (91.4714%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2097, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4781/5399 (88.5534%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4670/5399 (86.4975%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1220, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3779/4145 (91.1701%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3799/4145 (91.6526%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0430, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4422/4748 (93.1340%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4370/4748 (92.0388%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1844, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4491/5050 (88.9307%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4509/5050 (89.2871%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0419, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4455/5018 (88.7804%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4489/5018 (89.4580%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1303, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5877/6664 (88.1903%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5777/6664 (86.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1229, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3998/4364 (91.6132%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4079/4364 (93.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7642, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3921/4196 (93.4461%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3944/4196 (93.9943%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7955, Accuracy: 5857/10000 (58.5700%)
time spent on training: 243.84374833106995
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1580, Accuracy: 6906/10000 (69.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.7841, Accuracy: 8005/9900 (80.8586%)
Done in 270.33738923072815 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 6, 84, 86, 33, 22, 12, 42, 56, 72, 93, 82, 28, 78, 39, 99, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5056/5308 (95.2524%), train_poison_data_count: 415
Global model norm: 42.84845946490521.
Norm before scaling: 42.83302142750818. Distance: 1.5756394102594413
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0441, Accuracy: 9768/9900 (98.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5535/5777 (95.8110%), train_poison_data_count: 455
Global model norm: 42.84845946490521.
Norm before scaling: 42.82792548293549. Distance: 1.5711594001184108
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0652, Accuracy: 9735/9900 (98.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4855/5123 (94.7687%), train_poison_data_count: 403
Global model norm: 42.84845946490521.
Norm before scaling: 42.8345788757277. Distance: 1.5641905222506245
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2736, Accuracy: 9186/9900 (92.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5223/5503 (94.9119%), train_poison_data_count: 430
Global model norm: 42.84845946490521.
Norm before scaling: 42.83271363598009. Distance: 1.6194646163754294
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0985, Accuracy: 9633/9900 (97.3030%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4520/4929 (91.7022%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4461/4929 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1711, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4673/5209 (89.7101%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4661/5209 (89.4797%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1673, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3528/3929 (89.7938%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3555/3929 (90.4810%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8977, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4369/4818 (90.6808%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4320/4818 (89.6638%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1037, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5247/5696 (92.1173%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5178/5696 (90.9059%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9854, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4980/5526 (90.1194%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4821/5526 (87.2421%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1150, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5361/5907 (90.7567%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5361/5907 (90.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1929, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4846/5427 (89.2943%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4891/5427 (90.1235%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0083, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4695/5193 (90.4102%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4573/5193 (88.0609%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1827, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4549/5055 (89.9901%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4559/5055 (90.1879%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0812, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4895/5298 (92.3934%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4916/5298 (92.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9739, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4553/5122 (88.8911%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4184/5122 (81.6868%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3148, Accuracy: 4842/10000 (48.4200%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4055/4368 (92.8342%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4055/4368 (92.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9348, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3769/4175 (90.2754%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3804/4175 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0695, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4378/4851 (90.2494%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4387/4851 (90.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0010, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4851/5353 (90.6221%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4805/5353 (89.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9714, Accuracy: 5469/10000 (54.6900%)
time spent on training: 247.83958220481873
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1650, Accuracy: 6883/10000 (68.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.6985, Accuracy: 8179/9900 (82.6162%)
Done in 274.4176695346832 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 56, 54, 18, 92, 50, 11, 82, 27, 16, 4, 75, 29, 52, 67, 62, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5069/5308 (95.4974%), train_poison_data_count: 415
Global model norm: 42.871836731887576.
Norm before scaling: 42.85615930791045. Distance: 1.5564618743922922
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0858, Accuracy: 9667/9900 (97.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5551/5777 (96.0879%), train_poison_data_count: 455
Global model norm: 42.871836731887576.
Norm before scaling: 42.84682844748036. Distance: 1.5278385853466803
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0538, Accuracy: 9761/9900 (98.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4858/5123 (94.8272%), train_poison_data_count: 403
Global model norm: 42.871836731887576.
Norm before scaling: 42.85257448098582. Distance: 1.520387227024378
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1521, Accuracy: 9516/9900 (96.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5247/5503 (95.3480%), train_poison_data_count: 430
Global model norm: 42.871836731887576.
Norm before scaling: 42.8550840337417. Distance: 1.590742827062818
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0696, Accuracy: 9700/9900 (97.9798%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4878/5427 (89.8839%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4904/5427 (90.3630%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0188, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4994/5645 (88.4677%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4933/5645 (87.3871%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0929, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3869/4249 (91.0567%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3906/4249 (91.9275%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9294, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6225/6812 (91.3829%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6178/6812 (90.6929%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0109, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4349/4757 (91.4232%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4304/4757 (90.4772%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0820, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4886/5702 (85.6892%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4855/5702 (85.1456%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3373, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4916/5298 (92.7897%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4931/5298 (93.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0729, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4131/4587 (90.0589%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4153/4587 (90.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0077, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4818/5353 (90.0056%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4760/5353 (88.9221%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0615, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3702/4028 (91.9067%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3722/4028 (92.4032%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8686, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4280/4672 (91.6096%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4309/4672 (92.2303%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9200, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4392/4732 (92.8149%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4426/4732 (93.5334%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9761, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3793/4130 (91.8402%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3820/4130 (92.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9160, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4945/5559 (88.9548%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4892/5559 (88.0014%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1929, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4813/5504 (87.4455%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4863/5504 (88.3539%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0829, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4574/5123 (89.2836%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4393/5123 (85.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1876, Accuracy: 5195/10000 (51.9500%)
time spent on training: 248.6038248538971
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1674, Accuracy: 6889/10000 (68.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.6450, Accuracy: 8309/9900 (83.9293%)
Done in 275.3373169898987 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 74, 10, 82, 34, 43, 23, 33, 1, 44, 19, 63, 0, 28, 54, 70, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5083/5308 (95.7611%), train_poison_data_count: 415
Global model norm: 42.895040471717856.
Norm before scaling: 42.87522349841529. Distance: 1.5008879258758927
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0376, Accuracy: 9796/9900 (98.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5564/5777 (96.3130%), train_poison_data_count: 455
Global model norm: 42.895040471717856.
Norm before scaling: 42.87028063722073. Distance: 1.4779014369945997
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2479, Accuracy: 9340/9900 (94.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4852/5123 (94.7101%), train_poison_data_count: 403
Global model norm: 42.895040471717856.
Norm before scaling: 42.87956938570075. Distance: 1.5620492666536632
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1458, Accuracy: 9502/9900 (95.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5231/5503 (95.0572%), train_poison_data_count: 430
Global model norm: 42.895040471717856.
Norm before scaling: 42.87769044492281. Distance: 1.5949243445077166
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2224, Accuracy: 9348/9900 (94.4242%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4259/4797 (88.7847%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4268/4797 (88.9723%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0695, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4671/5068 (92.1665%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4655/5068 (91.8508%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9258, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4940/5298 (93.2427%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4922/5298 (92.9030%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1259, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4489/4911 (91.4070%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4546/4911 (92.5677%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0310, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4491/4979 (90.1988%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4512/4979 (90.6206%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9758, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4259/4549 (93.6250%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4074/4549 (89.5581%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8890, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4401/4818 (91.3450%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4342/4818 (90.1204%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9823, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5066/5422 (93.4342%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5072/5422 (93.5448%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9228, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4672/5075 (92.0591%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4648/5075 (91.5862%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9838, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4811/5361 (89.7407%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4812/5361 (89.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1386, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3563/3910 (91.1253%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3500/3910 (89.5141%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1740, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4931/5454 (90.4107%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4804/5454 (88.0821%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2010, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4558/5122 (88.9887%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4331/5122 (84.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.3895, Accuracy: 4887/10000 (48.8700%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5007/5645 (88.6980%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4943/5645 (87.5642%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.3337, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5412/5871 (92.1819%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5366/5871 (91.3984%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0994, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6303/6812 (92.5279%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6234/6812 (91.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1054, Accuracy: 5394/10000 (53.9400%)
time spent on training: 249.3020203113556
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1662, Accuracy: 6891/10000 (68.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.6195, Accuracy: 8372/9900 (84.5657%)
Done in 275.82487869262695 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 92, 14, 45, 16, 59, 87, 19, 95, 47, 66, 6, 7, 82, 69, 79, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5075/5308 (95.6104%), train_poison_data_count: 415
Global model norm: 42.91840516553621.
Norm before scaling: 42.90128795050913. Distance: 1.5363941588712104
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0690, Accuracy: 9719/9900 (98.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5532/5777 (95.7590%), train_poison_data_count: 455
Global model norm: 42.91840516553621.
Norm before scaling: 42.89420095520999. Distance: 1.5311820345995588
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1143, Accuracy: 9603/9900 (97.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4857/5123 (94.8077%), train_poison_data_count: 403
Global model norm: 42.91840516553621.
Norm before scaling: 42.901120072972745. Distance: 1.5510093079268599
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1345, Accuracy: 9556/9900 (96.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5243/5503 (95.2753%), train_poison_data_count: 430
Global model norm: 42.91840516553621.
Norm before scaling: 42.90140461078314. Distance: 1.5487765559766902
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0814, Accuracy: 9678/9900 (97.7576%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6300/6812 (92.4839%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6273/6812 (92.0875%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1678, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3971/4196 (94.6378%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3972/4196 (94.6616%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8733, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4889/5489 (89.0690%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4960/5489 (90.3625%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9358, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4869/5353 (90.9583%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4759/5353 (88.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9299, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4140/4397 (94.1551%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4205/4397 (95.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8667, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3561/3995 (89.1364%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3594/3995 (89.9625%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0540, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4852/5361 (90.5055%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4699/5361 (87.6516%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0660, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4520/5018 (90.0757%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4450/5018 (88.6807%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0399, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4595/5123 (89.6935%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4294/5123 (83.8181%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.4111, Accuracy: 4864/10000 (48.6400%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4410/4843 (91.0593%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4431/4843 (91.4929%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9172, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4557/4929 (92.4528%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4473/4929 (90.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1115, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4388/4869 (90.1212%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0103, Accuracy: 3976/4869 (81.6595%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3899, Accuracy: 4753/10000 (47.5300%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4888/5298 (92.2612%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4879/5298 (92.0914%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0016, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4007/4364 (91.8194%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3907/4364 (89.5280%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9745, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3761/4111 (91.4863%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3775/4111 (91.8268%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0334, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3648/4028 (90.5660%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3713/4028 (92.1797%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9062, Accuracy: 5739/10000 (57.3900%)
time spent on training: 245.5351870059967
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1709, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.5385, Accuracy: 8578/9900 (86.6465%)
Done in 272.2113206386566 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 14, 82, 18, 47, 52, 43, 16, 75, 27, 28, 33, 5, 17, 67, 48, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5094/5308 (95.9683%), train_poison_data_count: 415
Global model norm: 42.94025333466621.
Norm before scaling: 42.92016998115149. Distance: 1.4901044596467656
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0726, Accuracy: 9714/9900 (98.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5573/5777 (96.4688%), train_poison_data_count: 455
Global model norm: 42.94025333466621.
Norm before scaling: 42.91196531945519. Distance: 1.4456443611824294
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1547, Accuracy: 9511/9900 (96.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4854/5123 (94.7492%), train_poison_data_count: 403
Global model norm: 42.94025333466621.
Norm before scaling: 42.92177688148596. Distance: 1.54192539140475
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1433, Accuracy: 9535/9900 (96.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5258/5503 (95.5479%), train_poison_data_count: 430
Global model norm: 42.94025333466621.
Norm before scaling: 42.9227310389699. Distance: 1.569962647595079
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0837, Accuracy: 9662/9900 (97.5960%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3958/4196 (94.3279%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3955/4196 (94.2564%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8077, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4902/5298 (92.5255%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4961/5298 (93.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0866, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3872/4249 (91.1273%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3877/4249 (91.2450%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9167, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4630/5123 (90.3767%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4592/5123 (89.6350%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0495, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3819/4130 (92.4697%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3832/4130 (92.7845%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9771, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4520/4979 (90.7813%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4510/4979 (90.5804%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9303, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4885/5353 (91.2572%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4791/5353 (89.5012%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1113, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4288/4672 (91.7808%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4356/4672 (93.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8618, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4125/4587 (89.9281%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4171/4587 (90.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1905, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4583/5122 (89.4768%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4342/5122 (84.7716%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2466, Accuracy: 5024/10000 (50.2400%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4373/4818 (90.7638%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4393/4818 (91.1789%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1158, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4682/4993 (93.7713%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4647/4993 (93.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9494, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4434/4903 (90.4344%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4411/4903 (89.9653%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1191, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4956/5559 (89.1527%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4939/5559 (88.8469%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1756, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4503/4830 (93.2298%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4552/4830 (94.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9869, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5210/5696 (91.4677%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5150/5696 (90.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0402, Accuracy: 5276/10000 (52.7600%)
time spent on training: 244.8722004890442
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1683, Accuracy: 6900/10000 (69.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.5111, Accuracy: 8627/9900 (87.1414%)
Done in 271.8511679172516 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 14, 47, 73, 97, 20, 45, 34, 76, 40, 35, 85, 62, 90, 54, 32, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5064/5308 (95.4032%), train_poison_data_count: 415
Global model norm: 42.96136300139347.
Norm before scaling: 42.94154110122781. Distance: 1.518095460983616
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0282, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5562/5777 (96.2783%), train_poison_data_count: 455
Global model norm: 42.96136300139347.
Norm before scaling: 42.93387505167831. Distance: 1.4884612207406693
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1969, Accuracy: 9458/9900 (95.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4831/5123 (94.3002%), train_poison_data_count: 403
Global model norm: 42.96136300139347.
Norm before scaling: 42.948165523977856. Distance: 1.6072906774327054
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1888, Accuracy: 9412/9900 (95.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5285/5503 (96.0385%), train_poison_data_count: 430
Global model norm: 42.96136300139347.
Norm before scaling: 42.94030166214412. Distance: 1.4716892457283337
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1476, Accuracy: 9510/9900 (96.0606%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3961/4196 (94.3994%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3941/4196 (93.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0141, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4622/5123 (90.2206%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4213/5123 (82.2370%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3126, Accuracy: 4843/10000 (48.4300%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4262/4605 (92.5516%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4263/4605 (92.5733%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0037, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4225/4736 (89.2103%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4259/4736 (89.9282%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9927, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4343/4714 (92.1298%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4395/4714 (93.2329%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0161, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4927/5489 (89.7613%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4891/5489 (89.1055%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2041, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4491/4911 (91.4478%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4487/4911 (91.3663%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0884, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3523/3959 (88.9871%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3611/3959 (91.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9735, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5429/5939 (91.4127%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5498/5939 (92.5745%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0440, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5133/5615 (91.4159%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5131/5615 (91.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1693, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6299/6947 (90.6722%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 6141/6947 (88.3979%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1872, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4819/5504 (87.5545%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4800/5504 (87.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0680, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4398/4748 (92.6285%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4378/4748 (92.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1192, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4975/5645 (88.1311%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4955/5645 (87.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2710, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5376/6080 (88.4211%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5346/6080 (87.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1572, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3320/3589 (92.5049%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3236/3589 (90.1644%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9787, Accuracy: 5547/10000 (55.4700%)
time spent on training: 247.70357275009155
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1725, Accuracy: 6883/10000 (68.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.4812, Accuracy: 8709/9900 (87.9697%)
Done in 274.4649221897125 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 19, 26, 11, 32, 40, 65, 21, 5, 17, 92, 12, 63, 44, 51, 82, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5102/5308 (96.1191%), train_poison_data_count: 415
Global model norm: 42.98295503834194.
Norm before scaling: 42.96017528079058. Distance: 1.4123035682544012
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1188, Accuracy: 9587/9900 (96.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5565/5777 (96.3303%), train_poison_data_count: 455
Global model norm: 42.98295503834194.
Norm before scaling: 42.95741185637745. Distance: 1.5113284373535716
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0511, Accuracy: 9752/9900 (98.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4849/5123 (94.6516%), train_poison_data_count: 403
Global model norm: 42.98295503834194.
Norm before scaling: 42.96527542770004. Distance: 1.5250629068126067
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2932, Accuracy: 9151/9900 (92.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5263/5503 (95.6387%), train_poison_data_count: 430
Global model norm: 42.98295503834194.
Norm before scaling: 42.96412333045663. Distance: 1.5749336682838482
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0911, Accuracy: 9659/9900 (97.5657%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4842/5361 (90.3190%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4858/5361 (90.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0160, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3756/4086 (91.9236%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3821/4086 (93.5144%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0631, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4922/5702 (86.3206%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4739/5702 (83.1112%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2130, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5332/6080 (87.6974%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5342/6080 (87.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1295, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5446/5939 (91.6989%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5448/5939 (91.7326%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0201, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4928/5497 (89.6489%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4922/5497 (89.5397%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2207, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4558/5038 (90.4724%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4600/5038 (91.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8980, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4649/4993 (93.1104%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4574/4993 (91.6083%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0910, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4401/4903 (89.7614%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4448/4903 (90.7200%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0956, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6310/6812 (92.6307%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6220/6812 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1324, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4999/5526 (90.4633%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4897/5526 (88.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0788, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3609/3910 (92.3018%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3479/3910 (88.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9984, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4718/5075 (92.9655%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4625/5075 (91.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0825, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3770/4108 (91.7722%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3729/4108 (90.7741%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9683, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4962/5298 (93.6580%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4961/5298 (93.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1684, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5007/5422 (92.3460%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4978/5422 (91.8111%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9609, Accuracy: 5497/10000 (54.9700%)
time spent on training: 250.19094967842102
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1707, Accuracy: 6886/10000 (68.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.4730, Accuracy: 8714/9900 (88.0202%)
Done in 277.1638150215149 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 40, 64, 16, 91, 86, 42, 49, 66, 2, 8, 83, 26, 43, 81, 28, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5101/5308 (96.1002%), train_poison_data_count: 415
Global model norm: 43.00607895575273.
Norm before scaling: 42.98401859403315. Distance: 1.433388427666158
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0518, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5568/5777 (96.3822%), train_poison_data_count: 455
Global model norm: 43.00607895575273.
Norm before scaling: 42.979066943251574. Distance: 1.4690632587520975
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0818, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4872/5123 (95.1005%), train_poison_data_count: 403
Global model norm: 43.00607895575273.
Norm before scaling: 42.984938711770745. Distance: 1.4904153096561938
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2293, Accuracy: 9337/9900 (94.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5248/5503 (95.3662%), train_poison_data_count: 430
Global model norm: 43.00607895575273.
Norm before scaling: 42.985789235186495. Distance: 1.5387135221370474
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1109, Accuracy: 9590/9900 (96.8687%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5440/5939 (91.5979%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5426/5939 (91.3622%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2646, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4327/4894 (88.4144%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4357/4894 (89.0274%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0871, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4834/5353 (90.3045%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4862/5353 (90.8276%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9775, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4069/4527 (89.8829%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4032/4527 (89.0656%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0689, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3590/3929 (91.3719%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3609/3929 (91.8554%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8447, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5383/5907 (91.1292%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5330/5907 (90.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2413, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5082/5652 (89.9151%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5069/5652 (89.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.3069, Accuracy: 4934/10000 (49.3400%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4433/4843 (91.5342%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4404/4843 (90.9354%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0907, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3623/3968 (91.3054%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3669/3968 (92.4647%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8189, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4482/4889 (91.6752%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4468/4889 (91.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.3329, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3227/3552 (90.8502%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3291/3552 (92.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8949, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3835/4086 (93.8571%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3850/4086 (94.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8352, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4541/4979 (91.2031%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4552/4979 (91.4240%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0703, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4642/5035 (92.1946%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4634/5035 (92.0357%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0302, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4626/5122 (90.3163%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   2,  Average loss: 0.0133, Accuracy: 3871/5122 (75.5759%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.4180, Accuracy: 4694/10000 (46.9400%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5130/5615 (91.3624%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5159/5615 (91.8789%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2437, Accuracy: 5132/10000 (51.3200%)
time spent on training: 244.7173719406128
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1783, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.4219, Accuracy: 8823/9900 (89.1212%)
Done in 271.4202399253845 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 48, 89, 35, 76, 39, 12, 31, 24, 1, 54, 37, 22, 21, 17, 10, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5103/5308 (96.1379%), train_poison_data_count: 415
Global model norm: 43.02707547153086.
Norm before scaling: 43.005890198865494. Distance: 1.4899131658712692
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0667, Accuracy: 9715/9900 (98.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5583/5777 (96.6419%), train_poison_data_count: 455
Global model norm: 43.02707547153086.
Norm before scaling: 42.99804683064104. Distance: 1.452101726588803
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0495, Accuracy: 9761/9900 (98.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4869/5123 (95.0420%), train_poison_data_count: 403
Global model norm: 43.02707547153086.
Norm before scaling: 43.00919545346887. Distance: 1.5182607482801056
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1523, Accuracy: 9516/9900 (96.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5265/5503 (95.6751%), train_poison_data_count: 430
Global model norm: 43.02707547153086.
Norm before scaling: 43.00761168776915. Distance: 1.5363825978724466
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0438, Accuracy: 9778/9900 (98.7677%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4511/4830 (93.3954%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4512/4830 (93.4161%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9407, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4314/4737 (91.0703%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4278/4737 (90.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2182, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5110/5615 (91.0062%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5072/5615 (90.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1800, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3581/3959 (90.4521%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3598/3959 (90.8815%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0327, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3829/4175 (91.7126%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3820/4175 (91.4970%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8887, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5098/5526 (92.2548%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4869/5526 (88.1107%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1087, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4173/4537 (91.9771%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4159/4537 (91.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9204, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3927/4313 (91.0503%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3979/4313 (92.2560%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9169, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5074/5422 (93.5817%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5077/5422 (93.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9353, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4967/5645 (87.9894%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4836/5645 (85.6687%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0280, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4354/4741 (91.8372%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3926/4741 (82.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.6500, Accuracy: 4560/10000 (45.6000%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5207/5696 (91.4150%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5156/5696 (90.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0125, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4585/5038 (91.0083%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4625/5038 (91.8023%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0774, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4414/4903 (90.0265%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4442/4903 (90.5976%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0471, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4690/5068 (92.5414%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4620/5068 (91.1602%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2664, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4413/4748 (92.9444%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4425/4748 (93.1971%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0208, Accuracy: 5489/10000 (54.8900%)
time spent on training: 243.702627658844
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1786, Accuracy: 6883/10000 (68.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.3948, Accuracy: 8883/9900 (89.7273%)
Done in 270.5554389953613 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 83, 63, 46, 35, 25, 8, 56, 22, 31, 87, 5, 7, 10, 30, 82, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5098/5308 (96.0437%), train_poison_data_count: 415
Global model norm: 43.048523958889255.
Norm before scaling: 43.025919354827565. Distance: 1.4698372732648128
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0210, Accuracy: 9837/9900 (99.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5551/5777 (96.0879%), train_poison_data_count: 455
Global model norm: 43.048523958889255.
Norm before scaling: 43.022055004344864. Distance: 1.5080171752528364
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0839, Accuracy: 9679/9900 (97.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4871/5123 (95.0810%), train_poison_data_count: 403
Global model norm: 43.048523958889255.
Norm before scaling: 43.02970959933526. Distance: 1.542699940117931
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1220, Accuracy: 9592/9900 (96.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5241/5503 (95.2390%), train_poison_data_count: 430
Global model norm: 43.048523958889255.
Norm before scaling: 43.03045427505022. Distance: 1.5549831396826352
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1440, Accuracy: 9535/9900 (96.3131%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3219/3552 (90.6250%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3311/3552 (93.2151%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8167, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3649/3910 (93.3248%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3327/3910 (85.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.3462, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4789/5399 (88.7016%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4760/5399 (88.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2386, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5128/5615 (91.3268%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5171/5615 (92.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1054, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5676/6419 (88.4250%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5493/6419 (85.5741%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.3472, Accuracy: 4922/10000 (49.2200%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4435/4889 (90.7138%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4430/4889 (90.6116%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1451, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4908/5427 (90.4367%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4901/5427 (90.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0577, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5265/5696 (92.4333%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5237/5696 (91.9417%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9603, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4163/4537 (91.7567%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4157/4537 (91.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9264, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3604/3995 (90.2128%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3562/3995 (89.1615%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0867, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4691/4993 (93.9515%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4665/4993 (93.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9936, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4384/4869 (90.0390%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4329/4869 (88.9094%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1587, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4715/5068 (93.0347%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4607/5068 (90.9037%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1880, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3488/3774 (92.4218%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3549/3774 (94.0382%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0681, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4951/5298 (93.4504%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4906/5298 (92.6010%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0202, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4983/5461 (91.2470%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4987/5461 (91.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2513, Accuracy: 5147/10000 (51.4700%)
time spent on training: 244.2458779811859
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1819, Accuracy: 6870/10000 (68.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3599, Accuracy: 8958/9900 (90.4848%)
Done in 271.2346119880676 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 87, 99, 81, 52, 95, 3, 6, 0, 51, 78, 18, 89, 92, 40, 42, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5125/5308 (96.5524%), train_poison_data_count: 415
Global model norm: 43.069801630608886.
Norm before scaling: 43.04723088555247. Distance: 1.4180764401739392
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0797, Accuracy: 9698/9900 (97.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5592/5777 (96.7976%), train_poison_data_count: 455
Global model norm: 43.069801630608886.
Norm before scaling: 43.04027427841204. Distance: 1.4275009862091346
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0566, Accuracy: 9744/9900 (98.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4853/5123 (94.7297%), train_poison_data_count: 403
Global model norm: 43.069801630608886.
Norm before scaling: 43.048414786435515. Distance: 1.50664249545657
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1209, Accuracy: 9589/9900 (96.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5297/5503 (96.2566%), train_poison_data_count: 430
Global model norm: 43.069801630608886.
Norm before scaling: 43.046330531946914. Distance: 1.4829707681266149
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0541, Accuracy: 9734/9900 (98.3232%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3573/3995 (89.4368%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3549/3995 (88.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0650, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4411/4851 (90.9297%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4386/4851 (90.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1041, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4653/5035 (92.4131%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4657/5035 (92.4926%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9687, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3811/4130 (92.2760%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3859/4130 (93.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9056, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4495/5018 (89.5775%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4496/5018 (89.5974%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1289, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4988/5346 (93.3034%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4954/5346 (92.6674%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1902, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4566/4929 (92.6354%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4459/4929 (90.4646%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1765, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4950/5454 (90.7591%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4861/5454 (89.1272%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2395, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3797/4108 (92.4294%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3768/4108 (91.7235%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9270, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4068/4368 (93.1319%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3978/4368 (91.0714%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0776, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3910/4249 (92.0217%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3879/4249 (91.2921%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9208, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4325/4737 (91.3025%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4357/4737 (91.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0419, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6320/6812 (92.7775%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6205/6812 (91.0893%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0956, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5477/5939 (92.2209%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5481/5939 (92.2883%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9503, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5352/5907 (90.6044%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5348/5907 (90.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.3221, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4435/4843 (91.5755%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4451/4843 (91.9058%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0475, Accuracy: 5381/10000 (53.8100%)
time spent on training: 246.22739815711975
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1848, Accuracy: 6870/10000 (68.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.3149, Accuracy: 9051/9900 (91.4242%)
Done in 272.89972281455994 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 92, 3, 12, 50, 95, 31, 5, 38, 72, 61, 32, 94, 7, 57, 22, 8].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5120/5308 (96.4582%), train_poison_data_count: 415
Global model norm: 43.0906821107026.
Norm before scaling: 43.067677312592124. Distance: 1.4257683740321851
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0470, Accuracy: 9770/9900 (98.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5574/5777 (96.4861%), train_poison_data_count: 455
Global model norm: 43.0906821107026.
Norm before scaling: 43.06080338412113. Distance: 1.45203966196395
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0501, Accuracy: 9747/9900 (98.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4885/5123 (95.3543%), train_poison_data_count: 403
Global model norm: 43.0906821107026.
Norm before scaling: 43.0695734733894. Distance: 1.4830583856912927
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1031, Accuracy: 9638/9900 (97.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5268/5503 (95.7296%), train_poison_data_count: 430
Global model norm: 43.0906821107026.
Norm before scaling: 43.070257941422. Distance: 1.5169468257639867
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0261, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6319/6812 (92.7628%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6250/6812 (91.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1058, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4994/5346 (93.4156%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4904/5346 (91.7321%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0730, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5036/5526 (91.1328%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4882/5526 (88.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1461, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4409/4757 (92.6845%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4311/4757 (90.6243%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1832, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4580/5018 (91.2714%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4461/5018 (88.9000%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1227, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4206/4537 (92.7044%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4226/4537 (93.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9008, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4680/4993 (93.7312%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4638/4993 (92.8900%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9217, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5567/6235 (89.2863%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5513/6235 (88.4202%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2528, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4734/5193 (91.1612%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4491/5193 (86.4818%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.5015, Accuracy: 4772/10000 (47.7200%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4084/4485 (91.0591%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3734/4485 (83.2553%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.4693, Accuracy: 4720/10000 (47.2000%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5372/6080 (88.3553%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5356/6080 (88.0921%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2909, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4650/5224 (89.0123%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4667/5224 (89.3377%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2040, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4405/4869 (90.4703%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4263/4869 (87.5539%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1284, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4534/4956 (91.4851%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4446/4956 (89.7094%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0641, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5205/5696 (91.3799%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5171/5696 (90.7830%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9966, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4489/4889 (91.8184%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4459/4889 (91.2047%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0573, Accuracy: 5382/10000 (53.8200%)
time spent on training: 251.17679524421692
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1889, Accuracy: 6868/10000 (68.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2895, Accuracy: 9116/9900 (92.0808%)
Done in 277.83537793159485 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 1, 65, 25, 70, 59, 5, 76, 49, 11, 2, 40, 47, 23, 83, 28, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5142/5308 (96.8726%), train_poison_data_count: 415
Global model norm: 43.11543004096315.
Norm before scaling: 43.08789022660181. Distance: 1.3339226235078185
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1305, Accuracy: 9555/9900 (96.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5559/5777 (96.2264%), train_poison_data_count: 455
Global model norm: 43.11543004096315.
Norm before scaling: 43.087054467616056. Distance: 1.4775434192661312
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0592, Accuracy: 9751/9900 (98.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4893/5123 (95.5104%), train_poison_data_count: 403
Global model norm: 43.11543004096315.
Norm before scaling: 43.09490712958797. Distance: 1.5151258610229714
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1298, Accuracy: 9578/9900 (96.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5281/5503 (95.9658%), train_poison_data_count: 430
Global model norm: 43.11543004096315.
Norm before scaling: 43.092101355338315. Distance: 1.511609608261368
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0427, Accuracy: 9782/9900 (98.8081%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5043/5422 (93.0100%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5027/5422 (92.7149%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0254, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4997/5497 (90.9041%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4930/5497 (89.6853%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9791, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5682/6419 (88.5185%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5536/6419 (86.2440%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2090, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5417/5871 (92.2671%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5368/5871 (91.4325%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0478, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4146/4397 (94.2916%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4194/4397 (95.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7816, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4694/4993 (94.0116%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4668/4993 (93.4909%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9782, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3588/3959 (90.6289%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3597/3959 (90.8563%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0308, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5051/5652 (89.3666%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5026/5652 (88.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1286, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4930/5702 (86.4609%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   2,  Average loss: 0.0103, Accuracy: 4570/5702 (80.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3800, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3628/3968 (91.4315%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3671/3968 (92.5151%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8480, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5514/5939 (92.8439%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5468/5939 (92.0694%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0127, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4623/5123 (90.2401%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4492/5123 (87.6830%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1354, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4278/4549 (94.0426%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3951/4549 (86.8543%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0257, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3216/3552 (90.5405%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3291/3552 (92.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8581, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4581/5122 (89.4377%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   2,  Average loss: 0.0105, Accuracy: 4152/5122 (81.0621%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.6198, Accuracy: 4501/10000 (45.0100%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6309/6812 (92.6160%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6241/6812 (91.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2393, Accuracy: 5192/10000 (51.9200%)
time spent on training: 249.90372896194458
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1886, Accuracy: 6879/10000 (68.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2703, Accuracy: 9157/9900 (92.4949%)
Done in 276.647314786911 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 55, 74, 81, 88, 47, 3, 20, 49, 91, 24, 85, 5, 96, 21, 80, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5132/5308 (96.6843%), train_poison_data_count: 415
Global model norm: 43.13742744397694.
Norm before scaling: 43.11200409933337. Distance: 1.3862393692338209
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1098, Accuracy: 9608/9900 (97.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5564/5777 (96.3130%), train_poison_data_count: 455
Global model norm: 43.13742744397694.
Norm before scaling: 43.10843630049039. Distance: 1.4754566714143764
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0954, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4868/5123 (95.0224%), train_poison_data_count: 403
Global model norm: 43.13742744397694.
Norm before scaling: 43.115858972330294. Distance: 1.5019703480857838
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1748, Accuracy: 9456/9900 (95.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5264/5503 (95.6569%), train_poison_data_count: 430
Global model norm: 43.13742744397694.
Norm before scaling: 43.113627916348854. Distance: 1.499375133697262
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0357, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4352/4731 (91.9890%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4385/4731 (92.6865%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9619, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4343/4797 (90.5358%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4327/4797 (90.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9733, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4670/5035 (92.7507%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4645/5035 (92.2542%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0293, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4864/5362 (90.7124%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4867/5362 (90.7684%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0997, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4644/5123 (90.6500%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4513/5123 (88.0929%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3123, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4932/5346 (92.2559%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4904/5346 (91.7321%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0999, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4382/4714 (92.9571%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4393/4714 (93.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8703, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5083/5652 (89.9328%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5003/5652 (88.5173%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1248, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4072/4527 (89.9492%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3976/4527 (87.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2037, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4001/4313 (92.7661%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4002/4313 (92.7892%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7439, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 6275/6947 (90.3268%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6172/6947 (88.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.4612, Accuracy: 4803/10000 (48.0300%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4687/4993 (93.8714%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4590/4993 (91.9287%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1508, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4663/5086 (91.6831%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4686/5086 (92.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0423, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4627/5038 (91.8420%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4627/5038 (91.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8419, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4990/5461 (91.3752%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4886/5461 (89.4708%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0611, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5126/5727 (89.5058%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5099/5727 (89.0344%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0583, Accuracy: 5394/10000 (53.9400%)
time spent on training: 249.89672231674194
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1847, Accuracy: 6873/10000 (68.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2661, Accuracy: 9169/9900 (92.6162%)
Done in 276.7108998298645 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 24, 64, 59, 90, 22, 56, 73, 1, 70, 49, 88, 11, 44, 15, 92, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5106/5308 (96.1944%), train_poison_data_count: 415
Global model norm: 43.15909685803866.
Norm before scaling: 43.13749252933867. Distance: 1.468426283204759
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0784, Accuracy: 9697/9900 (97.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5600/5777 (96.9361%), train_poison_data_count: 455
Global model norm: 43.15909685803866.
Norm before scaling: 43.12842773968088. Distance: 1.4188288662538155
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0698, Accuracy: 9715/9900 (98.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4883/5123 (95.3152%), train_poison_data_count: 403
Global model norm: 43.15909685803866.
Norm before scaling: 43.13831033268891. Distance: 1.4629638816510484
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2372, Accuracy: 9243/9900 (93.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5297/5503 (96.2566%), train_poison_data_count: 430
Global model norm: 43.15909685803866.
Norm before scaling: 43.1344334111754. Distance: 1.4637752450644035
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0589, Accuracy: 9736/9900 (98.3434%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3963/4313 (91.8850%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3968/4313 (92.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9991, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4403/4894 (89.9673%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4326/4894 (88.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9619, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4193/4397 (95.3605%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4220/4397 (95.9745%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7505, Accuracy: 5942/10000 (59.4200%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4413/4748 (92.9444%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4444/4748 (93.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9315, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5262/5696 (92.3806%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5147/5696 (90.3617%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9270, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4928/5427 (90.8052%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4849/5427 (89.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0367, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4279/4605 (92.9207%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4277/4605 (92.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1580, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5091/5422 (93.8952%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5067/5422 (93.4526%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9557, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5466/5871 (93.1017%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5324/5871 (90.6830%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0286, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5085/5652 (89.9682%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5108/5652 (90.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0482, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4915/5362 (91.6636%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4838/5362 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1181, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4957/5702 (86.9344%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4752/5702 (83.3392%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2831, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4686/5075 (92.3350%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4611/5075 (90.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1093, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5557/6068 (91.5788%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5585/6068 (92.0402%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1632, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6333/6812 (92.9683%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   2,  Average loss: 0.0038, Accuracy: 6307/6812 (92.5866%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0592, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4399/4732 (92.9628%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4424/4732 (93.4911%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8678, Accuracy: 5696/10000 (56.9600%)
time spent on training: 251.58663153648376
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1869, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2636, Accuracy: 9177/9900 (92.6970%)
Done in 278.3794229030609 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 38, 1, 27, 46, 63, 42, 19, 95, 85, 68, 67, 92, 3, 17, 59, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5125/5308 (96.5524%), train_poison_data_count: 415
Global model norm: 43.18116813206887.
Norm before scaling: 43.15575358376693. Distance: 1.375360268298727
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1063, Accuracy: 9619/9900 (97.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5600/5777 (96.9361%), train_poison_data_count: 455
Global model norm: 43.18116813206887.
Norm before scaling: 43.150267167662186. Distance: 1.4037133544459461
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0685, Accuracy: 9702/9900 (98.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4903/5123 (95.7056%), train_poison_data_count: 403
Global model norm: 43.18116813206887.
Norm before scaling: 43.15817338219378. Distance: 1.4483500136339311
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1667, Accuracy: 9454/9900 (95.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5298/5503 (96.2748%), train_poison_data_count: 430
Global model norm: 43.18116813206887.
Norm before scaling: 43.15505067124241. Distance: 1.4602951840942024
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0463, Accuracy: 9767/9900 (98.6566%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5611/6235 (89.9920%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5594/6235 (89.7193%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2820, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5087/5422 (93.8215%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5015/5422 (92.4935%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8828, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4128/4587 (89.9935%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4127/4587 (89.9717%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0340, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4844/5399 (89.7203%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4749/5399 (87.9607%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3695, Accuracy: 4932/10000 (49.3200%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3622/3910 (92.6343%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3573/3910 (91.3811%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1541, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5355/5907 (90.6552%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5282/5907 (89.4193%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.4198, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4848/5361 (90.4309%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4792/5361 (89.3863%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0009, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4532/5018 (90.3149%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4468/5018 (89.0395%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0483, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6282/6947 (90.4275%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6080/6947 (87.5198%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3171, Accuracy: 4954/10000 (49.5400%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3288/3589 (91.6133%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3184/3589 (88.7155%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1499, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5045/5559 (90.7537%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4965/5559 (89.3146%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1287, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6365/6812 (93.4381%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6241/6812 (91.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1508, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4991/5346 (93.3595%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4953/5346 (92.6487%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9888, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4387/4903 (89.4758%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4439/4903 (90.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9940, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4223/4397 (96.0428%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   2,  Average loss: 0.0020, Accuracy: 4241/4397 (96.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7492, Accuracy: 5971/10000 (59.7100%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4695/5035 (93.2473%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4707/5035 (93.4856%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8483, Accuracy: 5726/10000 (57.2600%)
time spent on training: 252.15572667121887
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1825, Accuracy: 6875/10000 (68.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2618, Accuracy: 9171/9900 (92.6364%)
Done in 278.86729526519775 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 70, 72, 67, 66, 75, 44, 99, 84, 22, 28, 37, 74, 14, 79, 7, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5124/5308 (96.5335%), train_poison_data_count: 415
Global model norm: 43.204034800546985.
Norm before scaling: 43.180461392784466. Distance: 1.417423616399927
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0296, Accuracy: 9822/9900 (99.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5579/5777 (96.5726%), train_poison_data_count: 455
Global model norm: 43.204034800546985.
Norm before scaling: 43.173985708898684. Distance: 1.4390709627215368
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0649, Accuracy: 9734/9900 (98.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4915/5123 (95.9399%), train_poison_data_count: 403
Global model norm: 43.204034800546985.
Norm before scaling: 43.18070027195671. Distance: 1.4119814739632923
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0848, Accuracy: 9664/9900 (97.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5271/5503 (95.7841%), train_poison_data_count: 430
Global model norm: 43.204034800546985.
Norm before scaling: 43.18158792972779. Distance: 1.5085030985324028
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0264, Accuracy: 9836/9900 (99.3535%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5405/5871 (92.0627%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5368/5871 (91.4325%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0356, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4704/5193 (90.5835%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4518/5193 (87.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3411, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5007/5559 (90.0702%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4910/5559 (88.3252%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1619, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4437/4843 (91.6168%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4434/4843 (91.5548%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0492, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4320/4672 (92.4658%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4328/4672 (92.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8104, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4731/5075 (93.2217%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4691/5075 (92.4335%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1670, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4419/4851 (91.0946%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4431/4851 (91.3420%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0392, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4741/5209 (91.0156%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4687/5209 (89.9789%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1652, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5265/5696 (92.4333%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5149/5696 (90.3968%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1515, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4650/5122 (90.7848%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4333/5122 (84.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.4356, Accuracy: 4897/10000 (48.9700%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4318/4741 (91.0778%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4149/4741 (87.5132%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3841, Accuracy: 4995/10000 (49.9500%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4324/4797 (90.1397%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4298/4797 (89.5977%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0375, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3963/4196 (94.4471%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3954/4196 (94.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7939, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3757/4111 (91.3890%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3746/4111 (91.1214%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0136, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4473/4869 (91.8669%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4115/4869 (84.5143%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3003, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5036/5645 (89.2117%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5018/5645 (88.8928%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9746, Accuracy: 5399/10000 (53.9900%)
time spent on training: 259.3125534057617
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1833, Accuracy: 6892/10000 (68.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2291, Accuracy: 9264/9900 (93.5758%)
Done in 286.2488787174225 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 16, 83, 76, 93, 11, 51, 92, 61, 72, 59, 60, 3, 30, 80, 49, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5125/5308 (96.5524%), train_poison_data_count: 415
Global model norm: 43.22719153369352.
Norm before scaling: 43.20248360735468. Distance: 1.4296916690619712
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0522, Accuracy: 9759/9900 (98.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5601/5777 (96.9534%), train_poison_data_count: 455
Global model norm: 43.22719153369352.
Norm before scaling: 43.19280787751301. Distance: 1.3719705239930446
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0328, Accuracy: 9813/9900 (99.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4920/5123 (96.0375%), train_poison_data_count: 403
Global model norm: 43.22719153369352.
Norm before scaling: 43.20306990276776. Distance: 1.4310703781223628
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1111, Accuracy: 9604/9900 (97.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5313/5503 (96.5473%), train_poison_data_count: 430
Global model norm: 43.22719153369352.
Norm before scaling: 43.20096909177791. Distance: 1.4167014099049453
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1085, Accuracy: 9602/9900 (96.9899%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4885/5353 (91.2572%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4864/5353 (90.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0067, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3221/3552 (90.6813%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3305/3552 (93.0462%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7911, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3593/3959 (90.7552%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3646/3959 (92.0940%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8426, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4581/5055 (90.6231%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4496/5055 (88.9416%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2728, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4928/5702 (86.4258%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   2,  Average loss: 0.0118, Accuracy: 4418/5702 (77.4816%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3440, Accuracy: 4895/10000 (48.9500%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3809/4108 (92.7215%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3796/4108 (92.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9508, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 6299/6812 (92.4692%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6230/6812 (91.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0761, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4127/4485 (92.0178%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3959/4485 (88.2720%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0695, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4719/5193 (90.8723%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4552/5193 (87.6565%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3661, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4156/4397 (94.5190%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4208/4397 (95.7016%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.6871, Accuracy: 6002/10000 (60.0200%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3798/4145 (91.6285%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3810/4145 (91.9180%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0091, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4992/5346 (93.3782%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4987/5346 (93.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9826, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3478/3774 (92.1569%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3537/3774 (93.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8985, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5047/5461 (92.4190%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5056/5461 (92.5838%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1497, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5071/5652 (89.7205%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5001/5652 (88.4820%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1090, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5553/5939 (93.5006%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5521/5939 (92.9618%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0084, Accuracy: 5417/10000 (54.1700%)
time spent on training: 256.2059531211853
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1914, Accuracy: 6874/10000 (68.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2086, Accuracy: 9307/9900 (94.0101%)
Done in 282.83300137519836 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 61, 73, 22, 98, 14, 33, 5, 2, 32, 21, 53, 79, 12, 10, 76, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5135/5308 (96.7408%), train_poison_data_count: 415
Global model norm: 43.247125254442494.
Norm before scaling: 43.220728499995374. Distance: 1.376009570471061
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0449, Accuracy: 9777/9900 (98.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5591/5777 (96.7803%), train_poison_data_count: 455
Global model norm: 43.247125254442494.
Norm before scaling: 43.214155745958266. Distance: 1.3839861097548356
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0835, Accuracy: 9676/9900 (97.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4914/5123 (95.9204%), train_poison_data_count: 403
Global model norm: 43.247125254442494.
Norm before scaling: 43.22247814722682. Distance: 1.415458116947269
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0868, Accuracy: 9690/9900 (97.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5319/5503 (96.6564%), train_poison_data_count: 430
Global model norm: 43.247125254442494.
Norm before scaling: 43.220885250940896. Distance: 1.4348774082041669
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1181, Accuracy: 9589/9900 (96.8586%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4120/4485 (91.8618%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3916/4485 (87.3133%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1635, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4311/4605 (93.6156%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4299/4605 (93.3550%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9111, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5299/5696 (93.0302%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5215/5696 (91.5555%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9885, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3847/4161 (92.4537%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3815/4161 (91.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2357, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3972/4196 (94.6616%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3980/4196 (94.8522%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.7773, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4404/4818 (91.4072%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4268/4818 (88.5845%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0064, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4663/4993 (93.3907%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4663/4993 (93.3907%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0786, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3667/3968 (92.4143%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3671/3968 (92.5151%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9222, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5396/6080 (88.7500%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5392/6080 (88.6842%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1534, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4602/5038 (91.3458%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4605/5038 (91.4053%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9125, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5854/6664 (87.8451%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   2,  Average loss: 0.0089, Accuracy: 5490/6664 (82.3830%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.8644, Accuracy: 4381/10000 (43.8100%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3803/4111 (92.5079%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3811/4111 (92.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1353, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5010/5526 (90.6623%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4823/5526 (87.2783%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1957, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4756/5068 (93.8437%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4664/5068 (92.0284%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0607, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3612/3959 (91.2352%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3692/3959 (93.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8368, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4092/4368 (93.6813%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4084/4368 (93.4982%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9710, Accuracy: 5510/10000 (55.1000%)
time spent on training: 250.39490938186646
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1915, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1953, Accuracy: 9335/9900 (94.2929%)
Done in 277.3886420726776 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 73, 72, 84, 40, 22, 51, 8, 54, 34, 27, 68, 82, 65, 7, 14, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5133/5308 (96.7031%), train_poison_data_count: 415
Global model norm: 43.26683395972529.
Norm before scaling: 43.2404873480139. Distance: 1.390761765173301
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1112, Accuracy: 9617/9900 (97.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5605/5777 (97.0227%), train_poison_data_count: 455
Global model norm: 43.26683395972529.
Norm before scaling: 43.23393595051736. Distance: 1.378835703312224
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1052, Accuracy: 9629/9900 (97.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4904/5123 (95.7252%), train_poison_data_count: 403
Global model norm: 43.26683395972529.
Norm before scaling: 43.24227289399879. Distance: 1.4280031214821516
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0871, Accuracy: 9662/9900 (97.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5308/5503 (96.4565%), train_poison_data_count: 430
Global model norm: 43.26683395972529.
Norm before scaling: 43.24121851330771. Distance: 1.4592494902460391
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1282, Accuracy: 9548/9900 (96.4444%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4308/4605 (93.5505%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4291/4605 (93.1813%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9367, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4751/5193 (91.4885%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4429/5193 (85.2879%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3842, Accuracy: 4840/10000 (48.4000%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4766/5209 (91.4955%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4697/5209 (90.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0486, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5505/5939 (92.6924%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5475/5939 (92.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0054, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5313/5696 (93.2760%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5231/5696 (91.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1309, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3800/4108 (92.5024%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3707/4108 (90.2386%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0015, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4468/4889 (91.3888%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4464/4889 (91.3070%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0419, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5059/5645 (89.6191%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4871/5645 (86.2888%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3037, Accuracy: 4929/10000 (49.2900%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4539/4911 (92.4252%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4536/4911 (92.3641%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9945, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4158/4587 (90.6475%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4202/4587 (91.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0292, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3338/3589 (93.0064%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3162/3589 (88.1025%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2858, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4948/5298 (93.3937%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4916/5298 (92.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0005, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5042/5497 (91.7228%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4931/5497 (89.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1251, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4424/4869 (90.8605%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4176/4869 (85.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2907, Accuracy: 4969/10000 (49.6900%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3979/4196 (94.8284%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3976/4196 (94.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7537, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3671/3968 (92.5151%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3683/3968 (92.8175%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7450, Accuracy: 5880/10000 (58.8000%)
time spent on training: 251.05117440223694
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1935, Accuracy: 6850/10000 (68.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1995, Accuracy: 9335/9900 (94.2929%)
Done in 277.87190556526184 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 98, 90, 19, 60, 20, 39, 86, 78, 25, 23, 28, 34, 4, 9, 5, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Significant loss increase detected for 13 at epoch 110: Current loss: 0.1592, Previous loss: 0.0789, Loss jump: 0.0803, Applied weight: -0.0370
Significant loss increase detected for 13 at epoch 110: Current loss: 0.2102, Previous loss: 0.1388, Loss jump: 0.0715, Applied weight: 0.7348
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5133/5308 (96.7031%), train_poison_data_count: 415
Global model norm: 43.28789152562614.
Norm before scaling: 43.26223493625459. Distance: 1.4002235983355278
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0319, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5615/5777 (97.1958%), train_poison_data_count: 455
Global model norm: 43.28789152562614.
Norm before scaling: 43.25539333695135. Distance: 1.367397706357029
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0434, Accuracy: 9784/9900 (98.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4893/5123 (95.5104%), train_poison_data_count: 403
Global model norm: 43.28789152562614.
Norm before scaling: 43.26391659908043. Distance: 1.443175679701009
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2135, Accuracy: 9359/9900 (94.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5320/5503 (96.6745%), train_poison_data_count: 430
Global model norm: 43.28789152562614.
Norm before scaling: 43.25983365672842. Distance: 1.4013649757713382
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0268, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3868/4161 (92.9584%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3763/4161 (90.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0510, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4425/4748 (93.1971%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4432/4748 (93.3446%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9630, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4884/5361 (91.1024%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4841/5361 (90.3003%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8585, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3813/4145 (91.9903%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3846/4145 (92.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9200, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4433/4714 (94.0390%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4384/4714 (92.9996%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0292, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3832/4175 (91.7844%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3793/4175 (90.8503%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0890, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3577/3929 (91.0410%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3561/3929 (90.6337%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9536, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4084/4368 (93.4982%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4075/4368 (93.2921%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9316, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5764/6419 (89.7959%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5548/6419 (86.4309%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1618, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4296/4549 (94.4383%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3992/4549 (87.7556%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1342, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4581/5122 (89.4377%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   2,  Average loss: 0.0143, Accuracy: 3812/5122 (74.4241%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.5667, Accuracy: 4524/10000 (45.2400%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4559/4911 (92.8324%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4569/4911 (93.0360%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9962, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3723/4028 (92.4280%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3725/4028 (92.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8178, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5173/5727 (90.3265%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5113/5727 (89.2789%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1462, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4702/4993 (94.1718%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4642/4993 (92.9702%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1028, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4421/4714 (93.7845%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4416/4714 (93.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0613, Accuracy: 5522/10000 (55.2200%)
time spent on training: 240.25095534324646
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1908, Accuracy: 6860/10000 (68.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1929, Accuracy: 9360/9900 (94.5455%)
Done in 267.01247572898865 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 80, 69, 20, 50, 3, 73, 15, 77, 35, 56, 55, 18, 47, 21, 5, 43].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5149/5308 (97.0045%), train_poison_data_count: 415
Global model norm: 43.306827674654116.
Norm before scaling: 43.277415500267715. Distance: 1.3041828572951153
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0352, Accuracy: 9812/9900 (99.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5607/5777 (97.0573%), train_poison_data_count: 455
Global model norm: 43.306827674654116.
Norm before scaling: 43.2737978692794. Distance: 1.3756590477535482
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0771, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4918/5123 (95.9984%), train_poison_data_count: 403
Global model norm: 43.306827674654116.
Norm before scaling: 43.2807211723108. Distance: 1.3740869438282348
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1064, Accuracy: 9625/9900 (97.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5302/5503 (96.3474%), train_poison_data_count: 430
Global model norm: 43.306827674654116.
Norm before scaling: 43.28258402727505. Distance: 1.4812388166174448
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1542, Accuracy: 9489/9900 (95.8485%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4963/5461 (90.8808%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4944/5461 (90.5329%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1203, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3999/4364 (91.6361%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3907/4364 (89.5280%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0502, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4430/4714 (93.9754%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4431/4714 (93.9966%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8699, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4354/4757 (91.5283%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4289/4757 (90.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0859, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5006/5346 (93.6401%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4875/5346 (91.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1658, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4302/4605 (93.4202%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4344/4605 (94.3322%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8642, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5540/6068 (91.2986%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5514/6068 (90.8701%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1600, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4534/5050 (89.7822%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4494/5050 (88.9901%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0573, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5121/5615 (91.2021%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5065/5615 (90.2048%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0483, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4916/5427 (90.5841%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4904/5427 (90.3630%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0839, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4392/4731 (92.8345%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4360/4731 (92.1581%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9829, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3932/4249 (92.5394%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3898/4249 (91.7392%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9356, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4628/5123 (90.3377%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4155/5123 (81.1048%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2628, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4646/5038 (92.2191%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4605/5038 (91.4053%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9183, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4738/4993 (94.8928%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4668/4993 (93.4909%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1231, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4600/4979 (92.3880%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4630/4979 (92.9906%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0816, Accuracy: 5446/10000 (54.4600%)
time spent on training: 245.92993450164795
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1845, Accuracy: 6884/10000 (68.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1940, Accuracy: 9363/9900 (94.5758%)
Done in 272.81134557724 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 56, 14, 4, 30, 82, 85, 39, 70, 91, 59, 1, 88, 49, 34, 53, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5144/5308 (96.9103%), train_poison_data_count: 415
Global model norm: 43.32807147039607.
Norm before scaling: 43.29894860380922. Distance: 1.3473187010041465
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0325, Accuracy: 9815/9900 (99.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5603/5777 (96.9881%), train_poison_data_count: 455
Global model norm: 43.32807147039607.
Norm before scaling: 43.2936269532321. Distance: 1.3651112513217036
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0624, Accuracy: 9734/9900 (98.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4933/5123 (96.2912%), train_poison_data_count: 403
Global model norm: 43.32807147039607.
Norm before scaling: 43.30215678492888. Distance: 1.3932088357267924
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0700, Accuracy: 9699/9900 (97.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5301/5503 (96.3293%), train_poison_data_count: 430
Global model norm: 43.32807147039607.
Norm before scaling: 43.30063447905888. Distance: 1.4302417118690522
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0746, Accuracy: 9696/9900 (97.9394%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4877/5427 (89.8655%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4907/5427 (90.4183%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1194, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3961/4196 (94.3994%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3980/4196 (94.8522%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9396, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3707/4028 (92.0308%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3744/4028 (92.9494%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8568, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3529/3774 (93.5082%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3582/3774 (94.9126%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7856, Accuracy: 5917/10000 (59.1700%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4935/5298 (93.1484%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4903/5298 (92.5444%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0500, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6337/6947 (91.2192%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6090/6947 (87.6637%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2920, Accuracy: 5001/10000 (50.0100%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3808/4175 (91.2096%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3809/4175 (91.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0755, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5410/5871 (92.1478%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5355/5871 (91.2110%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1034, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4110/4527 (90.7886%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4069/4527 (89.8829%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8554, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4172/4397 (94.8829%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4173/4397 (94.9056%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7820, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5085/5422 (93.7846%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5021/5422 (92.6042%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9544, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4929/5362 (91.9247%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4859/5362 (90.6192%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1157, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5068/5652 (89.6674%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5080/5652 (89.8797%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1568, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4530/4911 (92.2419%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4542/4911 (92.4863%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9463, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5835/6664 (87.5600%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5647/6664 (84.7389%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2160, Accuracy: 5001/10000 (50.0100%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4582/5055 (90.6429%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4521/5055 (89.4362%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1398, Accuracy: 5295/10000 (52.9500%)
time spent on training: 250.22496962547302
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1897, Accuracy: 6861/10000 (68.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1786, Accuracy: 9404/9900 (94.9899%)
Done in 276.88431310653687 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 98, 78, 33, 79, 16, 3, 62, 30, 39, 1, 15, 6, 50, 93, 66, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5142/5308 (96.8726%), train_poison_data_count: 415
Global model norm: 43.34826715827289.
Norm before scaling: 43.320514680547134. Distance: 1.3792104412557646
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0348, Accuracy: 9813/9900 (99.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5591/5777 (96.7803%), train_poison_data_count: 455
Global model norm: 43.34826715827289.
Norm before scaling: 43.31618062463783. Distance: 1.4302207911042137
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0565, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4911/5123 (95.8618%), train_poison_data_count: 403
Global model norm: 43.34826715827289.
Norm before scaling: 43.32300839785512. Distance: 1.4290018574226753
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0865, Accuracy: 9666/9900 (97.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5298/5503 (96.2748%), train_poison_data_count: 430
Global model norm: 43.34826715827289.
Norm before scaling: 43.32208982490197. Distance: 1.4546772039686233
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0439, Accuracy: 9782/9900 (98.8081%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3883/4161 (93.3189%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3821/4161 (91.8289%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0689, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4120/4368 (94.3223%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4058/4368 (92.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9545, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4325/4818 (89.7675%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4342/4818 (90.1204%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9479, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3814/4111 (92.7755%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3803/4111 (92.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2304, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4892/5353 (91.3880%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4822/5353 (90.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9154, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4995/5346 (93.4343%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4989/5346 (93.3221%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2034, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4868/5504 (88.4448%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4765/5504 (86.5734%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2769, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3499/3774 (92.7133%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3540/3774 (93.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8791, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3855/4175 (92.3353%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3816/4175 (91.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0111, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5075/5422 (93.6001%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5040/5422 (92.9546%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8637, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5592/6068 (92.1556%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5506/6068 (90.7383%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1762, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4564/4929 (92.5948%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4491/4929 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0700, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4402/4757 (92.5373%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4264/4757 (89.6363%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1798, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4628/5055 (91.5529%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4570/5055 (90.4055%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9798, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4472/4843 (92.3395%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4446/4843 (91.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9469, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4713/5035 (93.6048%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4701/5035 (93.3664%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0127, Accuracy: 5557/10000 (55.5700%)
time spent on training: 248.12241649627686
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.1930, Accuracy: 6857/10000 (68.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1697, Accuracy: 9422/9900 (95.1717%)
Done in 274.7570331096649 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 33, 91, 10, 81, 5, 93, 90, 24, 64, 16, 9, 18, 27, 2, 67, 82].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5144/5308 (96.9103%), train_poison_data_count: 415
Global model norm: 43.36835070386511.
Norm before scaling: 43.339097172760766. Distance: 1.3412370916138263
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0511, Accuracy: 9760/9900 (98.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5599/5777 (96.9188%), train_poison_data_count: 455
Global model norm: 43.36835070386511.
Norm before scaling: 43.332555049851806. Distance: 1.3429408187580205
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0432, Accuracy: 9787/9900 (98.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4919/5123 (96.0180%), train_poison_data_count: 403
Global model norm: 43.36835070386511.
Norm before scaling: 43.341715153659266. Distance: 1.4123097300027314
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0850, Accuracy: 9685/9900 (97.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5307/5503 (96.4383%), train_poison_data_count: 430
Global model norm: 43.36835070386511.
Norm before scaling: 43.34040547884056. Distance: 1.440031476339073
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0577, Accuracy: 9752/9900 (98.5051%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4420/4818 (91.7393%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4291/4818 (89.0619%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1242, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4073/4527 (89.9713%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4027/4527 (88.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1127, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4705/5068 (92.8374%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4601/5068 (90.7853%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2657, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4694/5035 (93.2274%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4713/5035 (93.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9438, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4757/4993 (95.2734%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4659/4993 (93.3106%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1413, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4550/5055 (90.0099%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4577/5055 (90.5440%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1478, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4442/4748 (93.5552%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4364/4748 (91.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1269, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3994/4313 (92.6038%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3980/4313 (92.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9454, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4342/4894 (88.7209%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4284/4894 (87.5358%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1376, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4945/5353 (92.3781%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4821/5353 (90.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0698, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5137/5727 (89.6979%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5017/5727 (87.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2436, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3927/4249 (92.4217%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3930/4249 (92.4924%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9604, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4163/4587 (90.7565%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4094/4587 (89.2522%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1491, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3668/3968 (92.4395%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3681/3968 (92.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9123, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4997/5559 (89.8903%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4971/5559 (89.4226%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1429, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4913/5298 (92.7331%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4932/5298 (93.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0581, Accuracy: 5453/10000 (54.5300%)
time spent on training: 244.7075548171997
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.1984, Accuracy: 6848/10000 (68.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1579, Accuracy: 9469/9900 (95.6465%)
Done in 271.52537989616394 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 33, 82, 16, 30, 63, 31, 53, 84, 47, 60, 12, 92, 42, 39, 44, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5155/5308 (97.1176%), train_poison_data_count: 415
Global model norm: 43.389339308463775.
Norm before scaling: 43.359596001689034. Distance: 1.330799640897055
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0740, Accuracy: 9715/9900 (98.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5615/5777 (97.1958%), train_poison_data_count: 455
Global model norm: 43.389339308463775.
Norm before scaling: 43.35267403174947. Distance: 1.3435732703095986
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0489, Accuracy: 9769/9900 (98.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4931/5123 (96.2522%), train_poison_data_count: 403
Global model norm: 43.389339308463775.
Norm before scaling: 43.36286585046732. Distance: 1.4054111097813864
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0763, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5310/5503 (96.4928%), train_poison_data_count: 430
Global model norm: 43.389339308463775.
Norm before scaling: 43.359313063018824. Distance: 1.3922576749606872
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0484, Accuracy: 9775/9900 (98.7374%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4384/4818 (90.9921%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4317/4818 (89.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0729, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5021/5298 (94.7716%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4940/5298 (93.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1392, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4952/5353 (92.5089%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4832/5353 (90.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0430, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3543/3774 (93.8792%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3508/3774 (92.9518%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9102, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3628/3910 (92.7877%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3559/3910 (91.0230%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0920, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4176/4537 (92.0432%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4140/4537 (91.2497%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9263, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5922/6664 (88.8655%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   2,  Average loss: 0.0081, Accuracy: 5637/6664 (84.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2654, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4728/5209 (90.7660%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4664/5209 (89.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1975, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4623/5123 (90.2401%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   2,  Average loss: 0.0120, Accuracy: 4008/5123 (78.2354%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3105, Accuracy: 4837/10000 (48.3700%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3854/4145 (92.9795%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3813/4145 (91.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0307, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5084/5526 (92.0014%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4965/5526 (89.8480%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1373, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6336/6812 (93.0123%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6207/6812 (91.1186%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1150, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5412/5907 (91.6201%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5394/5907 (91.3154%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2115, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3862/4175 (92.5030%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3831/4175 (91.7605%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9983, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4717/5075 (92.9458%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4646/5075 (91.5468%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2301, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3813/4111 (92.7512%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3760/4111 (91.4619%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9430, Accuracy: 5559/10000 (55.5900%)
time spent on training: 247.24602556228638
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.2032, Accuracy: 6843/10000 (68.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1536, Accuracy: 9476/9900 (95.7172%)
Done in 273.8423898220062 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 41, 49, 96, 89, 92, 44, 42, 48, 23, 22, 76, 75, 29, 6, 15, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5143/5308 (96.8915%), train_poison_data_count: 415
Global model norm: 43.40984815675111.
Norm before scaling: 43.38037216821826. Distance: 1.3465324249414725
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0529, Accuracy: 9760/9900 (98.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5607/5777 (97.0573%), train_poison_data_count: 455
Global model norm: 43.40984815675111.
Norm before scaling: 43.37623123927939. Distance: 1.3968390594569573
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0601, Accuracy: 9732/9900 (98.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4930/5123 (96.2327%), train_poison_data_count: 403
Global model norm: 43.40984815675111.
Norm before scaling: 43.38200563696817. Distance: 1.361611904520111
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0870, Accuracy: 9670/9900 (97.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5293/5503 (96.1839%), train_poison_data_count: 430
Global model norm: 43.40984815675111.
Norm before scaling: 43.38432699837077. Distance: 1.4730650640440512
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0383, Accuracy: 9802/9900 (99.0101%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4392/4714 (93.1693%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4386/4714 (93.0420%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1829, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5038/5652 (89.1366%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5007/5652 (88.5881%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3784, Accuracy: 4989/10000 (49.8900%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4680/5086 (92.0173%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4660/5086 (91.6241%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9958, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4302/4737 (90.8170%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4288/4737 (90.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2489, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6384/6812 (93.7170%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6273/6812 (92.0875%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1929, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4698/5075 (92.5714%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4704/5075 (92.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0191, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5425/5907 (91.8402%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5268/5907 (89.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3076, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4493/4830 (93.0228%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4536/4830 (93.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1825, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4293/4549 (94.3724%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3939/4549 (86.5905%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2788, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5259/5696 (92.3279%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5192/5696 (91.1517%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0473, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3613/3959 (91.2604%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3626/3959 (91.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8655, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4358/4672 (93.2791%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4341/4672 (92.9152%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9793, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4409/4732 (93.1741%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4395/4732 (92.8783%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8478, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4558/4929 (92.4731%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4447/4929 (90.2211%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1712, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5626/6068 (92.7159%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5525/6068 (91.0514%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1379, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3592/3995 (89.9124%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3586/3995 (89.7622%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1638, Accuracy: 5293/10000 (52.9300%)
time spent on training: 249.0470585823059
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2091, Accuracy: 6845/10000 (68.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1453, Accuracy: 9499/9900 (95.9495%)
Done in 275.8460910320282 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 5, 39, 78, 34, 63, 68, 55, 14, 81, 75, 43, 73, 11, 3, 70, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5112/5308 (96.3075%), train_poison_data_count: 415
Global model norm: 43.43097832112106.
Norm before scaling: 43.403832782316734. Distance: 1.3953540842794856
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0599, Accuracy: 9727/9900 (98.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5591/5777 (96.7803%), train_poison_data_count: 455
Global model norm: 43.43097832112106.
Norm before scaling: 43.39837350917875. Distance: 1.4091288451013122
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0557, Accuracy: 9758/9900 (98.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4909/5123 (95.8228%), train_poison_data_count: 403
Global model norm: 43.43097832112106.
Norm before scaling: 43.40595752241275. Distance: 1.4543036326236782
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0162, Accuracy: 9854/9900 (99.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5334/5503 (96.9289%), train_poison_data_count: 430
Global model norm: 43.43097832112106.
Norm before scaling: 43.40039585477951. Distance: 1.3474768920077753
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0481, Accuracy: 9769/9900 (98.6768%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4687/4993 (93.8714%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4634/4993 (92.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1044, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3836/4175 (91.8802%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3771/4175 (90.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0883, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4132/4368 (94.5971%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4076/4368 (93.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0668, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4505/4911 (91.7328%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4451/4911 (90.6333%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0973, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3647/3910 (93.2737%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3463/3910 (88.5678%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1087, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3321/3589 (92.5327%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3232/3589 (90.0529%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2904, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4397/4731 (92.9402%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4388/4731 (92.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9627, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3999/4196 (95.3051%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3975/4196 (94.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8333, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4678/5035 (92.9096%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4610/5035 (91.5591%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1362, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4338/4672 (92.8510%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4369/4672 (93.5146%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8057, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4567/4979 (91.7252%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4513/4979 (90.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1584, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4299/4605 (93.3550%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4343/4605 (94.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9658, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4958/5702 (86.9519%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4763/5702 (83.5321%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2858, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5034/5346 (94.1639%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5007/5346 (93.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0977, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5442/5871 (92.6929%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5342/5871 (90.9896%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1026, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5085/5645 (90.0797%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5047/5645 (89.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1322, Accuracy: 5264/10000 (52.6400%)
time spent on training: 243.29413175582886
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2060, Accuracy: 6852/10000 (68.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1417, Accuracy: 9511/9900 (96.0707%)
Done in 269.9679145812988 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 53, 62, 44, 64, 3, 63, 32, 24, 73, 6, 54, 16, 25, 82, 84, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.45091407086564.
Norm before scaling: 43.4201094909159. Distance: 1.2841567120835642
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0427, Accuracy: 9787/9900 (98.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5617/5777 (97.2304%), train_poison_data_count: 455
Global model norm: 43.45091407086564.
Norm before scaling: 43.4154873405289. Distance: 1.3583549969745707
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0725, Accuracy: 9685/9900 (97.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4935/5123 (96.3303%), train_poison_data_count: 403
Global model norm: 43.45091407086564.
Norm before scaling: 43.42313864435138. Distance: 1.36712498113195
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0706, Accuracy: 9725/9900 (98.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5337/5503 (96.9835%), train_poison_data_count: 430
Global model norm: 43.45091407086564.
Norm before scaling: 43.4205986678198. Distance: 1.3613276433738613
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0949, Accuracy: 9635/9900 (97.3232%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5916/6664 (88.7755%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   2,  Average loss: 0.0086, Accuracy: 5578/6664 (83.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.3176, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4837/5504 (87.8815%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4828/5504 (87.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1799, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4743/5075 (93.4581%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4677/5075 (92.1576%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1545, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4388/4894 (89.6608%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4285/4894 (87.5562%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1811, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5021/5346 (93.9207%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4929/5346 (92.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0551, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3623/3910 (92.6598%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3484/3910 (89.1049%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0786, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5403/6080 (88.8651%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5388/6080 (88.6184%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4657, Accuracy: 4875/10000 (48.7500%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4039/4313 (93.6471%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3990/4313 (92.5110%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8849, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4313/4605 (93.6591%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4338/4605 (94.2020%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7486, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4582/4929 (92.9600%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4501/4929 (91.3167%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0299, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5056/5645 (89.5660%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4875/5645 (86.3596%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2540, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4941/5353 (92.3034%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4842/5353 (90.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9829, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5719/6419 (89.0949%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5464/6419 (85.1223%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4406, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5021/5298 (94.7716%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4964/5298 (93.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9794, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4739/5209 (90.9772%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4681/5209 (89.8637%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1472, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4369/4714 (92.6814%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4348/4714 (92.2359%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1065, Accuracy: 5385/10000 (53.8500%)
time spent on training: 250.60895538330078
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2100, Accuracy: 6844/10000 (68.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1322, Accuracy: 9539/9900 (96.3535%)
Done in 277.4688720703125 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 20, 31, 38, 91, 81, 60, 39, 47, 52, 84, 79, 21, 4, 77, 8, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5168/5308 (97.3625%), train_poison_data_count: 415
Global model norm: 43.47261816676605.
Norm before scaling: 43.43946291652974. Distance: 1.2647462313630389
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0782, Accuracy: 9699/9900 (97.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5603/5777 (96.9881%), train_poison_data_count: 455
Global model norm: 43.47261816676605.
Norm before scaling: 43.43707564990564. Distance: 1.361683781273878
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0663, Accuracy: 9725/9900 (98.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4903/5123 (95.7056%), train_poison_data_count: 403
Global model norm: 43.47261816676605.
Norm before scaling: 43.44761713339769. Distance: 1.4557771987588441
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0966, Accuracy: 9652/9900 (97.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5310/5503 (96.4928%), train_poison_data_count: 430
Global model norm: 43.47261816676605.
Norm before scaling: 43.44280262148582. Distance: 1.38066913421947
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0292, Accuracy: 9824/9900 (99.2323%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4375/4714 (92.8087%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4377/4714 (92.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8447, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4209/4537 (92.7706%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4202/4537 (92.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8379, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5606/6235 (89.9118%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5496/6235 (88.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3391, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4063/4527 (89.7504%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3996/4527 (88.2704%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1069, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4712/5035 (93.5849%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4708/5035 (93.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9284, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3788/4145 (91.3872%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3787/4145 (91.3631%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0112, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3856/4175 (92.3593%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3804/4175 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1825, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4627/5123 (90.3182%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   2,  Average loss: 0.0145, Accuracy: 3759/5123 (73.3750%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3762, Accuracy: 4815/10000 (48.1500%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3894/4130 (94.2857%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3845/4130 (93.0993%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9149, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4785/5209 (91.8602%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4700/5209 (90.2285%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2269, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3819/4111 (92.8971%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3792/4111 (92.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9870, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4633/5038 (91.9611%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4589/5038 (91.0877%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0144, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3760/4028 (93.3466%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3781/4028 (93.8679%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.7888, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4554/5050 (90.1782%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4528/5050 (89.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2158, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4487/4889 (91.7775%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4386/4889 (89.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0405, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4041/4364 (92.5985%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3968/4364 (90.9258%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9091, Accuracy: 5538/10000 (55.3800%)
time spent on training: 242.70926642417908
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2093, Accuracy: 6852/10000 (68.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1234, Accuracy: 9566/9900 (96.6263%)
Done in 269.43128657341003 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 72, 30, 96, 38, 62, 1, 31, 88, 21, 34, 43, 37, 10, 83, 93, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5156/5308 (97.1364%), train_poison_data_count: 415
Global model norm: 43.49181771331031.
Norm before scaling: 43.4611249827432. Distance: 1.3119594278197235
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0426, Accuracy: 9779/9900 (98.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5623/5777 (97.3343%), train_poison_data_count: 455
Global model norm: 43.49181771331031.
Norm before scaling: 43.45359975918278. Distance: 1.3119614722479795
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0577, Accuracy: 9748/9900 (98.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4943/5123 (96.4864%), train_poison_data_count: 403
Global model norm: 43.49181771331031.
Norm before scaling: 43.46339718120582. Distance: 1.3619836791372826
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1754, Accuracy: 9459/9900 (95.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5309/5503 (96.4747%), train_poison_data_count: 430
Global model norm: 43.49181771331031.
Norm before scaling: 43.465166548915924. Distance: 1.432419880994871
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1040, Accuracy: 9623/9900 (97.2020%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4773/5193 (91.9122%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4524/5193 (87.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2768, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3506/3774 (92.8988%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3502/3774 (92.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8353, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4663/5086 (91.6831%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4637/5086 (91.1718%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0075, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5598/6235 (89.7835%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5521/6235 (88.5485%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.4687, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4900/5504 (89.0262%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4849/5504 (88.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0803, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5098/5422 (94.0243%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5052/5422 (93.1759%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0503, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4228/4537 (93.1893%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4174/4537 (91.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9179, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4954/5362 (92.3909%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4910/5362 (91.5703%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0576, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4599/5038 (91.2862%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4576/5038 (90.8297%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9741, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4554/4911 (92.7306%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4565/4911 (92.9546%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0610, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4622/4979 (92.8299%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4556/4979 (91.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0292, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4332/4741 (91.3731%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3806/4741 (80.2784%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.5176, Accuracy: 4611/10000 (46.1100%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4741/5068 (93.5478%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4637/5068 (91.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0847, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3267/3552 (91.9764%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3287/3552 (92.5394%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8199, Accuracy: 5921/10000 (59.2100%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4675/5055 (92.4827%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4585/5055 (90.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1502, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3657/3959 (92.3718%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3638/3959 (91.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0073, Accuracy: 5511/10000 (55.1100%)
time spent on training: 244.80280542373657
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2112, Accuracy: 6839/10000 (68.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1212, Accuracy: 9568/9900 (96.6465%)
Done in 271.6963918209076 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 86, 74, 94, 24, 51, 84, 63, 26, 28, 88, 55, 2, 33, 98, 34, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5159/5308 (97.1929%), train_poison_data_count: 415
Global model norm: 43.51150816477679.
Norm before scaling: 43.478621216980734. Distance: 1.2711330696125156
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0572, Accuracy: 9748/9900 (98.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5623/5777 (97.3343%), train_poison_data_count: 455
Global model norm: 43.51150816477679.
Norm before scaling: 43.476188368785564. Distance: 1.3431518465379395
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1376, Accuracy: 9571/9900 (96.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4914/5123 (95.9204%), train_poison_data_count: 403
Global model norm: 43.51150816477679.
Norm before scaling: 43.48349211958559. Distance: 1.3948826707700324
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0569, Accuracy: 9737/9900 (98.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5336/5503 (96.9653%), train_poison_data_count: 430
Global model norm: 43.51150816477679.
Norm before scaling: 43.48122097122432. Distance: 1.3559747020983515
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0194, Accuracy: 9862/9900 (99.6162%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3572/3929 (90.9137%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3543/3929 (90.1756%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9744, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4382/4797 (91.3488%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4288/4797 (89.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1095, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4712/5224 (90.1991%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4701/5224 (89.9885%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1705, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4038/4313 (93.6239%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4052/4313 (93.9485%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7481, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3836/4108 (93.3788%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3830/4108 (93.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9192, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4723/5209 (90.6700%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4672/5209 (89.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1770, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3657/3910 (93.5294%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3641/3910 (93.1202%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0002, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3828/4086 (93.6858%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3804/4086 (93.0984%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1233, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4596/5122 (89.7306%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4325/5122 (84.4397%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.4038, Accuracy: 4802/10000 (48.0200%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4913/5362 (91.6263%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4819/5362 (89.8732%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1486, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4404/4731 (93.0881%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4390/4731 (92.7922%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9992, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3643/3968 (91.8095%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3635/3968 (91.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8644, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4454/4818 (92.4450%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4353/4818 (90.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0068, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3876/4161 (93.1507%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3739/4161 (89.8582%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9172, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4526/4911 (92.1605%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4537/4911 (92.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0206, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4755/5068 (93.8240%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4756/5068 (93.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9684, Accuracy: 5562/10000 (55.6200%)
time spent on training: 240.5643391609192
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2241, Accuracy: 6818/10000 (68.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1076, Accuracy: 9605/9900 (97.0202%)
Done in 267.5894145965576 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 33, 32, 46, 38, 22, 73, 61, 35, 83, 24, 87, 23, 3, 19, 98, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5169/5308 (97.3813%), train_poison_data_count: 415
Global model norm: 43.53003576465192.
Norm before scaling: 43.49585783080384. Distance: 1.2291507019471735
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0635, Accuracy: 9730/9900 (98.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5620/5777 (97.2823%), train_poison_data_count: 455
Global model norm: 43.53003576465192.
Norm before scaling: 43.494175312710695. Distance: 1.3530744794263914
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0971, Accuracy: 9651/9900 (97.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4932/5123 (96.2717%), train_poison_data_count: 403
Global model norm: 43.53003576465192.
Norm before scaling: 43.500350775345765. Distance: 1.3407626101419896
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1564, Accuracy: 9504/9900 (96.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5323/5503 (96.7291%), train_poison_data_count: 430
Global model norm: 43.53003576465192.
Norm before scaling: 43.499783920979134. Distance: 1.412423295495571
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0825, Accuracy: 9687/9900 (97.8485%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4465/4818 (92.6733%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4272/4818 (88.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1098, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5460/6080 (89.8026%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5361/6080 (88.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2297, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4819/5399 (89.2573%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4687/5399 (86.8124%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2346, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5593/6235 (89.7033%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5472/6235 (87.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2650, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5342/5696 (93.7851%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5229/5696 (91.8013%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9929, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4345/4605 (94.3540%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4361/4605 (94.7014%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8167, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4143/4485 (92.3746%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3993/4485 (89.0301%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1305, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5141/5615 (91.5583%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5129/5615 (91.3446%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1506, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3258/3552 (91.7230%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3297/3552 (92.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7932, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4021/4313 (93.2298%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4046/4313 (93.8094%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7492, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3622/3995 (90.6633%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3560/3995 (89.1114%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2932, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4325/4549 (95.0758%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3983/4549 (87.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1932, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4996/5346 (93.4530%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4978/5346 (93.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0369, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4867/5361 (90.7853%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4801/5361 (89.5542%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1602, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3858/4161 (92.7181%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3839/4161 (92.2615%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1509, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4389/4714 (93.1056%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4422/4714 (93.8057%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0059, Accuracy: 5491/10000 (54.9100%)
time spent on training: 244.55793523788452
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2314, Accuracy: 6802/10000 (68.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1059, Accuracy: 9609/9900 (97.0606%)
Done in 271.4035449028015 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 9, 53, 69, 0, 77, 5, 33, 81, 92, 66, 83, 47, 17, 1, 84, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5180/5308 (97.5885%), train_poison_data_count: 415
Global model norm: 43.55031718544797.
Norm before scaling: 43.515950402733075. Distance: 1.2491246973528076
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1017, Accuracy: 9635/9900 (97.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5613/5777 (97.1612%), train_poison_data_count: 455
Global model norm: 43.55031718544797.
Norm before scaling: 43.513435481271905. Distance: 1.3802220277886605
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0416, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4945/5123 (96.5255%), train_poison_data_count: 403
Global model norm: 43.55031718544797.
Norm before scaling: 43.519784922348826. Distance: 1.3456017354964225
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0836, Accuracy: 9686/9900 (97.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5340/5503 (97.0380%), train_poison_data_count: 430
Global model norm: 43.55031718544797.
Norm before scaling: 43.51858579469595. Distance: 1.3603806557594287
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0455, Accuracy: 9778/9900 (98.7677%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5168/5727 (90.2392%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5041/5727 (88.0217%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0377, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5859/6664 (87.9202%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5738/6664 (86.1044%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1398, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4043/4364 (92.6444%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3955/4364 (90.6279%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9811, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4989/5454 (91.4741%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4825/5454 (88.4672%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1605, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4477/5050 (88.6535%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4406/5050 (87.2475%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0834, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4735/4993 (94.8328%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4658/4993 (93.2906%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0445, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4425/4818 (91.8431%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4289/4818 (89.0203%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9685, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4700/5035 (93.3466%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4680/5035 (92.9494%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9975, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6384/6812 (93.7170%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6287/6812 (92.2930%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1555, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4472/4843 (92.3395%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4464/4843 (92.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1169, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3324/3552 (93.5811%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3331/3552 (93.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8743, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4624/5123 (90.2596%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4374/5123 (85.3797%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.3396, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4480/4903 (91.3726%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4419/4903 (90.1285%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1996, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5117/5422 (94.3748%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5089/5422 (93.8584%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9006, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4752/5209 (91.2267%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4747/5209 (91.1307%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0822, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5304/5696 (93.1180%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5205/5696 (91.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1047, Accuracy: 5329/10000 (53.2900%)
time spent on training: 250.0743329524994
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2318, Accuracy: 6807/10000 (68.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1093, Accuracy: 9606/9900 (97.0303%)
Done in 276.8529679775238 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 33, 99, 27, 61, 22, 75, 85, 54, 11, 37, 60, 21, 32, 64, 29, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5142/5308 (96.8726%), train_poison_data_count: 415
Global model norm: 43.5718078739711.
Norm before scaling: 43.54017485233465. Distance: 1.3192746298527398
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1026, Accuracy: 9640/9900 (97.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5627/5777 (97.4035%), train_poison_data_count: 455
Global model norm: 43.5718078739711.
Norm before scaling: 43.5353032817728. Distance: 1.3529329353030302
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0968, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4939/5123 (96.4084%), train_poison_data_count: 403
Global model norm: 43.5718078739711.
Norm before scaling: 43.54089818151579. Distance: 1.3364616838008343
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1363, Accuracy: 9527/9900 (96.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5312/5503 (96.5292%), train_poison_data_count: 430
Global model norm: 43.5718078739711.
Norm before scaling: 43.54326994406684. Distance: 1.4400189761394973
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0296, Accuracy: 9824/9900 (99.2323%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4448/4818 (92.3205%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4280/4818 (88.8335%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1246, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4451/4851 (91.7543%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4411/4851 (90.9297%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0292, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4238/4587 (92.3915%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4194/4587 (91.4323%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0060, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4137/4485 (92.2408%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3909/4485 (87.1572%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1356, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5321/5696 (93.4164%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5225/5696 (91.7310%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0482, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4351/4672 (93.1293%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4366/4672 (93.4503%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8942, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 6251/6947 (89.9813%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6068/6947 (87.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3329, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5071/5645 (89.8317%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4943/5645 (87.5642%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3300, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4919/5702 (86.2680%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   2,  Average loss: 0.0116, Accuracy: 4423/5702 (77.5693%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2605, Accuracy: 4855/10000 (48.5500%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4323/4741 (91.1833%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4157/4741 (87.6819%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1517, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3826/4145 (92.3040%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3777/4145 (91.1218%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9955, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4658/5038 (92.4573%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4560/5038 (90.5121%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0947, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5384/6080 (88.5526%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5315/6080 (87.4178%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1981, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4407/4894 (90.0490%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4288/4894 (87.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1773, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4447/4732 (93.9772%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4500/4732 (95.0972%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8201, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3940/4249 (92.7277%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3900/4249 (91.7863%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9594, Accuracy: 5673/10000 (56.7300%)
time spent on training: 246.28767895698547
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2310, Accuracy: 6807/10000 (68.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1160, Accuracy: 9592/9900 (96.8889%)
Done in 273.0533068180084 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 53, 50, 93, 1, 7, 79, 52, 24, 16, 28, 10, 62, 86, 47, 98, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5165/5308 (97.3060%), train_poison_data_count: 415
Global model norm: 43.592942140812056.
Norm before scaling: 43.562385110142614. Distance: 1.3125118073431885
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0743, Accuracy: 9691/9900 (97.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5613/5777 (97.1612%), train_poison_data_count: 455
Global model norm: 43.592942140812056.
Norm before scaling: 43.55669768343254. Distance: 1.4012500461438842
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0712, Accuracy: 9722/9900 (98.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.592942140812056.
Norm before scaling: 43.56266392768654. Distance: 1.327362200522884
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0379, Accuracy: 9793/9900 (98.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5333/5503 (96.9108%), train_poison_data_count: 430
Global model norm: 43.592942140812056.
Norm before scaling: 43.56246777482667. Distance: 1.3719776488810727
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0555, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5892/6664 (88.4154%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5756/6664 (86.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1596, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4440/4757 (93.3361%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4349/4757 (91.4232%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0897, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4631/5055 (91.6123%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4559/5055 (90.1879%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1158, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5138/5422 (94.7621%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5040/5422 (92.9546%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8738, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4411/4869 (90.5936%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4209/4869 (86.4449%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2056, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3812/4111 (92.7268%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3788/4111 (92.1430%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1871, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3876/4130 (93.8499%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3783/4130 (91.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0093, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4037/4313 (93.6007%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4055/4313 (94.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7410, Accuracy: 5951/10000 (59.5100%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4937/5353 (92.2287%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4836/5353 (90.3419%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2965, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4637/5122 (90.5310%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4301/5122 (83.9711%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3912, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4730/5068 (93.3307%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4679/5068 (92.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0250, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4885/5504 (88.7536%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4788/5504 (86.9913%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1904, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3595/3929 (91.4991%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3604/3929 (91.7282%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9735, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4692/5123 (91.5870%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4310/5123 (84.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2737, Accuracy: 4945/10000 (49.4500%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3913/4161 (94.0399%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3828/4161 (91.9971%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1072, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5002/5454 (91.7125%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4881/5454 (89.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9915, Accuracy: 5572/10000 (55.7200%)
time spent on training: 246.15889382362366
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2356, Accuracy: 6794/10000 (67.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1084, Accuracy: 9606/9900 (97.0303%)
Done in 272.78948402404785 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 2, 78, 57, 41, 70, 21, 35, 39, 46, 53, 29, 48, 56, 65, 45, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5174/5308 (97.4755%), train_poison_data_count: 415
Global model norm: 43.613730300252065.
Norm before scaling: 43.57898355419947. Distance: 1.2205123386064112
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1148, Accuracy: 9593/9900 (96.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5628/5777 (97.4208%), train_poison_data_count: 455
Global model norm: 43.613730300252065.
Norm before scaling: 43.57637142402262. Distance: 1.3391193622636726
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0783, Accuracy: 9700/9900 (97.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.613730300252065.
Norm before scaling: 43.58386284608029. Distance: 1.3410126061298582
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1675, Accuracy: 9467/9900 (95.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5325/5503 (96.7654%), train_poison_data_count: 430
Global model norm: 43.613730300252065.
Norm before scaling: 43.58241900231962. Distance: 1.3694956886387983
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0847, Accuracy: 9667/9900 (97.6465%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3704/3968 (93.3468%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3702/3968 (93.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8641, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4102/4368 (93.9103%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3971/4368 (90.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1151, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4597/4956 (92.7563%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4524/4956 (91.2833%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9443, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4402/4714 (93.3814%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4373/4714 (92.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9603, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5463/5871 (93.0506%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5405/5871 (92.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1174, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4658/5038 (92.4573%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4631/5038 (91.9214%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9230, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5126/5615 (91.2912%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5113/5615 (91.0597%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1201, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3813/4175 (91.3293%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3760/4175 (90.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0043, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4843/5399 (89.7018%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4759/5399 (88.1460%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.3347, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5873/6664 (88.1303%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5742/6664 (86.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.3048, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4446/4732 (93.9560%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4439/4732 (93.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9151, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4527/4830 (93.7267%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4482/4830 (92.7950%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9947, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4910/5427 (90.4736%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4828/5427 (88.9626%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1319, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5076/5497 (92.3413%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5007/5497 (91.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0963, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4999/5489 (91.0731%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4986/5489 (90.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0951, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4638/5055 (91.7507%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4618/5055 (91.3551%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1290, Accuracy: 5328/10000 (53.2800%)
time spent on training: 248.645414352417
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2367, Accuracy: 6783/10000 (67.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1128, Accuracy: 9594/9900 (96.9091%)
Done in 275.2382457256317 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 55, 61, 17, 94, 19, 54, 21, 96, 8, 84, 97, 57, 90, 95, 73, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5166/5308 (97.3248%), train_poison_data_count: 415
Global model norm: 43.634042759066.
Norm before scaling: 43.600322925176684. Distance: 1.2881550224466594
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0646, Accuracy: 9718/9900 (98.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5613/5777 (97.1612%), train_poison_data_count: 455
Global model norm: 43.634042759066.
Norm before scaling: 43.59670688896697. Distance: 1.3574166496780047
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0497, Accuracy: 9778/9900 (98.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.634042759066.
Norm before scaling: 43.604707124328186. Distance: 1.3747554474878956
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0196, Accuracy: 9841/9900 (99.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5322/5503 (96.7109%), train_poison_data_count: 430
Global model norm: 43.634042759066.
Norm before scaling: 43.602334504229816. Distance: 1.3914739182139133
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0314, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4450/4731 (94.0605%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4352/4731 (91.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1139, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4108/4485 (91.5942%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3801/4485 (84.7492%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.3515, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4401/4903 (89.7614%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4387/4903 (89.4758%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1626, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4754/5224 (91.0031%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4773/5224 (91.3668%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1356, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4842/5361 (90.3190%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4753/5361 (88.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0327, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5076/5645 (89.9203%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4946/5645 (87.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.4256, Accuracy: 4847/10000 (48.4700%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4670/5038 (92.6955%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4656/5038 (92.4176%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0230, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4656/5086 (91.5454%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4614/5086 (90.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0689, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4487/4889 (91.7775%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4494/4889 (91.9206%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0307, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4805/5209 (92.2442%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4684/5209 (89.9213%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1633, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4260/4736 (89.9493%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4255/4736 (89.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9997, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4578/4956 (92.3729%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4444/4956 (89.6691%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1887, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4421/4748 (93.1129%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4395/4748 (92.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0177, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4519/5018 (90.0558%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4388/5018 (87.4452%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2492, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4354/4605 (94.5494%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4338/4605 (94.2020%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9171, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4943/5353 (92.3407%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4834/5353 (90.3045%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0141, Accuracy: 5507/10000 (55.0700%)
time spent on training: 246.5919942855835
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2437, Accuracy: 6788/10000 (67.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1000, Accuracy: 9632/9900 (97.2929%)
Done in 273.5504310131073 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 10, 72, 34, 67, 60, 23, 86, 20, 99, 97, 64, 73, 68, 40, 30, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5177/5308 (97.5320%), train_poison_data_count: 415
Global model norm: 43.65523218212223.
Norm before scaling: 43.622049226405416. Distance: 1.26353116556549
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0907, Accuracy: 9681/9900 (97.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5608/5777 (97.0746%), train_poison_data_count: 455
Global model norm: 43.65523218212223.
Norm before scaling: 43.618181717801896. Distance: 1.390253767546591
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0871, Accuracy: 9672/9900 (97.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4954/5123 (96.7012%), train_poison_data_count: 403
Global model norm: 43.65523218212223.
Norm before scaling: 43.625016789036884. Distance: 1.3372475965260409
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1039, Accuracy: 9637/9900 (97.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5348/5503 (97.1834%), train_poison_data_count: 430
Global model norm: 43.65523218212223.
Norm before scaling: 43.6215735021639. Distance: 1.346488867194172
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0688, Accuracy: 9709/9900 (98.0707%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4739/5068 (93.5083%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4592/5068 (90.6077%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2471, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4740/5193 (91.2767%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4579/5193 (88.1764%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2824, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4543/4911 (92.5066%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4488/4911 (91.3867%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9391, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5036/5559 (90.5918%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4896/5559 (88.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2837, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3799/4145 (91.6526%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3798/4145 (91.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9943, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4279/4549 (94.0646%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4089/4549 (89.8879%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0105, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3570/3929 (90.8628%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3558/3929 (90.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9731, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4404/4714 (93.4238%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4402/4714 (93.3814%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0224, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4439/4851 (91.5069%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4435/4851 (91.4244%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9945, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4311/4736 (91.0262%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4242/4736 (89.5693%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1034, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4459/4894 (91.1116%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4318/4894 (88.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2636, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4345/4605 (94.3540%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4307/4605 (93.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1286, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3345/3589 (93.2014%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3049/3589 (84.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2906, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5503/5939 (92.6587%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5460/5939 (91.9347%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0043, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3516/3774 (93.1638%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3550/3774 (94.0647%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0355, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3263/3552 (91.8637%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3303/3552 (92.9899%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8619, Accuracy: 5818/10000 (58.1800%)
time spent on training: 241.4396026134491
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2460, Accuracy: 6775/10000 (67.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0982, Accuracy: 9639/9900 (97.3636%)
Done in 268.20708656311035 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 37, 33, 25, 48, 65, 95, 38, 74, 43, 26, 15, 14, 49, 79, 8, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5178/5308 (97.5509%), train_poison_data_count: 415
Global model norm: 43.67410129611641.
Norm before scaling: 43.63966276239569. Distance: 1.2459386651325735
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0895, Accuracy: 9667/9900 (97.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5620/5777 (97.2823%), train_poison_data_count: 455
Global model norm: 43.67410129611641.
Norm before scaling: 43.63804872900483. Distance: 1.375215426821946
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0331, Accuracy: 9819/9900 (99.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4933/5123 (96.2912%), train_poison_data_count: 403
Global model norm: 43.67410129611641.
Norm before scaling: 43.64393672539892. Distance: 1.3365035168608275
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1213, Accuracy: 9580/9900 (96.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5347/5503 (97.1652%), train_poison_data_count: 430
Global model norm: 43.67410129611641.
Norm before scaling: 43.64102219654548. Distance: 1.3363033931331407
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0816, Accuracy: 9688/9900 (97.8586%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4380/4741 (92.3856%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4205/4741 (88.6944%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3020, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4448/4818 (92.3205%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4382/4818 (90.9506%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1136, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5698/6419 (88.7677%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5555/6419 (86.5400%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2711, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4528/4830 (93.7474%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4524/4830 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2085, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5055/5497 (91.9593%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5000/5497 (90.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1752, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4510/5018 (89.8764%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4450/5018 (88.6807%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3768, Accuracy: 5012/10000 (50.1200%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5676/6235 (91.0345%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5516/6235 (88.4683%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3578, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4350/4797 (90.6817%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4337/4797 (90.4107%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0906, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4625/4979 (92.8901%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4639/4979 (93.1713%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0657, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3817/4086 (93.4165%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3806/4086 (93.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9851, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5603/6068 (92.3368%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5604/6068 (92.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2059, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3964/4196 (94.4709%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3979/4196 (94.8284%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8570, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5114/5652 (90.4812%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5031/5652 (89.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0722, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3825/4111 (93.0431%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3797/4111 (92.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9102, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4539/4889 (92.8411%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4522/4889 (92.4934%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1408, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4078/4368 (93.3608%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3990/4368 (91.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9688, Accuracy: 5539/10000 (55.3900%)
time spent on training: 247.76205134391785
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2436, Accuracy: 6801/10000 (68.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0974, Accuracy: 9642/9900 (97.3939%)
Done in 274.4587483406067 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 55, 3, 46, 33, 49, 20, 1, 52, 29, 54, 11, 97, 91, 79, 88, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5180/5308 (97.5885%), train_poison_data_count: 415
Global model norm: 43.69430467168676.
Norm before scaling: 43.6615749817023. Distance: 1.2907184022075855
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0248, Accuracy: 9834/9900 (99.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5604/5777 (97.0054%), train_poison_data_count: 455
Global model norm: 43.69430467168676.
Norm before scaling: 43.65735866747223. Distance: 1.3583727682665219
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0638, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4939/5123 (96.4084%), train_poison_data_count: 403
Global model norm: 43.69430467168676.
Norm before scaling: 43.66211736922595. Distance: 1.2956347682380387
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1031, Accuracy: 9636/9900 (97.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5332/5503 (96.8926%), train_poison_data_count: 430
Global model norm: 43.69430467168676.
Norm before scaling: 43.6626289966424. Distance: 1.3525095361454498
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0453, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4421/4731 (93.4475%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4393/4731 (92.8556%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1009, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5012/5346 (93.7523%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4898/5346 (91.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1480, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4865/5399 (90.1093%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4733/5399 (87.6644%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1483, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4500/4818 (93.3998%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4405/4818 (91.4280%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1866, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5162/5652 (91.3305%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4995/5652 (88.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2043, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4444/4714 (94.2724%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4417/4714 (93.6996%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9390, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5120/5422 (94.4301%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5022/5422 (92.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0573, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3860/4130 (93.4625%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3814/4130 (92.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0717, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4406/4732 (93.1107%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4437/4732 (93.7658%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8587, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5118/5645 (90.6643%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4883/5645 (86.5013%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2905, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5002/5702 (87.7236%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   2,  Average loss: 0.0128, Accuracy: 4311/5702 (75.6051%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2797, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4346/4736 (91.7652%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4314/4736 (91.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0047, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4096/4527 (90.4793%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4064/4527 (89.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1336, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3827/4111 (93.0917%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3749/4111 (91.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9961, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4925/5362 (91.8501%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4847/5362 (90.3954%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1642, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5515/5939 (92.8608%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5372/5939 (90.4529%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2271, Accuracy: 5182/10000 (51.8200%)
time spent on training: 248.22334122657776
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2416, Accuracy: 6798/10000 (67.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0936, Accuracy: 9654/9900 (97.5152%)
Done in 274.8322470188141 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 44, 96, 65, 90, 49, 43, 69, 8, 56, 63, 2, 72, 42, 7, 64, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.71494829119168.
Norm before scaling: 43.6817785617792. Distance: 1.2699342997520169
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1103, Accuracy: 9629/9900 (97.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5632/5777 (97.4900%), train_poison_data_count: 455
Global model norm: 43.71494829119168.
Norm before scaling: 43.67403701043747. Distance: 1.2917663422959602
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0607, Accuracy: 9737/9900 (98.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 43.71494829119168.
Norm before scaling: 43.68294666230247. Distance: 1.2994991548131092
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0720, Accuracy: 9699/9900 (97.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5364/5503 (97.4741%), train_poison_data_count: 430
Global model norm: 43.71494829119168.
Norm before scaling: 43.68011717839995. Distance: 1.3098137932853067
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0535, Accuracy: 9753/9900 (98.5152%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4735/5075 (93.3005%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4596/5075 (90.5616%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0709, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4674/5086 (91.8993%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4619/5086 (90.8179%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1669, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5030/5497 (91.5045%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4968/5497 (90.3766%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0187, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4429/4748 (93.2814%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4329/4748 (91.1752%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0895, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5094/5652 (90.1274%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4954/5652 (87.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2467, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4604/4979 (92.4684%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4572/4979 (91.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0245, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4025/4364 (92.2319%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3968/4364 (90.9258%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2296, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4502/4889 (92.0843%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4507/4889 (92.1865%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0693, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4954/5427 (91.2843%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4802/5427 (88.4835%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1412, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3666/3910 (93.7596%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3600/3910 (92.0716%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0926, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3704/3968 (93.3468%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3685/3968 (92.8679%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8182, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4785/5193 (92.1433%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4485/5193 (86.3663%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3056, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5397/5907 (91.3662%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5338/5907 (90.3674%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3223, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4478/4869 (91.9696%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3925/4869 (80.6120%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.5826, Accuracy: 4773/10000 (47.7300%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4433/4894 (90.5803%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4303/4894 (87.9240%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1879, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5188/5727 (90.5884%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5041/5727 (88.0217%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1663, Accuracy: 5223/10000 (52.2300%)
time spent on training: 244.38964533805847
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2420, Accuracy: 6805/10000 (68.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0954, Accuracy: 9648/9900 (97.4545%)
Done in 270.9108884334564 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 66, 50, 48, 43, 31, 92, 4, 61, 56, 47, 18, 87, 89, 21, 97, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5166/5308 (97.3248%), train_poison_data_count: 415
Global model norm: 43.736455771776505.
Norm before scaling: 43.703210191640245. Distance: 1.2811501161672407
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0389, Accuracy: 9794/9900 (98.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5621/5777 (97.2996%), train_poison_data_count: 455
Global model norm: 43.736455771776505.
Norm before scaling: 43.69623929041263. Distance: 1.294705287950188
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0901, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4956/5123 (96.7402%), train_poison_data_count: 403
Global model norm: 43.736455771776505.
Norm before scaling: 43.70337498811233. Distance: 1.292276617849447
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0440, Accuracy: 9786/9900 (98.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5370/5503 (97.5831%), train_poison_data_count: 430
Global model norm: 43.736455771776505.
Norm before scaling: 43.70254541312139. Distance: 1.3106713953569964
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0452, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4515/4843 (93.2273%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4432/4843 (91.5135%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1486, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4434/4757 (93.2100%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4381/4757 (92.0959%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9069, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4517/4830 (93.5197%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4522/4830 (93.6232%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1187, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4581/4979 (92.0064%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4581/4979 (92.0064%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9502, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4213/4537 (92.8587%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4182/4537 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9985, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6305/6812 (92.5573%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6270/6812 (92.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0851, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3764/4028 (93.4459%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3733/4028 (92.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0095, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4169/4485 (92.9543%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3993/4485 (89.0301%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1092, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4962/5427 (91.4317%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4904/5427 (90.3630%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0806, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4630/5123 (90.3767%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4184/5123 (81.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3768, Accuracy: 4853/10000 (48.5300%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3971/4249 (93.4573%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3879/4249 (91.2921%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0935, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3637/3995 (91.0388%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3575/3995 (89.4869%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0649, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4390/4737 (92.6747%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4305/4737 (90.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0699, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4703/5038 (93.3505%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4643/5038 (92.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8777, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4330/4736 (91.4274%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4285/4736 (90.4772%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0510, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5499/5871 (93.6638%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5383/5871 (91.6880%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1252, Accuracy: 5391/10000 (53.9100%)
time spent on training: 245.4583067893982
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2432, Accuracy: 6827/10000 (68.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0890, Accuracy: 9658/9900 (97.5556%)
Done in 272.1215717792511 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 14, 60, 82, 89, 72, 33, 79, 92, 81, 56, 75, 19, 78, 66, 16, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5203/5308 (98.0219%), train_poison_data_count: 415
Global model norm: 43.75653968979951.
Norm before scaling: 43.71943268096365. Distance: 1.176105796658003
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0743, Accuracy: 9694/9900 (97.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5616/5777 (97.2131%), train_poison_data_count: 455
Global model norm: 43.75653968979951.
Norm before scaling: 43.719191161105094. Distance: 1.3817577757819341
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0462, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4956/5123 (96.7402%), train_poison_data_count: 403
Global model norm: 43.75653968979951.
Norm before scaling: 43.72518129741931. Distance: 1.3213517652747147
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0520, Accuracy: 9770/9900 (98.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5348/5503 (97.1834%), train_poison_data_count: 430
Global model norm: 43.75653968979951.
Norm before scaling: 43.72108838233488. Distance: 1.2759972804647421
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0146, Accuracy: 9864/9900 (99.6364%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3979/4196 (94.8284%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3995/4196 (95.2097%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9572, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3824/4145 (92.2557%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3804/4145 (91.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0251, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4995/5298 (94.2809%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4934/5298 (93.1295%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0244, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4344/4737 (91.7036%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4355/4737 (91.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2350, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4684/5193 (90.1983%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4440/5193 (85.4997%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.4117, Accuracy: 4911/10000 (49.1100%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4515/4818 (93.7111%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4329/4818 (89.8506%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0672, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3855/4111 (93.7728%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3868/4111 (94.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0125, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6330/6812 (92.9243%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6307/6812 (92.5866%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2248, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4697/5035 (93.2870%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4648/5035 (92.3138%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9970, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4970/5427 (91.5791%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4776/5427 (88.0044%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2077, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4342/4672 (92.9366%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4334/4672 (92.7654%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8659, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4913/5361 (91.6434%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4816/5361 (89.8340%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1138, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4141/4368 (94.8031%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4083/4368 (93.4753%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9544, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4500/4843 (92.9176%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4460/4843 (92.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9923, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4983/5353 (93.0880%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4768/5353 (89.0715%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0129, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4440/4714 (94.1875%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4421/4714 (93.7845%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8027, Accuracy: 5832/10000 (58.3200%)
time spent on training: 245.6299011707306
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2551, Accuracy: 6799/10000 (67.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0783, Accuracy: 9692/9900 (97.8990%)
Done in 272.4233229160309 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 23, 49, 30, 9, 15, 85, 92, 17, 70, 56, 51, 53, 43, 46, 64, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5183/5308 (97.6451%), train_poison_data_count: 415
Global model norm: 43.775213158925624.
Norm before scaling: 43.738024309607454. Distance: 1.2039529007890717
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0406, Accuracy: 9785/9900 (98.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5630/5777 (97.4554%), train_poison_data_count: 455
Global model norm: 43.775213158925624.
Norm before scaling: 43.73541609603995. Distance: 1.290951818138842
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0847, Accuracy: 9687/9900 (97.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4970/5123 (97.0135%), train_poison_data_count: 403
Global model norm: 43.775213158925624.
Norm before scaling: 43.74151982545445. Distance: 1.2705520985748169
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1463, Accuracy: 9492/9900 (95.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5353/5503 (97.2742%), train_poison_data_count: 430
Global model norm: 43.775213158925624.
Norm before scaling: 43.740238866445964. Distance: 1.3350516164995108
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0345, Accuracy: 9815/9900 (99.1414%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4285/4549 (94.1965%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3914/4549 (86.0409%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2698, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5078/5652 (89.8443%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4958/5652 (87.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.4031, Accuracy: 4903/10000 (49.0300%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3549/3774 (94.0382%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3575/3774 (94.7271%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.7903, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5232/5727 (91.3567%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5123/5727 (89.4535%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2285, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5573/6068 (91.8425%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5466/6068 (90.0791%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2023, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6283/6947 (90.4419%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 6058/6947 (87.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2257, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6350/6812 (93.2179%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6190/6812 (90.8691%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1554, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4456/4903 (90.8831%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4458/4903 (90.9239%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3485, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5483/5871 (93.3912%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5372/5871 (91.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1516, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4933/5427 (90.8974%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4893/5427 (90.1603%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9796, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3834/4108 (93.3301%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3837/4108 (93.4031%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9283, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5928/6664 (88.9556%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   2,  Average loss: 0.0080, Accuracy: 5631/6664 (84.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1124, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4632/4979 (93.0307%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4622/4979 (92.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0756, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4871/5399 (90.2204%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4731/5399 (87.6273%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2110, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4452/4894 (90.9685%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4276/4894 (87.3723%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0824, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3700/3968 (93.2460%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3690/3968 (92.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8937, Accuracy: 5639/10000 (56.3900%)
time spent on training: 251.099543094635
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2570, Accuracy: 6785/10000 (67.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0839, Accuracy: 9675/9900 (97.7273%)
Done in 277.737580537796 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 49, 57, 40, 46, 85, 37, 51, 30, 8, 73, 21, 28, 82, 80, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5168/5308 (97.3625%), train_poison_data_count: 415
Global model norm: 43.79775016963628.
Norm before scaling: 43.76182736335044. Distance: 1.2682115943939372
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0401, Accuracy: 9791/9900 (98.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5627/5777 (97.4035%), train_poison_data_count: 455
Global model norm: 43.79775016963628.
Norm before scaling: 43.758869078700776. Distance: 1.325801792109267
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0408, Accuracy: 9797/9900 (98.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4947/5123 (96.5645%), train_poison_data_count: 403
Global model norm: 43.79775016963628.
Norm before scaling: 43.76601687837765. Distance: 1.3297545365716783
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1922, Accuracy: 9421/9900 (95.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5336/5503 (96.9653%), train_poison_data_count: 430
Global model norm: 43.79775016963628.
Norm before scaling: 43.76527774540923. Distance: 1.3691059276847861
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0120, Accuracy: 9868/9900 (99.6768%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6321/6812 (92.7921%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6202/6812 (91.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2162, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5166/5652 (91.4013%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5034/5652 (89.0658%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1704, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4607/4956 (92.9580%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4550/4956 (91.8079%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0393, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5507/5939 (92.7260%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5443/5939 (91.6484%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0046, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4820/5399 (89.2758%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4727/5399 (87.5533%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1309, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6258/6947 (90.0820%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 6003/6947 (86.4114%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3279, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4398/4741 (92.7652%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4219/4741 (88.9897%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3181, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3861/4108 (93.9873%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3777/4108 (91.9426%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1250, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3532/3774 (93.5877%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3590/3774 (95.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7877, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4538/4889 (92.8206%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4471/4889 (91.4502%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2563, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4358/4605 (94.6363%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4301/4605 (93.3985%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0299, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4669/5038 (92.6757%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4649/5038 (92.2787%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9280, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4640/5122 (90.5896%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4402/5122 (85.9430%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3119, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4970/5298 (93.8090%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4920/5298 (92.8652%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9900, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5061/5461 (92.6753%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4986/5461 (91.3020%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2168, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4521/4830 (93.6025%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4506/4830 (93.2919%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0572, Accuracy: 5512/10000 (55.1200%)
time spent on training: 248.99607229232788
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2659, Accuracy: 6775/10000 (67.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0765, Accuracy: 9699/9900 (97.9697%)
Done in 275.8105962276459 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 32, 67, 70, 18, 87, 0, 98, 29, 99, 28, 40, 75, 92, 80, 64, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5157/5308 (97.1552%), train_poison_data_count: 415
Global model norm: 43.81806786348598.
Norm before scaling: 43.78479224829738. Distance: 1.3166797478343923
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0436, Accuracy: 9787/9900 (98.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5629/5777 (97.4381%), train_poison_data_count: 455
Global model norm: 43.81806786348598.
Norm before scaling: 43.77968022257158. Distance: 1.3318022142317685
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0411, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.81806786348598.
Norm before scaling: 43.78481733994316. Distance: 1.304418387612194
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1842, Accuracy: 9467/9900 (95.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5353/5503 (97.2742%), train_poison_data_count: 430
Global model norm: 43.81806786348598.
Norm before scaling: 43.78354043571554. Distance: 1.3139284625734926
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0471, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5381/6080 (88.5033%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5306/6080 (87.2697%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1901, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5004/5559 (90.0162%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4885/5559 (87.8755%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1627, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5473/5871 (93.2209%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5385/5871 (91.7220%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2254, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3979/4249 (93.6456%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3925/4249 (92.3747%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0315, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3659/3995 (91.5895%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3603/3995 (90.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.3203, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5016/5454 (91.9692%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4792/5454 (87.8621%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1954, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3900/4161 (93.7275%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3845/4161 (92.4057%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1727, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4498/4732 (95.0549%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4483/4732 (94.7380%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8106, Accuracy: 5957/10000 (59.5700%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4428/4851 (91.2801%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4410/4851 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0901, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4645/5122 (90.6872%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4227/5122 (82.5264%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.8795, Accuracy: 4288/10000 (42.8800%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5498/5939 (92.5745%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5447/5939 (91.7158%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2126, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4420/4672 (94.6062%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4350/4672 (93.1079%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8888, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 6389/6812 (93.7904%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6254/6812 (91.8086%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1999, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5073/5461 (92.8951%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5002/5461 (91.5949%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2483, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4474/4894 (91.4181%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4314/4894 (88.1488%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.3611, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3847/4175 (92.1437%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3817/4175 (91.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1496, Accuracy: 5325/10000 (53.2500%)
time spent on training: 249.02034783363342
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2814, Accuracy: 6746/10000 (67.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0732, Accuracy: 9712/9900 (98.1010%)
Done in 275.715439081192 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 94, 74, 82, 63, 27, 55, 92, 11, 34, 79, 60, 59, 43, 16, 78, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5191/5308 (97.7958%), train_poison_data_count: 415
Global model norm: 43.83869218643717.
Norm before scaling: 43.8005302501615. Distance: 1.1931446837554536
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0621, Accuracy: 9721/9900 (98.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5642/5777 (97.6631%), train_poison_data_count: 455
Global model norm: 43.83869218643717.
Norm before scaling: 43.79915904452747. Distance: 1.3068849708618253
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0668, Accuracy: 9729/9900 (98.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4957/5123 (96.7597%), train_poison_data_count: 403
Global model norm: 43.83869218643717.
Norm before scaling: 43.80618044651348. Distance: 1.3178526406058018
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0469, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5349/5503 (97.2015%), train_poison_data_count: 430
Global model norm: 43.83869218643717.
Norm before scaling: 43.805358391732454. Distance: 1.3510220279408416
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0782, Accuracy: 9709/9900 (98.0707%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4772/5224 (91.3476%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4704/5224 (90.0459%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.3242, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4372/4797 (91.1403%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4323/4797 (90.1188%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9904, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5024/5298 (94.8282%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4968/5298 (93.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9927, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3675/3910 (93.9898%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3420/3910 (87.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1512, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4228/4587 (92.1735%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4205/4587 (91.6721%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0632, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4428/4731 (93.5954%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4431/4731 (93.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9662, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6428/6812 (94.3629%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6244/6812 (91.6618%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1545, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5016/5702 (87.9691%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4806/5702 (84.2862%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2733, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4572/4911 (93.0971%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4555/4911 (92.7510%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9746, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3804/4111 (92.5322%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3770/4111 (91.7052%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2221, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3854/4145 (92.9795%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3881/4145 (93.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9863, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4205/4397 (95.6334%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4191/4397 (95.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7993, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4575/4979 (91.8859%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4552/4979 (91.4240%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1000, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5000/5353 (93.4056%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4824/5353 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2504, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4130/4368 (94.5513%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4098/4368 (93.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0647, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5057/5346 (94.5941%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4973/5346 (93.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0991, Accuracy: 5424/10000 (54.2400%)
time spent on training: 245.56221532821655
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2746, Accuracy: 6741/10000 (67.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0716, Accuracy: 9716/9900 (98.1414%)
Done in 272.17695212364197 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 45, 90, 54, 95, 30, 48, 61, 73, 15, 85, 88, 94, 78, 18, 0, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5200/5308 (97.9653%), train_poison_data_count: 415
Global model norm: 43.8574016522582.
Norm before scaling: 43.819593086669. Distance: 1.193785895561865
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1127, Accuracy: 9596/9900 (96.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5635/5777 (97.5420%), train_poison_data_count: 455
Global model norm: 43.8574016522582.
Norm before scaling: 43.8170997719141. Distance: 1.3013377789033198
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0855, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4956/5123 (96.7402%), train_poison_data_count: 403
Global model norm: 43.8574016522582.
Norm before scaling: 43.82528539152298. Distance: 1.3249484951877215
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1585, Accuracy: 9506/9900 (96.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5354/5503 (97.2924%), train_poison_data_count: 430
Global model norm: 43.8574016522582.
Norm before scaling: 43.82353056355327. Distance: 1.3521470145504981
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0641, Accuracy: 9740/9900 (98.3838%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5031/5489 (91.6560%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4975/5489 (90.6358%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1171, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4479/4748 (94.3345%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4407/4748 (92.8180%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1450, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5099/5645 (90.3277%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4907/5645 (86.9265%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3430, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4572/5018 (91.1120%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4441/5018 (88.5014%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2357, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3537/3774 (93.7202%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3525/3774 (93.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0447, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4542/4830 (94.0373%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4491/4830 (92.9814%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1313, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4147/4485 (92.4638%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3756/4485 (83.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.4141, Accuracy: 4844/10000 (48.4400%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4322/4605 (93.8545%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4277/4605 (92.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9037, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5615/6068 (92.5346%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5495/6068 (90.5570%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3046, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   1,  Average loss: 0.0047, Accuracy: 6331/6947 (91.1329%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 6068/6947 (87.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2399, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4930/5362 (91.9433%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4871/5362 (90.8430%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9982, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4761/5224 (91.1371%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4705/5224 (90.0651%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1084, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4167/4368 (95.3984%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4087/4368 (93.5668%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9483, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4008/4249 (94.3281%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3923/4249 (92.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8704, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4984/5454 (91.3825%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4813/5454 (88.2472%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1720, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5522/5939 (92.9786%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5440/5939 (91.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0251, Accuracy: 5488/10000 (54.8800%)
time spent on training: 248.4512734413147
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2799, Accuracy: 6734/10000 (67.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0777, Accuracy: 9693/9900 (97.9091%)
Done in 275.33387303352356 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 59, 30, 64, 19, 12, 82, 16, 74, 70, 85, 50, 67, 57, 72, 18, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5168/5308 (97.3625%), train_poison_data_count: 415
Global model norm: 43.87798801257015.
Norm before scaling: 43.84554021202584. Distance: 1.3123677959162658
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0517, Accuracy: 9768/9900 (98.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5635/5777 (97.5420%), train_poison_data_count: 455
Global model norm: 43.87798801257015.
Norm before scaling: 43.837632658588845. Distance: 1.3220718219222667
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0205, Accuracy: 9835/9900 (99.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4972/5123 (97.0525%), train_poison_data_count: 403
Global model norm: 43.87798801257015.
Norm before scaling: 43.843109626470955. Distance: 1.2511935258100286
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0849, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5352/5503 (97.2560%), train_poison_data_count: 430
Global model norm: 43.87798801257015.
Norm before scaling: 43.84478849892681. Distance: 1.3701894881081753
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0480, Accuracy: 9775/9900 (98.7374%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4167/4397 (94.7692%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4203/4397 (95.5879%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8058, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3575/3774 (94.7271%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3629/3774 (96.1579%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7604, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4455/4894 (91.0298%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4286/4894 (87.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3282, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4837/5361 (90.2257%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4768/5361 (88.9386%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1300, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5061/5526 (91.5852%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4882/5526 (88.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3580, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5016/5298 (94.6772%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4960/5298 (93.6202%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2082, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4920/5353 (91.9111%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4734/5353 (88.4364%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1157, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4406/4797 (91.8491%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4366/4797 (91.0152%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0705, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5472/5871 (93.2039%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5364/5871 (91.3643%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2160, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6348/6947 (91.3776%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6089/6947 (87.6493%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3775, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4417/4757 (92.8526%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4368/4757 (91.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9052, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5051/5559 (90.8617%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4882/5559 (87.8216%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2669, Accuracy: 4974/10000 (49.7400%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4597/4956 (92.7563%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4516/4956 (91.1219%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1253, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4768/5193 (91.8159%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4553/5193 (87.6757%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3466, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3976/4249 (93.5750%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3926/4249 (92.3982%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9967, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4844/5399 (89.7203%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4717/5399 (87.3680%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2576, Accuracy: 5040/10000 (50.4000%)
time spent on training: 249.98211216926575
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2899, Accuracy: 6713/10000 (67.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0741, Accuracy: 9707/9900 (98.0505%)
Done in 276.7127287387848 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 18, 76, 66, 22, 96, 54, 1, 88, 32, 97, 26, 2, 77, 68, 42, 5].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Significant loss increase detected for 13 at epoch 140: Current loss: 0.1773, Previous loss: 0.0722, Loss jump: 0.1051, Applied weight: -1.1221
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5185/5308 (97.6827%), train_poison_data_count: 415
Global model norm: 43.899180647518214.
Norm before scaling: 43.863557980970945. Distance: 1.28456092658202
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0164, Accuracy: 9849/9900 (99.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5633/5777 (97.5074%), train_poison_data_count: 455
Global model norm: 43.899180647518214.
Norm before scaling: 43.85964636316123. Distance: 1.3376150473910717
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0233, Accuracy: 9833/9900 (99.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Significant loss increase detected for 58 at epoch 140: Current loss: 0.1079, Previous loss: 0.0697, Loss jump: 0.0383, Applied weight: 0.6982
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4933/5123 (96.2912%), train_poison_data_count: 403
Global model norm: 43.899180647518214.
Norm before scaling: 43.86775447652296. Distance: 1.353666839299633
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0428, Accuracy: 9785/9900 (98.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5353/5503 (97.2742%), train_poison_data_count: 430
Global model norm: 43.899180647518214.
Norm before scaling: 43.8643177211344. Distance: 1.3435858249175496
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0367, Accuracy: 9812/9900 (99.1111%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4023/4249 (94.6811%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3960/4249 (93.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9729, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3621/3959 (91.4625%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3633/3959 (91.7656%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0215, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4525/4843 (93.4338%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4489/4843 (92.6905%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9680, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5325/5696 (93.4867%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5257/5696 (92.2928%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9870, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4674/5086 (91.8993%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4644/5086 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0439, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5098/5645 (90.3100%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4856/5645 (86.0230%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.3085, Accuracy: 4945/10000 (49.4500%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5138/5422 (94.7621%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5023/5422 (92.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0554, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4963/5362 (92.5587%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4868/5362 (90.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9706, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5467/6080 (89.9178%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5311/6080 (87.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2900, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4317/4736 (91.1529%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4293/4736 (90.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1781, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3856/4086 (94.3710%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3861/4086 (94.4934%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8548, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3715/3968 (93.6240%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3667/3968 (92.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9590, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4574/5050 (90.5743%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4518/5050 (89.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0411, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3339/3589 (93.0343%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3317/3589 (92.4213%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9935, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5356/5907 (90.6721%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5418/5907 (91.7217%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1326, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4695/4993 (94.0316%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4704/4993 (94.2119%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9428, Accuracy: 5769/10000 (57.6900%)
time spent on training: 245.84060859680176
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2976, Accuracy: 6686/10000 (66.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0666, Accuracy: 9725/9900 (98.2323%)
Done in 272.41431045532227 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 69, 7, 17, 81, 55, 66, 54, 73, 78, 3, 79, 38, 84, 90, 5, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5195/5308 (97.8711%), train_poison_data_count: 415
Global model norm: 43.9187510006048.
Norm before scaling: 43.88246130467444. Distance: 1.216241896740539
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0506, Accuracy: 9765/9900 (98.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5646/5777 (97.7324%), train_poison_data_count: 455
Global model norm: 43.9187510006048.
Norm before scaling: 43.87641752295232. Distance: 1.2825078604830957
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0326, Accuracy: 9819/9900 (99.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4962/5123 (96.8573%), train_poison_data_count: 403
Global model norm: 43.9187510006048.
Norm before scaling: 43.882373679264006. Distance: 1.235420894561961
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1305, Accuracy: 9566/9900 (96.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5354/5503 (97.2924%), train_poison_data_count: 430
Global model norm: 43.9187510006048.
Norm before scaling: 43.88506773290745. Distance: 1.3719595324773588
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0291, Accuracy: 9826/9900 (99.2525%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4016/4364 (92.0257%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3955/4364 (90.6279%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0234, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4483/4869 (92.0723%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4181/4869 (85.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.4618, Accuracy: 4805/10000 (48.0500%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4461/4903 (90.9851%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4415/4903 (90.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0967, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4751/5035 (94.3595%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4716/5035 (93.6643%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9531, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4419/4731 (93.4052%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4404/4731 (93.0881%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9649, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4509/4843 (93.1034%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4467/4843 (92.2362%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0584, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5126/5645 (90.8060%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4859/5645 (86.0762%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.3193, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4319/4605 (93.7894%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4371/4605 (94.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8849, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4141/4368 (94.8031%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4140/4368 (94.7802%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9692, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5022/5346 (93.9394%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5002/5346 (93.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0566, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3876/4111 (94.2836%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3813/4111 (92.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9596, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5650/6235 (90.6175%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5563/6235 (89.2221%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1513, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4764/5209 (91.4571%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4690/5209 (90.0365%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1926, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4426/4748 (93.2182%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4312/4748 (90.8172%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0735, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4729/4993 (94.7126%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4655/4993 (93.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1040, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4574/4911 (93.1379%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4539/4911 (92.4252%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1908, Accuracy: 5243/10000 (52.4300%)
time spent on training: 245.6531834602356
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2953, Accuracy: 6703/10000 (67.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0646, Accuracy: 9734/9900 (98.3232%)
Done in 272.6313283443451 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 96, 52, 20, 2, 65, 42, 1, 45, 48, 32, 68, 12, 39, 33, 4, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5169/5308 (97.3813%), train_poison_data_count: 415
Global model norm: 43.9372443982608.
Norm before scaling: 43.90076422580107. Distance: 1.252191815408116
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0583, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5635/5777 (97.5420%), train_poison_data_count: 455
Global model norm: 43.9372443982608.
Norm before scaling: 43.89712288363484. Distance: 1.3363902791457256
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0460, Accuracy: 9793/9900 (98.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4970/5123 (97.0135%), train_poison_data_count: 403
Global model norm: 43.9372443982608.
Norm before scaling: 43.90286908691162. Distance: 1.2827561992227077
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2093, Accuracy: 9330/9900 (94.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5352/5503 (97.2560%), train_poison_data_count: 430
Global model norm: 43.9372443982608.
Norm before scaling: 43.902019647182094. Distance: 1.3346165154832206
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0486, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4668/5086 (91.7814%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4649/5086 (91.4078%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0852, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3877/4130 (93.8741%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3880/4130 (93.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0179, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4411/4714 (93.5723%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4412/4714 (93.5936%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9851, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3679/3968 (92.7167%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3664/3968 (92.3387%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8824, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5015/5497 (91.2316%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4935/5497 (89.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0943, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5451/5907 (92.2803%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5331/5907 (90.2489%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.4603, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5132/5422 (94.6514%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5060/5422 (93.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8688, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5042/5489 (91.8564%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4920/5489 (89.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1917, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4539/4830 (93.9752%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4543/4830 (94.0580%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0996, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5417/6080 (89.0954%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5377/6080 (88.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3115, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3355/3589 (93.4801%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3088/3589 (86.0407%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1233, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5083/5526 (91.9834%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4906/5526 (88.7803%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1164, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3860/4175 (92.4551%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3786/4175 (90.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0298, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4476/4818 (92.9016%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4409/4818 (91.5110%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8898, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3752/4028 (93.1480%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3744/4028 (92.9494%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8904, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4866/5399 (90.1278%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4693/5399 (86.9235%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2105, Accuracy: 5099/10000 (50.9900%)
time spent on training: 245.07003355026245
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2916, Accuracy: 6717/10000 (67.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0655, Accuracy: 9734/9900 (98.3232%)
Done in 272.0358612537384 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 27, 65, 15, 35, 94, 34, 49, 50, 42, 4, 93, 68, 90, 96, 92, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5196/5308 (97.8900%), train_poison_data_count: 415
Global model norm: 43.95695054228128.
Norm before scaling: 43.919249910435774. Distance: 1.2159463962610861
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0215, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5630/5777 (97.4554%), train_poison_data_count: 455
Global model norm: 43.95695054228128.
Norm before scaling: 43.916810896248776. Distance: 1.3162359925599785
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0372, Accuracy: 9794/9900 (98.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4956/5123 (96.7402%), train_poison_data_count: 403
Global model norm: 43.95695054228128.
Norm before scaling: 43.923133986758614. Distance: 1.3075790342729023
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1299, Accuracy: 9580/9900 (96.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5378/5503 (97.7285%), train_poison_data_count: 430
Global model norm: 43.95695054228128.
Norm before scaling: 43.91866761679337. Distance: 1.2515729067937682
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0309, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4269/4587 (93.0674%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4210/4587 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0232, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5011/5497 (91.1588%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4957/5497 (90.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1057, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5544/6068 (91.3645%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5478/6068 (90.2769%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2476, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5220/5615 (92.9653%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5121/5615 (91.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.5072, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4731/5224 (90.5628%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4738/5224 (90.6968%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1433, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4562/4911 (92.8935%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4540/4911 (92.4455%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1944, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5145/5652 (91.0297%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5052/5652 (89.3843%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3773, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4439/4757 (93.3151%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4330/4757 (91.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1319, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5395/5907 (91.3323%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5310/5907 (89.8933%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4090, Accuracy: 4830/10000 (48.3000%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3724/4028 (92.4528%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3738/4028 (92.8004%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8909, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4656/5055 (92.1068%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4561/5055 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2938, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3364/3589 (93.7308%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3333/3589 (92.8671%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9324, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4482/4748 (94.3976%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4345/4748 (91.5122%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0709, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4703/5086 (92.4695%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4690/5086 (92.2139%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0079, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6366/6812 (93.4527%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6260/6812 (91.8967%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1147, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4107/4364 (94.1109%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3977/4364 (91.1320%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0660, Accuracy: 5483/10000 (54.8300%)
time spent on training: 246.60655570030212
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.2846, Accuracy: 6725/10000 (67.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0656, Accuracy: 9733/9900 (98.3131%)
Done in 273.50613498687744 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 0, 83, 23, 90, 88, 51, 9, 6, 70, 7, 75, 87, 85, 89, 84, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5193/5308 (97.8335%), train_poison_data_count: 415
Global model norm: 43.97699760510459.
Norm before scaling: 43.939322508432014. Distance: 1.2339864191640337
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0785, Accuracy: 9693/9900 (97.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5626/5777 (97.3862%), train_poison_data_count: 455
Global model norm: 43.97699760510459.
Norm before scaling: 43.93691516991649. Distance: 1.357305332367794
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0962, Accuracy: 9660/9900 (97.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4968/5123 (96.9744%), train_poison_data_count: 403
Global model norm: 43.97699760510459.
Norm before scaling: 43.942465880025296. Distance: 1.2803694793036928
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0529, Accuracy: 9754/9900 (98.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5359/5503 (97.3832%), train_poison_data_count: 430
Global model norm: 43.97699760510459.
Norm before scaling: 43.94143107858886. Distance: 1.3180240911183572
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0420, Accuracy: 9794/9900 (98.9293%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4979/5454 (91.2908%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4815/5454 (88.2838%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1919, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3280/3552 (92.3423%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3284/3552 (92.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9642, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4259/4549 (93.6250%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4063/4549 (89.3163%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9342, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4513/4748 (95.0505%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4414/4748 (92.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9484, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4955/5362 (92.4095%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4827/5362 (90.0224%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1003, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3807/4108 (92.6728%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3782/4108 (92.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0962, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5258/5727 (91.8107%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5077/5727 (88.6503%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1580, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4579/4929 (92.8992%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4478/4929 (90.8501%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2362, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5490/5871 (93.5105%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5373/5871 (91.5176%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1746, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4485/4869 (92.1134%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3986/4869 (81.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.5397, Accuracy: 4647/10000 (46.4700%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4375/4672 (93.6430%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4333/4672 (92.7440%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0353, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3598/3995 (90.0626%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3557/3995 (89.0363%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0960, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6309/6947 (90.8162%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 6039/6947 (86.9296%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3046, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4347/4737 (91.7669%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4306/4737 (90.9014%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2258, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4777/5209 (91.7067%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4610/5209 (88.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1967, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3751/3968 (94.5312%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3750/3968 (94.5060%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8105, Accuracy: 5778/10000 (57.7800%)
time spent on training: 246.63921904563904
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2896, Accuracy: 6720/10000 (67.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0669, Accuracy: 9722/9900 (98.2020%)
Done in 273.4815626144409 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 27, 69, 59, 16, 44, 4, 1, 35, 8, 7, 23, 66, 88, 42, 52, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5182/5308 (97.6262%), train_poison_data_count: 415
Global model norm: 43.99678166496954.
Norm before scaling: 43.95905826687985. Distance: 1.238577725992679
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0296, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5636/5777 (97.5593%), train_poison_data_count: 455
Global model norm: 43.99678166496954.
Norm before scaling: 43.95524123949128. Distance: 1.3124644410902269
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0441, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4969/5123 (96.9939%), train_poison_data_count: 403
Global model norm: 43.99678166496954.
Norm before scaling: 43.96279027440066. Distance: 1.2690437672088917
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1365, Accuracy: 9555/9900 (96.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5356/5503 (97.3287%), train_poison_data_count: 430
Global model norm: 43.99678166496954.
Norm before scaling: 43.961767058327226. Distance: 1.3441646734523638
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0473, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4190/4587 (91.3451%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4108/4587 (89.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2165, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4060/4364 (93.0339%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4004/4364 (91.7507%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9331, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4190/4397 (95.2922%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4197/4397 (95.4514%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8195, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4955/5353 (92.5649%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4793/5353 (89.5386%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2697, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4752/5075 (93.6355%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4659/5075 (91.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1436, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3745/4028 (92.9742%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3758/4028 (93.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9263, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5150/5422 (94.9834%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5049/5422 (93.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0455, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5216/5615 (92.8940%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5146/5615 (91.6474%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2938, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4556/4889 (93.1888%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4470/4889 (91.4297%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0571, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4464/4869 (91.6821%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4181/4869 (85.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2422, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4297/4549 (94.4603%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3775/4549 (82.9853%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.5332, Accuracy: 4767/10000 (47.6700%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4520/4843 (93.3306%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4484/4843 (92.5872%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9539, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4925/5362 (91.8501%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4877/5362 (90.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1732, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5480/5907 (92.7713%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5358/5907 (90.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.3952, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3884/4130 (94.0436%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3831/4130 (92.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9015, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5028/5454 (92.1892%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4852/5454 (88.9622%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1672, Accuracy: 5331/10000 (53.3100%)
time spent on training: 245.56044030189514
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.2869, Accuracy: 6717/10000 (67.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0654, Accuracy: 9731/9900 (98.2929%)
Done in 272.5200595855713 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 54, 63, 3, 38, 67, 73, 20, 32, 49, 0, 75, 56, 10, 2, 42, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5189/5308 (97.7581%), train_poison_data_count: 415
Global model norm: 44.01659288516945.
Norm before scaling: 43.980178529828926. Distance: 1.255775650579602
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0165, Accuracy: 9852/9900 (99.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5641/5777 (97.6458%), train_poison_data_count: 455
Global model norm: 44.01659288516945.
Norm before scaling: 43.97437164222048. Distance: 1.2846855994609265
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0430, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4965/5123 (96.9159%), train_poison_data_count: 403
Global model norm: 44.01659288516945.
Norm before scaling: 43.98295818099963. Distance: 1.317466286403425
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1280, Accuracy: 9578/9900 (96.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5367/5503 (97.5286%), train_poison_data_count: 430
Global model norm: 44.01659288516945.
Norm before scaling: 43.97977884511955. Distance: 1.2916882215772794
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0645, Accuracy: 9743/9900 (98.4141%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5117/5645 (90.6466%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4843/5645 (85.7927%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.5103, Accuracy: 4761/10000 (47.6100%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3684/3910 (94.2199%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3461/3910 (88.5166%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3687, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5078/5346 (94.9869%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4999/5346 (93.5092%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9568, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5580/6235 (89.4948%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5470/6235 (87.7306%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.6031, Accuracy: 4760/10000 (47.6000%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5045/5559 (90.7537%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4887/5559 (87.9115%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1945, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4357/4605 (94.6145%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4304/4605 (93.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0482, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4476/4714 (94.9512%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4502/4714 (95.5028%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8362, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5478/6080 (90.0987%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5221/6080 (85.8717%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3205, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5183/5652 (91.7021%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4971/5652 (87.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2432, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5037/5454 (92.3542%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4761/5454 (87.2937%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1294, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4397/4672 (94.1139%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4412/4672 (94.4349%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8551, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4934/5427 (90.9158%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4840/5427 (89.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0457, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4747/5068 (93.6661%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4623/5068 (91.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3890, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3730/3968 (94.0020%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3720/3968 (93.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8106, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5394/5907 (91.3154%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5335/5907 (90.3166%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.4958, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4494/4851 (92.6407%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4452/4851 (91.7749%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1252, Accuracy: 5445/10000 (54.4500%)
time spent on training: 248.08717799186707
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.2923, Accuracy: 6714/10000 (67.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0576, Accuracy: 9752/9900 (98.5051%)
Done in 274.58290243148804 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 92, 39, 50, 63, 32, 3, 4, 22, 47, 68, 64, 51, 16, 62, 87, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5191/5308 (97.7958%), train_poison_data_count: 415
Global model norm: 44.03795997710739.
Norm before scaling: 43.99712847963063. Distance: 1.17055574545255
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0700, Accuracy: 9715/9900 (98.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5651/5777 (97.8189%), train_poison_data_count: 455
Global model norm: 44.03795997710739.
Norm before scaling: 43.994159657667915. Distance: 1.2533380760109902
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0380, Accuracy: 9800/9900 (98.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4977/5123 (97.1501%), train_poison_data_count: 403
Global model norm: 44.03795997710739.
Norm before scaling: 44.001378818062335. Distance: 1.2163179045772192
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0477, Accuracy: 9781/9900 (98.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5360/5503 (97.4014%), train_poison_data_count: 430
Global model norm: 44.03795997710739.
Norm before scaling: 44.00317371366525. Distance: 1.3476401065467651
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1235, Accuracy: 9570/9900 (96.6667%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6417/6812 (94.2014%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   2,  Average loss: 0.0035, Accuracy: 6335/6812 (92.9977%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2410, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3886/4175 (93.0778%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3771/4175 (90.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0978, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4455/4757 (93.6515%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4372/4757 (91.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1283, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3687/3910 (94.2967%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3432/3910 (87.7749%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1613, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5483/6080 (90.1809%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5358/6080 (88.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3769, Accuracy: 4949/10000 (49.4900%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5011/5346 (93.7336%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4940/5346 (92.4055%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1006, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3767/4028 (93.5204%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3728/4028 (92.5521%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9594, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5350/5696 (93.9256%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5219/5696 (91.6257%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9623, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4691/5123 (91.5674%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4186/5123 (81.7099%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2589, Accuracy: 4969/10000 (49.6900%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3367/3589 (93.8144%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3176/3589 (88.4926%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9547, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4506/4894 (92.0719%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4345/4894 (88.7822%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1504, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3867/4108 (94.1334%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3779/4108 (91.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0881, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5006/5353 (93.5177%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4855/5353 (90.6968%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1660, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4916/5504 (89.3169%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4888/5504 (88.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2348, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3640/3995 (91.1139%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3583/3995 (89.6871%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1364, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5164/5615 (91.9679%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5124/5615 (91.2556%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2043, Accuracy: 5275/10000 (52.7500%)
time spent on training: 244.35936546325684
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.2975, Accuracy: 6707/10000 (67.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0588, Accuracy: 9745/9900 (98.4343%)
Done in 271.1833760738373 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 34, 96, 45, 52, 66, 63, 32, 29, 57, 44, 77, 79, 94, 64, 51, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5181/5308 (97.6074%), train_poison_data_count: 415
Global model norm: 44.058409329175596.
Norm before scaling: 44.02167185345688. Distance: 1.260164656022776
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0534, Accuracy: 9772/9900 (98.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 44.058409329175596.
Norm before scaling: 44.01617827793904. Distance: 1.3129931386316576
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0892, Accuracy: 9669/9900 (97.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4979/5123 (97.1891%), train_poison_data_count: 403
Global model norm: 44.058409329175596.
Norm before scaling: 44.02185902782418. Distance: 1.2282165745574511
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0771, Accuracy: 9695/9900 (97.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5360/5503 (97.4014%), train_poison_data_count: 430
Global model norm: 44.058409329175596.
Norm before scaling: 44.02034774538929. Distance: 1.3009019858657795
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0477, Accuracy: 9779/9900 (98.7778%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4631/4911 (94.2985%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4544/4911 (92.5270%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9934, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4742/5086 (93.2363%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4695/5086 (92.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0033, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4994/5489 (90.9820%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4996/5489 (91.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1246, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3887/4130 (94.1162%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3868/4130 (93.6562%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9418, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4505/4843 (93.0209%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4462/4843 (92.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1747, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3660/3910 (93.6061%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3561/3910 (91.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3937, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5500/6080 (90.4605%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5316/6080 (87.4342%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1861, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4488/4732 (94.8436%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4477/4732 (94.6112%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8591, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4610/4956 (93.0186%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4494/4956 (90.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1787, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4734/5075 (93.2808%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4568/5075 (90.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0909, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4595/5050 (90.9901%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4470/5050 (88.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3141, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3863/4111 (93.9674%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3818/4111 (92.8728%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0571, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4780/5224 (91.5008%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4743/5224 (90.7925%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0647, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4554/4894 (93.0527%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4393/4894 (89.7630%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2273, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3863/4108 (94.0360%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3841/4108 (93.5005%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9240, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5953/6664 (89.3307%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5696/6664 (85.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2745, Accuracy: 5019/10000 (50.1900%)
time spent on training: 246.01349663734436
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.3033, Accuracy: 6706/10000 (67.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0586, Accuracy: 9744/9900 (98.4242%)
Done in 272.69238924980164 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 69, 1, 68, 16, 44, 2, 45, 27, 14, 83, 87, 12, 50, 43, 37, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5181/5308 (97.6074%), train_poison_data_count: 415
Global model norm: 44.07732047963059.
Norm before scaling: 44.04016638118903. Distance: 1.2630142788536702
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0900, Accuracy: 9641/9900 (97.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 44.07732047963059.
Norm before scaling: 44.0351560767431. Distance: 1.3185165650647543
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0443, Accuracy: 9787/9900 (98.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4970/5123 (97.0135%), train_poison_data_count: 403
Global model norm: 44.07732047963059.
Norm before scaling: 44.04371690744819. Distance: 1.3080436803016275
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1581, Accuracy: 9488/9900 (95.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5358/5503 (97.3651%), train_poison_data_count: 430
Global model norm: 44.07732047963059.
Norm before scaling: 44.04044494570445. Distance: 1.3230177122359148
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0230, Accuracy: 9854/9900 (99.5354%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4088/4364 (93.6755%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3955/4364 (90.6279%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0398, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5078/5422 (93.6555%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5063/5422 (93.3788%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9765, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3352/3589 (93.3965%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3133/3589 (87.2945%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2440, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4934/5353 (92.1726%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4831/5353 (90.2485%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1321, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4746/5075 (93.5172%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4628/5075 (91.1921%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1708, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3692/3968 (93.0444%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3655/3968 (92.1119%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9549, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5078/5489 (92.5123%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5002/5489 (91.1277%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0978, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4240/4587 (92.4351%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4200/4587 (91.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1408, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3997/4196 (95.2574%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4023/4196 (95.8770%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8842, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3273/3552 (92.1453%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3290/3552 (92.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8802, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3623/3995 (90.6884%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3567/3995 (89.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3229, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5063/5526 (91.6214%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4922/5526 (89.0699%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3067, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4411/4757 (92.7265%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4423/4757 (92.9788%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0007, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4590/4979 (92.1872%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4558/4979 (91.5445%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2677, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4383/4741 (92.4489%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4256/4741 (89.7701%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1887, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4741/5193 (91.2960%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4647/5193 (89.4858%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3400, Accuracy: 5136/10000 (51.3600%)
time spent on training: 241.67692017555237
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.3063, Accuracy: 6679/10000 (66.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0582, Accuracy: 9746/9900 (98.4444%)
Done in 268.7651619911194 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 63, 26, 6, 29, 91, 4, 39, 1, 80, 62, 89, 20, 33, 74, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5216/5308 (98.2668%), train_poison_data_count: 415
Global model norm: 44.09648373657119.
Norm before scaling: 44.056806480561264. Distance: 1.1868769868549833
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0275, Accuracy: 9826/9900 (99.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5650/5777 (97.8016%), train_poison_data_count: 455
Global model norm: 44.09648373657119.
Norm before scaling: 44.05291617847932. Distance: 1.282480625801907
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0502, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Significant loss increase detected for 58 at epoch 150: Current loss: 0.0801, Previous loss: 0.0423, Loss jump: 0.0378, Applied weight: 0.2019
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4972/5123 (97.0525%), train_poison_data_count: 403
Global model norm: 44.09648373657119.
Norm before scaling: 44.06025731216356. Distance: 1.2615230632946206
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1882, Accuracy: 9401/9900 (94.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5351/5503 (97.2379%), train_poison_data_count: 430
Global model norm: 44.09648373657119.
Norm before scaling: 44.05988051832486. Distance: 1.3323438618775012
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0528, Accuracy: 9772/9900 (98.7071%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3673/3910 (93.9386%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3545/3910 (90.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0380, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3842/4086 (94.0284%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3846/4086 (94.1263%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9695, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4639/4929 (94.1165%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4510/4929 (91.4993%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0783, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4477/4732 (94.6112%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4462/4732 (94.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8523, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4157/4527 (91.8268%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4035/4527 (89.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0739, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3786/4028 (93.9921%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3724/4028 (92.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0012, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3861/4175 (92.4790%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3823/4175 (91.5689%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9678, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5166/5422 (95.2785%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5089/5422 (93.8584%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9392, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5058/5461 (92.6204%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4976/5461 (91.1188%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1250, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4922/5504 (89.4259%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4828/5504 (87.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1346, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4395/4737 (92.7802%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4288/4737 (90.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3326, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4431/4714 (93.9966%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4419/4714 (93.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9529, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4464/4818 (92.6526%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4338/4818 (90.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0670, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4420/4797 (92.1409%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4355/4797 (90.7859%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9806, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4678/5055 (92.5420%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4597/5055 (90.9397%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2805, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5066/5497 (92.1594%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4931/5497 (89.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0997, Accuracy: 5366/10000 (53.6600%)
time spent on training: 244.39630317687988
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.3034, Accuracy: 6699/10000 (66.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0600, Accuracy: 9744/9900 (98.4242%)
Done in 270.8937873840332 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 4, 98, 5, 17, 65, 46, 15, 48, 68, 94, 2, 93, 43, 10, 26, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.114970420871586.
Norm before scaling: 44.074676952162676. Distance: 1.1640869752499834
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0857, Accuracy: 9674/9900 (97.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5664/5777 (98.0440%), train_poison_data_count: 455
Global model norm: 44.114970420871586.
Norm before scaling: 44.06994340941879. Distance: 1.2164658881569843
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0858, Accuracy: 9691/9900 (97.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4961/5123 (96.8378%), train_poison_data_count: 403
Global model norm: 44.114970420871586.
Norm before scaling: 44.08140524173359. Distance: 1.3172156225711567
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0382, Accuracy: 9796/9900 (98.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5381/5503 (97.7830%), train_poison_data_count: 430
Global model norm: 44.114970420871586.
Norm before scaling: 44.07581802275484. Distance: 1.2178922716051677
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0370, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3758/4028 (93.2969%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3767/4028 (93.5204%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8217, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3943/4161 (94.7609%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3850/4161 (92.5258%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9589, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4724/4993 (94.6125%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4618/4993 (92.4895%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3175, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4453/4903 (90.8219%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4363/4903 (88.9863%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3569, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5078/5497 (92.3777%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4906/5497 (89.2487%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2272, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4881/5399 (90.4056%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4734/5399 (87.6829%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3006, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5654/6068 (93.1773%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5503/6068 (90.6889%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2721, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4585/4830 (94.9275%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4507/4830 (93.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0689, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3365/3589 (93.7587%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3217/3589 (89.6350%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2684, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4801/5224 (91.9028%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4751/5224 (90.9456%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2036, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3684/3968 (92.8427%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3683/3968 (92.8175%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.7273, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4671/5055 (92.4036%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4571/5055 (90.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2679, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4583/4979 (92.0466%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4571/4979 (91.8056%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9026, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4777/5068 (94.2581%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4663/5068 (92.0087%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1606, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3862/4086 (94.5179%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3866/4086 (94.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8833, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4969/5362 (92.6706%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4859/5362 (90.6192%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1052, Accuracy: 5285/10000 (52.8500%)
time spent on training: 241.98332118988037
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.2999, Accuracy: 6684/10000 (66.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0638, Accuracy: 9731/9900 (98.2929%)
Done in 268.8228359222412 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 7, 81, 4, 44, 5, 99, 83, 55, 94, 14, 32, 74, 20, 49, 23, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.13377574072733.
Norm before scaling: 44.09244328326. Distance: 1.1680729542052692
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0896, Accuracy: 9668/9900 (97.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 44.13377574072733.
Norm before scaling: 44.090171663361524. Distance: 1.2760318003162758
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0541, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4981/5123 (97.2282%), train_poison_data_count: 403
Global model norm: 44.13377574072733.
Norm before scaling: 44.09721870215428. Distance: 1.265802677068774
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0524, Accuracy: 9747/9900 (98.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5386/5503 (97.8739%), train_poison_data_count: 430
Global model norm: 44.13377574072733.
Norm before scaling: 44.09270352230911. Distance: 1.2175146346416996
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0873, Accuracy: 9687/9900 (97.8485%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4473/4869 (91.8669%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4308/4869 (88.4781%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3375, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4763/5035 (94.5978%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4694/5035 (93.2274%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8590, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3793/4028 (94.1658%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3733/4028 (92.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8702, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4773/5075 (94.0493%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4629/5075 (91.2118%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1529, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4741/4993 (94.9529%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4621/4993 (92.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0235, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4481/4851 (92.3727%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4465/4851 (92.0429%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9779, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3301/3552 (92.9336%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3341/3552 (94.0597%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7660, Accuracy: 6028/10000 (60.2800%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4423/4731 (93.4897%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4349/4731 (91.9256%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9766, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4804/5224 (91.9602%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4767/5224 (91.2519%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1402, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4017/4196 (95.7340%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3978/4196 (94.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8100, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5527/6080 (90.9046%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5351/6080 (88.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0574, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4404/4797 (91.8074%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4361/4797 (90.9110%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1070, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4434/4714 (94.0602%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4406/4714 (93.4663%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9381, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5142/5652 (90.9766%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5015/5652 (88.7297%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2298, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4299/4549 (94.5043%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4117/4549 (90.5034%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1307, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4968/5504 (90.2616%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4816/5504 (87.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.6734, Accuracy: 4604/10000 (46.0400%)
time spent on training: 243.92917037010193
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3100, Accuracy: 6685/10000 (66.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0622, Accuracy: 9735/9900 (98.3333%)
Done in 270.785781621933 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 0, 97, 90, 3, 15, 93, 69, 88, 79, 65, 44, 84, 6, 78, 24, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5187/5308 (97.7204%), train_poison_data_count: 415
Global model norm: 44.15225648740603.
Norm before scaling: 44.11388017198357. Distance: 1.258701507861673
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0237, Accuracy: 9839/9900 (99.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5648/5777 (97.7670%), train_poison_data_count: 455
Global model norm: 44.15225648740603.
Norm before scaling: 44.10868590056838. Distance: 1.269231485042059
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0928, Accuracy: 9664/9900 (97.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4977/5123 (97.1501%), train_poison_data_count: 403
Global model norm: 44.15225648740603.
Norm before scaling: 44.115111542489046. Distance: 1.2643757529829256
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2615, Accuracy: 9176/9900 (92.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5381/5503 (97.7830%), train_poison_data_count: 430
Global model norm: 44.15225648740603.
Norm before scaling: 44.11120424386247. Distance: 1.2203999623546513
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0750, Accuracy: 9707/9900 (98.0505%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5057/5454 (92.7209%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4867/5454 (89.2373%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0864, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4334/4736 (91.5118%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4270/4736 (90.1605%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0230, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4528/4748 (95.3665%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4410/4748 (92.8812%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1107, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5039/5346 (94.2574%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4970/5346 (92.9667%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1181, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5560/6068 (91.6282%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5499/6068 (90.6229%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2796, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4704/5055 (93.0564%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4628/5055 (91.5529%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1222, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4071/4364 (93.2860%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3947/4364 (90.4445%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0075, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5032/5362 (93.8456%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4911/5362 (91.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0435, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3848/4111 (93.6025%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3780/4111 (91.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1205, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5010/5497 (91.1406%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4972/5497 (90.4493%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2087, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4801/5075 (94.6010%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4685/5075 (92.3153%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0108, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4805/5209 (92.2442%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4713/5209 (90.4780%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1918, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4594/4929 (93.2035%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4496/4929 (91.2153%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2738, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4095/4368 (93.7500%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3987/4368 (91.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1188, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4035/4313 (93.5544%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3980/4313 (92.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9140, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3802/4028 (94.3893%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3742/4028 (92.8997%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0284, Accuracy: 5649/10000 (56.4900%)
time spent on training: 246.60875344276428
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3148, Accuracy: 6680/10000 (66.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0653, Accuracy: 9731/9900 (98.2929%)
Done in 273.26051688194275 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 38, 89, 81, 43, 21, 40, 78, 9, 14, 83, 85, 20, 65, 97, 3, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.17148395873957.
Norm before scaling: 44.13163348686235. Distance: 1.1966579071050185
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0635, Accuracy: 9740/9900 (98.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 44.17148395873957.
Norm before scaling: 44.126300219866046. Distance: 1.2502334853502086
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0329, Accuracy: 9812/9900 (99.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5013/5123 (97.8528%), train_poison_data_count: 403
Global model norm: 44.17148395873957.
Norm before scaling: 44.133482552667. Distance: 1.194566980380181
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1137, Accuracy: 9608/9900 (97.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5363/5503 (97.4559%), train_poison_data_count: 430
Global model norm: 44.17148395873957.
Norm before scaling: 44.13542004710474. Distance: 1.3264194083350338
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0554, Accuracy: 9750/9900 (98.4848%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5641/6235 (90.4731%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5544/6235 (88.9174%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2984, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4381/4737 (92.4847%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4332/4737 (91.4503%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1885, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4760/5035 (94.5382%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4726/5035 (93.8630%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0017, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4608/4979 (92.5487%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4559/4979 (91.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0003, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4665/5038 (92.5963%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4621/5038 (91.7229%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2435, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5518/5939 (92.9113%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5400/5939 (90.9244%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2314, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4158/4368 (95.1923%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4104/4368 (93.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0354, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5287/5727 (92.3171%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5058/5727 (88.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2443, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4021/4196 (95.8294%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3959/4196 (94.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7800, Accuracy: 5996/10000 (59.9600%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3319/3552 (93.4403%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3321/3552 (93.4966%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8667, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6367/6947 (91.6511%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6028/6947 (86.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2645, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4456/4714 (94.5269%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4414/4714 (93.6360%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9351, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5041/5497 (91.7046%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4960/5497 (90.2310%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1380, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4365/4736 (92.1664%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4243/4736 (89.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1404, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5099/5346 (95.3797%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5001/5346 (93.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0000, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4609/4956 (92.9984%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4545/4956 (91.7070%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9859, Accuracy: 5532/10000 (55.3200%)
time spent on training: 247.732754945755
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3161, Accuracy: 6672/10000 (66.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0625, Accuracy: 9733/9900 (98.3131%)
Done in 274.72159218788147 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 79, 41, 44, 27, 24, 6, 29, 62, 19, 17, 51, 10, 22, 55, 2, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5195/5308 (97.8711%), train_poison_data_count: 415
Global model norm: 44.1899834653949.
Norm before scaling: 44.151151952695415. Distance: 1.2320776699031892
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0658, Accuracy: 9726/9900 (98.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5641/5777 (97.6458%), train_poison_data_count: 455
Global model norm: 44.1899834653949.
Norm before scaling: 44.14653997979343. Distance: 1.2698991447862196
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1038, Accuracy: 9622/9900 (97.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4975/5123 (97.1111%), train_poison_data_count: 403
Global model norm: 44.1899834653949.
Norm before scaling: 44.15286473001709. Distance: 1.267152265065897
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0376, Accuracy: 9803/9900 (99.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5404/5503 (98.2010%), train_poison_data_count: 430
Global model norm: 44.1899834653949.
Norm before scaling: 44.1489179156749. Distance: 1.1894374902759395
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0666, Accuracy: 9730/9900 (98.2828%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3859/4111 (93.8701%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3784/4111 (92.0457%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0579, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4421/4714 (93.7845%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4398/4714 (93.2966%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1246, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4790/5075 (94.3842%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4762/5075 (93.8325%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0449, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4251/4587 (92.6750%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4197/4587 (91.4977%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1499, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4048/4313 (93.8558%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4034/4313 (93.5312%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8590, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4607/4929 (93.4672%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4480/4929 (90.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1597, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4480/4732 (94.6746%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4427/4732 (93.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8177, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4933/5504 (89.6257%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4831/5504 (87.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2240, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4837/5361 (90.2257%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4802/5361 (89.5728%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0981, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4443/4903 (90.6180%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4410/4903 (89.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2021, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3859/4108 (93.9387%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3784/4108 (92.1130%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0098, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4778/5068 (94.2778%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4490/5068 (88.5951%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2266, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5329/5696 (93.5569%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5186/5696 (91.0463%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2190, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4448/4731 (94.0182%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4388/4731 (92.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9854, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3694/3968 (93.0948%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3689/3968 (92.9688%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9173, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4008/4249 (94.3281%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3913/4249 (92.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9410, Accuracy: 5732/10000 (57.3200%)
time spent on training: 240.52396726608276
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3194, Accuracy: 6673/10000 (66.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0651, Accuracy: 9728/9900 (98.2626%)
Done in 267.3127806186676 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 11, 83, 23, 59, 10, 86, 19, 48, 50, 12, 38, 98, 74, 21, 63, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.20822671822873.
Norm before scaling: 44.16746971312003. Distance: 1.19202599587672
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0321, Accuracy: 9815/9900 (99.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5668/5777 (98.1132%), train_poison_data_count: 455
Global model norm: 44.20822671822873.
Norm before scaling: 44.16289952364923. Distance: 1.2399760780795712
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0848, Accuracy: 9685/9900 (97.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4983/5123 (97.2672%), train_poison_data_count: 403
Global model norm: 44.20822671822873.
Norm before scaling: 44.170813791638764. Distance: 1.2383686600408566
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0558, Accuracy: 9755/9900 (98.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5382/5503 (97.8012%), train_poison_data_count: 430
Global model norm: 44.20822671822873.
Norm before scaling: 44.1671518743002. Distance: 1.2127068176067828
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0604, Accuracy: 9743/9900 (98.4141%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5001/5702 (87.7061%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   2,  Average loss: 0.0100, Accuracy: 4577/5702 (80.2701%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.4459, Accuracy: 4887/10000 (48.8700%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3308/3552 (93.1306%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3314/3552 (93.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8747, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4326/4549 (95.0978%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3787/4549 (83.2491%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1906, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4218/4397 (95.9290%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4201/4397 (95.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8720, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4816/5068 (95.0276%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4628/5068 (91.3181%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1669, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3605/3929 (91.7536%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3579/3929 (91.0919%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9264, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4879/5361 (91.0091%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4818/5361 (89.8713%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0707, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4579/4830 (94.8033%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4556/4830 (94.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9856, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4463/4757 (93.8196%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4388/4757 (92.2430%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0529, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5098/5526 (92.2548%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4811/5526 (87.0612%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3448, Accuracy: 4964/10000 (49.6400%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5653/6235 (90.6656%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5471/6235 (87.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2897, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3887/4161 (93.4150%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3833/4161 (92.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0050, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4437/4797 (92.4953%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4365/4797 (90.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3322, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4669/5038 (92.6757%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4667/5038 (92.6360%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8331, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3710/3910 (94.8849%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3502/3910 (89.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2250, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4979/5504 (90.4615%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4820/5504 (87.5727%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.4598, Accuracy: 4942/10000 (49.4200%)
time spent on training: 244.03634405136108
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3186, Accuracy: 6678/10000 (66.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0601, Accuracy: 9744/9900 (98.4242%)
Done in 270.7872862815857 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 7, 2, 12, 90, 33, 98, 27, 94, 1, 52, 14, 48, 96, 37, 20, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.22656042991516.
Norm before scaling: 44.18550401034753. Distance: 1.1920584972576196
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0191, Accuracy: 9853/9900 (99.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 44.22656042991516.
Norm before scaling: 44.18074780447361. Distance: 1.2590292974370412
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0645, Accuracy: 9730/9900 (98.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4981/5123 (97.2282%), train_poison_data_count: 403
Global model norm: 44.22656042991516.
Norm before scaling: 44.18857323882287. Distance: 1.2866920176579741
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0921, Accuracy: 9652/9900 (97.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5375/5503 (97.6740%), train_poison_data_count: 430
Global model norm: 44.22656042991516.
Norm before scaling: 44.1847442674116. Distance: 1.2337980732929177
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1067, Accuracy: 9617/9900 (97.1414%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4443/4869 (91.2508%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4157/4869 (85.3769%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3692, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3748/3968 (94.4556%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3740/3968 (94.2540%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8447, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5144/5526 (93.0872%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4900/5526 (88.6717%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2011, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4513/4748 (95.0505%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4345/4748 (91.5122%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1982, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4468/4818 (92.7356%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4380/4818 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0129, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3943/4161 (94.7609%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3777/4161 (90.7714%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3019, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4254/4587 (92.7404%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4192/4587 (91.3887%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3748, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4786/5224 (91.6156%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4710/5224 (90.1608%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3059, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5162/5422 (95.2047%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   2,  Average loss: 0.0030, Accuracy: 5123/5422 (94.4854%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9392, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3909/4130 (94.6489%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3798/4130 (91.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1740, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3996/4196 (95.2336%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3969/4196 (94.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9174, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4594/4830 (95.1139%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4529/4830 (93.7681%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0088, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4711/5086 (92.6268%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4717/5086 (92.7448%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1088, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4392/4741 (92.6387%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4176/4741 (88.0827%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.4541, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4474/4714 (94.9088%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4432/4714 (94.0178%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0473, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4643/5122 (90.6482%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   2,  Average loss: 0.0126, Accuracy: 3931/5122 (76.7474%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.4064, Accuracy: 4701/10000 (47.0100%)
time spent on training: 243.2106101512909
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3237, Accuracy: 6660/10000 (66.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0576, Accuracy: 9747/9900 (98.4545%)
Done in 269.9991476535797 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 76, 60, 40, 20, 6, 79, 62, 50, 11, 68, 14, 94, 19, 35, 31, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5200/5308 (97.9653%), train_poison_data_count: 415
Global model norm: 44.24427266960663.
Norm before scaling: 44.202159818465745. Distance: 1.167273528211006
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0244, Accuracy: 9833/9900 (99.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5657/5777 (97.9228%), train_poison_data_count: 455
Global model norm: 44.24427266960663.
Norm before scaling: 44.198098644943144. Distance: 1.2341232042990207
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0097, Accuracy: 9871/9900 (99.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4990/5123 (97.4039%), train_poison_data_count: 403
Global model norm: 44.24427266960663.
Norm before scaling: 44.20599004279921. Distance: 1.2313970061711417
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0253, Accuracy: 9832/9900 (99.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5351/5503 (97.2379%), train_poison_data_count: 430
Global model norm: 44.24427266960663.
Norm before scaling: 44.20642910282889. Distance: 1.338409768618193
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0660, Accuracy: 9727/9900 (98.2525%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3649/3959 (92.1697%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3636/3959 (91.8414%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9353, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3855/4145 (93.0036%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3847/4145 (92.8106%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0727, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5504/5939 (92.6755%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5386/5939 (90.6887%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9850, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4483/4714 (95.0997%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4434/4714 (94.0602%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0191, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4589/4929 (93.1020%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4493/4929 (91.1544%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2710, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3879/4111 (94.3566%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3769/4111 (91.6809%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0910, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4981/5504 (90.4978%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4837/5504 (87.8815%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2327, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4439/4757 (93.3151%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4342/4757 (91.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1075, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4998/5702 (87.6535%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   2,  Average loss: 0.0116, Accuracy: 4411/5702 (77.3588%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.5909, Accuracy: 4572/10000 (45.7200%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3372/3589 (93.9537%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3381/3589 (94.2045%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9664, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4038/4196 (96.2345%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4013/4196 (95.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8356, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4803/5224 (91.9410%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4697/5224 (89.9119%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2365, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4948/5361 (92.2962%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4757/5361 (88.7334%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1420, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5184/5615 (92.3241%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5148/5615 (91.6830%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3332, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4215/4537 (92.9028%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4163/4537 (91.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9767, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4440/4732 (93.8292%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4459/4732 (94.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8465, Accuracy: 5808/10000 (58.0800%)
time spent on training: 243.14524817466736
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3436, Accuracy: 6610/10000 (66.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0477, Accuracy: 9770/9900 (98.6869%)
Done in 270.024374961853 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 97, 47, 16, 70, 11, 17, 62, 21, 9, 1, 10, 20, 30, 84, 83, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.26234600015571.
Norm before scaling: 44.21992876079037. Distance: 1.1262226877912411
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0503, Accuracy: 9765/9900 (98.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 44.26234600015571.
Norm before scaling: 44.219808677697685. Distance: 1.328507895532705
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0362, Accuracy: 9813/9900 (99.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4977/5123 (97.1501%), train_poison_data_count: 403
Global model norm: 44.26234600015571.
Norm before scaling: 44.22325783118115. Distance: 1.2404742151676464
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0627, Accuracy: 9728/9900 (98.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5375/5503 (97.6740%), train_poison_data_count: 430
Global model norm: 44.26234600015571.
Norm before scaling: 44.22284516151903. Distance: 1.2590925444206431
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0432, Accuracy: 9793/9900 (98.9192%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4355/4736 (91.9552%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4289/4736 (90.5617%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1285, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4731/5123 (92.3482%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4191/5123 (81.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2950, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5009/5353 (93.5737%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4874/5353 (91.0517%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1398, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5506/5871 (93.7830%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5380/5871 (91.6369%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1342, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5019/5702 (88.0217%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   2,  Average loss: 0.0129, Accuracy: 4336/5702 (76.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.3030, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4488/4903 (91.5358%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4394/4903 (89.6186%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1685, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4927/5504 (89.5167%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4794/5504 (87.1003%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2306, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4677/5038 (92.8345%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4627/5038 (91.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0399, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5262/5727 (91.8806%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5089/5727 (88.8598%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2549, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5150/5422 (94.9834%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5093/5422 (93.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9145, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4810/5068 (94.9092%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4744/5068 (93.6069%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1671, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4457/4714 (94.5482%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4426/4714 (93.8905%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9490, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3571/3774 (94.6211%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3540/3774 (93.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9205, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4773/5209 (91.6299%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4763/5209 (91.4379%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1413, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3284/3552 (92.4550%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3322/3552 (93.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8491, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3700/3910 (94.6292%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3538/3910 (90.4859%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1254, Accuracy: 5455/10000 (54.5500%)
time spent on training: 246.79683208465576
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3401, Accuracy: 6621/10000 (66.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0462, Accuracy: 9771/9900 (98.6970%)
Done in 273.1223335266113 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 82, 6, 27, 91, 61, 74, 8, 42, 9, 15, 85, 19, 89, 48, 96, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5199/5308 (97.9465%), train_poison_data_count: 415
Global model norm: 44.28114386675707.
Norm before scaling: 44.241323191495695. Distance: 1.2188449724802197
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0264, Accuracy: 9830/9900 (99.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5657/5777 (97.9228%), train_poison_data_count: 455
Global model norm: 44.28114386675707.
Norm before scaling: 44.235063521222195. Distance: 1.2352244677395743
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0856, Accuracy: 9678/9900 (97.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4997/5123 (97.5405%), train_poison_data_count: 403
Global model norm: 44.28114386675707.
Norm before scaling: 44.24266551812218. Distance: 1.2291017719961486
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0571, Accuracy: 9747/9900 (98.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5388/5503 (97.9102%), train_poison_data_count: 430
Global model norm: 44.28114386675707.
Norm before scaling: 44.240165695238844. Distance: 1.2358589909402997
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0403, Accuracy: 9788/9900 (98.8687%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4918/5298 (92.8275%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4887/5298 (92.2424%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0520, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4639/4929 (94.1165%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4539/4929 (92.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1913, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4267/4587 (93.0238%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4188/4587 (91.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9907, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4142/4527 (91.4955%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4089/4527 (90.3247%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9678, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4124/4485 (91.9509%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4119/4485 (91.8395%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1561, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4463/4797 (93.0373%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4401/4797 (91.7448%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0881, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4542/4889 (92.9024%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4500/4889 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0890, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5418/5907 (91.7217%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5345/5907 (90.4859%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3966, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5246/5727 (91.6012%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5144/5727 (89.8202%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0051, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5607/6068 (92.4028%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5581/6068 (91.9743%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1324, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6371/6947 (91.7087%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 6016/6947 (86.5985%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.4545, Accuracy: 4865/10000 (48.6500%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4862/5361 (90.6920%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4803/5361 (89.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1414, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4360/4737 (92.0414%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4312/4737 (91.0281%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2883, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4570/4830 (94.6170%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4500/4830 (93.1677%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0608, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4758/5086 (93.5509%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4709/5086 (92.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0711, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4983/5362 (92.9317%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4864/5362 (90.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1352, Accuracy: 5301/10000 (53.0100%)
time spent on training: 249.85059428215027
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3389, Accuracy: 6622/10000 (66.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0446, Accuracy: 9779/9900 (98.7778%)
Done in 276.8298890590668 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 74, 51, 9, 80, 78, 64, 90, 42, 14, 6, 57, 0, 46, 43, 18, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 44.30143687929673.
Norm before scaling: 44.25838550489613. Distance: 1.1420845204490626
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0657, Accuracy: 9718/9900 (98.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5650/5777 (97.8016%), train_poison_data_count: 455
Global model norm: 44.30143687929673.
Norm before scaling: 44.255443863138886. Distance: 1.25094144654253
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0440, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4971/5123 (97.0330%), train_poison_data_count: 403
Global model norm: 44.30143687929673.
Norm before scaling: 44.26405447487484. Distance: 1.2724068806569844
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0160, Accuracy: 9864/9900 (99.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5377/5503 (97.7103%), train_poison_data_count: 430
Global model norm: 44.30143687929673.
Norm before scaling: 44.26110217804822. Distance: 1.2522974835069645
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0592, Accuracy: 9755/9900 (98.5354%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4467/4797 (93.1207%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4381/4797 (91.3279%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0141, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3851/4108 (93.7439%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3787/4108 (92.1860%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9325, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5238/5727 (91.4615%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5132/5727 (89.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0581, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5045/5461 (92.3823%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4949/5461 (90.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3398, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4139/4368 (94.7573%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4023/4368 (92.1016%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0300, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4514/4894 (92.2354%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4411/4894 (90.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2140, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4511/4748 (95.0084%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4347/4748 (91.5543%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1499, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5453/5907 (92.3142%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5369/5907 (90.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4663, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3988/4196 (95.0429%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3962/4196 (94.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7844, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4670/4929 (94.7454%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4457/4929 (90.4240%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0578, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4645/4956 (93.7248%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4503/4956 (90.8596%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1697, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5047/5454 (92.5376%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4854/5454 (88.9989%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2326, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4924/5399 (91.2021%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4719/5399 (87.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3337, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4653/4979 (93.4525%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4604/4979 (92.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0819, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4016/4249 (94.5164%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3968/4249 (93.3867%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9341, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4601/5050 (91.1089%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4444/5050 (88.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3291, Accuracy: 4991/10000 (49.9100%)
time spent on training: 245.87621092796326
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.3517, Accuracy: 6593/10000 (65.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0423, Accuracy: 9783/9900 (98.8182%)
Done in 272.73629546165466 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 27, 87, 60, 89, 4, 98, 25, 54, 90, 2, 44, 35, 74, 78, 92, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.320342108442425.
Norm before scaling: 44.27727603242506. Distance: 1.1298741609840557
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0515, Accuracy: 9770/9900 (98.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5647/5777 (97.7497%), train_poison_data_count: 455
Global model norm: 44.320342108442425.
Norm before scaling: 44.27594302620075. Distance: 1.284868805344233
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0217, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4980/5123 (97.2087%), train_poison_data_count: 403
Global model norm: 44.320342108442425.
Norm before scaling: 44.27984957206833. Distance: 1.2196062454731824
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1057, Accuracy: 9612/9900 (97.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.320342108442425.
Norm before scaling: 44.28023689957872. Distance: 1.267239941359708
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0158, Accuracy: 9857/9900 (99.5657%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4283/4587 (93.3726%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4219/4587 (91.9773%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0022, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3651/3995 (91.3892%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3610/3995 (90.3630%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2508, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3852/4145 (92.9312%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3846/4145 (92.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0697, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4387/4737 (92.6114%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4366/4737 (92.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.4441, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3752/4028 (93.1480%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3758/4028 (93.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8991, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3958/4161 (95.1214%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3888/4161 (93.4391%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1703, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5782/6419 (90.0763%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5553/6419 (86.5088%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2180, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5101/5645 (90.3632%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4791/5645 (84.8716%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2937, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4484/4748 (94.4398%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4338/4748 (91.3648%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0781, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3731/3968 (94.0272%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3713/3968 (93.5736%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.7922, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4798/5075 (94.5419%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4727/5075 (93.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0240, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5231/5615 (93.1612%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5119/5615 (91.1665%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1641, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4475/4797 (93.2875%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4365/4797 (90.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0871, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4158/4368 (95.1923%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4080/4368 (93.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9368, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 6442/6812 (94.5684%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6257/6812 (91.8526%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1577, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4774/5068 (94.1989%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4631/5068 (91.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0640, Accuracy: 5402/10000 (54.0200%)
time spent on training: 245.4727544784546
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.3601, Accuracy: 6570/10000 (65.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0436, Accuracy: 9777/9900 (98.7576%)
Done in 272.39677572250366 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 95, 8, 67, 7, 31, 90, 40, 65, 34, 20, 2, 82, 51, 83, 86, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5201/5308 (97.9842%), train_poison_data_count: 415
Global model norm: 44.3385083230424.
Norm before scaling: 44.29719604160559. Distance: 1.1831569054317304
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0335, Accuracy: 9819/9900 (99.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5665/5777 (98.0613%), train_poison_data_count: 455
Global model norm: 44.3385083230424.
Norm before scaling: 44.29016841867603. Distance: 1.208336331374735
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0245, Accuracy: 9836/9900 (99.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4997/5123 (97.5405%), train_poison_data_count: 403
Global model norm: 44.3385083230424.
Norm before scaling: 44.29977531290015. Distance: 1.2348168946253766
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0522, Accuracy: 9775/9900 (98.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5375/5503 (97.6740%), train_poison_data_count: 430
Global model norm: 44.3385083230424.
Norm before scaling: 44.29789874257934. Distance: 1.231679701979178
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0707, Accuracy: 9706/9900 (98.0404%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4511/5018 (89.8964%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4474/5018 (89.1590%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1820, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4530/4889 (92.6570%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4404/4889 (90.0798%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0803, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5090/5559 (91.5632%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4938/5559 (88.8289%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.4863, Accuracy: 4839/10000 (48.3900%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4476/4869 (91.9285%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4036/4869 (82.8918%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3259, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4268/4537 (94.0710%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4233/4537 (93.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9212, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4553/4748 (95.8930%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4468/4748 (94.1028%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9315, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5549/5939 (93.4332%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5449/5939 (91.7495%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1681, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5072/5497 (92.2685%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4969/5497 (90.3948%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0625, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4545/4911 (92.5473%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4558/4911 (92.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9901, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4482/4714 (95.0785%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4436/4714 (94.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8774, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3719/3968 (93.7248%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3705/3968 (93.3720%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9781, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4966/5298 (93.7335%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4952/5298 (93.4692%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0586, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3858/4108 (93.9143%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3858/4108 (93.9143%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0348, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3286/3552 (92.5113%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3343/3552 (94.1160%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7754, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3598/3929 (91.5755%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3569/3929 (90.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0391, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 6455/6812 (94.7592%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   2,  Average loss: 0.0032, Accuracy: 6377/6812 (93.6142%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1886, Accuracy: 5328/10000 (53.2800%)
time spent on training: 245.6116623878479
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.3652, Accuracy: 6560/10000 (65.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0417, Accuracy: 9788/9900 (98.8687%)
Done in 272.18808794021606 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 93, 42, 22, 44, 28, 6, 70, 27, 35, 41, 8, 24, 26, 60, 31, 12].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 44.356124946984494.
Norm before scaling: 44.314553626161434. Distance: 1.1619355400281905
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0515, Accuracy: 9759/9900 (98.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5636/5777 (97.5593%), train_poison_data_count: 455
Global model norm: 44.356124946984494.
Norm before scaling: 44.311487614052325. Distance: 1.2988833308139516
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0684, Accuracy: 9720/9900 (98.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 44.356124946984494.
Norm before scaling: 44.31704098955968. Distance: 1.2330634476950344
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0669, Accuracy: 9708/9900 (98.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5388/5503 (97.9102%), train_poison_data_count: 430
Global model norm: 44.356124946984494.
Norm before scaling: 44.31419276782623. Distance: 1.2443658214711495
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0738, Accuracy: 9693/9900 (97.9091%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4681/5055 (92.6014%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4620/5055 (91.3947%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2142, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5437/5907 (92.0433%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5277/5907 (89.3347%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.5122, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5284/5696 (92.7669%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5109/5696 (89.6945%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0962, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4776/5075 (94.1084%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4680/5075 (92.2167%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1206, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4686/5122 (91.4877%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4239/5122 (82.7606%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.5274, Accuracy: 4770/10000 (47.7000%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4649/4929 (94.3193%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4530/4929 (91.9051%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0535, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5500/5871 (93.6808%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5379/5871 (91.6198%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1523, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4281/4587 (93.3290%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4240/4587 (92.4351%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0092, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5247/5615 (93.4461%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5118/5615 (91.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2371, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4440/4714 (94.1875%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4403/4714 (93.4026%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1003, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4571/4889 (93.4956%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4439/4889 (90.7957%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1576, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4064/4313 (94.2268%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4052/4313 (93.9485%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8426, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3872/4086 (94.7626%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3839/4086 (93.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9990, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3857/4145 (93.0519%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3837/4145 (92.5694%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1194, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4256/4537 (93.8065%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4204/4537 (92.6603%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8345, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5081/5526 (91.9472%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4941/5526 (89.4137%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2940, Accuracy: 5104/10000 (51.0400%)
time spent on training: 246.46809363365173
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.3710, Accuracy: 6545/10000 (65.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0398, Accuracy: 9790/9900 (98.8889%)
Done in 273.16072845458984 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 90, 84, 56, 79, 2, 19, 51, 77, 98, 18, 60, 16, 88, 63, 69, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.37480606251635.
Norm before scaling: 44.33305125517248. Distance: 1.175516345830061
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0556, Accuracy: 9758/9900 (98.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5658/5777 (97.9401%), train_poison_data_count: 455
Global model norm: 44.37480606251635.
Norm before scaling: 44.32905439411676. Distance: 1.272383271055268
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0778, Accuracy: 9701/9900 (97.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4988/5123 (97.3648%), train_poison_data_count: 403
Global model norm: 44.37480606251635.
Norm before scaling: 44.335750963263976. Distance: 1.2249865764738808
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1273, Accuracy: 9552/9900 (96.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5393/5503 (98.0011%), train_poison_data_count: 430
Global model norm: 44.37480606251635.
Norm before scaling: 44.331586377900464. Distance: 1.2158125176237327
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0598, Accuracy: 9742/9900 (98.4040%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4535/4748 (95.5139%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4396/4748 (92.5864%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9827, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4815/5209 (92.4362%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4770/5209 (91.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2824, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5023/5427 (92.5557%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4829/5427 (88.9810%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1931, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3880/4111 (94.3809%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3776/4111 (91.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1095, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3770/3968 (95.0101%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3746/3968 (94.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7968, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4936/5361 (92.0724%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4741/5361 (88.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2168, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3888/4108 (94.6446%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3701/4108 (90.0925%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2376, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4634/5050 (91.7624%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4490/5050 (88.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1934, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3915/4161 (94.0880%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3838/4161 (92.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0178, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3974/4249 (93.5279%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3866/4249 (90.9861%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1931, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3886/4145 (93.7515%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3853/4145 (92.9554%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1162, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5012/5353 (93.6297%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4895/5353 (91.4441%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1452, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4943/5362 (92.1858%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4880/5362 (91.0108%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0645, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3718/3910 (95.0895%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3670/3910 (93.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1241, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4096/4364 (93.8588%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4003/4364 (91.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0585, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5282/5727 (92.2298%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5044/5727 (88.0740%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1354, Accuracy: 5404/10000 (54.0400%)
time spent on training: 242.62129139900208
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.3798, Accuracy: 6539/10000 (65.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0424, Accuracy: 9781/9900 (98.7980%)
Done in 269.2087228298187 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 37, 97, 49, 32, 82, 55, 2, 63, 31, 12, 87, 60, 93, 0, 66, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5184/5308 (97.6639%), train_poison_data_count: 415
Global model norm: 44.392592518435016.
Norm before scaling: 44.35321180547061. Distance: 1.251654864652201
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0555, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 44.392592518435016.
Norm before scaling: 44.34487451225691. Distance: 1.1910945797351489
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0552, Accuracy: 9750/9900 (98.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4989/5123 (97.3843%), train_poison_data_count: 403
Global model norm: 44.392592518435016.
Norm before scaling: 44.35319804431032. Distance: 1.231995570815782
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0504, Accuracy: 9771/9900 (98.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5390/5503 (97.9466%), train_poison_data_count: 430
Global model norm: 44.392592518435016.
Norm before scaling: 44.35079940883958. Distance: 1.241567492951484
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0269, Accuracy: 9829/9900 (99.2828%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4422/4741 (93.2715%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4265/4741 (89.9599%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3747, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4308/4736 (90.9628%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4212/4736 (88.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2934, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5168/5652 (91.4367%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5005/5652 (88.5527%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3145, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5475/6080 (90.0493%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5339/6080 (87.8125%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2673, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5031/5298 (94.9604%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4937/5298 (93.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9096, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4465/4731 (94.3775%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4435/4731 (93.7434%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9213, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3756/3968 (94.6573%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3725/3968 (93.8760%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8103, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3721/3910 (95.1662%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3523/3910 (90.1023%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1239, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4270/4537 (94.1151%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4186/4537 (92.2636%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9826, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5068/5526 (91.7119%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4900/5526 (88.6717%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2770, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3710/3995 (92.8661%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3616/3995 (90.5131%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0609, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3883/4145 (93.6791%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3880/4145 (93.6068%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0868, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4713/5055 (93.2344%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4581/5055 (90.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1193, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5037/5454 (92.3542%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4867/5454 (89.2373%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2683, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4495/4843 (92.8144%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4480/4843 (92.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9642, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3894/4130 (94.2857%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3820/4130 (92.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0542, Accuracy: 5565/10000 (55.6500%)
time spent on training: 241.2937831878662
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.3889, Accuracy: 6520/10000 (65.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0401, Accuracy: 9789/9900 (98.8788%)
Done in 267.77398562431335 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 59, 98, 38, 39, 7, 3, 32, 76, 35, 66, 73, 20, 74, 49, 62, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5198/5308 (97.9277%), train_poison_data_count: 415
Global model norm: 44.4109119649946.
Norm before scaling: 44.36763528234151. Distance: 1.1605589710325541
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0331, Accuracy: 9819/9900 (99.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5681/5777 (98.3382%), train_poison_data_count: 455
Global model norm: 44.4109119649946.
Norm before scaling: 44.363014171347594. Distance: 1.1963549786527428
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0438, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4996/5123 (97.5210%), train_poison_data_count: 403
Global model norm: 44.4109119649946.
Norm before scaling: 44.37102617550317. Distance: 1.1967875037818427
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0553, Accuracy: 9753/9900 (98.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5379/5503 (97.7467%), train_poison_data_count: 430
Global model norm: 44.4109119649946.
Norm before scaling: 44.37214311886386. Distance: 1.3029279436372259
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0489, Accuracy: 9783/9900 (98.8182%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4228/4397 (96.1565%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0020, Accuracy: 4236/4397 (96.3384%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7432, Accuracy: 6044/10000 (60.4400%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3936/4161 (94.5926%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3831/4161 (92.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1345, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5677/6235 (91.0505%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5502/6235 (88.2438%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3969, Accuracy: 4903/10000 (49.0300%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3905/4175 (93.5329%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3775/4175 (90.4192%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0815, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4467/4869 (91.7437%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4299/4869 (88.2933%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1342, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5039/5346 (94.2574%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4932/5346 (92.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2172, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5503/6080 (90.5099%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5321/6080 (87.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2235, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3653/3959 (92.2708%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3588/3959 (90.6289%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1980, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5206/5615 (92.7159%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5137/5615 (91.4871%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1343, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4515/4843 (93.2273%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4467/4843 (92.2362%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9409, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4388/4605 (95.2877%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4329/4605 (94.0065%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0544, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4473/4714 (94.8876%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4420/4714 (93.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9307, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4418/4797 (92.0992%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4328/4797 (90.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1217, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5167/5652 (91.4190%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5014/5652 (88.7120%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3537, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4925/5504 (89.4804%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4844/5504 (88.0087%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2730, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4768/5075 (93.9507%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4577/5075 (90.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0265, Accuracy: 5560/10000 (55.6000%)
time spent on training: 246.78982496261597
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.3895, Accuracy: 6526/10000 (65.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0425, Accuracy: 9785/9900 (98.8384%)
Done in 273.37726759910583 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 32, 2, 40, 91, 74, 50, 6, 92, 53, 87, 69, 86, 52, 37, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 44.42974451046984.
Norm before scaling: 44.38773749848459. Distance: 1.1934695528555137
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0123, Accuracy: 9867/9900 (99.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5653/5777 (97.8536%), train_poison_data_count: 455
Global model norm: 44.42974451046984.
Norm before scaling: 44.38266466596573. Distance: 1.2350083669772873
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0484, Accuracy: 9772/9900 (98.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4993/5123 (97.4624%), train_poison_data_count: 403
Global model norm: 44.42974451046984.
Norm before scaling: 44.39123685120395. Distance: 1.233844594836462
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.2330, Accuracy: 9253/9900 (93.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5369/5503 (97.5650%), train_poison_data_count: 430
Global model norm: 44.42974451046984.
Norm before scaling: 44.38875502045113. Distance: 1.2859683268341193
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0277, Accuracy: 9832/9900 (99.3131%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3914/4175 (93.7485%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3838/4175 (91.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9651, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5450/6080 (89.6382%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5291/6080 (87.0230%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2943, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3769/3968 (94.9849%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3745/3968 (94.3800%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7403, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5546/5939 (93.3827%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5396/5939 (90.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2605, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4108/4527 (90.7444%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3996/4527 (88.2704%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3215, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4504/4797 (93.8920%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4438/4797 (92.5162%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0629, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4463/4757 (93.8196%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4339/4757 (91.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1647, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4625/4929 (93.8324%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4470/4929 (90.6878%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0962, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   1,  Average loss: 0.0026, Accuracy: 6485/6812 (95.1996%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 6320/6812 (92.7775%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2446, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5957/6664 (89.3908%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   2,  Average loss: 0.0081, Accuracy: 5612/6664 (84.2137%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2142, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3691/3995 (92.3905%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3635/3995 (90.9887%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1375, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4057/4364 (92.9652%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4011/4364 (91.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0018, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3613/3929 (91.9572%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3587/3929 (91.2955%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0280, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3892/4130 (94.2373%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3794/4130 (91.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.4535, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4388/4741 (92.5543%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4075/4741 (85.9523%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3705, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5514/5871 (93.9193%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5363/5871 (91.3473%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3086, Accuracy: 5205/10000 (52.0500%)
time spent on training: 246.868590593338
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.3945, Accuracy: 6513/10000 (65.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0447, Accuracy: 9784/9900 (98.8283%)
Done in 273.8280313014984 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 30, 23, 34, 24, 2, 67, 21, 72, 83, 87, 29, 15, 42, 37, 70, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 44.44886018645472.
Norm before scaling: 44.40525624547799. Distance: 1.157925808982452
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0346, Accuracy: 9810/9900 (99.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5657/5777 (97.9228%), train_poison_data_count: 455
Global model norm: 44.44886018645472.
Norm before scaling: 44.40316557725642. Distance: 1.2577759162842628
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0243, Accuracy: 9836/9900 (99.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4979/5123 (97.1891%), train_poison_data_count: 403
Global model norm: 44.44886018645472.
Norm before scaling: 44.410242662254305. Distance: 1.2529894843516496
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0361, Accuracy: 9810/9900 (99.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5382/5503 (97.8012%), train_poison_data_count: 430
Global model norm: 44.44886018645472.
Norm before scaling: 44.40579092391132. Distance: 1.2399543986856965
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0214, Accuracy: 9849/9900 (99.4848%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3572/3774 (94.6476%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3565/3774 (94.4621%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9661, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4298/4549 (94.4823%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4221/4549 (92.7896%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8792, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4613/4911 (93.9320%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4517/4911 (91.9772%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2468, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4058/4313 (94.0876%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4006/4313 (92.8820%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9510, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3785/3968 (95.3881%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3713/3968 (93.5736%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7642, Accuracy: 5890/10000 (58.9000%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5128/5559 (92.2468%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4882/5559 (87.8216%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2628, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4697/5038 (93.2314%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4602/5038 (91.3458%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0303, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4757/5193 (91.6041%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4557/5193 (87.7527%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.4447, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3279/3552 (92.3142%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3262/3552 (91.8356%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8702, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3696/3995 (92.5156%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3592/3995 (89.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1981, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4475/4732 (94.5689%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4469/4732 (94.4421%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8462, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5622/6068 (92.6500%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5458/6068 (89.9473%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3613, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5364/5907 (90.8075%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5274/5907 (89.2839%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.4880, Accuracy: 4845/10000 (48.4500%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4424/4741 (93.3136%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4075/4741 (85.9523%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.6230, Accuracy: 4738/10000 (47.3800%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5531/5871 (94.2088%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5408/5871 (92.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0265, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3878/4111 (94.3323%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3783/4111 (92.0214%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0929, Accuracy: 5508/10000 (55.0800%)
time spent on training: 243.53411054611206
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.4001, Accuracy: 6497/10000 (64.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0410, Accuracy: 9790/9900 (98.8889%)
Done in 270.068966627121 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 51, 97, 20, 54, 5, 34, 74, 14, 77, 50, 56, 10, 16, 39, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5210/5308 (98.1537%), train_poison_data_count: 415
Global model norm: 44.466910757818.
Norm before scaling: 44.42448687581757. Distance: 1.154977304227375
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0195, Accuracy: 9844/9900 (99.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Significant loss increase detected for 36 at epoch 170: Current loss: 0.1375, Previous loss: 0.0895, Loss jump: 0.0480, Applied weight: 0.7128
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5673/5777 (98.1998%), train_poison_data_count: 455
Global model norm: 44.466910757818.
Norm before scaling: 44.41997335887455. Distance: 1.227771236340879
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0229, Accuracy: 9840/9900 (99.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Significant loss increase detected for 58 at epoch 170: Current loss: 0.2232, Previous loss: 0.1451, Loss jump: 0.0780, Applied weight: 0.7112
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4987/5123 (97.3453%), train_poison_data_count: 403
Global model norm: 44.466910757818.
Norm before scaling: 44.42678673821473. Distance: 1.222556795700461
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0383, Accuracy: 9813/9900 (99.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5377/5503 (97.7103%), train_poison_data_count: 430
Global model norm: 44.466910757818.
Norm before scaling: 44.42447451064419. Distance: 1.228617944383364
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0567, Accuracy: 9766/9900 (98.6465%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4369/4672 (93.5146%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4395/4672 (94.0711%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0337, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3871/4108 (94.2308%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3820/4108 (92.9893%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0125, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4370/4736 (92.2720%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4275/4736 (90.2660%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0676, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4489/4714 (95.2270%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4442/4714 (94.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8256, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5137/5645 (91.0009%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4910/5645 (86.9796%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1480, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4743/4993 (94.9930%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4573/4993 (91.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2608, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4626/4911 (94.1967%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4589/4911 (93.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0930, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4405/4797 (91.8282%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4394/4797 (91.5989%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1579, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4010/4196 (95.5672%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3981/4196 (94.8761%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7752, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4604/5050 (91.1683%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4505/5050 (89.2079%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1617, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4464/4757 (93.8407%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4367/4757 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0590, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4955/5427 (91.3027%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4858/5427 (89.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0866, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4774/5068 (94.1989%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4736/5068 (93.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1591, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4996/5353 (93.3308%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4791/5353 (89.5012%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1147, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3882/4175 (92.9820%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3834/4175 (91.8323%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0565, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3865/4111 (94.0161%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3833/4111 (93.2377%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9569, Accuracy: 5639/10000 (56.3900%)
time spent on training: 244.62117671966553
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.4162, Accuracy: 6479/10000 (64.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0363, Accuracy: 9797/9900 (98.9596%)
Done in 271.033739566803 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 31, 8, 83, 64, 23, 74, 90, 97, 86, 76, 0, 62, 33, 32, 54, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 44.484597272890426.
Norm before scaling: 44.44155577702937. Distance: 1.1606344143142107
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0437, Accuracy: 9792/9900 (98.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5654/5777 (97.8709%), train_poison_data_count: 455
Global model norm: 44.484597272890426.
Norm before scaling: 44.43767992887272. Distance: 1.2256409408567568
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0771, Accuracy: 9706/9900 (98.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 44.484597272890426.
Norm before scaling: 44.44365974581259. Distance: 1.1988046533816945
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0703, Accuracy: 9720/9900 (98.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5352/5503 (97.2560%), train_poison_data_count: 430
Global model norm: 44.484597272890426.
Norm before scaling: 44.443564986958464. Distance: 1.292971193247904
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0232, Accuracy: 9837/9900 (99.3636%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4310/4537 (94.9967%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4227/4537 (93.1673%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9238, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4549/4889 (93.0456%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4563/4889 (93.3320%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0009, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3317/3552 (93.3840%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3384/3552 (95.2703%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7906, Accuracy: 5928/10000 (59.2800%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4505/4894 (92.0515%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4384/4894 (89.5791%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1508, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4328/4549 (95.1418%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3810/4549 (83.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.4693, Accuracy: 4979/10000 (49.7900%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4452/4797 (92.8080%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4361/4797 (90.9110%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0499, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4539/4748 (95.5981%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4408/4748 (92.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9589, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4349/4736 (91.8285%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4242/4736 (89.5693%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1166, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3657/3929 (93.0771%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3580/3929 (91.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9615, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3648/3959 (92.1445%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3645/3959 (92.0687%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0312, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5010/5454 (91.8592%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4772/5454 (87.4954%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.4285, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4947/5504 (89.8801%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4731/5504 (85.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3470, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4507/4818 (93.5450%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4396/4818 (91.2412%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0412, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5478/6080 (90.0987%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5332/6080 (87.6974%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3002, Accuracy: 4970/10000 (49.7000%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5162/5645 (91.4438%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4839/5645 (85.7219%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2821, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4489/4869 (92.1955%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4059/4869 (83.3641%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.8248, Accuracy: 4672/10000 (46.7200%)
time spent on training: 244.7437744140625
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.4173, Accuracy: 6479/10000 (64.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0352, Accuracy: 9802/9900 (99.0101%)
Done in 271.6008040904999 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 93, 25, 55, 21, 42, 88, 17, 23, 2, 68, 12, 52, 5, 44, 72, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5224/5308 (98.4175%), train_poison_data_count: 415
Global model norm: 44.504006194755235.
Norm before scaling: 44.459780916471296. Distance: 1.1196408843020695
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0206, Accuracy: 9851/9900 (99.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5652/5777 (97.8362%), train_poison_data_count: 455
Global model norm: 44.504006194755235.
Norm before scaling: 44.45744432003205. Distance: 1.249167212591546
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0847, Accuracy: 9666/9900 (97.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 44.504006194755235.
Norm before scaling: 44.46233428332204. Distance: 1.1991034337369753
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0637, Accuracy: 9727/9900 (98.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5401/5503 (98.1465%), train_poison_data_count: 430
Global model norm: 44.504006194755235.
Norm before scaling: 44.46022707985405. Distance: 1.17154821289989
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0580, Accuracy: 9740/9900 (98.3838%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4672/5055 (92.4233%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4634/5055 (91.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1780, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5862/6419 (91.3226%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5549/6419 (86.4465%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3427, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4472/4731 (94.5255%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4409/4731 (93.1938%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0738, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4681/5038 (92.9139%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4639/5038 (92.0802%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9600, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5451/5907 (92.2803%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5389/5907 (91.2307%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3470, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4982/5362 (92.9131%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4816/5362 (89.8172%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1144, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4511/4903 (92.0049%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4423/4903 (90.2101%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0972, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4322/4549 (95.0099%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4141/4549 (91.0310%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1362, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3747/3968 (94.4304%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3745/3968 (94.3800%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8635, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3406/3589 (94.9011%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3251/3589 (90.5823%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0728, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5143/5526 (93.0691%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4849/5526 (87.7488%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.4219, Accuracy: 4862/10000 (48.6200%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3907/4130 (94.6005%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3836/4130 (92.8814%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9176, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4725/4993 (94.6325%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4585/4993 (91.8286%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1429, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4792/5075 (94.4236%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4570/5075 (90.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1804, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4770/5193 (91.8544%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4475/5193 (86.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.5497, Accuracy: 4798/10000 (47.9800%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4721/5035 (93.7637%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4720/5035 (93.7438%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0489, Accuracy: 5571/10000 (55.7100%)
time spent on training: 246.40206289291382
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.4146, Accuracy: 6474/10000 (64.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0357, Accuracy: 9800/9900 (98.9899%)
Done in 272.9897127151489 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 32, 54, 57, 25, 67, 38, 0, 98, 43, 94, 42, 26, 70, 90, 56, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5224/5308 (98.4175%), train_poison_data_count: 415
Global model norm: 44.52282403836893.
Norm before scaling: 44.47897836733171. Distance: 1.1310002003744608
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0346, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5654/5777 (97.8709%), train_poison_data_count: 455
Global model norm: 44.52282403836893.
Norm before scaling: 44.474954822296475. Distance: 1.221865315898949
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0458, Accuracy: 9774/9900 (98.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.52282403836893.
Norm before scaling: 44.480589330048645. Distance: 1.2196648905107719
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0262, Accuracy: 9826/9900 (99.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5379/5503 (97.7467%), train_poison_data_count: 430
Global model norm: 44.52282403836893.
Norm before scaling: 44.482679103605875. Distance: 1.2923781322378936
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0293, Accuracy: 9829/9900 (99.2828%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5559/6080 (91.4309%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5276/6080 (86.7763%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2455, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5159/5645 (91.3906%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4878/5645 (86.4128%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1908, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4672/4956 (94.2696%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4531/4956 (91.4245%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1688, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5808/6419 (90.4814%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5540/6419 (86.3063%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3491, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5131/5559 (92.3008%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4916/5559 (88.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1802, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5696/6235 (91.3553%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5470/6235 (87.7306%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3236, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5051/5454 (92.6109%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4942/5454 (90.6124%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1136, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3937/4161 (94.6167%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3830/4161 (92.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1002, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4621/4979 (92.8098%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4518/4979 (90.7411%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2513, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4791/5224 (91.7113%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4762/5224 (91.1562%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1648, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5503/5907 (93.1607%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5464/5907 (92.5004%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2948, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3893/4086 (95.2766%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3834/4086 (93.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9636, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5524/5871 (94.0896%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5384/5871 (91.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2197, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4528/4748 (95.3665%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4383/4748 (92.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1944, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4953/5427 (91.2659%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4832/5427 (89.0363%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0917, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4032/4196 (96.0915%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4010/4196 (95.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9295, Accuracy: 5734/10000 (57.3400%)
time spent on training: 251.77491068840027
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.4255, Accuracy: 6464/10000 (64.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0322, Accuracy: 9808/9900 (99.0707%)
Done in 278.4044895172119 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 12, 96, 75, 78, 54, 4, 5, 33, 35, 83, 57, 40, 6, 38, 18, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.543001464788915.
Norm before scaling: 44.5008325391749. Distance: 1.219208264391966
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0307, Accuracy: 9821/9900 (99.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5676/5777 (98.2517%), train_poison_data_count: 455
Global model norm: 44.543001464788915.
Norm before scaling: 44.49486177761849. Distance: 1.2335407480035543
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0342, Accuracy: 9813/9900 (99.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5011/5123 (97.8138%), train_poison_data_count: 403
Global model norm: 44.543001464788915.
Norm before scaling: 44.500869571033384. Distance: 1.1608130140550408
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0433, Accuracy: 9791/9900 (98.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5409/5503 (98.2918%), train_poison_data_count: 430
Global model norm: 44.543001464788915.
Norm before scaling: 44.49889449557286. Distance: 1.1754980411553784
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0827, Accuracy: 9667/9900 (97.6465%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5046/5526 (91.3138%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4818/5526 (87.1878%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.5034, Accuracy: 4784/10000 (47.8400%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4769/5086 (93.7672%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4712/5086 (92.6465%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0052, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4417/4672 (94.5420%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4381/4672 (93.7714%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9011, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4126/4368 (94.4597%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4042/4368 (92.5366%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1413, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5122/5645 (90.7352%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4823/5645 (85.4384%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2154, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3792/4028 (94.1410%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3775/4028 (93.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8878, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4702/4993 (94.1718%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4607/4993 (92.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2113, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4502/4818 (93.4413%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4429/4818 (91.9261%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0061, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5186/5615 (92.3598%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5079/5615 (90.4541%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3338, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3293/3552 (92.7083%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3315/3552 (93.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9212, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4634/4956 (93.5028%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4570/4956 (92.2115%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0679, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5591/5939 (94.1404%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5501/5939 (92.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0547, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4642/4929 (94.1773%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4534/4929 (91.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2526, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5684/6235 (91.1628%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5507/6235 (88.3240%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3532, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4010/4249 (94.3751%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3932/4249 (92.5394%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9571, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4215/4485 (93.9799%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3807/4485 (84.8829%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3355, Accuracy: 4902/10000 (49.0200%)
time spent on training: 243.5770959854126
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.4261, Accuracy: 6470/10000 (64.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0311, Accuracy: 9810/9900 (99.0909%)
Done in 270.7853124141693 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 65, 4, 57, 0, 72, 62, 24, 77, 78, 41, 19, 61, 52, 59, 2, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.561189222920625.
Norm before scaling: 44.51604866637635. Distance: 1.112890931354024
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0487, Accuracy: 9769/9900 (98.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.561189222920625.
Norm before scaling: 44.5116842981986. Distance: 1.1998061937549047
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0653, Accuracy: 9732/9900 (98.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4992/5123 (97.4429%), train_poison_data_count: 403
Global model norm: 44.561189222920625.
Norm before scaling: 44.52064840908795. Distance: 1.2082741273428106
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0490, Accuracy: 9762/9900 (98.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5400/5503 (98.1283%), train_poison_data_count: 430
Global model norm: 44.561189222920625.
Norm before scaling: 44.51649289475124. Distance: 1.2041121557408618
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0383, Accuracy: 9802/9900 (99.0101%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5105/5497 (92.8688%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4927/5497 (89.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1176, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3821/4028 (94.8610%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3779/4028 (93.8183%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9591, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4678/4956 (94.3906%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4507/4956 (90.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1630, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5013/5454 (91.9142%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4887/5454 (89.6040%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2555, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4787/5193 (92.1818%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4526/5193 (87.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.5790, Accuracy: 4851/10000 (48.5100%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4984/5504 (90.5523%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4886/5504 (88.7718%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1594, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4053/4313 (93.9717%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4040/4313 (93.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9882, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4599/5050 (91.0693%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4480/5050 (88.7129%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1260, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4140/4368 (94.7802%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4056/4368 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9819, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4472/4714 (94.8664%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4425/4714 (93.8693%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0354, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4889/5361 (91.1957%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4860/5361 (90.6547%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0581, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4150/4485 (92.5307%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3731/4485 (83.1884%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.5495, Accuracy: 4778/10000 (47.7800%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3917/4130 (94.8426%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3892/4130 (94.2373%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9170, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4173/4397 (94.9056%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4206/4397 (95.6561%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9329, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3757/3968 (94.6825%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3760/3968 (94.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8049, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4380/4605 (95.1140%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4318/4605 (93.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8688, Accuracy: 5772/10000 (57.7200%)
time spent on training: 242.46315050125122
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.4279, Accuracy: 6467/10000 (64.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0328, Accuracy: 9807/9900 (99.0606%)
Done in 269.37289452552795 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 19, 85, 76, 57, 46, 62, 22, 25, 89, 95, 48, 51, 45, 96, 41, 17].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5201/5308 (97.9842%), train_poison_data_count: 415
Global model norm: 44.57857545557549.
Norm before scaling: 44.53616612118108. Distance: 1.1837987942493071
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0480, Accuracy: 9782/9900 (98.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5664/5777 (98.0440%), train_poison_data_count: 455
Global model norm: 44.57857545557549.
Norm before scaling: 44.52936810716538. Distance: 1.1909667658456882
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0257, Accuracy: 9826/9900 (99.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5006/5123 (97.7162%), train_poison_data_count: 403
Global model norm: 44.57857545557549.
Norm before scaling: 44.53541236029552. Distance: 1.1688688248393815
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0693, Accuracy: 9719/9900 (98.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5393/5503 (98.0011%), train_poison_data_count: 430
Global model norm: 44.57857545557549.
Norm before scaling: 44.53339632985424. Distance: 1.2001471886170454
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0528, Accuracy: 9757/9900 (98.5556%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4898/5361 (91.3636%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4796/5361 (89.4609%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1406, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6331/6947 (91.1329%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5994/6947 (86.2818%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5798, Accuracy: 4790/10000 (47.9000%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3637/3959 (91.8666%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3659/3959 (92.4223%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0747, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4645/4956 (93.7248%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4603/4956 (92.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1940, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4839/5399 (89.6277%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4740/5399 (87.7940%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2386, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4944/5504 (89.8256%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4790/5504 (87.0276%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5004, Accuracy: 4924/10000 (49.2400%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5330/5696 (93.5744%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5109/5696 (89.6945%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2947, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5845/6419 (91.0578%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5532/6419 (86.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1586, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4427/4737 (93.4558%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4324/4737 (91.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1954, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4613/5018 (91.9291%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4473/5018 (89.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5508, Accuracy: 4867/10000 (48.6700%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4605/4830 (95.3416%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4519/4830 (93.5611%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0331, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3901/4108 (94.9611%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3801/4108 (92.5268%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0204, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4987/5489 (90.8544%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4967/5489 (90.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1799, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4789/5086 (94.1604%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4771/5086 (93.8065%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9885, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4447/4714 (94.3360%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4403/4714 (93.4026%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0686, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4491/4903 (91.5970%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4455/4903 (90.8627%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3230, Accuracy: 5166/10000 (51.6600%)
time spent on training: 246.1413676738739
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.4369, Accuracy: 6459/10000 (64.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0315, Accuracy: 9813/9900 (99.1212%)
Done in 272.7550070285797 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 2, 27, 99, 74, 8, 3, 67, 72, 7, 24, 17, 10, 20, 59, 16, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 44.59781209599861.
Norm before scaling: 44.551579789259435. Distance: 1.0984702570712446
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0322, Accuracy: 9809/9900 (99.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.59781209599861.
Norm before scaling: 44.54634201496305. Distance: 1.1738304100077854
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0361, Accuracy: 9813/9900 (99.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 44.59781209599861.
Norm before scaling: 44.55544846908457. Distance: 1.1941727833259568
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0787, Accuracy: 9704/9900 (98.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5409/5503 (98.2918%), train_poison_data_count: 430
Global model norm: 44.59781209599861.
Norm before scaling: 44.553611436023765. Distance: 1.2051113624873404
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0369, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3762/3968 (94.8085%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3758/3968 (94.7077%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8597, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4309/4587 (93.9394%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4219/4587 (91.9773%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0714, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4431/4851 (91.3420%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4355/4851 (89.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0882, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4500/4797 (93.8086%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4358/4797 (90.8484%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9588, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4601/4889 (94.1092%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4435/4889 (90.7138%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1471, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5064/5346 (94.7250%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4951/5346 (92.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2654, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5162/5559 (92.8584%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4946/5559 (88.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1926, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4736/5193 (91.1997%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4541/5193 (87.4446%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.7121, Accuracy: 4791/10000 (47.9100%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4520/4869 (92.8322%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4227/4869 (86.8145%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1893, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4054/4313 (93.9949%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4027/4313 (93.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9288, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4538/4903 (92.5556%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4449/4903 (90.7404%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3578, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4855/5068 (95.7972%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4664/5068 (92.0284%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2761, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4503/4714 (95.5240%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4464/4714 (94.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9162, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4211/4397 (95.7698%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4210/4397 (95.7471%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7011, Accuracy: 6055/10000 (60.5500%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5034/5353 (94.0407%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4881/5353 (91.1825%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1555, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4544/4818 (94.3130%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4340/4818 (90.0789%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1971, Accuracy: 5341/10000 (53.4100%)
time spent on training: 245.0018503665924
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.4410, Accuracy: 6446/10000 (64.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0297, Accuracy: 9816/9900 (99.1515%)
Done in 271.5853416919708 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 44, 6, 40, 60, 96, 93, 0, 47, 5, 94, 78, 63, 23, 45, 26, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5220/5308 (98.3421%), train_poison_data_count: 415
Global model norm: 44.61540704620364.
Norm before scaling: 44.571023904269914. Distance: 1.130545933427617
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0832, Accuracy: 9680/9900 (97.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.61540704620364.
Norm before scaling: 44.5655816124184. Distance: 1.1959458212940515
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0323, Accuracy: 9815/9900 (99.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 44.61540704620364.
Norm before scaling: 44.57285063434775. Distance: 1.2008568327327565
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0270, Accuracy: 9833/9900 (99.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5395/5503 (98.0374%), train_poison_data_count: 430
Global model norm: 44.61540704620364.
Norm before scaling: 44.570904767099044. Distance: 1.1948310530716115
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0380, Accuracy: 9812/9900 (99.1111%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4782/5075 (94.2266%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4738/5075 (93.3596%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1832, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4637/4929 (94.0759%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4504/4929 (91.3776%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2907, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5569/5939 (93.7700%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5477/5939 (92.2209%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2137, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3875/4145 (93.4861%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3864/4145 (93.2207%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1089, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4779/5086 (93.9638%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4714/5086 (92.6858%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2353, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4716/5055 (93.2938%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4602/5055 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0105, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5036/5454 (92.3359%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4814/5454 (88.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2170, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4767/5123 (93.0509%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   2,  Average loss: 0.0122, Accuracy: 3979/5123 (77.6693%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2988, Accuracy: 4931/10000 (49.3100%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4708/4993 (94.2920%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4607/4993 (92.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9985, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4837/5224 (92.5919%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4762/5224 (91.1562%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0133, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4155/4368 (95.1236%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4132/4368 (94.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9357, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3731/3910 (95.4220%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3616/3910 (92.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0539, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4353/4549 (95.6914%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4024/4549 (88.4590%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2960, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5013/5489 (91.3281%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4997/5489 (91.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1820, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3872/4086 (94.7626%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3806/4086 (93.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0195, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4770/5193 (91.8544%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4587/5193 (88.3304%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3934, Accuracy: 5172/10000 (51.7200%)
time spent on training: 244.34722065925598
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.4533, Accuracy: 6417/10000 (64.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0273, Accuracy: 9821/9900 (99.2020%)
Done in 271.1528334617615 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 27, 56, 90, 39, 16, 69, 88, 23, 98, 84, 48, 3, 35, 81, 55, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5228/5308 (98.4928%), train_poison_data_count: 415
Global model norm: 44.633846998119736.
Norm before scaling: 44.58757950476512. Distance: 1.0835244792642744
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0555, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5672/5777 (98.1824%), train_poison_data_count: 455
Global model norm: 44.633846998119736.
Norm before scaling: 44.583513738439514. Distance: 1.166214355709067
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0278, Accuracy: 9835/9900 (99.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5006/5123 (97.7162%), train_poison_data_count: 403
Global model norm: 44.633846998119736.
Norm before scaling: 44.591280809354984. Distance: 1.1876741582752153
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0772, Accuracy: 9703/9900 (98.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5407/5503 (98.2555%), train_poison_data_count: 430
Global model norm: 44.633846998119736.
Norm before scaling: 44.5890756682095. Distance: 1.2292922920211926
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0334, Accuracy: 9819/9900 (99.1818%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4321/4587 (94.2010%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4279/4587 (93.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0212, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5034/5427 (92.7584%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4869/5427 (89.7181%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1948, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4517/4748 (95.1348%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4339/4748 (91.3858%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1746, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3911/4175 (93.6766%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3788/4175 (90.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1174, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5065/5353 (94.6198%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4840/5353 (90.4166%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2900, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4083/4364 (93.5610%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3897/4364 (89.2988%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1954, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5020/5362 (93.6218%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4930/5362 (91.9433%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2414, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4347/4549 (95.5595%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3803/4549 (83.6008%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3849, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3950/4161 (94.9291%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3854/4161 (92.6220%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1537, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4810/5209 (92.3402%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4736/5209 (90.9196%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0431, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4585/4830 (94.9275%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4525/4830 (93.6853%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0388, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5075/5346 (94.9308%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5025/5346 (93.9955%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0065, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5272/5615 (93.8914%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5177/5615 (92.1995%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0417, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4758/5035 (94.4985%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4673/5035 (92.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1307, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4534/4731 (95.8360%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4403/4731 (93.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0809, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5085/5702 (89.1792%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0127, Accuracy: 4347/5702 (76.2364%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4063, Accuracy: 4812/10000 (48.1200%)
time spent on training: 244.9833915233612
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.4681, Accuracy: 6406/10000 (64.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0250, Accuracy: 9828/9900 (99.2727%)
Done in 271.65895676612854 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 97, 21, 14, 37, 95, 9, 28, 17, 73, 23, 0, 68, 19, 50, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Significant loss increase detected for 13 at epoch 180: Current loss: 0.1367, Previous loss: 0.0836, Loss jump: 0.0532, Applied weight: 0.5947
Significant loss increase detected for 13 at epoch 180: Current loss: 0.0714, Previous loss: 0.0454, Loss jump: 0.0260, Applied weight: 0.6733
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5236/5308 (98.6436%), train_poison_data_count: 415
Global model norm: 44.65302838930342.
Norm before scaling: 44.60558215049295. Distance: 1.044892041502413
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0311, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 44.65302838930342.
Norm before scaling: 44.604294533377754. Distance: 1.2066763939562006
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0208, Accuracy: 9851/9900 (99.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Significant loss increase detected for 58 at epoch 180: Current loss: 0.1788, Previous loss: 0.1181, Loss jump: 0.0607, Applied weight: 0.7355
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4999/5123 (97.5795%), train_poison_data_count: 403
Global model norm: 44.65302838930342.
Norm before scaling: 44.611086602453014. Distance: 1.182097140314367
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0627, Accuracy: 9736/9900 (98.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5394/5503 (98.0193%), train_poison_data_count: 430
Global model norm: 44.65302838930342.
Norm before scaling: 44.609134193745845. Distance: 1.2110157602924232
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0349, Accuracy: 9813/9900 (99.1212%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4381/4736 (92.5042%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4298/4736 (90.7517%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1037, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4696/5038 (93.2116%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4641/5038 (92.1199%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1208, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4050/4196 (96.5205%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4020/4196 (95.8055%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8331, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4434/4741 (93.5246%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4104/4741 (86.5640%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.8547, Accuracy: 4440/10000 (44.4000%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4588/5018 (91.4308%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4482/5018 (89.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1916, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5263/5727 (91.8980%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5006/5727 (87.4105%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2135, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4678/5122 (91.3315%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4240/5122 (82.7802%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.6998, Accuracy: 4578/10000 (45.7800%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4570/4903 (93.2082%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4384/4903 (89.4146%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1986, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4388/4605 (95.2877%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4351/4605 (94.4843%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9472, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4315/4549 (94.8560%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3858/4549 (84.8098%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.5058, Accuracy: 4789/10000 (47.8900%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5097/5454 (93.4543%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4911/5454 (90.0440%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2014, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3386/3589 (94.3438%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3264/3589 (90.9446%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0347, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4911/5361 (91.6060%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4750/5361 (88.6029%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3470, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4481/4757 (94.1980%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4355/4757 (91.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1448, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4484/4731 (94.7791%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4405/4731 (93.1093%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1739, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5704/6235 (91.4836%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5505/6235 (88.2919%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3238, Accuracy: 5052/10000 (50.5200%)
time spent on training: 257.8107178211212
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.4753, Accuracy: 6391/10000 (63.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0236, Accuracy: 9833/9900 (99.3232%)
Done in 284.55839347839355 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 89, 53, 72, 87, 21, 48, 39, 95, 70, 57, 16, 55, 17, 7, 74, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.67278494613639.
Norm before scaling: 44.629406623289036. Distance: 1.1799873324700287
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0225, Accuracy: 9842/9900 (99.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5682/5777 (98.3555%), train_poison_data_count: 455
Global model norm: 44.67278494613639.
Norm before scaling: 44.62239028608564. Distance: 1.1853104030309987
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0501, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4983/5123 (97.2672%), train_poison_data_count: 403
Global model norm: 44.67278494613639.
Norm before scaling: 44.63272156147746. Distance: 1.2613423261318522
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0663, Accuracy: 9747/9900 (98.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5389/5503 (97.9284%), train_poison_data_count: 430
Global model norm: 44.67278494613639.
Norm before scaling: 44.62851630710389. Distance: 1.2179166438889781
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0737, Accuracy: 9711/9900 (98.0909%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4421/4737 (93.3291%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4376/4737 (92.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2264, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5958/6664 (89.4058%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5687/6664 (85.3391%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3902, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4749/5193 (91.4500%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4570/5193 (88.0031%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2817, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3695/3995 (92.4906%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3592/3995 (89.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4026, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4697/5038 (93.2314%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4662/5038 (92.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0655, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4598/4830 (95.1967%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4592/4830 (95.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9765, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3924/4175 (93.9880%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3803/4175 (91.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1740, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4616/5018 (91.9888%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4491/5018 (89.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2999, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5524/5871 (94.0896%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5403/5871 (92.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0933, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4665/4956 (94.1283%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4624/4956 (93.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2130, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5077/5353 (94.8440%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4843/5353 (90.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0947, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4481/4731 (94.7157%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4419/4731 (93.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0702, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4500/4903 (91.7805%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4426/4903 (90.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1608, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4501/4869 (92.4420%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0143, Accuracy: 3583/4869 (73.5880%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.6299, Accuracy: 4622/10000 (46.2200%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4503/4797 (93.8712%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4425/4797 (92.2452%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1278, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3734/3910 (95.4987%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3245/3910 (82.9923%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4777, Accuracy: 4797/10000 (47.9700%)
time spent on training: 273.7534399032593
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.4835, Accuracy: 6381/10000 (63.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0244, Accuracy: 9830/9900 (99.2929%)
Done in 300.47046971321106 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 77, 41, 51, 7, 32, 44, 67, 5, 85, 49, 55, 64, 35, 95, 4, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5200/5308 (97.9653%), train_poison_data_count: 415
Global model norm: 44.69158362023408.
Norm before scaling: 44.646532521696884. Distance: 1.1526392670929426
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0440, Accuracy: 9778/9900 (98.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.69158362023408.
Norm before scaling: 44.64161488226961. Distance: 1.1847056589065654
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0587, Accuracy: 9740/9900 (98.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4998/5123 (97.5600%), train_poison_data_count: 403
Global model norm: 44.69158362023408.
Norm before scaling: 44.649773738753424. Distance: 1.2166540757054674
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0712, Accuracy: 9711/9900 (98.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5388/5503 (97.9102%), train_poison_data_count: 430
Global model norm: 44.69158362023408.
Norm before scaling: 44.646270042534766. Distance: 1.1854023224689612
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0370, Accuracy: 9806/9900 (99.0505%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4638/5050 (91.8416%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4563/5050 (90.3564%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0416, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4471/4714 (94.8451%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4374/4714 (92.7874%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2548, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3897/4108 (94.8637%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3747/4108 (91.2123%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1670, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4483/4869 (92.0723%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4014/4869 (82.4399%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.7360, Accuracy: 4607/10000 (46.0700%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5392/6080 (88.6842%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5267/6080 (86.6283%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3738, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4858/5075 (95.7241%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4741/5075 (93.4187%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9743, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5160/5559 (92.8225%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4915/5559 (88.4152%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1813, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4723/4993 (94.5924%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4651/4993 (93.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0166, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 6275/6947 (90.3268%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 6046/6947 (87.0304%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3159, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5160/5652 (91.2951%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5049/5652 (89.3312%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2880, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4490/4731 (94.9059%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4462/4731 (94.3141%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9309, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4503/4894 (92.0106%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4339/4894 (88.6596%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3627, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5226/5615 (93.0721%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5190/5615 (92.4310%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0456, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4651/5018 (92.6863%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4504/5018 (89.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3227, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3796/4028 (94.2403%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3747/4028 (93.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9031, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4723/5123 (92.1921%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4330/5123 (84.5208%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2198, Accuracy: 5184/10000 (51.8400%)
time spent on training: 278.6598062515259
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.4744, Accuracy: 6393/10000 (63.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0266, Accuracy: 9822/9900 (99.2121%)
Done in 305.33390951156616 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 17, 70, 42, 31, 21, 82, 84, 28, 86, 67, 5, 85, 95, 74, 38, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5211/5308 (98.1726%), train_poison_data_count: 415
Global model norm: 44.71180092102713.
Norm before scaling: 44.66554448630188. Distance: 1.1097637086534184
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0606, Accuracy: 9752/9900 (98.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5685/5777 (98.4075%), train_poison_data_count: 455
Global model norm: 44.71180092102713.
Norm before scaling: 44.66112366249729. Distance: 1.184772923840416
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0563, Accuracy: 9757/9900 (98.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 44.71180092102713.
Norm before scaling: 44.669404662370695. Distance: 1.1687062464393303
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0122, Accuracy: 9868/9900 (99.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5402/5503 (98.1646%), train_poison_data_count: 430
Global model norm: 44.71180092102713.
Norm before scaling: 44.66556088421551. Distance: 1.1604328275385025
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0376, Accuracy: 9799/9900 (98.9798%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4550/4903 (92.8003%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4532/4903 (92.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0955, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5537/5871 (94.3110%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5329/5871 (90.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1885, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5441/5907 (92.1111%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5288/5907 (89.5209%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.6472, Accuracy: 4720/10000 (47.2000%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4273/4537 (94.1812%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4233/4537 (93.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9394, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4662/5038 (92.5367%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4628/5038 (91.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0222, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5009/5298 (94.5451%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4930/5298 (93.0540%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1249, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4845/5209 (93.0121%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4737/5209 (90.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1096, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4712/5122 (91.9953%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   2,  Average loss: 0.0100, Accuracy: 4177/5122 (81.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4242, Accuracy: 4857/10000 (48.5700%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3616/3929 (92.0336%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3597/3929 (91.5500%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9464, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5141/5559 (92.4807%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4933/5559 (88.7390%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2672, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4719/4993 (94.5123%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4645/4993 (93.0302%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0095, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6375/6947 (91.7662%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 6075/6947 (87.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2163, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4607/5018 (91.8095%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4432/5018 (88.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3620, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4478/4797 (93.3500%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4424/4797 (92.2243%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9468, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5711/6235 (91.5958%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5398/6235 (86.5758%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4178, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5074/5461 (92.9134%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4885/5461 (89.4525%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.5669, Accuracy: 4982/10000 (49.8200%)
time spent on training: 279.9616470336914
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.4848, Accuracy: 6381/10000 (63.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0261, Accuracy: 9823/9900 (99.2222%)
Done in 306.8763666152954 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 87, 92, 52, 89, 22, 93, 78, 49, 39, 82, 35, 94, 38, 61, 32, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5228/5308 (98.4928%), train_poison_data_count: 415
Global model norm: 44.731979066120864.
Norm before scaling: 44.68549219702772. Distance: 1.1196795326096365
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0571, Accuracy: 9766/9900 (98.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5661/5777 (97.9920%), train_poison_data_count: 455
Global model norm: 44.731979066120864.
Norm before scaling: 44.681386163941355. Distance: 1.187132627981839
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0427, Accuracy: 9795/9900 (98.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 44.731979066120864.
Norm before scaling: 44.68916490561149. Distance: 1.1654438808747436
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0662, Accuracy: 9729/9900 (98.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 44.731979066120864.
Norm before scaling: 44.68664635329762. Distance: 1.1853095481668854
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0558, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3701/3995 (92.6408%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3607/3995 (90.2879%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2577, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6388/6812 (93.7757%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6271/6812 (92.0581%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2880, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3918/4130 (94.8668%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3871/4130 (93.7288%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9191, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4411/4737 (93.1180%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4343/4737 (91.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2919, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5309/5696 (93.2058%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5155/5696 (90.5021%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1903, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4709/5055 (93.1553%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4549/5055 (89.9901%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2546, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4178/4368 (95.6502%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4146/4368 (94.9176%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9713, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5231/5652 (92.5513%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4972/5652 (87.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2770, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3927/4175 (94.0599%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3867/4175 (92.6228%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0454, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5033/5298 (94.9981%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4905/5298 (92.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1136, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5267/5615 (93.8023%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5134/5615 (91.4337%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2803, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4843/5224 (92.7067%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4773/5224 (91.3668%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2160, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5740/6235 (92.0609%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5467/6235 (87.6824%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4242, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4205/4485 (93.7570%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3754/4485 (83.7012%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.5123, Accuracy: 4737/10000 (47.3700%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5459/6080 (89.7862%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5281/6080 (86.8586%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4400, Accuracy: 4959/10000 (49.5900%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3895/4108 (94.8150%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3773/4108 (91.8452%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0691, Accuracy: 5475/10000 (54.7500%)
time spent on training: 272.3322434425354
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.4932, Accuracy: 6387/10000 (63.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0269, Accuracy: 9827/9900 (99.2626%)
Done in 299.51730465888977 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 8, 12, 68, 28, 34, 90, 64, 6, 54, 43, 77, 76, 83, 84, 52, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5213/5308 (98.2102%), train_poison_data_count: 415
Global model norm: 44.750777424287556.
Norm before scaling: 44.704637775871475. Distance: 1.114388327013429
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0506, Accuracy: 9775/9900 (98.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5657/5777 (97.9228%), train_poison_data_count: 455
Global model norm: 44.750777424287556.
Norm before scaling: 44.70227438241747. Distance: 1.233136146908787
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0334, Accuracy: 9818/9900 (99.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4998/5123 (97.5600%), train_poison_data_count: 403
Global model norm: 44.750777424287556.
Norm before scaling: 44.70884406137881. Distance: 1.2034166651338492
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0496, Accuracy: 9762/9900 (98.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5378/5503 (97.7285%), train_poison_data_count: 430
Global model norm: 44.750777424287556.
Norm before scaling: 44.70751846201319. Distance: 1.27586087353909
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0503, Accuracy: 9761/9900 (98.5960%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4575/4889 (93.5774%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4483/4889 (91.6956%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0057, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5133/5526 (92.8882%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4912/5526 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1985, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3394/3589 (94.5667%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3327/3589 (92.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9393, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4680/5122 (91.3706%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4012/5122 (78.3288%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4167, Accuracy: 4777/10000 (47.7700%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4582/4911 (93.3008%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4558/4911 (92.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1142, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4517/4748 (95.1348%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4390/4748 (92.4600%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1690, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4541/4894 (92.7871%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4421/4894 (90.3351%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1866, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4708/4929 (95.5163%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4598/4929 (93.2846%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0259, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5188/5645 (91.9043%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4984/5645 (88.2905%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2993, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4625/4979 (92.8901%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4585/4979 (92.0868%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1672, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4647/5050 (92.0198%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4535/5050 (89.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0432, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3691/3959 (93.2306%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3641/3959 (91.9677%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9784, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3329/3552 (93.7218%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3330/3552 (93.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9672, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4826/5209 (92.6473%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4682/5209 (89.8829%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0003, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3921/4130 (94.9395%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3785/4130 (91.6465%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0357, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3877/4086 (94.8850%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3833/4086 (93.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0692, Accuracy: 5510/10000 (55.1000%)
time spent on training: 263.58088207244873
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.4986, Accuracy: 6378/10000 (63.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0260, Accuracy: 9829/9900 (99.2828%)
Done in 290.12763142585754 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 90, 6, 39, 89, 88, 7, 3, 94, 74, 66, 25, 96, 31, 98, 78, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5215/5308 (98.2479%), train_poison_data_count: 415
Global model norm: 44.767734188967644.
Norm before scaling: 44.723685087574125. Distance: 1.1586729901020147
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0243, Accuracy: 9833/9900 (99.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5678/5777 (98.2863%), train_poison_data_count: 455
Global model norm: 44.767734188967644.
Norm before scaling: 44.716059765777246. Distance: 1.1730271334262006
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0181, Accuracy: 9852/9900 (99.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5023/5123 (98.0480%), train_poison_data_count: 403
Global model norm: 44.767734188967644.
Norm before scaling: 44.721886354900384. Distance: 1.1209916124770227
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1048, Accuracy: 9611/9900 (97.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5403/5503 (98.1828%), train_poison_data_count: 430
Global model norm: 44.767734188967644.
Norm before scaling: 44.721440072390756. Distance: 1.1577053190343904
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0488, Accuracy: 9779/9900 (98.7778%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4539/4748 (95.5981%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4431/4748 (93.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0024, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4678/4929 (94.9077%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4526/4929 (91.8239%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0585, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3906/4175 (93.5569%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3876/4175 (92.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9983, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4432/4737 (93.5613%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4294/4737 (90.6481%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.6087, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5013/5362 (93.4912%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4904/5362 (91.4584%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2948, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4511/4869 (92.6474%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4021/4869 (82.5837%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.5723, Accuracy: 4908/10000 (49.0800%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5073/5346 (94.8934%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4962/5346 (92.8171%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1148, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4795/5224 (91.7879%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4795/5224 (91.7879%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0039, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4455/4797 (92.8705%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4327/4797 (90.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0803, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4544/4843 (93.8261%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4456/4843 (92.0091%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1135, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5812/6419 (90.5437%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5529/6419 (86.1349%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.5294, Accuracy: 4926/10000 (49.2600%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4754/5086 (93.4723%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4660/5086 (91.6241%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9402, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4285/4537 (94.4457%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4215/4537 (92.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8946, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3976/4161 (95.5540%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3892/4161 (93.5352%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9247, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4155/4368 (95.1236%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4115/4368 (94.2079%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9942, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4632/4911 (94.3189%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4570/4911 (93.0564%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2031, Accuracy: 5304/10000 (53.0400%)
time spent on training: 275.13793301582336
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.5129, Accuracy: 6344/10000 (63.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0255, Accuracy: 9831/9900 (99.3030%)
Done in 302.19349575042725 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 44, 82, 1, 10, 89, 11, 87, 28, 22, 78, 31, 79, 27, 46, 35, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5205/5308 (98.0595%), train_poison_data_count: 415
Global model norm: 44.78537140839071.
Norm before scaling: 44.74120461749996. Distance: 1.1788675351165914
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0378, Accuracy: 9801/9900 (99.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5684/5777 (98.3902%), train_poison_data_count: 455
Global model norm: 44.78537140839071.
Norm before scaling: 44.735164975124015. Distance: 1.196111972702416
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0553, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4985/5123 (97.3063%), train_poison_data_count: 403
Global model norm: 44.78537140839071.
Norm before scaling: 44.74359323682204. Distance: 1.2256861186022416
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0355, Accuracy: 9810/9900 (99.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5389/5503 (97.9284%), train_poison_data_count: 430
Global model norm: 44.78537140839071.
Norm before scaling: 44.740049140231314. Distance: 1.185324885341103
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0630, Accuracy: 9743/9900 (98.4141%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4818/5075 (94.9360%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4689/5075 (92.3941%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1206, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5042/5298 (95.1680%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4997/5298 (94.3186%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1909, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5182/5422 (95.5736%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5050/5422 (93.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0638, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4839/5068 (95.4815%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4587/5068 (90.5091%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2239, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4423/4737 (93.3713%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4330/4737 (91.4081%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0627, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5075/5702 (89.0039%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   2,  Average loss: 0.0112, Accuracy: 4474/5702 (78.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3447, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3721/3995 (93.1414%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3618/3995 (90.5632%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1834, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4640/5122 (90.5896%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0130, Accuracy: 3878/5122 (75.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.6433, Accuracy: 4470/10000 (44.7000%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5317/5696 (93.3462%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5188/5696 (91.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1466, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4173/4368 (95.5357%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4065/4368 (93.0632%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0478, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4286/4537 (94.4677%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4267/4537 (94.0489%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9708, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3865/4111 (94.0161%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3746/4111 (91.1214%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1408, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4286/4587 (93.4380%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4238/4587 (92.3915%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0610, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4853/5399 (89.8870%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4668/5399 (86.4605%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4698, Accuracy: 4911/10000 (49.1100%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5260/5615 (93.6776%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5144/5615 (91.6118%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1383, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4440/4714 (94.1875%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4409/4714 (93.5299%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0621, Accuracy: 5530/10000 (55.3000%)
time spent on training: 274.5559642314911
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.5147, Accuracy: 6341/10000 (63.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0256, Accuracy: 9831/9900 (99.3030%)
Done in 301.07494139671326 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 50, 45, 74, 0, 54, 55, 59, 96, 81, 75, 98, 14, 62, 25, 73, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.80355477535028.
Norm before scaling: 44.757022242761664. Distance: 1.118211823488708
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0457, Accuracy: 9777/9900 (98.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 44.80355477535028.
Norm before scaling: 44.757252707487254. Distance: 1.3209589893406137
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0476, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5014/5123 (97.8723%), train_poison_data_count: 403
Global model norm: 44.80355477535028.
Norm before scaling: 44.75998410140259. Distance: 1.1788828044200628
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0541, Accuracy: 9762/9900 (98.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 44.80355477535028.
Norm before scaling: 44.757624994152536. Distance: 1.1993493620978426
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0166, Accuracy: 9861/9900 (99.6061%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4472/4757 (94.0088%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4355/4757 (91.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2382, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5094/5489 (92.8038%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5003/5489 (91.1459%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2625, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4509/4797 (93.9962%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4437/4797 (92.4953%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0071, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5099/5454 (93.4910%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4823/5454 (88.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3431, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5154/5645 (91.3020%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4990/5645 (88.3968%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1828, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4488/4731 (94.8637%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4418/4731 (93.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9771, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4198/4397 (95.4742%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4198/4397 (95.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8430, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4774/5086 (93.8655%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4698/5086 (92.3712%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0233, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4734/5035 (94.0218%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4653/5035 (92.4131%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1433, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4440/4672 (95.0342%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4403/4672 (94.2423%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9120, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3960/4161 (95.1694%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3822/4161 (91.8529%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2986, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4055/4196 (96.6397%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4013/4196 (95.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8721, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4970/5504 (90.2980%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4781/5504 (86.8641%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.4229, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5833/6419 (90.8709%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5459/6419 (85.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3498, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4353/4605 (94.5277%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4346/4605 (94.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0478, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4541/4732 (95.9637%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4496/4732 (95.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8024, Accuracy: 5896/10000 (58.9600%)
time spent on training: 276.47828340530396
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.5088, Accuracy: 6339/10000 (63.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0247, Accuracy: 9832/9900 (99.3131%)
Done in 303.3325135707855 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 1, 41, 43, 84, 99, 94, 23, 2, 40, 82, 59, 28, 14, 56, 63, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5225/5308 (98.4363%), train_poison_data_count: 415
Global model norm: 44.81983247193702.
Norm before scaling: 44.77330322458491. Distance: 1.102551766821596
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0371, Accuracy: 9791/9900 (98.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5678/5777 (98.2863%), train_poison_data_count: 455
Global model norm: 44.81983247193702.
Norm before scaling: 44.76814728932559. Distance: 1.1620668547729314
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0317, Accuracy: 9829/9900 (99.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5005/5123 (97.6967%), train_poison_data_count: 403
Global model norm: 44.81983247193702.
Norm before scaling: 44.77597229890714. Distance: 1.1921645456006613
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0490, Accuracy: 9771/9900 (98.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5377/5503 (97.7103%), train_poison_data_count: 430
Global model norm: 44.81983247193702.
Norm before scaling: 44.775390241616684. Distance: 1.2407009899014623
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0363, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5165/5422 (95.2601%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5086/5422 (93.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9029, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4466/4714 (94.7391%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4430/4714 (93.9754%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9904, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4692/4979 (94.2358%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4583/4979 (92.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0979, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4813/5209 (92.3978%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4710/5209 (90.4204%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0425, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4456/4851 (91.8573%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4419/4851 (91.0946%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1200, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4862/5224 (93.0704%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4684/5224 (89.6631%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2124, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4304/4549 (94.6142%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3996/4549 (87.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1546, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3814/3968 (96.1190%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3764/3968 (94.8589%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.7812, Accuracy: 5964/10000 (59.6400%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5538/5939 (93.2480%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5413/5939 (91.1433%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3420, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4961/5298 (93.6391%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4952/5298 (93.4692%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9865, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4195/4397 (95.4060%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4203/4397 (95.5879%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9274, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4672/5122 (91.2144%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4065/5122 (79.3635%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.5616, Accuracy: 4561/10000 (45.6100%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4045/4196 (96.4013%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3981/4196 (94.8761%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8936, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4994/5427 (92.0214%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4842/5427 (89.2206%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3067, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3727/3910 (95.3197%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3313/3910 (84.7315%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.7273, Accuracy: 4683/10000 (46.8300%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3908/4086 (95.6437%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3887/4086 (95.1297%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0670, Accuracy: 5615/10000 (56.1500%)
time spent on training: 273.55558228492737
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.5094, Accuracy: 6339/10000 (63.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0251, Accuracy: 9835/9900 (99.3434%)
Done in 300.30623722076416 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 27, 20, 75, 69, 86, 64, 19, 23, 31, 10, 76, 80, 97, 26, 52, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5226/5308 (98.4552%), train_poison_data_count: 415
Global model norm: 44.83687746771275.
Norm before scaling: 44.788805625680624. Distance: 1.0773161466186794
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0158, Accuracy: 9856/9900 (99.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.83687746771275.
Norm before scaling: 44.78667562430329. Distance: 1.1906435166568619
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0197, Accuracy: 9856/9900 (99.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5016/5123 (97.9114%), train_poison_data_count: 403
Global model norm: 44.83687746771275.
Norm before scaling: 44.79435977853406. Distance: 1.2116201138025475
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0200, Accuracy: 9839/9900 (99.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5393/5503 (98.0011%), train_poison_data_count: 430
Global model norm: 44.83687746771275.
Norm before scaling: 44.79196705325632. Distance: 1.237155390450672
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0290, Accuracy: 9831/9900 (99.3030%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4290/4587 (93.5252%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4253/4587 (92.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9683, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4473/4714 (94.8876%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4455/4714 (94.5057%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9093, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4411/4672 (94.4135%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4355/4672 (93.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9996, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4076/4364 (93.4005%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3909/4364 (89.5738%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2848, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3671/3929 (93.4334%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3596/3929 (91.5246%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9525, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4535/4894 (92.6645%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4349/4894 (88.8639%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.4471, Accuracy: 4892/10000 (48.9200%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4949/5361 (92.3149%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4771/5361 (88.9946%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1845, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4327/4549 (95.1198%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3805/4549 (83.6448%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.4440, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4259/4537 (93.8726%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4201/4537 (92.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8630, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4846/5068 (95.6196%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4746/5068 (93.6464%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0892, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3635/3959 (91.8161%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3565/3959 (90.0480%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1302, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5088/5461 (93.1697%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4989/5461 (91.3569%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3551, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4403/4736 (92.9688%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4315/4736 (91.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9990, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3872/4086 (94.7626%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3834/4086 (93.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0977, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3885/4130 (94.0678%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3858/4130 (93.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9430, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4181/4368 (95.7189%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4149/4368 (94.9863%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8485, Accuracy: 5873/10000 (58.7300%)
time spent on training: 264.71550726890564
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.5163, Accuracy: 6313/10000 (63.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0229, Accuracy: 9841/9900 (99.4040%)
Done in 291.5089325904846 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 46, 98, 55, 51, 80, 4, 97, 11, 35, 61, 86, 6, 83, 73, 84, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.85337168120001.
Norm before scaling: 44.807543364737285. Distance: 1.1453530547701922
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0278, Accuracy: 9833/9900 (99.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5675/5777 (98.2344%), train_poison_data_count: 455
Global model norm: 44.85337168120001.
Norm before scaling: 44.80313518997931. Distance: 1.202162121990045
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0373, Accuracy: 9806/9900 (99.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5011/5123 (97.8138%), train_poison_data_count: 403
Global model norm: 44.85337168120001.
Norm before scaling: 44.80944217905906. Distance: 1.1683581159324072
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0572, Accuracy: 9743/9900 (98.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5415/5503 (98.4009%), train_poison_data_count: 430
Global model norm: 44.85337168120001.
Norm before scaling: 44.80517722596352. Distance: 1.1241470388268873
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0556, Accuracy: 9750/9900 (98.4848%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4919/5399 (91.1095%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4725/5399 (87.5162%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3069, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3952/4161 (94.9772%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3881/4161 (93.2708%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0718, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4507/4731 (95.2653%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4425/4731 (93.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0080, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3905/4108 (95.0584%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3838/4108 (93.4275%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9626, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5053/5461 (92.5288%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4927/5461 (90.2216%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2816, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3803/4028 (94.4141%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3759/4028 (93.3217%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9710, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4406/4736 (93.0321%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4345/4736 (91.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9061, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5096/5702 (89.3722%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   2,  Average loss: 0.0109, Accuracy: 4520/5702 (79.2704%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3388, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5253/5615 (93.5530%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5106/5615 (90.9350%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3463, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4202/4485 (93.6901%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4110/4485 (91.6388%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1978, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3638/3929 (92.5935%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3563/3929 (90.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0775, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4710/4929 (95.5569%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4590/4929 (93.1223%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1326, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3320/3552 (93.4685%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3347/3552 (94.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8306, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4411/4605 (95.7872%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4362/4605 (94.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8616, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4860/5209 (93.3001%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4701/5209 (90.2476%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0345, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4491/4869 (92.2366%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3930/4869 (80.7147%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.5136, Accuracy: 4740/10000 (47.4000%)
time spent on training: 265.72956228256226
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.5236, Accuracy: 6312/10000 (63.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0224, Accuracy: 9840/9900 (99.3939%)
Done in 292.8397026062012 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 14, 5, 1, 61, 91, 75, 59, 44, 12, 38, 53, 74, 20, 89, 0, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5237/5308 (98.6624%), train_poison_data_count: 415
Global model norm: 44.8699836158595.
Norm before scaling: 44.824579417121974. Distance: 1.1446350363066111
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0382, Accuracy: 9801/9900 (99.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5686/5777 (98.4248%), train_poison_data_count: 455
Global model norm: 44.8699836158595.
Norm before scaling: 44.817618148272615. Distance: 1.1829307386191277
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0076, Accuracy: 9880/9900 (99.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5015/5123 (97.8919%), train_poison_data_count: 403
Global model norm: 44.8699836158595.
Norm before scaling: 44.826826074768. Distance: 1.2212492430732436
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0539, Accuracy: 9762/9900 (98.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5401/5503 (98.1465%), train_poison_data_count: 430
Global model norm: 44.8699836158595.
Norm before scaling: 44.82308975293872. Distance: 1.17636818668045
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0249, Accuracy: 9844/9900 (99.4343%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3996/4196 (95.2336%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3929/4196 (93.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8840, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4726/4993 (94.6525%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4605/4993 (92.2291%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2215, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5195/5422 (95.8134%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5033/5422 (92.8255%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0234, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4201/4485 (93.6678%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3748/4485 (83.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2595, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4178/4527 (92.2907%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4074/4527 (89.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1286, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4421/4672 (94.6276%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4362/4672 (93.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8719, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4221/4397 (95.9973%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4195/4397 (95.4060%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.7855, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4811/5075 (94.7980%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4683/5075 (92.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9692, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5134/5526 (92.9063%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4899/5526 (88.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2907, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5673/6235 (90.9864%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5440/6235 (87.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2850, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6049/6664 (90.7713%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   2,  Average loss: 0.0086, Accuracy: 5552/6664 (83.3133%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2942, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4480/4797 (93.3917%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4348/4797 (90.6400%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3887, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4539/4714 (96.2877%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4483/4714 (95.0997%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8738, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4450/4737 (93.9413%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4357/4737 (91.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1748, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5078/5454 (93.1060%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4939/5454 (90.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2328, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4521/4869 (92.8527%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4184/4869 (85.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3517, Accuracy: 5058/10000 (50.5800%)
time spent on training: 276.53820180892944
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.5515, Accuracy: 6269/10000 (62.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0206, Accuracy: 9849/9900 (99.4848%)
Done in 303.48796343803406 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 17, 26, 15, 18, 38, 29, 82, 21, 84, 80, 85, 11, 12, 88, 89, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5205/5308 (98.0595%), train_poison_data_count: 415
Global model norm: 44.888157182863246.
Norm before scaling: 44.841668886814276. Distance: 1.1439239661485283
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0672, Accuracy: 9714/9900 (98.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.888157182863246.
Norm before scaling: 44.83725453828825. Distance: 1.2178895309162407
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0381, Accuracy: 9812/9900 (99.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5022/5123 (98.0285%), train_poison_data_count: 403
Global model norm: 44.888157182863246.
Norm before scaling: 44.8427999681596. Distance: 1.1385390660616022
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0327, Accuracy: 9813/9900 (99.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5399/5503 (98.1101%), train_poison_data_count: 430
Global model norm: 44.888157182863246.
Norm before scaling: 44.84146607859878. Distance: 1.1938797086379807
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0319, Accuracy: 9818/9900 (99.1717%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4507/4903 (91.9233%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4484/4903 (91.4542%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1621, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3926/4086 (96.0842%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3907/4086 (95.6192%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9029, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5643/6068 (92.9960%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5567/6068 (91.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2993, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4015/4249 (94.4928%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3969/4249 (93.4102%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9146, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5709/6235 (91.5638%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5522/6235 (88.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.4396, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4444/4732 (93.9138%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4445/4732 (93.9349%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8914, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5043/5298 (95.1869%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4956/5298 (93.5447%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9819, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4690/5038 (93.0925%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4611/5038 (91.5244%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0010, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4867/5209 (93.4344%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4709/5209 (90.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0503, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5128/5461 (93.9022%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4994/5461 (91.4485%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3299, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6338/6947 (91.2336%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   2,  Average loss: 0.0071, Accuracy: 6001/6947 (86.3826%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2130, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5132/5702 (90.0035%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   2,  Average loss: 0.0122, Accuracy: 4407/5702 (77.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.5565, Accuracy: 4766/10000 (47.6600%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5101/5526 (92.3091%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4876/5526 (88.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2266, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4993/5362 (93.1182%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4853/5362 (90.5073%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1387, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4355/4737 (91.9358%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4309/4737 (90.9647%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3800, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5269/5727 (92.0028%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5067/5727 (88.4756%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1604, Accuracy: 5340/10000 (53.4000%)
time spent on training: 283.41926407814026
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.5611, Accuracy: 6261/10000 (62.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0193, Accuracy: 9853/9900 (99.5253%)
Done in 310.2107193470001 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 7, 34, 31, 64, 77, 29, 99, 0, 33, 46, 72, 22, 88, 80, 11, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5230/5308 (98.5305%), train_poison_data_count: 415
Global model norm: 44.907584683540655.
Norm before scaling: 44.8596620832855. Distance: 1.0693145889171745
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0667, Accuracy: 9726/9900 (98.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5683/5777 (98.3729%), train_poison_data_count: 455
Global model norm: 44.907584683540655.
Norm before scaling: 44.85574616330875. Distance: 1.1555902815658703
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0453, Accuracy: 9781/9900 (98.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4970/5123 (97.0135%), train_poison_data_count: 403
Global model norm: 44.907584683540655.
Norm before scaling: 44.86740039454105. Distance: 1.2793888903424278
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1600, Accuracy: 9459/9900 (95.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5391/5503 (97.9647%), train_poison_data_count: 430
Global model norm: 44.907584683540655.
Norm before scaling: 44.86030563297998. Distance: 1.190830479309919
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0173, Accuracy: 9861/9900 (99.6061%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4550/4869 (93.4483%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4313/4869 (88.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3687, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4593/4911 (93.5247%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4543/4911 (92.5066%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0835, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4285/4537 (94.4457%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4246/4537 (93.5861%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9519, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4522/4894 (92.3989%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4351/4894 (88.9048%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4259, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4662/5050 (92.3168%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4551/5050 (90.1188%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1980, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4510/4732 (95.3085%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4500/4732 (95.0972%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8404, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4532/4851 (93.4240%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4476/4851 (92.2696%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9035, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5104/5454 (93.5827%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4909/5454 (90.0073%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2858, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4534/4818 (94.1054%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4382/4818 (90.9506%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1067, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4935/5399 (91.4058%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4713/5399 (87.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3494, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4813/5193 (92.6825%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4568/5193 (87.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4184, Accuracy: 4908/10000 (49.0800%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5398/5696 (94.7683%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5232/5696 (91.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1311, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5018/5362 (93.5845%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4915/5362 (91.6636%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1163, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5135/5461 (94.0304%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4996/5461 (91.4851%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1806, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5036/5702 (88.3199%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4724/5702 (82.8481%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4912, Accuracy: 4818/10000 (48.1800%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4612/4830 (95.4865%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4510/4830 (93.3747%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1329, Accuracy: 5539/10000 (55.3900%)
time spent on training: 277.14563727378845
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.5845, Accuracy: 6213/10000 (62.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0205, Accuracy: 9847/9900 (99.4646%)
Done in 304.37333846092224 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 31, 7, 49, 8, 57, 89, 19, 42, 51, 98, 15, 35, 76, 48, 75, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5234/5308 (98.6059%), train_poison_data_count: 415
Global model norm: 44.92673886711982.
Norm before scaling: 44.87693268165798. Distance: 1.0634030823766758
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0358, Accuracy: 9811/9900 (99.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5667/5777 (98.0959%), train_poison_data_count: 455
Global model norm: 44.92673886711982.
Norm before scaling: 44.87349160722216. Distance: 1.1837497016721066
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0105, Accuracy: 9872/9900 (99.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4998/5123 (97.5600%), train_poison_data_count: 403
Global model norm: 44.92673886711982.
Norm before scaling: 44.88226650559982. Distance: 1.17611877058003
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0251, Accuracy: 9830/9900 (99.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5407/5503 (98.2555%), train_poison_data_count: 430
Global model norm: 44.92673886711982.
Norm before scaling: 44.877933671951325. Distance: 1.161304047376957
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0625, Accuracy: 9731/9900 (98.2929%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4297/4537 (94.7102%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4241/4537 (93.4759%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9548, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4543/4869 (93.3046%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   2,  Average loss: 0.0098, Accuracy: 3948/4869 (81.0844%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.5577, Accuracy: 4777/10000 (47.7700%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5166/5652 (91.4013%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5051/5652 (89.3666%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3945, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4565/4889 (93.3729%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4529/4889 (92.6365%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0472, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4651/4956 (93.8458%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4554/4956 (91.8886%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1655, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4384/4737 (92.5480%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4360/4737 (92.0414%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2820, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4962/5361 (92.5574%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4794/5361 (89.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2765, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5442/5907 (92.1280%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5283/5907 (89.4363%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.4908, Accuracy: 4875/10000 (48.7500%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3893/4108 (94.7663%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3828/4108 (93.1840%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0339, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3925/4161 (94.3283%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3838/4161 (92.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0141, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5683/6068 (93.6552%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5548/6068 (91.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3884, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5245/5615 (93.4105%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5128/5615 (91.3268%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2381, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3639/3959 (91.9172%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3607/3959 (91.1089%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0001, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4609/4830 (95.4244%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4578/4830 (94.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9252, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4444/4672 (95.1199%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4392/4672 (94.0068%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0143, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5170/5559 (93.0023%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4861/5559 (87.4438%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1498, Accuracy: 5283/10000 (52.8300%)
time spent on training: 276.0144455432892
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.6027, Accuracy: 6196/10000 (61.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0177, Accuracy: 9855/9900 (99.5455%)
Done in 303.1468572616577 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 21, 78, 19, 42, 25, 70, 73, 31, 96, 99, 88, 18, 0, 54, 32, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.944617884211816.
Norm before scaling: 44.89561868544009. Distance: 1.081023039177945
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0352, Accuracy: 9810/9900 (99.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5699/5777 (98.6498%), train_poison_data_count: 455
Global model norm: 44.944617884211816.
Norm before scaling: 44.89134152534665. Distance: 1.1357998624214134
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0162, Accuracy: 9863/9900 (99.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4988/5123 (97.3648%), train_poison_data_count: 403
Global model norm: 44.944617884211816.
Norm before scaling: 44.90175772372043. Distance: 1.223444529156327
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1090, Accuracy: 9613/9900 (97.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5408/5503 (98.2737%), train_poison_data_count: 430
Global model norm: 44.944617884211816.
Norm before scaling: 44.896017014318765. Distance: 1.1600497932270464
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0401, Accuracy: 9799/9900 (98.9798%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4696/5038 (93.2116%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4669/5038 (92.6757%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9128, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4201/4368 (96.1767%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4162/4368 (95.2839%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9235, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4905/5361 (91.4941%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4817/5361 (89.8526%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1496, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5520/5907 (93.4485%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5372/5907 (90.9429%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4475, Accuracy: 4932/10000 (49.3200%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5860/6419 (91.2915%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5655/6419 (88.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3955, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5512/5871 (93.8852%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5443/5871 (92.7099%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1452, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4417/4605 (95.9175%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4362/4605 (94.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0015, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4308/4537 (94.9526%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4307/4537 (94.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9812, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4769/5086 (93.7672%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4686/5086 (92.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0317, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4545/4851 (93.6920%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4478/4851 (92.3109%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0940, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5033/5362 (93.8642%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4890/5362 (91.1973%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1614, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4031/4249 (94.8694%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3877/4249 (91.2450%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1494, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5078/5454 (93.1060%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4821/5454 (88.3938%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2940, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5200/5645 (92.1169%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4957/5645 (87.8122%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2568, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5503/6080 (90.5099%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5323/6080 (87.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3417, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5096/5489 (92.8402%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5020/5489 (91.4556%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2042, Accuracy: 5250/10000 (52.5000%)
time spent on training: 281.03570795059204
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.5936, Accuracy: 6207/10000 (62.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0170, Accuracy: 9858/9900 (99.5758%)
Done in 307.6933352947235 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 84, 48, 20, 55, 59, 40, 92, 0, 16, 85, 82, 90, 52, 6, 15, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5222/5308 (98.3798%), train_poison_data_count: 415
Global model norm: 44.963081644138896.
Norm before scaling: 44.91444231988471. Distance: 1.0870197858229205
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0339, Accuracy: 9815/9900 (99.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5672/5777 (98.1824%), train_poison_data_count: 455
Global model norm: 44.963081644138896.
Norm before scaling: 44.91070105593919. Distance: 1.1823207946863878
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0244, Accuracy: 9834/9900 (99.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5014/5123 (97.8723%), train_poison_data_count: 403
Global model norm: 44.963081644138896.
Norm before scaling: 44.91751201638608. Distance: 1.1500181362546418
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0597, Accuracy: 9735/9900 (98.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5395/5503 (98.0374%), train_poison_data_count: 430
Global model norm: 44.963081644138896.
Norm before scaling: 44.91499132040994. Distance: 1.170560531918445
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0519, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4872/5209 (93.5304%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4723/5209 (90.6700%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2501, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4621/4830 (95.6729%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4525/4830 (93.6853%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0896, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4515/4714 (95.7785%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4482/4714 (95.0785%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9550, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4515/4731 (95.4344%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4439/4731 (93.8279%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9911, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4237/4397 (96.3612%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4199/4397 (95.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8971, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5595/5939 (94.2078%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5447/5939 (91.7158%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2039, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   1,  Average loss: 0.0028, Accuracy: 6450/6812 (94.6858%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6202/6812 (91.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3492, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5048/5454 (92.5559%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4869/5454 (89.2739%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1384, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5034/5353 (94.0407%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4839/5353 (90.3979%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1995, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6324/6947 (91.0321%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6079/6947 (87.5054%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3212, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5057/5298 (95.4511%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4988/5298 (94.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0089, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4542/4748 (95.6613%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4348/4748 (91.5754%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1466, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3922/4130 (94.9637%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3848/4130 (93.1719%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0619, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4692/4929 (95.1917%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4557/4929 (92.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1301, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5667/6068 (93.3916%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5615/6068 (92.5346%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2827, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4429/4736 (93.5177%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4318/4736 (91.1740%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0382, Accuracy: 5598/10000 (55.9800%)
time spent on training: 278.965603351593
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.6151, Accuracy: 6172/10000 (61.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0177, Accuracy: 9856/9900 (99.5556%)
Done in 305.9750905036926 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 57, 62, 61, 67, 3, 82, 69, 93, 42, 76, 7, 94, 14, 21, 32, 25].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5236/5308 (98.6436%), train_poison_data_count: 415
Global model norm: 44.980459081903.
Norm before scaling: 44.93108329535078. Distance: 1.0580834992455617
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0575, Accuracy: 9750/9900 (98.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 44.980459081903.
Norm before scaling: 44.93140523907318. Distance: 1.299792489582838
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0074, Accuracy: 9879/9900 (99.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 44.980459081903.
Norm before scaling: 44.93650305309287. Distance: 1.190839388711606
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0813, Accuracy: 9688/9900 (97.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5417/5503 (98.4372%), train_poison_data_count: 430
Global model norm: 44.980459081903.
Norm before scaling: 44.93288859553837. Distance: 1.1613101037837692
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0308, Accuracy: 9820/9900 (99.1919%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4692/4956 (94.6731%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4515/4956 (91.1017%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1561, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4999/5504 (90.8249%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4795/5504 (87.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4409, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4154/4485 (92.6198%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3847/4485 (85.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3111, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5140/5559 (92.4627%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4924/5559 (88.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3692, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5053/5346 (94.5193%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5027/5346 (94.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1941, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5031/5298 (94.9604%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4914/5298 (92.7520%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0685, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4120/4364 (94.4088%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3925/4364 (89.9404%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3438, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4699/5055 (92.9575%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4600/5055 (90.9990%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1698, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5472/5907 (92.6359%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5275/5907 (89.3008%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4667, Accuracy: 4920/10000 (49.2000%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3650/3959 (92.1950%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3632/3959 (91.7403%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9339, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4542/4869 (93.2840%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4173/4869 (85.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3276, Accuracy: 5001/10000 (50.0100%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4866/5224 (93.1470%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4790/5224 (91.6922%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2538, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4059/4196 (96.7350%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4001/4196 (95.3527%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9057, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4719/5038 (93.6681%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4629/5038 (91.8817%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1038, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5446/6080 (89.5724%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5348/6080 (87.9605%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3966, Accuracy: 4842/10000 (48.4200%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5820/6419 (90.6683%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5510/6419 (85.8389%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2360, Accuracy: 5164/10000 (51.6400%)
time spent on training: 275.90880966186523
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.6174, Accuracy: 6158/10000 (61.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0179, Accuracy: 9854/9900 (99.5354%)
Done in 302.65350890159607 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 19, 16, 82, 89, 45, 31, 91, 9, 44, 66, 11, 76, 92, 37, 54, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5239/5308 (98.7001%), train_poison_data_count: 415
Global model norm: 45.00013970247412.
Norm before scaling: 44.951331374975005. Distance: 1.0604648734016657
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0566, Accuracy: 9755/9900 (98.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5687/5777 (98.4421%), train_poison_data_count: 455
Global model norm: 45.00013970247412.
Norm before scaling: 44.946003031154646. Distance: 1.1540465107607334
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0358, Accuracy: 9806/9900 (99.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5018/5123 (97.9504%), train_poison_data_count: 403
Global model norm: 45.00013970247412.
Norm before scaling: 44.95476241804087. Distance: 1.1536523145690218
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0274, Accuracy: 9823/9900 (99.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5411/5503 (98.3282%), train_poison_data_count: 430
Global model norm: 45.00013970247412.
Norm before scaling: 44.95049767478596. Distance: 1.1277066096874018
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0848, Accuracy: 9672/9900 (97.6970%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4983/5361 (92.9491%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4770/5361 (88.9759%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2633, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5055/5353 (94.4330%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4825/5353 (90.1364%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1374, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5064/5298 (95.5832%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4984/5298 (94.0732%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0875, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4441/4737 (93.7513%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4344/4737 (91.7036%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2081, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5061/5489 (92.2026%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4971/5489 (90.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3216, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4323/4537 (95.2832%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4248/4537 (93.6302%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9690, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4163/4527 (91.9594%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4030/4527 (89.0214%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0313, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5285/5727 (92.2822%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5126/5727 (89.5058%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1082, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4785/5075 (94.2857%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4645/5075 (91.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9995, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4587/4843 (94.7140%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4457/4843 (92.0297%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1830, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5054/5702 (88.6356%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4571/5702 (80.1649%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.6856, Accuracy: 4637/10000 (46.3700%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3680/3959 (92.9528%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3649/3959 (92.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0242, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6418/6812 (94.2161%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6215/6812 (91.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1393, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4379/4741 (92.3645%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3910/4741 (82.4721%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.7537, Accuracy: 4668/10000 (46.6800%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5111/5645 (90.5403%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5010/5645 (88.7511%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2193, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3733/3910 (95.4731%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3489/3910 (89.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3083, Accuracy: 5232/10000 (52.3200%)
time spent on training: 276.68123507499695
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.6247, Accuracy: 6158/10000 (61.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0187, Accuracy: 9850/9900 (99.4949%)
Done in 303.15823245048523 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 42, 74, 66, 6, 50, 49, 10, 11, 1, 96, 61, 52, 79, 72, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Significant loss increase detected for 13 at epoch 200: Current loss: 0.0994, Previous loss: 0.0574, Loss jump: 0.0420, Applied weight: 0.4639
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5225/5308 (98.4363%), train_poison_data_count: 415
Global model norm: 45.020124894404866.
Norm before scaling: 44.9710898887413. Distance: 1.0998271502892196
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0249, Accuracy: 9846/9900 (99.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Significant loss increase detected for 36 at epoch 200: Current loss: 0.1276, Previous loss: 0.0612, Loss jump: 0.0664, Applied weight: -0.1786
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5678/5777 (98.2863%), train_poison_data_count: 455
Global model norm: 45.020124894404866.
Norm before scaling: 44.9666610985468. Distance: 1.1593143478116412
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1169, Accuracy: 9606/9900 (97.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5026/5123 (98.1066%), train_poison_data_count: 403
Global model norm: 45.020124894404866.
Norm before scaling: 44.97386258072223. Distance: 1.1179138703275142
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2492, Accuracy: 9221/9900 (93.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5395/5503 (98.0374%), train_poison_data_count: 430
Global model norm: 45.020124894404866.
Norm before scaling: 44.97260179386306. Distance: 1.1775893190042053
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0364, Accuracy: 9812/9900 (99.1111%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5480/5907 (92.7713%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5351/5907 (90.5874%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2871, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4482/4797 (93.4334%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4440/4797 (92.5578%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0319, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4552/4843 (93.9913%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4503/4843 (92.9796%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0325, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4677/4929 (94.8874%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4546/4929 (92.2297%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1947, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4491/4757 (94.4082%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4330/4757 (91.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1361, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5174/5652 (91.5428%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4995/5652 (88.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3492, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4835/5068 (95.4025%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4669/5068 (92.1271%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3635, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5095/5702 (89.3546%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4603/5702 (80.7261%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4026, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5210/5422 (96.0900%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   2,  Average loss: 0.0029, Accuracy: 5139/5422 (94.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7953, Accuracy: 5917/10000 (59.1700%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4783/5086 (94.0425%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4669/5086 (91.8010%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0619, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4214/4485 (93.9576%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3975/4485 (88.6288%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1232, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3952/4130 (95.6901%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3844/4130 (93.0751%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9805, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3865/4111 (94.0161%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3683/4111 (89.5889%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3213, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4870/5193 (93.7801%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4603/5193 (88.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3834, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4455/4731 (94.1661%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4404/4731 (93.0881%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2507, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5749/6235 (92.2053%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5445/6235 (87.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.5269, Accuracy: 4730/10000 (47.3000%)
time spent on training: 275.87000346183777
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6085, Accuracy: 6167/10000 (61.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0223, Accuracy: 9837/9900 (99.3636%)
Done in 302.67691826820374 sec.
Saving all the graphs.
This run has a label: Oct.03_18.58.18. Visdom environment: cifar100_CerP
