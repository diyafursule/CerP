current path: saved_models/model_cifar100_Dec.07_14.57.18_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4310/4885 (88.2293%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43996218925036. Distance: 2.294601145307424
Total norm for 4 adversaries is: 42.43996218925036. distance: 2.294601145307424
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4293, Accuracy: 8863/9900 (89.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43528937311124. Distance: 2.251403053244887
Total norm for 4 adversaries is: 42.43528937311124. distance: 2.251403053244887
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7372, Accuracy: 8283/9900 (83.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438660640884834. Distance: 2.175776757281885
Total norm for 4 adversaries is: 42.438660640884834. distance: 2.175776757281885
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4307, Accuracy: 8880/9900 (89.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4454/5066 (87.9195%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.440423833832206. Distance: 2.3049032853827645
Total norm for 4 adversaries is: 42.440423833832206. distance: 2.3049032853827645
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6270, Accuracy: 8460/9900 (85.4545%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3841/4356 (88.1772%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3690/4356 (84.7107%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3792, Accuracy: 4725/10000 (47.2500%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3939/4465 (88.2195%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4088/4465 (91.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0124, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4041/4647 (86.9593%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4156/4647 (89.4340%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9377, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4447/5055 (87.9723%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4540/5055 (89.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0936, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4437/5116 (86.7279%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4446/5116 (86.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0271, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3634/4126 (88.0756%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3750/4126 (90.8871%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9996, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3081/3472 (88.7385%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3215/3472 (92.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0667, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4437/4986 (88.9892%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4445/4986 (89.1496%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0906, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3542/4013 (88.2631%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3679/4013 (91.6770%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8058, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4026/4618 (87.1806%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4106/4618 (88.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0998, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4432/5083 (87.1926%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4440/5083 (87.3500%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0922, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3966/4511 (87.9184%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4037/4511 (89.4924%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1103, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3329/3797 (87.6745%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3389/3797 (89.2547%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9187, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4993/5582 (89.4482%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5052/5582 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1635, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3152/3616 (87.1681%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3202/3616 (88.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0731, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4826/5455 (88.4693%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4855/5455 (89.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0031, Accuracy: 5273/10000 (52.7300%)
time spent on training: 257.66282629966736
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1053, Accuracy: 7059/10000 (70.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0724, Accuracy: 116/9900 (1.1717%)
Done in 284.8298602104187 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 42.454775455587736.
Norm before scaling: 42.46086203420157. Distance: 2.112289675563565
Total norm for 4 adversaries is: 42.46086203420157. distance: 2.112289675563565
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2582, Accuracy: 9225/9900 (93.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.454775455587736.
Norm before scaling: 42.45817392685565. Distance: 2.166705118962957
Total norm for 4 adversaries is: 42.45817392685565. distance: 2.166705118962957
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5534, Accuracy: 8560/9900 (86.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4185/4717 (88.7216%), train_poison_data_count: 370
Global model norm: 42.454775455587736.
Norm before scaling: 42.46194010430841. Distance: 2.1616244577812935
Total norm for 4 adversaries is: 42.46194010430841. distance: 2.1616244577812935
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2260, Accuracy: 9357/9900 (94.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 42.454775455587736.
Norm before scaling: 42.46477314207404. Distance: 2.290328264987656
Total norm for 4 adversaries is: 42.46477314207404. distance: 2.290328264987656
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2636, Accuracy: 9184/9900 (92.7677%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3588/4025 (89.1429%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3707/4025 (92.0994%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9508, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3346/3797 (88.1222%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3412/3797 (89.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0367, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3942/4625 (85.2324%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4009/4625 (86.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1047, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3853/4481 (85.9853%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3890/4481 (86.8110%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1705, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3857/4315 (89.3859%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3983/4315 (92.3059%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0114, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3716/4235 (87.7450%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3826/4235 (90.3424%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9542, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3374/3828 (88.1400%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3487/3828 (91.0920%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9246, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3821/4416 (86.5263%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3981/4416 (90.1495%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8865, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3154/3638 (86.6960%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3285/3638 (90.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9417, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4554/5265 (86.4957%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4539/5265 (86.2108%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9896, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3352/3781 (88.6538%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3334/3781 (88.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2539, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3990/4441 (89.8446%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4010/4441 (90.2950%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1234, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3982/4433 (89.8263%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4026/4433 (90.8189%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9661, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4435/5083 (87.2516%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4427/5083 (87.0942%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0802, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4326/4928 (87.7841%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4411/4928 (89.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9656, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4179/4793 (87.1897%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4375/4793 (91.2789%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1078, Accuracy: 5327/10000 (53.2700%)
time spent on training: 255.32777190208435
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0962, Accuracy: 7061/10000 (70.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.0369, Accuracy: 233/9900 (2.3535%)
Done in 282.5204939842224 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 42.47723856253414.
Norm before scaling: 42.477922517081595. Distance: 2.0174300517042187
Total norm for 4 adversaries is: 42.477922517081595. distance: 2.0174300517042187
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2395, Accuracy: 9251/9900 (93.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.47723856253414.
Norm before scaling: 42.478514502462744. Distance: 2.094940530301633
Total norm for 4 adversaries is: 42.478514502462744. distance: 2.094940530301633
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0908, Accuracy: 9656/9900 (97.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 42.47723856253414.
Norm before scaling: 42.47874583431401. Distance: 1.9850418892579482
Total norm for 4 adversaries is: 42.47874583431401. distance: 1.9850418892579482
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2230, Accuracy: 9330/9900 (94.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.47723856253414.
Norm before scaling: 42.483528805015276. Distance: 2.1631039035300734
Total norm for 4 adversaries is: 42.483528805015276. distance: 2.1631039035300734
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1585, Accuracy: 9495/9900 (95.9091%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3146/3616 (87.0022%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3297/3616 (91.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8349, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3411/3837 (88.8976%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3499/3837 (91.1910%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8765, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4175/4679 (89.2285%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4279/4679 (91.4512%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1042, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3102/3638 (85.2666%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3265/3638 (89.7471%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0812, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3640/4046 (89.9654%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3649/4046 (90.1878%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9482, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3989/4518 (88.2913%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4086/4518 (90.4382%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2402, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3388/3797 (89.2283%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3403/3797 (89.6234%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0945, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4426/5025 (88.0796%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4431/5025 (88.1791%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3175, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3919/4362 (89.8441%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3962/4362 (90.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9994, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4005/4558 (87.8675%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4013/4558 (88.0430%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2589, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3210/3672 (87.4183%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3277/3672 (89.2429%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0577, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4326/4874 (88.7567%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4354/4874 (89.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2419, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3619/4025 (89.9130%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3707/4025 (92.0994%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9575, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4078/4663 (87.4544%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4259/4663 (91.3360%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0570, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3460/3911 (88.4684%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3455/3911 (88.3406%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0225, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4445/5017 (88.5988%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4567/5017 (91.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8111, Accuracy: 5755/10000 (57.5500%)
time spent on training: 252.90261602401733
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0914, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.0522, Accuracy: 431/9900 (4.3535%)
Done in 280.46691274642944 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 42.497614535535256.
Norm before scaling: 42.4998262289646. Distance: 1.970237351753403
Total norm for 4 adversaries is: 42.4998262289646. distance: 1.970237351753403
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5262, Accuracy: 8704/9900 (87.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4830/5305 (91.0462%), train_poison_data_count: 415
Global model norm: 42.497614535535256.
Norm before scaling: 42.49557651612106. Distance: 2.016506032089568
Total norm for 4 adversaries is: 42.49557651612106. distance: 2.016506032089568
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0791, Accuracy: 9672/9900 (97.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 42.497614535535256.
Norm before scaling: 42.499006192424666. Distance: 1.9552950591043692
Total norm for 4 adversaries is: 42.499006192424666. distance: 1.9552950591043692
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1433, Accuracy: 9523/9900 (96.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 42.497614535535256.
Norm before scaling: 42.50341065128995. Distance: 2.119124198885071
Total norm for 4 adversaries is: 42.50341065128995. distance: 2.119124198885071
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3394, Accuracy: 9047/9900 (91.3838%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5268/6124 (86.0222%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5337/6124 (87.1489%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1038, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3873/4356 (88.9118%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3634/4356 (83.4252%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3921, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3544/4158 (85.2333%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3592/4158 (86.3877%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1253, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4891/5455 (89.6609%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4906/5455 (89.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9257, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3927/4511 (87.0539%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4062/4511 (90.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9761, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4534/5232 (86.6590%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4564/5232 (87.2324%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0762, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4484/5244 (85.5072%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4563/5244 (87.0137%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0364, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4382/4918 (89.1013%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4406/4918 (89.5893%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0364, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3613/4126 (87.5667%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3710/4126 (89.9176%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8336, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4356/4928 (88.3929%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4377/4928 (88.8190%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1652, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3740/4223 (88.5626%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3835/4223 (90.8122%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8971, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4519/5195 (86.9875%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4597/5195 (88.4889%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1647, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4149/4679 (88.6728%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4120/4679 (88.0530%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0369, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3198/3646 (87.7126%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3279/3646 (89.9342%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9456, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3206/3616 (88.6615%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3208/3616 (88.7168%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8994, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4073/4716 (86.3656%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4096/4716 (86.8533%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9754, Accuracy: 5434/10000 (54.3400%)
time spent on training: 261.1144366264343
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0874, Accuracy: 7061/10000 (70.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.3890, Accuracy: 712/9900 (7.1919%)
Done in 288.4319531917572 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 42.52259997682482.
Norm before scaling: 42.525482078120675. Distance: 1.9582076810201277
Total norm for 4 adversaries is: 42.525482078120675. distance: 1.9582076810201277
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1697, Accuracy: 9489/9900 (95.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4870/5305 (91.8002%), train_poison_data_count: 415
Global model norm: 42.52259997682482.
Norm before scaling: 42.51755582945635. Distance: 1.9811686044814396
Total norm for 4 adversaries is: 42.51755582945635. distance: 1.9811686044814396
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1455, Accuracy: 9534/9900 (96.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 42.52259997682482.
Norm before scaling: 42.52334779179404. Distance: 1.9205268535370341
Total norm for 4 adversaries is: 42.52334779179404. distance: 1.9205268535370341
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1973, Accuracy: 9385/9900 (94.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 42.52259997682482.
Norm before scaling: 42.5299139324495. Distance: 2.079397399983492
Total norm for 4 adversaries is: 42.5299139324495. distance: 2.079397399983492
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2814, Accuracy: 9206/9900 (92.9899%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5275/6124 (86.1365%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5305/6124 (86.6264%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0236, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3964/4433 (89.4203%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4052/4433 (91.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9789, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3378/3781 (89.3414%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3214/3781 (85.0040%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3845, Accuracy: 4842/10000 (48.4200%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3574/3969 (90.0479%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3575/3969 (90.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9508, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4472/5025 (88.9950%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4519/5025 (89.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1571, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4184/4679 (89.4208%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4236/4679 (90.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1083, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4173/4707 (88.6552%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4214/4707 (89.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0364, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4437/4986 (88.9892%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4462/4986 (89.4906%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8770, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3907/4315 (90.5446%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3958/4315 (91.7265%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8686, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3861/4416 (87.4321%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3933/4416 (89.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9704, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4246/4804 (88.3847%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4080/4804 (84.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2105, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4180/4793 (87.2105%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4253/4793 (88.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0607, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4546/5232 (86.8884%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4547/5232 (86.9075%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0569, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4116/4662 (88.2883%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4221/4662 (90.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1306, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4229/4956 (85.3309%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4305/4956 (86.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2115, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3827/4368 (87.6145%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3821/4368 (87.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9797, Accuracy: 5380/10000 (53.8000%)
time spent on training: 260.65234422683716
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0863, Accuracy: 7072/10000 (70.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7686, Accuracy: 1051/9900 (10.6162%)
Done in 288.4311375617981 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 42.547034233543386.
Norm before scaling: 42.54746315697036. Distance: 1.92619149130969
Total norm for 4 adversaries is: 42.54746315697036. distance: 1.92619149130969
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2759, Accuracy: 9217/9900 (93.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 42.547034233543386.
Norm before scaling: 42.54381214875364. Distance: 1.952076195453091
Total norm for 4 adversaries is: 42.54381214875364. distance: 1.952076195453091
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2188, Accuracy: 9347/9900 (94.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4321/4717 (91.6048%), train_poison_data_count: 370
Global model norm: 42.547034233543386.
Norm before scaling: 42.54697398308354. Distance: 1.8649144722193662
Total norm for 4 adversaries is: 42.54697398308354. distance: 1.8649144722193662
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2362, Accuracy: 9302/9900 (93.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 42.547034233543386.
Norm before scaling: 42.55175645656784. Distance: 2.019394299938238
Total norm for 4 adversaries is: 42.55175645656784. distance: 2.019394299938238
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1128, Accuracy: 9608/9900 (97.0505%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5361/6124 (87.5408%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5360/6124 (87.5245%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1354, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5144/5902 (87.1569%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5073/5902 (85.9539%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0607, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4183/4707 (88.8676%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4232/4707 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9246, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4091/4647 (88.0353%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4177/4647 (89.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8548, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2977/3297 (90.2942%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3019/3297 (91.5681%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7897, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5555/6263 (88.6955%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5649/6263 (90.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2067, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4173/4663 (89.4917%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4242/4663 (90.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0863, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4340/4956 (87.5706%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4326/4956 (87.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2977, Accuracy: 4961/10000 (49.6100%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3619/4046 (89.4464%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3728/4046 (92.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8928, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3725/4184 (89.0296%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3787/4184 (90.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8305, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4864/5591 (86.9970%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4882/5591 (87.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2221, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4093/4634 (88.3254%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4162/4634 (89.8144%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9732, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3400/3828 (88.8192%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3497/3828 (91.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9918, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3144/3638 (86.4211%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3275/3638 (90.0220%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9050, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3399/3781 (89.8969%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3376/3781 (89.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1647, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3421/3837 (89.1582%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3521/3837 (91.7644%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8904, Accuracy: 5640/10000 (56.4000%)
time spent on training: 259.88914918899536
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0830, Accuracy: 7074/10000 (70.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.2216, Accuracy: 1396/9900 (14.1010%)
Done in 287.26256680488586 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4486/4885 (91.8321%), train_poison_data_count: 385
Global model norm: 42.57053401369235.
Norm before scaling: 42.56881205490265. Distance: 1.8552254286386614
Total norm for 4 adversaries is: 42.56881205490265. distance: 1.8552254286386614
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2775, Accuracy: 9220/9900 (93.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4881/5305 (92.0075%), train_poison_data_count: 415
Global model norm: 42.57053401369235.
Norm before scaling: 42.567842795170804. Distance: 1.9377845432163878
Total norm for 4 adversaries is: 42.567842795170804. distance: 1.9377845432163878
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1518, Accuracy: 9527/9900 (96.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4284/4717 (90.8204%), train_poison_data_count: 370
Global model norm: 42.57053401369235.
Norm before scaling: 42.57232041855732. Distance: 1.8811497607726064
Total norm for 4 adversaries is: 42.57232041855732. distance: 1.8811497607726064
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1471, Accuracy: 9525/9900 (96.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4617/5066 (91.1370%), train_poison_data_count: 400
Global model norm: 42.57053401369235.
Norm before scaling: 42.572496761039865. Distance: 1.9513367057269824
Total norm for 4 adversaries is: 42.572496761039865. distance: 1.9513367057269824
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2376, Accuracy: 9327/9900 (94.2121%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3909/4501 (86.8474%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3927/4501 (87.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9903, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3713/4175 (88.9341%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3766/4175 (90.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9714, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3161/3616 (87.4170%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3241/3616 (89.6294%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8881, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4075/4634 (87.9370%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4123/4634 (88.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9538, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4028/4558 (88.3721%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4019/4558 (88.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2494, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4566/5167 (88.3685%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4620/5167 (89.4136%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1400, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3898/4356 (89.4858%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3827/4356 (87.8558%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1702, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4163/4716 (88.2740%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4173/4716 (88.4860%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0251, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5400/6124 (88.1777%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5350/6124 (87.3612%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9978, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4474/5055 (88.5064%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4560/5055 (90.2077%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9948, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4526/5025 (90.0697%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4602/5025 (91.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0295, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4378/4918 (89.0199%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4364/4918 (88.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1585, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3765/4223 (89.1546%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3805/4223 (90.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9429, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3926/4481 (87.6144%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3867/4481 (86.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2339, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3207/3638 (88.1528%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3276/3638 (90.0495%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8982, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3584/4013 (89.3097%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3683/4013 (91.7767%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8787, Accuracy: 5630/10000 (56.3000%)
time spent on training: 260.3072052001953
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0829, Accuracy: 7081/10000 (70.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.7125, Accuracy: 1887/9900 (19.0606%)
Done in 287.4016227722168 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4504/4885 (92.2006%), train_poison_data_count: 385
Global model norm: 42.59378295807603.
Norm before scaling: 42.59157757666121. Distance: 1.8387506238364504
Total norm for 4 adversaries is: 42.59157757666121. distance: 1.8387506238364504
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2381, Accuracy: 9306/9900 (94.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4866/5305 (91.7248%), train_poison_data_count: 415
Global model norm: 42.59378295807603.
Norm before scaling: 42.59064466165442. Distance: 1.9216281763386889
Total norm for 4 adversaries is: 42.59064466165442. distance: 1.9216281763386889
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2430, Accuracy: 9320/9900 (94.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4330/4717 (91.7956%), train_poison_data_count: 370
Global model norm: 42.59378295807603.
Norm before scaling: 42.592638008228604. Distance: 1.7830779751400911
Total norm for 4 adversaries is: 42.592638008228604. distance: 1.7830779751400911
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4337, Accuracy: 8852/9900 (89.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4612/5066 (91.0383%), train_poison_data_count: 400
Global model norm: 42.59378295807603.
Norm before scaling: 42.59498089518221. Distance: 1.9551988501531339
Total norm for 4 adversaries is: 42.59498089518221. distance: 1.9551988501531339
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1296, Accuracy: 9572/9900 (96.6869%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3209/3646 (88.0143%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3334/3646 (91.4427%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7918, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3958/4501 (87.9360%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4009/4501 (89.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0250, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4115/4651 (88.4756%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4185/4651 (89.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0054, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4602/5167 (89.0652%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4651/5167 (90.0135%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0573, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4912/5455 (90.0458%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4930/5455 (90.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2385, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4896/5591 (87.5693%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4895/5591 (87.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1059, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4228/4679 (90.3612%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4230/4679 (90.4039%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0217, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4477/5017 (89.2366%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4521/5017 (90.1136%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9250, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4274/4793 (89.1717%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4310/4793 (89.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0104, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4039/4456 (90.6418%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4086/4456 (91.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8741, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4832/5424 (89.0855%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4913/5424 (90.5789%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2149, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3683/4175 (88.2156%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3671/4175 (87.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9386, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4564/5116 (89.2103%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4567/5116 (89.2690%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9522, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3311/3704 (89.3898%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3363/3704 (90.7937%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8983, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4536/5232 (86.6972%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4649/5232 (88.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1826, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3107/3472 (89.4873%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3171/3472 (91.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0449, Accuracy: 5505/10000 (55.0500%)
time spent on training: 258.8761775493622
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0856, Accuracy: 7075/10000 (70.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.2261, Accuracy: 2422/9900 (24.4646%)
Done in 286.22011637687683 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4510/4885 (92.3234%), train_poison_data_count: 385
Global model norm: 42.61735577991524.
Norm before scaling: 42.61509719323731. Distance: 1.8036710180172413
Total norm for 4 adversaries is: 42.61509719323731. distance: 1.8036710180172413
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1922, Accuracy: 9420/9900 (95.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4888/5305 (92.1395%), train_poison_data_count: 415
Global model norm: 42.61735577991524.
Norm before scaling: 42.61122566571367. Distance: 1.8803386343683075
Total norm for 4 adversaries is: 42.61122566571367. distance: 1.8803386343683075
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1959, Accuracy: 9445/9900 (95.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 42.61735577991524.
Norm before scaling: 42.61413471536249. Distance: 1.7832731168450011
Total norm for 4 adversaries is: 42.61413471536249. distance: 1.7832731168450011
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1520, Accuracy: 9523/9900 (96.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4648/5066 (91.7489%), train_poison_data_count: 400
Global model norm: 42.61735577991524.
Norm before scaling: 42.618504362101916. Distance: 1.9196389689358593
Total norm for 4 adversaries is: 42.618504362101916. distance: 1.9196389689358593
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3695, Accuracy: 8976/9900 (90.6667%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3242/3590 (90.3064%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3340/3590 (93.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9721, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3866/4368 (88.5073%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3875/4368 (88.7134%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8511, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3302/3704 (89.1469%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3388/3704 (91.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8982, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4351/4928 (88.2914%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4368/4928 (88.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1763, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3916/4356 (89.8990%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3880/4356 (89.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0491, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3498/3911 (89.4400%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3349/3911 (85.6303%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1567, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4139/4651 (88.9916%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4175/4651 (89.7656%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0666, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3754/4184 (89.7228%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3797/4184 (90.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9372, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3925/4346 (90.3129%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4009/4346 (92.2457%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8199, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4229/4793 (88.2328%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4365/4793 (91.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0688, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3434/3804 (90.2734%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3495/3804 (91.8770%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9450, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4494/4986 (90.1324%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4500/4986 (90.2527%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8308, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5389/6124 (87.9980%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5321/6124 (86.8877%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0784, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4186/4707 (88.9314%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4233/4707 (89.9299%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9553, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3826/4235 (90.3424%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3718/4235 (87.7922%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0617, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3658/4046 (90.4103%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3696/4046 (91.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9626, Accuracy: 5459/10000 (54.5900%)
time spent on training: 258.14445328712463
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0888, Accuracy: 7058/10000 (70.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.7567, Accuracy: 3010/9900 (30.4040%)
Done in 285.5243573188782 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4555/4885 (93.2446%), train_poison_data_count: 385
Global model norm: 42.63955431048588.
Norm before scaling: 42.63382824174806. Distance: 1.7745292764733167
Total norm for 4 adversaries is: 42.63382824174806. distance: 1.7745292764733167
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0581, Accuracy: 9748/9900 (98.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4903/5305 (92.4222%), train_poison_data_count: 415
Global model norm: 42.63955431048588.
Norm before scaling: 42.6353872401458. Distance: 1.8456661160104069
Total norm for 4 adversaries is: 42.6353872401458. distance: 1.8456661160104069
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1045, Accuracy: 9643/9900 (97.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4355/4717 (92.3256%), train_poison_data_count: 370
Global model norm: 42.63955431048588.
Norm before scaling: 42.636717139544174. Distance: 1.7510599604764299
Total norm for 4 adversaries is: 42.636717139544174. distance: 1.7510599604764299
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3225, Accuracy: 9152/9900 (92.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4621/5066 (91.2159%), train_poison_data_count: 400
Global model norm: 42.63955431048588.
Norm before scaling: 42.6410415310363. Distance: 1.9432757642385898
Total norm for 4 adversaries is: 42.6410415310363. distance: 1.9432757642385898
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1524, Accuracy: 9511/9900 (96.0707%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4464/4986 (89.5307%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4488/4986 (90.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9337, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4066/4634 (87.7428%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4125/4634 (89.0160%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9137, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4162/4716 (88.2528%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4204/4716 (89.1433%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2015, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5369/6124 (87.6715%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5427/6124 (88.6185%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0289, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4414/4918 (89.7519%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4494/4918 (91.3786%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1214, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3404/3797 (89.6497%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3431/3797 (90.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0769, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4996/5582 (89.5020%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5034/5582 (90.1827%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1706, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4359/4956 (87.9540%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4311/4956 (86.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1333, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4022/4433 (90.7286%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4036/4433 (91.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8560, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3880/4354 (89.1135%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3371/4354 (77.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4989, Accuracy: 4702/10000 (47.0200%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4374/4928 (88.7581%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4401/4928 (89.3060%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8952, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3499/3911 (89.4656%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3435/3911 (87.8292%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9560, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3855/4481 (86.0299%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3858/4481 (86.0969%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1265, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4618/5197 (88.8590%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4621/5197 (88.9167%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0384, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4840/5455 (88.7259%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4927/5455 (90.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0630, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3840/4361 (88.0532%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3742/4361 (85.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1379, Accuracy: 5160/10000 (51.6000%)
time spent on training: 264.68639612197876
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.0930, Accuracy: 7060/10000 (70.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.3757, Accuracy: 3547/9900 (35.8283%)
Done in 292.0306308269501 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4536/4885 (92.8557%), train_poison_data_count: 385
Global model norm: 42.66517191493842.
Norm before scaling: 42.6646998270013. Distance: 1.773224469132173
Total norm for 4 adversaries is: 42.6646998270013. distance: 1.773224469132173
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1595, Accuracy: 9521/9900 (96.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4917/5305 (92.6861%), train_poison_data_count: 415
Global model norm: 42.66517191493842.
Norm before scaling: 42.657969860017076. Distance: 1.8247666118266548
Total norm for 4 adversaries is: 42.657969860017076. distance: 1.8247666118266548
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1422, Accuracy: 9520/9900 (96.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4364/4717 (92.5164%), train_poison_data_count: 370
Global model norm: 42.66517191493842.
Norm before scaling: 42.659191748379385. Distance: 1.708688171875511
Total norm for 4 adversaries is: 42.659191748379385. distance: 1.708688171875511
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0752, Accuracy: 9700/9900 (97.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4633/5066 (91.4528%), train_poison_data_count: 400
Global model norm: 42.66517191493842.
Norm before scaling: 42.66782552416912. Distance: 1.9083074504090962
Total norm for 4 adversaries is: 42.66782552416912. distance: 1.9083074504090962
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1709, Accuracy: 9478/9900 (95.7374%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4340/4928 (88.0682%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4396/4928 (89.2045%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9360, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3791/4184 (90.6071%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3831/4184 (91.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8807, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4263/4707 (90.5672%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4225/4707 (89.7599%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9876, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3447/3828 (90.0470%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3546/3828 (92.6332%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9659, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4011/4503 (89.0740%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4002/4503 (88.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9679, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4210/4662 (90.3046%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4228/4662 (90.6907%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9654, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3790/4235 (89.4923%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3789/4235 (89.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0448, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4461/5244 (85.0686%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4464/5244 (85.1259%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0819, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4262/4793 (88.9213%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4348/4793 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9554, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3980/4481 (88.8195%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3907/4481 (87.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2113, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3975/4346 (91.4634%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4031/4346 (92.7520%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7265, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3847/4361 (88.2137%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3686/4361 (84.5219%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2068, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4562/5055 (90.2473%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4540/5055 (89.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0182, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4593/5195 (88.4119%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4548/5195 (87.5457%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0791, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3937/4315 (91.2399%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4001/4315 (92.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9856, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4226/4663 (90.6284%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4281/4663 (91.8078%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9836, Accuracy: 5533/10000 (55.3300%)
time spent on training: 260.27679347991943
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.0973, Accuracy: 7049/10000 (70.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.9738, Accuracy: 4071/9900 (41.1212%)
Done in 287.65048694610596 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4544/4885 (93.0194%), train_poison_data_count: 385
Global model norm: 42.688692447656734.
Norm before scaling: 42.684921968729924. Distance: 1.7013365428250533
Total norm for 4 adversaries is: 42.684921968729924. distance: 1.7013365428250533
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1508, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4925/5305 (92.8369%), train_poison_data_count: 415
Global model norm: 42.688692447656734.
Norm before scaling: 42.68384810056229. Distance: 1.8151042250455813
Total norm for 4 adversaries is: 42.68384810056229. distance: 1.8151042250455813
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2190, Accuracy: 9361/9900 (94.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4376/4717 (92.7708%), train_poison_data_count: 370
Global model norm: 42.688692447656734.
Norm before scaling: 42.682938651797684. Distance: 1.6730678972967128
Total norm for 4 adversaries is: 42.682938651797684. distance: 1.6730678972967128
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1716, Accuracy: 9490/9900 (95.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4676/5066 (92.3016%), train_poison_data_count: 400
Global model norm: 42.688692447656734.
Norm before scaling: 42.688686728562814. Distance: 1.8428237010608282
Total norm for 4 adversaries is: 42.688686728562814. distance: 1.8428237010608282
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1455, Accuracy: 9524/9900 (96.2020%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3978/4315 (92.1900%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3971/4315 (92.0278%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8654, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3280/3590 (91.3649%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3223/3590 (89.7772%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1111, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4207/4679 (89.9124%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4266/4679 (91.1733%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9920, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4634/5167 (89.6845%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4647/5167 (89.9361%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0435, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3392/3775 (89.8543%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3527/3775 (93.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8165, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3446/3828 (90.0209%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3491/3828 (91.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9643, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3807/4235 (89.8937%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3846/4235 (90.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9684, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4158/4647 (89.4771%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4202/4647 (90.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9209, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4435/4918 (90.1789%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4498/4918 (91.4599%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0507, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4022/4433 (90.7286%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4005/4433 (90.3451%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0152, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3994/4481 (89.1319%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3904/4481 (87.1234%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0934, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3827/4295 (89.1036%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3698/4295 (86.1001%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1587, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4023/4503 (89.3404%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4059/4503 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9684, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3874/4354 (88.9757%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3519/4354 (80.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4369, Accuracy: 4674/10000 (46.7400%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4487/4986 (89.9920%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4434/4986 (88.9290%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9824, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5601/6263 (89.4300%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5703/6263 (91.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1060, Accuracy: 5323/10000 (53.2300%)
time spent on training: 256.1600387096405
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1100, Accuracy: 7022/10000 (70.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.6510, Accuracy: 4624/9900 (46.7071%)
Done in 283.6141412258148 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4527/4885 (92.6714%), train_poison_data_count: 385
Global model norm: 42.71175846910822.
Norm before scaling: 42.70701963807809. Distance: 1.7352079848366504
Total norm for 4 adversaries is: 42.70701963807809. distance: 1.7352079848366504
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1653, Accuracy: 9493/9900 (95.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4909/5305 (92.5353%), train_poison_data_count: 415
Global model norm: 42.71175846910822.
Norm before scaling: 42.70725259049246. Distance: 1.8681267327319444
Total norm for 4 adversaries is: 42.70725259049246. distance: 1.8681267327319444
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0802, Accuracy: 9679/9900 (97.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4381/4717 (92.8768%), train_poison_data_count: 370
Global model norm: 42.71175846910822.
Norm before scaling: 42.70406117479124. Distance: 1.6535533328480077
Total norm for 4 adversaries is: 42.70406117479124. distance: 1.6535533328480077
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1688, Accuracy: 9507/9900 (96.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4683/5066 (92.4398%), train_poison_data_count: 400
Global model norm: 42.71175846910822.
Norm before scaling: 42.710007906702906. Distance: 1.8288905179317898
Total norm for 4 adversaries is: 42.710007906702906. distance: 1.8288905179317898
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0588, Accuracy: 9753/9900 (98.5152%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3755/4223 (88.9178%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3833/4223 (90.7649%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9563, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4948/5455 (90.7058%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4875/5455 (89.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1257, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5101/5582 (91.3830%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5059/5582 (90.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2779, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4036/4465 (90.3919%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4084/4465 (91.4670%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8399, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4980/5591 (89.0717%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4953/5591 (88.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2938, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3539/3911 (90.4884%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3388/3911 (86.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9349, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3922/4356 (90.0367%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0144, Accuracy: 3279/4356 (75.2755%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.6320, Accuracy: 4422/10000 (44.2200%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4478/5037 (88.9021%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4546/5037 (90.2521%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9510, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4249/4679 (90.8100%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4249/4679 (90.8100%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1658, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4002/4362 (91.7469%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3949/4362 (90.5319%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1074, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4120/4518 (91.1908%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4157/4518 (92.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9466, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4512/5083 (88.7665%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4510/5083 (88.7271%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1408, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3590/4013 (89.4593%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3724/4013 (92.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7648, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4630/5197 (89.0899%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4665/5197 (89.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1030, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2978/3297 (90.3245%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3050/3297 (92.5083%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8018, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4039/4441 (90.9480%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4026/4441 (90.6553%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1180, Accuracy: 5391/10000 (53.9100%)
time spent on training: 261.8767297267914
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1122, Accuracy: 7028/10000 (70.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.3709, Accuracy: 5042/9900 (50.9293%)
Done in 289.537540435791 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4547/4885 (93.0809%), train_poison_data_count: 385
Global model norm: 42.73470635154903.
Norm before scaling: 42.72949440822829. Distance: 1.721415931720832
Total norm for 4 adversaries is: 42.72949440822829. distance: 1.721415931720832
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0901, Accuracy: 9685/9900 (97.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4920/5305 (92.7427%), train_poison_data_count: 415
Global model norm: 42.73470635154903.
Norm before scaling: 42.72659178436554. Distance: 1.7464604003462023
Total norm for 4 adversaries is: 42.72659178436554. distance: 1.7464604003462023
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2936, Accuracy: 9232/9900 (93.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4393/4717 (93.1312%), train_poison_data_count: 370
Global model norm: 42.73470635154903.
Norm before scaling: 42.72790313196621. Distance: 1.657862040708004
Total norm for 4 adversaries is: 42.72790313196621. distance: 1.657862040708004
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3085, Accuracy: 9126/9900 (92.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4665/5066 (92.0845%), train_poison_data_count: 400
Global model norm: 42.73470635154903.
Norm before scaling: 42.73353232715791. Distance: 1.8333960941438296
Total norm for 4 adversaries is: 42.73353232715791. distance: 1.8333960941438296
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1819, Accuracy: 9439/9900 (95.3434%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4032/4501 (89.5801%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4031/4501 (89.5579%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9565, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4032/4511 (89.3815%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4087/4511 (90.6008%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9256, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3901/4354 (89.5958%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0112, Accuracy: 3422/4354 (78.5944%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.6564, Accuracy: 4332/10000 (43.3200%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3966/4346 (91.2563%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4012/4346 (92.3148%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8437, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4249/4707 (90.2698%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4248/4707 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9577, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4953/5591 (88.5888%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4964/5591 (88.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0043, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4141/4647 (89.1113%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4201/4647 (90.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8682, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4103/4538 (90.4143%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4193/4538 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9592, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4383/4934 (88.8326%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4353/4934 (88.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1123, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4329/4804 (90.1124%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4251/4804 (88.4888%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0676, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5701/6263 (91.0267%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5651/6263 (90.2283%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.4495, Accuracy: 4933/10000 (49.3300%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3972/4481 (88.6409%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3923/4481 (87.5474%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0137, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4457/5063 (88.0308%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4450/5063 (87.8926%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9016, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3751/4223 (88.8231%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3859/4223 (91.3805%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9687, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4048/4441 (91.1506%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4088/4441 (92.0513%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0072, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3413/3756 (90.8679%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3470/3756 (92.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8434, Accuracy: 5717/10000 (57.1700%)
time spent on training: 260.1420786380768
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1161, Accuracy: 7020/10000 (70.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.1710, Accuracy: 5390/9900 (54.4444%)
Done in 287.21525168418884 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4579/4885 (93.7359%), train_poison_data_count: 385
Global model norm: 42.75826857170435.
Norm before scaling: 42.750950852912325. Distance: 1.669910595950579
Total norm for 4 adversaries is: 42.750950852912325. distance: 1.669910595950579
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1368, Accuracy: 9566/9900 (96.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4937/5305 (93.0631%), train_poison_data_count: 415
Global model norm: 42.75826857170435.
Norm before scaling: 42.75477118386175. Distance: 1.8427149566767125
Total norm for 4 adversaries is: 42.75477118386175. distance: 1.8427149566767125
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0620, Accuracy: 9735/9900 (98.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4390/4717 (93.0676%), train_poison_data_count: 370
Global model norm: 42.75826857170435.
Norm before scaling: 42.751867420836135. Distance: 1.6218948774644837
Total norm for 4 adversaries is: 42.751867420836135. distance: 1.6218948774644837
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2036, Accuracy: 9403/9900 (94.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4711/5066 (92.9925%), train_poison_data_count: 400
Global model norm: 42.75826857170435.
Norm before scaling: 42.752792534888876. Distance: 1.761407592090727
Total norm for 4 adversaries is: 42.752792534888876. distance: 1.761407592090727
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2027, Accuracy: 9385/9900 (94.7980%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4486/5244 (85.5454%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4581/5244 (87.3570%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9858, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4415/4928 (89.5901%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4456/4928 (90.4221%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9147, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3430/3804 (90.1682%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3501/3804 (92.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9906, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3642/4013 (90.7550%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3684/4013 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8916, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3640/4158 (87.5421%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3644/4158 (87.6383%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9501, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5105/5582 (91.4547%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5035/5582 (90.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1738, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4902/5455 (89.8625%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4943/5455 (90.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9488, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3902/4354 (89.6187%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0110, Accuracy: 3499/4354 (80.3629%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.7418, Accuracy: 4528/10000 (45.2800%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4021/4433 (90.7061%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4062/4433 (91.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9895, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3250/3646 (89.1388%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3323/3646 (91.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8482, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4085/4518 (90.4161%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4097/4518 (90.6817%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0303, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3867/4235 (91.3105%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3766/4235 (88.9256%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2932, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4012/4362 (91.9762%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3880/4362 (88.9500%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1055, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4865/5392 (90.2263%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4760/5392 (88.2789%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1913, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4938/5591 (88.3205%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4907/5591 (87.7661%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1772, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3411/3756 (90.8147%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3480/3756 (92.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0044, Accuracy: 5600/10000 (56.0000%)
time spent on training: 257.87004375457764
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1226, Accuracy: 7007/10000 (70.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.9372, Accuracy: 5815/9900 (58.7374%)
Done in 285.6821174621582 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4563/4885 (93.4084%), train_poison_data_count: 385
Global model norm: 42.78147398818281.
Norm before scaling: 42.773302653897034. Distance: 1.676267682237547
Total norm for 4 adversaries is: 42.773302653897034. distance: 1.676267682237547
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0845, Accuracy: 9679/9900 (97.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4937/5305 (93.0631%), train_poison_data_count: 415
Global model norm: 42.78147398818281.
Norm before scaling: 42.77319420592908. Distance: 1.7812425044387248
Total norm for 4 adversaries is: 42.77319420592908. distance: 1.7812425044387248
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0179, Accuracy: 9853/9900 (99.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4390/4717 (93.0676%), train_poison_data_count: 370
Global model norm: 42.78147398818281.
Norm before scaling: 42.77431862676921. Distance: 1.6447809532675064
Total norm for 4 adversaries is: 42.77431862676921. distance: 1.6447809532675064
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1163, Accuracy: 9616/9900 (97.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4694/5066 (92.6569%), train_poison_data_count: 400
Global model norm: 42.78147398818281.
Norm before scaling: 42.77683562415089. Distance: 1.8007073707899586
Total norm for 4 adversaries is: 42.77683562415089. distance: 1.8007073707899586
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1407, Accuracy: 9550/9900 (96.4646%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4213/4634 (90.9150%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4161/4634 (89.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0718, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4091/4503 (90.8505%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4078/4503 (90.5618%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9449, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4378/4928 (88.8393%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4495/4928 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7964, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3413/3804 (89.7213%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3452/3804 (90.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0156, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3287/3590 (91.5599%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3084/3590 (85.9053%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.4266, Accuracy: 4924/10000 (49.2400%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4177/4647 (89.8859%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4261/4647 (91.6936%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8335, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4031/4625 (87.1568%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4076/4625 (88.1297%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0385, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3953/4356 (90.7484%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3912/4356 (89.8072%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0900, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3464/3797 (91.2299%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3515/3797 (92.5731%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9523, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4066/4456 (91.2478%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4093/4456 (91.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9116, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3630/4025 (90.1863%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3722/4025 (92.4720%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8978, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3169/3472 (91.2730%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3163/3472 (91.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9953, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2955/3297 (89.6269%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3018/3297 (91.5378%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8618, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3925/4416 (88.8813%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3989/4416 (90.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0900, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3970/4356 (91.1387%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4020/4356 (92.2865%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0651, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3236/3638 (88.9500%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3338/3638 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8112, Accuracy: 5730/10000 (57.3000%)
time spent on training: 248.48102855682373
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1291, Accuracy: 6996/10000 (69.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.7461, Accuracy: 6172/9900 (62.3434%)
Done in 275.8662598133087 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4566/4885 (93.4698%), train_poison_data_count: 385
Global model norm: 42.8014855242892.
Norm before scaling: 42.79556291343911. Distance: 1.69672296450631
Total norm for 4 adversaries is: 42.79556291343911. distance: 1.69672296450631
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1618, Accuracy: 9516/9900 (96.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4950/5305 (93.3082%), train_poison_data_count: 415
Global model norm: 42.8014855242892.
Norm before scaling: 42.791239874078634. Distance: 1.7376446533364986
Total norm for 4 adversaries is: 42.791239874078634. distance: 1.7376446533364986
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1102, Accuracy: 9626/9900 (97.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4384/4717 (92.9404%), train_poison_data_count: 370
Global model norm: 42.8014855242892.
Norm before scaling: 42.7924622359914. Distance: 1.6222973135910361
Total norm for 4 adversaries is: 42.7924622359914. distance: 1.6222973135910361
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1110, Accuracy: 9630/9900 (97.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4725/5066 (93.2689%), train_poison_data_count: 400
Global model norm: 42.8014855242892.
Norm before scaling: 42.79436631247082. Distance: 1.7524747380328303
Total norm for 4 adversaries is: 42.79436631247082. distance: 1.7524747380328303
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0908, Accuracy: 9664/9900 (97.6162%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3740/4175 (89.5808%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3724/4175 (89.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9108, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4350/4956 (87.7724%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4445/4956 (89.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0821, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4551/5037 (90.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0125, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4305/4793 (89.8185%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4325/4793 (90.2358%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0870, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3405/3804 (89.5110%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3419/3804 (89.8791%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0294, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4865/5392 (90.2263%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4873/5392 (90.3746%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0527, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4084/4465 (91.4670%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4085/4465 (91.4894%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8691, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4174/4596 (90.8181%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4220/4596 (91.8190%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9910, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5395/6124 (88.0960%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5405/6124 (88.2593%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8869, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2924/3271 (89.3916%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2976/3271 (90.9814%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8577, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3254/3590 (90.6407%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3281/3590 (91.3928%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0071, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3973/4501 (88.2693%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3987/4501 (88.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0921, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4659/5232 (89.0482%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4589/5232 (87.7102%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0418, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3277/3672 (89.2429%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3303/3672 (89.9510%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0939, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3840/4223 (90.9306%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3889/4223 (92.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0738, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3926/4354 (90.1700%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0168, Accuracy: 3056/4354 (70.1883%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.6910, Accuracy: 4368/10000 (43.6800%)
time spent on training: 259.7446403503418
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1326, Accuracy: 6993/10000 (69.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.5725, Accuracy: 6494/9900 (65.5960%)
Done in 287.2028670310974 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4630/4885 (94.7799%), train_poison_data_count: 385
Global model norm: 42.824402428514695.
Norm before scaling: 42.811577601833505. Distance: 1.5714380586015742
Total norm for 4 adversaries is: 42.811577601833505. distance: 1.5714380586015742
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2677, Accuracy: 9263/9900 (93.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4974/5305 (93.7606%), train_poison_data_count: 415
Global model norm: 42.824402428514695.
Norm before scaling: 42.81129246700352. Distance: 1.6967581636730706
Total norm for 4 adversaries is: 42.81129246700352. distance: 1.6967581636730706
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0611, Accuracy: 9749/9900 (98.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4405/4717 (93.3856%), train_poison_data_count: 370
Global model norm: 42.824402428514695.
Norm before scaling: 42.81652581436869. Distance: 1.647279305386562
Total norm for 4 adversaries is: 42.81652581436869. distance: 1.647279305386562
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0741, Accuracy: 9702/9900 (98.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4734/5066 (93.4465%), train_poison_data_count: 400
Global model norm: 42.824402428514695.
Norm before scaling: 42.816353327959725. Distance: 1.6842519796596793
Total norm for 4 adversaries is: 42.816353327959725. distance: 1.6842519796596793
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1910, Accuracy: 9423/9900 (95.1818%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5116/5582 (91.6517%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5024/5582 (90.0036%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0753, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4171/4647 (89.7568%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4214/4647 (90.6822%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0059, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4047/4465 (90.6383%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4131/4465 (92.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8799, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4543/5083 (89.3764%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4460/5083 (87.7435%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1796, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3869/4416 (87.6132%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3942/4416 (89.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8751, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4423/4956 (89.2454%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4415/4956 (89.0839%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1557, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4021/4362 (92.1825%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3875/4362 (88.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0191, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3935/4356 (90.3352%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3798/4356 (87.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3172, Accuracy: 4932/10000 (49.3200%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3427/3781 (90.6374%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3441/3781 (91.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0647, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3282/3590 (91.4206%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3309/3590 (92.1727%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0940, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4198/4651 (90.2602%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4263/4651 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8770, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4211/4662 (90.3260%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4216/4662 (90.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8660, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3165/3472 (91.1578%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3237/3472 (93.2316%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8590, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4894/5424 (90.2286%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4947/5424 (91.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1644, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2965/3271 (90.6451%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2911/3271 (88.9942%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1074, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4490/5037 (89.1404%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4517/5037 (89.6764%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8945, Accuracy: 5628/10000 (56.2800%)
time spent on training: 255.64649963378906
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1354, Accuracy: 6983/10000 (69.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.4800, Accuracy: 6672/9900 (67.3939%)
Done in 283.30190658569336 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4627/4885 (94.7185%), train_poison_data_count: 385
Global model norm: 42.84632559727263.
Norm before scaling: 42.838488633452485. Distance: 1.6031104817764794
Total norm for 4 adversaries is: 42.838488633452485. distance: 1.6031104817764794
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1613, Accuracy: 9515/9900 (96.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4965/5305 (93.5910%), train_poison_data_count: 415
Global model norm: 42.84632559727263.
Norm before scaling: 42.83681876601235. Distance: 1.7301536944920042
Total norm for 4 adversaries is: 42.83681876601235. distance: 1.7301536944920042
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1041, Accuracy: 9626/9900 (97.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4424/4717 (93.7884%), train_poison_data_count: 370
Global model norm: 42.84632559727263.
Norm before scaling: 42.83436798943913. Distance: 1.5768621698644538
Total norm for 4 adversaries is: 42.83436798943913. distance: 1.5768621698644538
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2057, Accuracy: 9399/9900 (94.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4692/5066 (92.6174%), train_poison_data_count: 400
Global model norm: 42.84632559727263.
Norm before scaling: 42.8411372060707. Distance: 1.7676862314791093
Total norm for 4 adversaries is: 42.8411372060707. distance: 1.7676862314791093
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2664, Accuracy: 9238/9900 (93.3131%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4404/4989 (88.2742%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4452/4989 (89.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1022, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3655/4013 (91.0790%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3725/4013 (92.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8109, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4617/5195 (88.8739%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4434/5195 (85.3513%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1240, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3603/3969 (90.7785%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3577/3969 (90.1235%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9469, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3983/4356 (91.4371%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3837/4356 (88.0854%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2420, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4053/4441 (91.2632%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4034/4441 (90.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0751, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4100/4518 (90.7481%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4141/4518 (91.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0548, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3541/3911 (90.5395%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3278/3911 (83.8149%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2920, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4004/4362 (91.7928%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3958/4362 (90.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0291, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3454/3804 (90.7992%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3498/3804 (91.9558%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1982, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3812/4223 (90.2676%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3880/4223 (91.8778%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0101, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4202/4634 (90.6776%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4228/4634 (91.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8009, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3939/4354 (90.4685%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0147, Accuracy: 3227/4354 (74.1158%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.7742, Accuracy: 4276/10000 (42.7600%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4519/5244 (86.1747%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4536/5244 (86.4989%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9804, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4487/5037 (89.0808%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4598/5037 (91.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9840, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3327/3704 (89.8218%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3348/3704 (90.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8900, Accuracy: 5630/10000 (56.3000%)
time spent on training: 256.7412796020508
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1336, Accuracy: 6995/10000 (69.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 1.4088, Accuracy: 6807/9900 (68.7576%)
Done in 284.26031827926636 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4619/4885 (94.5548%), train_poison_data_count: 385
Global model norm: 42.86904198535567.
Norm before scaling: 42.858140305310584. Distance: 1.5859021713756722
Total norm for 4 adversaries is: 42.858140305310584. distance: 1.5859021713756722
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1369, Accuracy: 9556/9900 (96.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4964/5305 (93.5721%), train_poison_data_count: 415
Global model norm: 42.86904198535567.
Norm before scaling: 42.857063656688354. Distance: 1.6961042954702612
Total norm for 4 adversaries is: 42.857063656688354. distance: 1.6961042954702612
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0791, Accuracy: 9699/9900 (97.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4417/4717 (93.6400%), train_poison_data_count: 370
Global model norm: 42.86904198535567.
Norm before scaling: 42.85726873470167. Distance: 1.548089831572261
Total norm for 4 adversaries is: 42.85726873470167. distance: 1.548089831572261
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1042, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4745/5066 (93.6636%), train_poison_data_count: 400
Global model norm: 42.86904198535567.
Norm before scaling: 42.85964415017567. Distance: 1.6513207698098205
Total norm for 4 adversaries is: 42.85964415017567. distance: 1.6513207698098205
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1968, Accuracy: 9424/9900 (95.1919%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3938/4416 (89.1757%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3976/4416 (90.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9368, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4646/5197 (89.3977%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4610/5197 (88.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9380, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4427/4918 (90.0163%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4487/4918 (91.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9947, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5682/6263 (90.7233%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5700/6263 (91.0107%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1048, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3273/3646 (89.7696%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3330/3646 (91.3330%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8388, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4307/4707 (91.5020%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4324/4707 (91.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9406, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4460/5063 (88.0901%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4324/5063 (85.4039%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1787, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3835/4295 (89.2899%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3844/4295 (89.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0262, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4315/4793 (90.0271%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4350/4793 (90.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9820, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4132/4538 (91.0533%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4226/4538 (93.1247%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9246, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4556/5083 (89.6321%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4506/5083 (88.6484%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0401, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3253/3638 (89.4173%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3279/3638 (90.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8562, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5458/6124 (89.1248%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5442/6124 (88.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0724, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4189/4618 (90.7103%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4001/4618 (86.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0364, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3630/3969 (91.4588%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3616/3969 (91.1061%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8355, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3613/4158 (86.8927%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3668/4158 (88.2155%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9912, Accuracy: 5332/10000 (53.3200%)
time spent on training: 263.61370396614075
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1356, Accuracy: 6993/10000 (69.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 1.3340, Accuracy: 6952/9900 (70.2222%)
Done in 291.1485130786896 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4597/4885 (94.1044%), train_poison_data_count: 385
Global model norm: 42.892642825941024.
Norm before scaling: 42.882500084260045. Distance: 1.5544824512923048
Total norm for 4 adversaries is: 42.882500084260045. distance: 1.5544824512923048
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2031, Accuracy: 9421/9900 (95.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4945/5305 (93.2139%), train_poison_data_count: 415
Global model norm: 42.892642825941024.
Norm before scaling: 42.88121623805332. Distance: 1.7338449166409169
Total norm for 4 adversaries is: 42.88121623805332. distance: 1.7338449166409169
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1667, Accuracy: 9472/9900 (95.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4448/4717 (94.2972%), train_poison_data_count: 370
Global model norm: 42.892642825941024.
Norm before scaling: 42.88135145648251. Distance: 1.5461318417599068
Total norm for 4 adversaries is: 42.88135145648251. distance: 1.5461318417599068
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0857, Accuracy: 9672/9900 (97.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4714/5066 (93.0517%), train_poison_data_count: 400
Global model norm: 42.892642825941024.
Norm before scaling: 42.88563267849007. Distance: 1.7243287839983759
Total norm for 4 adversaries is: 42.88563267849007. distance: 1.7243287839983759
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3122, Accuracy: 9159/9900 (92.5152%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4147/4716 (87.9347%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4209/4716 (89.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0959, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4008/4481 (89.4443%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3933/4481 (87.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0624, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3916/4361 (89.7959%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3778/4361 (86.6315%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1848, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4364/4793 (91.0494%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4402/4793 (91.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9065, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3899/4295 (90.7800%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3773/4295 (87.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0796, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4567/5244 (87.0900%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4618/5244 (88.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0171, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4423/4989 (88.6550%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4478/4989 (89.7575%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9290, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4642/5197 (89.3208%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4658/5197 (89.6286%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0714, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3945/4356 (90.5647%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3665/4356 (84.1368%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3849, Accuracy: 4723/10000 (47.2300%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4175/4647 (89.8429%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4195/4647 (90.2733%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9543, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3663/4013 (91.2783%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3695/4013 (92.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8314, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4146/4538 (91.3618%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4188/4538 (92.2874%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8215, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4295/4707 (91.2471%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4308/4707 (91.5233%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8387, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5653/6263 (90.2603%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5690/6263 (90.8510%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0412, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3871/4235 (91.4050%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3752/4235 (88.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9687, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3488/3861 (90.3393%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3467/3861 (89.7954%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1718, Accuracy: 5247/10000 (52.4700%)
time spent on training: 256.7123029232025
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1409, Accuracy: 6984/10000 (69.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 1.2682, Accuracy: 7060/9900 (71.3131%)
Done in 284.4764621257782 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4597/4885 (94.1044%), train_poison_data_count: 385
Global model norm: 42.91660472285174.
Norm before scaling: 42.90863550588113. Distance: 1.631869102885221
Total norm for 4 adversaries is: 42.90863550588113. distance: 1.631869102885221
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1131, Accuracy: 9621/9900 (97.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4970/5305 (93.6852%), train_poison_data_count: 415
Global model norm: 42.91660472285174.
Norm before scaling: 42.904787620745196. Distance: 1.6999655299338445
Total norm for 4 adversaries is: 42.904787620745196. distance: 1.6999655299338445
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1216, Accuracy: 9583/9900 (96.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4409/4717 (93.4704%), train_poison_data_count: 370
Global model norm: 42.91660472285174.
Norm before scaling: 42.90534953306741. Distance: 1.541546438873158
Total norm for 4 adversaries is: 42.90534953306741. distance: 1.541546438873158
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1507, Accuracy: 9516/9900 (96.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4732/5066 (93.4070%), train_poison_data_count: 400
Global model norm: 42.91660472285174.
Norm before scaling: 42.91067382055862. Distance: 1.71733853731986
Total norm for 4 adversaries is: 42.91067382055862. distance: 1.71733853731986
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0916, Accuracy: 9659/9900 (97.5657%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4596/5055 (90.9199%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4640/5055 (91.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9007, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3476/3828 (90.8046%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3596/3828 (93.9394%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8920, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3920/4361 (89.8876%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3903/4361 (89.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9333, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3644/4013 (90.8049%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3737/4013 (93.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8802, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4099/4518 (90.7260%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4165/4518 (92.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8707, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4105/4558 (90.0614%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4021/4558 (88.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1480, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3722/4126 (90.2084%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3785/4126 (91.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8970, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4285/4679 (91.5794%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3907/4679 (83.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1921, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3920/4235 (92.5620%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3811/4235 (89.9882%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8797, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4481/5037 (88.9617%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4646/5037 (92.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8832, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3294/3672 (89.7059%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3354/3672 (91.3399%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8248, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4442/4928 (90.1380%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4434/4928 (89.9756%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0189, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3983/4356 (91.4371%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3781/4356 (86.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2702, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4078/4456 (91.5171%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4124/4456 (92.5494%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9578, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4316/4793 (90.0480%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4382/4793 (91.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1302, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4533/5025 (90.2090%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4524/5025 (90.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9494, Accuracy: 5494/10000 (54.9400%)
time spent on training: 259.0517179965973
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1407, Accuracy: 6991/10000 (69.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 1.1675, Accuracy: 7249/9900 (73.2222%)
Done in 286.2473258972168 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4638/4885 (94.9437%), train_poison_data_count: 385
Global model norm: 42.93836709914136.
Norm before scaling: 42.92734084236846. Distance: 1.544919097164854
Total norm for 4 adversaries is: 42.92734084236846. distance: 1.544919097164854
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0927, Accuracy: 9651/9900 (97.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4993/5305 (94.1188%), train_poison_data_count: 415
Global model norm: 42.93836709914136.
Norm before scaling: 42.92644650527589. Distance: 1.692847221740936
Total norm for 4 adversaries is: 42.92644650527589. distance: 1.692847221740936
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0880, Accuracy: 9649/9900 (97.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4463/4717 (94.6152%), train_poison_data_count: 370
Global model norm: 42.93836709914136.
Norm before scaling: 42.92372925554262. Distance: 1.4896698328614633
Total norm for 4 adversaries is: 42.92372925554262. distance: 1.4896698328614633
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1636, Accuracy: 9501/9900 (95.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4735/5066 (93.4662%), train_poison_data_count: 400
Global model norm: 42.93836709914136.
Norm before scaling: 42.93119807965633. Distance: 1.6839747871722388
Total norm for 4 adversaries is: 42.93119807965633. distance: 1.6839747871722388
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1256, Accuracy: 9564/9900 (96.6061%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3983/4346 (91.6475%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4024/4346 (92.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8991, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3803/4184 (90.8939%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3816/4184 (91.2046%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9573, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3931/4356 (90.2433%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0110, Accuracy: 3468/4356 (79.6143%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.4066, Accuracy: 4822/10000 (48.2200%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3307/3646 (90.7021%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3347/3646 (91.7992%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7856, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4586/5083 (90.2223%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4562/5083 (89.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9926, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3957/4356 (90.8402%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3929/4356 (90.1974%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1252, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4094/4558 (89.8201%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4074/4558 (89.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9749, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3751/4175 (89.8443%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3672/4175 (87.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9242, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3195/3472 (92.0219%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3168/3472 (91.2442%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1797, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4112/4501 (91.3575%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4094/4501 (90.9576%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9105, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4913/5424 (90.5789%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4948/5424 (91.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2423, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4028/4481 (89.8906%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3988/4481 (88.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0268, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4931/5455 (90.3941%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4907/5455 (89.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1154, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4686/5232 (89.5642%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4667/5232 (89.2011%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0876, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5587/6391 (87.4198%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5520/6391 (86.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1202, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3494/3775 (92.5563%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3580/3775 (94.8344%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8547, Accuracy: 5800/10000 (58.0000%)
time spent on training: 261.73520040512085
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1446, Accuracy: 6980/10000 (69.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 1.0765, Accuracy: 7429/9900 (75.0404%)
Done in 288.7848045825958 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4593/4885 (94.0225%), train_poison_data_count: 385
Global model norm: 42.9617522710972.
Norm before scaling: 42.951966892808734. Distance: 1.6411950710428087
Total norm for 4 adversaries is: 42.951966892808734. distance: 1.6411950710428087
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0824, Accuracy: 9670/9900 (97.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5002/5305 (94.2884%), train_poison_data_count: 415
Global model norm: 42.9617522710972.
Norm before scaling: 42.94765533335682. Distance: 1.6471486047108732
Total norm for 4 adversaries is: 42.94765533335682. distance: 1.6471486047108732
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0442, Accuracy: 9771/9900 (98.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4443/4717 (94.1912%), train_poison_data_count: 370
Global model norm: 42.9617522710972.
Norm before scaling: 42.94843980222463. Distance: 1.5172342625177524
Total norm for 4 adversaries is: 42.94843980222463. distance: 1.5172342625177524
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1515, Accuracy: 9495/9900 (95.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4741/5066 (93.5847%), train_poison_data_count: 400
Global model norm: 42.9617522710972.
Norm before scaling: 42.95482871075512. Distance: 1.695899264142016
Total norm for 4 adversaries is: 42.95482871075512. distance: 1.695899264142016
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1548, Accuracy: 9499/9900 (95.9495%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3678/4025 (91.3789%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3730/4025 (92.6708%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8329, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3875/4223 (91.7594%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3858/4223 (91.3569%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9033, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3260/3638 (89.6097%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3378/3638 (92.8532%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8473, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4498/5063 (88.8406%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4396/5063 (86.8260%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1329, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4389/4874 (90.0492%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4229/4874 (86.7665%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.4664, Accuracy: 4923/10000 (49.2300%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4335/4804 (90.2373%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4091/4804 (85.1582%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3459, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3672/4158 (88.3117%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3667/4158 (88.1914%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8835, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4080/4518 (90.3054%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4154/4518 (91.9433%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0952, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3897/4235 (92.0189%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3806/4235 (89.8701%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9605, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4353/4934 (88.2246%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4051/4934 (82.1038%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2135, Accuracy: 4959/10000 (49.5900%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5617/6391 (87.8892%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5600/6391 (87.6232%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1473, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3887/4295 (90.5006%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3820/4295 (88.9406%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0761, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3463/3756 (92.1991%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3537/3756 (94.1693%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8255, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4041/4481 (90.1808%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3891/4481 (86.8333%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1268, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3749/4175 (89.7964%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3740/4175 (89.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0520, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3303/3590 (92.0056%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3187/3590 (88.7744%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2382, Accuracy: 5176/10000 (51.7600%)
time spent on training: 258.88116240501404
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1506, Accuracy: 6977/10000 (69.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 1.0016, Accuracy: 7578/9900 (76.5455%)
Done in 286.64707374572754 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4629/4885 (94.7595%), train_poison_data_count: 385
Global model norm: 42.98493587193149.
Norm before scaling: 42.971340830982925. Distance: 1.5417934915424776
Total norm for 4 adversaries is: 42.971340830982925. distance: 1.5417934915424776
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1980, Accuracy: 9419/9900 (95.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5056/5305 (95.3063%), train_poison_data_count: 415
Global model norm: 42.98493587193149.
Norm before scaling: 42.967390603496476. Distance: 1.5473812315294824
Total norm for 4 adversaries is: 42.967390603496476. distance: 1.5473812315294824
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2650, Accuracy: 9300/9900 (93.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4449/4717 (94.3184%), train_poison_data_count: 370
Global model norm: 42.98493587193149.
Norm before scaling: 42.97035224285461. Distance: 1.4676677693739668
Total norm for 4 adversaries is: 42.97035224285461. distance: 1.4676677693739668
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1025, Accuracy: 9635/9900 (97.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4754/5066 (93.8413%), train_poison_data_count: 400
Global model norm: 42.98493587193149.
Norm before scaling: 42.97679328128365. Distance: 1.6620464738896499
Total norm for 4 adversaries is: 42.97679328128365. distance: 1.6620464738896499
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0808, Accuracy: 9693/9900 (97.9091%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3506/3828 (91.5883%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3562/3828 (93.0512%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7845, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3567/3911 (91.2043%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3342/3911 (85.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2883, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4038/4362 (92.5722%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3918/4362 (89.8212%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0182, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4782/5197 (92.0146%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4604/5197 (88.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1976, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4293/4679 (91.7504%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4196/4679 (89.6773%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2237, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4364/4793 (91.0494%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4365/4793 (91.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0736, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4588/5116 (89.6794%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4560/5116 (89.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1393, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4104/4625 (88.7351%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4098/4625 (88.6054%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9884, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4247/4618 (91.9662%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4181/4618 (90.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0397, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2965/3271 (90.6451%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3001/3271 (91.7456%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8945, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3812/4175 (91.3054%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3784/4175 (90.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9228, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3221/3616 (89.0763%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3322/3616 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8554, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3983/4481 (88.8864%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3915/4481 (87.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0955, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3953/4368 (90.4991%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3918/4368 (89.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9559, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5121/5740 (89.2160%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5188/5740 (90.3833%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1741, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4190/4647 (90.1657%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4227/4647 (90.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9978, Accuracy: 5455/10000 (54.5500%)
time spent on training: 258.9965591430664
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1641, Accuracy: 6951/10000 (69.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.8758, Accuracy: 7832/9900 (79.1111%)
Done in 286.884859085083 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4660/4885 (95.3941%), train_poison_data_count: 385
Global model norm: 43.007281019649746.
Norm before scaling: 42.993717178174705. Distance: 1.5183247382921856
Total norm for 4 adversaries is: 42.993717178174705. distance: 1.5183247382921856
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2191, Accuracy: 9357/9900 (94.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5009/5305 (94.4204%), train_poison_data_count: 415
Global model norm: 43.007281019649746.
Norm before scaling: 42.98962419102937. Distance: 1.6197569701310774
Total norm for 4 adversaries is: 42.98962419102937. distance: 1.6197569701310774
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1098, Accuracy: 9649/9900 (97.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4453/4717 (94.4032%), train_poison_data_count: 370
Global model norm: 43.007281019649746.
Norm before scaling: 42.99266380006012. Distance: 1.4844763470233624
Total norm for 4 adversaries is: 42.99266380006012. distance: 1.4844763470233624
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0526, Accuracy: 9756/9900 (98.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4768/5066 (94.1176%), train_poison_data_count: 400
Global model norm: 43.007281019649746.
Norm before scaling: 42.99728030098241. Distance: 1.6514551826191304
Total norm for 4 adversaries is: 42.99728030098241. distance: 1.6514551826191304
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0587, Accuracy: 9741/9900 (98.3939%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5017/5591 (89.7335%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4999/5591 (89.4116%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9724, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4435/4956 (89.4875%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4324/4956 (87.2478%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0779, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4034/4511 (89.4258%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4106/4511 (91.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0108, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3684/4013 (91.8016%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3701/4013 (92.2253%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8695, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3313/3590 (92.2841%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3365/3590 (93.7326%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9261, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4341/4793 (90.5696%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4359/4793 (90.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0319, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3476/3804 (91.3775%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3473/3804 (91.2986%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0431, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3492/3837 (91.0086%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3557/3837 (92.7026%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9441, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3932/4361 (90.1628%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3753/4361 (86.0582%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1699, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4512/5063 (89.1171%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4418/5063 (87.2605%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2804, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3910/4368 (89.5147%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3927/4368 (89.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1173, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4333/4679 (92.6053%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4196/4679 (89.6773%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0801, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4748/5265 (90.1804%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4684/5265 (88.9649%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9781, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4248/4767 (89.1126%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4216/4767 (88.4414%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0516, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5229/5902 (88.5971%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4910/5902 (83.1921%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.4110, Accuracy: 4848/10000 (48.4800%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3813/4223 (90.2913%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3869/4223 (91.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8884, Accuracy: 5639/10000 (56.3900%)
time spent on training: 259.89573311805725
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1631, Accuracy: 6952/10000 (69.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.8687, Accuracy: 7871/9900 (79.5051%)
Done in 287.9259431362152 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4678/4885 (95.7625%), train_poison_data_count: 385
Global model norm: 43.03050250122362.
Norm before scaling: 43.01416208237047. Distance: 1.431810314327495
Total norm for 4 adversaries is: 43.01416208237047. distance: 1.431810314327495
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1765, Accuracy: 9457/9900 (95.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5000/5305 (94.2507%), train_poison_data_count: 415
Global model norm: 43.03050250122362.
Norm before scaling: 43.01789519072993. Distance: 1.6615332065401363
Total norm for 4 adversaries is: 43.01789519072993. distance: 1.6615332065401363
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1536, Accuracy: 9513/9900 (96.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4455/4717 (94.4456%), train_poison_data_count: 370
Global model norm: 43.03050250122362.
Norm before scaling: 43.01445296714233. Distance: 1.4494713411475175
Total norm for 4 adversaries is: 43.01445296714233. distance: 1.4494713411475175
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1681, Accuracy: 9468/9900 (95.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4765/5066 (94.0584%), train_poison_data_count: 400
Global model norm: 43.03050250122362.
Norm before scaling: 43.01838468490463. Distance: 1.649414496142261
Total norm for 4 adversaries is: 43.01838468490463. distance: 1.649414496142261
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0481, Accuracy: 9774/9900 (98.7273%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3491/3797 (91.9410%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3494/3797 (92.0200%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8731, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3496/3861 (90.5465%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3466/3861 (89.7695%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9728, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4307/4707 (91.5020%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4230/4707 (89.8662%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1979, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4143/4518 (91.6999%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4182/4518 (92.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0587, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3698/4013 (92.1505%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3722/4013 (92.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8973, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4719/5167 (91.3296%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4684/5167 (90.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1650, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3618/3969 (91.1565%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3623/3969 (91.2824%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9221, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4077/4441 (91.8036%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4074/4441 (91.7361%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0026, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4114/4558 (90.2589%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4100/4558 (89.9517%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9760, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4061/4465 (90.9518%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4137/4465 (92.6540%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8782, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3297/3638 (90.6267%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3366/3638 (92.5234%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8878, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4133/4538 (91.0754%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4192/4538 (92.3755%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9466, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5135/5740 (89.4599%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5161/5740 (89.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2652, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3505/3837 (91.3474%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3542/3837 (92.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9600, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3946/4361 (90.4838%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3683/4361 (84.4531%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1327, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4368/4793 (91.1329%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4361/4793 (90.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0331, Accuracy: 5478/10000 (54.7800%)
time spent on training: 257.9470183849335
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1638, Accuracy: 6954/10000 (69.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.7941, Accuracy: 8022/9900 (81.0303%)
Done in 285.5940065383911 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4654/4885 (95.2712%), train_poison_data_count: 385
Global model norm: 43.05106887465165.
Norm before scaling: 43.034167532268036. Distance: 1.4800243666936974
Total norm for 4 adversaries is: 43.034167532268036. distance: 1.4800243666936974
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1016, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4999/5305 (94.2319%), train_poison_data_count: 415
Global model norm: 43.05106887465165.
Norm before scaling: 43.03610346176655. Distance: 1.6478414316601808
Total norm for 4 adversaries is: 43.03610346176655. distance: 1.6478414316601808
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0835, Accuracy: 9689/9900 (97.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4463/4717 (94.6152%), train_poison_data_count: 370
Global model norm: 43.05106887465165.
Norm before scaling: 43.03614742691965. Distance: 1.459544369265245
Total norm for 4 adversaries is: 43.03614742691965. distance: 1.459544369265245
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1797, Accuracy: 9455/9900 (95.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4763/5066 (94.0189%), train_poison_data_count: 400
Global model norm: 43.05106887465165.
Norm before scaling: 43.03806908569435. Distance: 1.6246140094974395
Total norm for 4 adversaries is: 43.03806908569435. distance: 1.6246140094974395
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1422, Accuracy: 9538/9900 (96.3434%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4240/4767 (88.9448%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4242/4767 (88.9868%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2086, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4110/4441 (92.5467%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4131/4441 (93.0196%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1310, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3996/4356 (91.7355%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3913/4356 (89.8301%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.4906, Accuracy: 4845/10000 (48.4500%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5571/6391 (87.1695%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5524/6391 (86.4340%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3525, Accuracy: 4925/10000 (49.2500%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3819/4184 (91.2763%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3788/4184 (90.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0619, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4007/4346 (92.1997%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4074/4346 (93.7414%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8079, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4490/5037 (89.1404%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4615/5037 (91.6220%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9888, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4197/4634 (90.5697%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4212/4634 (90.8934%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0248, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4411/4934 (89.4001%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4255/4934 (86.2383%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2471, Accuracy: 5019/10000 (50.1900%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4936/5424 (91.0029%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4916/5424 (90.6342%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1332, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3454/3781 (91.3515%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3237/3781 (85.6123%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1276, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3527/3861 (91.3494%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3473/3861 (89.9508%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0259, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4634/5055 (91.6716%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4627/5055 (91.5331%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9411, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4093/4433 (92.3303%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4069/4433 (91.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8670, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4699/5167 (90.9425%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4664/5167 (90.2651%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1807, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3317/3590 (92.3955%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3172/3590 (88.3565%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3955, Accuracy: 5085/10000 (50.8500%)
time spent on training: 259.7453303337097
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1680, Accuracy: 6933/10000 (69.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.7341, Accuracy: 8150/9900 (82.3232%)
Done in 287.25765109062195 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4648/4885 (95.1484%), train_poison_data_count: 385
Global model norm: 43.07369287138177.
Norm before scaling: 43.05659061185857. Distance: 1.472105292509091
Total norm for 4 adversaries is: 43.05659061185857. distance: 1.472105292509091
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1461, Accuracy: 9551/9900 (96.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5026/5305 (94.7408%), train_poison_data_count: 415
Global model norm: 43.07369287138177.
Norm before scaling: 43.05521130714754. Distance: 1.5697027892139532
Total norm for 4 adversaries is: 43.05521130714754. distance: 1.5697027892139532
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1421, Accuracy: 9544/9900 (96.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4478/4717 (94.9332%), train_poison_data_count: 370
Global model norm: 43.07369287138177.
Norm before scaling: 43.0584773384188. Distance: 1.4586795759158664
Total norm for 4 adversaries is: 43.0584773384188. distance: 1.4586795759158664
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0719, Accuracy: 9705/9900 (98.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4787/5066 (94.4927%), train_poison_data_count: 400
Global model norm: 43.07369287138177.
Norm before scaling: 43.062555277087164. Distance: 1.5919349657318382
Total norm for 4 adversaries is: 43.062555277087164. distance: 1.5919349657318382
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2307, Accuracy: 9321/9900 (94.1515%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3921/4368 (89.7665%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3937/4368 (90.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9254, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3507/3828 (91.6144%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3542/3828 (92.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8237, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4047/4356 (92.9063%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3683/4356 (84.5500%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1769, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3512/3861 (90.9609%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3499/3861 (90.6242%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8850, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3215/3472 (92.5979%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3231/3472 (93.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8991, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4182/4538 (92.1551%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4175/4538 (92.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9313, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4906/5392 (90.9866%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4861/5392 (90.1521%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0124, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3903/4295 (90.8731%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3704/4295 (86.2398%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0781, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3878/4235 (91.5702%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3821/4235 (90.2243%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0584, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4119/4456 (92.4372%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4048/4456 (90.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9102, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4736/5265 (89.9525%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4663/5265 (88.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0300, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4133/4441 (93.0646%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4158/4441 (93.6276%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9665, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3713/4013 (92.5243%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3731/4013 (92.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7391, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4090/4465 (91.6013%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4128/4465 (92.4524%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8846, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5692/6263 (90.8830%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5688/6263 (90.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9425, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4537/4986 (90.9948%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4547/4986 (91.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8282, Accuracy: 5758/10000 (57.5800%)
time spent on training: 259.6385223865509
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1643, Accuracy: 6935/10000 (69.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.7242, Accuracy: 8169/9900 (82.5152%)
Done in 286.9596383571625 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4630/4885 (94.7799%), train_poison_data_count: 385
Global model norm: 43.095193220485015.
Norm before scaling: 43.07965658548635. Distance: 1.5014311797547275
Total norm for 4 adversaries is: 43.07965658548635. distance: 1.5014311797547275
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1930, Accuracy: 9417/9900 (95.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5022/5305 (94.6654%), train_poison_data_count: 415
Global model norm: 43.095193220485015.
Norm before scaling: 43.07976001159071. Distance: 1.5874679772458806
Total norm for 4 adversaries is: 43.07976001159071. distance: 1.5874679772458806
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1177, Accuracy: 9602/9900 (96.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4464/4717 (94.6364%), train_poison_data_count: 370
Global model norm: 43.095193220485015.
Norm before scaling: 43.078724322544794. Distance: 1.4491292509426135
Total norm for 4 adversaries is: 43.078724322544794. distance: 1.4491292509426135
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0627, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4806/5066 (94.8677%), train_poison_data_count: 400
Global model norm: 43.095193220485015.
Norm before scaling: 43.08188373382352. Distance: 1.570455060722147
Total norm for 4 adversaries is: 43.08188373382352. distance: 1.570455060722147
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1180, Accuracy: 9606/9900 (97.0303%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3697/4158 (88.9129%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3653/4158 (87.8547%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0377, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4679/5167 (90.5554%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4707/5167 (91.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0281, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3511/3828 (91.7189%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3522/3828 (92.0063%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9339, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4252/4663 (91.1859%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4256/4663 (91.2717%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9189, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4065/4433 (91.6986%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4102/4433 (92.5333%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9598, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3825/4184 (91.4197%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3800/4184 (90.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9872, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4251/4716 (90.1399%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4211/4716 (89.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1823, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3886/4223 (92.0199%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3918/4223 (92.7776%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8537, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4305/4679 (92.0068%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4169/4679 (89.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0990, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3316/3704 (89.5248%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3382/3704 (91.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9180, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3520/3837 (91.7383%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3587/3837 (93.4845%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9507, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3530/3861 (91.4271%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3524/3861 (91.2717%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8905, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4926/5424 (90.8186%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4907/5424 (90.4683%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1110, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4201/4576 (91.8051%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4221/4576 (92.2421%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7969, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3682/4025 (91.4783%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3785/4025 (94.0373%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7831, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3481/3775 (92.2119%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3564/3775 (94.4106%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7836, Accuracy: 5871/10000 (58.7100%)
time spent on training: 252.7442593574524
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1638, Accuracy: 6943/10000 (69.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.6805, Accuracy: 8266/9900 (83.4949%)
Done in 280.33725929260254 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4645/4885 (95.0870%), train_poison_data_count: 385
Global model norm: 43.11515540939824.
Norm before scaling: 43.10095004209594. Distance: 1.5050188185063427
Total norm for 4 adversaries is: 43.10095004209594. distance: 1.5050188185063427
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0756, Accuracy: 9698/9900 (97.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5009/5305 (94.4204%), train_poison_data_count: 415
Global model norm: 43.11515540939824.
Norm before scaling: 43.099553747145976. Distance: 1.6285880896425922
Total norm for 4 adversaries is: 43.099553747145976. distance: 1.6285880896425922
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0913, Accuracy: 9666/9900 (97.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4484/4717 (95.0604%), train_poison_data_count: 370
Global model norm: 43.11515540939824.
Norm before scaling: 43.09609113700525. Distance: 1.3949274520741168
Total norm for 4 adversaries is: 43.09609113700525. distance: 1.3949274520741168
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2593, Accuracy: 9275/9900 (93.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4778/5066 (94.3150%), train_poison_data_count: 400
Global model norm: 43.11515540939824.
Norm before scaling: 43.102231591462434. Distance: 1.5930302808700916
Total norm for 4 adversaries is: 43.102231591462434. distance: 1.5930302808700916
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0346, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4172/4576 (91.1713%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4198/4576 (91.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9791, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3319/3672 (90.3867%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3332/3672 (90.7407%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9544, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4254/4618 (92.1178%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4095/4618 (88.6748%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0897, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4207/4538 (92.7060%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4247/4538 (93.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8491, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4550/5025 (90.5473%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4631/5025 (92.1592%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1381, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3314/3590 (92.3120%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3336/3590 (92.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9190, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4311/4707 (91.5870%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4315/4707 (91.6720%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1079, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4507/4918 (91.6429%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4493/4918 (91.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0063, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3939/4336 (90.8441%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3958/4336 (91.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0020, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5251/5902 (88.9698%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5045/5902 (85.4795%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2283, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4121/4441 (92.7944%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4158/4441 (93.6276%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9479, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4695/5232 (89.7362%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4684/5232 (89.5260%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9790, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4344/4804 (90.4246%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4242/4804 (88.3014%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2442, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3630/3969 (91.4588%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3666/3969 (92.3658%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0589, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4936/5392 (91.5430%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4872/5392 (90.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9964, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3531/3828 (92.2414%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3532/3828 (92.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8948, Accuracy: 5669/10000 (56.6900%)
time spent on training: 257.1747179031372
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1746, Accuracy: 6920/10000 (69.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.6048, Accuracy: 8434/9900 (85.1919%)
Done in 284.5148124694824 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4688/4885 (95.9672%), train_poison_data_count: 385
Global model norm: 43.136657731381725.
Norm before scaling: 43.117083455890054. Distance: 1.39253031473361
Total norm for 4 adversaries is: 43.117083455890054. distance: 1.39253031473361
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1044, Accuracy: 9626/9900 (97.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5030/5305 (94.8162%), train_poison_data_count: 415
Global model norm: 43.136657731381725.
Norm before scaling: 43.12016220600144. Distance: 1.5804445952202155
Total norm for 4 adversaries is: 43.12016220600144. distance: 1.5804445952202155
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0854, Accuracy: 9679/9900 (97.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4464/4717 (94.6364%), train_poison_data_count: 370
Global model norm: 43.136657731381725.
Norm before scaling: 43.119618663340184. Distance: 1.4435377617268106
Total norm for 4 adversaries is: 43.119618663340184. distance: 1.4435377617268106
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1186, Accuracy: 9594/9900 (96.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4796/5066 (94.6704%), train_poison_data_count: 400
Global model norm: 43.136657731381725.
Norm before scaling: 43.121277579382145. Distance: 1.5455307176759008
Total norm for 4 adversaries is: 43.121277579382145. distance: 1.5455307176759008
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1018, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4693/5232 (89.6980%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4569/5232 (87.3280%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2390, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4483/4956 (90.4560%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4427/4956 (89.3261%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2773, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4527/5063 (89.4134%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4483/5063 (88.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1129, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3741/4025 (92.9441%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3754/4025 (93.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8591, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4102/4441 (92.3666%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4101/4441 (92.3441%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0879, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4121/4625 (89.1027%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4040/4625 (87.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0202, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4996/5591 (89.3579%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4847/5591 (86.6929%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2667, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5153/5582 (92.3146%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5094/5582 (91.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1622, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5263/5902 (89.1732%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5134/5902 (86.9875%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2011, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4209/4538 (92.7501%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4238/4538 (93.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7988, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4603/5025 (91.6020%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4638/5025 (92.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9434, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3877/4223 (91.8068%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3902/4223 (92.3988%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8583, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3927/4361 (90.0482%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3709/4361 (85.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1598, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3957/4354 (90.8819%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3601/4354 (82.7056%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3345, Accuracy: 4879/10000 (48.7900%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3325/3672 (90.5501%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3347/3672 (91.1492%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0843, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3992/4356 (91.6437%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3884/4356 (89.1644%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2957, Accuracy: 5016/10000 (50.1600%)
time spent on training: 262.39428997039795
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1723, Accuracy: 6941/10000 (69.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.6041, Accuracy: 8443/9900 (85.2828%)
Done in 289.64034819602966 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4648/4885 (95.1484%), train_poison_data_count: 385
Global model norm: 43.160184356324.
Norm before scaling: 43.143250780285726. Distance: 1.45355316745137
Total norm for 4 adversaries is: 43.143250780285726. distance: 1.45355316745137
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0602, Accuracy: 9746/9900 (98.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5044/5305 (95.0801%), train_poison_data_count: 415
Global model norm: 43.160184356324.
Norm before scaling: 43.13996711513944. Distance: 1.51653765699129
Total norm for 4 adversaries is: 43.13996711513944. distance: 1.51653765699129
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1256, Accuracy: 9575/9900 (96.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4480/4717 (94.9756%), train_poison_data_count: 370
Global model norm: 43.160184356324.
Norm before scaling: 43.141353613459586. Distance: 1.3949802220901137
Total norm for 4 adversaries is: 43.141353613459586. distance: 1.3949802220901137
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1478, Accuracy: 9529/9900 (96.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4806/5066 (94.8677%), train_poison_data_count: 400
Global model norm: 43.160184356324.
Norm before scaling: 43.146479026031194. Distance: 1.5594942555665736
Total norm for 4 adversaries is: 43.146479026031194. distance: 1.5594942555665736
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0976, Accuracy: 9673/9900 (97.7071%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3547/3828 (92.6594%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3568/3828 (93.2079%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8288, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3907/4235 (92.2550%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3799/4235 (89.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9921, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3367/3704 (90.9017%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3318/3704 (89.5788%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0324, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3711/4046 (91.7202%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3730/4046 (92.1898%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8195, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4498/4928 (91.2744%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4456/4928 (90.4221%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8925, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5223/5740 (90.9930%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5172/5740 (90.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1008, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4586/5083 (90.2223%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4541/5083 (89.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8435, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4190/4576 (91.5647%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4171/4576 (91.1495%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9587, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4240/4647 (91.2417%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4255/4647 (91.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9301, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4984/5424 (91.8879%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4931/5424 (90.9108%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3043, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4090/4503 (90.8283%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4064/4503 (90.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0683, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5652/6391 (88.4369%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5659/6391 (88.5464%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0480, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4092/4511 (90.7116%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4068/4511 (90.1796%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0069, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4121/4456 (92.4820%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4088/4456 (91.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9605, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4358/4804 (90.7161%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4107/4804 (85.4913%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2976, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3462/3804 (91.0095%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3491/3804 (91.7718%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0743, Accuracy: 5340/10000 (53.4000%)
time spent on training: 261.4362633228302
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1736, Accuracy: 6936/10000 (69.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.5737, Accuracy: 8508/9900 (85.9394%)
Done in 289.05615425109863 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4668/4885 (95.5578%), train_poison_data_count: 385
Global model norm: 43.18278652145798.
Norm before scaling: 43.164650024282025. Distance: 1.4471659555233904
Total norm for 4 adversaries is: 43.164650024282025. distance: 1.4471659555233904
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0872, Accuracy: 9673/9900 (97.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5055/5305 (95.2875%), train_poison_data_count: 415
Global model norm: 43.18278652145798.
Norm before scaling: 43.16479849485646. Distance: 1.5812761930324262
Total norm for 4 adversaries is: 43.16479849485646. distance: 1.5812761930324262
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1036, Accuracy: 9625/9900 (97.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4479/4717 (94.9544%), train_poison_data_count: 370
Global model norm: 43.18278652145798.
Norm before scaling: 43.165714759100915. Distance: 1.4247590881957422
Total norm for 4 adversaries is: 43.165714759100915. distance: 1.4247590881957422
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0811, Accuracy: 9692/9900 (97.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4825/5066 (95.2428%), train_poison_data_count: 400
Global model norm: 43.18278652145798.
Norm before scaling: 43.165379646193315. Distance: 1.484306976365907
Total norm for 4 adversaries is: 43.165379646193315. distance: 1.484306976365907
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0676, Accuracy: 9715/9900 (98.1313%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4508/4928 (91.4773%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4479/4928 (90.8888%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9010, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4511/5037 (89.5573%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4581/5037 (90.9470%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0666, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4952/5392 (91.8398%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4821/5392 (89.4102%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0930, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4094/4501 (90.9576%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4040/4501 (89.7578%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0659, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3450/3804 (90.6940%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3496/3804 (91.9033%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9343, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3518/3837 (91.6862%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3577/3837 (93.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9788, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4534/5063 (89.5516%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4219/5063 (83.3300%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2156, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4070/4481 (90.8279%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3945/4481 (88.0384%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2558, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4162/4518 (92.1204%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4168/4518 (92.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9500, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3279/3638 (90.1319%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3336/3638 (91.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8698, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4287/4663 (91.9365%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4290/4663 (92.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0225, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4142/4625 (89.5568%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4035/4625 (87.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2802, Accuracy: 4964/10000 (49.6400%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4697/5197 (90.3791%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4662/5197 (89.7056%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2142, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4616/5083 (90.8125%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4615/5083 (90.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0284, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3562/3828 (93.0512%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3592/3828 (93.8349%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7928, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3335/3704 (90.0378%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3390/3704 (91.5227%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9499, Accuracy: 5596/10000 (55.9600%)
time spent on training: 257.42822217941284
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1786, Accuracy: 6929/10000 (69.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.5527, Accuracy: 8550/9900 (86.3636%)
Done in 284.885582447052 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4650/4885 (95.1894%), train_poison_data_count: 385
Global model norm: 43.20471431299121.
Norm before scaling: 43.18715798978181. Distance: 1.4938228892654606
Total norm for 4 adversaries is: 43.18715798978181. distance: 1.4938228892654606
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0893, Accuracy: 9664/9900 (97.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5072/5305 (95.6079%), train_poison_data_count: 415
Global model norm: 43.20471431299121.
Norm before scaling: 43.18371653787383. Distance: 1.5067768394367214
Total norm for 4 adversaries is: 43.18371653787383. distance: 1.5067768394367214
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0555, Accuracy: 9749/9900 (98.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4491/4717 (95.2088%), train_poison_data_count: 370
Global model norm: 43.20471431299121.
Norm before scaling: 43.18598354564462. Distance: 1.4226161157182973
Total norm for 4 adversaries is: 43.18598354564462. distance: 1.4226161157182973
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1296, Accuracy: 9563/9900 (96.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4798/5066 (94.7098%), train_poison_data_count: 400
Global model norm: 43.20471431299121.
Norm before scaling: 43.18821510352245. Distance: 1.5300640262346676
Total norm for 4 adversaries is: 43.18821510352245. distance: 1.5300640262346676
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0823, Accuracy: 9691/9900 (97.8889%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3553/3861 (92.0228%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3538/3861 (91.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8688, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3836/4184 (91.6826%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3839/4184 (91.7543%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8992, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4538/5037 (90.0933%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4588/5037 (91.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8987, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4659/5197 (89.6479%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4522/5197 (87.0117%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1597, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4507/5025 (89.6915%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4497/5025 (89.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0927, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4645/5116 (90.7936%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4558/5116 (89.0930%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1709, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4051/4481 (90.4039%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4006/4481 (89.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1322, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4252/4576 (92.9196%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4221/4576 (92.2421%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0283, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4715/5232 (90.1185%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4704/5232 (89.9083%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0139, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3953/4354 (90.7901%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3801/4354 (87.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1764, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2957/3271 (90.4005%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2903/3271 (88.7496%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0135, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4908/5455 (89.9725%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4882/5455 (89.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1701, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3765/4126 (91.2506%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3799/4126 (92.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0169, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3481/3797 (91.6776%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3527/3797 (92.8891%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8554, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3372/3704 (91.0367%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3393/3704 (91.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7756, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4488/4934 (90.9607%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4301/4934 (87.1707%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1229, Accuracy: 5244/10000 (52.4400%)
time spent on training: 258.6837205886841
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1803, Accuracy: 6932/10000 (69.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.5193, Accuracy: 8615/9900 (87.0202%)
Done in 286.1469295024872 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4687/4885 (95.9468%), train_poison_data_count: 385
Global model norm: 43.22701362610248.
Norm before scaling: 43.206515463707845. Distance: 1.3961856549223188
Total norm for 4 adversaries is: 43.206515463707845. distance: 1.3961856549223188
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0989, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5047/5305 (95.1367%), train_poison_data_count: 415
Global model norm: 43.22701362610248.
Norm before scaling: 43.20762578273944. Distance: 1.542587967254623
Total norm for 4 adversaries is: 43.20762578273944. distance: 1.542587967254623
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1882, Accuracy: 9415/9900 (95.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4466/4717 (94.6788%), train_poison_data_count: 370
Global model norm: 43.22701362610248.
Norm before scaling: 43.207878637665. Distance: 1.441362830027552
Total norm for 4 adversaries is: 43.207878637665. distance: 1.441362830027552
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0934, Accuracy: 9658/9900 (97.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4824/5066 (95.2231%), train_poison_data_count: 400
Global model norm: 43.22701362610248.
Norm before scaling: 43.2089267691187. Distance: 1.5059758201927576
Total norm for 4 adversaries is: 43.2089267691187. distance: 1.5059758201927576
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0673, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4271/4618 (92.4859%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4117/4618 (89.1511%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9514, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4126/4625 (89.2108%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4084/4625 (88.3027%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2371, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5227/5740 (91.0627%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5109/5740 (89.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3710, Accuracy: 4944/10000 (49.4400%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3999/4416 (90.5571%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4026/4416 (91.1685%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0185, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3820/4126 (92.5836%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8327, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3256/3616 (90.0442%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3325/3616 (91.9524%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8494, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3677/4158 (88.4319%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3731/4158 (89.7306%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9744, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4025/4346 (92.6139%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4053/4346 (93.2582%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9315, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4358/4874 (89.4132%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4287/4874 (87.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3653, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4742/5265 (90.0665%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4702/5265 (89.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9873, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3716/4025 (92.3230%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3753/4025 (93.2422%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8717, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4230/4651 (90.9482%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4203/4651 (90.3677%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1355, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3480/3837 (90.6959%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3515/3837 (91.6080%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0518, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3287/3638 (90.3518%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3349/3638 (92.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8983, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3232/3472 (93.0876%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3239/3472 (93.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9476, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4149/4456 (93.1104%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4154/4456 (93.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9958, Accuracy: 5522/10000 (55.2200%)
time spent on training: 256.12010169029236
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1779, Accuracy: 6929/10000 (69.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.4998, Accuracy: 8663/9900 (87.5051%)
Done in 283.448992729187 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4646/4885 (95.1075%), train_poison_data_count: 385
Global model norm: 43.24740045926894.
Norm before scaling: 43.232843248525334. Distance: 1.5081692604624108
Total norm for 4 adversaries is: 43.232843248525334. distance: 1.5081692604624108
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1056, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5062/5305 (95.4194%), train_poison_data_count: 415
Global model norm: 43.24740045926894.
Norm before scaling: 43.227331317715674. Distance: 1.5127034294841537
Total norm for 4 adversaries is: 43.227331317715674. distance: 1.5127034294841537
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0612, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4487/4717 (95.1240%), train_poison_data_count: 370
Global model norm: 43.24740045926894.
Norm before scaling: 43.227893273162614. Distance: 1.4057085054322491
Total norm for 4 adversaries is: 43.227893273162614. distance: 1.4057085054322491
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1003, Accuracy: 9632/9900 (97.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4800/5066 (94.7493%), train_poison_data_count: 400
Global model norm: 43.24740045926894.
Norm before scaling: 43.231763225231745. Distance: 1.5567261637658845
Total norm for 4 adversaries is: 43.231763225231745. distance: 1.5567261637658845
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0604, Accuracy: 9745/9900 (98.4343%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4986/5424 (91.9248%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4924/5424 (90.7817%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1730, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4554/4986 (91.3357%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4531/4986 (90.8744%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8742, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4706/5167 (91.0780%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4722/5167 (91.3877%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1775, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4253/4716 (90.1824%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4228/4716 (89.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1114, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3923/4368 (89.8123%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3867/4368 (88.5302%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0637, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4031/4356 (92.5390%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3743/4356 (85.9275%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.4272, Accuracy: 4737/10000 (47.3700%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4395/4804 (91.4863%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4271/4804 (88.9051%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1279, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4058/4481 (90.5601%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3955/4481 (88.2615%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1439, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3707/4025 (92.0994%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3806/4025 (94.5590%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8370, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4576/5017 (91.2099%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4575/5017 (91.1900%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0016, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3305/3616 (91.3993%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3311/3616 (91.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8628, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3825/4184 (91.4197%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3833/4184 (91.6109%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7779, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4653/5195 (89.5669%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4648/5195 (89.4706%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0418, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3970/4361 (91.0342%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3922/4361 (89.9335%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1785, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3518/3756 (93.6635%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3536/3756 (94.1427%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8553, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5021/5591 (89.8050%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4906/5591 (87.7482%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2463, Accuracy: 5227/10000 (52.2700%)
time spent on training: 257.10673236846924
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1808, Accuracy: 6930/10000 (69.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.4673, Accuracy: 8736/9900 (88.2424%)
Done in 284.93196964263916 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4671/4885 (95.6192%), train_poison_data_count: 385
Global model norm: 43.26928563197644.
Norm before scaling: 43.24879480347545. Distance: 1.3974782114940636
Total norm for 4 adversaries is: 43.24879480347545. distance: 1.3974782114940636
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1703, Accuracy: 9443/9900 (95.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5019/5305 (94.6089%), train_poison_data_count: 415
Global model norm: 43.26928563197644.
Norm before scaling: 43.254003438717234. Distance: 1.6214760203227834
Total norm for 4 adversaries is: 43.254003438717234. distance: 1.6214760203227834
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1135, Accuracy: 9604/9900 (97.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4495/4717 (95.2936%), train_poison_data_count: 370
Global model norm: 43.26928563197644.
Norm before scaling: 43.248495615996575. Distance: 1.381041173554568
Total norm for 4 adversaries is: 43.248495615996575. distance: 1.381041173554568
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0679, Accuracy: 9723/9900 (98.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4799/5066 (94.7296%), train_poison_data_count: 400
Global model norm: 43.26928563197644.
Norm before scaling: 43.252966277434375. Distance: 1.5707142633832019
Total norm for 4 adversaries is: 43.252966277434375. distance: 1.5707142633832019
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0486, Accuracy: 9769/9900 (98.6768%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3810/4175 (91.2575%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3767/4175 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1752, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5013/5455 (91.8973%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4930/5455 (90.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9127, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3394/3704 (91.6307%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3436/3704 (92.7646%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8154, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4469/4989 (89.5771%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4447/4989 (89.1361%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9716, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4492/4928 (91.1526%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4455/4928 (90.4018%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9907, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3492/3804 (91.7981%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3541/3804 (93.0862%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0633, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3941/4336 (90.8902%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3933/4336 (90.7057%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9463, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3716/4046 (91.8438%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3717/4046 (91.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8246, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4370/4793 (91.1746%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4381/4793 (91.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9365, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3472/3756 (92.4388%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3526/3756 (93.8765%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0532, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5713/6391 (89.3913%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5547/6391 (86.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2024, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3320/3672 (90.4139%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3346/3672 (91.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9664, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4148/4558 (91.0048%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4105/4558 (90.0614%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1131, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4206/4576 (91.9143%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4154/4576 (90.7780%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9214, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4135/4456 (92.7962%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4174/4456 (93.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8408, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4059/4356 (93.1818%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3660/4356 (84.0220%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.3703, Accuracy: 4952/10000 (49.5200%)
time spent on training: 255.68620109558105
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1827, Accuracy: 6925/10000 (69.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.4483, Accuracy: 8771/9900 (88.5960%)
Done in 283.24791073799133 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4673/4885 (95.6602%), train_poison_data_count: 385
Global model norm: 43.290767793744145.
Norm before scaling: 43.26894850001413. Distance: 1.3873522533762361
Total norm for 4 adversaries is: 43.26894850001413. distance: 1.3873522533762361
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0654, Accuracy: 9737/9900 (98.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5043/5305 (95.0613%), train_poison_data_count: 415
Global model norm: 43.290767793744145.
Norm before scaling: 43.27295300663062. Distance: 1.5719345597194188
Total norm for 4 adversaries is: 43.27295300663062. distance: 1.5719345597194188
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1073, Accuracy: 9612/9900 (97.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4477/4717 (94.9120%), train_poison_data_count: 370
Global model norm: 43.290767793744145.
Norm before scaling: 43.273212532137734. Distance: 1.4568079554883664
Total norm for 4 adversaries is: 43.273212532137734. distance: 1.4568079554883664
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0502, Accuracy: 9749/9900 (98.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4829/5066 (95.3218%), train_poison_data_count: 400
Global model norm: 43.290767793744145.
Norm before scaling: 43.27369067559988. Distance: 1.5147398890932091
Total norm for 4 adversaries is: 43.27369067559988. distance: 1.5147398890932091
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0529, Accuracy: 9763/9900 (98.6162%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4641/5116 (90.7154%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4548/5116 (88.8976%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0987, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5193/5582 (93.0312%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5057/5582 (90.5948%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0831, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4402/4928 (89.3263%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4445/4928 (90.1989%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0615, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3839/4126 (93.0441%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3816/4126 (92.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7771, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3703/4158 (89.0572%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3682/4158 (88.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9340, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4546/5063 (89.7887%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4386/5063 (86.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1163, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5479/6124 (89.4677%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5452/6124 (89.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9593, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3985/4354 (91.5250%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3778/4354 (86.7708%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3317, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4580/5025 (91.1443%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4582/5025 (91.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0808, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4335/4679 (92.6480%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4119/4679 (88.0316%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2568, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4400/4793 (91.8005%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4391/4793 (91.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8885, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4171/4518 (92.3196%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4172/4518 (92.3417%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9825, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4731/5167 (91.5618%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4688/5167 (90.7296%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1518, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4149/4433 (93.5935%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4042/4433 (91.1798%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9192, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4143/4503 (92.0053%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4086/4503 (90.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1016, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4345/4707 (92.3093%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4296/4707 (91.2683%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9567, Accuracy: 5597/10000 (55.9700%)
time spent on training: 264.567485332489
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1835, Accuracy: 6930/10000 (69.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.4334, Accuracy: 8800/9900 (88.8889%)
Done in 292.0804440975189 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4675/4885 (95.7011%), train_poison_data_count: 385
Global model norm: 43.31420930294195.
Norm before scaling: 43.29501275993359. Distance: 1.4318332100226803
Total norm for 4 adversaries is: 43.29501275993359. distance: 1.4318332100226803
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2168, Accuracy: 9366/9900 (94.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5008/5305 (94.4015%), train_poison_data_count: 415
Global model norm: 43.31420930294195.
Norm before scaling: 43.2953271331041. Distance: 1.5765571737813817
Total norm for 4 adversaries is: 43.2953271331041. distance: 1.5765571737813817
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1194, Accuracy: 9581/9900 (96.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4497/4717 (95.3360%), train_poison_data_count: 370
Global model norm: 43.31420930294195.
Norm before scaling: 43.29209588835184. Distance: 1.364028900536689
Total norm for 4 adversaries is: 43.29209588835184. distance: 1.364028900536689
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0900, Accuracy: 9663/9900 (97.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4842/5066 (95.5784%), train_poison_data_count: 400
Global model norm: 43.31420930294195.
Norm before scaling: 43.297202046761925. Distance: 1.496714968478934
Total norm for 4 adversaries is: 43.297202046761925. distance: 1.496714968478934
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1881, Accuracy: 9419/9900 (95.1414%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3392/3704 (91.5767%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3392/3704 (91.5767%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8819, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4908/5392 (91.0237%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4794/5392 (88.9095%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2102, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4068/4362 (93.2600%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4063/4362 (93.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8586, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4213/4538 (92.8383%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4255/4538 (93.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8324, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3852/4184 (92.0650%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3809/4184 (91.0373%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.7733, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3472/3756 (92.4388%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3490/3756 (92.9180%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9467, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4316/4679 (92.2419%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4137/4679 (88.4163%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1798, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3237/3472 (93.2316%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3215/3472 (92.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1065, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5701/6391 (89.2036%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5569/6391 (87.1382%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1852, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4777/5265 (90.7312%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4531/5265 (86.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1790, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5280/5902 (89.4612%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5148/5902 (87.2247%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2927, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5441/6124 (88.8472%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5372/6124 (87.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0673, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4637/5083 (91.2257%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4615/5083 (90.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0325, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4127/4465 (92.4300%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4128/4465 (92.4524%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8692, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3500/3804 (92.0084%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3521/3804 (92.5605%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9232, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4536/4918 (92.2326%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4466/4918 (90.8093%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0305, Accuracy: 5431/10000 (54.3100%)
time spent on training: 251.9080934524536
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1840, Accuracy: 6914/10000 (69.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.4295, Accuracy: 8803/9900 (88.9192%)
Done in 279.4053053855896 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4684/4885 (95.8854%), train_poison_data_count: 385
Global model norm: 43.337122668353.
Norm before scaling: 43.31669070184581. Distance: 1.411089305800991
Total norm for 4 adversaries is: 43.31669070184581. distance: 1.411089305800991
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1099, Accuracy: 9626/9900 (97.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5035/5305 (94.9105%), train_poison_data_count: 415
Global model norm: 43.337122668353.
Norm before scaling: 43.31852805725138. Distance: 1.5659652431621043
Total norm for 4 adversaries is: 43.31852805725138. distance: 1.5659652431621043
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0467, Accuracy: 9779/9900 (98.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4520/4717 (95.8236%), train_poison_data_count: 370
Global model norm: 43.337122668353.
Norm before scaling: 43.31533095230616. Distance: 1.2974705075713968
Total norm for 4 adversaries is: 43.31533095230616. distance: 1.2974705075713968
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0961, Accuracy: 9635/9900 (97.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4846/5066 (95.6573%), train_poison_data_count: 400
Global model norm: 43.337122668353.
Norm before scaling: 43.319066286177616. Distance: 1.4889552875361505
Total norm for 4 adversaries is: 43.319066286177616. distance: 1.4889552875361505
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1188, Accuracy: 9578/9900 (96.7475%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4231/4538 (93.2349%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4240/4538 (93.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9296, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4491/4989 (90.0180%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4483/4989 (89.8577%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9374, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4394/4793 (91.6754%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4429/4793 (92.4056%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8937, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3713/4158 (89.2977%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3699/4158 (88.9610%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9592, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3578/3861 (92.6703%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3497/3861 (90.5724%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0578, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4730/5232 (90.4052%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4682/5232 (89.4878%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2571, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4266/4663 (91.4862%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4356/4663 (93.4163%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8804, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4758/5197 (91.5528%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4661/5197 (89.6864%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0622, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4769/5167 (92.2973%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4699/5167 (90.9425%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1515, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4031/4416 (91.2817%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4011/4416 (90.8288%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8245, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4017/4354 (92.2600%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3664/4354 (84.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.4187, Accuracy: 4805/10000 (48.0500%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5017/5455 (91.9707%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4946/5455 (90.6691%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0577, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4149/4456 (93.1104%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4134/4456 (92.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8898, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2981/3271 (91.1342%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2988/3271 (91.3482%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8640, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3078/3297 (93.3576%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3067/3297 (93.0240%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7238, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5069/5591 (90.6636%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4903/5591 (87.6945%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2322, Accuracy: 5022/10000 (50.2200%)
time spent on training: 260.5543267726898
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1862, Accuracy: 6916/10000 (69.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3996, Accuracy: 8867/9900 (89.5657%)
Done in 288.46103858947754 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4664/4885 (95.4759%), train_poison_data_count: 385
Global model norm: 43.35865145792705.
Norm before scaling: 43.33905492325167. Distance: 1.4427828534248808
Total norm for 4 adversaries is: 43.33905492325167. distance: 1.4427828534248808
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0516, Accuracy: 9757/9900 (98.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5071/5305 (95.5891%), train_poison_data_count: 415
Global model norm: 43.35865145792705.
Norm before scaling: 43.33613538241282. Distance: 1.4873619143722052
Total norm for 4 adversaries is: 43.33613538241282. distance: 1.4873619143722052
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1332, Accuracy: 9551/9900 (96.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4524/4717 (95.9084%), train_poison_data_count: 370
Global model norm: 43.35865145792705.
Norm before scaling: 43.33758602304341. Distance: 1.389347861535875
Total norm for 4 adversaries is: 43.33758602304341. distance: 1.389347861535875
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0406, Accuracy: 9790/9900 (98.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4806/5066 (94.8677%), train_poison_data_count: 400
Global model norm: 43.35865145792705.
Norm before scaling: 43.34514828539421. Distance: 1.6111962096807073
Total norm for 4 adversaries is: 43.34514828539421. distance: 1.6111962096807073
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0627, Accuracy: 9743/9900 (98.4141%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4693/5167 (90.8264%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4736/5167 (91.6586%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1130, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3488/3775 (92.3974%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3541/3775 (93.8013%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8991, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4711/5195 (90.6833%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4680/5195 (90.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1897, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3788/4126 (91.8080%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3822/4126 (92.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8847, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3608/3911 (92.2526%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3454/3911 (88.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0936, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4117/4433 (92.8716%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4118/4433 (92.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8240, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2951/3271 (90.2171%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2908/3271 (88.9025%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9826, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3357/3590 (93.5097%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3255/3590 (90.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1391, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4508/4918 (91.6633%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4575/4918 (93.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0540, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4559/4986 (91.4360%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4532/4986 (90.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0642, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3274/3616 (90.5420%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3351/3616 (92.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8557, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3931/4295 (91.5250%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3905/4295 (90.9197%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8763, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4040/4356 (92.7456%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3889/4356 (89.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1304, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4449/4793 (92.8229%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4430/4793 (92.4265%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9100, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4004/4315 (92.7926%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3959/4315 (91.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8937, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4386/4804 (91.2989%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4378/4804 (91.1324%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0649, Accuracy: 5463/10000 (54.6300%)
time spent on training: 257.5643103122711
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1896, Accuracy: 6927/10000 (69.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.3802, Accuracy: 8911/9900 (90.0101%)
Done in 284.9530873298645 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4690/4885 (96.0082%), train_poison_data_count: 385
Global model norm: 43.37844316079921.
Norm before scaling: 43.354494376214184. Distance: 1.3496508888672167
Total norm for 4 adversaries is: 43.354494376214184. distance: 1.3496508888672167
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1058, Accuracy: 9631/9900 (97.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5060/5305 (95.3817%), train_poison_data_count: 415
Global model norm: 43.37844316079921.
Norm before scaling: 43.35630619770756. Distance: 1.4997131550226606
Total norm for 4 adversaries is: 43.35630619770756. distance: 1.4997131550226606
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0293, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4503/4717 (95.4632%), train_poison_data_count: 370
Global model norm: 43.37844316079921.
Norm before scaling: 43.355229250002964. Distance: 1.3543171676730645
Total norm for 4 adversaries is: 43.355229250002964. distance: 1.3543171676730645
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0272, Accuracy: 9822/9900 (99.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4827/5066 (95.2823%), train_poison_data_count: 400
Global model norm: 43.37844316079921.
Norm before scaling: 43.35958051753096. Distance: 1.502924135233815
Total norm for 4 adversaries is: 43.35958051753096. distance: 1.502924135233815
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0944, Accuracy: 9657/9900 (97.5455%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4166/4503 (92.5161%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4066/4503 (90.2954%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0196, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4438/4934 (89.9473%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4296/4934 (87.0693%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2778, Accuracy: 4994/10000 (49.9400%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4406/4804 (91.7152%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4162/4804 (86.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3356, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4113/4456 (92.3025%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4141/4456 (92.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8313, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4264/4651 (91.6792%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4244/4651 (91.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1222, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3863/4184 (92.3279%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3827/4184 (91.4675%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9689, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4351/4928 (88.2914%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4414/4928 (89.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0159, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3497/3775 (92.6358%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3561/3775 (94.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0088, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4611/5083 (90.7141%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4527/5083 (89.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1474, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5008/5455 (91.8057%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4892/5455 (89.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2298, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3344/3638 (91.9186%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3373/3638 (92.7158%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8839, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3570/3911 (91.2810%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3494/3911 (89.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1364, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3562/3837 (92.8329%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3583/3837 (93.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8254, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4132/4501 (91.8018%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4109/4501 (91.2908%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0763, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4790/5197 (92.1686%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4712/5197 (90.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2262, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3560/3861 (92.2041%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3518/3861 (91.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8813, Accuracy: 5725/10000 (57.2500%)
time spent on training: 253.79277515411377
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.2018, Accuracy: 6886/10000 (68.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.3300, Accuracy: 9027/9900 (91.1818%)
Done in 281.43710064888 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4684/4885 (95.8854%), train_poison_data_count: 385
Global model norm: 43.39961674252939.
Norm before scaling: 43.37752857588319. Distance: 1.3802082517611882
Total norm for 4 adversaries is: 43.37752857588319. distance: 1.3802082517611882
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1083, Accuracy: 9606/9900 (97.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5068/5305 (95.5325%), train_poison_data_count: 415
Global model norm: 43.39961674252939.
Norm before scaling: 43.37622561083649. Distance: 1.4954051532162196
Total norm for 4 adversaries is: 43.37622561083649. distance: 1.4954051532162196
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0580, Accuracy: 9756/9900 (98.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4534/4717 (96.1204%), train_poison_data_count: 370
Global model norm: 43.39961674252939.
Norm before scaling: 43.37506613602667. Distance: 1.2699445315885918
Total norm for 4 adversaries is: 43.37506613602667. distance: 1.2699445315885918
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0880, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4833/5066 (95.4007%), train_poison_data_count: 400
Global model norm: 43.39961674252939.
Norm before scaling: 43.38471387986211. Distance: 1.5215566909312486
Total norm for 4 adversaries is: 43.38471387986211. distance: 1.5215566909312486
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0586, Accuracy: 9750/9900 (98.4848%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2979/3271 (91.0731%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3006/3271 (91.8985%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9881, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4048/4511 (89.7362%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4042/4511 (89.6032%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0480, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3317/3638 (91.1765%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3370/3638 (92.6333%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9054, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5191/5582 (92.9953%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5108/5582 (91.5084%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0110, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4139/4456 (92.8860%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4139/4456 (92.8860%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9927, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5338/5902 (90.4439%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5059/5902 (85.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1897, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4007/4416 (90.7382%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4028/4416 (91.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8359, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4469/4934 (90.5756%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4338/4934 (87.9206%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.4482, Accuracy: 4859/10000 (48.5900%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4220/4596 (91.8190%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4308/4596 (93.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9954, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3555/3837 (92.6505%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3557/3837 (92.7026%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9943, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5755/6391 (90.0485%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5559/6391 (86.9817%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1993, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3974/4368 (90.9799%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3918/4368 (89.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0660, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3514/3804 (92.3764%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3496/3804 (91.9033%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8330, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5718/6263 (91.2981%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5659/6263 (90.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1411, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4443/4793 (92.6977%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4406/4793 (91.9257%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0361, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4949/5424 (91.2426%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4959/5424 (91.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2853, Accuracy: 5038/10000 (50.3800%)
time spent on training: 263.54152154922485
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.2070, Accuracy: 6885/10000 (68.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.3091, Accuracy: 9064/9900 (91.5556%)
Done in 291.1098494529724 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4710/4885 (96.4176%), train_poison_data_count: 385
Global model norm: 43.42175270988537.
Norm before scaling: 43.39953939307709. Distance: 1.3690783694666033
Total norm for 4 adversaries is: 43.39953939307709. distance: 1.3690783694666033
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0822, Accuracy: 9687/9900 (97.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5065/5305 (95.4760%), train_poison_data_count: 415
Global model norm: 43.42175270988537.
Norm before scaling: 43.40099213340707. Distance: 1.513860166590246
Total norm for 4 adversaries is: 43.40099213340707. distance: 1.513860166590246
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1959, Accuracy: 9438/9900 (95.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4525/4717 (95.9296%), train_poison_data_count: 370
Global model norm: 43.42175270988537.
Norm before scaling: 43.39849586517227. Distance: 1.3233687561988996
Total norm for 4 adversaries is: 43.39849586517227. distance: 1.3233687561988996
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0654, Accuracy: 9738/9900 (98.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4835/5066 (95.4402%), train_poison_data_count: 400
Global model norm: 43.42175270988537.
Norm before scaling: 43.402084820857105. Distance: 1.4949529297221906
Total norm for 4 adversaries is: 43.402084820857105. distance: 1.4949529297221906
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1153, Accuracy: 9565/9900 (96.6162%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4655/5055 (92.0870%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4651/5055 (92.0079%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9941, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3868/4184 (92.4474%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3835/4184 (91.6587%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8514, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3587/3861 (92.9034%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3550/3861 (91.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8757, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4345/4804 (90.4455%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0131, Accuracy: 3675/4804 (76.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.6518, Accuracy: 4380/10000 (43.8000%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3218/3472 (92.6843%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0188, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3625/3969 (91.3328%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3604/3969 (90.8037%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8894, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4518/4989 (90.5592%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4454/4989 (89.2764%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9469, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5181/5582 (92.8162%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5119/5582 (91.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0123, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4436/4793 (92.5516%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4448/4793 (92.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0808, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4250/4662 (91.1626%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4244/4662 (91.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0847, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4444/4934 (90.0689%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4307/4934 (87.2923%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2565, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4587/4986 (91.9976%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4592/4986 (92.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9879, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4116/4433 (92.8491%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4031/4433 (90.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8746, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4259/4716 (90.3096%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4265/4716 (90.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0216, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4228/4596 (91.9930%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4253/4596 (92.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1383, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4013/4354 (92.1681%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3661/4354 (84.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2255, Accuracy: 5058/10000 (50.5800%)
time spent on training: 259.1814835071564
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.2069, Accuracy: 6896/10000 (68.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3103, Accuracy: 9063/9900 (91.5455%)
Done in 286.636798620224 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4704/4885 (96.2948%), train_poison_data_count: 385
Global model norm: 43.44387458845968.
Norm before scaling: 43.42178785075817. Distance: 1.3660683983591988
Total norm for 4 adversaries is: 43.42178785075817. distance: 1.3660683983591988
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0216, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5053/5305 (95.2498%), train_poison_data_count: 415
Global model norm: 43.44387458845968.
Norm before scaling: 43.42045810030826. Distance: 1.4994405656911791
Total norm for 4 adversaries is: 43.42045810030826. distance: 1.4994405656911791
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0329, Accuracy: 9823/9900 (99.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4513/4717 (95.6752%), train_poison_data_count: 370
Global model norm: 43.44387458845968.
Norm before scaling: 43.422580621290805. Distance: 1.3712456339207622
Total norm for 4 adversaries is: 43.422580621290805. distance: 1.3712456339207622
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1053, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4845/5066 (95.6376%), train_poison_data_count: 400
Global model norm: 43.44387458845968.
Norm before scaling: 43.42570658247831. Distance: 1.4984754921529033
Total norm for 4 adversaries is: 43.42570658247831. distance: 1.4984754921529033
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0905, Accuracy: 9653/9900 (97.5051%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4699/5116 (91.8491%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4592/5116 (89.7576%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0432, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4305/4662 (92.3423%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4301/4662 (92.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9811, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5331/5902 (90.3253%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5149/5902 (87.2416%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3439, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4594/5063 (90.7367%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4587/5063 (90.5985%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0168, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4003/4354 (91.9384%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0223, Accuracy: 2721/4354 (62.4943%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 3.0964, Accuracy: 3656/10000 (36.5600%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4705/5195 (90.5679%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4601/5195 (88.5659%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0567, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4066/4356 (93.3425%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3658/4356 (83.9761%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.5124, Accuracy: 4627/10000 (46.2700%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3981/4295 (92.6892%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3939/4295 (91.7113%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0845, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5769/6263 (92.1124%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5679/6263 (90.6754%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0394, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4102/4511 (90.9333%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4097/4511 (90.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9313, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4320/4663 (92.6442%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4334/4663 (92.9445%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9000, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3973/4336 (91.6282%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3982/4336 (91.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1060, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4375/4928 (88.7784%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4417/4928 (89.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1393, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3769/4046 (93.1537%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3808/4046 (94.1176%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9696, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3361/3672 (91.5305%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3359/3672 (91.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.7753, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4018/4356 (92.2406%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4042/4356 (92.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0358, Accuracy: 5489/10000 (54.8900%)
time spent on training: 263.2010552883148
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2074, Accuracy: 6895/10000 (68.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2882, Accuracy: 9121/9900 (92.1313%)
Done in 290.87997460365295 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4714/4885 (96.4995%), train_poison_data_count: 385
Global model norm: 43.46704817840464.
Norm before scaling: 43.44256658850712. Distance: 1.3171088723531816
Total norm for 4 adversaries is: 43.44256658850712. distance: 1.3171088723531816
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0732, Accuracy: 9715/9900 (98.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5068/5305 (95.5325%), train_poison_data_count: 415
Global model norm: 43.46704817840464.
Norm before scaling: 43.44748789172468. Distance: 1.555272514652456
Total norm for 4 adversaries is: 43.44748789172468. distance: 1.555272514652456
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0388, Accuracy: 9817/9900 (99.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4495/4717 (95.2936%), train_poison_data_count: 370
Global model norm: 43.46704817840464.
Norm before scaling: 43.44559839076049. Distance: 1.3839269339204585
Total norm for 4 adversaries is: 43.44559839076049. distance: 1.3839269339204585
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1284, Accuracy: 9567/9900 (96.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4832/5066 (95.3810%), train_poison_data_count: 400
Global model norm: 43.46704817840464.
Norm before scaling: 43.44754970300756. Distance: 1.5157313358718771
Total norm for 4 adversaries is: 43.44754970300756. distance: 1.5157313358718771
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0439, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4550/5037 (90.3315%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4663/5037 (92.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9565, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4242/4647 (91.2847%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4242/4647 (91.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0056, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4345/4663 (93.1804%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4242/4663 (90.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1304, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3994/4336 (92.1125%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3954/4336 (91.1900%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1817, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3524/3756 (93.8232%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3561/3756 (94.8083%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8743, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4171/4625 (90.1838%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4103/4625 (88.7135%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2026, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4059/4362 (93.0536%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4091/4362 (93.7873%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0699, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4420/4874 (90.6853%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4407/4874 (90.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1744, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4312/4767 (90.4552%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4293/4767 (90.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1492, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3510/3775 (92.9801%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3561/3775 (94.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8136, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4334/4662 (92.9644%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4216/4662 (90.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0071, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5524/6124 (90.2025%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5423/6124 (88.5532%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8756, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4097/4511 (90.8224%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4109/4511 (91.0885%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0568, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3645/3911 (93.1987%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3560/3911 (91.0253%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8334, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5051/5591 (90.3416%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4996/5591 (89.3579%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1925, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3811/4126 (92.3655%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3831/4126 (92.8502%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8094, Accuracy: 5766/10000 (57.6600%)
time spent on training: 260.4664189815521
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2081, Accuracy: 6888/10000 (68.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2836, Accuracy: 9137/9900 (92.2929%)
Done in 288.1536138057709 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4696/4885 (96.1310%), train_poison_data_count: 385
Global model norm: 43.487763185464026.
Norm before scaling: 43.46548390407755. Distance: 1.3994960508001226
Total norm for 4 adversaries is: 43.46548390407755. distance: 1.3994960508001226
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0156, Accuracy: 9860/9900 (99.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5067/5305 (95.5137%), train_poison_data_count: 415
Global model norm: 43.487763185464026.
Norm before scaling: 43.467616863825334. Distance: 1.5532916526495975
Total norm for 4 adversaries is: 43.467616863825334. distance: 1.5532916526495975
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0134, Accuracy: 9866/9900 (99.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4516/4717 (95.7388%), train_poison_data_count: 370
Global model norm: 43.487763185464026.
Norm before scaling: 43.46539543804862. Distance: 1.3456983413943462
Total norm for 4 adversaries is: 43.46539543804862. distance: 1.3456983413943462
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0205, Accuracy: 9839/9900 (99.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4834/5066 (95.4205%), train_poison_data_count: 400
Global model norm: 43.487763185464026.
Norm before scaling: 43.469366402441246. Distance: 1.4888102875232652
Total norm for 4 adversaries is: 43.469366402441246. distance: 1.4888102875232652
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0446, Accuracy: 9764/9900 (98.6263%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4629/5025 (92.1194%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4594/5025 (91.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0501, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4674/5116 (91.3604%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4617/5116 (90.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0885, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4720/5167 (91.3489%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4685/5167 (90.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1159, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4167/4558 (91.4217%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4085/4558 (89.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0795, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4274/4651 (91.8942%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4233/4651 (91.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0487, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4033/4336 (93.0120%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3978/4336 (91.7435%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0620, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4653/5055 (92.0475%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4648/5055 (91.9486%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9616, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3544/3775 (93.8808%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3565/3775 (94.4371%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8262, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4766/5265 (90.5223%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4728/5265 (89.8006%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9228, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3732/4025 (92.7205%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3771/4025 (93.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8857, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4550/4989 (91.2006%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4502/4989 (90.2385%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9371, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4458/4793 (93.0106%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4431/4793 (92.4473%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8835, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3523/3804 (92.6130%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3536/3804 (92.9548%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8642, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3515/3797 (92.5731%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3513/3797 (92.5204%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9703, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4134/4433 (93.2551%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4103/4433 (92.5558%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9037, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4355/4707 (92.5218%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4323/4707 (91.8419%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9116, Accuracy: 5599/10000 (55.9900%)
time spent on training: 260.7058126926422
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2145, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.2740, Accuracy: 9159/9900 (92.5152%)
Done in 288.1480824947357 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4720/4885 (96.6223%), train_poison_data_count: 385
Global model norm: 43.50840379940265.
Norm before scaling: 43.48382758818214. Distance: 1.3018064382504366
Total norm for 4 adversaries is: 43.48382758818214. distance: 1.3018064382504366
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0737, Accuracy: 9705/9900 (98.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5077/5305 (95.7022%), train_poison_data_count: 415
Global model norm: 43.50840379940265.
Norm before scaling: 43.48340649747901. Distance: 1.4579983281046174
Total norm for 4 adversaries is: 43.48340649747901. distance: 1.4579983281046174
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0437, Accuracy: 9779/9900 (98.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4526/4717 (95.9508%), train_poison_data_count: 370
Global model norm: 43.50840379940265.
Norm before scaling: 43.48369564686717. Distance: 1.3145778194418656
Total norm for 4 adversaries is: 43.48369564686717. distance: 1.3145778194418656
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1708, Accuracy: 9457/9900 (95.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4845/5066 (95.6376%), train_poison_data_count: 400
Global model norm: 43.50840379940265.
Norm before scaling: 43.48796809625192. Distance: 1.4503403921800864
Total norm for 4 adversaries is: 43.48796809625192. distance: 1.4503403921800864
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0737, Accuracy: 9709/9900 (98.0707%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4951/5392 (91.8212%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4855/5392 (90.0408%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0543, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4282/4663 (91.8293%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4315/4663 (92.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0279, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3527/3797 (92.8891%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3460/3797 (91.1246%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0170, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5170/5582 (92.6191%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5092/5582 (91.2218%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1129, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4740/5167 (91.7360%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4703/5167 (91.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3081, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3501/3781 (92.5946%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3328/3781 (88.0190%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1804, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3685/3969 (92.8445%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3679/3969 (92.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9385, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3538/3837 (92.2075%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3585/3837 (93.4324%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9044, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5339/5902 (90.4609%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5170/5902 (87.5974%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2968, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5003/5455 (91.7140%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4863/5455 (89.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9658, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4542/5037 (90.1727%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4507/5037 (89.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9704, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4604/5017 (91.7680%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4584/5017 (91.3693%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9758, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4542/4986 (91.0951%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4497/4986 (90.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9178, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4754/5197 (91.4759%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4687/5197 (90.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0765, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3986/4361 (91.4011%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3791/4361 (86.9296%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2874, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5772/6263 (92.1603%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5694/6263 (90.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1452, Accuracy: 5347/10000 (53.4700%)
time spent on training: 265.2280101776123
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2080, Accuracy: 6881/10000 (68.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2778, Accuracy: 9150/9900 (92.4242%)
Done in 292.88537096977234 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4724/4885 (96.7042%), train_poison_data_count: 385
Global model norm: 43.5315696775771.
Norm before scaling: 43.50410670045631. Distance: 1.2844774488442199
Total norm for 4 adversaries is: 43.50410670045631. distance: 1.2844774488442199
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1014, Accuracy: 9623/9900 (97.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5095/5305 (96.0415%), train_poison_data_count: 415
Global model norm: 43.5315696775771.
Norm before scaling: 43.50926793781269. Distance: 1.5017538943061612
Total norm for 4 adversaries is: 43.50926793781269. distance: 1.5017538943061612
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0419, Accuracy: 9794/9900 (98.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4510/4717 (95.6116%), train_poison_data_count: 370
Global model norm: 43.5315696775771.
Norm before scaling: 43.50685223509338. Distance: 1.3064990230634024
Total norm for 4 adversaries is: 43.50685223509338. distance: 1.3064990230634024
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0448, Accuracy: 9789/9900 (98.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4867/5066 (96.0719%), train_poison_data_count: 400
Global model norm: 43.5315696775771.
Norm before scaling: 43.5085019978136. Distance: 1.4207052931980122
Total norm for 4 adversaries is: 43.5085019978136. distance: 1.4207052931980122
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0767, Accuracy: 9689/9900 (97.8687%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4622/5017 (92.1268%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4607/5017 (91.8278%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7642, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4447/4928 (90.2394%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4441/4928 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0256, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3906/4184 (93.3556%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3816/4184 (91.2046%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9445, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4468/4793 (93.2193%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4427/4793 (92.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9428, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5262/5740 (91.6725%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5174/5740 (90.1394%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0339, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3511/3756 (93.4771%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3558/3756 (94.7284%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8425, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3951/4235 (93.2940%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3847/4235 (90.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8967, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3879/4223 (91.8541%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3877/4223 (91.8068%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7883, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4545/5063 (89.7689%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4267/5063 (84.2781%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2214, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4546/4989 (91.1205%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4469/4989 (89.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9043, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4538/4928 (92.0860%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4499/4928 (91.2946%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0029, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5306/5902 (89.9017%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5090/5902 (86.2420%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2935, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4171/4456 (93.6041%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4171/4456 (93.6041%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8813, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5515/6124 (90.0555%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5397/6124 (88.1287%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0330, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3580/3828 (93.5214%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3609/3828 (94.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7566, Accuracy: 5943/10000 (59.4300%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3347/3616 (92.5608%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3332/3616 (92.1460%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8244, Accuracy: 5760/10000 (57.6000%)
time spent on training: 260.33321142196655
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2118, Accuracy: 6887/10000 (68.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2526, Accuracy: 9210/9900 (93.0303%)
Done in 288.7167613506317 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4717/4885 (96.5609%), train_poison_data_count: 385
Global model norm: 43.55354608930397.
Norm before scaling: 43.52860135292872. Distance: 1.3434176810329597
Total norm for 4 adversaries is: 43.52860135292872. distance: 1.3434176810329597
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1106, Accuracy: 9607/9900 (97.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5058/5305 (95.3440%), train_poison_data_count: 415
Global model norm: 43.55354608930397.
Norm before scaling: 43.531395818133376. Distance: 1.5119815568404622
Total norm for 4 adversaries is: 43.531395818133376. distance: 1.5119815568404622
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1064, Accuracy: 9616/9900 (97.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4555/4717 (96.5656%), train_poison_data_count: 370
Global model norm: 43.55354608930397.
Norm before scaling: 43.52998668976293. Distance: 1.3005554644773694
Total norm for 4 adversaries is: 43.52998668976293. distance: 1.3005554644773694
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0514, Accuracy: 9769/9900 (98.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4861/5066 (95.9534%), train_poison_data_count: 400
Global model norm: 43.55354608930397.
Norm before scaling: 43.53051248926579. Distance: 1.4388480292761736
Total norm for 4 adversaries is: 43.53051248926579. distance: 1.4388480292761736
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0571, Accuracy: 9757/9900 (98.5556%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3851/4223 (91.1911%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3863/4223 (91.4753%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9427, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4102/4362 (94.0394%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3965/4362 (90.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1100, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5770/6391 (90.2832%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5554/6391 (86.9035%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2279, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4405/4793 (91.9049%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4369/4793 (91.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1635, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3513/3756 (93.5304%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3547/3756 (94.4356%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9640, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4292/4618 (92.9407%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4191/4618 (90.7536%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0485, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3717/4025 (92.3478%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3756/4025 (93.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8078, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3307/3638 (90.9016%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3349/3638 (92.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8650, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4039/4315 (93.6037%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4021/4315 (93.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8706, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3967/4295 (92.3632%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3687/4295 (85.8440%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2002, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4526/4928 (91.8425%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4464/4928 (90.5844%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9285, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4584/4986 (91.9374%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4558/4986 (91.4160%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9450, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3835/4126 (92.9472%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3787/4126 (91.7838%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8975, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4546/4918 (92.4359%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4493/4918 (91.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.3979, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4716/5195 (90.7796%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4556/5195 (87.6997%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.3306, Accuracy: 4989/10000 (49.8900%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5232/5740 (91.1498%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5199/5740 (90.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2079, Accuracy: 5274/10000 (52.7400%)
time spent on training: 261.603892326355
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2112, Accuracy: 6885/10000 (68.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2504, Accuracy: 9216/9900 (93.0909%)
Done in 289.4475326538086 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4704/4885 (96.2948%), train_poison_data_count: 385
Global model norm: 43.5751458398126.
Norm before scaling: 43.550265330438144. Distance: 1.3708387175727703
Total norm for 4 adversaries is: 43.550265330438144. distance: 1.3708387175727703
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0332, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5071/5305 (95.5891%), train_poison_data_count: 415
Global model norm: 43.5751458398126.
Norm before scaling: 43.551844778307036. Distance: 1.4780836393928773
Total norm for 4 adversaries is: 43.551844778307036. distance: 1.4780836393928773
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0956, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4529/4717 (96.0144%), train_poison_data_count: 370
Global model norm: 43.5751458398126.
Norm before scaling: 43.550872170335175. Distance: 1.3009486276891533
Total norm for 4 adversaries is: 43.550872170335175. distance: 1.3009486276891533
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1042, Accuracy: 9647/9900 (97.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4840/5066 (95.5389%), train_poison_data_count: 400
Global model norm: 43.5751458398126.
Norm before scaling: 43.55388382106052. Distance: 1.4730997808965756
Total norm for 4 adversaries is: 43.55388382106052. distance: 1.4730997808965756
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0920, Accuracy: 9663/9900 (97.6061%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3060/3297 (92.8116%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3079/3297 (93.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7887, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3577/3828 (93.4431%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3546/3828 (92.6332%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8688, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4566/5063 (90.1837%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4387/5063 (86.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0703, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4117/4501 (91.4686%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4071/4501 (90.4466%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1803, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4430/4793 (92.4265%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4400/4793 (91.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2513, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3887/4223 (92.0436%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3933/4223 (93.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9440, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3556/3756 (94.6752%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3583/3756 (95.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7361, Accuracy: 5967/10000 (59.6700%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3338/3638 (91.7537%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3380/3638 (92.9082%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8314, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3339/3646 (91.5798%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3362/3646 (92.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9818, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4437/4874 (91.0341%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4344/4874 (89.1260%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2023, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5746/6263 (91.7452%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5689/6263 (90.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0522, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4532/5037 (89.9742%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4537/5037 (90.0735%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9985, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4094/4362 (93.8560%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4035/4362 (92.5034%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9086, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4038/4356 (92.6997%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3844/4356 (88.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0924, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4675/5116 (91.3800%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4558/5116 (89.0930%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8468, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4064/4346 (93.5113%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4069/4346 (93.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8459, Accuracy: 5778/10000 (57.7800%)
time spent on training: 259.2081160545349
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2128, Accuracy: 6878/10000 (68.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2349, Accuracy: 9262/9900 (93.5556%)
Done in 286.7131190299988 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4712/4885 (96.4585%), train_poison_data_count: 385
Global model norm: 43.59520046870125.
Norm before scaling: 43.56911686431041. Distance: 1.306115334244948
Total norm for 4 adversaries is: 43.56911686431041. distance: 1.306115334244948
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1272, Accuracy: 9589/9900 (96.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5074/5305 (95.6456%), train_poison_data_count: 415
Global model norm: 43.59520046870125.
Norm before scaling: 43.569951781499455. Distance: 1.4586319299818153
Total norm for 4 adversaries is: 43.569951781499455. distance: 1.4586319299818153
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0950, Accuracy: 9654/9900 (97.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4548/4717 (96.4172%), train_poison_data_count: 370
Global model norm: 43.59520046870125.
Norm before scaling: 43.56937322481384. Distance: 1.2789698058912136
Total norm for 4 adversaries is: 43.56937322481384. distance: 1.2789698058912136
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0786, Accuracy: 9697/9900 (97.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4845/5066 (95.6376%), train_poison_data_count: 400
Global model norm: 43.59520046870125.
Norm before scaling: 43.57269596874142. Distance: 1.458044277790395
Total norm for 4 adversaries is: 43.57269596874142. distance: 1.458044277790395
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1340, Accuracy: 9525/9900 (96.2121%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4172/4518 (92.3417%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4147/4518 (91.7884%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8946, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4169/4558 (91.4656%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4059/4558 (89.0522%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.3090, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3536/3804 (92.9548%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3515/3804 (92.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9628, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3525/3775 (93.3775%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3589/3775 (95.0728%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7156, Accuracy: 6024/10000 (60.2400%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4663/5083 (91.7372%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4576/5083 (90.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1032, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4591/4928 (93.1615%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4513/4928 (91.5787%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8805, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4680/5244 (89.2449%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4549/5244 (86.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1803, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4509/4989 (90.3788%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4482/4989 (89.8376%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1396, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4604/4986 (92.3385%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4547/4986 (91.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9310, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3844/4175 (92.0719%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3779/4175 (90.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0202, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4768/5232 (91.1315%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4691/5232 (89.6598%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0819, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4571/5063 (90.2824%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4369/5063 (86.2927%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.3083, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4155/4441 (93.5600%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4115/4441 (92.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9523, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3337/3646 (91.5250%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3395/3646 (93.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8189, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4745/5167 (91.8328%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4759/5167 (92.1037%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0566, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4233/4538 (93.2790%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4187/4538 (92.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8527, Accuracy: 5699/10000 (56.9900%)
time spent on training: 261.80579352378845
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2139, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2318, Accuracy: 9267/9900 (93.6061%)
Done in 289.31770515441895 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4720/4885 (96.6223%), train_poison_data_count: 385
Global model norm: 43.61660187341943.
Norm before scaling: 43.591441191100664. Distance: 1.327767088291513
Total norm for 4 adversaries is: 43.591441191100664. distance: 1.327767088291513
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0849, Accuracy: 9678/9900 (97.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5085/5305 (95.8530%), train_poison_data_count: 415
Global model norm: 43.61660187341943.
Norm before scaling: 43.59090492508156. Distance: 1.4494530007781707
Total norm for 4 adversaries is: 43.59090492508156. distance: 1.4494530007781707
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0540, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4500/4717 (95.3996%), train_poison_data_count: 370
Global model norm: 43.61660187341943.
Norm before scaling: 43.593539986053266. Distance: 1.3784653172078485
Total norm for 4 adversaries is: 43.593539986053266. distance: 1.3784653172078485
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0214, Accuracy: 9839/9900 (99.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4860/5066 (95.9337%), train_poison_data_count: 400
Global model norm: 43.61660187341943.
Norm before scaling: 43.59275592504591. Distance: 1.401603992405087
Total norm for 4 adversaries is: 43.59275592504591. distance: 1.401603992405087
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0483, Accuracy: 9776/9900 (98.7475%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4093/4356 (93.9624%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3861/4356 (88.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3001, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4478/4928 (90.8685%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4391/4928 (89.1031%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0946, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4603/5037 (91.3838%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4591/5037 (91.1455%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0981, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4373/4804 (91.0283%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4197/4804 (87.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2558, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3551/3775 (94.0662%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3600/3775 (95.3642%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7442, Accuracy: 5969/10000 (59.6900%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4757/5167 (92.0650%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4735/5167 (91.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1532, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3916/4235 (92.4675%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3928/4235 (92.7509%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9691, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4511/4956 (91.0210%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4339/4956 (87.5504%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0419, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5278/5740 (91.9512%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5229/5740 (91.0976%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1453, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4361/4679 (93.2037%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4279/4679 (91.4512%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0981, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3431/3704 (92.6296%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3436/3704 (92.7646%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8227, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3245/3472 (93.4620%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3230/3472 (93.0300%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9419, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4279/4651 (92.0017%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4255/4651 (91.4857%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9639, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4212/4634 (90.8934%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4184/4634 (90.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8563, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5346/5902 (90.5795%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5163/5902 (87.4788%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1615, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3551/3837 (92.5463%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3614/3837 (94.1882%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8380, Accuracy: 5807/10000 (58.0700%)
time spent on training: 261.474161863327
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2148, Accuracy: 6868/10000 (68.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.2201, Accuracy: 9302/9900 (93.9596%)
Done in 288.91300559043884 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4718/4885 (96.5814%), train_poison_data_count: 385
Global model norm: 43.63776619708982.
Norm before scaling: 43.610726981013514. Distance: 1.3073908956896099
Total norm for 4 adversaries is: 43.610726981013514. distance: 1.3073908956896099
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0754, Accuracy: 9700/9900 (97.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5072/5305 (95.6079%), train_poison_data_count: 415
Global model norm: 43.63776619708982.
Norm before scaling: 43.6135833579438. Distance: 1.4891512673209195
Total norm for 4 adversaries is: 43.6135833579438. distance: 1.4891512673209195
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0671, Accuracy: 9727/9900 (98.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4535/4717 (96.1416%), train_poison_data_count: 370
Global model norm: 43.63776619708982.
Norm before scaling: 43.61296059695157. Distance: 1.3332428106732523
Total norm for 4 adversaries is: 43.61296059695157. distance: 1.3332428106732523
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0210, Accuracy: 9842/9900 (99.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4855/5066 (95.8350%), train_poison_data_count: 400
Global model norm: 43.63776619708982.
Norm before scaling: 43.6169741005437. Distance: 1.4728650013424738
Total norm for 4 adversaries is: 43.6169741005437. distance: 1.4728650013424738
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0887, Accuracy: 9659/9900 (97.5657%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3666/3969 (92.3658%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3659/3969 (92.1895%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9272, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4323/4707 (91.8419%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4271/4707 (90.7372%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8519, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3613/3861 (93.5768%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3577/3861 (92.6444%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8144, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4226/4596 (91.9495%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4237/4596 (92.1889%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9689, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4179/4503 (92.8048%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4107/4503 (91.2059%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1607, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4592/4928 (93.1818%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4567/4928 (92.6745%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0054, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4613/5025 (91.8010%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4563/5025 (90.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1917, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4245/4576 (92.7666%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4227/4576 (92.3733%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9268, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4501/4918 (91.5209%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4514/4918 (91.7853%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0319, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4058/4315 (94.0440%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3984/4315 (92.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9884, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3348/3590 (93.2591%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3315/3590 (92.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8824, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4165/4456 (93.4695%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4164/4456 (93.4470%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9347, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4008/4354 (92.0533%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3721/4354 (85.4616%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.4494, Accuracy: 4795/10000 (47.9500%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4102/4501 (91.1353%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4062/4501 (90.2466%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0203, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3612/3911 (92.3549%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3528/3911 (90.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9914, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4211/4558 (92.3870%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4095/4558 (89.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0359, Accuracy: 5305/10000 (53.0500%)
time spent on training: 255.60115265846252
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2163, Accuracy: 6867/10000 (68.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2103, Accuracy: 9334/9900 (94.2828%)
Done in 283.256977558136 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4733/4885 (96.8884%), train_poison_data_count: 385
Global model norm: 43.65781023518301.
Norm before scaling: 43.63046309140338. Distance: 1.2755326897332444
Total norm for 4 adversaries is: 43.63046309140338. distance: 1.2755326897332444
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1142, Accuracy: 9604/9900 (97.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5082/5305 (95.7964%), train_poison_data_count: 415
Global model norm: 43.65781023518301.
Norm before scaling: 43.63214734833208. Distance: 1.4707183634461212
Total norm for 4 adversaries is: 43.63214734833208. distance: 1.4707183634461212
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1212, Accuracy: 9599/9900 (96.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4555/4717 (96.5656%), train_poison_data_count: 370
Global model norm: 43.65781023518301.
Norm before scaling: 43.6311261704123. Distance: 1.251887660464841
Total norm for 4 adversaries is: 43.6311261704123. distance: 1.251887660464841
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1010, Accuracy: 9634/9900 (97.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4836/5066 (95.4599%), train_poison_data_count: 400
Global model norm: 43.65781023518301.
Norm before scaling: 43.63708083979438. Distance: 1.484023685040104
Total norm for 4 adversaries is: 43.63708083979438. distance: 1.484023685040104
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0361, Accuracy: 9815/9900 (99.1414%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4698/5116 (91.8296%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4598/5116 (89.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.4561, Accuracy: 4995/10000 (49.9500%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5007/5392 (92.8598%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4832/5392 (89.6142%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0969, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4308/4767 (90.3713%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4273/4767 (89.6371%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1463, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4303/4618 (93.1789%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4167/4618 (90.2339%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9775, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3791/4046 (93.6975%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3795/4046 (93.7963%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9505, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4183/4625 (90.4432%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4159/4625 (89.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9573, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3340/3638 (91.8087%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3417/3638 (93.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8904, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4016/4416 (90.9420%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3998/4416 (90.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0574, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4438/4874 (91.0546%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4299/4874 (88.2027%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2435, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3380/3646 (92.7043%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3368/3646 (92.3752%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7838, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4608/5063 (91.0132%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4394/5063 (86.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2475, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3836/4126 (92.9714%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3845/4126 (93.1895%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8251, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4487/4934 (90.9404%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4368/4934 (88.5286%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2041, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4165/4511 (92.3299%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4128/4511 (91.5096%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1999, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4181/4518 (92.5409%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4212/4518 (93.2271%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8784, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3073/3297 (93.2059%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3080/3297 (93.4183%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.6945, Accuracy: 5989/10000 (59.8900%)
time spent on training: 258.44377970695496
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2161, Accuracy: 6848/10000 (68.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2036, Accuracy: 9355/9900 (94.4949%)
Done in 285.80110120773315 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4716/4885 (96.5404%), train_poison_data_count: 385
Global model norm: 43.678441758080865.
Norm before scaling: 43.65264978220466. Distance: 1.335960120294035
Total norm for 4 adversaries is: 43.65264978220466. distance: 1.335960120294035
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0272, Accuracy: 9837/9900 (99.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5071/5305 (95.5891%), train_poison_data_count: 415
Global model norm: 43.678441758080865.
Norm before scaling: 43.65427166464139. Distance: 1.4947524469881626
Total norm for 4 adversaries is: 43.65427166464139. distance: 1.4947524469881626
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0662, Accuracy: 9723/9900 (98.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4536/4717 (96.1628%), train_poison_data_count: 370
Global model norm: 43.678441758080865.
Norm before scaling: 43.65381167134778. Distance: 1.3002031204289464
Total norm for 4 adversaries is: 43.65381167134778. distance: 1.3002031204289464
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0803, Accuracy: 9679/9900 (97.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4874/5066 (96.2100%), train_poison_data_count: 400
Global model norm: 43.678441758080865.
Norm before scaling: 43.652357557324436. Distance: 1.3991331362876682
Total norm for 4 adversaries is: 43.652357557324436. distance: 1.3991331362876682
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1019, Accuracy: 9620/9900 (97.1717%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5561/6124 (90.8067%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5427/6124 (88.6185%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1663, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4595/5025 (91.4428%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4554/5025 (90.6269%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2249, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3242/3472 (93.3756%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3205/3472 (92.3099%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9672, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4629/5037 (91.8999%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4605/5037 (91.4235%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9536, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5213/5582 (93.3895%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5158/5582 (92.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1127, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4702/5116 (91.9077%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4592/5116 (89.7576%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1019, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4158/4518 (92.0319%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4181/4518 (92.5409%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0859, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4464/4928 (90.5844%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4459/4928 (90.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9348, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4178/4558 (91.6630%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4058/4558 (89.0303%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1407, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3071/3297 (93.1453%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3065/3297 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8324, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3529/3756 (93.9563%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3572/3756 (95.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9875, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4317/4651 (92.8187%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4251/4651 (91.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0442, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4114/4441 (92.6368%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4168/4441 (93.8527%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9473, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3308/3638 (90.9291%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3354/3638 (92.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8428, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4254/4596 (92.5587%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4239/4596 (92.2324%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1086, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3004/3271 (91.8374%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2972/3271 (90.8591%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8602, Accuracy: 5690/10000 (56.9000%)
time spent on training: 258.16044092178345
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2162, Accuracy: 6852/10000 (68.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1935, Accuracy: 9377/9900 (94.7172%)
Done in 285.6343038082123 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4730/4885 (96.8270%), train_poison_data_count: 385
Global model norm: 43.69820594858558.
Norm before scaling: 43.67194907194076. Distance: 1.3163081282544016
Total norm for 4 adversaries is: 43.67194907194076. distance: 1.3163081282544016
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0785, Accuracy: 9690/9900 (97.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5092/5305 (95.9849%), train_poison_data_count: 415
Global model norm: 43.69820594858558.
Norm before scaling: 43.670269145341464. Distance: 1.4175841595460046
Total norm for 4 adversaries is: 43.670269145341464. distance: 1.4175841595460046
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0255, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4522/4717 (95.8660%), train_poison_data_count: 370
Global model norm: 43.69820594858558.
Norm before scaling: 43.67236415200121. Distance: 1.3212664617056107
Total norm for 4 adversaries is: 43.67236415200121. distance: 1.3212664617056107
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0887, Accuracy: 9673/9900 (97.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4886/5066 (96.4469%), train_poison_data_count: 400
Global model norm: 43.69820594858558.
Norm before scaling: 43.67191832511268. Distance: 1.3539293765972615
Total norm for 4 adversaries is: 43.67191832511268. distance: 1.3539293765972615
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0838, Accuracy: 9685/9900 (97.8283%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4611/4989 (92.4233%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4506/4989 (90.3187%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0518, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4181/4465 (93.6394%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4177/4465 (93.5498%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8264, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4041/4315 (93.6501%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4001/4315 (92.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9072, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4337/4767 (90.9797%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4233/4767 (88.7980%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2748, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5753/6391 (90.0172%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5650/6391 (88.4056%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1462, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3395/3672 (92.4564%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3343/3672 (91.0403%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9445, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3689/3969 (92.9453%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3603/3969 (90.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9189, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3354/3590 (93.4262%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3185/3590 (88.7187%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2947, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5390/5902 (91.3250%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5134/5902 (86.9875%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3516, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3764/4013 (93.7952%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3783/4013 (94.2686%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7286, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4391/4804 (91.4030%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4034/4804 (83.9717%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4214, Accuracy: 4723/10000 (47.2300%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3844/4175 (92.0719%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3741/4175 (89.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9807, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3333/3616 (92.1737%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3346/3616 (92.5332%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8319, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3997/4361 (91.6533%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3821/4361 (87.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1869, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4972/5424 (91.6667%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4949/5424 (91.2426%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1393, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3577/3837 (93.2239%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3618/3837 (94.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9870, Accuracy: 5583/10000 (55.8300%)
time spent on training: 256.5576157569885
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2165, Accuracy: 6859/10000 (68.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1950, Accuracy: 9376/9900 (94.7071%)
Done in 284.27705240249634 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4741/4885 (97.0522%), train_poison_data_count: 385
Global model norm: 43.71915905142804.
Norm before scaling: 43.69088780006436. Distance: 1.2753638926299693
Total norm for 4 adversaries is: 43.69088780006436. distance: 1.2753638926299693
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1226, Accuracy: 9576/9900 (96.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5094/5305 (96.0226%), train_poison_data_count: 415
Global model norm: 43.71915905142804.
Norm before scaling: 43.69328354957716. Distance: 1.438857391353072
Total norm for 4 adversaries is: 43.69328354957716. distance: 1.438857391353072
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1103, Accuracy: 9618/9900 (97.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4564/4717 (96.7564%), train_poison_data_count: 370
Global model norm: 43.71915905142804.
Norm before scaling: 43.692854699113134. Distance: 1.2556840884032414
Total norm for 4 adversaries is: 43.692854699113134. distance: 1.2556840884032414
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1282, Accuracy: 9572/9900 (96.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4849/5066 (95.7165%), train_poison_data_count: 400
Global model norm: 43.71915905142804.
Norm before scaling: 43.696274210541254. Distance: 1.4447163770109557
Total norm for 4 adversaries is: 43.696274210541254. distance: 1.4447163770109557
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0453, Accuracy: 9779/9900 (98.7778%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3979/4416 (90.1042%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4010/4416 (90.8062%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8701, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5252/5740 (91.4983%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5209/5740 (90.7491%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0803, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4591/5037 (91.1455%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4638/5037 (92.0786%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0065, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4726/5116 (92.3769%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4635/5116 (90.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0261, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4532/4918 (92.1513%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4491/4918 (91.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9715, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3563/3837 (92.8590%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3603/3837 (93.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8655, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4312/4651 (92.7112%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4257/4651 (91.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0493, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3618/3861 (93.7063%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3570/3861 (92.4631%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9684, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3928/4223 (93.0144%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3948/4223 (93.4880%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8481, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4315/4662 (92.5568%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4320/4662 (92.6641%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9234, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5817/6263 (92.8788%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5713/6263 (91.2183%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0796, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3506/3781 (92.7268%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3260/3781 (86.2206%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2276, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3542/3804 (93.1125%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3524/3804 (92.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9912, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3607/3828 (94.2268%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3600/3828 (94.0439%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7686, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4041/4315 (93.6501%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4025/4315 (93.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8727, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4480/4956 (90.3955%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4419/4956 (89.1646%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9656, Accuracy: 5536/10000 (55.3600%)
time spent on training: 259.8550126552582
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2198, Accuracy: 6858/10000 (68.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1933, Accuracy: 9377/9900 (94.7172%)
Done in 287.87662649154663 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4719/4885 (96.6018%), train_poison_data_count: 385
Global model norm: 43.73946301682269.
Norm before scaling: 43.712129256541886. Distance: 1.3027473231734477
Total norm for 4 adversaries is: 43.712129256541886. distance: 1.3027473231734477
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0862, Accuracy: 9682/9900 (97.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5125/5305 (96.6070%), train_poison_data_count: 415
Global model norm: 43.73946301682269.
Norm before scaling: 43.70962841538392. Distance: 1.364198567353981
Total norm for 4 adversaries is: 43.70962841538392. distance: 1.364198567353981
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0994, Accuracy: 9648/9900 (97.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4554/4717 (96.5444%), train_poison_data_count: 370
Global model norm: 43.73946301682269.
Norm before scaling: 43.71296702728065. Distance: 1.2547186480654628
Total norm for 4 adversaries is: 43.71296702728065. distance: 1.2547186480654628
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0577, Accuracy: 9734/9900 (98.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4889/5066 (96.5061%), train_poison_data_count: 400
Global model norm: 43.73946301682269.
Norm before scaling: 43.7134222093169. Distance: 1.3916105571255368
Total norm for 4 adversaries is: 43.7134222093169. distance: 1.3916105571255368
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0648, Accuracy: 9728/9900 (98.2626%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4298/4662 (92.1922%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4279/4662 (91.7846%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1091, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3332/3616 (92.1460%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3315/3616 (91.6759%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8605, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3596/3828 (93.9394%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3626/3828 (94.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8402, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3075/3297 (93.2666%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3083/3297 (93.5093%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7560, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4007/4361 (91.8826%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3812/4361 (87.4111%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1315, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4250/4576 (92.8759%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4219/4576 (92.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9799, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3958/4295 (92.1537%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3822/4295 (88.9872%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1484, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4632/5083 (91.1273%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4608/5083 (90.6551%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9739, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4727/5116 (92.3964%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4659/5116 (91.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0697, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3798/4046 (93.8705%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3769/4046 (93.1537%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8812, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5295/5902 (89.7154%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5102/5902 (86.4453%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1332, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4832/5197 (92.9767%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4697/5197 (90.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0677, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4206/4465 (94.1993%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4184/4465 (93.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7549, Accuracy: 5922/10000 (59.2200%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3428/3704 (92.5486%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3428/3704 (92.5486%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8830, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3598/3861 (93.1883%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3572/3861 (92.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7879, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3829/4126 (92.8017%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3855/4126 (93.4319%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7617, Accuracy: 5906/10000 (59.0600%)
time spent on training: 257.2747449874878
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2301, Accuracy: 6845/10000 (68.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1718, Accuracy: 9436/9900 (95.3131%)
Done in 284.75528955459595 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4731/4885 (96.8475%), train_poison_data_count: 385
Global model norm: 43.75906156157831.
Norm before scaling: 43.73320966873673. Distance: 1.3170416229668662
Total norm for 4 adversaries is: 43.73320966873673. distance: 1.3170416229668662
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0625, Accuracy: 9738/9900 (98.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5099/5305 (96.1169%), train_poison_data_count: 415
Global model norm: 43.75906156157831.
Norm before scaling: 43.72935059563113. Distance: 1.412071259170169
Total norm for 4 adversaries is: 43.72935059563113. distance: 1.412071259170169
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0129, Accuracy: 9873/9900 (99.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4553/4717 (96.5232%), train_poison_data_count: 370
Global model norm: 43.75906156157831.
Norm before scaling: 43.73103662678402. Distance: 1.2502056429507238
Total norm for 4 adversaries is: 43.73103662678402. distance: 1.2502056429507238
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0944, Accuracy: 9650/9900 (97.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4872/5066 (96.1705%), train_poison_data_count: 400
Global model norm: 43.75906156157831.
Norm before scaling: 43.73546633597269. Distance: 1.4142907732918493
Total norm for 4 adversaries is: 43.73546633597269. distance: 1.4142907732918493
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0464, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4171/4511 (92.4629%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4102/4511 (90.9333%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9007, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5257/5740 (91.5854%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5230/5740 (91.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0692, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4370/4662 (93.7366%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4317/4662 (92.5997%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9964, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3944/4235 (93.1287%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3873/4235 (91.4522%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0549, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4851/5265 (92.1368%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4797/5265 (91.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0013, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4154/4433 (93.7063%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4081/4433 (92.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9462, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4261/4596 (92.7111%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4274/4596 (92.9939%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9365, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4692/5055 (92.8190%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4649/5055 (91.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8852, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4597/5037 (91.2646%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4533/5037 (89.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2574, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4269/4538 (94.0723%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4276/4538 (94.2265%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7052, Accuracy: 5996/10000 (59.9600%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3552/3756 (94.5687%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3527/3756 (93.9031%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8885, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3777/4025 (93.8385%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3806/4025 (94.5590%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9573, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4702/5244 (89.6644%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4582/5244 (87.3760%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2812, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4358/4663 (93.4591%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4372/4663 (93.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0424, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3579/3837 (93.2760%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3612/3837 (94.1360%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7553, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4108/4481 (91.6760%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3999/4481 (89.2435%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1182, Accuracy: 5431/10000 (54.3100%)
time spent on training: 260.95551443099976
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2347, Accuracy: 6824/10000 (68.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1638, Accuracy: 9458/9900 (95.5354%)
Done in 288.9004452228546 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4726/4885 (96.7451%), train_poison_data_count: 385
Global model norm: 43.779164386440726.
Norm before scaling: 43.75196424162006. Distance: 1.3105324120441235
Total norm for 4 adversaries is: 43.75196424162006. distance: 1.3105324120441235
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0481, Accuracy: 9781/9900 (98.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5103/5305 (96.1923%), train_poison_data_count: 415
Global model norm: 43.779164386440726.
Norm before scaling: 43.74968749888392. Distance: 1.3889382237043402
Total norm for 4 adversaries is: 43.74968749888392. distance: 1.3889382237043402
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1046, Accuracy: 9636/9900 (97.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4548/4717 (96.4172%), train_poison_data_count: 370
Global model norm: 43.779164386440726.
Norm before scaling: 43.751748011954476. Distance: 1.2631759967730338
Total norm for 4 adversaries is: 43.751748011954476. distance: 1.2631759967730338
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0365, Accuracy: 9804/9900 (99.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4869/5066 (96.1113%), train_poison_data_count: 400
Global model norm: 43.779164386440726.
Norm before scaling: 43.75485324643642. Distance: 1.4253043435333193
Total norm for 4 adversaries is: 43.75485324643642. distance: 1.4253043435333193
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0823, Accuracy: 9676/9900 (97.7374%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4120/4362 (94.4521%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3976/4362 (91.1508%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2349, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5090/5591 (91.0392%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4994/5591 (89.3221%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1593, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4041/4315 (93.6501%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4004/4315 (92.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8769, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3519/3781 (93.0706%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3475/3781 (91.9069%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9043, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3770/4158 (90.6686%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3757/4158 (90.3559%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8544, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4159/4511 (92.1969%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4072/4511 (90.2682%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9170, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4437/4793 (92.5725%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4414/4793 (92.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0106, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5006/5424 (92.2935%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5031/5424 (92.7544%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2333, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4265/4618 (92.3560%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4217/4618 (91.3166%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0023, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4008/4368 (91.7582%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3933/4368 (90.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9474, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4473/4934 (90.6567%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0109, Accuracy: 3941/4934 (79.8743%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.4322, Accuracy: 4749/10000 (47.4900%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4806/5232 (91.8578%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4693/5232 (89.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1372, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5390/5902 (91.3250%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5129/5902 (86.9027%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.4629, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4944/5392 (91.6914%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4844/5392 (89.8368%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1460, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4661/5017 (92.9041%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4593/5017 (91.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9541, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4723/5195 (90.9143%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4604/5195 (88.6237%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9896, Accuracy: 5540/10000 (55.4000%)
time spent on training: 264.35522294044495
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2370, Accuracy: 6835/10000 (68.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1583, Accuracy: 9477/9900 (95.7273%)
Done in 291.8830797672272 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4731/4885 (96.8475%), train_poison_data_count: 385
Global model norm: 43.80195993715278.
Norm before scaling: 43.77232270912251. Distance: 1.2739679366857346
Total norm for 4 adversaries is: 43.77232270912251. distance: 1.2739679366857346
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0718, Accuracy: 9695/9900 (97.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5104/5305 (96.2111%), train_poison_data_count: 415
Global model norm: 43.80195993715278.
Norm before scaling: 43.774585725838115. Distance: 1.4339831080751946
Total norm for 4 adversaries is: 43.774585725838115. distance: 1.4339831080751946
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1010, Accuracy: 9626/9900 (97.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4543/4717 (96.3112%), train_poison_data_count: 370
Global model norm: 43.80195993715278.
Norm before scaling: 43.77435287615983. Distance: 1.267999235246229
Total norm for 4 adversaries is: 43.77435287615983. distance: 1.267999235246229
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1246, Accuracy: 9560/9900 (96.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4889/5066 (96.5061%), train_poison_data_count: 400
Global model norm: 43.80195993715278.
Norm before scaling: 43.77406982967342. Distance: 1.344928357864608
Total norm for 4 adversaries is: 43.77406982967342. distance: 1.344928357864608
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0434, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4883/5265 (92.7445%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4762/5265 (90.4463%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9574, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3859/4126 (93.5288%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3858/4126 (93.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7837, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4178/4501 (92.8238%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4061/4501 (90.2244%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2234, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5585/6124 (91.1986%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5371/6124 (87.7041%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0369, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3010/3271 (92.0208%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2955/3271 (90.3393%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9901, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4336/4663 (92.9873%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4359/4663 (93.4806%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9076, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3770/4025 (93.6646%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3785/4025 (94.0373%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8470, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4313/4651 (92.7327%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4256/4651 (91.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0339, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4418/4804 (91.9650%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4231/4804 (88.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1350, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3341/3616 (92.3949%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3367/3616 (93.1139%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.6971, Accuracy: 6091/10000 (60.9100%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3673/3911 (93.9146%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3495/3911 (89.3633%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.3859, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4798/5197 (92.3225%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4742/5197 (91.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1176, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4279/4538 (94.2926%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4291/4538 (94.5571%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8288, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5745/6391 (89.8920%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5561/6391 (87.0130%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2134, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3435/3704 (92.7376%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3439/3704 (92.8456%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7861, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3907/4235 (92.2550%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3799/4235 (89.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2454, Accuracy: 5144/10000 (51.4400%)
time spent on training: 255.60309433937073
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2414, Accuracy: 6796/10000 (67.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1528, Accuracy: 9490/9900 (95.8586%)
Done in 283.09570121765137 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4736/4885 (96.9498%), train_poison_data_count: 385
Global model norm: 43.82262805323509.
Norm before scaling: 43.79310794760903. Distance: 1.2596962133402916
Total norm for 4 adversaries is: 43.79310794760903. distance: 1.2596962133402916
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0801, Accuracy: 9684/9900 (97.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5103/5305 (96.1923%), train_poison_data_count: 415
Global model norm: 43.82262805323509.
Norm before scaling: 43.793980405148865. Distance: 1.4112401796038114
Total norm for 4 adversaries is: 43.793980405148865. distance: 1.4112401796038114
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0564, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4532/4717 (96.0780%), train_poison_data_count: 370
Global model norm: 43.82262805323509.
Norm before scaling: 43.79532111273061. Distance: 1.2923402670581712
Total norm for 4 adversaries is: 43.79532111273061. distance: 1.2923402670581712
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0850, Accuracy: 9669/9900 (97.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4868/5066 (96.0916%), train_poison_data_count: 400
Global model norm: 43.82262805323509.
Norm before scaling: 43.79627156871133. Distance: 1.3817976767698925
Total norm for 4 adversaries is: 43.79627156871133. distance: 1.3817976767698925
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0741, Accuracy: 9703/9900 (98.0101%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4758/5116 (93.0023%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4680/5116 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9144, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5254/5582 (94.1240%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5181/5582 (92.8162%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1232, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4000/4235 (94.4510%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3703/4235 (87.4380%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1724, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4239/4625 (91.6541%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4077/4625 (88.1514%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3172, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4091/4481 (91.2966%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3968/4481 (88.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1176, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4855/5232 (92.7943%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4776/5232 (91.2844%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9528, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4367/4662 (93.6722%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4348/4662 (93.2647%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0022, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4216/4441 (94.9336%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4170/4441 (93.8978%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9967, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4175/4518 (92.4081%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4203/4518 (93.0279%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9220, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4603/4928 (93.4050%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4567/4928 (92.6745%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9472, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4228/4634 (91.2387%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4262/4634 (91.9724%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0516, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4540/4934 (92.0146%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4306/4934 (87.2720%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1411, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3620/3861 (93.7581%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3610/3861 (93.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8950, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3325/3616 (91.9524%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3359/3616 (92.8927%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8268, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4034/4416 (91.3496%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4008/4416 (90.7609%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0239, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3556/3797 (93.6529%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3527/3797 (92.8891%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9303, Accuracy: 5709/10000 (57.0900%)
time spent on training: 259.68479084968567
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2426, Accuracy: 6802/10000 (68.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1518, Accuracy: 9499/9900 (95.9495%)
Done in 287.42014169692993 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4729/4885 (96.8066%), train_poison_data_count: 385
Global model norm: 43.842916120455676.
Norm before scaling: 43.815291681743375. Distance: 1.3114368128910872
Total norm for 4 adversaries is: 43.815291681743375. distance: 1.3114368128910872
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0410, Accuracy: 9795/9900 (98.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5116/5305 (96.4373%), train_poison_data_count: 415
Global model norm: 43.842916120455676.
Norm before scaling: 43.81281762545351. Distance: 1.3832851399602157
Total norm for 4 adversaries is: 43.81281762545351. distance: 1.3832851399602157
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0994, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4566/4717 (96.7988%), train_poison_data_count: 370
Global model norm: 43.842916120455676.
Norm before scaling: 43.81389447005154. Distance: 1.2144702692990437
Total norm for 4 adversaries is: 43.81389447005154. distance: 1.2144702692990437
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0994, Accuracy: 9624/9900 (97.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4906/5066 (96.8417%), train_poison_data_count: 400
Global model norm: 43.842916120455676.
Norm before scaling: 43.814862632444715. Distance: 1.3482814499610314
Total norm for 4 adversaries is: 43.814862632444715. distance: 1.3482814499610314
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1764, Accuracy: 9432/9900 (95.2727%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5796/6263 (92.5435%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5733/6263 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2199, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3984/4295 (92.7590%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3914/4295 (91.1292%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9074, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4522/4989 (90.6394%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4458/4989 (89.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9365, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3926/4223 (92.9671%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3924/4223 (92.9197%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8316, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5598/6124 (91.4108%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5503/6124 (89.8596%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2856, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4137/4481 (92.3231%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3985/4481 (88.9310%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3250, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4322/4618 (93.5903%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4150/4618 (89.8657%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1573, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4230/4441 (95.2488%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4166/4441 (93.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9348, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3755/4013 (93.5709%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3759/4013 (93.6706%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7910, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4146/4511 (91.9087%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4164/4511 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9311, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3992/4416 (90.3986%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3981/4416 (90.1495%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9899, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4504/4956 (90.8797%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4412/4956 (89.0234%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2157, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4232/4538 (93.2569%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4267/4538 (94.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8280, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4770/5265 (90.5983%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4754/5265 (90.2944%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0771, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4829/5197 (92.9190%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4591/5197 (88.3394%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1193, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4327/4716 (91.7515%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4314/4716 (91.4758%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0356, Accuracy: 5408/10000 (54.0800%)
time spent on training: 261.0853567123413
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2376, Accuracy: 6831/10000 (68.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1612, Accuracy: 9469/9900 (95.6465%)
Done in 288.59995007514954 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4717/4885 (96.5609%), train_poison_data_count: 385
Global model norm: 43.86456539914935.
Norm before scaling: 43.8359354114685. Distance: 1.306013335914931
Total norm for 4 adversaries is: 43.8359354114685. distance: 1.306013335914931
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0752, Accuracy: 9702/9900 (98.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5103/5305 (96.1923%), train_poison_data_count: 415
Global model norm: 43.86456539914935.
Norm before scaling: 43.837737080999204. Distance: 1.4414377596752834
Total norm for 4 adversaries is: 43.837737080999204. distance: 1.4414377596752834
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0165, Accuracy: 9864/9900 (99.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4555/4717 (96.5656%), train_poison_data_count: 370
Global model norm: 43.86456539914935.
Norm before scaling: 43.83628906805197. Distance: 1.2303967167190428
Total norm for 4 adversaries is: 43.83628906805197. distance: 1.2303967167190428
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1042, Accuracy: 9634/9900 (97.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4881/5066 (96.3482%), train_poison_data_count: 400
Global model norm: 43.86456539914935.
Norm before scaling: 43.838261973881046. Distance: 1.3735385410607512
Total norm for 4 adversaries is: 43.838261973881046. distance: 1.3735385410607512
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0960, Accuracy: 9644/9900 (97.4141%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3349/3616 (92.6162%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3369/3616 (93.1692%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7860, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4089/4315 (94.7625%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4010/4315 (92.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9880, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5053/5455 (92.6306%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4864/5455 (89.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0445, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4413/4804 (91.8609%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4171/4804 (86.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2567, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4092/4362 (93.8102%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3964/4362 (90.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0027, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5806/6263 (92.7032%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5723/6263 (91.3779%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0961, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4267/4538 (94.0282%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4264/4538 (93.9621%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8311, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4293/4634 (92.6413%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4249/4634 (91.6918%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8627, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4753/5116 (92.9046%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4668/5116 (91.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8985, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4263/4716 (90.3944%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4254/4716 (90.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2141, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3772/4046 (93.2279%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3726/4046 (92.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9365, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4167/4518 (92.2311%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4164/4518 (92.1647%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9682, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4614/5063 (91.1317%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4442/5063 (87.7345%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2636, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5301/5740 (92.3519%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5206/5740 (90.6969%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0682, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5219/5582 (93.4970%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5069/5582 (90.8097%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0883, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4167/4433 (93.9995%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4138/4433 (93.3454%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8903, Accuracy: 5699/10000 (56.9900%)
time spent on training: 264.17236852645874
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2351, Accuracy: 6825/10000 (68.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1583, Accuracy: 9478/9900 (95.7374%)
Done in 291.72028827667236 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4738/4885 (96.9908%), train_poison_data_count: 385
Global model norm: 43.885750608202116.
Norm before scaling: 43.857858118585774. Distance: 1.292074995205688
Total norm for 4 adversaries is: 43.857858118585774. distance: 1.292074995205688
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0861, Accuracy: 9685/9900 (97.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5105/5305 (96.2300%), train_poison_data_count: 415
Global model norm: 43.885750608202116.
Norm before scaling: 43.856810187298024. Distance: 1.393570598466018
Total norm for 4 adversaries is: 43.856810187298024. distance: 1.393570598466018
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0337, Accuracy: 9816/9900 (99.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4576/4717 (97.0108%), train_poison_data_count: 370
Global model norm: 43.885750608202116.
Norm before scaling: 43.85755195267116. Distance: 1.212056485889908
Total norm for 4 adversaries is: 43.85755195267116. distance: 1.212056485889908
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1299, Accuracy: 9545/9900 (96.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4870/5066 (96.1311%), train_poison_data_count: 400
Global model norm: 43.885750608202116.
Norm before scaling: 43.85940144058697. Distance: 1.3888670278524158
Total norm for 4 adversaries is: 43.85940144058697. distance: 1.3888670278524158
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0815, Accuracy: 9683/9900 (97.8081%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4762/5197 (91.6298%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4579/5197 (88.1085%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0491, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3773/4025 (93.7391%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3785/4025 (94.0373%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7899, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4142/4481 (92.4347%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3990/4481 (89.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2517, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4293/4651 (92.3027%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4270/4651 (91.8082%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8971, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5369/5902 (90.9692%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5136/5902 (87.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1624, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3816/4126 (92.4867%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3834/4126 (92.9229%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8209, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4037/4368 (92.4222%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3916/4368 (89.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9673, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5817/6391 (91.0186%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5627/6391 (88.0457%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2271, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3873/4175 (92.7665%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3784/4175 (90.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9889, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4311/4596 (93.7990%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4246/4596 (92.3847%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0935, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4311/4634 (93.0298%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4276/4634 (92.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8518, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3937/4223 (93.2276%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3950/4223 (93.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8550, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3622/3911 (92.6106%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3380/3911 (86.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1454, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4129/4433 (93.1423%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4121/4433 (92.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9460, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3948/4336 (91.0517%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3982/4336 (91.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1898, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3334/3638 (91.6438%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3375/3638 (92.7708%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8728, Accuracy: 5781/10000 (57.8100%)
time spent on training: 259.9130880832672
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2376, Accuracy: 6803/10000 (68.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1640, Accuracy: 9462/9900 (95.5758%)
Done in 287.20399236679077 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4763/4885 (97.5026%), train_poison_data_count: 385
Global model norm: 43.90704236384666.
Norm before scaling: 43.876076709544975. Distance: 1.1980281722652175
Total norm for 4 adversaries is: 43.876076709544975. distance: 1.1980281722652175
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1380, Accuracy: 9518/9900 (96.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5130/5305 (96.7012%), train_poison_data_count: 415
Global model norm: 43.90704236384666.
Norm before scaling: 43.87901874623922. Distance: 1.4110890523599797
Total norm for 4 adversaries is: 43.87901874623922. distance: 1.4110890523599797
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0670, Accuracy: 9734/9900 (98.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4566/4717 (96.7988%), train_poison_data_count: 370
Global model norm: 43.90704236384666.
Norm before scaling: 43.878423399651254. Distance: 1.2187065214569048
Total norm for 4 adversaries is: 43.878423399651254. distance: 1.2187065214569048
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0645, Accuracy: 9733/9900 (98.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4894/5066 (96.6048%), train_poison_data_count: 400
Global model norm: 43.90704236384666.
Norm before scaling: 43.8792134840241. Distance: 1.33597399566949
Total norm for 4 adversaries is: 43.8792134840241. distance: 1.33597399566949
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1194, Accuracy: 9586/9900 (96.8283%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3550/3756 (94.5154%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3531/3756 (94.0096%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9181, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5025/5424 (92.6438%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4962/5424 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1094, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4137/4433 (93.3228%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4078/4433 (91.9919%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8659, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4140/4501 (91.9796%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4030/4501 (89.5357%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2735, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3773/4025 (93.7391%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3800/4025 (94.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8101, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3969/4235 (93.7190%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3880/4235 (91.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9034, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5609/6124 (91.5905%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5437/6124 (88.7818%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0190, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4311/4634 (93.0298%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4244/4634 (91.5839%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8327, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4322/4716 (91.6455%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4252/4716 (90.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1844, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4357/4767 (91.3992%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4245/4767 (89.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1350, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3522/3804 (92.5868%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3539/3804 (93.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9860, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3263/3472 (93.9804%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3289/3472 (94.7293%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9643, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5019/5392 (93.0823%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4868/5392 (90.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1812, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5326/5740 (92.7875%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5252/5740 (91.4983%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0667, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4281/4596 (93.1462%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4283/4596 (93.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9531, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3333/3616 (92.1737%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3349/3616 (92.6162%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8902, Accuracy: 5772/10000 (57.7200%)
time spent on training: 258.8327009677887
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2355, Accuracy: 6813/10000 (68.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1760, Accuracy: 9431/9900 (95.2626%)
Done in 286.1276021003723 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4731/4885 (96.8475%), train_poison_data_count: 385
Global model norm: 43.92672454106099.
Norm before scaling: 43.896935177398774. Distance: 1.28214060835939
Total norm for 4 adversaries is: 43.896935177398774. distance: 1.28214060835939
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0399, Accuracy: 9787/9900 (98.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5102/5305 (96.1734%), train_poison_data_count: 415
Global model norm: 43.92672454106099.
Norm before scaling: 43.89752749212506. Distance: 1.4391417871889562
Total norm for 4 adversaries is: 43.89752749212506. distance: 1.4391417871889562
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0268, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4582/4717 (97.1380%), train_poison_data_count: 370
Global model norm: 43.92672454106099.
Norm before scaling: 43.89955325931219. Distance: 1.258786032046391
Total norm for 4 adversaries is: 43.89955325931219. distance: 1.258786032046391
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0653, Accuracy: 9736/9900 (98.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4886/5066 (96.4469%), train_poison_data_count: 400
Global model norm: 43.92672454106099.
Norm before scaling: 43.89992030664392. Distance: 1.3770688704954173
Total norm for 4 adversaries is: 43.89992030664392. distance: 1.3770688704954173
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0861, Accuracy: 9656/9900 (97.5354%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4667/5063 (92.1786%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4551/5063 (89.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9680, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4447/4804 (92.5687%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4196/4804 (87.3439%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2759, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4176/4558 (91.6191%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4072/4558 (89.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1345, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3557/3756 (94.7018%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3583/3756 (95.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7764, Accuracy: 5996/10000 (59.9600%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5074/5424 (93.5472%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4973/5424 (91.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0429, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4166/4511 (92.3520%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4134/4511 (91.6427%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9046, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4833/5167 (93.5359%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4794/5167 (92.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1249, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4058/4356 (93.1589%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4008/4356 (92.0110%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0838, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4739/5244 (90.3699%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4645/5244 (88.5774%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0813, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4465/4793 (93.1567%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4440/4793 (92.6351%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0843, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3587/3828 (93.7043%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3597/3828 (93.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7220, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3806/4046 (94.0682%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3798/4046 (93.8705%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8206, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3770/4013 (93.9447%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3768/4013 (93.8948%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8190, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3011/3271 (92.0514%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2998/3271 (91.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8480, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4120/4362 (94.4521%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4056/4362 (92.9849%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8717, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4086/4346 (94.0175%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4139/4346 (95.2370%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7539, Accuracy: 5991/10000 (59.9100%)
time spent on training: 258.77914571762085
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2381, Accuracy: 6812/10000 (68.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1651, Accuracy: 9462/9900 (95.5758%)
Done in 286.2075982093811 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4757/4885 (97.3797%), train_poison_data_count: 385
Global model norm: 43.94527986109899.
Norm before scaling: 43.915295998732034. Distance: 1.2520094455661284
Total norm for 4 adversaries is: 43.915295998732034. distance: 1.2520094455661284
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0503, Accuracy: 9779/9900 (98.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5091/5305 (95.9661%), train_poison_data_count: 415
Global model norm: 43.94527986109899.
Norm before scaling: 43.91760862861558. Distance: 1.4356206965766016
Total norm for 4 adversaries is: 43.91760862861558. distance: 1.4356206965766016
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0389, Accuracy: 9801/9900 (99.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4556/4717 (96.5868%), train_poison_data_count: 370
Global model norm: 43.94527986109899.
Norm before scaling: 43.91812422841153. Distance: 1.2747504831639729
Total norm for 4 adversaries is: 43.91812422841153. distance: 1.2747504831639729
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0402, Accuracy: 9800/9900 (98.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4900/5066 (96.7233%), train_poison_data_count: 400
Global model norm: 43.94527986109899.
Norm before scaling: 43.9184758334263. Distance: 1.359446074282964
Total norm for 4 adversaries is: 43.9184758334263. distance: 1.359446074282964
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0913, Accuracy: 9650/9900 (97.4747%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3852/4126 (93.3592%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3850/4126 (93.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8679, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5011/5455 (91.8607%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4954/5455 (90.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9857, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4246/4558 (93.1549%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4060/4558 (89.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1332, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4002/4235 (94.4982%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3922/4235 (92.6092%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9451, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3534/3804 (92.9022%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3568/3804 (93.7960%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7870, Accuracy: 5953/10000 (59.5300%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5855/6391 (91.6132%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5550/6391 (86.8409%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.4844, Accuracy: 4868/10000 (48.6800%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4013/4336 (92.5507%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3966/4336 (91.4668%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1803, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4319/4663 (92.6228%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4355/4663 (93.3948%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0460, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4159/4511 (92.1969%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4102/4511 (90.9333%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9827, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4200/4503 (93.2712%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4061/4503 (90.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0495, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4607/5063 (90.9935%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4497/5063 (88.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1354, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4054/4315 (93.9513%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4030/4315 (93.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8396, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3359/3638 (92.3310%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3420/3638 (94.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8015, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4216/4441 (94.9336%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4209/4441 (94.7760%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9620, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4360/4679 (93.1823%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4163/4679 (88.9720%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1486, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4850/5265 (92.1178%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4687/5265 (89.0218%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0339, Accuracy: 5468/10000 (54.6800%)
time spent on training: 262.3242645263672
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2417, Accuracy: 6802/10000 (68.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1663, Accuracy: 9460/9900 (95.5556%)
Done in 289.39941453933716 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4746/4885 (97.1546%), train_poison_data_count: 385
Global model norm: 43.96563071957814.
Norm before scaling: 43.935187027935676. Distance: 1.2714991414843146
Total norm for 4 adversaries is: 43.935187027935676. distance: 1.2714991414843146
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0741, Accuracy: 9723/9900 (98.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5115/5305 (96.4185%), train_poison_data_count: 415
Global model norm: 43.96563071957814.
Norm before scaling: 43.93690544583505. Distance: 1.4218238569850163
Total norm for 4 adversaries is: 43.93690544583505. distance: 1.4218238569850163
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0480, Accuracy: 9773/9900 (98.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4585/4717 (97.2016%), train_poison_data_count: 370
Global model norm: 43.96563071957814.
Norm before scaling: 43.93572464852065. Distance: 1.181288485429925
Total norm for 4 adversaries is: 43.93572464852065. distance: 1.181288485429925
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0534, Accuracy: 9760/9900 (98.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4886/5066 (96.4469%), train_poison_data_count: 400
Global model norm: 43.96563071957814.
Norm before scaling: 43.9403198552807. Distance: 1.3839112135681952
Total norm for 4 adversaries is: 43.9403198552807. distance: 1.3839112135681952
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0369, Accuracy: 9805/9900 (99.0404%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4056/4336 (93.5424%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3979/4336 (91.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1605, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3591/3828 (93.8088%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3582/3828 (93.5737%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8498, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3364/3672 (91.6122%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3312/3672 (90.1961%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0663, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4346/4651 (93.4423%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4248/4651 (91.3352%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9647, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4023/4361 (92.2495%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3885/4361 (89.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9956, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4657/5025 (92.6766%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4609/5025 (91.7214%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0896, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5589/6124 (91.2639%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5470/6124 (89.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0498, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3436/3704 (92.7646%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3447/3704 (93.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7957, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4541/4934 (92.0349%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4140/4934 (83.9076%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.4172, Accuracy: 4790/10000 (47.9000%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4675/5017 (93.1832%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4629/5017 (92.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8800, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5190/5582 (92.9774%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5120/5582 (91.7234%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0724, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4789/5167 (92.6843%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4693/5167 (90.8264%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1650, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3638/3861 (94.2243%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3547/3861 (91.8674%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0144, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3383/3646 (92.7866%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3354/3646 (91.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7888, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4203/4558 (92.2115%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4014/4558 (88.0649%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0855, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4791/5116 (93.6474%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4653/5116 (90.9500%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9366, Accuracy: 5673/10000 (56.7300%)
time spent on training: 261.52403926849365
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2452, Accuracy: 6789/10000 (67.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1617, Accuracy: 9464/9900 (95.5960%)
Done in 289.0405328273773 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4746/4885 (97.1546%), train_poison_data_count: 385
Global model norm: 43.98648557325235.
Norm before scaling: 43.956088262179335. Distance: 1.2757831337535848
Total norm for 4 adversaries is: 43.956088262179335. distance: 1.2757831337535848
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0142, Accuracy: 9853/9900 (99.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5130/5305 (96.7012%), train_poison_data_count: 415
Global model norm: 43.98648557325235.
Norm before scaling: 43.95455388941159. Distance: 1.3593007209916799
Total norm for 4 adversaries is: 43.95455388941159. distance: 1.3593007209916799
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0603, Accuracy: 9745/9900 (98.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4557/4717 (96.6080%), train_poison_data_count: 370
Global model norm: 43.98648557325235.
Norm before scaling: 43.95683112929875. Distance: 1.265486533043209
Total norm for 4 adversaries is: 43.95683112929875. distance: 1.265486533043209
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0281, Accuracy: 9825/9900 (99.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4891/5066 (96.5456%), train_poison_data_count: 400
Global model norm: 43.98648557325235.
Norm before scaling: 43.95983718300433. Distance: 1.3497002622085343
Total norm for 4 adversaries is: 43.95983718300433. distance: 1.3497002622085343
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1228, Accuracy: 9597/9900 (96.9394%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4147/4511 (91.9308%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4215/4511 (93.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9329, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4068/4346 (93.6033%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4108/4346 (94.5237%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8051, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4423/4804 (92.0691%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3939/4804 (81.9942%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.4045, Accuracy: 4910/10000 (49.1000%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4791/5232 (91.5711%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4642/5232 (88.7232%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9857, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4328/4618 (93.7202%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4245/4618 (91.9229%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0049, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3384/3590 (94.2618%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3303/3590 (92.0056%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0383, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5792/6391 (90.6274%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5587/6391 (87.4198%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1923, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4043/4354 (92.8571%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3516/4354 (80.7533%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3936, Accuracy: 4789/10000 (47.8900%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4680/5055 (92.5816%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4664/5055 (92.2651%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9765, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3620/3837 (94.3445%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3632/3837 (94.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8509, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4181/4503 (92.8492%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4086/4503 (90.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9294, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4314/4576 (94.2745%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4259/4576 (93.0726%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9814, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4437/4793 (92.5725%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4409/4793 (91.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0052, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4313/4634 (93.0729%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4259/4634 (91.9076%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8406, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3770/4158 (90.6686%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3675/4158 (88.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1918, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5288/5740 (92.1254%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5220/5740 (90.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0861, Accuracy: 5379/10000 (53.7900%)
time spent on training: 262.988942861557
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2460, Accuracy: 6790/10000 (67.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1681, Accuracy: 9452/9900 (95.4747%)
Done in 290.6539490222931 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4743/4885 (97.0931%), train_poison_data_count: 385
Global model norm: 44.00836379581017.
Norm before scaling: 43.97841184044522. Distance: 1.2739913765631905
Total norm for 4 adversaries is: 43.97841184044522. distance: 1.2739913765631905
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0724, Accuracy: 9696/9900 (97.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5103/5305 (96.1923%), train_poison_data_count: 415
Global model norm: 44.00836379581017.
Norm before scaling: 43.97984268389327. Distance: 1.4380052756582797
Total norm for 4 adversaries is: 43.97984268389327. distance: 1.4380052756582797
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0508, Accuracy: 9769/9900 (98.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4556/4717 (96.5868%), train_poison_data_count: 370
Global model norm: 44.00836379581017.
Norm before scaling: 43.97936527864517. Distance: 1.250570596162661
Total norm for 4 adversaries is: 43.97936527864517. distance: 1.250570596162661
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0645, Accuracy: 9722/9900 (98.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4893/5066 (96.5851%), train_poison_data_count: 400
Global model norm: 44.00836379581017.
Norm before scaling: 43.980628170785316. Distance: 1.3690655261896398
Total norm for 4 adversaries is: 43.980628170785316. distance: 1.3690655261896398
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0701, Accuracy: 9703/9900 (98.0101%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3887/4184 (92.9015%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3832/4184 (91.5870%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9572, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5771/6263 (92.1443%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5711/6263 (91.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2339, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4195/4456 (94.1427%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4166/4456 (93.4919%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9187, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4297/4538 (94.6893%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4234/4538 (93.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9248, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3980/4235 (93.9787%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3773/4235 (89.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1250, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3914/4223 (92.6829%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3913/4223 (92.6592%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8665, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4998/5455 (91.6224%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4886/5455 (89.5692%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0966, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4613/5037 (91.5823%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4618/5037 (91.6816%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0521, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3546/3756 (94.4089%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3565/3756 (94.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8687, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4878/5265 (92.6496%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4681/5265 (88.9079%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0614, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4681/5055 (92.6014%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4579/5055 (90.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1578, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4459/4804 (92.8185%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4001/4804 (83.2848%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4054, Accuracy: 4900/10000 (49.0000%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4654/5063 (91.9218%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4458/5063 (88.0506%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3016, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4007/4295 (93.2945%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3868/4295 (90.0582%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9537, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3031/3271 (92.6628%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0046, Accuracy: 2975/3271 (90.9508%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9683, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4047/4356 (92.9063%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4021/4356 (92.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1567, Accuracy: 5408/10000 (54.0800%)
time spent on training: 258.47730255126953
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.2518, Accuracy: 6778/10000 (67.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1704, Accuracy: 9449/9900 (95.4444%)
Done in 286.3648762702942 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4719/4885 (96.6018%), train_poison_data_count: 385
Global model norm: 44.02899463040307.
Norm before scaling: 44.00000971013742. Distance: 1.3304906085061705
Total norm for 4 adversaries is: 44.00000971013742. distance: 1.3304906085061705
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0281, Accuracy: 9833/9900 (99.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5135/5305 (96.7955%), train_poison_data_count: 415
Global model norm: 44.02899463040307.
Norm before scaling: 43.99745864464788. Distance: 1.3614644621302743
Total norm for 4 adversaries is: 43.99745864464788. distance: 1.3614644621302743
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0523, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4577/4717 (97.0320%), train_poison_data_count: 370
Global model norm: 44.02899463040307.
Norm before scaling: 43.99868772457168. Distance: 1.1991937491827243
Total norm for 4 adversaries is: 43.99868772457168. distance: 1.1991937491827243
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0562, Accuracy: 9758/9900 (98.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4906/5066 (96.8417%), train_poison_data_count: 400
Global model norm: 44.02899463040307.
Norm before scaling: 43.99899013400762. Distance: 1.3161322424543784
Total norm for 4 adversaries is: 43.99899013400762. distance: 1.3161322424543784
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1724, Accuracy: 9465/9900 (95.6061%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4206/4503 (93.4044%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4118/4503 (91.4501%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1965, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4181/4456 (93.8285%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4136/4456 (92.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0270, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4889/5265 (92.8585%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4830/5265 (91.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0376, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4462/4793 (93.0941%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4443/4793 (92.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0549, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4589/4928 (93.1209%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4504/4928 (91.3961%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9006, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3341/3638 (91.8362%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3323/3638 (91.3414%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0004, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4349/4663 (93.2661%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4352/4663 (93.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8536, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4490/4928 (91.1120%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4483/4928 (90.9700%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0607, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4170/4465 (93.3931%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4161/4465 (93.1915%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9439, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3684/3911 (94.1959%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3487/3911 (89.1588%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1371, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4200/4518 (92.9615%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4158/4518 (92.0319%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1859, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3980/4235 (93.9787%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3978/4235 (93.9315%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0163, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4563/4934 (92.4807%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4071/4934 (82.5091%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.4435, Accuracy: 4803/10000 (48.0300%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4322/4647 (93.0062%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4250/4647 (91.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9255, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4341/4651 (93.3348%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4320/4651 (92.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0656, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4617/4989 (92.5436%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4502/4989 (90.2385%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9840, Accuracy: 5658/10000 (56.5800%)
time spent on training: 261.2650260925293
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2604, Accuracy: 6771/10000 (67.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1659, Accuracy: 9456/9900 (95.5152%)
Done in 288.9997444152832 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4726/4885 (96.7451%), train_poison_data_count: 385
Global model norm: 44.0489313106388.
Norm before scaling: 44.01984027561464. Distance: 1.321612152949261
Total norm for 4 adversaries is: 44.01984027561464. distance: 1.321612152949261
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0294, Accuracy: 9821/9900 (99.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5121/5305 (96.5316%), train_poison_data_count: 415
Global model norm: 44.0489313106388.
Norm before scaling: 44.01709484588772. Distance: 1.3961605096618794
Total norm for 4 adversaries is: 44.01709484588772. distance: 1.3961605096618794
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0631, Accuracy: 9740/9900 (98.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4571/4717 (96.9048%), train_poison_data_count: 370
Global model norm: 44.0489313106388.
Norm before scaling: 44.01807379148365. Distance: 1.2128428574153567
Total norm for 4 adversaries is: 44.01807379148365. distance: 1.2128428574153567
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1094, Accuracy: 9614/9900 (97.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4880/5066 (96.3285%), train_poison_data_count: 400
Global model norm: 44.0489313106388.
Norm before scaling: 44.0234964229863. Distance: 1.4088678788265843
Total norm for 4 adversaries is: 44.0234964229863. distance: 1.4088678788265843
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0428, Accuracy: 9796/9900 (98.9495%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4284/4538 (94.4028%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4276/4538 (94.2265%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.6969, Accuracy: 6004/10000 (60.0400%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4108/4362 (94.1770%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3964/4362 (90.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0555, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4678/5244 (89.2067%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4618/5244 (88.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0347, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3813/4046 (94.2412%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3678/4046 (90.9046%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0316, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3752/4013 (93.4961%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3772/4013 (93.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9006, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4190/4465 (93.8410%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4140/4465 (92.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8521, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4764/5232 (91.0550%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4604/5232 (87.9969%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0850, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4604/4928 (93.4253%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4568/4928 (92.6948%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8181, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4672/5063 (92.2773%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4582/5063 (90.4997%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0464, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5412/5902 (91.6977%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5172/5902 (87.6313%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1886, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4169/4456 (93.5592%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4143/4456 (92.9758%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8876, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4272/4596 (92.9504%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4290/4596 (93.3420%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9425, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4175/4441 (94.0104%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4143/4441 (93.2898%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1087, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5351/5740 (93.2230%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5192/5740 (90.4530%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2709, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3280/3472 (94.4700%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3240/3472 (93.3180%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9435, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3629/3861 (93.9912%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3572/3861 (92.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8239, Accuracy: 5744/10000 (57.4400%)
time spent on training: 258.76367235183716
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.2632, Accuracy: 6778/10000 (67.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1541, Accuracy: 9489/9900 (95.8485%)
Done in 286.9337258338928 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4759/4885 (97.4207%), train_poison_data_count: 385
Global model norm: 44.0691082699768.
Norm before scaling: 44.036001562287076. Distance: 1.2179163013100551
Total norm for 4 adversaries is: 44.036001562287076. distance: 1.2179163013100551
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0634, Accuracy: 9719/9900 (98.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5122/5305 (96.5504%), train_poison_data_count: 415
Global model norm: 44.0691082699768.
Norm before scaling: 44.03845892237616. Distance: 1.3946556228184632
Total norm for 4 adversaries is: 44.03845892237616. distance: 1.3946556228184632
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0389, Accuracy: 9796/9900 (98.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4573/4717 (96.9472%), train_poison_data_count: 370
Global model norm: 44.0691082699768.
Norm before scaling: 44.03746795609819. Distance: 1.1848408892402185
Total norm for 4 adversaries is: 44.03746795609819. distance: 1.1848408892402185
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0493, Accuracy: 9782/9900 (98.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4911/5066 (96.9404%), train_poison_data_count: 400
Global model norm: 44.0691082699768.
Norm before scaling: 44.039758925440744. Distance: 1.312350219172863
Total norm for 4 adversaries is: 44.039758925440744. distance: 1.312350219172863
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0438, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3587/3797 (94.4693%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3471/3797 (91.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0479, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3070/3297 (93.1150%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3093/3297 (93.8126%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8301, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3680/3911 (94.0936%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3443/3911 (88.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2247, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2998/3271 (91.6539%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2961/3271 (90.5228%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9044, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3825/4046 (94.5378%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3825/4046 (94.5378%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9027, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5320/5740 (92.6829%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5259/5740 (91.6202%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1140, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3704/3969 (93.3233%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3645/3969 (91.8367%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8979, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3446/3704 (93.0346%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3403/3704 (91.8737%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9252, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4419/4767 (92.6998%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4324/4767 (90.7069%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9804, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4555/4956 (91.9088%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4449/4956 (89.7700%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0680, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3401/3590 (94.7354%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3062/3590 (85.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2341, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5452/5902 (92.3755%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5131/5902 (86.9366%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1369, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4591/4928 (93.1615%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4529/4928 (91.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9428, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3997/4235 (94.3802%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4007/4235 (94.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8955, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4846/5265 (92.0418%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4661/5265 (88.5280%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1426, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4094/4356 (93.9853%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3755/4356 (86.2029%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.5113, Accuracy: 4946/10000 (49.4600%)
time spent on training: 256.1666724681854
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.2686, Accuracy: 6780/10000 (67.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1503, Accuracy: 9500/9900 (95.9596%)
Done in 283.80650186538696 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4752/4885 (97.2774%), train_poison_data_count: 385
Global model norm: 44.089006045743.
Norm before scaling: 44.057312139186244. Distance: 1.242159717177143
Total norm for 4 adversaries is: 44.057312139186244. distance: 1.242159717177143
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0201, Accuracy: 9842/9900 (99.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5130/5305 (96.7012%), train_poison_data_count: 415
Global model norm: 44.089006045743.
Norm before scaling: 44.0589080428656. Distance: 1.3993060009716114
Total norm for 4 adversaries is: 44.0589080428656. distance: 1.3993060009716114
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0444, Accuracy: 9777/9900 (98.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4552/4717 (96.5020%), train_poison_data_count: 370
Global model norm: 44.089006045743.
Norm before scaling: 44.0609776443574. Distance: 1.2932102865171653
Total norm for 4 adversaries is: 44.0609776443574. distance: 1.2932102865171653
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0284, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4927/5066 (97.2562%), train_poison_data_count: 400
Global model norm: 44.089006045743.
Norm before scaling: 44.058443962253136. Distance: 1.3049830484568157
Total norm for 4 adversaries is: 44.058443962253136. distance: 1.3049830484568157
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0303, Accuracy: 9829/9900 (99.2828%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3802/4025 (94.4596%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3866/4025 (96.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7387, Accuracy: 5997/10000 (59.9700%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5437/5902 (92.1213%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5254/5902 (89.0207%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1537, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4497/4793 (93.8243%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4445/4793 (92.7394%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9145, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4865/5265 (92.4027%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4715/5265 (89.5537%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0208, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4010/4295 (93.3644%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3893/4295 (90.6403%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1081, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3456/3704 (93.3045%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3455/3704 (93.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8629, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4727/5116 (92.3964%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4565/5116 (89.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0267, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5308/5740 (92.4739%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5187/5740 (90.3659%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1754, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3587/3797 (94.4693%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3514/3797 (92.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9063, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4349/4716 (92.2180%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4277/4716 (90.6913%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1948, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4165/4433 (93.9544%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4108/4433 (92.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8256, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4098/4416 (92.7989%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4076/4416 (92.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0061, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3922/4223 (92.8724%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3927/4223 (92.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9249, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4632/5083 (91.1273%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4509/5083 (88.7075%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1311, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4305/4576 (94.0778%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4234/4576 (92.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0160, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5021/5392 (93.1194%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4841/5392 (89.7812%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1048, Accuracy: 5484/10000 (54.8400%)
time spent on training: 262.3855369091034
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.2677, Accuracy: 6782/10000 (67.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1450, Accuracy: 9522/9900 (96.1818%)
Done in 289.6611659526825 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4762/4885 (97.4821%), train_poison_data_count: 385
Global model norm: 44.10988420712103.
Norm before scaling: 44.077223548474414. Distance: 1.2243447633897457
Total norm for 4 adversaries is: 44.077223548474414. distance: 1.2243447633897457
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0399, Accuracy: 9786/9900 (98.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5136/5305 (96.8143%), train_poison_data_count: 415
Global model norm: 44.10988420712103.
Norm before scaling: 44.07774005060548. Distance: 1.3614818863800275
Total norm for 4 adversaries is: 44.07774005060548. distance: 1.3614818863800275
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0641, Accuracy: 9726/9900 (98.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4543/4717 (96.3112%), train_poison_data_count: 370
Global model norm: 44.10988420712103.
Norm before scaling: 44.082580752279576. Distance: 1.300898916060402
Total norm for 4 adversaries is: 44.082580752279576. distance: 1.300898916060402
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0478, Accuracy: 9776/9900 (98.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4901/5066 (96.7430%), train_poison_data_count: 400
Global model norm: 44.10988420712103.
Norm before scaling: 44.080737859016295. Distance: 1.3495261225989985
Total norm for 4 adversaries is: 44.080737859016295. distance: 1.3495261225989985
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0670, Accuracy: 9747/9900 (98.4545%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4894/5265 (92.9535%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4769/5265 (90.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1110, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4053/4356 (93.0441%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3842/4356 (88.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2487, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3614/3756 (96.2194%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3592/3756 (95.6337%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8049, Accuracy: 5964/10000 (59.6400%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3601/3837 (93.8494%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3617/3837 (94.2664%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9771, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5312/5740 (92.5436%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5269/5740 (91.7944%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9232, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3922/4223 (92.8724%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3912/4223 (92.6356%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9357, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4167/4465 (93.3259%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4151/4465 (92.9675%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8392, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5098/5591 (91.1823%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5013/5591 (89.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2597, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5455/5902 (92.4263%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5081/5902 (86.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2556, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4586/4918 (93.2493%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4517/4918 (91.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2017, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3624/3861 (93.8617%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3541/3861 (91.7120%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9291, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3994/4295 (92.9919%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3909/4295 (91.0128%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8985, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3798/4158 (91.3420%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3747/4158 (90.1154%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1245, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5822/6263 (92.9586%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5725/6263 (91.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0630, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4001/4354 (91.8925%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0134, Accuracy: 3313/4354 (76.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.7493, Accuracy: 4240/10000 (42.4000%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3593/3797 (94.6273%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3477/3797 (91.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9571, Accuracy: 5684/10000 (56.8400%)
time spent on training: 262.0973494052887
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.2812, Accuracy: 6742/10000 (67.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1329, Accuracy: 9557/9900 (96.5354%)
Done in 289.7371392250061 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4756/4885 (97.3593%), train_poison_data_count: 385
Global model norm: 44.13101388727377.
Norm before scaling: 44.097854001516474. Distance: 1.2002158725799483
Total norm for 4 adversaries is: 44.097854001516474. distance: 1.2002158725799483
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1001, Accuracy: 9643/9900 (97.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5142/5305 (96.9274%), train_poison_data_count: 415
Global model norm: 44.13101388727377.
Norm before scaling: 44.09918270262004. Distance: 1.3524562989400444
Total norm for 4 adversaries is: 44.09918270262004. distance: 1.3524562989400444
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0464, Accuracy: 9785/9900 (98.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4574/4717 (96.9684%), train_poison_data_count: 370
Global model norm: 44.13101388727377.
Norm before scaling: 44.10106219268916. Distance: 1.2210257874342403
Total norm for 4 adversaries is: 44.10106219268916. distance: 1.2210257874342403
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0871, Accuracy: 9676/9900 (97.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4915/5066 (97.0193%), train_poison_data_count: 400
Global model norm: 44.13101388727377.
Norm before scaling: 44.10350624038085. Distance: 1.3812191075111133
Total norm for 4 adversaries is: 44.10350624038085. distance: 1.3812191075111133
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0665, Accuracy: 9717/9900 (98.1515%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3578/3797 (94.2323%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3524/3797 (92.8101%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9432, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4619/5037 (91.7014%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4622/5037 (91.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8743, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4543/4934 (92.0754%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4331/4934 (87.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1696, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5047/5455 (92.5206%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4947/5455 (90.6874%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1144, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5426/5902 (91.9349%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5089/5902 (86.2250%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4883, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5831/6391 (91.2377%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5681/6391 (88.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1126, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3697/3911 (94.5283%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3557/3911 (90.9486%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0954, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4792/5195 (92.2425%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4585/5195 (88.2579%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1681, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3982/4235 (94.0260%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3960/4235 (93.5065%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8310, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4746/5116 (92.7678%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4622/5116 (90.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1467, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4340/4538 (95.6368%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4341/4538 (95.6589%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9257, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5233/5582 (93.7478%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5081/5582 (91.0247%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2544, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4224/4558 (92.6722%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4159/4558 (91.2462%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1196, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3803/4046 (93.9941%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3781/4046 (93.4503%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.7793, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3614/3828 (94.4096%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3530/3828 (92.2153%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8474, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4705/5055 (93.0762%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4654/5055 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9636, Accuracy: 5582/10000 (55.8200%)
time spent on training: 266.7113747596741
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.2840, Accuracy: 6738/10000 (67.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1303, Accuracy: 9562/9900 (96.5859%)
Done in 293.7690625190735 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4758/4885 (97.4002%), train_poison_data_count: 385
Global model norm: 44.15264216948828.
Norm before scaling: 44.12001731339614. Distance: 1.2032961537877522
Total norm for 4 adversaries is: 44.12001731339614. distance: 1.2032961537877522
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0430, Accuracy: 9783/9900 (98.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5128/5305 (96.6635%), train_poison_data_count: 415
Global model norm: 44.15264216948828.
Norm before scaling: 44.120442011842. Distance: 1.4016929115003505
Total norm for 4 adversaries is: 44.120442011842. distance: 1.4016929115003505
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0415, Accuracy: 9801/9900 (99.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4585/4717 (97.2016%), train_poison_data_count: 370
Global model norm: 44.15264216948828.
Norm before scaling: 44.12070070237722. Distance: 1.1829923606393726
Total norm for 4 adversaries is: 44.12070070237722. distance: 1.1829923606393726
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0761, Accuracy: 9700/9900 (97.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4894/5066 (96.6048%), train_poison_data_count: 400
Global model norm: 44.15264216948828.
Norm before scaling: 44.12469153796219. Distance: 1.3665462625002514
Total norm for 4 adversaries is: 44.12469153796219. distance: 1.3665462625002514
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0469, Accuracy: 9770/9900 (98.6869%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5262/5582 (94.2673%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5177/5582 (92.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0213, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4155/4501 (92.3128%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4068/4501 (90.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0674, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3667/3911 (93.7612%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3389/3911 (86.6530%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.5567, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4376/4663 (93.8452%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4359/4663 (93.4806%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9695, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4923/5265 (93.5043%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4767/5265 (90.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0498, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4046/4416 (91.6214%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4005/4416 (90.6929%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1474, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4173/4433 (94.1349%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4158/4433 (93.7965%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7919, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5832/6263 (93.1183%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5663/6263 (90.4199%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2420, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5089/5455 (93.2906%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4952/5455 (90.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8860, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4321/4634 (93.2456%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4235/4634 (91.3897%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0447, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4365/4707 (92.7342%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4362/4707 (92.6705%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8914, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3885/4126 (94.1590%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3848/4126 (93.2622%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9740, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4810/5116 (94.0188%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4695/5116 (91.7709%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0913, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4678/5063 (92.3958%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4426/5063 (87.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2581, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4063/4361 (93.1667%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3885/4361 (89.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.5468, Accuracy: 4958/10000 (49.5800%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5560/6124 (90.7903%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5535/6124 (90.3821%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0469, Accuracy: 5448/10000 (54.4800%)
time spent on training: 265.8857207298279
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.2947, Accuracy: 6717/10000 (67.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1249, Accuracy: 9581/9900 (96.7778%)
Done in 293.5043828487396 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4755/4885 (97.3388%), train_poison_data_count: 385
Global model norm: 44.17414518175833.
Norm before scaling: 44.14315673049236. Distance: 1.2735176763277574
Total norm for 4 adversaries is: 44.14315673049236. distance: 1.2735176763277574
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0276, Accuracy: 9826/9900 (99.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5129/5305 (96.6824%), train_poison_data_count: 415
Global model norm: 44.17414518175833.
Norm before scaling: 44.14157355175504. Distance: 1.354580150957612
Total norm for 4 adversaries is: 44.14157355175504. distance: 1.354580150957612
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1025, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4569/4717 (96.8624%), train_poison_data_count: 370
Global model norm: 44.17414518175833.
Norm before scaling: 44.14381625632151. Distance: 1.244468322427376
Total norm for 4 adversaries is: 44.14381625632151. distance: 1.244468322427376
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1026, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4917/5066 (97.0588%), train_poison_data_count: 400
Global model norm: 44.17414518175833.
Norm before scaling: 44.14308206657004. Distance: 1.3193521562168127
Total norm for 4 adversaries is: 44.14308206657004. distance: 1.3193521562168127
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0572, Accuracy: 9746/9900 (98.4444%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4089/4356 (93.8705%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3859/4356 (88.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2865, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4108/4362 (94.1770%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4005/4362 (91.8157%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0156, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4373/4679 (93.4601%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4235/4679 (90.5108%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1480, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3825/4158 (91.9913%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3783/4158 (90.9812%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9514, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4359/4651 (93.7218%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4306/4651 (92.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0170, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3904/4175 (93.5090%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3830/4175 (91.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0506, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4325/4618 (93.6553%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4269/4618 (92.4426%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0629, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4239/4625 (91.6541%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4123/4625 (89.1459%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0143, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5234/5582 (93.7657%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5107/5582 (91.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2493, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4466/4874 (91.6291%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4291/4874 (88.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2978, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4567/4934 (92.5618%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4155/4934 (84.2116%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2687, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5107/5424 (94.1556%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5033/5424 (92.7913%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2517, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4460/4804 (92.8393%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4114/4804 (85.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3754, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4615/4918 (93.8390%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4548/4918 (92.4766%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1161, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3617/3861 (93.6804%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3550/3861 (91.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9561, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3955/4223 (93.6538%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3910/4223 (92.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8114, Accuracy: 5835/10000 (58.3500%)
time spent on training: 262.32627606391907
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.3001, Accuracy: 6702/10000 (67.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1207, Accuracy: 9587/9900 (96.8384%)
Done in 290.04746413230896 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4782/4885 (97.8915%), train_poison_data_count: 385
Global model norm: 44.19484639912427.
Norm before scaling: 44.15944150930877. Distance: 1.1592558889562354
Total norm for 4 adversaries is: 44.15944150930877. distance: 1.1592558889562354
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0447, Accuracy: 9776/9900 (98.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5147/5305 (97.0217%), train_poison_data_count: 415
Global model norm: 44.19484639912427.
Norm before scaling: 44.161892000661894. Distance: 1.3722620059735806
Total norm for 4 adversaries is: 44.161892000661894. distance: 1.3722620059735806
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0778, Accuracy: 9700/9900 (97.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4570/4717 (96.8836%), train_poison_data_count: 370
Global model norm: 44.19484639912427.
Norm before scaling: 44.164640867210586. Distance: 1.217054165354926
Total norm for 4 adversaries is: 44.164640867210586. distance: 1.217054165354926
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0517, Accuracy: 9765/9900 (98.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4906/5066 (96.8417%), train_poison_data_count: 400
Global model norm: 44.19484639912427.
Norm before scaling: 44.16469614683415. Distance: 1.3428575080215979
Total norm for 4 adversaries is: 44.16469614683415. distance: 1.3428575080215979
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0330, Accuracy: 9813/9900 (99.1212%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4276/4647 (92.0164%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4246/4647 (91.3708%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8359, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3564/3804 (93.6909%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3516/3804 (92.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9092, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5170/5591 (92.4700%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4961/5591 (88.7319%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2156, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4321/4634 (93.2456%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4262/4634 (91.9724%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9271, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4176/4433 (94.2026%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4140/4433 (93.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8144, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3457/3704 (93.3315%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3418/3704 (92.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8070, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3631/3837 (94.6312%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3631/3837 (94.6312%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8130, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5070/5455 (92.9423%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4905/5455 (89.9175%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2514, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5365/5740 (93.4669%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5255/5740 (91.5505%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1527, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4621/4986 (92.6795%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4578/4986 (91.8171%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9826, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4206/4456 (94.3896%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4171/4456 (93.6041%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9787, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4067/4356 (93.3655%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3794/4356 (87.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2483, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3387/3590 (94.3454%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3300/3590 (91.9220%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9868, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4238/4503 (94.1150%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4132/4503 (91.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9662, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4665/5037 (92.6147%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4681/5037 (92.9323%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9590, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4806/5167 (93.0134%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4704/5167 (91.0393%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0849, Accuracy: 5403/10000 (54.0300%)
time spent on training: 246.45160794258118
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3098, Accuracy: 6678/10000 (66.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1137, Accuracy: 9602/9900 (96.9899%)
Done in 273.9669153690338 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4783/4885 (97.9120%), train_poison_data_count: 385
Global model norm: 44.21417130667426.
Norm before scaling: 44.179096895919706. Distance: 1.2036325449301488
Total norm for 4 adversaries is: 44.179096895919706. distance: 1.2036325449301488
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0108, Accuracy: 9876/9900 (99.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5108/5305 (96.2865%), train_poison_data_count: 415
Global model norm: 44.21417130667426.
Norm before scaling: 44.18281308019768. Distance: 1.4078836065322433
Total norm for 4 adversaries is: 44.18281308019768. distance: 1.4078836065322433
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0507, Accuracy: 9764/9900 (98.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4542/4717 (96.2900%), train_poison_data_count: 370
Global model norm: 44.21417130667426.
Norm before scaling: 44.18548467159846. Distance: 1.2839953156026318
Total norm for 4 adversaries is: 44.18548467159846. distance: 1.2839953156026318
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0607, Accuracy: 9748/9900 (98.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4909/5066 (96.9009%), train_poison_data_count: 400
Global model norm: 44.21417130667426.
Norm before scaling: 44.184053580679. Distance: 1.3457986606741466
Total norm for 4 adversaries is: 44.184053580679. distance: 1.3457986606741466
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0844, Accuracy: 9673/9900 (97.7071%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3352/3638 (92.1385%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3378/3638 (92.8532%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8638, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4379/4716 (92.8541%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4319/4716 (91.5818%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0325, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4562/4956 (92.0500%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4413/4956 (89.0436%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1603, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5054/5392 (93.7315%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4926/5392 (91.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9621, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3893/4184 (93.0449%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3880/4184 (92.7342%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7359, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4142/4481 (92.4347%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3939/4481 (87.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1115, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3398/3646 (93.1980%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3431/3646 (94.1031%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8452, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4666/5025 (92.8557%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4543/5025 (90.4080%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1131, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3376/3590 (94.0390%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3272/3590 (91.1421%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8933, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4276/4596 (93.0374%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4320/4596 (93.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9437, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4047/4336 (93.3349%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3956/4336 (91.2362%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2165, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4466/4874 (91.6291%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4169/4874 (85.5355%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3420, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4813/5167 (93.1488%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4750/5167 (91.9296%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2209, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4330/4618 (93.7635%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4241/4618 (91.8363%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9910, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4539/4928 (92.1063%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4504/4928 (91.3961%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0852, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4318/4647 (92.9202%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4271/4647 (91.9088%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0424, Accuracy: 5493/10000 (54.9300%)
time spent on training: 260.7413954734802
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3144, Accuracy: 6673/10000 (66.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1157, Accuracy: 9598/9900 (96.9495%)
Done in 288.1544919013977 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4766/4885 (97.5640%), train_poison_data_count: 385
Global model norm: 44.233885163748475.
Norm before scaling: 44.1991605791155. Distance: 1.1758408135316551
Total norm for 4 adversaries is: 44.1991605791155. distance: 1.1758408135316551
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1065, Accuracy: 9618/9900 (97.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5137/5305 (96.8332%), train_poison_data_count: 415
Global model norm: 44.233885163748475.
Norm before scaling: 44.200667128555594. Distance: 1.3506835549162655
Total norm for 4 adversaries is: 44.200667128555594. distance: 1.3506835549162655
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0725, Accuracy: 9710/9900 (98.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4576/4717 (97.0108%), train_poison_data_count: 370
Global model norm: 44.233885163748475.
Norm before scaling: 44.20233518205656. Distance: 1.22070546874775
Total norm for 4 adversaries is: 44.20233518205656. distance: 1.22070546874775
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0783, Accuracy: 9674/9900 (97.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4907/5066 (96.8614%), train_poison_data_count: 400
Global model norm: 44.233885163748475.
Norm before scaling: 44.201844990746004. Distance: 1.3002430028479592
Total norm for 4 adversaries is: 44.201844990746004. distance: 1.3002430028479592
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0378, Accuracy: 9809/9900 (99.0808%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4031/4368 (92.2848%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3922/4368 (89.7894%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0688, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4786/5195 (92.1270%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4535/5195 (87.2955%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2292, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4036/4315 (93.5342%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4014/4315 (93.0243%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0953, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3404/3646 (93.3626%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3367/3646 (92.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8106, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3412/3590 (95.0418%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3301/3590 (91.9499%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1946, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3879/4126 (94.0136%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3889/4126 (94.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8391, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4034/4361 (92.5017%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3933/4361 (90.1857%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9965, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3616/3837 (94.2403%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3606/3837 (93.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8126, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4033/4235 (95.2302%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3868/4235 (91.3341%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1553, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5490/5902 (93.0193%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5292/5902 (89.6645%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1897, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4186/4433 (94.4282%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4128/4433 (93.1198%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9544, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3373/3638 (92.7158%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3379/3638 (92.8807%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7945, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4817/5232 (92.0680%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4717/5232 (90.1567%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0668, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4014/4336 (92.5738%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3971/4336 (91.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1447, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4563/4989 (91.4612%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4562/4989 (91.4412%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1162, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4158/4481 (92.7918%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3984/4481 (88.9087%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1562, Accuracy: 5372/10000 (53.7200%)
time spent on training: 255.7005259990692
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3287, Accuracy: 6651/10000 (66.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1072, Accuracy: 9618/9900 (97.1515%)
Done in 283.21475982666016 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4763/4885 (97.5026%), train_poison_data_count: 385
Global model norm: 44.253264743176715.
Norm before scaling: 44.217188852742126. Distance: 1.1778923169158242
Total norm for 4 adversaries is: 44.217188852742126. distance: 1.1778923169158242
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0250, Accuracy: 9837/9900 (99.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5135/5305 (96.7955%), train_poison_data_count: 415
Global model norm: 44.253264743176715.
Norm before scaling: 44.21857056058998. Distance: 1.3139388961809977
Total norm for 4 adversaries is: 44.21857056058998. distance: 1.3139388961809977
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0611, Accuracy: 9751/9900 (98.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4580/4717 (97.0956%), train_poison_data_count: 370
Global model norm: 44.253264743176715.
Norm before scaling: 44.22007092770841. Distance: 1.1631255507429439
Total norm for 4 adversaries is: 44.22007092770841. distance: 1.1631255507429439
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0630, Accuracy: 9720/9900 (98.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4906/5066 (96.8417%), train_poison_data_count: 400
Global model norm: 44.253264743176715.
Norm before scaling: 44.22373536384336. Distance: 1.320076509411393
Total norm for 4 adversaries is: 44.22373536384336. distance: 1.320076509411393
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0485, Accuracy: 9776/9900 (98.7475%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4781/5116 (93.4519%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4703/5116 (91.9273%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9333, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4113/4362 (94.2916%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3925/4362 (89.9817%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2698, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4213/4441 (94.8660%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4196/4441 (94.4832%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9898, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4413/4663 (94.6386%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4367/4663 (93.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9220, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4714/5083 (92.7405%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4568/5083 (89.8682%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0766, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4359/4767 (91.4412%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4217/4767 (88.4623%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2023, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3616/3797 (95.2331%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3564/3797 (93.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9113, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4779/5195 (91.9923%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4669/5195 (89.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0373, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4339/4618 (93.9584%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4272/4618 (92.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0089, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4204/4433 (94.8342%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4094/4433 (92.3528%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8457, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4698/5055 (92.9377%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4626/5055 (91.5134%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9078, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3806/4158 (91.5344%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3794/4158 (91.2458%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9686, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3533/3781 (93.4409%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3282/3781 (86.8024%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3673, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3865/4175 (92.5749%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3754/4175 (89.9162%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9566, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4890/5265 (92.8775%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4769/5265 (90.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1268, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3620/3837 (94.3445%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3615/3837 (94.2142%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8627, Accuracy: 5826/10000 (58.2600%)
time spent on training: 259.3475966453552
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3285, Accuracy: 6644/10000 (66.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1008, Accuracy: 9627/9900 (97.2424%)
Done in 286.7876822948456 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4761/4885 (97.4616%), train_poison_data_count: 385
Global model norm: 44.272799895047015.
Norm before scaling: 44.238414907358795. Distance: 1.2334248712867864
Total norm for 4 adversaries is: 44.238414907358795. distance: 1.2334248712867864
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0296, Accuracy: 9826/9900 (99.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5146/5305 (97.0028%), train_poison_data_count: 415
Global model norm: 44.272799895047015.
Norm before scaling: 44.23786992772355. Distance: 1.3130649985431682
Total norm for 4 adversaries is: 44.23786992772355. distance: 1.3130649985431682
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0363, Accuracy: 9811/9900 (99.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.272799895047015.
Norm before scaling: 44.23892538852238. Distance: 1.1540045715056366
Total norm for 4 adversaries is: 44.23892538852238. distance: 1.1540045715056366
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0819, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4911/5066 (96.9404%), train_poison_data_count: 400
Global model norm: 44.272799895047015.
Norm before scaling: 44.24060579571526. Distance: 1.3053653349627732
Total norm for 4 adversaries is: 44.24060579571526. distance: 1.3053653349627732
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0198, Accuracy: 9849/9900 (99.4848%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3700/3911 (94.6050%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3468/3911 (88.6730%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1730, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4824/5195 (92.8585%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4639/5195 (89.2974%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1545, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3570/3775 (94.5695%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3605/3775 (95.4967%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8000, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4405/4679 (94.1440%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4260/4679 (91.0451%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1429, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4064/4361 (93.1896%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3936/4361 (90.2545%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1395, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3440/3672 (93.6819%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3404/3672 (92.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9930, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4194/4481 (93.5952%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3987/4481 (88.9757%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1009, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3857/4126 (93.4804%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3864/4126 (93.6500%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8681, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3731/3969 (94.0035%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3654/3969 (92.0635%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9448, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4793/5116 (93.6865%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4698/5116 (91.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0068, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4657/5063 (91.9810%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4347/5063 (85.8582%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1910, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3107/3297 (94.2372%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3053/3297 (92.5993%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8359, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4619/5037 (91.7014%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4637/5037 (92.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0163, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4299/4596 (93.5379%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4296/4596 (93.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0485, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4151/4501 (92.2240%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4003/4501 (88.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1201, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4226/4465 (94.6473%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4215/4465 (94.4009%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8667, Accuracy: 5832/10000 (58.3200%)
time spent on training: 255.7882113456726
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3385, Accuracy: 6639/10000 (66.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0943, Accuracy: 9648/9900 (97.4545%)
Done in 283.66004753112793 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4759/4885 (97.4207%), train_poison_data_count: 385
Global model norm: 44.29161261731376.
Norm before scaling: 44.2570560670132. Distance: 1.1851602392060365
Total norm for 4 adversaries is: 44.2570560670132. distance: 1.1851602392060365
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0483, Accuracy: 9774/9900 (98.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5126/5305 (96.6258%), train_poison_data_count: 415
Global model norm: 44.29161261731376.
Norm before scaling: 44.25951494408787. Distance: 1.3699750112774534
Total norm for 4 adversaries is: 44.25951494408787. distance: 1.3699750112774534
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0332, Accuracy: 9809/9900 (99.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4575/4717 (96.9896%), train_poison_data_count: 370
Global model norm: 44.29161261731376.
Norm before scaling: 44.25924327453391. Distance: 1.1957019844535763
Total norm for 4 adversaries is: 44.25924327453391. distance: 1.1957019844535763
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0660, Accuracy: 9727/9900 (98.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4925/5066 (97.2167%), train_poison_data_count: 400
Global model norm: 44.29161261731376.
Norm before scaling: 44.25969697554636. Distance: 1.2699656520914515
Total norm for 4 adversaries is: 44.25969697554636. distance: 1.2699656520914515
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0525, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4032/4361 (92.4559%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4003/4361 (91.7909%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0124, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4112/4346 (94.6157%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4124/4346 (94.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7432, Accuracy: 5999/10000 (59.9900%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5110/5455 (93.6755%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4980/5455 (91.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0555, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4203/4465 (94.1321%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4215/4465 (94.4009%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8271, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4029/4336 (92.9197%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3992/4336 (92.0664%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2023, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4248/4441 (95.6541%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4205/4441 (94.6859%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9378, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4119/4362 (94.4292%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4023/4362 (92.2283%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0713, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3702/3969 (93.2729%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3705/3969 (93.3485%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9829, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3954/4295 (92.0605%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3879/4295 (90.3143%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0231, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4683/5017 (93.3426%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4641/5017 (92.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9073, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4655/5063 (91.9415%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4471/5063 (88.3073%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3749, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3055/3271 (93.3965%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0059, Accuracy: 2934/3271 (89.6973%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0899, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5881/6263 (93.9007%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5758/6263 (91.9368%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1025, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4527/4874 (92.8806%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4361/4874 (89.4748%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1999, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3691/3911 (94.3748%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3453/3911 (88.2894%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0777, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4461/4804 (92.8601%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4221/4804 (87.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1361, Accuracy: 5300/10000 (53.0000%)
time spent on training: 261.67975401878357
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3538, Accuracy: 6608/10000 (66.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0857, Accuracy: 9675/9900 (97.7273%)
Done in 289.1771991252899 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4750/4885 (97.2364%), train_poison_data_count: 385
Global model norm: 44.31066391427054.
Norm before scaling: 44.277078909937984. Distance: 1.2335268800958767
Total norm for 4 adversaries is: 44.277078909937984. distance: 1.2335268800958767
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0177, Accuracy: 9849/9900 (99.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5135/5305 (96.7955%), train_poison_data_count: 415
Global model norm: 44.31066391427054.
Norm before scaling: 44.27757102527686. Distance: 1.383443009766455
Total norm for 4 adversaries is: 44.27757102527686. distance: 1.383443009766455
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0970, Accuracy: 9648/9900 (97.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4568/4717 (96.8412%), train_poison_data_count: 370
Global model norm: 44.31066391427054.
Norm before scaling: 44.279622136186276. Distance: 1.2201267682330295
Total norm for 4 adversaries is: 44.279622136186276. distance: 1.2201267682330295
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0498, Accuracy: 9771/9900 (98.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4923/5066 (97.1773%), train_poison_data_count: 400
Global model norm: 44.31066391427054.
Norm before scaling: 44.27993778930815. Distance: 1.3318267396787449
Total norm for 4 adversaries is: 44.27993778930815. distance: 1.3318267396787449
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0364, Accuracy: 9812/9900 (99.1111%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5492/5902 (93.0532%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5209/5902 (88.2582%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1602, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4608/4918 (93.6966%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4624/4918 (94.0220%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0659, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3786/4025 (94.0621%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3793/4025 (94.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7657, Accuracy: 5974/10000 (59.7400%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3284/3472 (94.5853%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3203/3472 (92.2523%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9864, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4466/4793 (93.1776%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4462/4793 (93.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9059, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4574/4934 (92.7037%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4437/4934 (89.9270%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0647, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3704/3911 (94.7072%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3612/3911 (92.3549%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9996, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5016/5392 (93.0267%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4856/5392 (90.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0447, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3406/3638 (93.6229%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3414/3638 (93.8428%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8103, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5619/6124 (91.7538%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5484/6124 (89.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0011, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3912/4175 (93.7006%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3839/4175 (91.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0065, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4261/4625 (92.1297%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4065/4625 (87.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1651, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4062/4354 (93.2935%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3695/4354 (84.8645%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.4694, Accuracy: 4851/10000 (48.5100%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4176/4511 (92.5737%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4135/4511 (91.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8863, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3503/3704 (94.5734%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3438/3704 (92.8186%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8248, Accuracy: 5959/10000 (59.5900%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3660/3861 (94.7941%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3581/3861 (92.7480%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8990, Accuracy: 5736/10000 (57.3600%)
time spent on training: 255.8242483139038
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3676, Accuracy: 6581/10000 (65.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0866, Accuracy: 9667/9900 (97.6465%)
Done in 283.35902762413025 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4763/4885 (97.5026%), train_poison_data_count: 385
Global model norm: 44.33038304964356.
Norm before scaling: 44.29578096091658. Distance: 1.207931972580822
Total norm for 4 adversaries is: 44.29578096091658. distance: 1.207931972580822
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0148, Accuracy: 9860/9900 (99.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5157/5305 (97.2102%), train_poison_data_count: 415
Global model norm: 44.33038304964356.
Norm before scaling: 44.29326760002585. Distance: 1.3084739060822934
Total norm for 4 adversaries is: 44.29326760002585. distance: 1.3084739060822934
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0426, Accuracy: 9787/9900 (98.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4587/4717 (97.2440%), train_poison_data_count: 370
Global model norm: 44.33038304964356.
Norm before scaling: 44.29817430854586. Distance: 1.1846935337066955
Total norm for 4 adversaries is: 44.29817430854586. distance: 1.1846935337066955
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0878, Accuracy: 9676/9900 (97.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4918/5066 (97.0786%), train_poison_data_count: 400
Global model norm: 44.33038304964356.
Norm before scaling: 44.29692873673989. Distance: 1.3071661150498795
Total norm for 4 adversaries is: 44.29692873673989. distance: 1.3071661150498795
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0240, Accuracy: 9845/9900 (99.4444%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4675/5083 (91.9732%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4461/5083 (87.7631%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2556, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3452/3646 (94.6791%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3376/3646 (92.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9212, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4236/4503 (94.0706%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4149/4503 (92.1386%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0477, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4208/4501 (93.4903%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4100/4501 (91.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9205, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3758/4013 (93.6457%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3711/4013 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8750, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4170/4362 (95.5983%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3965/4362 (90.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1637, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4096/4315 (94.9247%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4069/4315 (94.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8757, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4368/4651 (93.9153%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4260/4651 (91.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1531, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4086/4416 (92.5272%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4066/4416 (92.0743%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1230, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3442/3704 (92.9266%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3470/3704 (93.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8608, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4363/4707 (92.6917%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4303/4707 (91.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8951, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4322/4662 (92.7070%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4343/4662 (93.1574%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8790, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5067/5424 (93.4181%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4993/5424 (92.0538%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1947, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4064/4336 (93.7269%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4021/4336 (92.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9558, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4158/4481 (92.7918%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3968/4481 (88.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1001, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3630/3828 (94.8276%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3619/3828 (94.5402%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7517, Accuracy: 5949/10000 (59.4900%)
time spent on training: 258.134890794754
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3653, Accuracy: 6585/10000 (65.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0836, Accuracy: 9678/9900 (97.7576%)
Done in 285.63616824150085 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4757/4885 (97.3797%), train_poison_data_count: 385
Global model norm: 44.3487460848317.
Norm before scaling: 44.31505358915157. Distance: 1.2793599120472423
Total norm for 4 adversaries is: 44.31505358915157. distance: 1.2793599120472423
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0254, Accuracy: 9842/9900 (99.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5149/5305 (97.0594%), train_poison_data_count: 415
Global model norm: 44.3487460848317.
Norm before scaling: 44.31587032096614. Distance: 1.3729412097888603
Total norm for 4 adversaries is: 44.31587032096614. distance: 1.3729412097888603
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0152, Accuracy: 9865/9900 (99.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4568/4717 (96.8412%), train_poison_data_count: 370
Global model norm: 44.3487460848317.
Norm before scaling: 44.31819510079565. Distance: 1.2404340448124294
Total norm for 4 adversaries is: 44.31819510079565. distance: 1.2404340448124294
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0690, Accuracy: 9725/9900 (98.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4913/5066 (96.9799%), train_poison_data_count: 400
Global model norm: 44.3487460848317.
Norm before scaling: 44.31614164338148. Distance: 1.3082773310020481
Total norm for 4 adversaries is: 44.31614164338148. distance: 1.3082773310020481
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0901, Accuracy: 9686/9900 (97.8384%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3904/4184 (93.3078%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3875/4184 (92.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8799, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4615/5037 (91.6220%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4627/5037 (91.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9813, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3833/4158 (92.1837%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3824/4158 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8238, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3038/3271 (92.8768%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3025/3271 (92.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7401, Accuracy: 6035/10000 (60.3500%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4633/4918 (94.2050%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4559/4918 (92.7003%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1477, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5465/5902 (92.5957%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5192/5902 (87.9702%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2578, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4078/4354 (93.6610%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0132, Accuracy: 3329/4354 (76.4584%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.7001, Accuracy: 4522/10000 (45.2200%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3772/3969 (95.0365%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3680/3969 (92.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9985, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4063/4356 (93.2736%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3899/4356 (89.5087%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3347, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4023/4295 (93.6671%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3697/4295 (86.0768%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.4147, Accuracy: 4790/10000 (47.9000%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3897/4126 (94.4498%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3883/4126 (94.1105%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8961, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4641/4928 (94.1761%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4562/4928 (92.5731%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8530, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4198/4511 (93.0614%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4151/4511 (92.0195%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0132, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4341/4618 (94.0017%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4190/4618 (90.7319%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0062, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3468/3704 (93.6285%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3454/3704 (93.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8183, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3349/3616 (92.6162%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3335/3616 (92.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0599, Accuracy: 5671/10000 (56.7100%)
time spent on training: 254.89563846588135
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3605, Accuracy: 6599/10000 (65.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0844, Accuracy: 9677/9900 (97.7475%)
Done in 282.0759561061859 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.367745335681356.
Norm before scaling: 44.3314693508425. Distance: 1.1648791220172774
Total norm for 4 adversaries is: 44.3314693508425. distance: 1.1648791220172774
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0950, Accuracy: 9663/9900 (97.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5151/5305 (97.0971%), train_poison_data_count: 415
Global model norm: 44.367745335681356.
Norm before scaling: 44.332393167799715. Distance: 1.313070173394468
Total norm for 4 adversaries is: 44.332393167799715. distance: 1.313070173394468
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0881, Accuracy: 9682/9900 (97.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4584/4717 (97.1804%), train_poison_data_count: 370
Global model norm: 44.367745335681356.
Norm before scaling: 44.33395163504067. Distance: 1.1556064773816415
Total norm for 4 adversaries is: 44.33395163504067. distance: 1.1556064773816415
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0415, Accuracy: 9794/9900 (98.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4927/5066 (97.2562%), train_poison_data_count: 400
Global model norm: 44.367745335681356.
Norm before scaling: 44.33584182258399. Distance: 1.2897126841137068
Total norm for 4 adversaries is: 44.33584182258399. distance: 1.2897126841137068
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0529, Accuracy: 9770/9900 (98.6869%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3017/3271 (92.2348%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3034/3271 (92.7545%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8595, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4200/4456 (94.2549%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4180/4456 (93.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8537, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3804/4013 (94.7919%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3778/4013 (94.1440%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.6880, Accuracy: 6004/10000 (60.0400%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3521/3781 (93.1235%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3465/3781 (91.6424%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0164, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3544/3775 (93.8808%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3574/3775 (94.6755%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8104, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4838/5232 (92.4694%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4723/5232 (90.2714%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2420, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4612/4989 (92.4434%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4503/4989 (90.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1241, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3433/3646 (94.1580%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3425/3646 (93.9386%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8079, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4113/4315 (95.3187%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4040/4315 (93.6269%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9499, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4620/4918 (93.9406%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4551/4918 (92.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1061, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4085/4416 (92.5045%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3996/4416 (90.4891%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9824, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5824/6263 (92.9906%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5785/6263 (92.3679%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9075, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5673/6124 (92.6355%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5387/6124 (87.9654%)
