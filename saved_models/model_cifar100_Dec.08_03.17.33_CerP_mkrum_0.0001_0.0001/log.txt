current path: saved_models/model_cifar100_Dec.08_03.17.33_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4311/4885 (88.2497%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439983761538926. Distance: 2.294408291102636
Total norm for 4 adversaries is: 42.439983761538926. distance: 2.294408291102636
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4386, Accuracy: 8842/9900 (89.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435230402306935. Distance: 2.2505272141654316
Total norm for 4 adversaries is: 42.435230402306935. distance: 2.2505272141654316
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7221, Accuracy: 8320/9900 (84.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4179/4717 (88.5944%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438698033991486. Distance: 2.1782590499194323
Total norm for 4 adversaries is: 42.438698033991486. distance: 2.1782590499194323
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4254, Accuracy: 8892/9900 (89.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4457/5066 (87.9787%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44034042178723. Distance: 2.3035787728024633
Total norm for 4 adversaries is: 42.44034042178723. distance: 2.3035787728024633
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5932, Accuracy: 8523/9900 (86.0909%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3836/4356 (88.0624%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3699/4356 (84.9174%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4975, Accuracy: 4623/10000 (46.2300%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3938/4465 (88.1971%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4095/4465 (91.7133%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0326, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4047/4647 (87.0884%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4173/4647 (89.7999%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9773, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4448/5055 (87.9921%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4526/5055 (89.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0469, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4439/5116 (86.7670%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4481/5116 (87.5880%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9626, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3630/4126 (87.9787%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3774/4126 (91.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9943, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3084/3472 (88.8249%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3225/3472 (92.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1046, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4431/4986 (88.8688%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4437/4986 (88.9892%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0087, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3539/4013 (88.1884%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3684/4013 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7832, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4034/4618 (87.3538%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4077/4618 (88.2850%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1114, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4431/5083 (87.1729%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4467/5083 (87.8812%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0733, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3971/4511 (88.0293%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4029/4511 (89.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0887, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3336/3797 (87.8588%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3391/3797 (89.3073%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9872, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4999/5582 (89.5557%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5065/5582 (90.7381%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1283, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3152/3616 (87.1681%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3212/3616 (88.8274%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0719, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4824/5455 (88.4326%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4849/5455 (88.8909%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9342, Accuracy: 5373/10000 (53.7300%)
time spent on training: 258.7972185611725
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1051, Accuracy: 7049/10000 (70.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0686, Accuracy: 118/9900 (1.1919%)
Done in 286.03456449508667 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 42.454726575420906.
Norm before scaling: 42.46078009975426. Distance: 2.1125098775598863
Total norm for 4 adversaries is: 42.46078009975426. distance: 2.1125098775598863
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2447, Accuracy: 9250/9900 (93.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 42.454726575420906.
Norm before scaling: 42.45809054968205. Distance: 2.1650618576480967
Total norm for 4 adversaries is: 42.45809054968205. distance: 2.1650618576480967
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5722, Accuracy: 8509/9900 (85.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4191/4717 (88.8488%), train_poison_data_count: 370
Global model norm: 42.454726575420906.
Norm before scaling: 42.462000475425086. Distance: 2.165392635589645
Total norm for 4 adversaries is: 42.462000475425086. distance: 2.165392635589645
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2161, Accuracy: 9388/9900 (94.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4498/5066 (88.7880%), train_poison_data_count: 400
Global model norm: 42.454726575420906.
Norm before scaling: 42.464902500016855. Distance: 2.2924121915584594
Total norm for 4 adversaries is: 42.464902500016855. distance: 2.2924121915584594
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2598, Accuracy: 9188/9900 (92.8081%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3605/4025 (89.5652%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3729/4025 (92.6460%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9084, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3347/3797 (88.1485%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3403/3797 (89.6234%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0065, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3932/4625 (85.0162%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4012/4625 (86.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2361, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3852/4481 (85.9630%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3881/4481 (86.6101%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1523, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3863/4315 (89.5249%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3982/4315 (92.2827%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9626, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3706/4235 (87.5089%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3814/4235 (90.0590%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9950, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3376/3828 (88.1923%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3480/3828 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8854, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3821/4416 (86.5263%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3964/4416 (89.7645%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8936, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3154/3638 (86.6960%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3286/3638 (90.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9756, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4542/5265 (86.2678%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4472/5265 (84.9383%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0057, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3356/3781 (88.7596%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3325/3781 (87.9397%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1684, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3993/4441 (89.9122%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4030/4441 (90.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1328, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3970/4433 (89.5556%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4015/4433 (90.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9846, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4442/5083 (87.3893%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4429/5083 (87.1336%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0772, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4326/4928 (87.7841%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4390/4928 (89.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8955, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4172/4793 (87.0436%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4371/4793 (91.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0141, Accuracy: 5419/10000 (54.1900%)
time spent on training: 252.30327939987183
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0962, Accuracy: 7062/10000 (70.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.0720, Accuracy: 226/9900 (2.2828%)
Done in 279.42628145217896 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4448/4885 (91.0542%), train_poison_data_count: 385
Global model norm: 42.47723425186131.
Norm before scaling: 42.477974244288504. Distance: 2.0209036614938642
Total norm for 4 adversaries is: 42.477974244288504. distance: 2.0209036614938642
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2386, Accuracy: 9257/9900 (93.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.47723425186131.
Norm before scaling: 42.47849726028673. Distance: 2.0935641533656932
Total norm for 4 adversaries is: 42.47849726028673. distance: 2.0935641533656932
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0879, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4255/4717 (90.2056%), train_poison_data_count: 370
Global model norm: 42.47723425186131.
Norm before scaling: 42.478915381082004. Distance: 1.9862541852634477
Total norm for 4 adversaries is: 42.478915381082004. distance: 1.9862541852634477
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2206, Accuracy: 9332/9900 (94.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4519/5066 (89.2025%), train_poison_data_count: 400
Global model norm: 42.47723425186131.
Norm before scaling: 42.48346415445073. Distance: 2.161536770665144
Total norm for 4 adversaries is: 42.48346415445073. distance: 2.161536770665144
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1570, Accuracy: 9501/9900 (95.9697%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3155/3616 (87.2511%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3308/3616 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8183, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3412/3837 (88.9236%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3488/3837 (90.9044%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9286, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4180/4679 (89.3353%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4299/4679 (91.8786%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0952, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3105/3638 (85.3491%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3265/3638 (89.7471%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0055, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3625/4046 (89.5947%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3638/4046 (89.9160%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9945, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3980/4518 (88.0921%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4114/4518 (91.0580%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1103, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3381/3797 (89.0440%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3423/3797 (90.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0644, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4434/5025 (88.2388%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4408/5025 (87.7214%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3650, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3916/4362 (89.7753%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3948/4362 (90.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9997, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4003/4558 (87.8236%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4041/4558 (88.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1767, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3205/3672 (87.2821%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3268/3672 (88.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1184, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4325/4874 (88.7362%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4332/4874 (88.8798%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2495, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3612/4025 (89.7391%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3709/4025 (92.1491%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9388, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4084/4663 (87.5831%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4242/4663 (90.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1576, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3460/3911 (88.4684%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3463/3911 (88.5451%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9553, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4443/5017 (88.5589%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4558/5017 (90.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8429, Accuracy: 5650/10000 (56.5000%)
time spent on training: 255.21197867393494
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0905, Accuracy: 7060/10000 (70.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.0762, Accuracy: 433/9900 (4.3737%)
Done in 282.6063702106476 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 42.49766480257327.
Norm before scaling: 42.499820484455434. Distance: 1.969554131392739
Total norm for 4 adversaries is: 42.499820484455434. distance: 1.969554131392739
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5357, Accuracy: 8671/9900 (87.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4831/5305 (91.0650%), train_poison_data_count: 415
Global model norm: 42.49766480257327.
Norm before scaling: 42.49567274615661. Distance: 2.018427593362218
Total norm for 4 adversaries is: 42.49567274615661. distance: 2.018427593362218
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0749, Accuracy: 9695/9900 (97.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 42.49766480257327.
Norm before scaling: 42.499175658365715. Distance: 1.9559151213548558
Total norm for 4 adversaries is: 42.499175658365715. distance: 1.9559151213548558
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1421, Accuracy: 9529/9900 (96.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4537/5066 (89.5578%), train_poison_data_count: 400
Global model norm: 42.49766480257327.
Norm before scaling: 42.50361456366461. Distance: 2.118637433057838
Total norm for 4 adversaries is: 42.50361456366461. distance: 2.118637433057838
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3388, Accuracy: 9028/9900 (91.1919%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5263/6124 (85.9406%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5301/6124 (86.5611%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1836, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3866/4356 (88.7511%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3686/4356 (84.6189%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3012, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3536/4158 (85.0409%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3581/4158 (86.1231%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0980, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4895/5455 (89.7342%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4903/5455 (89.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9838, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3931/4511 (87.1425%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4059/4511 (89.9800%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9042, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4534/5232 (86.6590%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4504/5232 (86.0856%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1160, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4498/5244 (85.7742%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4538/5244 (86.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0650, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4385/4918 (89.1623%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4403/4918 (89.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0407, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3618/4126 (87.6878%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3725/4126 (90.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8367, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4356/4928 (88.3929%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4382/4928 (88.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1297, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3736/4223 (88.4679%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3836/4223 (90.8359%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9703, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4530/5195 (87.1992%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4615/5195 (88.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1306, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4162/4679 (88.9506%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4151/4679 (88.7155%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0202, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3204/3646 (87.8771%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3302/3646 (90.5650%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8512, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3196/3616 (88.3850%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3210/3616 (88.7721%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9296, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4071/4716 (86.3232%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4099/4716 (86.9169%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9841, Accuracy: 5399/10000 (53.9900%)
time spent on training: 262.298686504364
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0881, Accuracy: 7056/10000 (70.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.4181, Accuracy: 707/9900 (7.1414%)
Done in 289.4310710430145 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 42.522674615378.
Norm before scaling: 42.52560694562454. Distance: 1.9575330505893842
Total norm for 4 adversaries is: 42.52560694562454. distance: 1.9575330505893842
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1726, Accuracy: 9477/9900 (95.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4861/5305 (91.6305%), train_poison_data_count: 415
Global model norm: 42.522674615378.
Norm before scaling: 42.51767784918998. Distance: 1.983076917544508
Total norm for 4 adversaries is: 42.51767784918998. distance: 1.983076917544508
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1407, Accuracy: 9547/9900 (96.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4284/4717 (90.8204%), train_poison_data_count: 370
Global model norm: 42.522674615378.
Norm before scaling: 42.52327602509301. Distance: 1.917236747824233
Total norm for 4 adversaries is: 42.52327602509301. distance: 1.917236747824233
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1999, Accuracy: 9377/9900 (94.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4555/5066 (89.9131%), train_poison_data_count: 400
Global model norm: 42.522674615378.
Norm before scaling: 42.530086145446056. Distance: 2.0815931936491423
Total norm for 4 adversaries is: 42.530086145446056. distance: 2.0815931936491423
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2704, Accuracy: 9235/9900 (93.2828%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5284/6124 (86.2835%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5343/6124 (87.2469%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0425, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3964/4433 (89.4203%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4037/4433 (91.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9452, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3375/3781 (89.2621%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3214/3781 (85.0040%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3531, Accuracy: 4913/10000 (49.1300%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3569/3969 (89.9219%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3561/3969 (89.7203%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0222, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4466/5025 (88.8756%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4516/5025 (89.8706%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1901, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4180/4679 (89.3353%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4232/4679 (90.4467%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0978, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4164/4707 (88.4640%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4214/4707 (89.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9822, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4435/4986 (88.9491%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4450/4986 (89.2499%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8917, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3914/4315 (90.7068%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3973/4315 (92.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8351, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3856/4416 (87.3188%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3927/4416 (88.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9744, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4243/4804 (88.3222%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4054/4804 (84.3880%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1191, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4178/4793 (87.1688%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4292/4793 (89.5473%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0994, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4552/5232 (87.0031%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4573/5232 (87.4044%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9656, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4117/4662 (88.3097%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4214/4662 (90.3904%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0812, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4250/4956 (85.7546%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4311/4956 (86.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1978, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3840/4368 (87.9121%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3800/4368 (86.9963%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0096, Accuracy: 5367/10000 (53.6700%)
time spent on training: 260.1198184490204
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0883, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7187, Accuracy: 1088/9900 (10.9899%)
Done in 287.4178409576416 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 42.54704714434511.
Norm before scaling: 42.54725658569245. Distance: 1.923898515526969
Total norm for 4 adversaries is: 42.54725658569245. distance: 1.923898515526969
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2837, Accuracy: 9196/9900 (92.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4854/5305 (91.4986%), train_poison_data_count: 415
Global model norm: 42.54704714434511.
Norm before scaling: 42.54390826968504. Distance: 1.9544925022210762
Total norm for 4 adversaries is: 42.54390826968504. distance: 1.9544925022210762
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2180, Accuracy: 9348/9900 (94.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4321/4717 (91.6048%), train_poison_data_count: 370
Global model norm: 42.54704714434511.
Norm before scaling: 42.546732980390956. Distance: 1.8619106537989685
Total norm for 4 adversaries is: 42.546732980390956. distance: 1.8619106537989685
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2421, Accuracy: 9286/9900 (93.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4601/5066 (90.8212%), train_poison_data_count: 400
Global model norm: 42.54704714434511.
Norm before scaling: 42.551522652874894. Distance: 2.016993449929098
Total norm for 4 adversaries is: 42.551522652874894. distance: 2.016993449929098
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1104, Accuracy: 9615/9900 (97.1212%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5356/6124 (87.4592%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5398/6124 (88.1450%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9787, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5168/5902 (87.5635%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5132/5902 (86.9536%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1388, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4179/4707 (88.7827%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4194/4707 (89.1013%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9577, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4093/4647 (88.0783%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4176/4647 (89.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9146, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2979/3297 (90.3549%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3027/3297 (91.8107%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8036, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5574/6263 (88.9989%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5627/6263 (89.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2306, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4181/4663 (89.6633%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4251/4663 (91.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1437, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4339/4956 (87.5504%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4392/4956 (88.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2118, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3623/4046 (89.5452%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3695/4046 (91.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9744, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3726/4184 (89.0535%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3753/4184 (89.6989%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8709, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4879/5591 (87.2652%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4878/5591 (87.2474%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1512, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4089/4634 (88.2391%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4199/4634 (90.6129%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8989, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3404/3828 (88.9237%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3505/3828 (91.5622%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0165, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3146/3638 (86.4761%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3280/3638 (90.1594%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8120, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3390/3781 (89.6588%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3362/3781 (88.9183%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2972, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3428/3837 (89.3406%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3522/3837 (91.7905%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9920, Accuracy: 5561/10000 (55.6100%)
time spent on training: 261.23234391212463
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0843, Accuracy: 7085/10000 (70.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.1889, Accuracy: 1423/9900 (14.3737%)
Done in 288.58230447769165 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4479/4885 (91.6888%), train_poison_data_count: 385
Global model norm: 42.57053544743418.
Norm before scaling: 42.56883499569403. Distance: 1.8576781279637407
Total norm for 4 adversaries is: 42.56883499569403. distance: 1.8576781279637407
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2747, Accuracy: 9236/9900 (93.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4869/5305 (91.7813%), train_poison_data_count: 415
Global model norm: 42.57053544743418.
Norm before scaling: 42.5681797444736. Distance: 1.9428570428816185
Total norm for 4 adversaries is: 42.5681797444736. distance: 1.9428570428816185
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1477, Accuracy: 9547/9900 (96.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 42.57053544743418.
Norm before scaling: 42.57244371500405. Distance: 1.884079439634679
Total norm for 4 adversaries is: 42.57244371500405. distance: 1.884079439634679
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1497, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4617/5066 (91.1370%), train_poison_data_count: 400
Global model norm: 42.57053544743418.
Norm before scaling: 42.57233188800929. Distance: 1.9494624472888116
Total norm for 4 adversaries is: 42.57233188800929. distance: 1.9494624472888116
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2493, Accuracy: 9298/9900 (93.9192%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3900/4501 (86.6474%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3941/4501 (87.5583%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0642, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3716/4175 (89.0060%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3759/4175 (90.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8974, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3159/3616 (87.3617%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3228/3616 (89.2699%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8706, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4063/4634 (87.6780%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4109/4634 (88.6707%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9239, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4030/4558 (88.4160%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3988/4558 (87.4945%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1107, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4563/5167 (88.3104%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4613/5167 (89.2781%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1123, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3899/4356 (89.5087%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3871/4356 (88.8659%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1719, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4138/4716 (87.7439%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4171/4716 (88.4436%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1216, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5406/6124 (88.2756%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5334/6124 (87.0999%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0457, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4472/5055 (88.4669%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4569/5055 (90.3858%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0255, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4519/5025 (89.9303%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4593/5025 (91.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0725, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4388/4918 (89.2233%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4387/4918 (89.2029%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1751, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3763/4223 (89.1073%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3801/4223 (90.0071%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9094, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3931/4481 (87.7260%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3854/4481 (86.0076%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0351, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3209/3638 (88.2078%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3274/3638 (89.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8954, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3590/4013 (89.4593%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3673/4013 (91.5275%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8188, Accuracy: 5644/10000 (56.4400%)
time spent on training: 258.6717550754547
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0841, Accuracy: 7082/10000 (70.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.6767, Accuracy: 1918/9900 (19.3737%)
Done in 286.15302634239197 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4508/4885 (92.2825%), train_poison_data_count: 385
Global model norm: 42.59382451387466.
Norm before scaling: 42.5914657999038. Distance: 1.8383620465279356
Total norm for 4 adversaries is: 42.5914657999038. distance: 1.8383620465279356
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2351, Accuracy: 9314/9900 (94.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4859/5305 (91.5928%), train_poison_data_count: 415
Global model norm: 42.59382451387466.
Norm before scaling: 42.59094273810234. Distance: 1.924226826051839
Total norm for 4 adversaries is: 42.59094273810234. distance: 1.924226826051839
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2263, Accuracy: 9361/9900 (94.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 42.59382451387466.
Norm before scaling: 42.59266810117162. Distance: 1.7829645170616695
Total norm for 4 adversaries is: 42.59266810117162. distance: 1.7829645170616695
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4362, Accuracy: 8842/9900 (89.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4613/5066 (91.0580%), train_poison_data_count: 400
Global model norm: 42.59382451387466.
Norm before scaling: 42.59498089518221. Distance: 1.9552520156340751
Total norm for 4 adversaries is: 42.59498089518221. distance: 1.9552520156340751
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1310, Accuracy: 9567/9900 (96.6364%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3211/3646 (88.0691%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3309/3646 (90.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7929, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3957/4501 (87.9138%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4003/4501 (88.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0177, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4106/4651 (88.2821%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4200/4651 (90.3032%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0124, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4602/5167 (89.0652%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4676/5167 (90.4974%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1411, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4912/5455 (90.0458%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4907/5455 (89.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0051, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4888/5591 (87.4262%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4889/5591 (87.4441%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1479, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4231/4679 (90.4253%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4164/4679 (88.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1724, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4479/5017 (89.2765%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4495/5017 (89.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8583, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4266/4793 (89.0048%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4300/4793 (89.7142%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0469, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4035/4456 (90.5521%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4088/4456 (91.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9026, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4839/5424 (89.2146%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4923/5424 (90.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1310, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3677/4175 (88.0719%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3678/4175 (88.0958%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9844, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4562/5116 (89.1712%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4528/5116 (88.5066%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0607, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3303/3704 (89.1739%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3367/3704 (90.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9701, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4520/5232 (86.3914%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4651/5232 (88.8953%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1201, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3112/3472 (89.6313%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3163/3472 (91.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0361, Accuracy: 5491/10000 (54.9100%)
time spent on training: 264.42759466171265
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0859, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.1889, Accuracy: 2483/9900 (25.0808%)
Done in 291.91124296188354 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4515/4885 (92.4258%), train_poison_data_count: 385
Global model norm: 42.61754625765587.
Norm before scaling: 42.615400827580075. Distance: 1.804660483153936
Total norm for 4 adversaries is: 42.615400827580075. distance: 1.804660483153936
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1886, Accuracy: 9442/9900 (95.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4880/5305 (91.9887%), train_poison_data_count: 415
Global model norm: 42.61754625765587.
Norm before scaling: 42.61152359819319. Distance: 1.8832341905115373
Total norm for 4 adversaries is: 42.61152359819319. distance: 1.8832341905115373
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2038, Accuracy: 9426/9900 (95.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 42.61754625765587.
Norm before scaling: 42.61454434401989. Distance: 1.786496183329919
Total norm for 4 adversaries is: 42.61454434401989. distance: 1.786496183329919
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1489, Accuracy: 9536/9900 (96.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4639/5066 (91.5713%), train_poison_data_count: 400
Global model norm: 42.61754625765587.
Norm before scaling: 42.61890965241764. Distance: 1.9225308919540351
Total norm for 4 adversaries is: 42.61890965241764. distance: 1.9225308919540351
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3665, Accuracy: 8990/9900 (90.8081%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3240/3590 (90.2507%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3332/3590 (92.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9528, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3878/4368 (88.7821%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3848/4368 (88.0952%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8452, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3309/3704 (89.3359%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3379/3704 (91.2257%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9067, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4351/4928 (88.2914%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4362/4928 (88.5146%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1058, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3926/4356 (90.1286%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3862/4356 (88.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1302, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3509/3911 (89.7213%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3353/3911 (85.7325%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2098, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4149/4651 (89.2066%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4197/4651 (90.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1206, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3757/4184 (89.7945%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3774/4184 (90.2008%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9358, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3929/4346 (90.4050%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3981/4346 (91.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8518, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4218/4793 (88.0033%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4341/4793 (90.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0165, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3434/3804 (90.2734%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3473/3804 (91.2986%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8804, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4497/4986 (90.1925%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4467/4986 (89.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8862, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5395/6124 (88.0960%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5275/6124 (86.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1709, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4186/4707 (88.9314%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4221/4707 (89.6750%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9964, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3829/4235 (90.4132%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3688/4235 (87.0838%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0758, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3662/4046 (90.5091%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3709/4046 (91.6708%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0295, Accuracy: 5332/10000 (53.3200%)
time spent on training: 258.4095516204834
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0901, Accuracy: 7068/10000 (70.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.7370, Accuracy: 3029/9900 (30.5960%)
Done in 286.25439524650574 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4557/4885 (93.2856%), train_poison_data_count: 385
Global model norm: 42.639894987338444.
Norm before scaling: 42.63417755396631. Distance: 1.7725857609284217
Total norm for 4 adversaries is: 42.63417755396631. distance: 1.7725857609284217
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0649, Accuracy: 9736/9900 (98.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4904/5305 (92.4411%), train_poison_data_count: 415
Global model norm: 42.639894987338444.
Norm before scaling: 42.63552037510801. Distance: 1.841902825877021
Total norm for 4 adversaries is: 42.63552037510801. distance: 1.841902825877021
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1033, Accuracy: 9648/9900 (97.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4350/4717 (92.2196%), train_poison_data_count: 370
Global model norm: 42.639894987338444.
Norm before scaling: 42.636971948687034. Distance: 1.748750853903005
Total norm for 4 adversaries is: 42.636971948687034. distance: 1.748750853903005
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3406, Accuracy: 9119/9900 (92.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 42.639894987338444.
Norm before scaling: 42.64129631433814. Distance: 1.9407049558818315
Total norm for 4 adversaries is: 42.64129631433814. distance: 1.9407049558818315
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1649, Accuracy: 9481/9900 (95.7677%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4462/4986 (89.4906%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4489/4986 (90.0321%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0977, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4081/4634 (88.0665%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4151/4634 (89.5770%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9156, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4164/4716 (88.2952%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4209/4716 (89.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1896, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5377/6124 (87.8021%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5399/6124 (88.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1719, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4401/4918 (89.4876%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4508/4918 (91.6633%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9991, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3408/3797 (89.7551%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3433/3797 (90.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0822, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4999/5582 (89.5557%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5044/5582 (90.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1688, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4348/4956 (87.7320%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4347/4956 (87.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2051, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4010/4433 (90.4579%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4015/4433 (90.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8575, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3883/4354 (89.1824%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3381/4354 (77.6527%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4645, Accuracy: 4699/10000 (46.9900%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4359/4928 (88.4537%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4423/4928 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8687, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3499/3911 (89.4656%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3452/3911 (88.2639%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0474, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3856/4481 (86.0522%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3818/4481 (85.2042%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1577, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4607/5197 (88.6473%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4620/5197 (88.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0520, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4856/5455 (89.0192%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4913/5455 (90.0642%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0464, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3845/4361 (88.1679%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3762/4361 (86.2646%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1406, Accuracy: 5146/10000 (51.4600%)
time spent on training: 266.44096398353577
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.0950, Accuracy: 7047/10000 (70.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.3557, Accuracy: 3562/9900 (35.9798%)
Done in 293.65054202079773 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4535/4885 (92.8352%), train_poison_data_count: 385
Global model norm: 42.66545373464125.
Norm before scaling: 42.664940163331124. Distance: 1.7756057457851764
Total norm for 4 adversaries is: 42.664940163331124. distance: 1.7756057457851764
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1602, Accuracy: 9517/9900 (96.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4914/5305 (92.6296%), train_poison_data_count: 415
Global model norm: 42.66545373464125.
Norm before scaling: 42.65859940874319. Distance: 1.8313489997845416
Total norm for 4 adversaries is: 42.65859940874319. distance: 1.8313489997845416
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1346, Accuracy: 9538/9900 (96.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4367/4717 (92.5800%), train_poison_data_count: 370
Global model norm: 42.66545373464125.
Norm before scaling: 42.65944928478625. Distance: 1.708022678631166
Total norm for 4 adversaries is: 42.65944928478625. distance: 1.708022678631166
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0704, Accuracy: 9714/9900 (98.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4627/5066 (91.3344%), train_poison_data_count: 400
Global model norm: 42.66545373464125.
Norm before scaling: 42.66812735282479. Distance: 1.9122379248077364
Total norm for 4 adversaries is: 42.66812735282479. distance: 1.9122379248077364
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1642, Accuracy: 9489/9900 (95.8485%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4340/4928 (88.0682%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4369/4928 (88.6567%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9389, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3789/4184 (90.5593%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3806/4184 (90.9656%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9248, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4256/4707 (90.4185%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4246/4707 (90.2061%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0282, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3452/3828 (90.1776%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3534/3828 (92.3197%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9225, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4016/4503 (89.1850%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4028/4503 (89.4515%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9680, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4204/4662 (90.1759%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4232/4662 (90.7765%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9359, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3790/4235 (89.4923%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3809/4235 (89.9410%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0879, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4464/5244 (85.1259%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4490/5244 (85.6217%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9796, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4264/4793 (88.9631%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4345/4793 (90.6530%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9831, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3983/4481 (88.8864%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3901/4481 (87.0565%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1952, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3969/4346 (91.3254%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4027/4346 (92.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7514, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3842/4361 (88.0991%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3714/4361 (85.1640%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1731, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4572/5055 (90.4451%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4563/5055 (90.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9723, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4585/5195 (88.2579%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4546/5195 (87.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1985, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3932/4315 (91.1240%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3989/4315 (92.4450%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9475, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4214/4663 (90.3710%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4291/4663 (92.0223%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0752, Accuracy: 5382/10000 (53.8200%)
time spent on training: 259.298903465271
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1005, Accuracy: 7041/10000 (70.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.9307, Accuracy: 4137/9900 (41.7879%)
Done in 286.51893496513367 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4550/4885 (93.1423%), train_poison_data_count: 385
Global model norm: 42.68891406195598.
Norm before scaling: 42.68507210793224. Distance: 1.699334291936505
Total norm for 4 adversaries is: 42.68507210793224. distance: 1.699334291936505
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1764, Accuracy: 9484/9900 (95.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4918/5305 (92.7050%), train_poison_data_count: 415
Global model norm: 42.68891406195598.
Norm before scaling: 42.68401254284574. Distance: 1.8151812616847955
Total norm for 4 adversaries is: 42.68401254284574. distance: 1.8151812616847955
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2196, Accuracy: 9355/9900 (94.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4381/4717 (92.8768%), train_poison_data_count: 370
Global model norm: 42.68891406195598.
Norm before scaling: 42.68303731934605. Distance: 1.6707542441937944
Total norm for 4 adversaries is: 42.68303731934605. distance: 1.6707542441937944
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1839, Accuracy: 9471/9900 (95.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4670/5066 (92.1832%), train_poison_data_count: 400
Global model norm: 42.68891406195598.
Norm before scaling: 42.68881111868264. Distance: 1.842111538395913
Total norm for 4 adversaries is: 42.68881111868264. distance: 1.842111538395913
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1543, Accuracy: 9494/9900 (95.8990%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3977/4315 (92.1669%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3967/4315 (91.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8410, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3275/3590 (91.2256%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3217/3590 (89.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0421, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4218/4679 (90.1475%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4243/4679 (90.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0598, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4624/5167 (89.4910%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4648/5167 (89.9555%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0244, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3392/3775 (89.8543%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3530/3775 (93.5099%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8211, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3449/3828 (90.0993%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3481/3828 (90.9352%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8881, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3809/4235 (89.9410%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3847/4235 (90.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9577, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4154/4647 (89.3910%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4195/4647 (90.2733%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9929, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4423/4918 (89.9349%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4497/4918 (91.4396%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0302, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4019/4433 (90.6610%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4030/4433 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0492, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3991/4481 (89.0649%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3890/4481 (86.8110%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1968, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3841/4295 (89.4296%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3711/4295 (86.4028%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2357, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4019/4503 (89.2516%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4021/4503 (89.2960%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8713, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3850/4354 (88.4244%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3531/4354 (81.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.6388, Accuracy: 4592/10000 (45.9200%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4497/4986 (90.1925%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4442/4986 (89.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9863, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5589/6263 (89.2384%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5704/6263 (91.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0074, Accuracy: 5425/10000 (54.2500%)
time spent on training: 260.74098205566406
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1113, Accuracy: 7017/10000 (70.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.6385, Accuracy: 4628/9900 (46.7475%)
Done in 288.4200623035431 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4534/4885 (92.8147%), train_poison_data_count: 385
Global model norm: 42.71201997553646.
Norm before scaling: 42.70715254973398. Distance: 1.7323497598082256
Total norm for 4 adversaries is: 42.70715254973398. distance: 1.7323497598082256
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1537, Accuracy: 9522/9900 (96.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4897/5305 (92.3091%), train_poison_data_count: 415
Global model norm: 42.71201997553646.
Norm before scaling: 42.70755699878755. Distance: 1.871606553432326
Total norm for 4 adversaries is: 42.70755699878755. distance: 1.871606553432326
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0830, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4382/4717 (92.8980%), train_poison_data_count: 370
Global model norm: 42.71201997553646.
Norm before scaling: 42.704186949382525. Distance: 1.6489701698570811
Total norm for 4 adversaries is: 42.704186949382525. distance: 1.6489701698570811
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1698, Accuracy: 9503/9900 (95.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4686/5066 (92.4990%), train_poison_data_count: 400
Global model norm: 42.71201997553646.
Norm before scaling: 42.710389463970735. Distance: 1.8239801483621643
Total norm for 4 adversaries is: 42.710389463970735. distance: 1.8239801483621643
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0599, Accuracy: 9751/9900 (98.4949%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3772/4223 (89.3204%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3840/4223 (90.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0001, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4938/5455 (90.5225%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4857/5455 (89.0376%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2232, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5093/5582 (91.2397%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5050/5582 (90.4694%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.4102, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4034/4465 (90.3471%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4080/4465 (91.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8311, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4983/5591 (89.1254%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4934/5591 (88.2490%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2525, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3540/3911 (90.5139%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3404/3911 (87.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9611, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3919/4356 (89.9679%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0142, Accuracy: 3290/4356 (75.5280%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.6051, Accuracy: 4516/10000 (45.1600%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4469/5037 (88.7234%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4553/5037 (90.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9910, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4245/4679 (90.7245%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4246/4679 (90.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0831, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3994/4362 (91.5635%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3945/4362 (90.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2164, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4119/4518 (91.1687%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4178/4518 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9783, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4522/5083 (88.9632%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4512/5083 (88.7665%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1240, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3591/4013 (89.4842%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3714/4013 (92.5492%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7888, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4624/5197 (88.9744%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4669/5197 (89.8403%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1506, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2979/3297 (90.3549%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3071/3297 (93.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8150, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4025/4441 (90.6327%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4033/4441 (90.8129%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1005, Accuracy: 5375/10000 (53.7500%)
time spent on training: 262.9151077270508
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1144, Accuracy: 7024/10000 (70.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.3635, Accuracy: 5047/9900 (50.9798%)
Done in 290.37055230140686 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4546/4885 (93.0604%), train_poison_data_count: 385
Global model norm: 42.735020561851556.
Norm before scaling: 42.72972009611328. Distance: 1.7185552313294685
Total norm for 4 adversaries is: 42.72972009611328. distance: 1.7185552313294685
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0887, Accuracy: 9683/9900 (97.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4926/5305 (92.8558%), train_poison_data_count: 415
Global model norm: 42.735020561851556.
Norm before scaling: 42.7268474860216. Distance: 1.7453639064721216
Total norm for 4 adversaries is: 42.7268474860216. distance: 1.7453639064721216
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2969, Accuracy: 9230/9900 (93.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4400/4717 (93.2796%), train_poison_data_count: 370
Global model norm: 42.735020561851556.
Norm before scaling: 42.72818310946462. Distance: 1.6555080551370867
Total norm for 4 adversaries is: 42.72818310946462. distance: 1.6555080551370867
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2920, Accuracy: 9154/9900 (92.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4669/5066 (92.1634%), train_poison_data_count: 400
Global model norm: 42.735020561851556.
Norm before scaling: 42.733889393950264. Distance: 1.8307590907234632
Total norm for 4 adversaries is: 42.733889393950264. distance: 1.8307590907234632
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1860, Accuracy: 9430/9900 (95.2525%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4032/4501 (89.5801%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4024/4501 (89.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0245, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4037/4511 (89.4924%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4077/4511 (90.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9929, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3903/4354 (89.6417%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0113, Accuracy: 3435/4354 (78.8930%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5288, Accuracy: 4533/10000 (45.3300%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3976/4346 (91.4864%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4020/4346 (92.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8611, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4240/4707 (90.0786%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4268/4707 (90.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9661, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4935/5591 (88.2669%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4946/5591 (88.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0486, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4130/4647 (88.8745%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4177/4647 (89.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8776, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4111/4538 (90.5906%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4190/4538 (92.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8533, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4378/4934 (88.7313%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4377/4934 (88.7110%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1907, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4332/4804 (90.1749%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4214/4804 (87.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0953, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5680/6263 (90.6914%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5656/6263 (90.3082%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1553, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3985/4481 (88.9310%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3923/4481 (87.5474%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0654, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4439/5063 (87.6753%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4441/5063 (87.7148%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0258, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3756/4223 (88.9415%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3886/4223 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9522, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4057/4441 (91.3533%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4090/4441 (92.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9899, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3403/3756 (90.6017%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3473/3756 (92.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8890, Accuracy: 5637/10000 (56.3700%)
time spent on training: 263.94698762893677
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1176, Accuracy: 7012/10000 (70.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.1915, Accuracy: 5360/9900 (54.1414%)
Done in 291.3286452293396 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4582/4885 (93.7973%), train_poison_data_count: 385
Global model norm: 42.75864541601499.
Norm before scaling: 42.751347749223065. Distance: 1.6700111053006181
Total norm for 4 adversaries is: 42.751347749223065. distance: 1.6700111053006181
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1265, Accuracy: 9592/9900 (96.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4925/5305 (92.8369%), train_poison_data_count: 415
Global model norm: 42.75864541601499.
Norm before scaling: 42.75542357546218. Distance: 1.847358663518605
Total norm for 4 adversaries is: 42.75542357546218. distance: 1.847358663518605
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0626, Accuracy: 9732/9900 (98.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4389/4717 (93.0464%), train_poison_data_count: 370
Global model norm: 42.75864541601499.
Norm before scaling: 42.752092990614216. Distance: 1.6199226285566128
Total norm for 4 adversaries is: 42.752092990614216. distance: 1.6199226285566128
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1969, Accuracy: 9415/9900 (95.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4711/5066 (92.9925%), train_poison_data_count: 400
Global model norm: 42.75864541601499.
Norm before scaling: 42.753126598932795. Distance: 1.7600667105299581
Total norm for 4 adversaries is: 42.753126598932795. distance: 1.7600667105299581
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1864, Accuracy: 9427/9900 (95.2222%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4495/5244 (85.7170%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4582/5244 (87.3760%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0564, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4427/4928 (89.8336%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4457/4928 (90.4424%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9265, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3429/3804 (90.1420%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3487/3804 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0050, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3648/4013 (90.9046%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3684/4013 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8413, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3646/4158 (87.6864%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3625/4158 (87.1813%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9695, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5109/5582 (91.5263%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5049/5582 (90.4515%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0151, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4904/5455 (89.8992%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4931/5455 (90.3941%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0371, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3911/4354 (89.8254%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0113, Accuracy: 3487/4354 (80.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.7808, Accuracy: 4344/10000 (43.4400%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4029/4433 (90.8865%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4053/4433 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9738, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3240/3646 (88.8645%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3335/3646 (91.4701%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8670, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4081/4518 (90.3276%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4114/4518 (91.0580%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0004, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3863/4235 (91.2161%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3790/4235 (89.4923%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.3296, Accuracy: 4957/10000 (49.5700%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4002/4362 (91.7469%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3893/4362 (89.2481%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1654, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4856/5392 (90.0593%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4753/5392 (88.1491%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2251, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4919/5591 (87.9807%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4895/5591 (87.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2015, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3412/3756 (90.8413%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3477/3756 (92.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9612, Accuracy: 5650/10000 (56.5000%)
time spent on training: 259.60163617134094
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1244, Accuracy: 6995/10000 (69.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.9541, Accuracy: 5780/9900 (58.3838%)
Done in 287.07190346717834 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4556/4885 (93.2651%), train_poison_data_count: 385
Global model norm: 42.78193622760443.
Norm before scaling: 42.77378781249242. Distance: 1.6782660568880718
Total norm for 4 adversaries is: 42.77378781249242. distance: 1.6782660568880718
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0891, Accuracy: 9666/9900 (97.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4935/5305 (93.0254%), train_poison_data_count: 415
Global model norm: 42.78193622760443.
Norm before scaling: 42.77355236856722. Distance: 1.7809567126368842
Total norm for 4 adversaries is: 42.77355236856722. distance: 1.7809567126368842
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0182, Accuracy: 9853/9900 (99.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4390/4717 (93.0676%), train_poison_data_count: 370
Global model norm: 42.78193622760443.
Norm before scaling: 42.774576896924856. Distance: 1.6383890810485304
Total norm for 4 adversaries is: 42.774576896924856. distance: 1.6383890810485304
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1147, Accuracy: 9615/9900 (97.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4690/5066 (92.5780%), train_poison_data_count: 400
Global model norm: 42.78193622760443.
Norm before scaling: 42.777192329485. Distance: 1.7983957903919638
Total norm for 4 adversaries is: 42.777192329485. distance: 1.7983957903919638
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1305, Accuracy: 9573/9900 (96.6970%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4229/4634 (91.2603%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4161/4634 (89.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0296, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4098/4503 (91.0060%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4040/4503 (89.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9058, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4382/4928 (88.9205%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4528/4928 (91.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7548, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3414/3804 (89.7476%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3449/3804 (90.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9492, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3284/3590 (91.4763%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3086/3590 (85.9610%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2907, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4166/4647 (89.6492%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4259/4647 (91.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8671, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4044/4625 (87.4378%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4043/4625 (87.4162%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1524, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3955/4356 (90.7943%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3885/4356 (89.1873%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1603, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3457/3797 (91.0456%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3502/3797 (92.2307%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9643, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4074/4456 (91.4273%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4092/4456 (91.8312%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9203, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3632/4025 (90.2360%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3736/4025 (92.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8614, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3168/3472 (91.2442%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3155/3472 (90.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0296, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2947/3297 (89.3843%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3030/3297 (91.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8342, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3908/4416 (88.4964%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3994/4416 (90.4438%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0976, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3959/4356 (90.8861%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4054/4356 (93.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1171, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3224/3638 (88.6201%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3346/3638 (91.9736%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8552, Accuracy: 5662/10000 (56.6200%)
time spent on training: 253.38026571273804
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1300, Accuracy: 6986/10000 (69.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.7549, Accuracy: 6158/9900 (62.2020%)
Done in 280.7978718280792 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4561/4885 (93.3675%), train_poison_data_count: 385
Global model norm: 42.80202455099598.
Norm before scaling: 42.79597080552677. Distance: 1.6946276147086
Total norm for 4 adversaries is: 42.79597080552677. distance: 1.6946276147086
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1641, Accuracy: 9501/9900 (95.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4950/5305 (93.3082%), train_poison_data_count: 415
Global model norm: 42.80202455099598.
Norm before scaling: 42.79161785436197. Distance: 1.7340145939451521
Total norm for 4 adversaries is: 42.79161785436197. distance: 1.7340145939451521
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1101, Accuracy: 9626/9900 (97.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4386/4717 (92.9828%), train_poison_data_count: 370
Global model norm: 42.80202455099598.
Norm before scaling: 42.79276746443989. Distance: 1.6167560683762248
Total norm for 4 adversaries is: 42.79276746443989. distance: 1.6167560683762248
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1158, Accuracy: 9619/9900 (97.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4724/5066 (93.2491%), train_poison_data_count: 400
Global model norm: 42.80202455099598.
Norm before scaling: 42.795089411454384. Distance: 1.7509532784372814
Total norm for 4 adversaries is: 42.795089411454384. distance: 1.7509532784372814
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0947, Accuracy: 9657/9900 (97.5455%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3738/4175 (89.5329%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3738/4175 (89.5329%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9403, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4365/4956 (88.0751%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4421/4956 (89.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0515, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4459/5037 (88.5249%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4581/5037 (90.9470%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9039, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4299/4793 (89.6933%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4339/4793 (90.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1414, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3406/3804 (89.5373%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3425/3804 (90.0368%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1384, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4878/5392 (90.4674%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4894/5392 (90.7641%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0747, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4075/4465 (91.2654%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4092/4465 (91.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8896, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4175/4596 (90.8399%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4225/4596 (91.9278%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0187, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5385/6124 (87.9327%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5410/6124 (88.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9926, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2923/3271 (89.3611%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2986/3271 (91.2871%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8643, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3255/3590 (90.6685%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3281/3590 (91.3928%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9856, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3966/4501 (88.1138%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3976/4501 (88.3359%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0999, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4670/5232 (89.2584%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4598/5232 (87.8823%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0323, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3277/3672 (89.2429%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3296/3672 (89.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0870, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3834/4223 (90.7885%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3885/4223 (91.9962%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1363, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3936/4354 (90.3996%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0177, Accuracy: 2990/4354 (68.6725%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.6737, Accuracy: 4201/10000 (42.0100%)
time spent on training: 257.7198312282562
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1398, Accuracy: 6985/10000 (69.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.5597, Accuracy: 6522/9900 (65.8788%)
Done in 285.25340390205383 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4628/4885 (94.7390%), train_poison_data_count: 385
Global model norm: 42.824895559563245.
Norm before scaling: 42.81203523926566. Distance: 1.571681095244492
Total norm for 4 adversaries is: 42.81203523926566. distance: 1.571681095244492
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2565, Accuracy: 9280/9900 (93.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4970/5305 (93.6852%), train_poison_data_count: 415
Global model norm: 42.824895559563245.
Norm before scaling: 42.81182994457402. Distance: 1.6971033718925068
Total norm for 4 adversaries is: 42.81182994457402. distance: 1.6971033718925068
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0593, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4402/4717 (93.3220%), train_poison_data_count: 370
Global model norm: 42.824895559563245.
Norm before scaling: 42.816886465523886. Distance: 1.643631641492597
Total norm for 4 adversaries is: 42.816886465523886. distance: 1.643631641492597
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0738, Accuracy: 9708/9900 (98.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4735/5066 (93.4662%), train_poison_data_count: 400
Global model norm: 42.824895559563245.
Norm before scaling: 42.816793808402444. Distance: 1.6800174832569668
Total norm for 4 adversaries is: 42.816793808402444. distance: 1.6800174832569668
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1872, Accuracy: 9432/9900 (95.2727%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5108/5582 (91.5084%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5035/5582 (90.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1178, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4174/4647 (89.8214%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4182/4647 (89.9935%)
