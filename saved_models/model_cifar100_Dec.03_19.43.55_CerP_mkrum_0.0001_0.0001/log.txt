current path: saved_models/model_cifar100_Dec.03_19.43.55_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4309/4885 (88.2088%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.44000389566502. Distance: 2.293390446476621
Total norm for 4 adversaries is: 42.44000389566502. distance: 2.293390446476621
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4435, Accuracy: 8825/9900 (89.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4745/5305 (89.4439%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43526348349993. Distance: 2.249247849101613
Total norm for 4 adversaries is: 42.43526348349993. distance: 2.249247849101613
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7262, Accuracy: 8303/9900 (83.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4180/4717 (88.6156%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438647697109474. Distance: 2.1766905605217866
Total norm for 4 adversaries is: 42.438647697109474. distance: 2.1766905605217866
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4278, Accuracy: 8880/9900 (89.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.440377813413875. Distance: 2.3031417576919075
Total norm for 4 adversaries is: 42.440377813413875. distance: 2.3031417576919075
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6106, Accuracy: 8490/9900 (85.7576%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3836/4356 (88.0624%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3687/4356 (84.6419%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4027, Accuracy: 4770/10000 (47.7000%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3933/4465 (88.0851%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4085/4465 (91.4894%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9646, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4049/4647 (87.1315%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4152/4647 (89.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9413, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4453/5055 (88.0910%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4553/5055 (90.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0696, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4440/5116 (86.7866%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4441/5116 (86.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0610, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3628/4126 (87.9302%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3761/4126 (91.1537%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0216, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3078/3472 (88.6521%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3228/3472 (92.9724%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0661, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4429/4986 (88.8287%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4439/4986 (89.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0548, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3536/4013 (88.1136%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3678/4013 (91.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8284, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4037/4618 (87.4188%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4070/4618 (88.1334%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0403, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4430/5083 (87.1533%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4435/5083 (87.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1672, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3975/4511 (88.1179%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4046/4511 (89.6919%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1664, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3328/3797 (87.6481%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3415/3797 (89.9394%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9618, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4992/5582 (89.4303%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5076/5582 (90.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1112, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3152/3616 (87.1681%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3207/3616 (88.6892%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0465, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4819/5455 (88.3410%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4850/5455 (88.9093%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9147, Accuracy: 5432/10000 (54.3200%)
time spent on training: 252.15425825119019
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1357, Accuracy: 6975/10000 (69.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.6971, Accuracy: 72/9900 (0.7273%)
Done in 275.8187429904938 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4381/4885 (89.6827%), train_poison_data_count: 385
Global model norm: 42.46770228426171.
Norm before scaling: 42.474923668265724. Distance: 2.1705270879461644
Total norm for 4 adversaries is: 42.474923668265724. distance: 2.1705270879461644
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1987, Accuracy: 9391/9900 (94.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 42.46770228426171.
Norm before scaling: 42.47152941144073. Distance: 2.2089467066513686
Total norm for 4 adversaries is: 42.47152941144073. distance: 2.2089467066513686
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4783, Accuracy: 8736/9900 (88.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4187/4717 (88.7640%), train_poison_data_count: 370
Global model norm: 42.46770228426171.
Norm before scaling: 42.47554587136359. Distance: 2.212434187950173
Total norm for 4 adversaries is: 42.47554587136359. distance: 2.212434187950173
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1666, Accuracy: 9488/9900 (95.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4470/5066 (88.2353%), train_poison_data_count: 400
Global model norm: 42.46770228426171.
Norm before scaling: 42.47790527466529. Distance: 2.342392591947296
Total norm for 4 adversaries is: 42.47790527466529. distance: 2.342392591947296
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2288, Accuracy: 9296/9900 (93.8990%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3581/4025 (88.9689%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3720/4025 (92.4224%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9363, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3313/3797 (87.2531%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3405/3797 (89.6761%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0956, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3946/4625 (85.3189%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4053/4625 (87.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2265, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3882/4481 (86.6324%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3870/4481 (86.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0770, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3842/4315 (89.0382%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3973/4315 (92.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0531, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3715/4235 (87.7214%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3828/4235 (90.3896%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0020, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3352/3828 (87.5653%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3486/3828 (91.0658%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9629, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3823/4416 (86.5716%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3992/4416 (90.3986%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9517, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3147/3638 (86.5036%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3273/3638 (89.9670%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9547, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4527/5265 (85.9829%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4547/5265 (86.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9699, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3351/3781 (88.6273%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3277/3781 (86.6702%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2644, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3968/4441 (89.3492%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4016/4441 (90.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1614, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3970/4433 (89.5556%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4024/4433 (90.7737%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9504, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4426/5083 (87.0746%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4452/5083 (87.5861%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0258, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4318/4928 (87.6218%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4380/4928 (88.8799%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9129, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4167/4793 (86.9393%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4355/4793 (90.8617%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0155, Accuracy: 5450/10000 (54.5000%)
time spent on training: 227.8617103099823
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1421, Accuracy: 6963/10000 (69.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.3958, Accuracy: 85/9900 (0.8586%)
Done in 251.36376285552979 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 42.498331194258384.
Norm before scaling: 42.500728107274085. Distance: 2.130019038836142
Total norm for 4 adversaries is: 42.500728107274085. distance: 2.130019038836142
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2278, Accuracy: 9301/9900 (93.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4737/5305 (89.2931%), train_poison_data_count: 415
Global model norm: 42.498331194258384.
Norm before scaling: 42.50177644495066. Distance: 2.1924441458570016
Total norm for 4 adversaries is: 42.50177644495066. distance: 2.1924441458570016
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0686, Accuracy: 9700/9900 (97.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4199/4717 (89.0184%), train_poison_data_count: 370
Global model norm: 42.498331194258384.
Norm before scaling: 42.50269264218371. Distance: 2.105632938359855
Total norm for 4 adversaries is: 42.50269264218371. distance: 2.105632938359855
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1900, Accuracy: 9395/9900 (94.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4483/5066 (88.4919%), train_poison_data_count: 400
Global model norm: 42.498331194258384.
Norm before scaling: 42.50473319231636. Distance: 2.262586990285863
Total norm for 4 adversaries is: 42.50473319231636. distance: 2.262586990285863
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1652, Accuracy: 9459/9900 (95.5455%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3137/3616 (86.7533%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3266/3616 (90.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8307, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3389/3837 (88.3242%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3478/3837 (90.6437%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9583, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4145/4679 (88.5873%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4294/4679 (91.7717%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0915, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3066/3638 (84.2771%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3270/3638 (89.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1331, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3611/4046 (89.2486%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3636/4046 (89.8665%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9441, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3937/4518 (87.1403%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4092/4518 (90.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0217, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3357/3797 (88.4119%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3405/3797 (89.6761%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1406, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4399/5025 (87.5423%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4490/5025 (89.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2020, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3889/4362 (89.1564%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3969/4362 (90.9904%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0522, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3976/4558 (87.2312%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4039/4558 (88.6134%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0824, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3206/3672 (87.3094%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3266/3672 (88.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1025, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4304/4874 (88.3053%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4309/4874 (88.4079%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0205, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3598/4025 (89.3913%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3697/4025 (91.8509%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9373, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4093/4663 (87.7761%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4257/4663 (91.2932%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0824, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3423/3911 (87.5224%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3486/3911 (89.1332%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9522, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4430/5017 (88.2998%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4534/5017 (90.3727%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7992, Accuracy: 5784/10000 (57.8400%)
time spent on training: 227.14336705207825
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1295, Accuracy: 6992/10000 (69.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.1537, Accuracy: 89/9900 (0.8990%)
Done in 250.48891758918762 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4391/4885 (89.8874%), train_poison_data_count: 385
Global model norm: 42.5302382663463.
Norm before scaling: 42.53649197352859. Distance: 2.139747049765743
Total norm for 4 adversaries is: 42.53649197352859. distance: 2.139747049765743
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5077, Accuracy: 8735/9900 (88.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 42.5302382663463.
Norm before scaling: 42.53025835774528. Distance: 2.147848707493613
Total norm for 4 adversaries is: 42.53025835774528. distance: 2.147848707493613
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0805, Accuracy: 9680/9900 (97.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4237/4717 (89.8240%), train_poison_data_count: 370
Global model norm: 42.5302382663463.
Norm before scaling: 42.532778317966866. Distance: 2.087806350249021
Total norm for 4 adversaries is: 42.532778317966866. distance: 2.087806350249021
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1472, Accuracy: 9513/9900 (96.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 42.5302382663463.
Norm before scaling: 42.536860738474516. Distance: 2.266568428135936
Total norm for 4 adversaries is: 42.536860738474516. distance: 2.266568428135936
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2985, Accuracy: 9122/9900 (92.1414%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5250/6124 (85.7283%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5331/6124 (87.0509%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1946, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3834/4356 (88.0165%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3569/4356 (81.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4240, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3495/4158 (84.0548%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3584/4158 (86.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0546, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4993/5455 (91.5307%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4989/5455 (91.4574%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9267, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3907/4511 (86.6105%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4062/4511 (90.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9904, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4499/5232 (85.9901%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4513/5232 (86.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1829, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4458/5244 (85.0114%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4512/5244 (86.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1312, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4367/4918 (88.7963%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4399/4918 (89.4469%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0598, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3600/4126 (87.2516%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3702/4126 (89.7237%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8232, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4322/4928 (87.7029%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4386/4928 (89.0016%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0312, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3722/4223 (88.1364%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3881/4223 (91.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8751, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4532/5195 (87.2377%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4605/5195 (88.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1599, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4121/4679 (88.0744%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4125/4679 (88.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0201, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3187/3646 (87.4109%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3289/3646 (90.2084%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8832, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3172/3616 (87.7212%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3243/3616 (89.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9071, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4048/4716 (85.8355%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4092/4716 (86.7684%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1075, Accuracy: 5202/10000 (52.0200%)
time spent on training: 234.01141476631165
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.1424, Accuracy: 6957/10000 (69.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.2322, Accuracy: 92/9900 (0.9293%)
Done in 257.68093037605286 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 42.566251211347.
Norm before scaling: 42.571672389501714. Distance: 2.1440132224187645
Total norm for 4 adversaries is: 42.571672389501714. distance: 2.1440132224187645
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1302, Accuracy: 9567/9900 (96.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4813/5305 (90.7257%), train_poison_data_count: 415
Global model norm: 42.566251211347.
Norm before scaling: 42.56148470705351. Distance: 2.120839365392874
Total norm for 4 adversaries is: 42.56148470705351. distance: 2.120839365392874
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1100, Accuracy: 9620/9900 (97.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 42.566251211347.
Norm before scaling: 42.56869018174112. Distance: 2.091662718729901
Total norm for 4 adversaries is: 42.56869018174112. distance: 2.091662718729901
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1934, Accuracy: 9413/9900 (95.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 42.566251211347.
Norm before scaling: 42.57586719931184. Distance: 2.286625837882784
Total norm for 4 adversaries is: 42.57586719931184. distance: 2.286625837882784
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2278, Accuracy: 9323/9900 (94.1717%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5262/6124 (85.9242%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5346/6124 (87.2959%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0136, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3958/4433 (89.2849%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3992/4433 (90.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9870, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3364/3781 (88.9712%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3139/3781 (83.0204%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.4185, Accuracy: 4731/10000 (47.3100%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3549/3969 (89.4180%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3575/3969 (90.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9284, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4443/5025 (88.4179%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4498/5025 (89.5124%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0928, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4135/4679 (88.3736%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4236/4679 (90.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9968, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4140/4707 (87.9541%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4203/4707 (89.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8981, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4414/4986 (88.5279%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4477/4986 (89.7914%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9630, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3883/4315 (89.9884%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3940/4315 (91.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8779, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3808/4416 (86.2319%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3903/4416 (88.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0412, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4201/4804 (87.4480%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4078/4804 (84.8876%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1682, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4255/4793 (88.7753%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4336/4793 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0318, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4529/5232 (86.5635%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4575/5232 (87.4427%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0559, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4094/4662 (87.8164%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4231/4662 (90.7550%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0377, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4220/4956 (85.1493%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4326/4956 (87.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2479, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3823/4368 (87.5229%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3843/4368 (87.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9900, Accuracy: 5347/10000 (53.4700%)
time spent on training: 232.98616480827332
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.1400, Accuracy: 6956/10000 (69.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.1041, Accuracy: 102/9900 (1.0303%)
Done in 257.4572420120239 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4390/4885 (89.8669%), train_poison_data_count: 385
Global model norm: 42.59623181507667.
Norm before scaling: 42.601584706806975. Distance: 2.167221132882442
Total norm for 4 adversaries is: 42.601584706806975. distance: 2.167221132882442
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2413, Accuracy: 9286/9900 (93.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 42.59623181507667.
Norm before scaling: 42.59365972340029. Distance: 2.136434197874614
Total norm for 4 adversaries is: 42.59365972340029. distance: 2.136434197874614
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2224, Accuracy: 9360/9900 (94.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 42.59623181507667.
Norm before scaling: 42.595483846772126. Distance: 2.048915399341727
Total norm for 4 adversaries is: 42.595483846772126. distance: 2.048915399341727
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1769, Accuracy: 9436/9900 (95.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4516/5066 (89.1433%), train_poison_data_count: 400
Global model norm: 42.59623181507667.
Norm before scaling: 42.60544135216181. Distance: 2.2401473170611417
Total norm for 4 adversaries is: 42.60544135216181. distance: 2.2401473170611417
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1500, Accuracy: 9520/9900 (96.1616%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5289/6124 (86.3651%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5365/6124 (87.6061%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1301, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5099/5902 (86.3944%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5144/5902 (87.1569%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0818, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4135/4707 (87.8479%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4201/4707 (89.2501%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9052, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4031/4647 (86.7441%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4139/4647 (89.0682%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9319, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2946/3297 (89.3540%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3031/3297 (91.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7776, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5570/6263 (88.9350%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5645/6263 (90.1325%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1735, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4174/4663 (89.5132%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4256/4663 (91.2717%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2269, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4283/4956 (86.4205%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4358/4956 (87.9338%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1094, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3582/4046 (88.5319%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3696/4046 (91.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8849, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3664/4184 (87.5717%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3784/4184 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9683, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4859/5591 (86.9075%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4898/5591 (87.6051%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3648, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4060/4634 (87.6133%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4135/4634 (89.2318%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9908, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3346/3828 (87.4086%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3505/3828 (91.5622%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9597, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3130/3638 (86.0363%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3278/3638 (90.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8565, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3375/3781 (89.2621%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3364/3781 (88.9712%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1902, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3380/3837 (88.0897%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3512/3837 (91.5298%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9682, Accuracy: 5530/10000 (55.3000%)
time spent on training: 232.0091667175293
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1565, Accuracy: 6940/10000 (69.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.1520, Accuracy: 107/9900 (1.0808%)
Done in 255.5008795261383 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 42.620075377635274.
Norm before scaling: 42.62424824071314. Distance: 2.1167606613234904
Total norm for 4 adversaries is: 42.62424824071314. distance: 2.1167606613234904
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2742, Accuracy: 9236/9900 (93.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.620075377635274.
Norm before scaling: 42.62226782849254. Distance: 2.1855841830344516
Total norm for 4 adversaries is: 42.62226782849254. distance: 2.1855841830344516
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1674, Accuracy: 9474/9900 (95.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4203/4717 (89.1032%), train_poison_data_count: 370
Global model norm: 42.620075377635274.
Norm before scaling: 42.62459619951695. Distance: 2.1072462855487455
Total norm for 4 adversaries is: 42.62459619951695. distance: 2.1072462855487455
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2113, Accuracy: 9374/9900 (94.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 42.620075377635274.
Norm before scaling: 42.62427401553676. Distance: 2.19244077474187
Total norm for 4 adversaries is: 42.62427401553676. distance: 2.19244077474187
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2122, Accuracy: 9366/9900 (94.6061%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3904/4501 (86.7363%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3925/4501 (87.2028%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9888, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3681/4175 (88.1677%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3729/4175 (89.3174%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9777, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3134/3616 (86.6704%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3203/3616 (88.5785%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9998, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4030/4634 (86.9659%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4117/4634 (88.8433%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0511, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3993/4558 (87.6042%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4011/4558 (87.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1960, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4545/5167 (87.9621%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4612/5167 (89.2588%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1151, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3864/4356 (88.7052%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3842/4356 (88.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2982, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4227/4716 (89.6310%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4262/4716 (90.3732%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9668, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5359/6124 (87.5082%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5276/6124 (86.1528%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0318, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4413/5055 (87.2997%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4504/5055 (89.0999%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0280, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4484/5025 (89.2338%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4536/5025 (90.2687%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1339, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4350/4918 (88.4506%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4399/4918 (89.4469%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1668, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3718/4223 (88.0417%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3784/4223 (89.6045%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8983, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3866/4481 (86.2754%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3837/4481 (85.6282%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0259, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3172/3638 (87.1908%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3297/3638 (90.6267%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9283, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3566/4013 (88.8612%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3696/4013 (92.1007%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8825, Accuracy: 5585/10000 (55.8500%)
time spent on training: 231.65793251991272
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1452, Accuracy: 6977/10000 (69.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.3321, Accuracy: 82/9900 (0.8283%)
Done in 255.11779832839966 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 42.644216194047786.
Norm before scaling: 42.64770261205095. Distance: 2.106193573419447
Total norm for 4 adversaries is: 42.64770261205095. distance: 2.106193573419447
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2428, Accuracy: 9306/9900 (94.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 42.644216194047786.
Norm before scaling: 42.644297776050905. Distance: 2.1891928525747018
Total norm for 4 adversaries is: 42.644297776050905. distance: 2.1891928525747018
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2569, Accuracy: 9286/9900 (93.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 42.644216194047786.
Norm before scaling: 42.64662780667717. Distance: 2.0578190252364275
Total norm for 4 adversaries is: 42.64662780667717. distance: 2.0578190252364275
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.3581, Accuracy: 9031/9900 (91.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4503/5066 (88.8867%), train_poison_data_count: 400
Global model norm: 42.644216194047786.
Norm before scaling: 42.64958452959272. Distance: 2.228374292838426
Total norm for 4 adversaries is: 42.64958452959272. distance: 2.228374292838426
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1437, Accuracy: 9507/9900 (96.0303%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3187/3646 (87.4109%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3301/3646 (90.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8870, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3909/4501 (86.8474%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4024/4501 (89.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0999, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4080/4651 (87.7231%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4143/4651 (89.0776%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9546, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4563/5167 (88.3104%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4658/5167 (90.1490%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0032, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4957/5455 (90.8708%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4952/5455 (90.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1269, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4883/5591 (87.3368%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4888/5591 (87.4262%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0165, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4193/4679 (89.6132%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4163/4679 (88.9720%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0729, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4535/5017 (90.3927%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4552/5017 (90.7315%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9695, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4315/4793 (90.0271%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4354/4793 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0811, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3976/4456 (89.2280%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4068/4456 (91.2926%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8421, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4809/5424 (88.6615%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4965/5424 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.3663, Accuracy: 4945/10000 (49.4500%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3620/4175 (86.7066%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3650/4175 (87.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0784, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4525/5116 (88.4480%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4537/5116 (88.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0462, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3287/3704 (88.7419%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3349/3704 (90.4158%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8857, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4492/5232 (85.8563%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4615/5232 (88.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0771, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3082/3472 (88.7673%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3163/3472 (91.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0311, Accuracy: 5424/10000 (54.2400%)
time spent on training: 233.3875072002411
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1405, Accuracy: 6953/10000 (69.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.2566, Accuracy: 91/9900 (0.9192%)
Done in 256.9534287452698 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 42.66374419058148.
Norm before scaling: 42.66625054474409. Distance: 2.1013480718760627
Total norm for 4 adversaries is: 42.66625054474409. distance: 2.1013480718760627
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3551, Accuracy: 9007/9900 (90.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 42.66374419058148.
Norm before scaling: 42.66481856476203. Distance: 2.1773511609299336
Total norm for 4 adversaries is: 42.66481856476203. distance: 2.1773511609299336
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1825, Accuracy: 9451/9900 (95.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4221/4717 (89.4848%), train_poison_data_count: 370
Global model norm: 42.66374419058148.
Norm before scaling: 42.66598589671944. Distance: 2.066456092853513
Total norm for 4 adversaries is: 42.66598589671944. distance: 2.066456092853513
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1728, Accuracy: 9470/9900 (95.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 42.66374419058148.
Norm before scaling: 42.670879473923726. Distance: 2.2203548161596953
Total norm for 4 adversaries is: 42.670879473923726. distance: 2.2203548161596953
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2871, Accuracy: 9154/9900 (92.4646%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3213/3590 (89.4986%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3319/3590 (92.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1534, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3916/4368 (89.6520%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3926/4368 (89.8810%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8245, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3263/3704 (88.0940%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3338/3704 (90.1188%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9566, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4334/4928 (87.9464%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4331/4928 (87.8856%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0875, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3837/4356 (88.0854%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3859/4356 (88.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1687, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3462/3911 (88.5196%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3324/3911 (84.9911%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2649, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4101/4651 (88.1746%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4174/4651 (89.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2126, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3712/4184 (88.7189%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3758/4184 (89.8184%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8730, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3909/4346 (89.9448%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4015/4346 (92.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9171, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4284/4793 (89.3803%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4385/4793 (91.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9272, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3381/3804 (88.8801%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3500/3804 (92.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9356, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4450/4986 (89.2499%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4486/4986 (89.9719%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9094, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5328/6124 (87.0020%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5321/6124 (86.8877%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1229, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4114/4707 (87.4017%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4226/4707 (89.7812%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9740, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3782/4235 (89.3034%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3740/4235 (88.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0183, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3608/4046 (89.1745%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3682/4046 (91.0035%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0419, Accuracy: 5339/10000 (53.3900%)
time spent on training: 229.19707369804382
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1325, Accuracy: 6980/10000 (69.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.0919, Accuracy: 84/9900 (0.8485%)
Done in 252.63595986366272 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 42.68688946534477.
Norm before scaling: 42.68932869207113. Distance: 2.0989806471428167
Total norm for 4 adversaries is: 42.68932869207113. distance: 2.0989806471428167
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1141, Accuracy: 9597/9900 (96.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4762/5305 (89.7644%), train_poison_data_count: 415
Global model norm: 42.68688946534477.
Norm before scaling: 42.69089567158538. Distance: 2.179759362789661
Total norm for 4 adversaries is: 42.69089567158538. distance: 2.179759362789661
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0924, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.68688946534477.
Norm before scaling: 42.687705892622056. Distance: 2.0471985539391357
Total norm for 4 adversaries is: 42.687705892622056. distance: 2.0471985539391357
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.4278, Accuracy: 8887/9900 (89.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4486/5066 (88.5511%), train_poison_data_count: 400
Global model norm: 42.68688946534477.
Norm before scaling: 42.69468849612619. Distance: 2.255557719617452
Total norm for 4 adversaries is: 42.69468849612619. distance: 2.255557719617452
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2409, Accuracy: 9279/9900 (93.7273%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4408/4986 (88.4075%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4470/4986 (89.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9878, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4031/4634 (86.9875%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4080/4634 (88.0449%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0442, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4251/4716 (90.1399%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4276/4716 (90.6701%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0033, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5281/6124 (86.2345%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5390/6124 (88.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0639, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4360/4918 (88.6539%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4515/4918 (91.8056%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9105, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3374/3797 (88.8596%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3412/3797 (89.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0358, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4962/5582 (88.8929%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5006/5582 (89.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0755, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4284/4956 (86.4407%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4324/4956 (87.2478%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1093, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3997/4433 (90.1647%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4025/4433 (90.7963%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9085, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3839/4354 (88.1718%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0110, Accuracy: 3439/4354 (78.9848%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3670, Accuracy: 4793/10000 (47.9300%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4277/4928 (86.7898%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4439/4928 (90.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8808, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3456/3911 (88.3661%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3501/3911 (89.5167%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0181, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0086, Accuracy: 3794/4481 (84.6686%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3828/4481 (85.4274%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0993, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4576/5197 (88.0508%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4641/5197 (89.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9669, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4900/5455 (89.8258%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4914/5455 (90.0825%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9289, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3805/4361 (87.2506%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3768/4361 (86.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1788, Accuracy: 5117/10000 (51.1700%)
time spent on training: 235.5952353477478
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1625, Accuracy: 6909/10000 (69.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 9.0935, Accuracy: 91/9900 (0.9192%)
Done in 259.1011106967926 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 42.72144885631587.
Norm before scaling: 42.72611180394037. Distance: 2.095280557569606
Total norm for 4 adversaries is: 42.72611180394037. distance: 2.095280557569606
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1459, Accuracy: 9536/9900 (96.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4802/5305 (90.5184%), train_poison_data_count: 415
Global model norm: 42.72144885631587.
Norm before scaling: 42.722183190041186. Distance: 2.1296354112531284
Total norm for 4 adversaries is: 42.722183190041186. distance: 2.1296354112531284
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2824, Accuracy: 9196/9900 (92.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.72144885631587.
Norm before scaling: 42.72117597811564. Distance: 2.035772482917325
Total norm for 4 adversaries is: 42.72117597811564. distance: 2.035772482917325
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1585, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 42.72144885631587.
Norm before scaling: 42.72762315263321. Distance: 2.2494510404808787
Total norm for 4 adversaries is: 42.72762315263321. distance: 2.2494510404808787
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2438, Accuracy: 9305/9900 (93.9899%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4337/4928 (88.0073%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4401/4928 (89.3060%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9997, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3746/4184 (89.5315%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3813/4184 (91.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8345, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4208/4707 (89.3988%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4240/4707 (90.0786%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9654, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3386/3828 (88.4535%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3523/3828 (92.0324%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9428, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3973/4503 (88.2301%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4048/4503 (89.8956%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9839, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4155/4662 (89.1248%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4236/4662 (90.8623%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9027, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3730/4235 (88.0756%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3816/4235 (90.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0651, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4390/5244 (83.7147%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4440/5244 (84.6682%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0864, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4283/4793 (89.3595%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4392/4793 (91.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9400, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3913/4481 (87.3243%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3863/4481 (86.2084%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1481, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3900/4346 (89.7377%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4010/4346 (92.2688%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7803, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3916/4361 (89.7959%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3752/4361 (86.0353%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1223, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4527/5055 (89.5549%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4518/5055 (89.3769%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1482, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4546/5195 (87.5072%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4552/5195 (87.6227%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1176, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3907/4315 (90.5446%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3984/4315 (92.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9131, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4164/4663 (89.2987%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4254/4663 (91.2288%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0606, Accuracy: 5336/10000 (53.3600%)
time spent on training: 231.61205625534058
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 19.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1431, Accuracy: 6958/10000 (69.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.3447, Accuracy: 69/9900 (0.6970%)
Done in 255.75698900222778 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4404/4885 (90.1535%), train_poison_data_count: 385
Global model norm: 42.74887493950864.
Norm before scaling: 42.75418445118486. Distance: 2.0843629073173977
Total norm for 4 adversaries is: 42.75418445118486. distance: 2.0843629073173977
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2140, Accuracy: 9379/9900 (94.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.74887493950864.
Norm before scaling: 42.75266833092483. Distance: 2.1706636192868998
Total norm for 4 adversaries is: 42.75266833092483. distance: 2.1706636192868998
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3077, Accuracy: 9176/9900 (92.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.74887493950864.
Norm before scaling: 42.74848515910754. Distance: 2.010843682935028
Total norm for 4 adversaries is: 42.74848515910754. distance: 2.010843682935028
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1917, Accuracy: 9426/9900 (95.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4536/5066 (89.5381%), train_poison_data_count: 400
Global model norm: 42.74887493950864.
Norm before scaling: 42.75373476010605. Distance: 2.2003847219292156
Total norm for 4 adversaries is: 42.75373476010605. distance: 2.2003847219292156
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2104, Accuracy: 9344/9900 (94.3838%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3906/4315 (90.5214%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3972/4315 (92.0510%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8852, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3256/3590 (90.6964%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3174/3590 (88.4123%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0568, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4187/4679 (89.4849%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4132/4679 (88.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0177, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4612/5167 (89.2588%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4638/5167 (89.7620%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1346, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3381/3775 (89.5629%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3521/3775 (93.2715%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7966, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3402/3828 (88.8715%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3475/3828 (90.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8210, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3749/4235 (88.5242%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3826/4235 (90.3424%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9782, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4092/4647 (88.0568%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4197/4647 (90.3163%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9345, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4336/4918 (88.1659%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4421/4918 (89.8943%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0811, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3967/4433 (89.4879%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4032/4433 (90.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9466, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3888/4481 (86.7663%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3896/4481 (86.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2141, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3791/4295 (88.2654%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3740/4295 (87.0780%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1887, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3987/4503 (88.5410%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4037/4503 (89.6513%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9093, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3781/4354 (86.8397%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3589/4354 (82.4299%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2747, Accuracy: 4848/10000 (48.4800%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4443/4986 (89.1095%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4470/4986 (89.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0107, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5571/6263 (88.9510%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5731/6263 (91.5057%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1393, Accuracy: 5211/10000 (52.1100%)
time spent on training: 233.39944410324097
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 20, confusion matrix appended.
No suspicious behavior detected for client 20.
No suspicious behavior detected for agent 20.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1449, Accuracy: 6946/10000 (69.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.3475, Accuracy: 82/9900 (0.8283%)
Done in 256.8032581806183 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 42.78588075284737.
Norm before scaling: 42.78834143883048. Distance: 2.1230340727391144
Total norm for 4 adversaries is: 42.78834143883048. distance: 2.1230340727391144
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1962, Accuracy: 9438/9900 (95.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 42.78588075284737.
Norm before scaling: 42.79092322387497. Distance: 2.2662941832319943
Total norm for 4 adversaries is: 42.79092322387497. distance: 2.2662941832319943
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0774, Accuracy: 9702/9900 (98.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 42.78588075284737.
Norm before scaling: 42.787586843506666. Distance: 2.03515343839777
Total norm for 4 adversaries is: 42.787586843506666. distance: 2.03515343839777
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1574, Accuracy: 9508/9900 (96.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4521/5066 (89.2420%), train_poison_data_count: 400
Global model norm: 42.78588075284737.
Norm before scaling: 42.790612276800125. Distance: 2.2187479583301015
Total norm for 4 adversaries is: 42.790612276800125. distance: 2.2187479583301015
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0739, Accuracy: 9715/9900 (98.1313%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3722/4223 (88.1364%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3863/4223 (91.4753%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9852, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4944/5455 (90.6324%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4907/5455 (89.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0107, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5067/5582 (90.7739%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5061/5582 (90.6664%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1596, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4020/4465 (90.0336%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4066/4465 (91.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8306, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4910/5591 (87.8197%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4955/5591 (88.6246%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1252, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3450/3911 (88.2127%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3354/3911 (85.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0136, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3882/4356 (89.1185%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0140, Accuracy: 3290/4356 (75.5280%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.7492, Accuracy: 4379/10000 (43.7900%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4425/5037 (87.8499%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4535/5037 (90.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0224, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4167/4679 (89.0575%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4218/4679 (90.1475%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1145, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3957/4362 (90.7153%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3904/4362 (89.5002%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1835, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4064/4518 (89.9513%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4148/4518 (91.8105%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0004, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4443/5083 (87.4090%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4486/5083 (88.2550%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2143, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3616/4013 (90.1072%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3692/4013 (92.0010%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8886, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4559/5197 (87.7237%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4694/5197 (90.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9997, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2965/3297 (89.9302%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3047/3297 (92.4173%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7374, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3988/4441 (89.7996%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4028/4441 (90.7003%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0362, Accuracy: 5479/10000 (54.7900%)
time spent on training: 233.01345682144165
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1436, Accuracy: 6937/10000 (69.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.3107, Accuracy: 72/9900 (0.7273%)
Done in 256.5691616535187 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4404/4885 (90.1535%), train_poison_data_count: 385
Global model norm: 42.81319000356374.
Norm before scaling: 42.814205029916764. Distance: 2.0955654643015427
Total norm for 4 adversaries is: 42.814205029916764. distance: 2.0955654643015427
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2341, Accuracy: 9330/9900 (94.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 42.81319000356374.
Norm before scaling: 42.81317289617181. Distance: 2.150259126528303
Total norm for 4 adversaries is: 42.81317289617181. distance: 2.150259126528303
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3092, Accuracy: 9190/9900 (92.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 42.81319000356374.
Norm before scaling: 42.8125883895073. Distance: 2.013021636081024
Total norm for 4 adversaries is: 42.8125883895073. distance: 2.013021636081024
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.4267, Accuracy: 8853/9900 (89.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 42.81319000356374.
Norm before scaling: 42.81595133214446. Distance: 2.2147880964334425
Total norm for 4 adversaries is: 42.81595133214446. distance: 2.2147880964334425
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2162, Accuracy: 9324/9900 (94.1818%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3985/4501 (88.5359%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4027/4501 (89.4690%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1443, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3984/4511 (88.3174%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4088/4511 (90.6229%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9113, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3826/4354 (87.8732%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0118, Accuracy: 3408/4354 (78.2729%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5154, Accuracy: 4541/10000 (45.4100%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3928/4346 (90.3820%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4006/4346 (92.1767%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8339, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4198/4707 (89.1863%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4266/4707 (90.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9573, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4867/5591 (87.0506%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4891/5591 (87.4799%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0539, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4072/4647 (87.6264%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4170/4647 (89.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8195, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4084/4538 (89.9956%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4163/4538 (91.7364%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9287, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4353/4934 (88.2246%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4390/4934 (88.9745%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0626, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4288/4804 (89.2590%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4153/4804 (86.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1324, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5734/6263 (91.5536%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5678/6263 (90.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2114, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3876/4481 (86.4985%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3942/4481 (87.9714%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1403, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4402/5063 (86.9445%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4364/5063 (86.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0456, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3736/4223 (88.4679%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3861/4223 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9276, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4116/4441 (92.6818%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4159/4441 (93.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9649, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3380/3756 (89.9894%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3491/3756 (92.9446%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9095, Accuracy: 5620/10000 (56.2000%)
time spent on training: 233.4785315990448
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1522, Accuracy: 6913/10000 (69.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 9.3389, Accuracy: 78/9900 (0.7879%)
Done in 256.9571211338043 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 42.83488807874663.
Norm before scaling: 42.838508580281044. Distance: 2.1086339708571944
Total norm for 4 adversaries is: 42.838508580281044. distance: 2.1086339708571944
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1750, Accuracy: 9456/9900 (95.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 42.83488807874663.
Norm before scaling: 42.83391629031398. Distance: 2.190291013847657
Total norm for 4 adversaries is: 42.83391629031398. distance: 2.190291013847657
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0956, Accuracy: 9653/9900 (97.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 42.83488807874663.
Norm before scaling: 42.83669765534716. Distance: 2.032057498936877
Total norm for 4 adversaries is: 42.83669765534716. distance: 2.032057498936877
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3287, Accuracy: 9087/9900 (91.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4564/5066 (90.0908%), train_poison_data_count: 400
Global model norm: 42.83488807874663.
Norm before scaling: 42.83845728841741. Distance: 2.1751773893431916
Total norm for 4 adversaries is: 42.83845728841741. distance: 2.1751773893431916
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3277, Accuracy: 9108/9900 (92.0000%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4437/5244 (84.6110%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4549/5244 (86.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9404, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4363/4928 (88.5349%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4443/4928 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9119, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3388/3804 (89.0641%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3457/3804 (90.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9045, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3677/4013 (91.6272%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3718/4013 (92.6489%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8233, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3567/4158 (85.7864%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3633/4158 (87.3737%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0268, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5048/5582 (90.4335%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4995/5582 (89.4841%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0620, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4911/5455 (90.0275%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4953/5455 (90.7974%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9185, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3845/4354 (88.3096%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0103, Accuracy: 3576/4354 (82.1314%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.8407, Accuracy: 4429/10000 (44.2900%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3967/4433 (89.4879%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4012/4433 (90.5030%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0240, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3200/3646 (87.7674%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3341/3646 (91.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9292, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4029/4518 (89.1766%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4115/4518 (91.0801%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9899, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3787/4235 (89.4215%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3762/4235 (88.8312%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2674, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3966/4362 (90.9216%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3856/4362 (88.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2540, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4795/5392 (88.9280%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4728/5392 (87.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2767, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4880/5591 (87.2831%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4853/5591 (86.8002%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2009, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3465/3756 (92.2524%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3489/3756 (92.8914%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9101, Accuracy: 5657/10000 (56.5700%)
time spent on training: 231.30815052986145
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1623, Accuracy: 6917/10000 (69.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 9.1973, Accuracy: 105/9900 (1.0606%)
Done in 254.79263162612915 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 42.85532899923663.
Norm before scaling: 42.85984067145855. Distance: 2.118752327076582
Total norm for 4 adversaries is: 42.85984067145855. distance: 2.118752327076582
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1229, Accuracy: 9569/9900 (96.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 42.85532899923663.
Norm before scaling: 42.85588159067624. Distance: 2.213017647743102
Total norm for 4 adversaries is: 42.85588159067624. distance: 2.213017647743102
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0189, Accuracy: 9839/9900 (99.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 42.85532899923663.
Norm before scaling: 42.85825708303258. Distance: 2.0536216611227274
Total norm for 4 adversaries is: 42.85825708303258. distance: 2.0536216611227274
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1366, Accuracy: 9559/9900 (96.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4515/5066 (89.1236%), train_poison_data_count: 400
Global model norm: 42.85532899923663.
Norm before scaling: 42.86139002508916. Distance: 2.274326111471708
Total norm for 4 adversaries is: 42.86139002508916. distance: 2.274326111471708
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1118, Accuracy: 9604/9900 (97.0101%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4128/4634 (89.0807%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4147/4634 (89.4907%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0265, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4028/4503 (89.4515%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3997/4503 (88.7630%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0308, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4314/4928 (87.5406%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4446/4928 (90.2192%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9384, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3352/3804 (88.1178%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3421/3804 (89.9317%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0793, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3237/3590 (90.1671%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3074/3590 (85.6267%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2160, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4131/4647 (88.8961%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4242/4647 (91.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8315, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3984/4625 (86.1405%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4011/4625 (86.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1046, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3861/4356 (88.6364%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3891/4356 (89.3251%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1010, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3381/3797 (89.0440%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3477/3797 (91.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9957, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3964/4456 (88.9587%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4101/4456 (92.0332%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9897, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3575/4025 (88.8199%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3679/4025 (91.4037%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8559, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3228/3472 (92.9724%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3198/3472 (92.1083%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8741, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2915/3297 (88.4137%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3028/3297 (91.8411%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8847, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3854/4416 (87.2736%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3975/4416 (90.0136%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9634, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3891/4356 (89.3251%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4052/4356 (93.0211%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0248, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3159/3638 (86.8334%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3321/3638 (91.2864%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8178, Accuracy: 5711/10000 (57.1100%)
time spent on training: 226.39589166641235
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 68, confusion matrix appended.
No suspicious behavior detected for client 68.
No suspicious behavior detected for agent 68.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1555, Accuracy: 6923/10000 (69.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 9.0677, Accuracy: 117/9900 (1.1818%)
Done in 250.00493907928467 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4376/4885 (89.5803%), train_poison_data_count: 385
Global model norm: 42.87673386162506.
Norm before scaling: 42.88293276877833. Distance: 2.1739044587338987
Total norm for 4 adversaries is: 42.88293276877833. distance: 2.1739044587338987
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2245, Accuracy: 9372/9900 (94.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 42.87673386162506.
Norm before scaling: 42.879054108620444. Distance: 2.1699634070761
Total norm for 4 adversaries is: 42.879054108620444. distance: 2.1699634070761
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2201, Accuracy: 9327/9900 (94.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4262/4717 (90.3540%), train_poison_data_count: 370
Global model norm: 42.87673386162506.
Norm before scaling: 42.87388249044734. Distance: 2.023230111234956
Total norm for 4 adversaries is: 42.87388249044734. distance: 2.023230111234956
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1639, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4551/5066 (89.8342%), train_poison_data_count: 400
Global model norm: 42.87673386162506.
Norm before scaling: 42.88302812958175. Distance: 2.203287429773851
Total norm for 4 adversaries is: 42.88302812958175. distance: 2.203287429773851
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1363, Accuracy: 9551/9900 (96.4747%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3701/4175 (88.6467%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3750/4175 (89.8204%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9749, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4288/4956 (86.5214%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4399/4956 (88.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0993, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4445/5037 (88.2470%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4541/5037 (90.1529%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9839, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4301/4793 (89.7350%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4342/4793 (90.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0407, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3358/3804 (88.2755%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3397/3804 (89.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1741, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4798/5392 (88.9837%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4802/5392 (89.0579%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1392, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4012/4465 (89.8544%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4080/4465 (91.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9515, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4122/4596 (89.6867%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4178/4596 (90.9051%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9805, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5267/6124 (86.0059%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5347/6124 (87.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9170, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2904/3271 (88.7802%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2962/3271 (90.5533%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0555, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3215/3590 (89.5543%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3246/3590 (90.4178%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1239, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3935/4501 (87.4250%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4008/4501 (89.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0141, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4597/5232 (87.8631%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4605/5232 (88.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0698, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3254/3672 (88.6166%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3282/3672 (89.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0524, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3782/4223 (89.5572%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3836/4223 (90.8359%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9842, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3850/4354 (88.4244%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0152, Accuracy: 3178/4354 (72.9904%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.6314, Accuracy: 4452/10000 (44.5200%)
time spent on training: 231.81379914283752
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 5.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.2406, Accuracy: 6797/10000 (67.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 7.8263, Accuracy: 450/9900 (4.5455%)
Done in 255.021240234375 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4434/4885 (90.7677%), train_poison_data_count: 385
Global model norm: 42.929037045800214.
Norm before scaling: 42.93090520907185. Distance: 2.055700248345406
Total norm for 4 adversaries is: 42.93090520907185. distance: 2.055700248345406
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2557, Accuracy: 9293/9900 (93.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.929037045800214.
Norm before scaling: 42.927822838257384. Distance: 2.1341570853251994
Total norm for 4 adversaries is: 42.927822838257384. distance: 2.1341570853251994
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0936, Accuracy: 9661/9900 (97.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.929037045800214.
Norm before scaling: 42.93470241977927. Distance: 2.1472616411116285
Total norm for 4 adversaries is: 42.93470241977927. distance: 2.1472616411116285
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0551, Accuracy: 9755/9900 (98.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 42.929037045800214.
Norm before scaling: 42.93588373732032. Distance: 2.1972612847179356
Total norm for 4 adversaries is: 42.93588373732032. distance: 2.1972612847179356
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1044, Accuracy: 9651/9900 (97.4848%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5021/5582 (89.9498%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5021/5582 (89.9498%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1680, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4049/4647 (87.1315%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4207/4647 (90.5315%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0098, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4003/4465 (89.6529%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4112/4465 (92.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8458, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4474/5083 (88.0189%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4536/5083 (89.2386%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1835, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3799/4416 (86.0281%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3955/4416 (89.5607%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9020, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4276/4956 (86.2793%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4377/4956 (88.3172%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1180, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3976/4362 (91.1508%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3906/4362 (89.5461%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0238, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3848/4356 (88.3379%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3812/4356 (87.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.5540, Accuracy: 4662/10000 (46.6200%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3352/3781 (88.6538%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3441/3781 (91.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1210, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3208/3590 (89.3593%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3251/3590 (90.5571%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9351, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4121/4651 (88.6046%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4213/4651 (90.5827%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0927, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4149/4662 (88.9961%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4220/4662 (90.5191%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9433, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3161/3472 (91.0426%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3258/3472 (93.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.7816, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4819/5424 (88.8459%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4968/5424 (91.5929%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1107, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2898/3271 (88.5968%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0066, Accuracy: 2847/3271 (87.0376%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0513, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4436/5037 (88.0683%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4550/5037 (90.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9051, Accuracy: 5555/10000 (55.5500%)
time spent on training: 239.35537099838257
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 44, confusion matrix appended.
No suspicious behavior detected for client 44.
No suspicious behavior detected for agent 44.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.2263, Accuracy: 6843/10000 (68.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 8.0183, Accuracy: 355/9900 (3.5859%)
Done in 266.1869637966156 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 42.95925889496568.
Norm before scaling: 42.96134453230529. Distance: 2.0769359657507156
Total norm for 4 adversaries is: 42.96134453230529. distance: 2.0769359657507156
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1842, Accuracy: 9400/9900 (94.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 42.95925889496568.
Norm before scaling: 42.96229070768413. Distance: 2.1814346147907293
Total norm for 4 adversaries is: 42.96229070768413. distance: 2.1814346147907293
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1576, Accuracy: 9495/9900 (95.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 42.95925889496568.
Norm before scaling: 42.95436691092944. Distance: 1.9543436749725969
Total norm for 4 adversaries is: 42.95436691092944. distance: 1.9543436749725969
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3019, Accuracy: 9138/9900 (92.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4499/5066 (88.8077%), train_poison_data_count: 400
Global model norm: 42.95925889496568.
Norm before scaling: 42.96588200655914. Distance: 2.213901110617634
Total norm for 4 adversaries is: 42.96588200655914. distance: 2.213901110617634
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.4330, Accuracy: 8843/9900 (89.3232%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4358/4989 (87.3522%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4452/4989 (89.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9629, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3655/4013 (91.0790%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3763/4013 (93.7702%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7175, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4573/5195 (88.0269%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4480/5195 (86.2368%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2104, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3528/3969 (88.8889%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3574/3969 (90.0479%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9583, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3917/4356 (89.9219%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3790/4356 (87.0064%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1610, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4055/4441 (91.3083%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4097/4441 (92.2540%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0072, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4031/4518 (89.2209%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4124/4518 (91.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0345, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3430/3911 (87.7014%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3230/3911 (82.5876%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1220, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3928/4362 (90.0504%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3815/4362 (87.4599%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1797, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3373/3804 (88.6698%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3477/3804 (91.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9546, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3752/4223 (88.8468%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3876/4223 (91.7831%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8679, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4109/4634 (88.6707%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4188/4634 (90.3755%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8992, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3951/4354 (90.7441%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0140, Accuracy: 3252/4354 (74.6899%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.5750, Accuracy: 4440/10000 (44.4000%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4448/5244 (84.8207%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4540/5244 (86.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9022, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4537/5037 (90.0735%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4629/5037 (91.8999%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9316, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3234/3704 (87.3110%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3382/3704 (91.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9084, Accuracy: 5564/10000 (55.6400%)
time spent on training: 254.3692762851715
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.2110, Accuracy: 6859/10000 (68.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 8.2592, Accuracy: 287/9900 (2.8990%)
Done in 281.43438696861267 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 42.98273068010861.
Norm before scaling: 42.98724033979443. Distance: 2.096433826773233
Total norm for 4 adversaries is: 42.98724033979443. distance: 2.096433826773233
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1360, Accuracy: 9553/9900 (96.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 42.98273068010861.
Norm before scaling: 42.985894307028204. Distance: 2.1893795113349626
Total norm for 4 adversaries is: 42.985894307028204. distance: 2.1893795113349626
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1109, Accuracy: 9605/9900 (97.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 42.98273068010861.
Norm before scaling: 42.98017887779421. Distance: 1.976154873396486
Total norm for 4 adversaries is: 42.98017887779421. distance: 1.976154873396486
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1924, Accuracy: 9392/9900 (94.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 42.98273068010861.
Norm before scaling: 42.98625637694782. Distance: 2.161519122513652
Total norm for 4 adversaries is: 42.98625637694782. distance: 2.161519122513652
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2458, Accuracy: 9325/9900 (94.1919%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3861/4416 (87.4321%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3986/4416 (90.2627%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0128, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4555/5197 (87.6467%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4629/5197 (89.0706%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9867, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4343/4918 (88.3083%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4426/4918 (89.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1109, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5696/6263 (90.9468%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5687/6263 (90.8031%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0821, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3205/3646 (87.9046%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3315/3646 (90.9216%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8507, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4195/4707 (89.1226%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4242/4707 (90.1211%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9489, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4382/5063 (86.5495%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4282/5063 (84.5744%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3478, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3789/4295 (88.2189%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3878/4295 (90.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0936, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4308/4793 (89.8811%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4352/4793 (90.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9670, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4079/4538 (89.8854%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4232/4538 (93.2569%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8591, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4476/5083 (88.0582%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4544/5083 (89.3960%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9418, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3254/3638 (89.4447%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3293/3638 (90.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8782, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5354/6124 (87.4265%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5361/6124 (87.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2155, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4116/4618 (89.1295%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4108/4618 (88.9563%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9099, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3525/3969 (88.8133%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3599/3969 (90.6778%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7975, Accuracy: 5946/10000 (59.4600%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3581/4158 (86.1231%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3633/4158 (87.3737%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9826, Accuracy: 5336/10000 (53.3600%)
time spent on training: 257.6898145675659
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 53, confusion matrix appended.
No suspicious behavior detected for client 53.
No suspicious behavior detected for agent 53.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.2007, Accuracy: 6886/10000 (68.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 8.4925, Accuracy: 239/9900 (2.4141%)
Done in 284.63097739219666 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 43.01475662036663.
Norm before scaling: 43.0199496100719. Distance: 2.0678633112124802
Total norm for 4 adversaries is: 43.0199496100719. distance: 2.0678633112124802
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3232, Accuracy: 9148/9900 (92.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4750/5305 (89.5382%), train_poison_data_count: 415
Global model norm: 43.01475662036663.
Norm before scaling: 43.01998791668313. Distance: 2.2238611800140835
Total norm for 4 adversaries is: 43.01998791668313. distance: 2.2238611800140835
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2186, Accuracy: 9317/9900 (94.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4236/4717 (89.8028%), train_poison_data_count: 370
Global model norm: 43.01475662036663.
Norm before scaling: 43.01242382748995. Distance: 2.0046229577322605
Total norm for 4 adversaries is: 43.01242382748995. distance: 2.0046229577322605
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2973, Accuracy: 9112/9900 (92.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 43.01475662036663.
Norm before scaling: 43.02134848864282. Distance: 2.2490242855784333
Total norm for 4 adversaries is: 43.02134848864282. distance: 2.2490242855784333
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3285, Accuracy: 9102/9900 (91.9394%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4235/4716 (89.8007%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4262/4716 (90.3732%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1201, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3897/4481 (86.9672%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3903/4481 (87.1011%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0687, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3925/4361 (90.0023%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3827/4361 (87.7551%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1076, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4287/4793 (89.4429%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4422/4793 (92.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9814, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3842/4295 (89.4529%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3670/4295 (85.4482%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1395, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4457/5244 (84.9924%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4557/5244 (86.8993%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9248, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4389/4989 (87.9735%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4472/4989 (89.6372%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9166, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4588/5197 (88.2817%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4613/5197 (88.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0365, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3881/4356 (89.0955%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3605/4356 (82.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.4179, Accuracy: 4646/10000 (46.4600%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4079/4647 (87.7771%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4179/4647 (89.9290%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9488, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3704/4013 (92.3000%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3738/4013 (93.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7734, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4095/4538 (90.2380%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4176/4538 (92.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8584, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4234/4707 (89.9511%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4256/4707 (90.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8266, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5687/6263 (90.8031%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5717/6263 (91.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2142, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3803/4235 (89.7993%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3768/4235 (88.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9851, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3441/3861 (89.1220%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3485/3861 (90.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1120, Accuracy: 5295/10000 (52.9500%)
time spent on training: 257.76466727256775
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11.
Validation completed, confusion matrix created.
Validation completed for user 56, confusion matrix appended.
No suspicious behavior detected for client 56.
No suspicious behavior detected for agent 56.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1976, Accuracy: 6876/10000 (68.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 8.1525, Accuracy: 303/9900 (3.0606%)
Done in 285.0630798339844 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 43.04101593520273.
Norm before scaling: 43.04474813257565. Distance: 2.1213564209551827
Total norm for 4 adversaries is: 43.04474813257565. distance: 2.1213564209551827
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1385, Accuracy: 9554/9900 (96.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 43.04101593520273.
Norm before scaling: 43.04316709302927. Distance: 2.1543309614540407
Total norm for 4 adversaries is: 43.04316709302927. distance: 2.1543309614540407
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2169, Accuracy: 9381/9900 (94.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4272/4717 (90.5660%), train_poison_data_count: 370
Global model norm: 43.04101593520273.
Norm before scaling: 43.040756427683604. Distance: 2.0005779623349165
Total norm for 4 adversaries is: 43.040756427683604. distance: 2.0005779623349165
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1826, Accuracy: 9437/9900 (95.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4518/5066 (89.1828%), train_poison_data_count: 400
Global model norm: 43.04101593520273.
Norm before scaling: 43.04894788566266. Distance: 2.240951888794002
Total norm for 4 adversaries is: 43.04894788566266. distance: 2.240951888794002
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1829, Accuracy: 9438/9900 (95.3333%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4503/5055 (89.0801%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4597/5055 (90.9397%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0119, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3414/3828 (89.1850%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3527/3828 (92.1369%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0074, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3899/4361 (89.4061%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3899/4361 (89.4061%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0056, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3661/4013 (91.2285%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3786/4013 (94.3434%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8563, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4042/4518 (89.4644%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4164/4518 (92.1647%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9422, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4019/4558 (88.1746%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4016/4558 (88.1088%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1273, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3671/4126 (88.9724%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3780/4126 (91.6142%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9911, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4222/4679 (90.2330%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3935/4679 (84.0992%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2181, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3831/4235 (90.4604%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3773/4235 (89.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9756, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4479/5037 (88.9220%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4652/5037 (92.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8306, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3245/3672 (88.3715%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3350/3672 (91.2309%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8465, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4364/4928 (88.5552%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4402/4928 (89.3263%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8339, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3882/4356 (89.1185%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3780/4356 (86.7769%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1114, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4030/4456 (90.4399%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4105/4456 (92.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9768, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4290/4793 (89.5055%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4452/4793 (92.8855%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9446, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4488/5025 (89.3134%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4559/5025 (90.7264%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9517, Accuracy: 5508/10000 (55.0800%)
time spent on training: 254.6569344997406
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1937, Accuracy: 6870/10000 (68.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 8.3553, Accuracy: 238/9900 (2.4040%)
Done in 281.5737535953522 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4425/4885 (90.5834%), train_poison_data_count: 385
Global model norm: 43.06973219158308.
Norm before scaling: 43.075746046481164. Distance: 2.1133585296998074
Total norm for 4 adversaries is: 43.075746046481164. distance: 2.1133585296998074
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1152, Accuracy: 9609/9900 (97.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 43.06973219158308.
Norm before scaling: 43.07204912719646. Distance: 2.1601585677895003
Total norm for 4 adversaries is: 43.07204912719646. distance: 2.1601585677895003
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1283, Accuracy: 9553/9900 (96.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4303/4717 (91.2232%), train_poison_data_count: 370
Global model norm: 43.06973219158308.
Norm before scaling: 43.06799901391403. Distance: 1.9532576859226656
Total norm for 4 adversaries is: 43.06799901391403. distance: 1.9532576859226656
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2692, Accuracy: 9213/9900 (93.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4513/5066 (89.0841%), train_poison_data_count: 400
Global model norm: 43.06973219158308.
Norm before scaling: 43.075604353620946. Distance: 2.198414521683563
Total norm for 4 adversaries is: 43.075604353620946. distance: 2.198414521683563
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2558, Accuracy: 9269/9900 (93.6263%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3924/4346 (90.2899%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4026/4346 (92.6369%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8760, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3714/4184 (88.7667%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3783/4184 (90.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0271, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3859/4356 (88.5904%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3825/4356 (87.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1555, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3268/3646 (89.6325%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3349/3646 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7738, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4490/5083 (88.3337%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4493/5083 (88.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9145, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3868/4356 (88.7971%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3870/4356 (88.8430%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1292, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4025/4558 (88.3063%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4033/4558 (88.4818%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0612, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3688/4175 (88.3353%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3727/4175 (89.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9029, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3172/3472 (91.3594%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3183/3472 (91.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1845, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4005/4501 (88.9802%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4056/4501 (90.1133%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9273, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4834/5424 (89.1224%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4941/5424 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3225, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3935/4481 (87.8152%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3908/4481 (87.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9649, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4925/5455 (90.2841%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4911/5455 (90.0275%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1923, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4597/5232 (87.8631%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4667/5232 (89.2011%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0518, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5500/6391 (86.0585%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5551/6391 (86.8565%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2242, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3401/3775 (90.0927%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3534/3775 (93.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9317, Accuracy: 5611/10000 (56.1100%)
time spent on training: 257.163076877594
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 2.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.2110, Accuracy: 6853/10000 (68.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 8.2466, Accuracy: 259/9900 (2.6162%)
Done in 284.2670977115631 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 43.089138168742714.
Norm before scaling: 43.08901351780405. Distance: 2.115974895443751
Total norm for 4 adversaries is: 43.08901351780405. distance: 2.115974895443751
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1607, Accuracy: 9484/9900 (95.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 43.089138168742714.
Norm before scaling: 43.08590845987235. Distance: 2.11200171919955
Total norm for 4 adversaries is: 43.08590845987235. distance: 2.11200171919955
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0977, Accuracy: 9639/9900 (97.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 43.089138168742714.
Norm before scaling: 43.085231323542004. Distance: 1.9840589256572867
Total norm for 4 adversaries is: 43.085231323542004. distance: 1.9840589256572867
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1039, Accuracy: 9615/9900 (97.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4508/5066 (88.9854%), train_poison_data_count: 400
Global model norm: 43.089138168742714.
Norm before scaling: 43.095530295441456. Distance: 2.2227017309164854
Total norm for 4 adversaries is: 43.095530295441456. distance: 2.2227017309164854
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1847, Accuracy: 9407/9900 (95.0202%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3648/4025 (90.6335%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3724/4025 (92.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9005, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3776/4223 (89.4151%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3857/4223 (91.3332%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0161, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3256/3638 (89.4997%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3389/3638 (93.1556%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9292, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4417/5063 (87.2408%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4357/5063 (86.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1127, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4355/4874 (89.3517%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4208/4874 (86.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2676, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4308/4804 (89.6753%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4262/4804 (88.7177%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3496, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3732/4158 (89.7547%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3735/4158 (89.8268%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9820, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4038/4518 (89.3758%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4121/4518 (91.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9827, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3800/4235 (89.7285%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3765/4235 (88.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9873, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4317/4934 (87.4949%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4107/4934 (83.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1483, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5526/6391 (86.4653%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5565/6391 (87.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1542, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3826/4295 (89.0803%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3809/4295 (88.6845%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0814, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3525/3756 (93.8498%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3597/3756 (95.7668%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7543, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3965/4481 (88.4847%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3895/4481 (86.9226%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0895, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3653/4175 (87.4970%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3687/4175 (88.3114%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9755, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3262/3590 (90.8635%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3243/3590 (90.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0497, Accuracy: 5486/10000 (54.8600%)
time spent on training: 254.91729474067688
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.2548, Accuracy: 6783/10000 (67.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 7.9117, Accuracy: 351/9900 (3.5455%)
Done in 282.05568981170654 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 43.11301350629239.
Norm before scaling: 43.11631479570697. Distance: 2.1031075509468384
Total norm for 4 adversaries is: 43.11631479570697. distance: 2.1031075509468384
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2409, Accuracy: 9287/9900 (93.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4838/5305 (91.1970%), train_poison_data_count: 415
Global model norm: 43.11301350629239.
Norm before scaling: 43.11425222727616. Distance: 2.0920213993794197
Total norm for 4 adversaries is: 43.11425222727616. distance: 2.0920213993794197
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.3212, Accuracy: 9133/9900 (92.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4250/4717 (90.0996%), train_poison_data_count: 370
Global model norm: 43.11301350629239.
Norm before scaling: 43.116193054531436. Distance: 2.0477232594970816
Total norm for 4 adversaries is: 43.116193054531436. distance: 2.0477232594970816
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1553, Accuracy: 9521/9900 (96.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 43.11301350629239.
Norm before scaling: 43.119605923976884. Distance: 2.20799885022092
Total norm for 4 adversaries is: 43.119605923976884. distance: 2.20799885022092
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2015, Accuracy: 9372/9900 (94.6667%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3441/3828 (89.8903%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3546/3828 (92.6332%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8769, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3496/3911 (89.3889%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3360/3911 (85.9115%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1950, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3978/4362 (91.1967%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3948/4362 (90.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0032, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4668/5197 (89.8211%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4552/5197 (87.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2680, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4217/4679 (90.1261%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4183/4679 (89.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2862, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4280/4793 (89.2969%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4333/4793 (90.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9836, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4536/5116 (88.6630%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4601/5116 (89.9335%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0127, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4026/4625 (87.0486%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4023/4625 (86.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1406, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4132/4618 (89.4760%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4031/4618 (87.2889%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1149, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2890/3271 (88.3522%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2948/3271 (90.1253%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9829, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3738/4175 (89.5329%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3728/4175 (89.2934%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9948, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3158/3616 (87.3341%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3310/3616 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9171, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3859/4481 (86.1192%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3910/4481 (87.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1925, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3942/4368 (90.2473%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3954/4368 (90.5220%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8423, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5024/5740 (87.5261%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5179/5740 (90.2265%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9939, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4069/4647 (87.5619%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4181/4647 (89.9720%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9653, Accuracy: 5457/10000 (54.5700%)
time spent on training: 255.8426764011383
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18.
Validation completed, confusion matrix created.
Validation completed for user 90, confusion matrix appended.
No suspicious behavior detected for client 90.
No suspicious behavior detected for agent 90.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 31, confusion matrix appended.
No suspicious behavior detected for client 31.
No suspicious behavior detected for agent 31.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.2402, Accuracy: 6834/10000 (68.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 7.9066, Accuracy: 344/9900 (3.4747%)
Done in 282.89422035217285 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 43.14417457554018.
Norm before scaling: 43.14447448643844. Distance: 2.0248097365676894
Total norm for 4 adversaries is: 43.14447448643844. distance: 2.0248097365676894
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2463, Accuracy: 9287/9900 (93.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4823/5305 (90.9142%), train_poison_data_count: 415
Global model norm: 43.14417457554018.
Norm before scaling: 43.1396855656497. Distance: 2.119079645219982
Total norm for 4 adversaries is: 43.1396855656497. distance: 2.119079645219982
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2404, Accuracy: 9296/9900 (93.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4263/4717 (90.3752%), train_poison_data_count: 370
Global model norm: 43.14417457554018.
Norm before scaling: 43.146087179107994. Distance: 2.049597407561069
Total norm for 4 adversaries is: 43.146087179107994. distance: 2.049597407561069
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1117, Accuracy: 9599/9900 (96.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4548/5066 (89.7750%), train_poison_data_count: 400
Global model norm: 43.14417457554018.
Norm before scaling: 43.15069858166768. Distance: 2.189549058621122
Total norm for 4 adversaries is: 43.15069858166768. distance: 2.189549058621122
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1309, Accuracy: 9537/9900 (96.3333%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4948/5591 (88.4994%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4942/5591 (88.3921%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2217, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4340/4956 (87.5706%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4361/4956 (87.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0158, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3959/4511 (87.7632%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4111/4511 (91.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0025, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3674/4013 (91.5525%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3761/4013 (93.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.7418, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3336/3590 (92.9248%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3404/3590 (94.8189%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8493, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4281/4793 (89.3178%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4376/4793 (91.2998%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9781, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3393/3804 (89.1956%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3467/3804 (91.1409%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0917, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3510/3837 (91.4777%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3557/3837 (92.7026%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8981, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3969/4361 (91.0112%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3907/4361 (89.5895%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0587, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4418/5063 (87.2605%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4352/5063 (85.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1570, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3894/4368 (89.1484%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3977/4368 (91.0485%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9791, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4237/4679 (90.5535%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4089/4679 (87.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1814, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4687/5265 (89.0218%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4711/5265 (89.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1473, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4209/4767 (88.2945%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4190/4767 (87.8960%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2575, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5155/5902 (87.3433%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4936/5902 (83.6327%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3537, Accuracy: 4894/10000 (48.9400%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3750/4223 (88.7994%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3854/4223 (91.2621%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9123, Accuracy: 5648/10000 (56.4800%)
time spent on training: 255.85966420173645
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.2347, Accuracy: 6847/10000 (68.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 8.0367, Accuracy: 287/9900 (2.8990%)
Done in 282.76594614982605 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 43.169683598924486.
Norm before scaling: 43.16785404727545. Distance: 1.9883618291628602
Total norm for 4 adversaries is: 43.16785404727545. distance: 1.9883618291628602
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2596, Accuracy: 9221/9900 (93.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 43.169683598924486.
Norm before scaling: 43.171375935859544. Distance: 2.165765415940412
Total norm for 4 adversaries is: 43.171375935859544. distance: 2.165765415940412
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2520, Accuracy: 9221/9900 (93.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 43.169683598924486.
Norm before scaling: 43.168070373884994. Distance: 1.9937561441643732
Total norm for 4 adversaries is: 43.168070373884994. distance: 1.9937561441643732
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1940, Accuracy: 9421/9900 (95.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4558/5066 (89.9724%), train_poison_data_count: 400
Global model norm: 43.169683598924486.
Norm before scaling: 43.175413524456395. Distance: 2.213009136693049
Total norm for 4 adversaries is: 43.175413524456395. distance: 2.213009136693049
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2023, Accuracy: 9382/9900 (94.7677%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3451/3797 (90.8875%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3449/3797 (90.8349%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8583, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3505/3861 (90.7796%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3515/3861 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8674, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4190/4707 (89.0164%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4197/4707 (89.1651%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1507, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4070/4518 (90.0841%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4140/4518 (91.6335%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0550, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3685/4013 (91.8266%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3733/4013 (93.0227%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9014, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4623/5167 (89.4716%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4646/5167 (89.9168%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0847, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3510/3969 (88.4354%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3601/3969 (90.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9674, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4085/4441 (91.9838%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4129/4441 (92.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0087, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4060/4558 (89.0742%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4062/4558 (89.1180%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2284, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4008/4465 (89.7648%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4098/4465 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8461, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3303/3638 (90.7916%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3352/3638 (92.1385%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8350, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4078/4538 (89.8634%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4210/4538 (92.7721%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7792, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5066/5740 (88.2578%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5223/5740 (90.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1812, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3487/3837 (90.8783%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3565/3837 (92.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9068, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3924/4361 (89.9794%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3630/4361 (83.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1651, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4289/4793 (89.4847%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4356/4793 (90.8825%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9870, Accuracy: 5427/10000 (54.2700%)
time spent on training: 252.31328964233398
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 57, confusion matrix appended.
No suspicious behavior detected for client 57.
No suspicious behavior detected for agent 57.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 84, confusion matrix appended.
No suspicious behavior detected for client 84.
No suspicious behavior detected for agent 84.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.2456, Accuracy: 6813/10000 (68.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 7.8762, Accuracy: 318/9900 (3.2121%)
Done in 279.31676959991455 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 43.199283565655776.
Norm before scaling: 43.19988685875664. Distance: 2.0552837246502627
Total norm for 4 adversaries is: 43.19988685875664. distance: 2.0552837246502627
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2386, Accuracy: 9303/9900 (93.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 43.199283565655776.
Norm before scaling: 43.19803315382976. Distance: 2.1215602860472202
Total norm for 4 adversaries is: 43.19803315382976. distance: 2.1215602860472202
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1195, Accuracy: 9603/9900 (97.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4265/4717 (90.4176%), train_poison_data_count: 370
Global model norm: 43.199283565655776.
Norm before scaling: 43.19903066042107. Distance: 2.032714550523189
Total norm for 4 adversaries is: 43.19903066042107. distance: 2.032714550523189
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2829, Accuracy: 9210/9900 (93.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 43.199283565655776.
Norm before scaling: 43.203058600762716. Distance: 2.1636106384283793
Total norm for 4 adversaries is: 43.203058600762716. distance: 2.1636106384283793
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1910, Accuracy: 9414/9900 (95.0909%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4174/4767 (87.5603%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4215/4767 (88.4204%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1807, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4084/4441 (91.9613%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4151/4441 (93.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0690, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3895/4356 (89.4169%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3678/4356 (84.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.6938, Accuracy: 4732/10000 (47.3200%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5500/6391 (86.0585%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5560/6391 (86.9973%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1083, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3725/4184 (89.0296%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3713/4184 (88.7428%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0088, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3910/4346 (89.9678%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4027/4346 (92.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8666, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4477/5037 (88.8823%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4647/5037 (92.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0074, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4131/4634 (89.1454%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4189/4634 (90.3971%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8563, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4316/4934 (87.4747%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4237/4934 (85.8735%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1465, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4853/5424 (89.4727%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4920/5424 (90.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1112, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3404/3781 (90.0291%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3165/3781 (83.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3063, Accuracy: 4946/10000 (49.4600%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3547/3861 (91.8674%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3555/3861 (92.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9031, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4515/5055 (89.3175%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4583/5055 (90.6627%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0774, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4008/4433 (90.4128%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3969/4433 (89.5330%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9705, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4608/5167 (89.1813%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4671/5167 (90.4006%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1266, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3352/3590 (93.3705%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3323/3590 (92.5627%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8882, Accuracy: 5791/10000 (57.9100%)
time spent on training: 256.79778265953064
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 72, confusion matrix appended.
No suspicious behavior detected for client 72.
No suspicious behavior detected for agent 72.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 21, confusion matrix appended.
No suspicious behavior detected for client 21.
No suspicious behavior detected for agent 21.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 79, confusion matrix appended.
No suspicious behavior detected for client 79.
No suspicious behavior detected for agent 79.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 65, confusion matrix appended.
No suspicious behavior detected for client 65.
No suspicious behavior detected for agent 65.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.2775, Accuracy: 6783/10000 (67.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 7.5788, Accuracy: 413/9900 (4.1717%)
Done in 283.7707107067108 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4433/4885 (90.7472%), train_poison_data_count: 385
Global model norm: 43.22081464247724.
Norm before scaling: 43.22184692673154. Distance: 2.090470435753931
Total norm for 4 adversaries is: 43.22184692673154. distance: 2.090470435753931
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2732, Accuracy: 9253/9900 (93.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4844/5305 (91.3101%), train_poison_data_count: 415
Global model norm: 43.22081464247724.
Norm before scaling: 43.21935019693508. Distance: 2.071681538060713
Total norm for 4 adversaries is: 43.21935019693508. distance: 2.071681538060713
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2339, Accuracy: 9319/9900 (94.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 43.22081464247724.
Norm before scaling: 43.22099539991386. Distance: 1.9864884183379463
Total norm for 4 adversaries is: 43.22099539991386. distance: 1.9864884183379463
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1821, Accuracy: 9442/9900 (95.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4584/5066 (90.4856%), train_poison_data_count: 400
Global model norm: 43.22081464247724.
Norm before scaling: 43.22508483490085. Distance: 2.1478327229398477
Total norm for 4 adversaries is: 43.22508483490085. distance: 2.1478327229398477
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3035, Accuracy: 9161/9900 (92.5354%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3915/4368 (89.6291%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3967/4368 (90.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9201, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3416/3828 (89.2372%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3499/3828 (91.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8016, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3954/4356 (90.7713%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3655/4356 (83.9073%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1430, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3507/3861 (90.8314%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3536/3861 (91.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8588, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3189/3472 (91.8491%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3195/3472 (92.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0032, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4131/4538 (91.0313%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4188/4538 (92.2874%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9433, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4809/5392 (89.1877%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4825/5392 (89.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0740, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3830/4295 (89.1735%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3628/4295 (84.4703%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1384, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3808/4235 (89.9174%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3838/4235 (90.6257%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8854, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4058/4456 (91.0682%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4055/4456 (91.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8926, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4660/5265 (88.5090%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4627/5265 (87.8822%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0552, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4085/4441 (91.9838%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4126/4441 (92.9070%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9683, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3676/4013 (91.6023%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3729/4013 (92.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8245, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4011/4465 (89.8320%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4104/4465 (91.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9919, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5671/6263 (90.5477%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5708/6263 (91.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9626, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4428/4986 (88.8087%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4517/4986 (90.5937%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8452, Accuracy: 5702/10000 (57.0200%)
time spent on training: 254.09843397140503
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 55, confusion matrix appended.
No suspicious behavior detected for client 55.
No suspicious behavior detected for agent 55.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 75, confusion matrix appended.
No suspicious behavior detected for client 75.
No suspicious behavior detected for agent 75.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 69, confusion matrix appended.
No suspicious behavior detected for client 69.
No suspicious behavior detected for agent 69.
Validation completed, confusion matrix created.
Validation completed for user 99, confusion matrix appended.
No suspicious behavior detected for client 99.
No suspicious behavior detected for agent 99.
Validation completed, confusion matrix created.
Validation completed for user 92, confusion matrix appended.
No suspicious behavior detected for client 92.
No suspicious behavior detected for agent 92.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.2495, Accuracy: 6829/10000 (68.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 7.7210, Accuracy: 379/9900 (3.8283%)
Done in 281.21650290489197 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4421/4885 (90.5015%), train_poison_data_count: 385
Global model norm: 43.2529902664797.
Norm before scaling: 43.25773278053879. Distance: 2.100129954540493
Total norm for 4 adversaries is: 43.25773278053879. distance: 2.100129954540493
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1660, Accuracy: 9490/9900 (95.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4815/5305 (90.7634%), train_poison_data_count: 415
Global model norm: 43.2529902664797.
Norm before scaling: 43.25542437985379. Distance: 2.142755714922494
Total norm for 4 adversaries is: 43.25542437985379. distance: 2.142755714922494
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1197, Accuracy: 9604/9900 (97.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 43.2529902664797.
Norm before scaling: 43.24995484101689. Distance: 1.9595556975885897
Total norm for 4 adversaries is: 43.24995484101689. distance: 1.9595556975885897
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2177, Accuracy: 9338/9900 (94.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4575/5066 (90.3079%), train_poison_data_count: 400
Global model norm: 43.2529902664797.
Norm before scaling: 43.25866824036181. Distance: 2.1734158106913943
Total norm for 4 adversaries is: 43.25866824036181. distance: 2.1734158106913943
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1897, Accuracy: 9410/9900 (95.0505%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3709/4158 (89.2015%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3708/4158 (89.1775%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0873, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4604/5167 (89.1039%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4670/5167 (90.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1197, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3443/3828 (89.9425%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3465/3828 (90.5172%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8999, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4242/4663 (90.9715%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4284/4663 (91.8722%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9362, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4015/4433 (90.5707%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4114/4433 (92.8040%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1207, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3745/4184 (89.5076%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3768/4184 (90.0574%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9572, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4227/4716 (89.6310%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4249/4716 (90.0975%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1065, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3888/4223 (92.0673%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3907/4223 (92.5172%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8662, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4206/4679 (89.8910%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4125/4679 (88.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2768, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3344/3704 (90.2808%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3428/3704 (92.5486%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8503, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3517/3837 (91.6602%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3610/3837 (94.0839%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9536, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3545/3861 (91.8156%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3554/3861 (92.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9407, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4849/5424 (89.3990%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4903/5424 (90.3945%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0960, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4128/4576 (90.2098%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4218/4576 (92.1766%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8499, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3661/4025 (90.9565%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3740/4025 (92.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8979, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3479/3775 (92.1589%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3551/3775 (94.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8169, Accuracy: 5818/10000 (58.1800%)
time spent on training: 252.7061493396759
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 33, confusion matrix appended.
No suspicious behavior detected for client 33.
No suspicious behavior detected for agent 33.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 96, confusion matrix appended.
No suspicious behavior detected for client 96.
No suspicious behavior detected for agent 96.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 51, confusion matrix appended.
No suspicious behavior detected for client 51.
No suspicious behavior detected for agent 51.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.2548, Accuracy: 6787/10000 (67.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 7.5980, Accuracy: 411/9900 (4.1515%)
Done in 279.58317136764526 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4460/4885 (91.2999%), train_poison_data_count: 385
Global model norm: 43.27110243180849.
Norm before scaling: 43.27080339857133. Distance: 2.0415122564145483
Total norm for 4 adversaries is: 43.27080339857133. distance: 2.0415122564145483
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1505, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4826/5305 (90.9708%), train_poison_data_count: 415
Global model norm: 43.27110243180849.
Norm before scaling: 43.271031905287835. Distance: 2.159210605132555
Total norm for 4 adversaries is: 43.271031905287835. distance: 2.159210605132555
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2278, Accuracy: 9302/9900 (93.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4302/4717 (91.2020%), train_poison_data_count: 370
Global model norm: 43.27110243180849.
Norm before scaling: 43.26795965847953. Distance: 1.9358327521680314
Total norm for 4 adversaries is: 43.26795965847953. distance: 1.9358327521680314
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.4468, Accuracy: 8831/9900 (89.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 43.27110243180849.
Norm before scaling: 43.27521392928058. Distance: 2.1805338429897354
Total norm for 4 adversaries is: 43.27521392928058. distance: 2.1805338429897354
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1025, Accuracy: 9626/9900 (97.2323%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4100/4576 (89.5979%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4191/4576 (91.5865%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0209, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3260/3672 (88.7800%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3342/3672 (91.0131%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9275, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4173/4618 (90.3638%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4125/4618 (89.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0474, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4110/4538 (90.5685%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4243/4538 (93.4993%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8159, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4553/5025 (90.6070%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4647/5025 (92.4776%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0490, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3396/3590 (94.5961%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3421/3590 (95.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.7972, Accuracy: 5934/10000 (59.3400%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4200/4707 (89.2288%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4271/4707 (90.7372%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0295, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4391/4918 (89.2843%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4450/4918 (90.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0888, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3901/4336 (89.9677%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3925/4336 (90.5212%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0111, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5166/5902 (87.5297%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5115/5902 (86.6655%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0905, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4043/4441 (91.0381%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4146/4441 (93.3574%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9831, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4582/5232 (87.5765%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4602/5232 (87.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0937, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4312/4804 (89.7585%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4185/4804 (87.1149%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2379, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3568/3969 (89.8967%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3590/3969 (90.4510%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0572, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4855/5392 (90.0408%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4852/5392 (89.9852%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0469, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3414/3828 (89.1850%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3493/3828 (91.2487%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0066, Accuracy: 5442/10000 (54.4200%)
time spent on training: 255.95919799804688
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 63, confusion matrix appended.
No suspicious behavior detected for client 63.
No suspicious behavior detected for agent 63.
Validation completed, confusion matrix created.
Validation completed for user 47, confusion matrix appended.
No suspicious behavior detected for client 47.
No suspicious behavior detected for agent 47.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 3.
Validation completed, confusion matrix created.
Validation completed for user 41, confusion matrix appended.
No suspicious behavior detected for client 41.
No suspicious behavior detected for agent 41.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 24, confusion matrix appended.
No suspicious behavior detected for client 24.
No suspicious behavior detected for agent 24.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.2513, Accuracy: 6804/10000 (68.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 7.5081, Accuracy: 396/9900 (4.0000%)
Done in 283.04714012145996 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4487/4885 (91.8526%), train_poison_data_count: 385
Global model norm: 43.295155144477484.
Norm before scaling: 43.294964828397625. Distance: 2.0154783210317166
Total norm for 4 adversaries is: 43.294964828397625. distance: 2.0154783210317166
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1331, Accuracy: 9580/9900 (96.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4820/5305 (90.8577%), train_poison_data_count: 415
Global model norm: 43.295155144477484.
Norm before scaling: 43.293587478942825. Distance: 2.1385702030627227
Total norm for 4 adversaries is: 43.293587478942825. distance: 2.1385702030627227
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1657, Accuracy: 9472/9900 (95.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4262/4717 (90.3540%), train_poison_data_count: 370
Global model norm: 43.295155144477484.
Norm before scaling: 43.29298972102036. Distance: 1.9946593862420252
Total norm for 4 adversaries is: 43.29298972102036. distance: 1.9946593862420252
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2464, Accuracy: 9289/9900 (93.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4589/5066 (90.5843%), train_poison_data_count: 400
Global model norm: 43.295155144477484.
Norm before scaling: 43.29470543328234. Distance: 2.144773153478664
Total norm for 4 adversaries is: 43.29470543328234. distance: 2.144773153478664
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1136, Accuracy: 9570/9900 (96.6667%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4549/5232 (86.9457%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4610/5232 (88.1116%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2602, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4393/4956 (88.6400%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4387/4956 (88.5190%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1359, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4408/5063 (87.0630%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4450/5063 (87.8926%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0544, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3666/4025 (91.0807%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3713/4025 (92.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8537, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4068/4441 (91.6010%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4084/4441 (91.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0974, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4045/4625 (87.4595%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4050/4625 (87.5676%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1057, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4872/5591 (87.1400%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4859/5591 (86.9075%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2047, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5059/5582 (90.6306%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5070/5582 (90.8277%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1050, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5131/5902 (86.9366%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5150/5902 (87.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1921, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4116/4538 (90.7007%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4200/4538 (92.5518%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8143, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4618/5025 (91.9005%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4653/5025 (92.5970%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0400, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3864/4223 (91.4989%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3910/4223 (92.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8862, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3915/4361 (89.7730%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3768/4361 (86.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0800, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3915/4354 (89.9173%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3686/4354 (84.6578%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3505, Accuracy: 4819/10000 (48.1900%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3299/3672 (89.8420%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3350/3672 (91.2309%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0018, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3935/4356 (90.3352%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3920/4356 (89.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2060, Accuracy: 5135/10000 (51.3500%)
time spent on training: 262.0237591266632
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 46, confusion matrix appended.
No suspicious behavior detected for client 46.
No suspicious behavior detected for agent 46.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 48, confusion matrix appended.
No suspicious behavior detected for client 48.
No suspicious behavior detected for agent 48.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 15.
Validation completed, confusion matrix created.
Validation completed for user 25, confusion matrix appended.
No suspicious behavior detected for client 25.
No suspicious behavior detected for agent 25.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 6.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 27, confusion matrix appended.
No suspicious behavior detected for client 27.
No suspicious behavior detected for agent 27.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 87, confusion matrix appended.
No suspicious behavior detected for client 87.
No suspicious behavior detected for agent 87.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.2294, Accuracy: 6848/10000 (68.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 7.9451, Accuracy: 286/9900 (2.8889%)
Done in 289.31391644477844 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4432/4885 (90.7267%), train_poison_data_count: 385
Global model norm: 43.32054990354246.
Norm before scaling: 43.32180523239712. Distance: 2.0727306135506605
Total norm for 4 adversaries is: 43.32180523239712. distance: 2.0727306135506605
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0969, Accuracy: 9658/9900 (97.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4830/5305 (91.0462%), train_poison_data_count: 415
Global model norm: 43.32054990354246.
Norm before scaling: 43.31539858852522. Distance: 2.065058883677218
Total norm for 4 adversaries is: 43.31539858852522. distance: 2.065058883677218
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2112, Accuracy: 9369/9900 (94.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4293/4717 (91.0112%), train_poison_data_count: 370
Global model norm: 43.32054990354246.
Norm before scaling: 43.31944106990965. Distance: 1.9720285153368127
Total norm for 4 adversaries is: 43.31944106990965. distance: 1.9720285153368127
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.4206, Accuracy: 8931/9900 (90.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 43.32054990354246.
Norm before scaling: 43.32354938876344. Distance: 2.1984259089291096
Total norm for 4 adversaries is: 43.32354938876344. distance: 2.1984259089291096
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1281, Accuracy: 9591/9900 (96.8788%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3554/3828 (92.8422%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3551/3828 (92.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8970, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3831/4235 (90.4604%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3835/4235 (90.5549%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9270, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3329/3704 (89.8758%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3333/3704 (89.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9161, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3688/4046 (91.1518%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3706/4046 (91.5966%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8498, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4415/4928 (89.5901%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4456/4928 (90.4221%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8046, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5118/5740 (89.1638%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5124/5740 (89.2683%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0508, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4486/5083 (88.2550%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4489/5083 (88.3140%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9925, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4129/4576 (90.2316%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4130/4576 (90.2535%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0168, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4225/4647 (90.9189%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4284/4647 (92.1885%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9539, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4875/5424 (89.8783%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4915/5424 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3077, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3993/4503 (88.6742%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4055/4503 (90.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0499, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5522/6391 (86.4028%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5564/6391 (87.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1240, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4045/4511 (89.6697%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4047/4511 (89.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9049, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4034/4456 (90.5296%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4072/4456 (91.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0424, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4288/4804 (89.2590%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4070/4804 (84.7211%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3430, Accuracy: 5036/10000 (50.3600%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3396/3804 (89.2744%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3449/3804 (90.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9368, Accuracy: 5574/10000 (55.7400%)
time spent on training: 256.0381019115448
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 73, confusion matrix appended.
No suspicious behavior detected for client 73.
No suspicious behavior detected for agent 73.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 59, confusion matrix appended.
No suspicious behavior detected for client 59.
No suspicious behavior detected for agent 59.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 77, confusion matrix appended.
No suspicious behavior detected for client 77.
No suspicious behavior detected for agent 77.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 64, confusion matrix appended.
No suspicious behavior detected for client 64.
No suspicious behavior detected for agent 64.
Validation completed, confusion matrix created.
Validation completed for user 85, confusion matrix appended.
No suspicious behavior detected for client 85.
No suspicious behavior detected for agent 85.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 17.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.2285, Accuracy: 6825/10000 (68.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 7.7259, Accuracy: 356/9900 (3.5960%)
Done in 283.3633716106415 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 43.34324024123456.
Norm before scaling: 43.34357538717532. Distance: 2.037248996181524
Total norm for 4 adversaries is: 43.34357538717532. distance: 2.037248996181524
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2005, Accuracy: 9400/9900 (94.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 43.34324024123456.
Norm before scaling: 43.34242067175644. Distance: 2.1498469497853145
Total norm for 4 adversaries is: 43.34242067175644. distance: 2.1498469497853145
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2193, Accuracy: 9332/9900 (94.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4286/4717 (90.8628%), train_poison_data_count: 370
Global model norm: 43.34324024123456.
Norm before scaling: 43.342399548626894. Distance: 1.987962138830512
Total norm for 4 adversaries is: 43.342399548626894. distance: 1.987962138830512
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1298, Accuracy: 9564/9900 (96.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4588/5066 (90.5645%), train_poison_data_count: 400
Global model norm: 43.34324024123456.
Norm before scaling: 43.34383308166154. Distance: 2.1169775827092168
Total norm for 4 adversaries is: 43.34383308166154. distance: 2.1169775827092168
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0934, Accuracy: 9656/9900 (97.5354%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4404/4928 (89.3669%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4397/4928 (89.2248%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8974, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4514/5037 (89.6168%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4617/5037 (91.6617%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9994, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4868/5392 (90.2819%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4825/5392 (89.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0209, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3992/4501 (88.6914%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4025/4501 (89.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0106, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3483/3804 (91.5615%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3503/3804 (92.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8663, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3514/3837 (91.5820%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3609/3837 (94.0579%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8677, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4403/5063 (86.9643%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4172/5063 (82.4017%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1725, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3936/4481 (87.8375%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3908/4481 (87.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1502, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4087/4518 (90.4604%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4141/4518 (91.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9790, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3260/3638 (89.6097%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3355/3638 (92.2210%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8555, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4238/4663 (90.8857%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4296/4663 (92.1295%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0240, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4033/4625 (87.2000%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3998/4625 (86.4432%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1158, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4584/5197 (88.2047%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4615/5197 (88.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1068, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4518/5083 (88.8845%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4555/5083 (89.6124%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0697, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3531/3828 (92.2414%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3602/3828 (94.0961%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8426, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3327/3704 (89.8218%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3421/3704 (92.3596%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9815, Accuracy: 5574/10000 (55.7400%)
time spent on training: 256.4229302406311
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 16.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 70, confusion matrix appended.
No suspicious behavior detected for client 70.
No suspicious behavior detected for agent 70.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 8.
Validation completed, confusion matrix created.
Validation completed for user 60, confusion matrix appended.
No suspicious behavior detected for client 60.
No suspicious behavior detected for agent 60.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 62, confusion matrix appended.
No suspicious behavior detected for client 62.
No suspicious behavior detected for agent 62.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 34, confusion matrix appended.
No suspicious behavior detected for client 34.
No suspicious behavior detected for agent 34.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 12.
Validation completed, confusion matrix created.
Validation completed for user 98, confusion matrix appended.
No suspicious behavior detected for client 98.
No suspicious behavior detected for agent 98.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.2371, Accuracy: 6811/10000 (68.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 7.9859, Accuracy: 281/9900 (2.8384%)
Done in 283.6680762767792 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4450/4885 (91.0952%), train_poison_data_count: 385
Global model norm: 43.365267054622755.
Norm before scaling: 43.36666605365664. Distance: 2.088719944626392
Total norm for 4 adversaries is: 43.36666605365664. distance: 2.088719944626392
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2413, Accuracy: 9288/9900 (93.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4820/5305 (90.8577%), train_poison_data_count: 415
Global model norm: 43.365267054622755.
Norm before scaling: 43.36490111181507. Distance: 2.0946677175228237
Total norm for 4 adversaries is: 43.36490111181507. distance: 2.0946677175228237
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1179, Accuracy: 9603/9900 (97.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4288/4717 (90.9052%), train_poison_data_count: 370
Global model norm: 43.365267054622755.
Norm before scaling: 43.363321892434335. Distance: 1.98443723565976
Total norm for 4 adversaries is: 43.363321892434335. distance: 1.98443723565976
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2387, Accuracy: 9320/9900 (94.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 43.365267054622755.
Norm before scaling: 43.366134045257596. Distance: 2.14169140169379
Total norm for 4 adversaries is: 43.366134045257596. distance: 2.14169140169379
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1676, Accuracy: 9454/9900 (95.4949%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3516/3861 (91.0645%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3573/3861 (92.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9088, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3782/4184 (90.3920%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3828/4184 (91.4914%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8714, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4503/5037 (89.3985%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4566/5037 (90.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9571, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4584/5197 (88.2047%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4461/5197 (85.8380%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1580, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4525/5025 (90.0498%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4582/5025 (91.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0057, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4601/5116 (89.9335%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4525/5116 (88.4480%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9874, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3956/4481 (88.2839%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3938/4481 (87.8822%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0772, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4174/4576 (91.2150%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4192/4576 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9519, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4583/5232 (87.5956%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4681/5232 (89.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0710, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3882/4354 (89.1594%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3891/4354 (89.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1558, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2905/3271 (88.8108%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2953/3271 (90.2782%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8996, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4915/5455 (90.1008%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4936/5455 (90.4858%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0791, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3725/4126 (90.2811%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3788/4126 (91.8080%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9027, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3410/3797 (89.8077%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3458/3797 (91.0719%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9784, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3424/3704 (92.4406%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3444/3704 (92.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8593, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4359/4934 (88.3462%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4268/4934 (86.5018%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1741, Accuracy: 5163/10000 (51.6300%)
time spent on training: 255.38918042182922
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 14.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 45, confusion matrix appended.
No suspicious behavior detected for client 45.
No suspicious behavior detected for agent 45.
Validation completed, confusion matrix created.
Validation completed for user 49, confusion matrix appended.
No suspicious behavior detected for client 49.
No suspicious behavior detected for agent 49.
Validation completed, confusion matrix created.
Validation completed for user 80, confusion matrix appended.
No suspicious behavior detected for client 80.
No suspicious behavior detected for agent 80.
Validation completed, confusion matrix created.
Validation completed for user 67, confusion matrix appended.
No suspicious behavior detected for client 67.
No suspicious behavior detected for agent 67.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 43, confusion matrix appended.
No suspicious behavior detected for client 43.
No suspicious behavior detected for agent 43.
Validation completed, confusion matrix created.
Validation completed for user 22, confusion matrix appended.
No suspicious behavior detected for client 22.
No suspicious behavior detected for agent 22.
Validation completed, confusion matrix created.
Validation completed for user 37, confusion matrix appended.
No suspicious behavior detected for client 37.
No suspicious behavior detected for agent 37.
Validation completed, confusion matrix created.
Validation completed for user 83, confusion matrix appended.
No suspicious behavior detected for client 83.
No suspicious behavior detected for agent 83.
Validation completed, confusion matrix created.
Validation completed for user 40, confusion matrix appended.
No suspicious behavior detected for client 40.
No suspicious behavior detected for agent 40.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 52, confusion matrix appended.
No suspicious behavior detected for client 52.
No suspicious behavior detected for agent 52.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 4.
Validation completed, confusion matrix created.
Validation completed for user 88, confusion matrix appended.
No suspicious behavior detected for client 88.
No suspicious behavior detected for agent 88.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.2619, Accuracy: 6768/10000 (67.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 8.2362, Accuracy: 230/9900 (2.3232%)
Done in 282.46607065200806 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4505/4885 (92.2211%), train_poison_data_count: 385
Global model norm: 43.403052325520555.
Norm before scaling: 43.400906348542996. Distance: 1.9825741864402906
Total norm for 4 adversaries is: 43.400906348542996. distance: 1.9825741864402906
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1810, Accuracy: 9440/9900 (95.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4813/5305 (90.7257%), train_poison_data_count: 415
Global model norm: 43.403052325520555.
Norm before scaling: 43.40287232628591. Distance: 2.14657145524
Total norm for 4 adversaries is: 43.40287232628591. distance: 2.14657145524
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2691, Accuracy: 9216/9900 (93.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 43.403052325520555.
Norm before scaling: 43.39990926284798. Distance: 2.0450403275745566
Total norm for 4 adversaries is: 43.39990926284798. distance: 2.0450403275745566
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1757, Accuracy: 9449/9900 (95.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 43.403052325520555.
Norm before scaling: 43.400537893592116. Distance: 2.1645161397697477
Total norm for 4 adversaries is: 43.400537893592116. distance: 2.1645161397697477
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1374, Accuracy: 9520/9900 (96.1616%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4156/4618 (89.9957%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4121/4618 (89.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0036, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4004/4625 (86.5730%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4072/4625 (88.0432%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2834, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5105/5740 (88.9373%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5100/5740 (88.8502%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3697, Accuracy: 4905/10000 (49.0500%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3916/4416 (88.6775%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3987/4416 (90.2853%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0368, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3762/4126 (91.1779%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3802/4126 (92.1474%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8379, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3166/3616 (87.5553%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3323/3616 (91.8971%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8164, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3708/4158 (89.1775%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3756/4158 (90.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9863, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3961/4346 (91.1413%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4020/4346 (92.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0016, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4281/4874 (87.8334%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4323/4874 (88.6951%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3577, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4707/5265 (89.4017%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4686/5265 (89.0028%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0497, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3663/4025 (91.0062%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3712/4025 (92.2236%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9685, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4189/4651 (90.0667%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4232/4651 (90.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0488, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3484/3837 (90.8001%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3544/3837 (92.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9992, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3252/3638 (89.3898%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3301/3638 (90.7367%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9108, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3179/3472 (91.5611%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8476, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4054/4456 (90.9785%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4135/4456 (92.7962%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0324, Accuracy: 5485/10000 (54.8500%)
time spent on training: 252.83782720565796
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 81, confusion matrix appended.
No suspicious behavior detected for client 81.
No suspicious behavior detected for agent 81.
Validation completed, confusion matrix created.
Validation completed for user 95, confusion matrix appended.
No suspicious behavior detected for client 95.
No suspicious behavior detected for agent 95.
Validation completed, confusion matrix created.
Validation completed for user 38, confusion matrix appended.
No suspicious behavior detected for client 38.
No suspicious behavior detected for agent 38.
Validation completed, confusion matrix created.
Validation completed for user 74, confusion matrix appended.
No suspicious behavior detected for client 74.
No suspicious behavior detected for agent 74.
Validation completed, confusion matrix created.
Validation completed for user 61, confusion matrix appended.
No suspicious behavior detected for client 61.
No suspicious behavior detected for agent 61.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 91, confusion matrix appended.
No suspicious behavior detected for client 91.
No suspicious behavior detected for agent 91.
Validation completed, confusion matrix created.
Validation completed for user 29, confusion matrix appended.
No suspicious behavior detected for client 29.
No suspicious behavior detected for agent 29.
Validation completed, confusion matrix created.
Validation completed for user 82, confusion matrix appended.
No suspicious behavior detected for client 82.
No suspicious behavior detected for agent 82.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 9.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 93, confusion matrix appended.
No suspicious behavior detected for client 93.
No suspicious behavior detected for agent 93.
Validation completed, confusion matrix created.
Validation completed for user 39, confusion matrix appended.
No suspicious behavior detected for client 39.
No suspicious behavior detected for agent 39.
Validation completed, confusion matrix created.
Validation completed for user 76, confusion matrix appended.
No suspicious behavior detected for client 76.
No suspicious behavior detected for agent 76.
Validation completed, confusion matrix created.
Validation completed for user 30, confusion matrix appended.
No suspicious behavior detected for client 30.
No suspicious behavior detected for agent 30.
Validation completed, confusion matrix created.
Validation completed for user 66, confusion matrix appended.
No suspicious behavior detected for client 66.
No suspicious behavior detected for agent 66.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.2843, Accuracy: 6753/10000 (67.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 8.2985, Accuracy: 219/9900 (2.2121%)
Done in 279.9616014957428 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 43.42769954637967.
Norm before scaling: 43.43090243286239. Distance: 2.1085150201889835
Total norm for 4 adversaries is: 43.43090243286239. distance: 2.1085150201889835
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2049, Accuracy: 9416/9900 (95.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4843/5305 (91.2912%), train_poison_data_count: 415
Global model norm: 43.42769954637967.
Norm before scaling: 43.42625472694341. Distance: 2.1237037295307353
Total norm for 4 adversaries is: 43.42625472694341. distance: 2.1237037295307353
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1295, Accuracy: 9561/9900 (96.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 43.42769954637967.
Norm before scaling: 43.42590756958555. Distance: 2.0070399122693448
Total norm for 4 adversaries is: 43.42590756958555. distance: 2.0070399122693448
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1379, Accuracy: 9538/9900 (96.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 43.42769954637967.
Norm before scaling: 43.43247357383859. Distance: 2.240793891617315
Total norm for 4 adversaries is: 43.43247357383859. distance: 2.240793891617315
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2122, Accuracy: 9375/9900 (94.6970%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4892/5424 (90.1917%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4896/5424 (90.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1286, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4560/4986 (91.4561%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4577/4986 (91.7970%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9738, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4614/5167 (89.2975%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4695/5167 (90.8651%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2518, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4236/4716 (89.8219%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4263/4716 (90.3944%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1445, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3921/4368 (89.7665%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3867/4368 (88.5302%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0279, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4005/4356 (91.9421%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3840/4356 (88.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1053, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4329/4804 (90.1124%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4335/4804 (90.2373%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0554, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3970/4481 (88.5963%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3903/4481 (87.1011%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1778, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3652/4025 (90.7329%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3719/4025 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9194, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4508/5017 (89.8545%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4569/5017 (91.0704%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0589, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3212/3616 (88.8274%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3317/3616 (91.7312%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8772, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3732/4184 (89.1969%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3786/4184 (90.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8297, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4581/5195 (88.1809%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4615/5195 (88.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0749, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3926/4361 (90.0252%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3968/4361 (90.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0135, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3512/3756 (93.5037%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3572/3756 (95.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8197, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4916/5591 (87.9270%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4882/5591 (87.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0978, Accuracy: 5252/10000 (52.5200%)
time spent on training: 255.25335550308228
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 13.
Validation completed, confusion matrix created.
Validation completed for user 36, confusion matrix appended.
No suspicious behavior detected for client 36.
No suspicious behavior detected for agent 36.
Validation completed, confusion matrix created.
Validation completed for user 58, confusion matrix appended.
No suspicious behavior detected for client 58.
No suspicious behavior detected for agent 58.
Validation completed, confusion matrix created.
Validation completed for user 71, confusion matrix appended.
No suspicious behavior detected for client 71.
No suspicious behavior detected for agent 71.
Validation completed, confusion matrix created.
Validation completed for user 42, confusion matrix appended.
No suspicious behavior detected for client 42.
No suspicious behavior detected for agent 42.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 1.
Validation completed, confusion matrix created.
Validation completed for user 35, confusion matrix appended.
No suspicious behavior detected for client 35.
No suspicious behavior detected for agent 35.
Validation completed, confusion matrix created.
Validation completed for user 28, confusion matrix appended.
No suspicious behavior detected for client 28.
No suspicious behavior detected for agent 28.
Validation completed, confusion matrix created.
Validation completed for user 50, confusion matrix appended.
No suspicious behavior detected for client 50.
No suspicious behavior detected for agent 50.
Validation completed, confusion matrix created.
Validation completed for user 89, confusion matrix appended.
No suspicious behavior detected for client 89.
No suspicious behavior detected for agent 89.
Validation completed, confusion matrix created.
Validation completed for user 94, confusion matrix appended.
No suspicious behavior detected for client 94.
No suspicious behavior detected for agent 94.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7.
Validation completed, confusion matrix created.
Validation completed for user 78, confusion matrix appended.
No suspicious behavior detected for client 78.
No suspicious behavior detected for agent 78.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 0.
Validation completed, confusion matrix created.
Validation completed for user 86, confusion matrix appended.
No suspicious behavior detected for client 86.
No suspicious behavior detected for agent 86.
Validation completed, confusion matrix created.
Validation completed for user 23, confusion matrix appended.
No suspicious behavior detected for client 23.
No suspicious behavior detected for agent 23.
Validation completed, confusion matrix created.
Validation completed for user 54, confusion matrix appended.
No suspicious behavior detected for client 54.
No suspicious behavior detected for agent 54.
Validation completed, confusion matrix created.
Validation completed for user 97, confusion matrix appended.
No suspicious behavior detected for client 97.
No suspicious behavior detected for agent 97.
Validation completed, confusion matrix created.
Validation completed for user 26, confusion matrix appended.
No suspicious behavior detected for client 26.
No suspicious behavior detected for agent 26.
Validation completed, confusion matrix created.
Validation completed for user 32, confusion matrix appended.
No suspicious behavior detected for client 32.
No suspicious behavior detected for agent 32.
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.3137, Accuracy: 6697/10000 (66.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 8.1818, Accuracy: 252/9900 (2.5455%)
Done in 282.278058052063 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
