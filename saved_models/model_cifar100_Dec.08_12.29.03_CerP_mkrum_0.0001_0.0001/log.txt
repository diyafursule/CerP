current path: saved_models/model_cifar100_Dec.08_12.29.03_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4311/4885 (88.2497%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43991185386773. Distance: 2.2932882525020095
Total norm for 4 adversaries is: 42.43991185386773. distance: 2.2932882525020095
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4572, Accuracy: 8792/9900 (88.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435285058177115. Distance: 2.2499916288432056
Total norm for 4 adversaries is: 42.435285058177115. distance: 2.2499916288432056
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7401, Accuracy: 8290/9900 (83.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4178/4717 (88.5732%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438633315132215. Distance: 2.1771242664145594
Total norm for 4 adversaries is: 42.438633315132215. distance: 2.1771242664145594
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4224, Accuracy: 8896/9900 (89.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4456/5066 (87.9589%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44031597339816. Distance: 2.303060079873373
Total norm for 4 adversaries is: 42.44031597339816. distance: 2.303060079873373
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6192, Accuracy: 8472/9900 (85.5758%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3841/4356 (88.1772%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3671/4356 (84.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4570, Accuracy: 4652/10000 (46.5200%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3942/4465 (88.2867%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4106/4465 (91.9597%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9952, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4038/4647 (86.8948%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4161/4647 (89.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9332, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4446/5055 (87.9525%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4510/5055 (89.2186%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1606, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4440/5116 (86.7866%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4440/5116 (86.7866%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9996, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3637/4126 (88.1483%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3756/4126 (91.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9382, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3090/3472 (88.9977%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3223/3472 (92.8283%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0596, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4438/4986 (89.0092%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4432/4986 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1418, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3543/4013 (88.2881%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3686/4013 (91.8515%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8236, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4033/4618 (87.3322%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4081/4618 (88.3716%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0750, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4430/5083 (87.1533%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4456/5083 (87.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0702, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3972/4511 (88.0514%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4027/4511 (89.2707%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2150, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3329/3797 (87.6745%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3397/3797 (89.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9636, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5001/5582 (89.5915%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5059/5582 (90.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1076, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3152/3616 (87.1681%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3182/3616 (87.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0300, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4819/5455 (88.3410%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4849/5455 (88.8909%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9808, Accuracy: 5298/10000 (52.9800%)
time spent on training: 257.055367231369
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1049, Accuracy: 7056/10000 (70.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0740, Accuracy: 116/9900 (1.1717%)
Done in 284.299786567688 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 42.45476395437708.
Norm before scaling: 42.460616230385334. Distance: 2.1086124878680104
Total norm for 4 adversaries is: 42.460616230385334. distance: 2.1086124878680104
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2670, Accuracy: 9214/9900 (93.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 42.45476395437708.
Norm before scaling: 42.458047423493525. Distance: 2.1645863033368538
Total norm for 4 adversaries is: 42.458047423493525. distance: 2.1645863033368538
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5824, Accuracy: 8492/9900 (85.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4189/4717 (88.8064%), train_poison_data_count: 370
Global model norm: 42.45476395437708.
Norm before scaling: 42.462047909813684. Distance: 2.1640888308909734
Total norm for 4 adversaries is: 42.462047909813684. distance: 2.1640888308909734
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2405, Accuracy: 9314/9900 (94.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 42.45476395437708.
Norm before scaling: 42.46464953300495. Distance: 2.289818544486616
Total norm for 4 adversaries is: 42.46464953300495. distance: 2.289818544486616
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2754, Accuracy: 9155/9900 (92.4747%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3605/4025 (89.5652%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3723/4025 (92.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0078, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3349/3797 (88.2012%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3407/3797 (89.7287%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0120, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3945/4625 (85.2973%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4023/4625 (86.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0939, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3866/4481 (86.2754%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3855/4481 (86.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2528, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3860/4315 (89.4554%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3977/4315 (92.1669%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0201, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3698/4235 (87.3200%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3824/4235 (90.2952%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0172, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3367/3828 (87.9572%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3471/3828 (90.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9502, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3832/4416 (86.7754%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3972/4416 (89.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9239, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3145/3638 (86.4486%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3280/3638 (90.1594%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9763, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4555/5265 (86.5147%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4520/5265 (85.8500%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0578, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3358/3781 (88.8125%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3306/3781 (87.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1870, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3987/4441 (89.7771%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4009/4441 (90.2725%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1251, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3975/4433 (89.6684%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4023/4433 (90.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0256, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4429/5083 (87.1336%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4443/5083 (87.4090%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1046, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4321/4928 (87.6826%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4401/4928 (89.3060%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0225, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4174/4793 (87.0853%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4362/4793 (91.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0979, Accuracy: 5347/10000 (53.4700%)
time spent on training: 253.57991409301758
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0963, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.1030, Accuracy: 218/9900 (2.2020%)
Done in 280.9109261035919 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4454/4885 (91.1771%), train_poison_data_count: 385
Global model norm: 42.477350639874096.
Norm before scaling: 42.47785929485427. Distance: 2.0179450116033233
Total norm for 4 adversaries is: 42.47785929485427. distance: 2.0179450116033233
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2386, Accuracy: 9256/9900 (93.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.477350639874096.
Norm before scaling: 42.47867542910134. Distance: 2.0963256707633984
Total norm for 4 adversaries is: 42.47867542910134. distance: 2.0963256707633984
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0848, Accuracy: 9666/9900 (97.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 42.477350639874096.
Norm before scaling: 42.47890963374501. Distance: 1.987737315182902
Total norm for 4 adversaries is: 42.47890963374501. distance: 1.987737315182902
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2216, Accuracy: 9330/9900 (94.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 42.477350639874096.
Norm before scaling: 42.48360351221177. Distance: 2.1632230487018806
Total norm for 4 adversaries is: 42.48360351221177. distance: 2.1632230487018806
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1548, Accuracy: 9505/9900 (96.0101%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3160/3616 (87.3894%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3294/3616 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8498, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3413/3837 (88.9497%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3501/3837 (91.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9238, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4172/4679 (89.1644%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4275/4679 (91.3657%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0508, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3101/3638 (85.2391%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3267/3638 (89.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0499, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3622/4046 (89.5205%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3622/4046 (89.5205%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0217, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3980/4518 (88.0921%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4099/4518 (90.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1601, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3384/3797 (89.1230%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3417/3797 (89.9921%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1175, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4437/5025 (88.2985%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4438/5025 (88.3184%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3931, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3921/4362 (89.8900%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3961/4362 (90.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0015, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3990/4558 (87.5384%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4020/4558 (88.1966%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1938, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3212/3672 (87.4728%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3278/3672 (89.2702%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0551, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4325/4874 (88.7362%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4310/4874 (88.4284%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2404, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3620/4025 (89.9379%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3708/4025 (92.1242%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9384, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4095/4663 (87.8190%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4221/4663 (90.5211%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1191, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3462/3911 (88.5196%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3432/3911 (87.7525%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0596, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4445/5017 (88.5988%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4552/5017 (90.7315%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8454, Accuracy: 5698/10000 (56.9800%)
time spent on training: 254.23258113861084
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0910, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.1009, Accuracy: 425/9900 (4.2929%)
Done in 281.4418714046478 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 42.497766772667745.
Norm before scaling: 42.49993537449131. Distance: 1.971759796404574
Total norm for 4 adversaries is: 42.49993537449131. distance: 1.971759796404574
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5332, Accuracy: 8680/9900 (87.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4831/5305 (91.0650%), train_poison_data_count: 415
Global model norm: 42.497766772667745.
Norm before scaling: 42.495829299032394. Distance: 2.0200035384118844
Total norm for 4 adversaries is: 42.495829299032394. distance: 2.0200035384118844
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0825, Accuracy: 9676/9900 (97.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 42.497766772667745.
Norm before scaling: 42.499181402962044. Distance: 1.9557039857776464
Total norm for 4 adversaries is: 42.499181402962044. distance: 1.9557039857776464
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1411, Accuracy: 9533/9900 (96.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 42.497766772667745.
Norm before scaling: 42.50373949541087. Distance: 2.119547074536911
Total norm for 4 adversaries is: 42.50373949541087. distance: 2.119547074536911
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3406, Accuracy: 9045/9900 (91.3636%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5273/6124 (86.1039%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5318/6124 (86.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2328, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3877/4356 (89.0037%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3640/4356 (83.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4758, Accuracy: 4809/10000 (48.0900%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3537/4158 (85.0649%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3563/4158 (85.6902%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1800, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4887/5455 (89.5875%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4908/5455 (89.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9454, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3931/4511 (87.1425%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4064/4511 (90.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9771, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4529/5232 (86.5635%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4548/5232 (86.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1598, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4497/5244 (85.7551%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4548/5244 (86.7277%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0857, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4377/4918 (88.9996%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4421/4918 (89.8943%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0046, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3620/4126 (87.7363%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3726/4126 (90.3054%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8500, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4350/4928 (88.2711%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4381/4928 (88.9002%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2032, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3734/4223 (88.4206%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3823/4223 (90.5281%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9513, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4522/5195 (87.0452%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4605/5195 (88.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3108, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4163/4679 (88.9720%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4131/4679 (88.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0372, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3210/3646 (88.0417%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3276/3646 (89.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8875, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3194/3616 (88.3296%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3198/3616 (88.4403%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9319, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4075/4716 (86.4080%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4094/4716 (86.8109%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0130, Accuracy: 5369/10000 (53.6900%)
time spent on training: 261.28316855430603
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0886, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.4404, Accuracy: 688/9900 (6.9495%)
Done in 288.5860664844513 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4474/4885 (91.5865%), train_poison_data_count: 385
Global model norm: 42.522795185071764.
Norm before scaling: 42.5256270392116. Distance: 1.960031185972494
Total norm for 4 adversaries is: 42.5256270392116. distance: 1.960031185972494
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1747, Accuracy: 9472/9900 (95.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4869/5305 (91.7813%), train_poison_data_count: 415
Global model norm: 42.522795185071764.
Norm before scaling: 42.51780991721293. Distance: 1.984077911965995
Total norm for 4 adversaries is: 42.51780991721293. distance: 1.984077911965995
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1404, Accuracy: 9543/9900 (96.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 42.522795185071764.
Norm before scaling: 42.52364777529307. Distance: 1.921822523935829
Total norm for 4 adversaries is: 42.52364777529307. distance: 1.921822523935829
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1976, Accuracy: 9384/9900 (94.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4558/5066 (89.9724%), train_poison_data_count: 400
Global model norm: 42.522795185071764.
Norm before scaling: 42.53027557893685. Distance: 2.081612321171225
Total norm for 4 adversaries is: 42.53027557893685. distance: 2.081612321171225
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2692, Accuracy: 9225/9900 (93.1818%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5285/6124 (86.2998%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5356/6124 (87.4592%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9995, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3965/4433 (89.4428%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4037/4433 (91.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9087, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3391/3781 (89.6853%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3232/3781 (85.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3027, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3571/3969 (89.9723%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3578/3969 (90.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9934, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4467/5025 (88.8955%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4515/5025 (89.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2072, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4185/4679 (89.4422%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4266/4679 (91.1733%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9729, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4159/4707 (88.3578%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4232/4707 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0096, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4442/4986 (89.0895%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4477/4986 (89.7914%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8999, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3905/4315 (90.4983%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3951/4315 (91.5643%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8824, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3862/4416 (87.4547%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3932/4416 (89.0399%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9351, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4252/4804 (88.5096%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4116/4804 (85.6786%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1539, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4180/4793 (87.2105%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4273/4793 (89.1508%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0716, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4541/5232 (86.7928%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4577/5232 (87.4809%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0592, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4108/4662 (88.1167%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4219/4662 (90.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0756, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4250/4956 (85.7546%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4327/4956 (87.3083%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1814, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3834/4368 (87.7747%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3835/4368 (87.7976%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9697, Accuracy: 5446/10000 (54.4600%)
time spent on training: 263.25511860847473
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0871, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7792, Accuracy: 1049/9900 (10.5960%)
Done in 290.5313866138458 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4462/4885 (91.3408%), train_poison_data_count: 385
Global model norm: 42.54701558460064.
Norm before scaling: 42.54722215704863. Distance: 1.9231674066677642
Total norm for 4 adversaries is: 42.54722215704863. distance: 1.9231674066677642
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2919, Accuracy: 9170/9900 (92.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 42.54701558460064.
Norm before scaling: 42.54386379584825. Distance: 1.9555105060869664
Total norm for 4 adversaries is: 42.54386379584825. distance: 1.9555105060869664
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2182, Accuracy: 9352/9900 (94.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4317/4717 (91.5200%), train_poison_data_count: 370
Global model norm: 42.54701558460064.
Norm before scaling: 42.547027060874065. Distance: 1.8660818361733937
Total norm for 4 adversaries is: 42.547027060874065. distance: 1.8660818361733937
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2381, Accuracy: 9298/9900 (93.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 42.54701558460064.
Norm before scaling: 42.551611584492306. Distance: 2.0179431212153145
Total norm for 4 adversaries is: 42.551611584492306. distance: 2.0179431212153145
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1114, Accuracy: 9610/9900 (97.0707%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5368/6124 (87.6551%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5355/6124 (87.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1485, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5144/5902 (87.1569%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5132/5902 (86.9536%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1720, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4177/4707 (88.7402%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4237/4707 (90.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9715, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4099/4647 (88.2074%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4154/4647 (89.3910%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8648, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2982/3297 (90.4459%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3026/3297 (91.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7721, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5569/6263 (88.9190%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5650/6263 (90.2124%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2165, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4173/4663 (89.4917%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4250/4663 (91.1430%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0946, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4333/4956 (87.4294%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4347/4956 (87.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2741, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3621/4046 (89.4958%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3708/4046 (91.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8935, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3725/4184 (89.0296%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3759/4184 (89.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8474, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4860/5591 (86.9254%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4871/5591 (87.1222%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1452, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4088/4634 (88.2175%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4183/4634 (90.2676%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9657, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3395/3828 (88.6886%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3501/3828 (91.4577%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9469, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3152/3638 (86.6410%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3260/3638 (89.6097%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8917, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3400/3781 (89.9233%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3374/3781 (89.2357%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2857, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3425/3837 (89.2624%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3536/3837 (92.1553%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8860, Accuracy: 5706/10000 (57.0600%)
time spent on training: 262.47818064689636
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0836, Accuracy: 7088/10000 (70.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.2452, Accuracy: 1387/9900 (14.0101%)
Done in 289.64046597480774 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4481/4885 (91.7298%), train_poison_data_count: 385
Global model norm: 42.570486700184965.
Norm before scaling: 42.568642866184376. Distance: 1.853425259894637
Total norm for 4 adversaries is: 42.568642866184376. distance: 1.853425259894637
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2778, Accuracy: 9228/9900 (93.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4877/5305 (91.9321%), train_poison_data_count: 415
Global model norm: 42.570486700184965.
Norm before scaling: 42.568113788649804. Distance: 1.9428553862223177
Total norm for 4 adversaries is: 42.568113788649804. distance: 1.9428553862223177
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1506, Accuracy: 9549/9900 (96.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 42.570486700184965.
Norm before scaling: 42.5723519595428. Distance: 1.8867239942142116
Total norm for 4 adversaries is: 42.5723519595428. distance: 1.8867239942142116
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1438, Accuracy: 9527/9900 (96.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4623/5066 (91.2554%), train_poison_data_count: 400
Global model norm: 42.570486700184965.
Norm before scaling: 42.57249819471559. Distance: 1.9527947718877323
Total norm for 4 adversaries is: 42.57249819471559. distance: 1.9527947718877323
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2325, Accuracy: 9341/9900 (94.3535%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3913/4501 (86.9362%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3967/4501 (88.1360%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1986, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3705/4175 (88.7425%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3725/4175 (89.2216%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9706, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3175/3616 (87.8042%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3234/3616 (89.4358%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9304, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4061/4634 (87.6349%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4089/4634 (88.2391%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9028, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4017/4558 (88.1308%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3986/4558 (87.4506%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1511, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4565/5167 (88.3491%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4613/5167 (89.2781%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1451, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3895/4356 (89.4169%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3868/4356 (88.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2457, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4150/4716 (87.9983%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4177/4716 (88.5708%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0631, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5391/6124 (88.0307%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5326/6124 (86.9693%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9919, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4463/5055 (88.2888%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4567/5055 (90.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9816, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4527/5025 (90.0896%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4580/5025 (91.1443%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0444, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4381/4918 (89.0809%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4377/4918 (88.9996%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2066, Accuracy: 4994/10000 (49.9400%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3768/4223 (89.2257%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3847/4223 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9349, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3932/4481 (87.7483%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3864/4481 (86.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1466, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3207/3638 (88.1528%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3283/3638 (90.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9620, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3582/4013 (89.2599%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3671/4013 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9308, Accuracy: 5530/10000 (55.3000%)
time spent on training: 260.02261090278625
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0847, Accuracy: 7075/10000 (70.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.7145, Accuracy: 1881/9900 (19.0000%)
Done in 287.0353901386261 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4505/4885 (92.2211%), train_poison_data_count: 385
Global model norm: 42.59376576256128.
Norm before scaling: 42.59141421053221. Distance: 1.8345236670900502
Total norm for 4 adversaries is: 42.59141421053221. distance: 1.8345236670900502
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2363, Accuracy: 9305/9900 (93.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4858/5305 (91.5740%), train_poison_data_count: 415
Global model norm: 42.59376576256128.
Norm before scaling: 42.59075357444456. Distance: 1.923822362281185
Total norm for 4 adversaries is: 42.59075357444456. distance: 1.923822362281185
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2351, Accuracy: 9337/9900 (94.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4329/4717 (91.7744%), train_poison_data_count: 370
Global model norm: 42.59376576256128.
Norm before scaling: 42.59266953416838. Distance: 1.784712387763741
Total norm for 4 adversaries is: 42.59266953416838. distance: 1.784712387763741
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4232, Accuracy: 8870/9900 (89.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4609/5066 (90.9791%), train_poison_data_count: 400
Global model norm: 42.59376576256128.
Norm before scaling: 42.594837603043956. Distance: 1.954903609102026
Total norm for 4 adversaries is: 42.594837603043956. distance: 1.954903609102026
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1395, Accuracy: 9549/9900 (96.4545%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3211/3646 (88.0691%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3316/3646 (90.9490%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8173, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3946/4501 (87.6694%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4019/4501 (89.2913%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9595, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4109/4651 (88.3466%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4179/4651 (89.8516%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9429, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4593/5167 (88.8910%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4668/5167 (90.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0062, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4911/5455 (90.0275%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4881/5455 (89.4775%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1680, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4905/5591 (87.7303%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4868/5591 (87.0685%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2070, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4224/4679 (90.2757%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4142/4679 (88.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1250, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4478/5017 (89.2565%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4519/5017 (90.0737%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8870, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4267/4793 (89.0257%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4317/4793 (90.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0701, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4035/4456 (90.5521%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4077/4456 (91.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8966, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4828/5424 (89.0118%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4924/5424 (90.7817%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2017, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3689/4175 (88.3593%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3665/4175 (87.7844%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0888, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4557/5116 (89.0735%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4543/5116 (88.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9906, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3306/3704 (89.2549%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3353/3704 (90.5238%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8950, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4527/5232 (86.5252%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4631/5232 (88.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2003, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3108/3472 (89.5161%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3166/3472 (91.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0432, Accuracy: 5516/10000 (55.1600%)
time spent on training: 259.967444896698
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0856, Accuracy: 7079/10000 (70.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.2281, Accuracy: 2433/9900 (24.5758%)
Done in 287.1561930179596 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4509/4885 (92.3030%), train_poison_data_count: 385
Global model norm: 42.617583493806436.
Norm before scaling: 42.61552829606979. Distance: 1.8062808446659475
Total norm for 4 adversaries is: 42.61552829606979. distance: 1.8062808446659475
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2018, Accuracy: 9398/9900 (94.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4880/5305 (91.9887%), train_poison_data_count: 415
Global model norm: 42.617583493806436.
Norm before scaling: 42.61144338580747. Distance: 1.881534633458629
Total norm for 4 adversaries is: 42.61144338580747. distance: 1.881534633458629
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1951, Accuracy: 9443/9900 (95.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4324/4717 (91.6684%), train_poison_data_count: 370
Global model norm: 42.617583493806436.
Norm before scaling: 42.61454434401989. Distance: 1.788249601564879
Total norm for 4 adversaries is: 42.61454434401989. distance: 1.788249601564879
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1480, Accuracy: 9536/9900 (96.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4646/5066 (91.7094%), train_poison_data_count: 400
Global model norm: 42.617583493806436.
Norm before scaling: 42.618777897684815. Distance: 1.9195859970340363
Total norm for 4 adversaries is: 42.618777897684815. distance: 1.9195859970340363
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3715, Accuracy: 8978/9900 (90.6869%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3239/3590 (90.2228%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3352/3590 (93.3705%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9729, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3869/4368 (88.5760%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3843/4368 (87.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8262, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3303/3704 (89.1739%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3377/3704 (91.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8835, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4363/4928 (88.5349%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4390/4928 (89.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0890, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3925/4356 (90.1056%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3882/4356 (89.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1219, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3504/3911 (89.5935%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3354/3911 (85.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1907, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4154/4651 (89.3141%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4192/4651 (90.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1123, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3747/4184 (89.5554%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3767/4184 (90.0335%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0057, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3935/4346 (90.5430%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3980/4346 (91.5785%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8609, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4226/4793 (88.1702%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4361/4793 (90.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0379, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3435/3804 (90.2997%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3492/3804 (91.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8916, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4492/4986 (90.0923%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4463/4986 (89.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9301, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5370/6124 (87.6878%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5251/6124 (85.7446%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1682, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4197/4707 (89.1651%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4245/4707 (90.1848%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8969, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3827/4235 (90.3660%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3701/4235 (87.3908%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1649, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3655/4046 (90.3361%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3700/4046 (91.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0231, Accuracy: 5309/10000 (53.0900%)
time spent on training: 250.24085116386414
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0894, Accuracy: 7061/10000 (70.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.7920, Accuracy: 2968/9900 (29.9798%)
Done in 277.3135106563568 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4557/4885 (93.2856%), train_poison_data_count: 385
Global model norm: 42.63986922195734.
Norm before scaling: 42.634170395957774. Distance: 1.770961898923739
Total norm for 4 adversaries is: 42.634170395957774. distance: 1.770961898923739
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0699, Accuracy: 9719/9900 (98.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4896/5305 (92.2903%), train_poison_data_count: 415
Global model norm: 42.63986922195734.
Norm before scaling: 42.63545738657555. Distance: 1.8429382606303222
Total norm for 4 adversaries is: 42.63545738657555. distance: 1.8429382606303222
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1018, Accuracy: 9655/9900 (97.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4346/4717 (92.1348%), train_poison_data_count: 370
Global model norm: 42.63986922195734.
Norm before scaling: 42.637053544551335. Distance: 1.7516379184462945
Total norm for 4 adversaries is: 42.637053544551335. distance: 1.7516379184462945
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3408, Accuracy: 9111/9900 (92.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4621/5066 (91.2159%), train_poison_data_count: 400
Global model norm: 42.63986922195734.
Norm before scaling: 42.641366451047276. Distance: 1.9405378091731598
Total norm for 4 adversaries is: 42.641366451047276. distance: 1.9405378091731598
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1692, Accuracy: 9468/9900 (95.6364%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4455/4986 (89.3502%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4524/4986 (90.7341%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9981, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4083/4634 (88.1096%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4116/4634 (88.8218%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8687, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4162/4716 (88.2528%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4187/4716 (88.7829%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1114, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5384/6124 (87.9164%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5406/6124 (88.2756%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0516, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4406/4918 (89.5893%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4500/4918 (91.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9688, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3407/3797 (89.7287%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3436/3797 (90.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0298, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5013/5582 (89.8065%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5041/5582 (90.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1232, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4350/4956 (87.7724%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4334/4956 (87.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1177, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4018/4433 (90.6384%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4023/4433 (90.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8496, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3884/4354 (89.2053%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0121, Accuracy: 3367/4354 (77.3312%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4640, Accuracy: 4618/10000 (46.1800%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4349/4928 (88.2508%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4412/4928 (89.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8771, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3502/3911 (89.5423%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3474/3911 (88.8264%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9184, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3861/4481 (86.1638%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3814/4481 (85.1149%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0654, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4602/5197 (88.5511%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4602/5197 (88.5511%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0063, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4860/5455 (89.0926%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4894/5455 (89.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0041, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3838/4361 (88.0073%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3765/4361 (86.3334%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2675, Accuracy: 4900/10000 (49.0000%)
time spent on training: 263.3192982673645
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.0961, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.3943, Accuracy: 3509/9900 (35.4444%)
Done in 290.52964782714844 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4533/4885 (92.7943%), train_poison_data_count: 385
Global model norm: 42.665462317953235.
Norm before scaling: 42.66488007937559. Distance: 1.7733455415654444
Total norm for 4 adversaries is: 42.66488007937559. distance: 1.7733455415654444
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1659, Accuracy: 9499/9900 (95.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4909/5305 (92.5353%), train_poison_data_count: 415
Global model norm: 42.665462317953235.
Norm before scaling: 42.65871387114976. Distance: 1.8332299579027849
Total norm for 4 adversaries is: 42.65871387114976. distance: 1.8332299579027849
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1419, Accuracy: 9521/9900 (96.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4363/4717 (92.4952%), train_poison_data_count: 370
Global model norm: 42.665462317953235.
Norm before scaling: 42.65948791511318. Distance: 1.7083538876049071
Total norm for 4 adversaries is: 42.65948791511318. distance: 1.7083538876049071
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0739, Accuracy: 9703/9900 (98.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4623/5066 (91.2554%), train_poison_data_count: 400
Global model norm: 42.665462317953235.
Norm before scaling: 42.66815453160369. Distance: 1.9101930080379714
Total norm for 4 adversaries is: 42.66815453160369. distance: 1.9101930080379714
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1731, Accuracy: 9468/9900 (95.6364%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4352/4928 (88.3117%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4375/4928 (88.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9904, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3786/4184 (90.4876%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3831/4184 (91.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8604, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4260/4707 (90.5035%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4248/4707 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0319, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3443/3828 (89.9425%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3547/3828 (92.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9519, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4028/4503 (89.4515%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4017/4503 (89.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9812, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4215/4662 (90.4118%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4240/4662 (90.9481%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9052, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3785/4235 (89.3743%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3808/4235 (89.9174%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0926, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4471/5244 (85.2593%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4521/5244 (86.2128%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0068, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4262/4793 (88.9213%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4356/4793 (90.8825%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9854, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3985/4481 (88.9310%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3888/4481 (86.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2749, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3965/4346 (91.2333%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4029/4346 (92.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7262, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3847/4361 (88.2137%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3670/4361 (84.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2566, Accuracy: 5001/10000 (50.0100%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4550/5055 (90.0099%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4540/5055 (89.8121%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9736, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4585/5195 (88.2579%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4547/5195 (87.5265%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0923, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3930/4315 (91.0776%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3993/4315 (92.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9986, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4226/4663 (90.6284%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4272/4663 (91.6148%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0292, Accuracy: 5430/10000 (54.3000%)
time spent on training: 260.48517632484436
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1010, Accuracy: 7042/10000 (70.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.9921, Accuracy: 4052/9900 (40.9293%)
Done in 287.59151101112366 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4546/4885 (93.0604%), train_poison_data_count: 385
Global model norm: 42.688864020118.
Norm before scaling: 42.685209377597936. Distance: 1.7020890471208059
Total norm for 4 adversaries is: 42.685209377597936. distance: 1.7020890471208059
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1782, Accuracy: 9484/9900 (95.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4919/5305 (92.7238%), train_poison_data_count: 415
Global model norm: 42.688864020118.
Norm before scaling: 42.68395105580522. Distance: 1.8143347957202671
Total norm for 4 adversaries is: 42.68395105580522. distance: 1.8143347957202671
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2223, Accuracy: 9353/9900 (94.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4376/4717 (92.7708%), train_poison_data_count: 370
Global model norm: 42.688864020118.
Norm before scaling: 42.68326325287305. Distance: 1.6743523612490776
Total norm for 4 adversaries is: 42.68326325287305. distance: 1.6743523612490776
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1787, Accuracy: 9469/9900 (95.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4674/5066 (92.2621%), train_poison_data_count: 400
Global model norm: 42.688864020118.
Norm before scaling: 42.68900270735354. Distance: 1.8434616121951677
Total norm for 4 adversaries is: 42.68900270735354. distance: 1.8434616121951677
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1517, Accuracy: 9508/9900 (96.0404%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3982/4315 (92.2827%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3975/4315 (92.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8989, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3277/3590 (91.2813%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3205/3590 (89.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1414, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4208/4679 (89.9337%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4255/4679 (90.9382%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0423, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4631/5167 (89.6265%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4658/5167 (90.1490%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0648, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3395/3775 (89.9338%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3524/3775 (93.3510%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8680, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3451/3828 (90.1515%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3488/3828 (91.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9118, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3811/4235 (89.9882%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3881/4235 (91.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9373, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4154/4647 (89.3910%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4211/4647 (90.6176%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9234, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4418/4918 (89.8333%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4467/4918 (90.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0528, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4020/4433 (90.6835%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3998/4433 (90.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9772, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3988/4481 (88.9980%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3900/4481 (87.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1162, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3830/4295 (89.1735%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3699/4295 (86.1234%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1474, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4019/4503 (89.2516%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4041/4503 (89.7402%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9003, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3857/4354 (88.5852%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3600/4354 (82.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.5362, Accuracy: 4650/10000 (46.5000%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4491/4986 (90.0722%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4423/4986 (88.7084%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0751, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5589/6263 (89.2384%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5701/6263 (91.0267%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0848, Accuracy: 5326/10000 (53.2600%)
time spent on training: 257.3497636318207
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1131, Accuracy: 7014/10000 (70.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.6764, Accuracy: 4569/9900 (46.1515%)
Done in 284.60873103141785 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4539/4885 (92.9171%), train_poison_data_count: 385
Global model norm: 42.71190422698703.
Norm before scaling: 42.707212574217195. Distance: 1.7362779367614773
Total norm for 4 adversaries is: 42.707212574217195. distance: 1.7362779367614773
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1559, Accuracy: 9518/9900 (96.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4905/5305 (92.4599%), train_poison_data_count: 415
Global model norm: 42.71190422698703.
Norm before scaling: 42.70756843192068. Distance: 1.8742724596590803
Total norm for 4 adversaries is: 42.70756843192068. distance: 1.8742724596590803
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0830, Accuracy: 9678/9900 (97.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4384/4717 (92.9404%), train_poison_data_count: 370
Global model norm: 42.71190422698703.
Norm before scaling: 42.70410548179179. Distance: 1.6513708690960958
Total norm for 4 adversaries is: 42.70410548179179. distance: 1.6513708690960958
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1633, Accuracy: 9511/9900 (96.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4688/5066 (92.5385%), train_poison_data_count: 400
Global model norm: 42.71190422698703.
Norm before scaling: 42.710140809059475. Distance: 1.8257793147379224
Total norm for 4 adversaries is: 42.710140809059475. distance: 1.8257793147379224
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0626, Accuracy: 9747/9900 (98.4545%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3764/4223 (89.1309%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3851/4223 (91.1911%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9475, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4944/5455 (90.6324%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4853/5455 (88.9643%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1810, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5092/5582 (91.2218%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5081/5582 (91.0247%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3096, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4029/4465 (90.2352%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4091/4465 (91.6237%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8462, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4973/5591 (88.9465%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4958/5591 (88.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1097, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3544/3911 (90.6162%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3408/3911 (87.1388%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9364, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3919/4356 (89.9679%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0146, Accuracy: 3277/4356 (75.2296%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.7125, Accuracy: 4444/10000 (44.4400%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4484/5037 (89.0212%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4523/5037 (89.7955%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9248, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4241/4679 (90.6390%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4217/4679 (90.1261%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2476, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3999/4362 (91.6781%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3923/4362 (89.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0363, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4126/4518 (91.3236%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4182/4518 (92.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9087, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4525/5083 (89.0222%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4528/5083 (89.0813%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1402, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3604/4013 (89.8081%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3714/4013 (92.5492%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7550, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4626/5197 (89.0129%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4668/5197 (89.8211%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0936, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2981/3297 (90.4155%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3061/3297 (92.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7795, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4032/4441 (90.7904%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4033/4441 (90.8129%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1152, Accuracy: 5428/10000 (54.2800%)
time spent on training: 260.9715461730957
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1145, Accuracy: 7018/10000 (70.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.4039, Accuracy: 5002/9900 (50.5253%)
Done in 288.3172218799591 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4547/4885 (93.0809%), train_poison_data_count: 385
Global model norm: 42.734877739273166.
Norm before scaling: 42.729737236916606. Distance: 1.722535767093922
Total norm for 4 adversaries is: 42.729737236916606. distance: 1.722535767093922
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0911, Accuracy: 9681/9900 (97.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4918/5305 (92.7050%), train_poison_data_count: 415
Global model norm: 42.734877739273166.
Norm before scaling: 42.726663209563156. Distance: 1.7450951231686083
Total norm for 4 adversaries is: 42.726663209563156. distance: 1.7450951231686083
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2972, Accuracy: 9226/9900 (93.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4403/4717 (93.3432%), train_poison_data_count: 370
Global model norm: 42.734877739273166.
Norm before scaling: 42.728040264031385. Distance: 1.6568457053986054
Total norm for 4 adversaries is: 42.728040264031385. distance: 1.6568457053986054
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2933, Accuracy: 9160/9900 (92.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4665/5066 (92.0845%), train_poison_data_count: 400
Global model norm: 42.734877739273166.
Norm before scaling: 42.73367658250121. Distance: 1.8329536377141795
Total norm for 4 adversaries is: 42.73367658250121. distance: 1.8329536377141795
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1807, Accuracy: 9441/9900 (95.3636%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4058/4501 (90.1577%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4032/4501 (89.5801%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9974, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4033/4511 (89.4037%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4077/4511 (90.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9708, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3913/4354 (89.8714%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0108, Accuracy: 3473/4354 (79.7657%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5423, Accuracy: 4554/10000 (45.5400%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3969/4346 (91.3254%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4028/4346 (92.6829%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8471, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4245/4707 (90.1848%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4249/4707 (90.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9868, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4952/5591 (88.5709%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4935/5591 (88.2669%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0748, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4140/4647 (89.0897%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4200/4647 (90.3809%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8402, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4116/4538 (90.7007%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4195/4538 (92.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8806, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4376/4934 (88.6907%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4352/4934 (88.2043%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1278, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4327/4804 (90.0708%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4246/4804 (88.3847%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0218, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5700/6263 (91.0107%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5666/6263 (90.4678%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2860, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3962/4481 (88.4178%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3934/4481 (87.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9928, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4443/5063 (87.7543%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4460/5063 (88.0901%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9757, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3751/4223 (88.8231%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3875/4223 (91.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9322, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4067/4441 (91.5785%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4129/4441 (92.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0472, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3410/3756 (90.7881%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3498/3756 (93.1310%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8629, Accuracy: 5671/10000 (56.7100%)
time spent on training: 262.3889799118042
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1187, Accuracy: 7012/10000 (70.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.1769, Accuracy: 5383/9900 (54.3737%)
Done in 289.72238183021545 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4583/4885 (93.8178%), train_poison_data_count: 385
Global model norm: 42.75827428149141.
Norm before scaling: 42.75112645856905. Distance: 1.6708439294696282
Total norm for 4 adversaries is: 42.75112645856905. distance: 1.6708439294696282
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1272, Accuracy: 9586/9900 (96.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4928/5305 (92.8935%), train_poison_data_count: 415
Global model norm: 42.75827428149141.
Norm before scaling: 42.75491393998618. Distance: 1.8452829356978593
Total norm for 4 adversaries is: 42.75491393998618. distance: 1.8452829356978593
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0649, Accuracy: 9733/9900 (98.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4392/4717 (93.1100%), train_poison_data_count: 370
Global model norm: 42.75827428149141.
Norm before scaling: 42.751704667219116. Distance: 1.6217586762272793
Total norm for 4 adversaries is: 42.751704667219116. distance: 1.6217586762272793
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2100, Accuracy: 9385/9900 (94.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4716/5066 (93.0912%), train_poison_data_count: 400
Global model norm: 42.75827428149141.
Norm before scaling: 42.75283964664292. Distance: 1.7602595272318367
Total norm for 4 adversaries is: 42.75283964664292. distance: 1.7602595272318367
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1889, Accuracy: 9422/9900 (95.1717%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4496/5244 (85.7361%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4593/5244 (87.5858%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0220, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4420/4928 (89.6916%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4405/4928 (89.3872%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9040, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3432/3804 (90.2208%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3493/3804 (91.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9141, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3651/4013 (90.9793%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3675/4013 (91.5774%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8442, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3654/4158 (87.8788%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3632/4158 (87.3497%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8696, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5095/5582 (91.2755%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5034/5582 (90.1827%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9933, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4909/5455 (89.9908%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4956/5455 (90.8524%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9865, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3907/4354 (89.7336%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3490/4354 (80.1562%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.6548, Accuracy: 4599/10000 (45.9900%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4032/4433 (90.9542%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4064/4433 (91.6761%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0741, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3248/3646 (89.0839%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3334/3646 (91.4427%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8368, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4085/4518 (90.4161%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4084/4518 (90.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9908, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3869/4235 (91.3577%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3765/4235 (88.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1922, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4010/4362 (91.9303%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3907/4362 (89.5690%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1298, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4849/5392 (89.9295%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4786/5392 (88.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2304, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4933/5591 (88.2311%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4908/5591 (87.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2711, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3410/3756 (90.7881%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3490/3756 (92.9180%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9596, Accuracy: 5654/10000 (56.5400%)
time spent on training: 261.0619282722473
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1263, Accuracy: 6984/10000 (69.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.9206, Accuracy: 5838/9900 (58.9697%)
Done in 288.134281873703 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4558/4885 (93.3060%), train_poison_data_count: 385
Global model norm: 42.7815595884525.
Norm before scaling: 42.77364511935913. Distance: 1.6813990190114934
Total norm for 4 adversaries is: 42.77364511935913. distance: 1.6813990190114934
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0847, Accuracy: 9676/9900 (97.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4942/5305 (93.1574%), train_poison_data_count: 415
Global model norm: 42.7815595884525.
Norm before scaling: 42.77321132931072. Distance: 1.7817436337357944
Total norm for 4 adversaries is: 42.77321132931072. distance: 1.7817436337357944
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0228, Accuracy: 9838/9900 (99.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4392/4717 (93.1100%), train_poison_data_count: 370
Global model norm: 42.7815595884525.
Norm before scaling: 42.77409888187301. Distance: 1.6382322028462586
Total norm for 4 adversaries is: 42.77409888187301. distance: 1.6382322028462586
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1209, Accuracy: 9608/9900 (97.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4693/5066 (92.6372%), train_poison_data_count: 400
Global model norm: 42.7815595884525.
Norm before scaling: 42.77702111129584. Distance: 1.8021524302148046
Total norm for 4 adversaries is: 42.77702111129584. distance: 1.8021524302148046
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1366, Accuracy: 9560/9900 (96.5657%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4219/4634 (91.0445%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4186/4634 (90.3323%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0706, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4091/4503 (90.8505%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4065/4503 (90.2732%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9032, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4394/4928 (89.1640%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4505/4928 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8431, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3419/3804 (89.8791%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3454/3804 (90.7992%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9682, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3281/3590 (91.3928%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3095/3590 (86.2117%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.4026, Accuracy: 4934/10000 (49.3400%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4182/4647 (89.9935%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4274/4647 (91.9733%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8274, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4039/4625 (87.3297%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4034/4625 (87.2216%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0684, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3955/4356 (90.7943%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3906/4356 (89.6694%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0997, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3459/3797 (91.0982%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3517/3797 (92.6258%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9705, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4065/4456 (91.2253%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4077/4456 (91.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9072, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3640/4025 (90.4348%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3726/4025 (92.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8851, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3175/3472 (91.4459%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3164/3472 (91.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0224, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2958/3297 (89.7179%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3018/3297 (91.5378%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8772, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3924/4416 (88.8587%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3978/4416 (90.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0882, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3969/4356 (91.1157%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4038/4356 (92.6997%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0827, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3230/3638 (88.7850%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3345/3638 (91.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8354, Accuracy: 5697/10000 (56.9700%)
time spent on training: 252.7498848438263
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1335, Accuracy: 6994/10000 (69.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.7138, Accuracy: 6241/9900 (63.0404%)
Done in 280.1256308555603 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4558/4885 (93.3060%), train_poison_data_count: 385
Global model norm: 42.80169086859697.
Norm before scaling: 42.79554294659375. Distance: 1.6934422315414226
Total norm for 4 adversaries is: 42.79554294659375. distance: 1.6934422315414226
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1546, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4941/5305 (93.1385%), train_poison_data_count: 415
Global model norm: 42.80169086859697.
Norm before scaling: 42.791466662649285. Distance: 1.7373892220509848
Total norm for 4 adversaries is: 42.791466662649285. distance: 1.7373892220509848
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1061, Accuracy: 9637/9900 (97.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4385/4717 (92.9616%), train_poison_data_count: 370
Global model norm: 42.80169086859697.
Norm before scaling: 42.79251215668096. Distance: 1.6224235503725866
Total norm for 4 adversaries is: 42.79251215668096. distance: 1.6224235503725866
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1122, Accuracy: 9624/9900 (97.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4727/5066 (93.3083%), train_poison_data_count: 400
Global model norm: 42.80169086859697.
Norm before scaling: 42.794949641794766. Distance: 1.75841406807101
Total norm for 4 adversaries is: 42.794949641794766. distance: 1.75841406807101
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0867, Accuracy: 9677/9900 (97.7475%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3732/4175 (89.3892%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3726/4175 (89.2455%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9221, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4356/4956 (87.8935%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4445/4956 (89.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1347, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4470/5037 (88.7433%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4574/5037 (90.8080%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9341, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4296/4793 (89.6307%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4320/4793 (90.1314%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1455, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3401/3804 (89.4059%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3411/3804 (89.6688%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1628, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4871/5392 (90.3375%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4914/5392 (91.1350%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0060, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4086/4465 (91.5118%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4118/4465 (92.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9932, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4179/4596 (90.9269%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4222/4596 (91.8625%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0570, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5396/6124 (88.1123%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5389/6124 (87.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0329, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2921/3271 (89.2999%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2976/3271 (90.9814%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8694, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3246/3590 (90.4178%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3262/3590 (90.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0369, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3952/4501 (87.8027%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4027/4501 (89.4690%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0516, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4655/5232 (88.9717%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4603/5232 (87.9778%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0052, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3275/3672 (89.1885%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3313/3672 (90.2233%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9324, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3825/4223 (90.5754%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3870/4223 (91.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1224, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3919/4354 (90.0092%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0173, Accuracy: 3042/4354 (69.8668%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.6952, Accuracy: 4365/10000 (43.6500%)
time spent on training: 256.5928599834442
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1399, Accuracy: 6991/10000 (69.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.5396, Accuracy: 6570/9900 (66.3636%)
Done in 283.62651562690735 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4633/4885 (94.8414%), train_poison_data_count: 385
Global model norm: 42.82458628439611.
Norm before scaling: 42.811708763217595. Distance: 1.570286612985278
Total norm for 4 adversaries is: 42.811708763217595. distance: 1.570286612985278
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2849, Accuracy: 9224/9900 (93.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4965/5305 (93.5910%), train_poison_data_count: 415
Global model norm: 42.82458628439611.
Norm before scaling: 42.81162464889793. Distance: 1.7000899964240606
Total norm for 4 adversaries is: 42.81162464889793. distance: 1.7000899964240606
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0590, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4398/4717 (93.2372%), train_poison_data_count: 370
Global model norm: 42.82458628439611.
Norm before scaling: 42.81677385145774. Distance: 1.647927155523602
Total norm for 4 adversaries is: 42.81677385145774. distance: 1.647927155523602
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0802, Accuracy: 9698/9900 (97.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4733/5066 (93.4268%), train_poison_data_count: 400
Global model norm: 42.82458628439611.
Norm before scaling: 42.81648019819588. Distance: 1.6831750194144501
Total norm for 4 adversaries is: 42.81648019819588. distance: 1.6831750194144501
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1902, Accuracy: 9420/9900 (95.1515%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5100/5582 (91.3651%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5062/5582 (90.6843%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0364, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4165/4647 (89.6277%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4215/4647 (90.7037%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9412, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4056/4465 (90.8399%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4156/4465 (93.0795%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8526, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4549/5083 (89.4944%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4463/5083 (87.8025%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1846, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3864/4416 (87.5000%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3954/4416 (89.5380%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9036, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4411/4956 (89.0032%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4348/4956 (87.7320%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1178, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4027/4362 (92.3200%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3897/4362 (89.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9673, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3947/4356 (90.6107%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3787/4356 (86.9376%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2492, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3421/3781 (90.4787%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3450/3781 (91.2457%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0022, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3279/3590 (91.3370%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3319/3590 (92.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9752, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4213/4651 (90.5827%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4273/4651 (91.8727%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9931, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4226/4662 (90.6478%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4221/4662 (90.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8927, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3164/3472 (91.1290%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3245/3472 (93.4620%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8663, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4904/5424 (90.4130%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4971/5424 (91.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2642, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2967/3271 (90.7062%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0055, Accuracy: 2922/3271 (89.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9857, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4502/5037 (89.3786%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4523/5037 (89.7955%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0212, Accuracy: 5457/10000 (54.5700%)
time spent on training: 259.88806986808777
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1407, Accuracy: 6985/10000 (69.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.4676, Accuracy: 6694/9900 (67.6162%)
Done in 287.06372714042664 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4629/4885 (94.7595%), train_poison_data_count: 385
Global model norm: 42.84644525621408.
Norm before scaling: 42.8383803505068. Distance: 1.5974226130216436
Total norm for 4 adversaries is: 42.8383803505068. distance: 1.5974226130216436
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1706, Accuracy: 9492/9900 (95.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4964/5305 (93.5721%), train_poison_data_count: 415
Global model norm: 42.84644525621408.
Norm before scaling: 42.837106580572325. Distance: 1.7329021076392759
Total norm for 4 adversaries is: 42.837106580572325. distance: 1.7329021076392759
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1065, Accuracy: 9628/9900 (97.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4431/4717 (93.9368%), train_poison_data_count: 370
Global model norm: 42.84644525621408.
Norm before scaling: 42.83441928619948. Distance: 1.5760577419324304
Total norm for 4 adversaries is: 42.83441928619948. distance: 1.5760577419324304
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1960, Accuracy: 9420/9900 (95.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4695/5066 (92.6767%), train_poison_data_count: 400
Global model norm: 42.84644525621408.
Norm before scaling: 42.841264002911814. Distance: 1.7676050342176493
Total norm for 4 adversaries is: 42.841264002911814. distance: 1.7676050342176493
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2682, Accuracy: 9254/9900 (93.4747%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4385/4989 (87.8934%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4448/4989 (89.1561%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0868, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3649/4013 (90.9295%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3747/4013 (93.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8123, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4615/5195 (88.8354%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4474/5195 (86.1213%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0325, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3605/3969 (90.8289%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3585/3969 (90.3250%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9193, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3980/4356 (91.3682%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3832/4356 (87.9706%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1640, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4058/4441 (91.3758%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4049/4441 (91.1732%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9833, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4098/4518 (90.7039%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4121/4518 (91.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0214, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3547/3911 (90.6929%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3291/3911 (84.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1573, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4010/4362 (91.9303%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3951/4362 (90.5777%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9438, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3455/3804 (90.8254%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3503/3804 (92.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1670, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3804/4223 (90.0781%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3856/4223 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9879, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4202/4634 (90.6776%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4203/4634 (90.6992%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8731, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3947/4354 (90.6523%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0141, Accuracy: 3265/4354 (74.9885%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.8967, Accuracy: 4150/10000 (41.5000%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4522/5244 (86.2319%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4551/5244 (86.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9501, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4486/5037 (89.0609%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4608/5037 (91.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0598, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3332/3704 (89.9568%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3366/3704 (90.8747%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8923, Accuracy: 5641/10000 (56.4100%)
time spent on training: 258.67509269714355
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1392, Accuracy: 6998/10000 (69.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 1.3879, Accuracy: 6856/9900 (69.2525%)
Done in 286.0401816368103 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4613/4885 (94.4319%), train_poison_data_count: 385
Global model norm: 42.86914876709852.
Norm before scaling: 42.858399494458055. Distance: 1.587208356125047
Total norm for 4 adversaries is: 42.858399494458055. distance: 1.587208356125047
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1335, Accuracy: 9569/9900 (96.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4964/5305 (93.5721%), train_poison_data_count: 415
Global model norm: 42.86914876709852.
Norm before scaling: 42.85720322377631. Distance: 1.698545826929017
Total norm for 4 adversaries is: 42.85720322377631. distance: 1.698545826929017
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0745, Accuracy: 9708/9900 (98.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4416/4717 (93.6188%), train_poison_data_count: 370
Global model norm: 42.86914876709852.
Norm before scaling: 42.85728582449182. Distance: 1.5481690667802812
Total norm for 4 adversaries is: 42.85728582449182. distance: 1.5481690667802812
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1008, Accuracy: 9644/9900 (97.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4741/5066 (93.5847%), train_poison_data_count: 400
Global model norm: 42.86914876709852.
Norm before scaling: 42.85991899490712. Distance: 1.6544749266591277
Total norm for 4 adversaries is: 42.85991899490712. distance: 1.6544749266591277
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2019, Accuracy: 9409/9900 (95.0404%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3928/4416 (88.9493%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3979/4416 (90.1042%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9710, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4639/5197 (89.2630%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4640/5197 (89.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8908, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4438/4918 (90.2399%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4482/4918 (91.1346%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0206, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5681/6263 (90.7073%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5734/6263 (91.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2167, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3291/3646 (90.2633%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3334/3646 (91.4427%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8380, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4306/4707 (91.4808%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4294/4707 (91.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9540, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4461/5063 (88.1098%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4279/5063 (84.5151%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1758, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3831/4295 (89.1967%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3857/4295 (89.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0510, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4328/4793 (90.2984%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4368/4793 (91.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0006, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4132/4538 (91.0533%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4241/4538 (93.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9194, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4559/5083 (89.6911%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4521/5083 (88.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9887, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3258/3638 (89.5547%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3285/3638 (90.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8396, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5454/6124 (89.0594%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5443/6124 (88.8798%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1407, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4175/4618 (90.4071%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4007/4618 (86.7692%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9824, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3622/3969 (91.2572%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3607/3969 (90.8793%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8890, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3621/4158 (87.0851%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3671/4158 (88.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0137, Accuracy: 5318/10000 (53.1800%)
time spent on training: 261.53275060653687
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1388, Accuracy: 6998/10000 (69.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 1.3267, Accuracy: 6964/9900 (70.3434%)
Done in 288.7265696525574 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4597/4885 (94.1044%), train_poison_data_count: 385
Global model norm: 42.892689784088645.
Norm before scaling: 42.8828900698424. Distance: 1.5610540947885436
Total norm for 4 adversaries is: 42.8828900698424. distance: 1.5610540947885436
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2106, Accuracy: 9406/9900 (95.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4939/5305 (93.1008%), train_poison_data_count: 415
Global model norm: 42.892689784088645.
Norm before scaling: 42.88102266145465. Distance: 1.7360426986778552
Total norm for 4 adversaries is: 42.88102266145465. distance: 1.7360426986778552
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1679, Accuracy: 9479/9900 (95.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4436/4717 (94.0428%), train_poison_data_count: 370
Global model norm: 42.892689784088645.
Norm before scaling: 42.881365689976576. Distance: 1.550903853559346
Total norm for 4 adversaries is: 42.881365689976576. distance: 1.550903853559346
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0809, Accuracy: 9682/9900 (97.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4715/5066 (93.0715%), train_poison_data_count: 400
Global model norm: 42.892689784088645.
Norm before scaling: 42.88539784860125. Distance: 1.7227938850071112
Total norm for 4 adversaries is: 42.88539784860125. distance: 1.7227938850071112
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3030, Accuracy: 9177/9900 (92.6970%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4163/4716 (88.2740%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4189/4716 (88.8253%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1179, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4001/4481 (89.2881%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3907/4481 (87.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1733, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3925/4361 (90.0023%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3771/4361 (86.4710%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2151, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4361/4793 (90.9869%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4440/4793 (92.6351%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9589, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3909/4295 (91.0128%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3751/4295 (87.3341%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1678, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4576/5244 (87.2616%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4585/5244 (87.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0515, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4436/4989 (88.9156%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4474/4989 (89.6773%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0238, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4633/5197 (89.1476%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4662/5197 (89.7056%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9998, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3938/4356 (90.4040%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3688/4356 (84.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3148, Accuracy: 4768/10000 (47.6800%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4167/4647 (89.6708%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4155/4647 (89.4125%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9530, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3668/4013 (91.4029%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3690/4013 (91.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7740, Accuracy: 5771/10000 (57.7100%)
