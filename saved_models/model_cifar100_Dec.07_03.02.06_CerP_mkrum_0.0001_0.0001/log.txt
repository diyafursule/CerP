current path: saved_models/model_cifar100_Dec.07_03.02.06_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4310/4885 (88.2293%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43998088523441. Distance: 2.2947953339447995
Total norm for 4 adversaries is: 42.43998088523441. distance: 2.2947953339447995
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4404, Accuracy: 8832/9900 (89.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4737/5305 (89.2931%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43528793479991. Distance: 2.250930381847324
Total norm for 4 adversaries is: 42.43528793479991. distance: 2.250930381847324
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7509, Accuracy: 8263/9900 (83.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4174/4717 (88.4884%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438623247745234. Distance: 2.176645104017647
Total norm for 4 adversaries is: 42.438623247745234. distance: 2.176645104017647
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4319, Accuracy: 8878/9900 (89.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4455/5066 (87.9392%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44030446826902. Distance: 2.3036848570482165
Total norm for 4 adversaries is: 42.44030446826902. distance: 2.3036848570482165
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6101, Accuracy: 8493/9900 (85.7879%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3834/4356 (88.0165%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3696/4356 (84.8485%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3451, Accuracy: 4779/10000 (47.7900%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3943/4465 (88.3091%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4079/4465 (91.3550%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0041, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4049/4647 (87.1315%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4163/4647 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9903, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4443/5055 (87.8932%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4502/5055 (89.0603%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1930, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4439/5116 (86.7670%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4440/5116 (86.7866%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0500, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3627/4126 (87.9060%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3748/4126 (90.8386%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0227, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3083/3472 (88.7961%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3208/3472 (92.3963%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0804, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4440/4986 (89.0493%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4458/4986 (89.4103%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1045, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3541/4013 (88.2382%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3689/4013 (91.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8337, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4031/4618 (87.2889%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4068/4618 (88.0901%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0465, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4435/5083 (87.2516%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4455/5083 (87.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2033, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3972/4511 (88.0514%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4028/4511 (89.2928%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1719, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3330/3797 (87.7008%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3394/3797 (89.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9979, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4993/5582 (89.4482%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5040/5582 (90.2902%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1316, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3158/3616 (87.3341%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3215/3616 (88.9104%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1017, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4820/5455 (88.3593%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4848/5455 (88.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9794, Accuracy: 5317/10000 (53.1700%)
time spent on training: 263.6367700099945
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 12, 6]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1059, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.9508, Accuracy: 131/9900 (1.3232%)
Done in 292.8146629333496 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4374/4885 (89.5394%), train_poison_data_count: 385
Global model norm: 42.45408537743305.
Norm before scaling: 42.46190129425951. Distance: 2.1534902630991715
Total norm for 4 adversaries is: 42.46190129425951. distance: 2.1534902630991715
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2378, Accuracy: 9315/9900 (94.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.45408537743305.
Norm before scaling: 42.455127678655465. Distance: 2.2101079779781143
Total norm for 4 adversaries is: 42.455127678655465. distance: 2.2101079779781143
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1556, Accuracy: 9489/9900 (95.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.45408537743305.
Norm before scaling: 42.45776135200062. Distance: 2.062232029008202
Total norm for 4 adversaries is: 42.45776135200062. distance: 2.062232029008202
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3293, Accuracy: 9076/9900 (91.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 42.45408537743305.
Norm before scaling: 42.46168136997904. Distance: 2.195756317563911
Total norm for 4 adversaries is: 42.46168136997904. distance: 2.195756317563911
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2449, Accuracy: 9310/9900 (94.0404%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3570/4025 (88.6957%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3697/4025 (91.8509%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9678, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3368/3797 (88.7016%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3451/3797 (90.8875%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0088, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3956/4625 (85.5351%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4033/4625 (87.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1215, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3862/4481 (86.1861%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3846/4481 (85.8291%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1923, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3904/4315 (90.4751%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3962/4315 (91.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8991, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3766/4235 (88.9256%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3756/4235 (88.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0716, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3386/3828 (88.4535%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3504/3828 (91.5361%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9031, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3811/4416 (86.2998%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3941/4416 (89.2437%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9113, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3140/3638 (86.3112%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3281/3638 (90.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8969, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4617/5265 (87.6923%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4621/5265 (87.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0177, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3343/3781 (88.4158%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3253/3781 (86.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.4005, Accuracy: 4964/10000 (49.6400%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4003/4441 (90.1374%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4037/4441 (90.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1493, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3954/4433 (89.1947%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3998/4433 (90.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9490, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4453/5083 (87.6057%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4447/5083 (87.4877%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9973, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4313/4928 (87.5203%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4425/4928 (89.7930%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9957, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4182/4793 (87.2522%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4286/4793 (89.4221%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1713, Accuracy: 5172/10000 (51.7200%)
time spent on training: 259.80796909332275
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [8, 12, 18]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0978, Accuracy: 7062/10000 (70.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.6860, Accuracy: 320/9900 (3.2323%)
Done in 289.0121500492096 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 42.476681045218065.
Norm before scaling: 42.478247247948126. Distance: 1.994044795708735
Total norm for 4 adversaries is: 42.478247247948126. distance: 1.994044795708735
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1935, Accuracy: 9439/9900 (95.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 42.476681045218065.
Norm before scaling: 42.4759439041309. Distance: 2.0635613687169414
Total norm for 4 adversaries is: 42.4759439041309. distance: 2.0635613687169414
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1719, Accuracy: 9432/9900 (95.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 42.476681045218065.
Norm before scaling: 42.47996713065907. Distance: 2.012476272917014
Total norm for 4 adversaries is: 42.47996713065907. distance: 2.012476272917014
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3171, Accuracy: 9144/9900 (92.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.476681045218065.
Norm before scaling: 42.48365235915384. Distance: 2.1806849450060914
Total norm for 4 adversaries is: 42.48365235915384. distance: 2.1806849450060914
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2126, Accuracy: 9344/9900 (94.3838%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3193/3616 (88.3020%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3271/3616 (90.4591%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9147, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3402/3837 (88.6630%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3545/3837 (92.3899%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9317, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4151/4679 (88.7155%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4222/4679 (90.2330%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9840, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3165/3638 (86.9984%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3313/3638 (91.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8869, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3615/4046 (89.3475%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3708/4046 (91.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9906, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4005/4518 (88.6454%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4120/4518 (91.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0808, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3358/3797 (88.4382%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3422/3797 (90.1238%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0339, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4435/5025 (88.2587%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4526/5025 (90.0697%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1520, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3924/4362 (89.9587%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4009/4362 (91.9074%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9313, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4017/4558 (88.1308%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4047/4558 (88.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1526, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3225/3672 (87.8268%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3295/3672 (89.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9215, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4285/4874 (87.9155%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4282/4874 (87.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0555, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3593/4025 (89.2671%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3672/4025 (91.2298%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9068, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4146/4663 (88.9127%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4272/4663 (91.6148%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0661, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3404/3911 (87.0366%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3245/3911 (82.9711%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1498, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4422/5017 (88.1403%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4506/5017 (89.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9096, Accuracy: 5605/10000 (56.0500%)
time spent on training: 258.2359914779663
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 17 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [9, 16, 17]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0935, Accuracy: 7082/10000 (70.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.5379, Accuracy: 680/9900 (6.8687%)
Done in 287.16076016426086 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 42.49688924736874.
Norm before scaling: 42.498701726493955. Distance: 1.9610641256232593
Total norm for 4 adversaries is: 42.498701726493955. distance: 1.9610641256232593
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3609, Accuracy: 9012/9900 (91.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4859/5305 (91.5928%), train_poison_data_count: 415
Global model norm: 42.49688924736874.
Norm before scaling: 42.49101611158896. Distance: 1.969076523118666
Total norm for 4 adversaries is: 42.49101611158896. distance: 1.969076523118666
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2939, Accuracy: 9125/9900 (92.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 42.49688924736874.
Norm before scaling: 42.499531821869816. Distance: 1.957646438850506
Total norm for 4 adversaries is: 42.499531821869816. distance: 1.957646438850506
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1682, Accuracy: 9479/9900 (95.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4590/5066 (90.6040%), train_poison_data_count: 400
Global model norm: 42.49688924736874.
Norm before scaling: 42.50273859512981. Distance: 2.087005227667746
Total norm for 4 adversaries is: 42.50273859512981. distance: 2.087005227667746
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2328, Accuracy: 9318/9900 (94.1212%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5294/6124 (86.4468%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5380/6124 (87.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0253, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3881/4356 (89.0955%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3786/4356 (86.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1488, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3553/4158 (85.4497%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3597/4158 (86.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0524, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4882/5455 (89.4959%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4902/5455 (89.8625%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0419, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3900/4511 (86.4553%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3994/4511 (88.5391%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9794, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4514/5232 (86.2768%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4574/5232 (87.4235%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0779, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4466/5244 (85.1640%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4534/5244 (86.4607%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9843, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4385/4918 (89.1623%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4420/4918 (89.8739%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2084, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3647/4126 (88.3907%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3788/4126 (91.8080%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9257, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4237/4928 (85.9781%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4367/4928 (88.6161%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9559, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3744/4223 (88.6574%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3847/4223 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9853, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4570/5195 (87.9692%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4536/5195 (87.3147%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1999, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4166/4679 (89.0361%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4140/4679 (88.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0829, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3208/3646 (87.9868%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3275/3646 (89.8245%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8789, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3167/3616 (87.5830%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3263/3616 (90.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8796, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4085/4716 (86.6200%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4207/4716 (89.2070%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0021, Accuracy: 5378/10000 (53.7800%)
time spent on training: 266.4914858341217
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 18, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0907, Accuracy: 7090/10000 (70.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 5.7946, Accuracy: 1036/9900 (10.4646%)
Done in 295.58329796791077 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4474/4885 (91.5865%), train_poison_data_count: 385
Global model norm: 42.5213296659747.
Norm before scaling: 42.52335496845748. Distance: 1.9109341338308135
Total norm for 4 adversaries is: 42.52335496845748. distance: 1.9109341338308135
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.4413, Accuracy: 8900/9900 (89.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 42.5213296659747.
Norm before scaling: 42.519251154624065. Distance: 1.983323366743846
Total norm for 4 adversaries is: 42.519251154624065. distance: 1.983323366743846
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2449, Accuracy: 9301/9900 (93.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4296/4717 (91.0748%), train_poison_data_count: 370
Global model norm: 42.5213296659747.
Norm before scaling: 42.52160813284377. Distance: 1.9244278490987181
Total norm for 4 adversaries is: 42.52160813284377. distance: 1.9244278490987181
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2351, Accuracy: 9264/9900 (93.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4591/5066 (90.6238%), train_poison_data_count: 400
Global model norm: 42.5213296659747.
Norm before scaling: 42.52493380497126. Distance: 2.0447196969807844
Total norm for 4 adversaries is: 42.52493380497126. distance: 2.0447196969807844
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.3325, Accuracy: 9083/9900 (91.7475%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5285/6124 (86.2998%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5323/6124 (86.9203%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1271, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3957/4433 (89.2624%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4062/4433 (91.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9351, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3354/3781 (88.7067%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3391/3781 (89.6853%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0302, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3531/3969 (88.9645%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3608/3969 (90.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9836, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4403/5025 (87.6219%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4519/5025 (89.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0731, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4197/4679 (89.6987%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4070/4679 (86.9844%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2000, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4130/4707 (87.7417%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4223/4707 (89.7174%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9498, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4401/4986 (88.2671%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4466/4986 (89.5708%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0277, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3892/4315 (90.1970%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3912/4315 (90.6605%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0549, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3878/4416 (87.8170%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3949/4416 (89.4248%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0157, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4273/4804 (88.9467%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4280/4804 (89.0924%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1527, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4245/4793 (88.5667%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4305/4793 (89.8185%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0486, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4560/5232 (87.1560%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4640/5232 (88.6850%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1128, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4120/4662 (88.3741%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4196/4662 (90.0043%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0561, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4293/4956 (86.6223%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4336/4956 (87.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3233, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3821/4368 (87.4771%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3888/4368 (89.0110%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3021, Accuracy: 5027/10000 (50.2700%)
time spent on training: 263.6418809890747
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [12, 4, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0925, Accuracy: 7092/10000 (70.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.0772, Accuracy: 1537/9900 (15.5253%)
Done in 292.8727858066559 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 42.54433005150334.
Norm before scaling: 42.54605730484906. Distance: 1.9340412893532908
Total norm for 4 adversaries is: 42.54605730484906. distance: 1.9340412893532908
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2030, Accuracy: 9381/9900 (94.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4851/5305 (91.4420%), train_poison_data_count: 415
Global model norm: 42.54433005150334.
Norm before scaling: 42.544226758383445. Distance: 1.9884923436912145
Total norm for 4 adversaries is: 42.544226758383445. distance: 1.9884923436912145
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1413, Accuracy: 9544/9900 (96.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4326/4717 (91.7108%), train_poison_data_count: 370
Global model norm: 42.54433005150334.
Norm before scaling: 42.54012782756932. Distance: 1.7912980816837403
Total norm for 4 adversaries is: 42.54012782756932. distance: 1.7912980816837403
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1999, Accuracy: 9413/9900 (95.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4609/5066 (90.9791%), train_poison_data_count: 400
Global model norm: 42.54433005150334.
Norm before scaling: 42.54730249050755. Distance: 2.0123859965571724
Total norm for 4 adversaries is: 42.54730249050755. distance: 2.0123859965571724
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2044, Accuracy: 9339/9900 (94.3333%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5307/6124 (86.6590%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5311/6124 (86.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0316, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5099/5902 (86.3944%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5120/5902 (86.7503%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2651, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4157/4707 (88.3153%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4265/4707 (90.6097%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8710, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4076/4647 (87.7125%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4148/4647 (89.2619%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9680, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2931/3297 (88.8990%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3003/3297 (91.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8493, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5516/6263 (88.0728%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5590/6263 (89.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0362, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4163/4663 (89.2773%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4262/4663 (91.4004%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9175, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4294/4956 (86.6425%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4378/4956 (88.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0420, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3649/4046 (90.1878%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3693/4046 (91.2753%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9111, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3700/4184 (88.4321%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3826/4184 (91.4436%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9743, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4792/5591 (85.7092%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4870/5591 (87.1043%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1104, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4072/4634 (87.8722%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4195/4634 (90.5265%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8539, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3407/3828 (89.0021%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3471/3828 (90.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1397, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3156/3638 (86.7510%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3303/3638 (90.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8069, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3404/3781 (90.0291%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3479/3781 (92.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1019, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3411/3837 (88.8976%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3537/3837 (92.1814%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0063, Accuracy: 5417/10000 (54.1700%)
time spent on training: 261.11201667785645
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 17 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 9, 17]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0954, Accuracy: 7077/10000 (70.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 4.3900, Accuracy: 2232/9900 (22.5455%)
Done in 291.7232596874237 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4516/4885 (92.4463%), train_poison_data_count: 385
Global model norm: 42.56753165238222.
Norm before scaling: 42.565627466320315. Distance: 1.8113892538957572
Total norm for 4 adversaries is: 42.565627466320315. distance: 1.8113892538957572
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1479, Accuracy: 9532/9900 (96.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4841/5305 (91.2535%), train_poison_data_count: 415
Global model norm: 42.56753165238222.
Norm before scaling: 42.56779547867217. Distance: 1.9565061675709807
Total norm for 4 adversaries is: 42.56779547867217. distance: 1.9565061675709807
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.3627, Accuracy: 9035/9900 (91.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4343/4717 (92.0712%), train_poison_data_count: 370
Global model norm: 42.56753165238222.
Norm before scaling: 42.56196510998332. Distance: 1.7858103549183268
Total norm for 4 adversaries is: 42.56196510998332. distance: 1.7858103549183268
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2769, Accuracy: 9182/9900 (92.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4626/5066 (91.3146%), train_poison_data_count: 400
Global model norm: 42.56753165238222.
Norm before scaling: 42.57201504326228. Distance: 1.986005518699116
Total norm for 4 adversaries is: 42.57201504326228. distance: 1.986005518699116
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1509, Accuracy: 9516/9900 (96.1212%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3951/4501 (87.7805%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3995/4501 (88.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0425, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3682/4175 (88.1916%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3663/4175 (87.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0136, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3244/3616 (89.7124%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3333/3616 (92.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9483, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4156/4634 (89.6849%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4229/4634 (91.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8686, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4051/4558 (88.8767%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3967/4558 (87.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2897, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4587/5167 (88.7749%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4657/5167 (90.1297%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2610, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3920/4356 (89.9908%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4022/4356 (92.3324%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0798, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4122/4716 (87.4046%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4225/4716 (89.5886%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0161, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5272/6124 (86.0875%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5386/6124 (87.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9889, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4466/5055 (88.3482%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4564/5055 (90.2868%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9814, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4497/5025 (89.4925%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4569/5025 (90.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2803, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4416/4918 (89.7926%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4427/4918 (90.0163%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2280, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3787/4223 (89.6756%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3893/4223 (92.1857%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9047, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3874/4481 (86.4539%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3904/4481 (87.1234%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1134, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3191/3638 (87.7130%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3268/3638 (89.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9504, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3573/4013 (89.0356%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3656/4013 (91.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8279, Accuracy: 5676/10000 (56.7600%)
time spent on training: 260.8731665611267
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 6, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0985, Accuracy: 7079/10000 (70.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 3.7884, Accuracy: 2978/9900 (30.0808%)
Done in 289.96277046203613 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4516/4885 (92.4463%), train_poison_data_count: 385
Global model norm: 42.58988083123443.
Norm before scaling: 42.58863545732814. Distance: 1.8186964466298743
Total norm for 4 adversaries is: 42.58863545732814. distance: 1.8186964466298743
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1557, Accuracy: 9507/9900 (96.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4912/5305 (92.5919%), train_poison_data_count: 415
Global model norm: 42.58988083123443.
Norm before scaling: 42.58267607558046. Distance: 1.8058191359730114
Total norm for 4 adversaries is: 42.58267607558046. distance: 1.8058191359730114
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2026, Accuracy: 9394/9900 (94.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4361/4717 (92.4528%), train_poison_data_count: 370
Global model norm: 42.58988083123443.
Norm before scaling: 42.585899519566624. Distance: 1.7382235742494514
Total norm for 4 adversaries is: 42.585899519566624. distance: 1.7382235742494514
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1852, Accuracy: 9454/9900 (95.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4635/5066 (91.4923%), train_poison_data_count: 400
Global model norm: 42.58988083123443.
Norm before scaling: 42.59163346492991. Distance: 1.9256297084771832
Total norm for 4 adversaries is: 42.59163346492991. distance: 1.9256297084771832
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1679, Accuracy: 9474/9900 (95.6970%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3230/3646 (88.5902%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3290/3646 (90.2359%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8412, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4015/4501 (89.2024%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3998/4501 (88.8247%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0918, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4106/4651 (88.2821%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4158/4651 (89.4001%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0836, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4556/5167 (88.1750%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4661/5167 (90.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0063, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4890/5455 (89.6425%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4827/5455 (88.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0424, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4841/5591 (86.5856%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4852/5591 (86.7823%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1878, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4198/4679 (89.7200%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4153/4679 (88.7583%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1276, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4509/5017 (89.8744%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4491/5017 (89.5156%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9106, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4220/4793 (88.0451%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4314/4793 (90.0063%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1019, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3958/4456 (88.8241%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4061/4456 (91.1355%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9295, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4856/5424 (89.5280%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4966/5424 (91.5560%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2104, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3666/4175 (87.8084%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3691/4175 (88.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9662, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4526/5116 (88.4676%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4540/5116 (88.7412%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1053, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3290/3704 (88.8229%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3324/3704 (89.7408%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9311, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4565/5232 (87.2515%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4608/5232 (88.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2585, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3152/3472 (90.7834%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3141/3472 (90.4666%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0328, Accuracy: 5525/10000 (55.2500%)
time spent on training: 266.67985939979553
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [6, 13, 8]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1022, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 3.3627, Accuracy: 3548/9900 (35.8384%)
Done in 296.02178049087524 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4541/4885 (92.9580%), train_poison_data_count: 385
Global model norm: 42.613334066162615.
Norm before scaling: 42.61025593836315. Distance: 1.7614590946183082
Total norm for 4 adversaries is: 42.61025593836315. distance: 1.7614590946183082
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1625, Accuracy: 9499/9900 (95.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4891/5305 (92.1960%), train_poison_data_count: 415
Global model norm: 42.613334066162615.
Norm before scaling: 42.607107395198014. Distance: 1.848265339822164
Total norm for 4 adversaries is: 42.607107395198014. distance: 1.848265339822164
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1582, Accuracy: 9489/9900 (95.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4364/4717 (92.5164%), train_poison_data_count: 370
Global model norm: 42.613334066162615.
Norm before scaling: 42.60846539412312. Distance: 1.7439794519333849
Total norm for 4 adversaries is: 42.60846539412312. distance: 1.7439794519333849
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1767, Accuracy: 9426/9900 (95.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4637/5066 (91.5318%), train_poison_data_count: 400
Global model norm: 42.613334066162615.
Norm before scaling: 42.6108231670847. Distance: 1.8590223474826604
Total norm for 4 adversaries is: 42.6108231670847. distance: 1.8590223474826604
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1503, Accuracy: 9521/9900 (96.1717%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3252/3590 (90.5850%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3031/3590 (84.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1994, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3923/4368 (89.8123%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3851/4368 (88.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9780, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3298/3704 (89.0389%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3351/3704 (90.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0242, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4317/4928 (87.6015%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4350/4928 (88.2711%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1056, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3938/4356 (90.4040%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3840/4356 (88.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0957, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3514/3911 (89.8491%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3555/3911 (90.8975%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9631, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4173/4651 (89.7226%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4212/4651 (90.5612%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9994, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3793/4184 (90.6549%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3726/4184 (89.0535%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8781, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3910/4346 (89.9678%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3995/4346 (91.9236%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0247, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4277/4793 (89.2343%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4346/4793 (90.6739%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0526, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3355/3804 (88.1966%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3466/3804 (91.1146%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9420, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4447/4986 (89.1897%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4476/4986 (89.7714%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9489, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5350/6124 (87.3612%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5363/6124 (87.5735%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9906, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4209/4707 (89.4200%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4242/4707 (90.1211%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9032, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3794/4235 (89.5868%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3748/4235 (88.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0492, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3662/4046 (90.5091%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3714/4046 (91.7944%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8733, Accuracy: 5544/10000 (55.4400%)
time spent on training: 262.8880214691162
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 16, 10]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1083, Accuracy: 7042/10000 (70.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 2.9778, Accuracy: 4100/9900 (41.4141%)
Done in 291.9537525177002 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4540/4885 (92.9376%), train_poison_data_count: 385
Global model norm: 42.63425342878291.
Norm before scaling: 42.63359345651765. Distance: 1.7660400442938196
Total norm for 4 adversaries is: 42.63359345651765. distance: 1.7660400442938196
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3085, Accuracy: 9171/9900 (92.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4921/5305 (92.7615%), train_poison_data_count: 415
Global model norm: 42.63425342878291.
Norm before scaling: 42.628369150664355. Distance: 1.8084724006561275
Total norm for 4 adversaries is: 42.628369150664355. distance: 1.8084724006561275
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1475, Accuracy: 9524/9900 (96.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4357/4717 (92.3680%), train_poison_data_count: 370
Global model norm: 42.63425342878291.
Norm before scaling: 42.62992262172634. Distance: 1.7404873339798432
Total norm for 4 adversaries is: 42.62992262172634. distance: 1.7404873339798432
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1385, Accuracy: 9538/9900 (96.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4695/5066 (92.6767%), train_poison_data_count: 400
Global model norm: 42.63425342878291.
Norm before scaling: 42.635488880853416. Distance: 1.8405437717098265
Total norm for 4 adversaries is: 42.635488880853416. distance: 1.8405437717098265
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1417, Accuracy: 9552/9900 (96.4848%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4504/4986 (90.3329%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4522/4986 (90.6939%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0126, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4122/4634 (88.9512%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4222/4634 (91.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8184, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4123/4716 (87.4258%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4167/4716 (88.3588%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1288, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5354/6124 (87.4265%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5386/6124 (87.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2011, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4432/4918 (90.1179%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4443/4918 (90.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9647, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3412/3797 (89.8604%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3485/3797 (91.7830%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0669, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5035/5582 (90.2006%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5039/5582 (90.2723%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1457, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4371/4956 (88.1961%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4346/4956 (87.6917%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1165, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4019/4433 (90.6610%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4055/4433 (91.4730%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8427, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3841/4354 (88.2177%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3652/4354 (83.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4457, Accuracy: 4685/10000 (46.8500%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4427/4928 (89.8336%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4426/4928 (89.8133%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9903, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3507/3911 (89.6702%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3400/3911 (86.9343%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0892, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3948/4481 (88.1053%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3910/4481 (87.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0803, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4582/5197 (88.1662%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4612/5197 (88.7435%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0822, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4910/5455 (90.0092%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4934/5455 (90.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0266, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3847/4361 (88.2137%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3835/4361 (87.9385%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0602, Accuracy: 5320/10000 (53.2000%)
time spent on training: 268.0374565124512
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 4, 10]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1168, Accuracy: 7020/10000 (70.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 2.5943, Accuracy: 4701/9900 (47.4848%)
Done in 297.517014503479 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4535/4885 (92.8352%), train_poison_data_count: 385
Global model norm: 42.658700994144354.
Norm before scaling: 42.654354067298186. Distance: 1.7512710587449076
Total norm for 4 adversaries is: 42.654354067298186. distance: 1.7512710587449076
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2645, Accuracy: 9222/9900 (93.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4919/5305 (92.7238%), train_poison_data_count: 415
Global model norm: 42.658700994144354.
Norm before scaling: 42.652327830212705. Distance: 1.8087345999462172
Total norm for 4 adversaries is: 42.652327830212705. distance: 1.8087345999462172
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1539, Accuracy: 9533/9900 (96.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4358/4717 (92.3892%), train_poison_data_count: 370
Global model norm: 42.658700994144354.
Norm before scaling: 42.65455725807985. Distance: 1.7193036661496266
Total norm for 4 adversaries is: 42.65455725807985. distance: 1.7193036661496266
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2471, Accuracy: 9286/9900 (93.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4653/5066 (91.8476%), train_poison_data_count: 400
Global model norm: 42.658700994144354.
Norm before scaling: 42.65958234465397. Distance: 1.8544096483902819
Total norm for 4 adversaries is: 42.65958234465397. distance: 1.8544096483902819
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2102, Accuracy: 9364/9900 (94.5859%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4320/4928 (87.6623%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4354/4928 (88.3523%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0104, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3738/4184 (89.3403%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3800/4184 (90.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9336, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4276/4707 (90.8434%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4301/4707 (91.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8530, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3411/3828 (89.1066%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3545/3828 (92.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9056, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4015/4503 (89.1628%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4015/4503 (89.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1223, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4199/4662 (90.0686%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4264/4662 (91.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9861, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3827/4235 (90.3660%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3685/4235 (87.0130%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0980, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4507/5244 (85.9458%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4565/5244 (87.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0421, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4267/4793 (89.0257%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4342/4793 (90.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0265, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3962/4481 (88.4178%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3908/4481 (87.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2298, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3942/4346 (90.7041%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4005/4346 (92.1537%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8022, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3893/4361 (89.2685%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3906/4361 (89.5666%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9607, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4505/5055 (89.1197%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4581/5055 (90.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9715, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4559/5195 (87.7575%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4587/5195 (88.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9768, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3930/4315 (91.0776%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3980/4315 (92.2364%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9521, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4217/4663 (90.4353%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4268/4663 (91.5291%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0521, Accuracy: 5394/10000 (53.9400%)
time spent on training: 266.00888204574585
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [6, 16, 19]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1189, Accuracy: 7024/10000 (70.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.3570, Accuracy: 5075/9900 (51.2626%)
Done in 295.14465975761414 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4567/4885 (93.4903%), train_poison_data_count: 385
Global model norm: 42.68147577138632.
Norm before scaling: 42.67811796377258. Distance: 1.7044489203196322
Total norm for 4 adversaries is: 42.67811796377258. distance: 1.7044489203196322
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1664, Accuracy: 9505/9900 (96.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4959/5305 (93.4779%), train_poison_data_count: 415
Global model norm: 42.68147577138632.
Norm before scaling: 42.67440233041129. Distance: 1.7545475456424782
Total norm for 4 adversaries is: 42.67440233041129. distance: 1.7545475456424782
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1290, Accuracy: 9588/9900 (96.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4365/4717 (92.5376%), train_poison_data_count: 370
Global model norm: 42.68147577138632.
Norm before scaling: 42.67480279913795. Distance: 1.682958071335423
Total norm for 4 adversaries is: 42.67480279913795. distance: 1.682958071335423
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.0837, Accuracy: 9673/9900 (97.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4660/5066 (91.9858%), train_poison_data_count: 400
Global model norm: 42.68147577138632.
Norm before scaling: 42.68323179384602. Distance: 1.8485276987829327
Total norm for 4 adversaries is: 42.68323179384602. distance: 1.8485276987829327
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.4265, Accuracy: 8911/9900 (90.0101%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3906/4315 (90.5214%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3955/4315 (91.6570%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0219, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3245/3590 (90.3900%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3132/3590 (87.2423%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1655, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4250/4679 (90.8314%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4268/4679 (91.2161%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9475, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4600/5167 (89.0265%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4674/5167 (90.4587%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1672, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3399/3775 (90.0397%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3519/3775 (93.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8642, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3447/3828 (90.0470%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3507/3828 (91.6144%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0622, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3814/4235 (90.0590%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3680/4235 (86.8949%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0072, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4147/4647 (89.2404%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4222/4647 (90.8543%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9069, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4373/4918 (88.9183%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4416/4918 (89.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1045, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4013/4433 (90.5256%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4067/4433 (91.7437%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7334, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3920/4481 (87.4805%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3887/4481 (86.7440%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1558, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3826/4295 (89.0803%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3803/4295 (88.5448%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8186, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4046/4503 (89.8512%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4069/4503 (90.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1739, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3885/4354 (89.2283%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0124, Accuracy: 3359/4354 (77.1475%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.6808, Accuracy: 4264/10000 (42.6400%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4482/4986 (89.8917%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4476/4986 (89.7714%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8352, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5617/6263 (89.6855%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5652/6263 (90.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2138, Accuracy: 5221/10000 (52.2100%)
time spent on training: 263.8702931404114
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 17, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1240, Accuracy: 7013/10000 (70.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.0876, Accuracy: 5520/9900 (55.7576%)
Done in 293.48100757598877 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4579/4885 (93.7359%), train_poison_data_count: 385
Global model norm: 42.7037796098747.
Norm before scaling: 42.69774195398101. Distance: 1.6487018680560308
Total norm for 4 adversaries is: 42.69774195398101. distance: 1.6487018680560308
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.2186, Accuracy: 9392/9900 (94.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4969/5305 (93.6664%), train_poison_data_count: 415
Global model norm: 42.7037796098747.
Norm before scaling: 42.69464274977892. Distance: 1.714636092766709
Total norm for 4 adversaries is: 42.69464274977892. distance: 1.714636092766709
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1284, Accuracy: 9557/9900 (96.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4390/4717 (93.0676%), train_poison_data_count: 370
Global model norm: 42.7037796098747.
Norm before scaling: 42.69682565365296. Distance: 1.6240624877859222
Total norm for 4 adversaries is: 42.69682565365296. distance: 1.6240624877859222
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.3373, Accuracy: 9078/9900 (91.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4720/5066 (93.1702%), train_poison_data_count: 400
Global model norm: 42.7037796098747.
Norm before scaling: 42.700790905383855. Distance: 1.7681481216876773
Total norm for 4 adversaries is: 42.700790905383855. distance: 1.7681481216876773
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1482, Accuracy: 9537/9900 (96.3333%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3802/4223 (90.0308%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3900/4223 (92.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9344, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4912/5455 (90.0458%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4853/5455 (88.9643%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0662, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5107/5582 (91.4905%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4989/5582 (89.3766%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1037, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4029/4465 (90.2352%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4101/4465 (91.8477%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8423, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4910/5591 (87.8197%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4967/5591 (88.8392%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0041, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3504/3911 (89.5935%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3406/3911 (87.0877%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0291, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3992/4356 (91.6437%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3775/4356 (86.6621%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1641, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4445/5037 (88.2470%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4562/5037 (90.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0447, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4263/4679 (91.1092%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4159/4679 (88.8865%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0420, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3960/4362 (90.7840%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3951/4362 (90.5777%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1217, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4084/4518 (90.3940%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4106/4518 (90.8809%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9810, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4501/5083 (88.5501%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4504/5083 (88.6091%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1249, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3662/4013 (91.2534%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3689/4013 (91.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9624, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4653/5197 (89.5324%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4590/5197 (88.3202%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2621, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2972/3297 (90.1426%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3033/3297 (91.9927%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8165, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4047/4441 (91.1281%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4040/4441 (90.9705%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9561, Accuracy: 5576/10000 (55.7600%)
time spent on training: 264.62787914276123
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 12, 19]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1291, Accuracy: 7009/10000 (70.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 1.8638, Accuracy: 5927/9900 (59.8687%)
Done in 293.8071813583374 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4571/4885 (93.5722%), train_poison_data_count: 385
Global model norm: 42.72655607172195.
Norm before scaling: 42.717882729400486. Distance: 1.6494307576447478
Total norm for 4 adversaries is: 42.717882729400486. distance: 1.6494307576447478
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2561, Accuracy: 9247/9900 (93.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4946/5305 (93.2328%), train_poison_data_count: 415
Global model norm: 42.72655607172195.
Norm before scaling: 42.7194572339957. Distance: 1.761553906766089
Total norm for 4 adversaries is: 42.7194572339957. distance: 1.761553906766089
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2148, Accuracy: 9383/9900 (94.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4393/4717 (93.1312%), train_poison_data_count: 370
Global model norm: 42.72655607172195.
Norm before scaling: 42.71821135130411. Distance: 1.6216501774722263
Total norm for 4 adversaries is: 42.71821135130411. distance: 1.6216501774722263
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1677, Accuracy: 9518/9900 (96.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4687/5066 (92.5188%), train_poison_data_count: 400
Global model norm: 42.72655607172195.
Norm before scaling: 42.72545896476713. Distance: 1.805508381479987
Total norm for 4 adversaries is: 42.72545896476713. distance: 1.805508381479987
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1892, Accuracy: 9422/9900 (95.1717%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4054/4501 (90.0689%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4019/4501 (89.2913%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1922, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4013/4511 (88.9603%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4064/4511 (90.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8144, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3875/4354 (88.9986%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3676/4354 (84.4281%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3315, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3951/4346 (90.9112%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4027/4346 (92.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8154, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4229/4707 (89.8449%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4179/4707 (88.7827%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8657, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4910/5591 (87.8197%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4975/5591 (88.9823%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1307, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4154/4647 (89.3910%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4145/4647 (89.1973%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8549, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4134/4538 (91.0974%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4148/4538 (91.4059%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9587, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4299/4934 (87.1301%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4132/4934 (83.7454%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2679, Accuracy: 4899/10000 (48.9900%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4321/4804 (89.9459%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4002/4804 (83.3056%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1373, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5598/6263 (89.3821%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5605/6263 (89.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2254, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3987/4481 (88.9757%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3918/4481 (87.4358%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0868, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4434/5063 (87.5765%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4265/5063 (84.2386%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0992, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3766/4223 (89.1783%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3803/4223 (90.0545%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9539, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4064/4441 (91.5109%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4058/4441 (91.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1047, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3457/3756 (92.0394%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3470/3756 (92.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0068, Accuracy: 5458/10000 (54.5800%)
time spent on training: 261.9392445087433
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 17 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [17, 13, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1351, Accuracy: 7003/10000 (70.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 1.6844, Accuracy: 6292/9900 (63.5556%)
Done in 291.09542870521545 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4594/4885 (94.0430%), train_poison_data_count: 385
Global model norm: 42.750128494872676.
Norm before scaling: 42.740251823972244. Distance: 1.641987044479612
Total norm for 4 adversaries is: 42.740251823972244. distance: 1.641987044479612
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2452, Accuracy: 9306/9900 (94.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4964/5305 (93.5721%), train_poison_data_count: 415
Global model norm: 42.750128494872676.
Norm before scaling: 42.7398234072488. Distance: 1.6914536114904892
Total norm for 4 adversaries is: 42.7398234072488. distance: 1.6914536114904892
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0635, Accuracy: 9742/9900 (98.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4398/4717 (93.2372%), train_poison_data_count: 370
Global model norm: 42.750128494872676.
Norm before scaling: 42.741208605816674. Distance: 1.5763836308343537
Total norm for 4 adversaries is: 42.741208605816674. distance: 1.5763836308343537
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2747, Accuracy: 9262/9900 (93.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4692/5066 (92.6174%), train_poison_data_count: 400
Global model norm: 42.750128494872676.
Norm before scaling: 42.74734006938692. Distance: 1.792201324649028
Total norm for 4 adversaries is: 42.74734006938692. distance: 1.792201324649028
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1355, Accuracy: 9562/9900 (96.5859%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4539/5244 (86.5561%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4537/5244 (86.5179%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9518, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4399/4928 (89.2654%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4423/4928 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9893, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3402/3804 (89.4322%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3446/3804 (90.5889%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9595, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3616/4013 (90.1072%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3719/4013 (92.6738%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8199, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3611/4158 (86.8446%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3641/4158 (87.5661%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9912, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5100/5582 (91.3651%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5104/5582 (91.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0820, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4917/5455 (90.1375%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4863/5455 (89.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0450, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3890/4354 (89.3431%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3678/4354 (84.4740%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.6559, Accuracy: 4506/10000 (45.0600%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4020/4433 (90.6835%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4040/4433 (91.1347%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9534, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3250/3646 (89.1388%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3343/3646 (91.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8094, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4089/4518 (90.5046%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4161/4518 (92.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0530, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3823/4235 (90.2715%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3869/4235 (91.3577%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9184, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4028/4362 (92.3430%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3961/4362 (90.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0991, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4909/5392 (91.0423%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4826/5392 (89.5030%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0836, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4993/5591 (89.3042%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4879/5591 (87.2652%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1198, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3418/3756 (91.0011%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3486/3756 (92.8115%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0411, Accuracy: 5421/10000 (54.2100%)
time spent on training: 265.300669670105
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [8, 12, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1464, Accuracy: 6978/10000 (69.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.4708, Accuracy: 6668/9900 (67.3535%)
Done in 294.45390129089355 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4600/4885 (94.1658%), train_poison_data_count: 385
Global model norm: 42.7728446020552.
Norm before scaling: 42.762385130290035. Distance: 1.6012104670984633
Total norm for 4 adversaries is: 42.762385130290035. distance: 1.6012104670984633
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0880, Accuracy: 9674/9900 (97.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4942/5305 (93.1574%), train_poison_data_count: 415
Global model norm: 42.7728446020552.
Norm before scaling: 42.76211536795376. Distance: 1.7383541477648181
Total norm for 4 adversaries is: 42.76211536795376. distance: 1.7383541477648181
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1729, Accuracy: 9479/9900 (95.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4446/4717 (94.2548%), train_poison_data_count: 370
Global model norm: 42.7728446020552.
Norm before scaling: 42.76137743794773. Distance: 1.5265490715818433
Total norm for 4 adversaries is: 42.76137743794773. distance: 1.5265490715818433
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0607, Accuracy: 9749/9900 (98.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4707/5066 (92.9135%), train_poison_data_count: 400
Global model norm: 42.7728446020552.
Norm before scaling: 42.76766727631766. Distance: 1.7569021622801615
Total norm for 4 adversaries is: 42.76766727631766. distance: 1.7569021622801615
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1413, Accuracy: 9513/9900 (96.0909%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4164/4634 (89.8576%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4198/4634 (90.5913%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8765, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4038/4503 (89.6736%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4033/4503 (89.5625%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0793, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4415/4928 (89.5901%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4411/4928 (89.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9527, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3465/3804 (91.0883%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3491/3804 (91.7718%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0181, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3261/3590 (90.8357%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3124/3590 (87.0195%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2330, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4208/4647 (90.5530%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4216/4647 (90.7252%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9328, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4049/4625 (87.5459%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4100/4625 (88.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0460, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3967/4356 (91.0698%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3749/4356 (86.0652%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2357, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3469/3797 (91.3616%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3466/3797 (91.2826%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9170, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4086/4456 (91.6966%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4066/4456 (91.2478%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9534, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3612/4025 (89.7391%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3734/4025 (92.7702%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9230, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3136/3472 (90.3226%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3145/3472 (90.5818%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0468, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2984/3297 (90.5065%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3040/3297 (92.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8973, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3931/4416 (89.0172%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3949/4416 (89.4248%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0445, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3989/4356 (91.5748%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3849/4356 (88.3609%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1899, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3201/3638 (87.9879%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3290/3638 (90.4343%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9357, Accuracy: 5483/10000 (54.8300%)
time spent on training: 257.8206624984741
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 13, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1519, Accuracy: 6956/10000 (69.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.2917, Accuracy: 7040/9900 (71.1111%)
Done in 287.22788071632385 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4612/4885 (94.4115%), train_poison_data_count: 385
Global model norm: 42.79338789873457.
Norm before scaling: 42.78358398490886. Distance: 1.5583264879426524
Total norm for 4 adversaries is: 42.78358398490886. distance: 1.5583264879426524
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2558, Accuracy: 9298/9900 (93.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4959/5305 (93.4779%), train_poison_data_count: 415
Global model norm: 42.79338789873457.
Norm before scaling: 42.783358581163014. Distance: 1.7163981906734649
Total norm for 4 adversaries is: 42.783358581163014. distance: 1.7163981906734649
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.3253, Accuracy: 9099/9900 (91.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4428/4717 (93.8732%), train_poison_data_count: 370
Global model norm: 42.79338789873457.
Norm before scaling: 42.78275084109541. Distance: 1.5477344167766245
Total norm for 4 adversaries is: 42.78275084109541. distance: 1.5477344167766245
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1653, Accuracy: 9490/9900 (95.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4758/5066 (93.9203%), train_poison_data_count: 400
Global model norm: 42.79338789873457.
Norm before scaling: 42.7844085530509. Distance: 1.645262711832197
Total norm for 4 adversaries is: 42.7844085530509. distance: 1.645262711832197
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.3266, Accuracy: 9132/9900 (92.2424%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3724/4175 (89.1976%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3770/4175 (90.2994%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0096, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4342/4956 (87.6110%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4402/4956 (88.8216%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1939, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4483/5037 (89.0014%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4541/5037 (90.1529%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9602, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4309/4793 (89.9019%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4351/4793 (90.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9301, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3419/3804 (89.8791%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3484/3804 (91.5878%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8371, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4826/5392 (89.5030%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4773/5392 (88.5200%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0714, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4056/4465 (90.8399%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4116/4465 (92.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9585, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4115/4596 (89.5344%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4163/4596 (90.5788%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0512, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5429/6124 (88.6512%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5350/6124 (87.3612%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0481, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2916/3271 (89.1470%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0059, Accuracy: 2916/3271 (89.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0628, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3302/3590 (91.9777%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3115/3590 (86.7688%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2828, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4010/4501 (89.0913%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4027/4501 (89.4690%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0664, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4579/5232 (87.5191%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4576/5232 (87.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1574, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3301/3672 (89.8965%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3283/3672 (89.4063%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0457, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3797/4223 (89.9124%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3875/4223 (91.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0938, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3887/4354 (89.2742%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3646/4354 (83.7391%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.3232, Accuracy: 5004/10000 (50.0400%)
time spent on training: 263.821608543396
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 11, 19]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1520, Accuracy: 6951/10000 (69.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.2294, Accuracy: 7162/9900 (72.3434%)
Done in 293.0168948173523 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4620/4885 (94.5752%), train_poison_data_count: 385
Global model norm: 42.815944204525024.
Norm before scaling: 42.804204830505554. Distance: 1.568448454914951
Total norm for 4 adversaries is: 42.804204830505554. distance: 1.568448454914951
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0533, Accuracy: 9752/9900 (98.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4951/5305 (93.3270%), train_poison_data_count: 415
Global model norm: 42.815944204525024.
Norm before scaling: 42.80668585064283. Distance: 1.7185403869429299
Total norm for 4 adversaries is: 42.80668585064283. distance: 1.7185403869429299
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.3072, Accuracy: 9180/9900 (92.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4435/4717 (94.0216%), train_poison_data_count: 370
Global model norm: 42.815944204525024.
Norm before scaling: 42.804606936637086. Distance: 1.4949826728811828
Total norm for 4 adversaries is: 42.804606936637086. distance: 1.4949826728811828
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2283, Accuracy: 9358/9900 (94.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4724/5066 (93.2491%), train_poison_data_count: 400
Global model norm: 42.815944204525024.
Norm before scaling: 42.80789493937567. Distance: 1.6928167298651249
Total norm for 4 adversaries is: 42.80789493937567. distance: 1.6928167298651249
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1380, Accuracy: 9555/9900 (96.5152%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5104/5582 (91.4368%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4924/5582 (88.2121%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2896, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4175/4647 (89.8429%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4212/4647 (90.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8862, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4061/4465 (90.9518%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4146/4465 (92.8555%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9320, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4490/5083 (88.3337%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4462/5083 (87.7828%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1168, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3952/4416 (89.4928%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4039/4416 (91.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9421, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4401/4956 (88.8015%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4382/4956 (88.4181%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0858, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3997/4362 (91.6323%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3909/4362 (89.6149%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0892, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3959/4356 (90.8861%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3520/4356 (80.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3836, Accuracy: 4773/10000 (47.7300%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3431/3781 (90.7432%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3291/3781 (87.0405%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1587, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3292/3590 (91.6992%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3147/3590 (87.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1967, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4181/4651 (89.8946%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4159/4651 (89.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9303, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4204/4662 (90.1759%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4211/4662 (90.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0869, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3156/3472 (90.8986%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3211/3472 (92.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9597, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4849/5424 (89.3990%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4941/5424 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3274, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2960/3271 (90.4922%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2962/3271 (90.5533%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9396, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4488/5037 (89.1007%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4526/5037 (89.8551%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9209, Accuracy: 5588/10000 (55.8800%)
time spent on training: 261.75263690948486
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 8, 18]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1545, Accuracy: 6968/10000 (69.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.1105, Accuracy: 7376/9900 (74.5051%)
Done in 291.06769728660583 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4619/4885 (94.5548%), train_poison_data_count: 385
Global model norm: 42.83849718209443.
Norm before scaling: 42.827289872375765. Distance: 1.5758041841637567
Total norm for 4 adversaries is: 42.827289872375765. distance: 1.5758041841637567
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1597, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4978/5305 (93.8360%), train_poison_data_count: 415
Global model norm: 42.83849718209443.
Norm before scaling: 42.82854683301927. Distance: 1.7066051379055038
Total norm for 4 adversaries is: 42.82854683301927. distance: 1.7066051379055038
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0905, Accuracy: 9674/9900 (97.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4429/4717 (93.8944%), train_poison_data_count: 370
Global model norm: 42.83849718209443.
Norm before scaling: 42.82796538642275. Distance: 1.5684514950958037
Total norm for 4 adversaries is: 42.82796538642275. distance: 1.5684514950958037
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1810, Accuracy: 9428/9900 (95.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4734/5066 (93.4465%), train_poison_data_count: 400
Global model norm: 42.83849718209443.
Norm before scaling: 42.82948596661023. Distance: 1.6734863074671114
Total norm for 4 adversaries is: 42.82948596661023. distance: 1.6734863074671114
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3618, Accuracy: 9034/9900 (91.2525%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4404/4989 (88.2742%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4427/4989 (88.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1213, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3606/4013 (89.8580%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3722/4013 (92.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8170, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4647/5195 (89.4514%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4477/5195 (86.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2111, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3620/3969 (91.2069%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3615/3969 (91.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9493, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3997/4356 (91.7585%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3883/4356 (89.1414%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1315, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4103/4441 (92.3891%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4130/4441 (92.9971%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9606, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4109/4518 (90.9473%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4141/4518 (91.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0006, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3581/3911 (91.5623%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3503/3911 (89.5679%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1185, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3995/4362 (91.5864%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4010/4362 (91.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9995, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3441/3804 (90.4574%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3506/3804 (92.1661%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0638, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3822/4223 (90.5044%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3921/4223 (92.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8428, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4158/4634 (89.7281%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4139/4634 (89.3181%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0328, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3935/4354 (90.3767%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0145, Accuracy: 3265/4354 (74.9885%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.9423, Accuracy: 4217/10000 (42.1700%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4554/5244 (86.8421%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4577/5244 (87.2807%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9475, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4507/5037 (89.4779%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4515/5037 (89.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0354, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3305/3704 (89.2279%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3352/3704 (90.4968%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9656, Accuracy: 5588/10000 (55.8800%)
time spent on training: 261.65219044685364
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 11 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [11, 17, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1611, Accuracy: 6935/10000 (69.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 1.0194, Accuracy: 7569/9900 (76.4545%)
Done in 291.6095886230469 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4630/4885 (94.7799%), train_poison_data_count: 385
Global model norm: 42.86011551492979.
Norm before scaling: 42.8464381336674. Distance: 1.5277744476205
Total norm for 4 adversaries is: 42.8464381336674. distance: 1.5277744476205
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2819, Accuracy: 9248/9900 (93.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4993/5305 (94.1188%), train_poison_data_count: 415
Global model norm: 42.86011551492979.
Norm before scaling: 42.84650366105223. Distance: 1.6363984661778601
Total norm for 4 adversaries is: 42.84650366105223. distance: 1.6363984661778601
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1002, Accuracy: 9644/9900 (97.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4434/4717 (94.0004%), train_poison_data_count: 370
Global model norm: 42.86011551492979.
Norm before scaling: 42.847114770315926. Distance: 1.5204573214360848
Total norm for 4 adversaries is: 42.847114770315926. distance: 1.5204573214360848
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1238, Accuracy: 9584/9900 (96.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4755/5066 (93.8610%), train_poison_data_count: 400
Global model norm: 42.86011551492979.
Norm before scaling: 42.850046264196145. Distance: 1.655215750170112
Total norm for 4 adversaries is: 42.850046264196145. distance: 1.655215750170112
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1079, Accuracy: 9617/9900 (97.1414%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3962/4416 (89.7192%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3975/4416 (90.0136%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0346, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4656/5197 (89.5901%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4548/5197 (87.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1460, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4458/4918 (90.6466%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4487/4918 (91.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9665, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5662/6263 (90.4040%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5655/6263 (90.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1792, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3292/3646 (90.2907%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3350/3646 (91.8815%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7964, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4229/4707 (89.8449%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4284/4707 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9752, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4479/5063 (88.4653%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4255/5063 (84.0411%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1150, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3884/4295 (90.4307%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3702/4295 (86.1932%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1487, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4309/4793 (89.9019%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4359/4793 (90.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9768, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4146/4538 (91.3618%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4211/4538 (92.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8566, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4548/5083 (89.4747%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4537/5083 (89.2583%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1137, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3247/3638 (89.2523%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3262/3638 (89.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0293, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5439/6124 (88.8145%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5427/6124 (88.6185%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1395, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4206/4618 (91.0784%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4134/4618 (89.5193%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1339, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3606/3969 (90.8541%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3570/3969 (89.9471%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0408, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3641/4158 (87.5661%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3668/4158 (88.2155%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9597, Accuracy: 5446/10000 (54.4600%)
time spent on training: 268.654292345047
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 18, 6]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1719, Accuracy: 6924/10000 (69.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.9059, Accuracy: 7810/9900 (78.8889%)
Done in 297.95945501327515 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4606/4885 (94.2886%), train_poison_data_count: 385
Global model norm: 42.88314341624005.
Norm before scaling: 42.870400229299385. Distance: 1.5558065862796484
Total norm for 4 adversaries is: 42.870400229299385. distance: 1.5558065862796484
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1652, Accuracy: 9526/9900 (96.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4998/5305 (94.2130%), train_poison_data_count: 415
Global model norm: 42.88314341624005.
Norm before scaling: 42.87232504638409. Distance: 1.6690012396230145
Total norm for 4 adversaries is: 42.87232504638409. distance: 1.6690012396230145
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1318, Accuracy: 9594/9900 (96.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4436/4717 (94.0428%), train_poison_data_count: 370
Global model norm: 42.88314341624005.
Norm before scaling: 42.87046144892483. Distance: 1.5329899147632606
Total norm for 4 adversaries is: 42.87046144892483. distance: 1.5329899147632606
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0675, Accuracy: 9714/9900 (98.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4746/5066 (93.6834%), train_poison_data_count: 400
Global model norm: 42.88314341624005.
Norm before scaling: 42.87695450401139. Distance: 1.6960262079553161
Total norm for 4 adversaries is: 42.87695450401139. distance: 1.6960262079553161
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2404, Accuracy: 9291/9900 (93.8485%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4211/4716 (89.2918%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4253/4716 (90.1824%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0008, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3984/4481 (88.9087%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3982/4481 (88.8641%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0595, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3930/4361 (90.1169%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3836/4361 (87.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1938, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4302/4793 (89.7559%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4376/4793 (91.2998%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9187, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3904/4295 (90.8964%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3850/4295 (89.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9744, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4608/5244 (87.8719%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4573/5244 (87.2044%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2187, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4387/4989 (87.9335%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4450/4989 (89.1962%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9466, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4636/5197 (89.2053%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4547/5197 (87.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0559, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3979/4356 (91.3453%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3552/4356 (81.5427%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.6081, Accuracy: 4499/10000 (44.9900%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4161/4647 (89.5416%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4264/4647 (91.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9002, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3631/4013 (90.4809%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3710/4013 (92.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8717, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4163/4538 (91.7364%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4196/4538 (92.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9402, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4246/4707 (90.2061%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4255/4707 (90.3973%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0120, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5671/6263 (90.5477%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5646/6263 (90.1485%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1394, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3932/4235 (92.8453%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3893/4235 (91.9244%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0029, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3516/3861 (91.0645%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3492/3861 (90.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1341, Accuracy: 5273/10000 (52.7300%)
time spent on training: 266.8499882221222
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 9, 13]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1764, Accuracy: 6923/10000 (69.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.8458, Accuracy: 7940/9900 (80.2020%)
Done in 296.2378034591675 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4637/4885 (94.9232%), train_poison_data_count: 385
Global model norm: 42.906498940920216.
Norm before scaling: 42.892590175835586. Distance: 1.5169687508248164
Total norm for 4 adversaries is: 42.892590175835586. distance: 1.5169687508248164
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0929, Accuracy: 9663/9900 (97.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5016/5305 (94.5523%), train_poison_data_count: 415
Global model norm: 42.906498940920216.
Norm before scaling: 42.89147597061099. Distance: 1.6056166532009228
Total norm for 4 adversaries is: 42.89147597061099. distance: 1.6056166532009228
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2031, Accuracy: 9403/9900 (94.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4452/4717 (94.3820%), train_poison_data_count: 370
Global model norm: 42.906498940920216.
Norm before scaling: 42.89350229419953. Distance: 1.5095390751909001
Total norm for 4 adversaries is: 42.89350229419953. distance: 1.5095390751909001
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1401, Accuracy: 9534/9900 (96.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4756/5066 (93.8808%), train_poison_data_count: 400
Global model norm: 42.906498940920216.
Norm before scaling: 42.89794165735111. Distance: 1.6770402496048076
Total norm for 4 adversaries is: 42.89794165735111. distance: 1.6770402496048076
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1038, Accuracy: 9626/9900 (97.2323%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4570/5055 (90.4055%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4559/5055 (90.1879%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9952, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3501/3828 (91.4577%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3570/3828 (93.2602%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8547, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3931/4361 (90.1399%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3714/4361 (85.1640%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2531, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3675/4013 (91.5774%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3692/4013 (92.0010%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8336, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4125/4518 (91.3015%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4151/4518 (91.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9233, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4125/4558 (90.5002%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3963/4558 (86.9460%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2113, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3737/4126 (90.5720%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3826/4126 (92.7290%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.7883, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4269/4679 (91.2374%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4277/4679 (91.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0932, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3854/4235 (91.0035%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3805/4235 (89.8465%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0911, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4531/5037 (89.9543%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4569/5037 (90.7088%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1215, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3282/3672 (89.3791%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3299/3672 (89.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1020, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4481/4928 (90.9294%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4493/4928 (91.1729%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8547, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3997/4356 (91.7585%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3650/4356 (83.7925%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.4585, Accuracy: 4890/10000 (48.9000%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4094/4456 (91.8761%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4130/4456 (92.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9075, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4317/4793 (90.0689%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4362/4793 (91.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9888, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4521/5025 (89.9701%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4529/5025 (90.1294%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1130, Accuracy: 5382/10000 (53.8200%)
time spent on training: 261.6745629310608
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 4, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1812, Accuracy: 6913/10000 (69.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.7638, Accuracy: 8139/9900 (82.2121%)
Done in 290.8672106266022 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4652/4885 (95.2303%), train_poison_data_count: 385
Global model norm: 42.92784558719215.
Norm before scaling: 42.91418125893817. Distance: 1.5248214304451762
Total norm for 4 adversaries is: 42.91418125893817. distance: 1.5248214304451762
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0839, Accuracy: 9677/9900 (97.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4983/5305 (93.9303%), train_poison_data_count: 415
Global model norm: 42.92784558719215.
Norm before scaling: 42.91672987454892. Distance: 1.67897231378954
Total norm for 4 adversaries is: 42.91672987454892. distance: 1.67897231378954
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1712, Accuracy: 9483/9900 (95.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4477/4717 (94.9120%), train_poison_data_count: 370
Global model norm: 42.92784558719215.
Norm before scaling: 42.91275897460451. Distance: 1.4271355037016995
Total norm for 4 adversaries is: 42.91275897460451. distance: 1.4271355037016995
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2314, Accuracy: 9325/9900 (94.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4753/5066 (93.8216%), train_poison_data_count: 400
Global model norm: 42.92784558719215.
Norm before scaling: 42.91757037251396. Distance: 1.6380076284032983
Total norm for 4 adversaries is: 42.91757037251396. distance: 1.6380076284032983
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2252, Accuracy: 9320/9900 (94.1414%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4010/4346 (92.2688%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4046/4346 (93.0971%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8732, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3782/4184 (90.3920%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3802/4184 (90.8700%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8525, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4020/4356 (92.2865%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3626/4356 (83.2415%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1979, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3302/3646 (90.5650%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3346/3646 (91.7718%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9156, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4606/5083 (90.6158%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4527/5083 (89.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9126, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3973/4356 (91.2075%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4016/4356 (92.1947%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0732, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4090/4558 (89.7323%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4113/4558 (90.2369%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0179, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3735/4175 (89.4611%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3597/4175 (86.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0241, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3189/3472 (91.8491%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3148/3472 (90.6682%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0593, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4033/4501 (89.6023%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4080/4501 (90.6465%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9793, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4889/5424 (90.1364%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4975/5424 (91.7220%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1005, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4029/4481 (89.9130%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3920/4481 (87.4805%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1968, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4943/5455 (90.6141%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4940/5455 (90.5591%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0601, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4614/5232 (88.1881%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4645/5232 (88.7806%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9429, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5645/6391 (88.3273%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5571/6391 (87.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1053, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3448/3775 (91.3377%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3537/3775 (93.6954%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8437, Accuracy: 5698/10000 (56.9800%)
time spent on training: 265.9340696334839
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 7, 18]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1816, Accuracy: 6901/10000 (69.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.7132, Accuracy: 8246/9900 (83.2929%)
Done in 294.87527227401733 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4613/4885 (94.4319%), train_poison_data_count: 385
Global model norm: 42.949902116266514.
Norm before scaling: 42.93543168462747. Distance: 1.5550360360830375
Total norm for 4 adversaries is: 42.93543168462747. distance: 1.5550360360830375
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1143, Accuracy: 9622/9900 (97.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4978/5305 (93.8360%), train_poison_data_count: 415
Global model norm: 42.949902116266514.
Norm before scaling: 42.93606142968577. Distance: 1.6361558624534658
Total norm for 4 adversaries is: 42.93606142968577. distance: 1.6361558624534658
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.3151, Accuracy: 9124/9900 (92.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4465/4717 (94.6576%), train_poison_data_count: 370
Global model norm: 42.949902116266514.
Norm before scaling: 42.93477634192648. Distance: 1.455733716089809
Total norm for 4 adversaries is: 42.93477634192648. distance: 1.455733716089809
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1968, Accuracy: 9409/9900 (95.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4769/5066 (94.1374%), train_poison_data_count: 400
Global model norm: 42.949902116266514.
Norm before scaling: 42.938516352145164. Distance: 1.6413366318418288
Total norm for 4 adversaries is: 42.938516352145164. distance: 1.6413366318418288
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0888, Accuracy: 9655/9900 (97.5253%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3674/4025 (91.2795%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3798/4025 (94.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7843, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3859/4223 (91.3805%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3910/4223 (92.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8827, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3249/3638 (89.3073%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3309/3638 (90.9566%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8174, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4441/5063 (87.7148%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4355/5063 (86.0162%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3117, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4362/4874 (89.4953%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4245/4874 (87.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3942, Accuracy: 4927/10000 (49.2700%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4310/4804 (89.7169%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4340/4804 (90.3414%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1035, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3635/4158 (87.4218%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3678/4158 (88.4560%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9238, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4143/4518 (91.6999%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4150/4518 (91.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9834, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3861/4235 (91.1688%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3790/4235 (89.4923%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9579, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4385/4934 (88.8731%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4250/4934 (86.1370%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2573, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5648/6391 (88.3743%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5558/6391 (86.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2616, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3918/4295 (91.2224%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3844/4295 (89.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8523, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3488/3756 (92.8647%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3530/3756 (93.9830%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9536, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3953/4481 (88.2169%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3994/4481 (89.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1262, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3753/4175 (89.8922%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3714/4175 (88.9581%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9460, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3282/3590 (91.4206%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3176/3590 (88.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2346, Accuracy: 5168/10000 (51.6800%)
time spent on training: 263.0776205062866
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [12, 4, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1803, Accuracy: 6913/10000 (69.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.6504, Accuracy: 8374/9900 (84.5859%)
Done in 291.8324484825134 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4611/4885 (94.3910%), train_poison_data_count: 385
Global model norm: 42.97274129190067.
Norm before scaling: 42.96109306777616. Distance: 1.5601234673277897
Total norm for 4 adversaries is: 42.96109306777616. distance: 1.5601234673277897
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0843, Accuracy: 9676/9900 (97.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5013/5305 (94.4958%), train_poison_data_count: 415
Global model norm: 42.97274129190067.
Norm before scaling: 42.96000621262831. Distance: 1.6553057011973662
Total norm for 4 adversaries is: 42.96000621262831. distance: 1.6553057011973662
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1219, Accuracy: 9593/9900 (96.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4478/4717 (94.9332%), train_poison_data_count: 370
Global model norm: 42.97274129190067.
Norm before scaling: 42.955915696902274. Distance: 1.4307917098558363
Total norm for 4 adversaries is: 42.955915696902274. distance: 1.4307917098558363
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0944, Accuracy: 9661/9900 (97.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4777/5066 (94.2953%), train_poison_data_count: 400
Global model norm: 42.97274129190067.
Norm before scaling: 42.96029036041961. Distance: 1.5883129351261092
Total norm for 4 adversaries is: 42.96029036041961. distance: 1.5883129351261092
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0972, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3473/3828 (90.7262%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3571/3828 (93.2863%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8971, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3579/3911 (91.5111%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3463/3911 (88.5451%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2233, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4040/4362 (92.6181%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4082/4362 (93.5809%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9131, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4672/5197 (89.8980%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4656/5197 (89.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1430, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4320/4679 (92.3274%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4132/4679 (88.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1487, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4376/4793 (91.2998%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4401/4793 (91.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8946, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4556/5116 (89.0539%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4554/5116 (89.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9757, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4070/4625 (88.0000%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3986/4625 (86.1838%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1234, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4185/4618 (90.6236%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4089/4618 (88.5448%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1738, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2924/3271 (89.3916%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0058, Accuracy: 2915/3271 (89.1165%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0208, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3767/4175 (90.2275%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3764/4175 (90.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0737, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3227/3616 (89.2423%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3287/3616 (90.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8087, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3990/4481 (89.0426%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3980/4481 (88.8195%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1475, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3941/4368 (90.2244%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3822/4368 (87.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0219, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5188/5740 (90.3833%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5151/5740 (89.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1596, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4211/4647 (90.6176%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4210/4647 (90.5961%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8437, Accuracy: 5723/10000 (57.2300%)
time spent on training: 263.5873625278473
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [18, 4, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1773, Accuracy: 6905/10000 (69.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.5939, Accuracy: 8486/9900 (85.7172%)
Done in 292.6640512943268 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4627/4885 (94.7185%), train_poison_data_count: 385
Global model norm: 42.99509419689647.
Norm before scaling: 42.979869299929966. Distance: 1.5267679441305444
Total norm for 4 adversaries is: 42.979869299929966. distance: 1.5267679441305444
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0375, Accuracy: 9796/9900 (98.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4995/5305 (94.1565%), train_poison_data_count: 415
Global model norm: 42.99509419689647.
Norm before scaling: 42.981228301761284. Distance: 1.6514842004900876
Total norm for 4 adversaries is: 42.981228301761284. distance: 1.6514842004900876
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1245, Accuracy: 9587/9900 (96.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4460/4717 (94.5516%), train_poison_data_count: 370
Global model norm: 42.99509419689647.
Norm before scaling: 42.98022574030411. Distance: 1.4810288308407005
Total norm for 4 adversaries is: 42.98022574030411. distance: 1.4810288308407005
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0077, Accuracy: 9875/9900 (99.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4775/5066 (94.2558%), train_poison_data_count: 400
Global model norm: 42.99509419689647.
Norm before scaling: 42.98302319757331. Distance: 1.6114010696083734
Total norm for 4 adversaries is: 42.98302319757331. distance: 1.6114010696083734
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1287, Accuracy: 9571/9900 (96.6768%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4998/5591 (89.3937%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4888/5591 (87.4262%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1525, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4448/4956 (89.7498%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4489/4956 (90.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0928, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4059/4511 (89.9800%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4053/4511 (89.8470%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0470, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3657/4013 (91.1288%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3701/4013 (92.2253%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8315, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3256/3590 (90.6964%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3122/3590 (86.9638%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1252, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4337/4793 (90.4861%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4410/4793 (92.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0656, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3479/3804 (91.4564%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3484/3804 (91.5878%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8356, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3492/3837 (91.0086%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8138, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3953/4361 (90.6443%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3820/4361 (87.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3750, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4556/5063 (89.9862%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4434/5063 (87.5765%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0748, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3957/4368 (90.5907%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3940/4368 (90.2015%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0663, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4282/4679 (91.5153%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4341/4679 (92.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0623, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4665/5265 (88.6040%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4651/5265 (88.3381%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1530, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4248/4767 (89.1126%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4196/4767 (88.0218%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1424, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5209/5902 (88.2582%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5100/5902 (86.4114%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0960, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3854/4223 (91.2621%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3909/4223 (92.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9227, Accuracy: 5507/10000 (55.0700%)
time spent on training: 266.23274302482605
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 19 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 19, 7]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1830, Accuracy: 6904/10000 (69.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.5167, Accuracy: 8646/9900 (87.3333%)
Done in 295.47217774391174 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4665/4885 (95.4964%), train_poison_data_count: 385
Global model norm: 43.018496771192794.
Norm before scaling: 43.00266843101135. Distance: 1.478039280541078
Total norm for 4 adversaries is: 43.00266843101135. distance: 1.478039280541078
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0632, Accuracy: 9733/9900 (98.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5046/5305 (95.1178%), train_poison_data_count: 415
Global model norm: 43.018496771192794.
Norm before scaling: 43.00140946318286. Distance: 1.5559262655189319
Total norm for 4 adversaries is: 43.00140946318286. distance: 1.5559262655189319
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0920, Accuracy: 9661/9900 (97.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4453/4717 (94.4032%), train_poison_data_count: 370
Global model norm: 43.018496771192794.
Norm before scaling: 43.00422257383207. Distance: 1.4718359324459995
Total norm for 4 adversaries is: 43.00422257383207. distance: 1.4718359324459995
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2390, Accuracy: 9306/9900 (94.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4782/5066 (94.3940%), train_poison_data_count: 400
Global model norm: 43.018496771192794.
Norm before scaling: 43.008612191702376. Distance: 1.615285076927749
Total norm for 4 adversaries is: 43.008612191702376. distance: 1.615285076927749
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1455, Accuracy: 9532/9900 (96.2828%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3465/3797 (91.2563%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3484/3797 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8851, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3538/3861 (91.6343%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3533/3861 (91.5048%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9287, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4318/4707 (91.7357%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4274/4707 (90.8009%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9238, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4144/4518 (91.7220%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4101/4518 (90.7703%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0148, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3657/4013 (91.1288%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3743/4013 (93.2719%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8322, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4664/5167 (90.2651%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4669/5167 (90.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1822, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3567/3969 (89.8715%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3614/3969 (91.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0334, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4055/4441 (91.3083%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4054/4441 (91.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1421, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4130/4558 (90.6099%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4032/4558 (88.4599%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0801, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4098/4465 (91.7805%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4114/4465 (92.1389%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9382, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3202/3638 (88.0154%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3346/3638 (91.9736%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7986, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4161/4538 (91.6924%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4188/4538 (92.2874%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8706, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5142/5740 (89.5819%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5196/5740 (90.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0607, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3507/3837 (91.3995%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3560/3837 (92.7808%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7416, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3946/4361 (90.4838%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3849/4361 (88.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1632, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4400/4793 (91.8005%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4362/4793 (91.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1216, Accuracy: 5329/10000 (53.2900%)
time spent on training: 261.34916281700134
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 14, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1855, Accuracy: 6896/10000 (68.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.4711, Accuracy: 8744/9900 (88.3232%)
Done in 291.3000431060791 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4677/4885 (95.7421%), train_poison_data_count: 385
Global model norm: 43.03867322046679.
Norm before scaling: 43.02309773222475. Distance: 1.463054571399865
Total norm for 4 adversaries is: 43.02309773222475. distance: 1.463054571399865
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2294, Accuracy: 9333/9900 (94.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5036/5305 (94.9293%), train_poison_data_count: 415
Global model norm: 43.03867322046679.
Norm before scaling: 43.020409287155495. Distance: 1.5573226602419383
Total norm for 4 adversaries is: 43.020409287155495. distance: 1.5573226602419383
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0596, Accuracy: 9733/9900 (98.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4490/4717 (95.1876%), train_poison_data_count: 370
Global model norm: 43.03867322046679.
Norm before scaling: 43.022157150233355. Distance: 1.4176008940082512
Total norm for 4 adversaries is: 43.022157150233355. distance: 1.4176008940082512
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0587, Accuracy: 9738/9900 (98.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4763/5066 (94.0189%), train_poison_data_count: 400
Global model norm: 43.03867322046679.
Norm before scaling: 43.02815921407239. Distance: 1.6337000428714339
Total norm for 4 adversaries is: 43.02815921407239. distance: 1.6337000428714339
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0964, Accuracy: 9644/9900 (97.4141%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4253/4767 (89.2175%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4243/4767 (89.0078%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3075, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4121/4441 (92.7944%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4167/4441 (93.8302%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9347, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4031/4356 (92.5390%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3726/4356 (85.5372%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2063, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5666/6391 (88.6559%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5502/6391 (86.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1982, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3801/4184 (90.8461%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3814/4184 (91.1568%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8637, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4033/4346 (92.7980%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4055/4346 (93.3042%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8213, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4493/5037 (89.1999%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4575/5037 (90.8279%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0177, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4223/4634 (91.1308%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4231/4634 (91.3034%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8904, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4370/4934 (88.5691%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4339/4934 (87.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0221, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4909/5424 (90.5052%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4917/5424 (90.6527%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2592, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3498/3781 (92.5152%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3471/3781 (91.8011%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1142, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3491/3861 (90.4170%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3480/3861 (90.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0472, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4646/5055 (91.9090%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4666/5055 (92.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0102, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4087/4433 (92.1949%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4064/4433 (91.6761%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9017, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4676/5167 (90.4974%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4655/5167 (90.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1767, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3312/3590 (92.2563%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3057/3590 (85.1532%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1245, Accuracy: 5267/10000 (52.6700%)
time spent on training: 267.9006085395813
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 19 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [10, 19, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1791, Accuracy: 6912/10000 (69.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.4460, Accuracy: 8787/9900 (88.7576%)
Done in 297.09438371658325 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4659/4885 (95.3736%), train_poison_data_count: 385
Global model norm: 43.061050014140534.
Norm before scaling: 43.04349606747734. Distance: 1.450021279935234
Total norm for 4 adversaries is: 43.04349606747734. distance: 1.450021279935234
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1614, Accuracy: 9490/9900 (95.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5031/5305 (94.8351%), train_poison_data_count: 415
Global model norm: 43.061050014140534.
Norm before scaling: 43.04533941226608. Distance: 1.5795339960664392
Total norm for 4 adversaries is: 43.04533941226608. distance: 1.5795339960664392
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1035, Accuracy: 9632/9900 (97.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4471/4717 (94.7848%), train_poison_data_count: 370
Global model norm: 43.061050014140534.
Norm before scaling: 43.04221276930503. Distance: 1.3861692387520812
Total norm for 4 adversaries is: 43.04221276930503. distance: 1.3861692387520812
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0908, Accuracy: 9661/9900 (97.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4810/5066 (94.9467%), train_poison_data_count: 400
Global model norm: 43.061050014140534.
Norm before scaling: 43.04664530337991. Distance: 1.5331355572044263
Total norm for 4 adversaries is: 43.04664530337991. distance: 1.5331355572044263
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0471, Accuracy: 9762/9900 (98.6061%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3955/4368 (90.5449%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3892/4368 (89.1026%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0638, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3479/3828 (90.8830%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3521/3828 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8376, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4053/4356 (93.0441%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3844/4356 (88.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1629, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3494/3861 (90.4947%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3470/3861 (89.8731%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0648, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3177/3472 (91.5035%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3197/3472 (92.0795%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9158, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4140/4538 (91.2296%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4195/4538 (92.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9396, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4905/5392 (90.9681%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4828/5392 (89.5401%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0836, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3911/4295 (91.0594%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3827/4295 (89.1036%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9945, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3853/4235 (90.9799%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3847/4235 (90.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1510, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4108/4456 (92.1903%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4128/4456 (92.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0209, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4736/5265 (89.9525%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4613/5265 (87.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0060, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4110/4441 (92.5467%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4172/4441 (93.9428%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0439, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3708/4013 (92.3997%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3743/4013 (93.2719%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7936, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4073/4465 (91.2206%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4089/4465 (91.5789%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0889, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5648/6263 (90.1804%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5629/6263 (89.8771%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0026, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4517/4986 (90.5937%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4547/4986 (91.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0007, Accuracy: 5576/10000 (55.7600%)
time spent on training: 264.52763175964355
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [8, 6, 10]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1768, Accuracy: 6929/10000 (69.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.4275, Accuracy: 8820/9900 (89.0909%)
Done in 293.71135997772217 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4661/4885 (95.4145%), train_poison_data_count: 385
Global model norm: 43.08189648434131.
Norm before scaling: 43.065748471450604. Distance: 1.479241015576054
Total norm for 4 adversaries is: 43.065748471450604. distance: 1.479241015576054
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2074, Accuracy: 9377/9900 (94.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5024/5305 (94.7031%), train_poison_data_count: 415
Global model norm: 43.08189648434131.
Norm before scaling: 43.064847087706. Distance: 1.5968475906796795
Total norm for 4 adversaries is: 43.064847087706. distance: 1.5968475906796795
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1955, Accuracy: 9426/9900 (95.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4497/4717 (95.3360%), train_poison_data_count: 370
Global model norm: 43.08189648434131.
Norm before scaling: 43.06123002481466. Distance: 1.3572333554877267
Total norm for 4 adversaries is: 43.06123002481466. distance: 1.3572333554877267
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0873, Accuracy: 9681/9900 (97.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4781/5066 (94.3743%), train_poison_data_count: 400
Global model norm: 43.08189648434131.
Norm before scaling: 43.06927870947791. Distance: 1.5698666675102588
Total norm for 4 adversaries is: 43.06927870947791. distance: 1.5698666675102588
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0761, Accuracy: 9711/9900 (98.0909%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3633/4158 (87.3737%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3730/4158 (89.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9259, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4658/5167 (90.1490%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4638/5167 (89.7620%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1895, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3553/3828 (92.8161%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3573/3828 (93.3386%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9092, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4277/4663 (91.7221%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4275/4663 (91.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9619, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4077/4433 (91.9693%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4047/4433 (91.2926%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8673, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3827/4184 (91.4675%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3833/4184 (91.6109%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8467, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4189/4716 (88.8253%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4226/4716 (89.6098%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2385, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3842/4223 (90.9780%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3961/4223 (93.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9051, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4245/4679 (90.7245%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4061/4679 (86.7920%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1739, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3377/3704 (91.1717%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3425/3704 (92.4676%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9406, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3512/3837 (91.5298%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3553/3837 (92.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9354, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3510/3861 (90.9091%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3522/3861 (91.2199%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8739, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4933/5424 (90.9476%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4932/5424 (90.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2741, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4167/4576 (91.0621%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4211/4576 (92.0236%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9798, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3669/4025 (91.1553%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3804/4025 (94.5093%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8002, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3477/3775 (92.1060%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3503/3775 (92.7947%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8346, Accuracy: 5792/10000 (57.9200%)
time spent on training: 261.34894347190857
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 11 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [11, 10, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1760, Accuracy: 6917/10000 (69.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.4177, Accuracy: 8858/9900 (89.4747%)
Done in 291.10542917251587 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4691/4885 (96.0287%), train_poison_data_count: 385
Global model norm: 43.10170056734276.
Norm before scaling: 43.08380618595286. Distance: 1.4401293218346012
Total norm for 4 adversaries is: 43.08380618595286. distance: 1.4401293218346012
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1351, Accuracy: 9556/9900 (96.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5033/5305 (94.8728%), train_poison_data_count: 415
Global model norm: 43.10170056734276.
Norm before scaling: 43.08458250929211. Distance: 1.5685200496093799
Total norm for 4 adversaries is: 43.08458250929211. distance: 1.5685200496093799
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0989, Accuracy: 9640/9900 (97.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4495/4717 (95.2936%), train_poison_data_count: 370
Global model norm: 43.10170056734276.
Norm before scaling: 43.08215432733576. Distance: 1.3818642765010385
Total norm for 4 adversaries is: 43.08215432733576. distance: 1.3818642765010385
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0356, Accuracy: 9805/9900 (99.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4775/5066 (94.2558%), train_poison_data_count: 400
Global model norm: 43.10170056734276.
Norm before scaling: 43.0888747015616. Distance: 1.6172144053704265
Total norm for 4 adversaries is: 43.0888747015616. distance: 1.6172144053704265
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0545, Accuracy: 9750/9900 (98.4848%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4208/4576 (91.9580%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4182/4576 (91.3899%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0082, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3356/3672 (91.3943%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3362/3672 (91.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8696, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4288/4618 (92.8540%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4201/4618 (90.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0055, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4177/4538 (92.0450%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4224/4538 (93.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8742, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4530/5025 (90.1493%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4633/5025 (92.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0575, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3326/3590 (92.6462%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3386/3590 (94.3175%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8956, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4316/4707 (91.6932%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4268/4707 (90.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0357, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4505/4918 (91.6023%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4485/4918 (91.1956%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2305, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3925/4336 (90.5212%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3927/4336 (90.5673%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1480, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5236/5902 (88.7157%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5052/5902 (85.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3517, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4172/4441 (93.9428%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4164/4441 (93.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9894, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4679/5232 (89.4304%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4684/5232 (89.5260%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1037, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4384/4804 (91.2573%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4124/4804 (85.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3308, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3680/3969 (92.7186%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3617/3969 (91.1313%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8746, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4899/5392 (90.8568%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4861/5392 (90.1521%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1863, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3537/3828 (92.3981%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3572/3828 (93.3124%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.7759, Accuracy: 5834/10000 (58.3400%)
time spent on training: 265.8483693599701
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [9, 4, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1801, Accuracy: 6905/10000 (69.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.3975, Accuracy: 8900/9900 (89.8990%)
Done in 294.97828793525696 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4699/4885 (96.1924%), train_poison_data_count: 385
Global model norm: 43.12347144030151.
Norm before scaling: 43.10389542467421. Distance: 1.4156543349706578
Total norm for 4 adversaries is: 43.10389542467421. distance: 1.4156543349706578
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1120, Accuracy: 9611/9900 (97.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5050/5305 (95.1932%), train_poison_data_count: 415
Global model norm: 43.12347144030151.
Norm before scaling: 43.10293536534809. Distance: 1.5153249069904868
Total norm for 4 adversaries is: 43.10293536534809. distance: 1.5153249069904868
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0629, Accuracy: 9732/9900 (98.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4481/4717 (94.9968%), train_poison_data_count: 370
Global model norm: 43.12347144030151.
Norm before scaling: 43.105689460524665. Distance: 1.4370678791215399
Total norm for 4 adversaries is: 43.105689460524665. distance: 1.4370678791215399
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0394, Accuracy: 9791/9900 (98.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4810/5066 (94.9467%), train_poison_data_count: 400
Global model norm: 43.12347144030151.
Norm before scaling: 43.10476767242517. Distance: 1.5290644872275545
Total norm for 4 adversaries is: 43.10476767242517. distance: 1.5290644872275545
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0406, Accuracy: 9781/9900 (98.7980%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4681/5232 (89.4687%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4671/5232 (89.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0439, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4407/4956 (88.9225%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4401/4956 (88.8015%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1953, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4512/5063 (89.1171%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4498/5063 (88.8406%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1127, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3744/4025 (93.0186%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3746/4025 (93.0683%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8042, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4127/4441 (92.9295%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4097/4441 (92.2540%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1740, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4139/4625 (89.4919%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4156/4625 (89.8595%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9209, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4969/5591 (88.8750%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4958/5591 (88.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2918, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5149/5582 (92.2429%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5124/5582 (91.7951%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1763, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5233/5902 (88.6649%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5124/5902 (86.8180%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2367, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4165/4538 (91.7805%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4221/4538 (93.0145%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8919, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4537/5025 (90.2886%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4512/5025 (89.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1288, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3867/4223 (91.5700%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3938/4223 (93.2512%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9859, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4002/4361 (91.7679%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3851/4361 (88.3054%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9435, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3922/4354 (90.0781%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0127, Accuracy: 3375/4354 (77.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.5970, Accuracy: 4613/10000 (46.1300%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3338/3672 (90.9041%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3338/3672 (90.9041%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8932, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4000/4356 (91.8274%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3786/4356 (86.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3734, Accuracy: 4929/10000 (49.2900%)
time spent on training: 266.0675127506256
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 15, 4]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1906, Accuracy: 6898/10000 (68.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.3591, Accuracy: 8989/9900 (90.7980%)
Done in 295.22386503219604 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4687/4885 (95.9468%), train_poison_data_count: 385
Global model norm: 43.14726129462405.
Norm before scaling: 43.13015141333844. Distance: 1.4129714128527595
Total norm for 4 adversaries is: 43.13015141333844. distance: 1.4129714128527595
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0711, Accuracy: 9710/9900 (98.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5032/5305 (94.8539%), train_poison_data_count: 415
Global model norm: 43.14726129462405.
Norm before scaling: 43.129514596119385. Distance: 1.556440582249055
Total norm for 4 adversaries is: 43.129514596119385. distance: 1.556440582249055
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1105, Accuracy: 9610/9900 (97.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4506/4717 (95.5268%), train_poison_data_count: 370
Global model norm: 43.14726129462405.
Norm before scaling: 43.128018746246184. Distance: 1.3661733735314583
Total norm for 4 adversaries is: 43.128018746246184. distance: 1.3661733735314583
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0609, Accuracy: 9729/9900 (98.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4819/5066 (95.1244%), train_poison_data_count: 400
Global model norm: 43.14726129462405.
Norm before scaling: 43.13246793355398. Distance: 1.5170159004197896
Total norm for 4 adversaries is: 43.13246793355398. distance: 1.5170159004197896
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1695, Accuracy: 9475/9900 (95.7071%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3530/3828 (92.2153%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3577/3828 (93.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7661, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3909/4235 (92.3022%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3802/4235 (89.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1957, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3350/3704 (90.4428%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3407/3704 (91.9816%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8803, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3726/4046 (92.0910%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3673/4046 (90.7810%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9718, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4514/4928 (91.5990%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4502/4928 (91.3555%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9753, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5192/5740 (90.4530%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5155/5740 (89.8084%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2109, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4564/5083 (89.7895%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4525/5083 (89.0222%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3010, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4149/4576 (90.6687%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4160/4576 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0462, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4253/4647 (91.5214%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4256/4647 (91.5860%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1437, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4951/5424 (91.2795%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4965/5424 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3746, Accuracy: 4933/10000 (49.3300%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4137/4503 (91.8721%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4053/4503 (90.0067%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0434, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5689/6391 (89.0158%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5532/6391 (86.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3393, Accuracy: 4908/10000 (49.0800%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4071/4511 (90.2461%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4133/4511 (91.6205%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9934, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4145/4456 (93.0206%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4173/4456 (93.6490%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9415, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4353/4804 (90.6120%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4195/4804 (87.3231%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3086, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3472/3804 (91.2723%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3559/3804 (93.5594%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8214, Accuracy: 5747/10000 (57.4700%)
time spent on training: 268.5842077732086
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [5, 16, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1919, Accuracy: 6894/10000 (68.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.3421, Accuracy: 9017/9900 (91.0808%)
Done in 297.83719396591187 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4698/4885 (96.1720%), train_poison_data_count: 385
Global model norm: 43.1688225599325.
Norm before scaling: 43.14818076037143. Distance: 1.3829285739954216
Total norm for 4 adversaries is: 43.14818076037143. distance: 1.3829285739954216
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1971, Accuracy: 9406/9900 (95.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5040/5305 (95.0047%), train_poison_data_count: 415
Global model norm: 43.1688225599325.
Norm before scaling: 43.14935481892009. Distance: 1.514822442631342
Total norm for 4 adversaries is: 43.14935481892009. distance: 1.514822442631342
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0726, Accuracy: 9706/9900 (98.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4493/4717 (95.2512%), train_poison_data_count: 370
Global model norm: 43.1688225599325.
Norm before scaling: 43.15029687171558. Distance: 1.420038063721178
Total norm for 4 adversaries is: 43.15029687171558. distance: 1.420038063721178
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0769, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4806/5066 (94.8677%), train_poison_data_count: 400
Global model norm: 43.1688225599325.
Norm before scaling: 43.151922076614966. Distance: 1.516475478198234
Total norm for 4 adversaries is: 43.151922076614966. distance: 1.516475478198234
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0917, Accuracy: 9658/9900 (97.5556%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4525/4928 (91.8222%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4464/4928 (90.5844%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9204, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4530/5037 (89.9345%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4557/5037 (90.4705%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0294, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4984/5392 (92.4332%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4774/5392 (88.5386%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1465, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4111/4501 (91.3353%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4022/4501 (89.3579%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1676, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3452/3804 (90.7466%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3520/3804 (92.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9671, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3535/3837 (92.1293%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3549/3837 (92.4941%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8179, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4537/5063 (89.6109%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4432/5063 (87.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1834, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4070/4481 (90.8279%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3967/4481 (88.5293%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2004, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4111/4518 (90.9916%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4139/4518 (91.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8987, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3281/3638 (90.1869%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3358/3638 (92.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8817, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4268/4663 (91.5291%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4283/4663 (91.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0265, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4111/4625 (88.8865%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4074/4625 (88.0865%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1613, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4758/5197 (91.5528%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4541/5197 (87.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0273, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4575/5083 (90.0059%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4484/5083 (88.2156%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1618, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3575/3828 (93.3908%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3578/3828 (93.4692%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9259, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3359/3704 (90.6857%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3381/3704 (91.2797%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8813, Accuracy: 5716/10000 (57.1600%)
time spent on training: 265.3032944202423
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 4 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [4, 8, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1921, Accuracy: 6896/10000 (68.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.3258, Accuracy: 9053/9900 (91.4444%)
Done in 294.6127552986145 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4669/4885 (95.5783%), train_poison_data_count: 385
Global model norm: 43.19029816369355.
Norm before scaling: 43.172296301780726. Distance: 1.4424966962171568
Total norm for 4 adversaries is: 43.172296301780726. distance: 1.4424966962171568
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1440, Accuracy: 9545/9900 (96.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5037/5305 (94.9482%), train_poison_data_count: 415
Global model norm: 43.19029816369355.
Norm before scaling: 43.16875469406012. Distance: 1.522051997926914
Total norm for 4 adversaries is: 43.16875469406012. distance: 1.522051997926914
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0418, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4509/4717 (95.5904%), train_poison_data_count: 370
Global model norm: 43.19029816369355.
Norm before scaling: 43.17030851302056. Distance: 1.3610670586461615
Total norm for 4 adversaries is: 43.17030851302056. distance: 1.3610670586461615
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1044, Accuracy: 9623/9900 (97.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4830/5066 (95.3415%), train_poison_data_count: 400
Global model norm: 43.19029816369355.
Norm before scaling: 43.17536828746007. Distance: 1.5327963514187022
Total norm for 4 adversaries is: 43.17536828746007. distance: 1.5327963514187022
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1077, Accuracy: 9626/9900 (97.2323%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3561/3861 (92.2300%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3534/3861 (91.5307%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8868, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3808/4184 (91.0134%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3762/4184 (89.9140%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8505, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4513/5037 (89.5970%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4548/5037 (90.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9137, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4750/5197 (91.3989%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4685/5197 (90.1482%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1375, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4603/5025 (91.6020%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4604/5025 (91.6219%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1110, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4647/5116 (90.8327%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4556/5116 (89.0539%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1129, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4046/4481 (90.2923%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3974/4481 (88.6856%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1089, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4246/4576 (92.7885%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4212/4576 (92.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8091, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4710/5232 (90.0229%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4680/5232 (89.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0112, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3937/4354 (90.4226%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3815/4354 (87.6206%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2792, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2947/3271 (90.0948%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0072, Accuracy: 2815/3271 (86.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1438, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4950/5455 (90.7424%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4905/5455 (89.9175%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0080, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3793/4126 (91.9292%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3811/4126 (92.3655%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9061, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3514/3797 (92.5467%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3478/3797 (91.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9756, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3394/3704 (91.6307%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3409/3704 (92.0356%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9041, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4393/4934 (89.0353%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3957/4934 (80.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2495, Accuracy: 4942/10000 (49.4200%)
time spent on training: 262.9908986091614
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 11, 16]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.2000, Accuracy: 6881/10000 (68.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.3118, Accuracy: 9077/9900 (91.6869%)
Done in 292.28090620040894 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4669/4885 (95.5783%), train_poison_data_count: 385
Global model norm: 43.21245660975548.
Norm before scaling: 43.193658546965835. Distance: 1.419799547553726
Total norm for 4 adversaries is: 43.193658546965835. distance: 1.419799547553726
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1428, Accuracy: 9532/9900 (96.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5072/5305 (95.6079%), train_poison_data_count: 415
Global model norm: 43.21245660975548.
Norm before scaling: 43.191743810576085. Distance: 1.4557229885272756
Total norm for 4 adversaries is: 43.191743810576085. distance: 1.4557229885272756
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1789, Accuracy: 9458/9900 (95.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4502/4717 (95.4420%), train_poison_data_count: 370
Global model norm: 43.21245660975548.
Norm before scaling: 43.191102248918845. Distance: 1.3590774648986708
Total norm for 4 adversaries is: 43.191102248918845. distance: 1.3590774648986708
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0588, Accuracy: 9744/9900 (98.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4841/5066 (95.5586%), train_poison_data_count: 400
Global model norm: 43.21245660975548.
Norm before scaling: 43.1911969293223. Distance: 1.4325231561570044
Total norm for 4 adversaries is: 43.1911969293223. distance: 1.4325231561570044
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0591, Accuracy: 9740/9900 (98.3838%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4262/4618 (92.2910%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4135/4618 (89.5409%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0952, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4161/4625 (89.9676%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4052/4625 (87.6108%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2951, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5168/5740 (90.0348%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5152/5740 (89.7561%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2020, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3992/4416 (90.3986%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3999/4416 (90.5571%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0331, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3757/4126 (91.0567%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3820/4126 (92.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8188, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3242/3616 (89.6571%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3313/3616 (91.6206%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8175, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3680/4158 (88.5041%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3676/4158 (88.4079%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9937, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4054/4346 (93.2812%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4080/4346 (93.8794%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7976, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4412/4874 (90.5211%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4364/4874 (89.5363%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1994, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4681/5265 (88.9079%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4680/5265 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1213, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3714/4025 (92.2733%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3739/4025 (92.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8215, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4225/4651 (90.8407%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4242/4651 (91.2062%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0981, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3545/3837 (92.3899%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3575/3837 (93.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8210, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3289/3638 (90.4068%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3337/3638 (91.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8314, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3193/3472 (91.9643%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3233/3472 (93.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9240, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4140/4456 (92.9084%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4136/4456 (92.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8541, Accuracy: 5763/10000 (57.6300%)
time spent on training: 260.71081352233887
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 17 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [17, 18, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1953, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.3129, Accuracy: 9076/9900 (91.6768%)
Done in 289.98533821105957 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4701/4885 (96.2334%), train_poison_data_count: 385
Global model norm: 43.2326470110046.
Norm before scaling: 43.21150602478103. Distance: 1.379816678697068
Total norm for 4 adversaries is: 43.21150602478103. distance: 1.379816678697068
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0989, Accuracy: 9638/9900 (97.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5026/5305 (94.7408%), train_poison_data_count: 415
Global model norm: 43.2326470110046.
Norm before scaling: 43.21590989628776. Distance: 1.6018992744478926
Total norm for 4 adversaries is: 43.21590989628776. distance: 1.6018992744478926
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1098, Accuracy: 9605/9900 (97.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4504/4717 (95.4844%), train_poison_data_count: 370
Global model norm: 43.2326470110046.
Norm before scaling: 43.21325887025301. Distance: 1.381484822123953
Total norm for 4 adversaries is: 43.21325887025301. distance: 1.381484822123953
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0407, Accuracy: 9791/9900 (98.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4819/5066 (95.1244%), train_poison_data_count: 400
Global model norm: 43.2326470110046.
Norm before scaling: 43.21484498581983. Distance: 1.5065928848453067
Total norm for 4 adversaries is: 43.21484498581983. distance: 1.5065928848453067
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1391, Accuracy: 9557/9900 (96.5354%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4935/5424 (90.9845%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4995/5424 (92.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1857, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4565/4986 (91.5564%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4549/4986 (91.2355%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8537, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4714/5167 (91.2328%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4673/5167 (90.4393%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1830, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4246/4716 (90.0339%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4214/4716 (89.3554%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0567, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3984/4368 (91.2088%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3909/4368 (89.4918%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0202, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4009/4356 (92.0340%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3752/4356 (86.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3180, Accuracy: 4911/10000 (49.1100%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4412/4804 (91.8401%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4170/4804 (86.8027%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2534, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4092/4481 (91.3189%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3994/4481 (89.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1020, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3692/4025 (91.7267%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3765/4025 (93.5404%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9356, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4585/5017 (91.3893%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4520/5017 (90.0937%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9917, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3286/3616 (90.8739%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3339/3616 (92.3396%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7397, Accuracy: 6004/10000 (60.0400%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3838/4184 (91.7304%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3824/4184 (91.3958%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9018, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4683/5195 (90.1444%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4445/5195 (85.5630%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1560, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3968/4361 (90.9883%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3860/4361 (88.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0219, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3521/3756 (93.7433%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3537/3756 (94.1693%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9613, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5024/5591 (89.8587%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4940/5591 (88.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3803, Accuracy: 4977/10000 (49.7700%)
time spent on training: 266.8488984107971
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 17 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 12, 17]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1915, Accuracy: 6912/10000 (69.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.3092, Accuracy: 9080/9900 (91.7172%)
Done in 296.79735565185547 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4674/4885 (95.6807%), train_poison_data_count: 385
Global model norm: 43.254256022529155.
Norm before scaling: 43.23424512087467. Distance: 1.4145708382250821
Total norm for 4 adversaries is: 43.23424512087467. distance: 1.4145708382250821
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0633, Accuracy: 9731/9900 (98.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5079/5305 (95.7399%), train_poison_data_count: 415
Global model norm: 43.254256022529155.
Norm before scaling: 43.23183381581361. Distance: 1.4648443196613476
Total norm for 4 adversaries is: 43.23183381581361. distance: 1.4648443196613476
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0799, Accuracy: 9675/9900 (97.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4504/4717 (95.4844%), train_poison_data_count: 370
Global model norm: 43.254256022529155.
Norm before scaling: 43.23440182281423. Distance: 1.352128279790703
Total norm for 4 adversaries is: 43.23440182281423. distance: 1.352128279790703
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1143, Accuracy: 9617/9900 (97.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4830/5066 (95.3415%), train_poison_data_count: 400
Global model norm: 43.254256022529155.
Norm before scaling: 43.23700073342131. Distance: 1.5109823636452777
Total norm for 4 adversaries is: 43.23700073342131. distance: 1.5109823636452777
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0797, Accuracy: 9702/9900 (98.0000%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3825/4175 (91.6168%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3790/4175 (90.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9415, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4941/5455 (90.5775%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4810/5455 (88.1760%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0731, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3400/3704 (91.7927%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3414/3704 (92.1706%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8675, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4463/4989 (89.4568%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4457/4989 (89.3365%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9993, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4457/4928 (90.4424%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4499/4928 (91.2946%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0198, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3522/3804 (92.5868%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3519/3804 (92.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0282, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3950/4336 (91.0978%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3938/4336 (90.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9947, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3711/4046 (91.7202%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3720/4046 (91.9427%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.7960, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4370/4793 (91.1746%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4412/4793 (92.0509%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1475, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3499/3756 (93.1576%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3532/3756 (94.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8322, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5665/6391 (88.6403%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5547/6391 (86.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2168, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3320/3672 (90.4139%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3298/3672 (89.8148%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0534, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4157/4558 (91.2023%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4107/4558 (90.1053%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1695, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4236/4576 (92.5699%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4202/4576 (91.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9614, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4148/4456 (93.0880%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4158/4456 (93.3124%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8847, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4066/4356 (93.3425%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3804/4356 (87.3278%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1501, Accuracy: 5199/10000 (51.9900%)
time spent on training: 262.7991919517517
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [6, 15, 7]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1935, Accuracy: 6889/10000 (68.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2785, Accuracy: 9150/9900 (92.4242%)
Done in 292.0351541042328 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4698/4885 (96.1720%), train_poison_data_count: 385
Global model norm: 43.27536343091904.
Norm before scaling: 43.254907935942654. Distance: 1.427320010567756
Total norm for 4 adversaries is: 43.254907935942654. distance: 1.427320010567756
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0254, Accuracy: 9828/9900 (99.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5061/5305 (95.4006%), train_poison_data_count: 415
Global model norm: 43.27536343091904.
Norm before scaling: 43.254258844686326. Distance: 1.4878874330293603
Total norm for 4 adversaries is: 43.254258844686326. distance: 1.4878874330293603
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1372, Accuracy: 9573/9900 (96.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4515/4717 (95.7176%), train_poison_data_count: 370
Global model norm: 43.27536343091904.
Norm before scaling: 43.252324212748235. Distance: 1.3304279780342596
Total norm for 4 adversaries is: 43.252324212748235. distance: 1.3304279780342596
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1398, Accuracy: 9535/9900 (96.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4848/5066 (95.6968%), train_poison_data_count: 400
Global model norm: 43.27536343091904.
Norm before scaling: 43.25496437820028. Distance: 1.4269442896617723
Total norm for 4 adversaries is: 43.25496437820028. distance: 1.4269442896617723
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0775, Accuracy: 9681/9900 (97.7879%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4612/5116 (90.1486%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4596/5116 (89.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0376, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5143/5582 (92.1354%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5061/5582 (90.6664%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0857, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4466/4928 (90.6250%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4442/4928 (90.1380%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0559, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3773/4126 (91.4445%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3807/4126 (92.2685%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8515, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3713/4158 (89.2977%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3718/4158 (89.4180%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1193, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4565/5063 (90.1639%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4296/5063 (84.8509%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1342, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5404/6124 (88.2430%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5450/6124 (88.9941%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1355, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4006/4354 (92.0073%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3552/4354 (81.5802%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.4222, Accuracy: 4785/10000 (47.8500%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4594/5025 (91.4229%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4609/5025 (91.7214%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0693, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4335/4679 (92.6480%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0099, Accuracy: 3843/4679 (82.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3333, Accuracy: 5036/10000 (50.3600%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4375/4793 (91.2789%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4406/4793 (91.9257%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0271, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4167/4518 (92.2311%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4187/4518 (92.6737%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9221, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4726/5167 (91.4651%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4713/5167 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1670, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4116/4433 (92.8491%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4090/4433 (92.2626%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9282, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4122/4503 (91.5390%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4070/4503 (90.3842%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9938, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4311/4707 (91.5870%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4261/4707 (90.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0722, Accuracy: 5324/10000 (53.2400%)
time spent on training: 271.017422914505
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [6, 4, 7]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1934, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2642, Accuracy: 9192/9900 (92.8485%)
Done in 300.39649200439453 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4672/4885 (95.6397%), train_poison_data_count: 385
Global model norm: 43.298935917208176.
Norm before scaling: 43.27749588863276. Distance: 1.4012054669044038
Total norm for 4 adversaries is: 43.27749588863276. distance: 1.4012054669044038
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0313, Accuracy: 9824/9900 (99.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5062/5305 (95.4194%), train_poison_data_count: 415
Global model norm: 43.298935917208176.
Norm before scaling: 43.2778456467986. Distance: 1.4992634236337672
Total norm for 4 adversaries is: 43.2778456467986. distance: 1.4992634236337672
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1114, Accuracy: 9612/9900 (97.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4507/4717 (95.5480%), train_poison_data_count: 370
Global model norm: 43.298935917208176.
Norm before scaling: 43.278064244216864. Distance: 1.373631272951758
Total norm for 4 adversaries is: 43.278064244216864. distance: 1.373631272951758
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0702, Accuracy: 9721/9900 (98.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4834/5066 (95.4205%), train_poison_data_count: 400
Global model norm: 43.298935917208176.
Norm before scaling: 43.27978759939145. Distance: 1.4568466601403558
Total norm for 4 adversaries is: 43.27978759939145. distance: 1.4568466601403558
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1278, Accuracy: 9559/9900 (96.5556%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3419/3704 (92.3056%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3429/3704 (92.5756%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.7774, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4921/5392 (91.2648%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4819/5392 (89.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1851, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4041/4362 (92.6410%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4006/4362 (91.8386%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1718, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4238/4538 (93.3892%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4231/4538 (93.2349%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8901, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3847/4184 (91.9455%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3851/4184 (92.0411%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8779, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3505/3756 (93.3174%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3514/3756 (93.5570%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9961, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4353/4679 (93.0327%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4054/4679 (86.6424%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.3341, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3233/3472 (93.1164%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3269/3472 (94.1532%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8372, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5709/6391 (89.3287%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5661/6391 (88.5777%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0815, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4715/5265 (89.5537%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4664/5265 (88.5850%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2307, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5251/5902 (88.9698%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4961/5902 (84.0563%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2430, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5495/6124 (89.7289%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5470/6124 (89.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9291, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4648/5083 (91.4421%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4541/5083 (89.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1714, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4096/4465 (91.7357%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4121/4465 (92.2956%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0671, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3510/3804 (92.2713%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3543/3804 (93.1388%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8149, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4549/4918 (92.4969%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4511/4918 (91.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1654, Accuracy: 5267/10000 (52.6700%)
time spent on training: 268.32785153388977
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 7, 19]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.2093, Accuracy: 6864/10000 (68.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2253, Accuracy: 9278/9900 (93.7172%)
Done in 297.5071940422058 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4694/4885 (96.0901%), train_poison_data_count: 385
Global model norm: 43.321240268469204.
Norm before scaling: 43.298473558544764. Distance: 1.3613722149620189
Total norm for 4 adversaries is: 43.298473558544764. distance: 1.3613722149620189
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0389, Accuracy: 9805/9900 (99.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5068/5305 (95.5325%), train_poison_data_count: 415
Global model norm: 43.321240268469204.
Norm before scaling: 43.29926294840364. Distance: 1.496449958487161
Total norm for 4 adversaries is: 43.29926294840364. distance: 1.496449958487161
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0497, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4512/4717 (95.6540%), train_poison_data_count: 370
Global model norm: 43.321240268469204.
Norm before scaling: 43.298558136718015. Distance: 1.3501180085067475
Total norm for 4 adversaries is: 43.298558136718015. distance: 1.3501180085067475
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0702, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4860/5066 (95.9337%), train_poison_data_count: 400
Global model norm: 43.321240268469204.
Norm before scaling: 43.300860009231485. Distance: 1.4415393137312755
Total norm for 4 adversaries is: 43.300860009231485. distance: 1.4415393137312755
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1000, Accuracy: 9624/9900 (97.2121%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4211/4538 (92.7942%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4168/4538 (91.8466%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9847, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4495/4989 (90.0982%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4490/4989 (89.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8897, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4403/4793 (91.8631%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4457/4793 (92.9898%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9344, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3678/4158 (88.4560%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3713/4158 (89.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0823, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3549/3861 (91.9192%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3503/3861 (90.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9517, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4668/5232 (89.2202%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4574/5232 (87.4235%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1698, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4322/4663 (92.6871%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4332/4663 (92.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8406, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4745/5197 (91.3027%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4517/5197 (86.9155%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2670, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4724/5167 (91.4264%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4717/5167 (91.2909%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2057, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4042/4416 (91.5308%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4045/4416 (91.5987%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9343, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3981/4354 (91.4332%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3544/4354 (81.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.8784, Accuracy: 4384/10000 (43.8400%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4982/5455 (91.3291%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4975/5455 (91.2007%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0288, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4127/4456 (92.6167%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4165/4456 (93.4695%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9747, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2928/3271 (89.5139%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2941/3271 (89.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8680, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3045/3297 (92.3567%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3066/3297 (92.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7171, Accuracy: 5983/10000 (59.8300%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5029/5591 (89.9481%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4927/5591 (88.1238%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0951, Accuracy: 5280/10000 (52.8000%)
time spent on training: 266.2150731086731
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [10, 4, 8]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.2164, Accuracy: 6844/10000 (68.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2061, Accuracy: 9329/9900 (94.2323%)
Done in 295.35853934288025 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4688/4885 (95.9672%), train_poison_data_count: 385
Global model norm: 43.34340640635263.
Norm before scaling: 43.32107965393767. Distance: 1.352011148595835
Total norm for 4 adversaries is: 43.32107965393767. distance: 1.352011148595835
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0876, Accuracy: 9680/9900 (97.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5080/5305 (95.7587%), train_poison_data_count: 415
Global model norm: 43.34340640635263.
Norm before scaling: 43.31811944967429. Distance: 1.4572621998547022
Total norm for 4 adversaries is: 43.31811944967429. distance: 1.4572621998547022
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0711, Accuracy: 9711/9900 (98.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4505/4717 (95.5056%), train_poison_data_count: 370
Global model norm: 43.34340640635263.
Norm before scaling: 43.32090635864369. Distance: 1.3619870488927652
Total norm for 4 adversaries is: 43.32090635864369. distance: 1.3619870488927652
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0910, Accuracy: 9655/9900 (97.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4853/5066 (95.7955%), train_poison_data_count: 400
Global model norm: 43.34340640635263.
Norm before scaling: 43.32175451274452. Distance: 1.43905530631621
Total norm for 4 adversaries is: 43.32175451274452. distance: 1.43905530631621
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1024, Accuracy: 9616/9900 (97.1313%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4698/5167 (90.9232%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4758/5167 (92.0844%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1174, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3507/3775 (92.9007%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3508/3775 (92.9272%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9634, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4697/5195 (90.4139%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4530/5195 (87.1992%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2241, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3801/4126 (92.1231%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3817/4126 (92.5109%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0112, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3580/3911 (91.5367%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3478/3911 (88.9287%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0390, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4072/4433 (91.8565%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4073/4433 (91.8791%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7743, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2953/3271 (90.2782%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2922/3271 (89.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9215, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3328/3590 (92.7019%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3351/3590 (93.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9121, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4546/4918 (92.4359%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4529/4918 (92.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9828, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4552/4986 (91.2956%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4524/4986 (90.7341%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0034, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3276/3616 (90.5973%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3348/3616 (92.5885%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8280, Accuracy: 5913/10000 (59.1300%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3925/4295 (91.3853%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3782/4295 (88.0559%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1989, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4049/4356 (92.9522%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3686/4356 (84.6189%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.3378, Accuracy: 4944/10000 (49.4400%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4396/4793 (91.7171%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4427/4793 (92.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9243, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3999/4315 (92.6767%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4024/4315 (93.2561%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8017, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4390/4804 (91.3822%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4037/4804 (84.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2191, Accuracy: 5031/10000 (50.3100%)
time spent on training: 259.64158725738525
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 11 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [11, 13, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.2169, Accuracy: 6856/10000 (68.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.2035, Accuracy: 9340/9900 (94.3434%)
Done in 288.61196541786194 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4694/4885 (96.0901%), train_poison_data_count: 385
Global model norm: 43.3635696169247.
Norm before scaling: 43.34276849780927. Distance: 1.3871020579809785
Total norm for 4 adversaries is: 43.34276849780927. distance: 1.3871020579809785
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1578, Accuracy: 9483/9900 (95.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5056/5305 (95.3063%), train_poison_data_count: 415
Global model norm: 43.3635696169247.
Norm before scaling: 43.34079556891953. Distance: 1.4805370304999603
Total norm for 4 adversaries is: 43.34079556891953. distance: 1.4805370304999603
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1445, Accuracy: 9533/9900 (96.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4514/4717 (95.6964%), train_poison_data_count: 370
Global model norm: 43.3635696169247.
Norm before scaling: 43.341416607613176. Distance: 1.3358405005504088
Total norm for 4 adversaries is: 43.341416607613176. distance: 1.3358405005504088
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0524, Accuracy: 9764/9900 (98.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4818/5066 (95.1046%), train_poison_data_count: 400
Global model norm: 43.3635696169247.
Norm before scaling: 43.34537921640624. Distance: 1.5318525257742095
Total norm for 4 adversaries is: 43.34537921640624. distance: 1.5318525257742095
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0219, Accuracy: 9842/9900 (99.4141%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4167/4503 (92.5383%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4088/4503 (90.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0056, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4453/4934 (90.2513%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4226/4934 (85.6506%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2462, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4435/4804 (92.3189%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4120/4804 (85.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2088, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4184/4456 (93.8959%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4201/4456 (94.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8194, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4300/4651 (92.4532%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4254/4651 (91.4642%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9308, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3840/4184 (91.7782%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3845/4184 (91.8977%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9008, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4464/4928 (90.5844%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4416/4928 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2206, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3488/3775 (92.3974%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3563/3775 (94.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8866, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4610/5083 (90.6945%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4524/5083 (89.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1358, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4981/5455 (91.3107%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4924/5455 (90.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1512, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3297/3638 (90.6267%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3367/3638 (92.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.7906, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3595/3911 (91.9202%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3352/3911 (85.7070%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1108, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3554/3837 (92.6244%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3567/3837 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9320, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4066/4501 (90.3355%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4022/4501 (89.3579%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0907, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4753/5197 (91.4566%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4692/5197 (90.2829%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1082, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3545/3861 (91.8156%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3503/3861 (90.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8932, Accuracy: 5713/10000 (57.1300%)
time spent on training: 263.5149896144867
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 8, 13]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.2218, Accuracy: 6844/10000 (68.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1960, Accuracy: 9367/9900 (94.6162%)
Done in 292.95689702033997 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4710/4885 (96.4176%), train_poison_data_count: 385
Global model norm: 43.38423977370339.
Norm before scaling: 43.359763511772925. Distance: 1.3081068812836485
Total norm for 4 adversaries is: 43.359763511772925. distance: 1.3081068812836485
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0587, Accuracy: 9749/9900 (98.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5062/5305 (95.4194%), train_poison_data_count: 415
Global model norm: 43.38423977370339.
Norm before scaling: 43.36090228166023. Distance: 1.4827521839476294
Total norm for 4 adversaries is: 43.36090228166023. distance: 1.4827521839476294
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0331, Accuracy: 9815/9900 (99.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4530/4717 (96.0356%), train_poison_data_count: 370
Global model norm: 43.38423977370339.
Norm before scaling: 43.359740989446365. Distance: 1.3008838876549114
Total norm for 4 adversaries is: 43.359740989446365. distance: 1.3008838876549114
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1399, Accuracy: 9553/9900 (96.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4873/5066 (96.1903%), train_poison_data_count: 400
Global model norm: 43.38423977370339.
Norm before scaling: 43.36334441290103. Distance: 1.418069546902727
Total norm for 4 adversaries is: 43.36334441290103. distance: 1.418069546902727
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0763, Accuracy: 9715/9900 (98.1313%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2967/3271 (90.7062%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0071, Accuracy: 2839/3271 (86.7930%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0902, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4070/4511 (90.2239%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4112/4511 (91.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8948, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3313/3638 (91.0665%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3364/3638 (92.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8241, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5172/5582 (92.6550%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5137/5582 (92.0279%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2273, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4140/4456 (92.9084%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4159/4456 (93.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8656, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5372/5902 (91.0200%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5163/5902 (87.4788%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1907, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4015/4416 (90.9194%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4005/4416 (90.6929%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0644, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4445/4934 (90.0892%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4145/4934 (84.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1579, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4211/4596 (91.6232%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4233/4596 (92.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9993, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3592/3837 (93.6148%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3598/3837 (93.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8078, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5704/6391 (89.2505%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5602/6391 (87.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1642, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3930/4368 (89.9725%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3855/4368 (88.2555%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0083, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3487/3804 (91.6667%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3479/3804 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8360, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5727/6263 (91.4418%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5716/6263 (91.2662%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1814, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4413/4793 (92.0718%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4367/4793 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1723, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4958/5424 (91.4086%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4974/5424 (91.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2221, Accuracy: 5164/10000 (51.6400%)
time spent on training: 269.9678819179535
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 19 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [5, 19, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.2223, Accuracy: 6849/10000 (68.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1885, Accuracy: 9394/9900 (94.8889%)
Done in 299.12447214126587 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4713/4885 (96.4790%), train_poison_data_count: 385
Global model norm: 43.405521614658944.
Norm before scaling: 43.380608539595485. Distance: 1.343361687554235
Total norm for 4 adversaries is: 43.380608539595485. distance: 1.343361687554235
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0288, Accuracy: 9824/9900 (99.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5066/5305 (95.4948%), train_poison_data_count: 415
Global model norm: 43.405521614658944.
Norm before scaling: 43.38493475247557. Distance: 1.5111890549909088
Total norm for 4 adversaries is: 43.38493475247557. distance: 1.5111890549909088
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0672, Accuracy: 9738/9900 (98.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4505/4717 (95.5056%), train_poison_data_count: 370
Global model norm: 43.405521614658944.
Norm before scaling: 43.38234892490479. Distance: 1.3115188473573576
Total norm for 4 adversaries is: 43.38234892490479. distance: 1.3115188473573576
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1082, Accuracy: 9616/9900 (97.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4868/5066 (96.0916%), train_poison_data_count: 400
Global model norm: 43.405521614658944.
Norm before scaling: 43.383802240870956. Distance: 1.4354855894124778
Total norm for 4 adversaries is: 43.383802240870956. distance: 1.4354855894124778
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0377, Accuracy: 9806/9900 (99.0505%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4637/5055 (91.7310%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4602/5055 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9428, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3849/4184 (91.9933%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3854/4184 (92.1128%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8220, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3586/3861 (92.8775%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3568/3861 (92.4113%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9422, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4416/4804 (91.9234%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4174/4804 (86.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0785, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3241/3472 (93.3468%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3239/3472 (93.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0138, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3657/3969 (92.1391%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3663/3969 (92.2902%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9687, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4543/4989 (91.0603%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4469/4989 (89.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9525, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5182/5582 (92.8341%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5110/5582 (91.5442%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1682, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4389/4793 (91.5710%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4388/4793 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9812, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4260/4662 (91.3771%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4313/4662 (92.5139%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9771, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4456/4934 (90.3121%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4295/4934 (87.0490%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1940, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4547/4986 (91.1953%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4583/4986 (91.9174%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8415, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4091/4433 (92.2851%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4023/4433 (90.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9216, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4263/4716 (90.3944%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4264/4716 (90.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9803, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4250/4596 (92.4717%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4227/4596 (91.9713%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1222, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3969/4354 (91.1576%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0112, Accuracy: 3507/4354 (80.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.5372, Accuracy: 4740/10000 (47.4000%)
time spent on training: 265.0993194580078
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 17 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [17, 11, 13]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.2225, Accuracy: 6838/10000 (68.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1714, Accuracy: 9430/9900 (95.2525%)
Done in 294.5065281391144 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4727/4885 (96.7656%), train_poison_data_count: 385
Global model norm: 43.42667215539532.
Norm before scaling: 43.402713420091175. Distance: 1.32625286321304
Total norm for 4 adversaries is: 43.402713420091175. distance: 1.32625286321304
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0298, Accuracy: 9826/9900 (99.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5087/5305 (95.8907%), train_poison_data_count: 415
Global model norm: 43.42667215539532.
Norm before scaling: 43.40094431891359. Distance: 1.4412209823347268
Total norm for 4 adversaries is: 43.40094431891359. distance: 1.4412209823347268
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0426, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4511/4717 (95.6328%), train_poison_data_count: 370
Global model norm: 43.42667215539532.
Norm before scaling: 43.40475384390516. Distance: 1.3648833995665093
Total norm for 4 adversaries is: 43.40475384390516. distance: 1.3648833995665093
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0651, Accuracy: 9726/9900 (98.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4848/5066 (95.6968%), train_poison_data_count: 400
Global model norm: 43.42667215539532.
Norm before scaling: 43.40954164310034. Distance: 1.4848440132032497
Total norm for 4 adversaries is: 43.40954164310034. distance: 1.4848440132032497
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0893, Accuracy: 9657/9900 (97.5455%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4677/5116 (91.4191%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4616/5116 (90.2267%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0131, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4272/4662 (91.6345%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4297/4662 (92.1707%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9190, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5349/5902 (90.6303%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4976/5902 (84.3104%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2057, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4549/5063 (89.8479%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4219/5063 (83.3300%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2187, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4045/4354 (92.9031%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0124, Accuracy: 3380/4354 (77.6298%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.7651, Accuracy: 4397/10000 (43.9700%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4744/5195 (91.3186%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4462/5195 (85.8903%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2955, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4055/4356 (93.0900%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3817/4356 (87.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2961, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3916/4295 (91.1758%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3904/4295 (90.8964%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9905, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5716/6263 (91.2662%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5637/6263 (90.0048%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0996, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4089/4511 (90.6451%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4100/4511 (90.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0015, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4311/4663 (92.4512%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4279/4663 (91.7650%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0157, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3957/4336 (91.2592%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3985/4336 (91.9050%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0147, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4436/4928 (90.0162%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4441/4928 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0832, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3744/4046 (92.5358%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3784/4046 (93.5245%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8056, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3342/3672 (91.0131%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3314/3672 (90.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9388, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4041/4356 (92.7686%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3959/4356 (90.8861%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9703, Accuracy: 5480/10000 (54.8000%)
time spent on training: 267.7603108882904
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 13, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2231, Accuracy: 6859/10000 (68.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1623, Accuracy: 9458/9900 (95.5354%)
Done in 297.16754698753357 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4701/4885 (96.2334%), train_poison_data_count: 385
Global model norm: 43.449899871324504.
Norm before scaling: 43.42540720834909. Distance: 1.3507097233047314
Total norm for 4 adversaries is: 43.42540720834909. distance: 1.3507097233047314
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0609, Accuracy: 9739/9900 (98.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5065/5305 (95.4760%), train_poison_data_count: 415
Global model norm: 43.449899871324504.
Norm before scaling: 43.424798615141846. Distance: 1.4721528262851005
Total norm for 4 adversaries is: 43.424798615141846. distance: 1.4721528262851005
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0213, Accuracy: 9835/9900 (99.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4513/4717 (95.6752%), train_poison_data_count: 370
Global model norm: 43.449899871324504.
Norm before scaling: 43.4270066574541. Distance: 1.3416068263165135
Total norm for 4 adversaries is: 43.4270066574541. distance: 1.3416068263165135
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0697, Accuracy: 9710/9900 (98.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4852/5066 (95.7758%), train_poison_data_count: 400
Global model norm: 43.449899871324504.
Norm before scaling: 43.426982764535346. Distance: 1.4317840046402264
Total norm for 4 adversaries is: 43.426982764535346. distance: 1.4317840046402264
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0515, Accuracy: 9766/9900 (98.6465%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4534/5037 (90.0139%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4557/5037 (90.4705%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9197, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4248/4647 (91.4138%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4232/4647 (91.0695%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9968, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4331/4663 (92.8801%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4314/4663 (92.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9922, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3979/4336 (91.7666%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3985/4336 (91.9050%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1343, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3491/3756 (92.9446%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3546/3756 (94.4089%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8638, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4143/4625 (89.5784%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4082/4625 (88.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2024, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4073/4362 (93.3746%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3959/4362 (90.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2652, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4469/4874 (91.6906%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4325/4874 (88.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1952, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4275/4767 (89.6790%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4264/4767 (89.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1367, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3486/3775 (92.3444%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3560/3775 (94.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8437, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4289/4662 (91.9991%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4277/4662 (91.7417%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1026, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5525/6124 (90.2188%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5414/6124 (88.4063%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0557, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4123/4511 (91.3988%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4082/4511 (90.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0002, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3612/3911 (92.3549%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3502/3911 (89.5423%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1169, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5060/5591 (90.5026%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4948/5591 (88.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0878, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3801/4126 (92.1231%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3804/4126 (92.1958%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9467, Accuracy: 5589/10000 (55.8900%)
time spent on training: 266.2635316848755
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [5, 14, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2246, Accuracy: 6849/10000 (68.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1486, Accuracy: 9495/9900 (95.9091%)
Done in 295.43506121635437 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4722/4885 (96.6633%), train_poison_data_count: 385
Global model norm: 43.47055003911412.
Norm before scaling: 43.44725188419933. Distance: 1.3295618251127626
Total norm for 4 adversaries is: 43.44725188419933. distance: 1.3295618251127626
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1062, Accuracy: 9627/9900 (97.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5063/5305 (95.4383%), train_poison_data_count: 415
Global model norm: 43.47055003911412.
Norm before scaling: 43.44696108744978. Distance: 1.4796533276520343
Total norm for 4 adversaries is: 43.44696108744978. distance: 1.4796533276520343
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0673, Accuracy: 9716/9900 (98.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4521/4717 (95.8448%), train_poison_data_count: 370
Global model norm: 43.47055003911412.
Norm before scaling: 43.446349986488364. Distance: 1.3116665419094182
Total norm for 4 adversaries is: 43.446349986488364. distance: 1.3116665419094182
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0571, Accuracy: 9750/9900 (98.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4842/5066 (95.5784%), train_poison_data_count: 400
Global model norm: 43.47055003911412.
Norm before scaling: 43.450130245597364. Distance: 1.4684000612930705
Total norm for 4 adversaries is: 43.450130245597364. distance: 1.4684000612930705
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0446, Accuracy: 9790/9900 (98.8889%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4559/5025 (90.7264%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4611/5025 (91.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0914, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4682/5116 (91.5168%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4566/5116 (89.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2837, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4737/5167 (91.6780%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4738/5167 (91.6973%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0652, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4144/4558 (90.9171%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4050/4558 (88.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0517, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4312/4651 (92.7112%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4180/4651 (89.8731%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0159, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3942/4336 (90.9133%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4006/4336 (92.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1997, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4632/5055 (91.6320%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4590/5055 (90.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0854, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3510/3775 (92.9801%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3578/3775 (94.7815%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7732, Accuracy: 5931/10000 (59.3100%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4792/5265 (91.0161%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4657/5265 (88.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0890, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3762/4025 (93.4658%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3779/4025 (93.8882%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8347, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4511/4989 (90.4189%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4472/4989 (89.6372%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0316, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4427/4793 (92.3639%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4420/4793 (92.2178%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0917, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3552/3804 (93.3754%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3553/3804 (93.4017%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9092, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3563/3797 (93.8372%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3535/3797 (93.0998%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8696, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4113/4433 (92.7814%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4092/4433 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9313, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4368/4707 (92.7980%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4248/4707 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8006, Accuracy: 5789/10000 (57.8900%)
time spent on training: 266.4381308555603
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [8, 17, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2283, Accuracy: 6838/10000 (68.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1418, Accuracy: 9512/9900 (96.0808%)
Done in 295.39440274238586 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4716/4885 (96.5404%), train_poison_data_count: 385
Global model norm: 43.49087604116667.
Norm before scaling: 43.46654688656769. Distance: 1.326115872488613
Total norm for 4 adversaries is: 43.46654688656769. distance: 1.326115872488613
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0547, Accuracy: 9769/9900 (98.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5090/5305 (95.9472%), train_poison_data_count: 415
Global model norm: 43.49087604116667.
Norm before scaling: 43.46546424497557. Distance: 1.423106655694525
Total norm for 4 adversaries is: 43.46546424497557. distance: 1.423106655694525
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0549, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4554/4717 (96.5444%), train_poison_data_count: 370
Global model norm: 43.49087604116667.
Norm before scaling: 43.462949210811296. Distance: 1.2376836544124101
Total norm for 4 adversaries is: 43.462949210811296. distance: 1.2376836544124101
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0995, Accuracy: 9638/9900 (97.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4837/5066 (95.4797%), train_poison_data_count: 400
Global model norm: 43.49087604116667.
Norm before scaling: 43.46932849183721. Distance: 1.4495132846177454
Total norm for 4 adversaries is: 43.46932849183721. distance: 1.4495132846177454
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0486, Accuracy: 9769/9900 (98.6768%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4838/5392 (89.7255%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4850/5392 (89.9481%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1321, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4352/4663 (93.3305%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4314/4663 (92.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9352, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3511/3797 (92.4677%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3492/3797 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0584, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5172/5582 (92.6550%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5086/5582 (91.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1944, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4747/5167 (91.8715%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4704/5167 (91.0393%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0056, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3499/3781 (92.5417%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3297/3781 (87.1992%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1294, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3653/3969 (92.0383%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3649/3969 (91.9375%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.7864, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3563/3837 (92.8590%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3613/3837 (94.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.6857, Accuracy: 6030/10000 (60.3000%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5332/5902 (90.3423%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5116/5902 (86.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.4136, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4984/5455 (91.3657%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4884/5455 (89.5325%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8485, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4539/5037 (90.1132%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4552/5037 (90.3713%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0426, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4619/5017 (92.0670%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4602/5017 (91.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8313, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4550/4986 (91.2555%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4492/4986 (90.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8984, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4768/5197 (91.7452%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4697/5197 (90.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1269, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4022/4361 (92.2266%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3861/4361 (88.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9890, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5762/6263 (92.0006%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5739/6263 (91.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3677, Accuracy: 5076/10000 (50.7600%)
time spent on training: 270.61400604248047
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [8, 12, 10]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2307, Accuracy: 6827/10000 (68.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1378, Accuracy: 9530/9900 (96.2626%)
Done in 300.28332328796387 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4733/4885 (96.8884%), train_poison_data_count: 385
Global model norm: 43.51281128695031.
Norm before scaling: 43.484880297100105. Distance: 1.2449244929783767
Total norm for 4 adversaries is: 43.484880297100105. distance: 1.2449244929783767
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1109, Accuracy: 9610/9900 (97.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5118/5305 (96.4750%), train_poison_data_count: 415
Global model norm: 43.51281128695031.
Norm before scaling: 43.48643685598635. Distance: 1.3899832970143935
Total norm for 4 adversaries is: 43.48643685598635. distance: 1.3899832970143935
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0747, Accuracy: 9719/9900 (98.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4521/4717 (95.8448%), train_poison_data_count: 370
Global model norm: 43.51281128695031.
Norm before scaling: 43.48787827246375. Distance: 1.2829795421982213
Total norm for 4 adversaries is: 43.48787827246375. distance: 1.2829795421982213
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0328, Accuracy: 9808/9900 (99.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4867/5066 (96.0719%), train_poison_data_count: 400
Global model norm: 43.51281128695031.
Norm before scaling: 43.49012802178861. Distance: 1.4293336691007883
Total norm for 4 adversaries is: 43.49012802178861. distance: 1.4293336691007883
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0925, Accuracy: 9659/9900 (97.5657%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4627/5017 (92.2264%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4558/5017 (90.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9443, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4456/4928 (90.4221%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4438/4928 (90.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0083, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3882/4184 (92.7820%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3903/4184 (93.2839%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8022, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4444/4793 (92.7185%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4389/4793 (91.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8861, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5213/5740 (90.8188%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5169/5740 (90.0523%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1331, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3537/3756 (94.1693%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3565/3756 (94.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7910, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3921/4235 (92.5856%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3840/4235 (90.6730%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9574, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3899/4223 (92.3277%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3881/4223 (91.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9583, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4544/5063 (89.7492%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4344/5063 (85.7989%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.4348, Accuracy: 4893/10000 (48.9300%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4507/4989 (90.3387%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4466/4989 (89.5169%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8486, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4506/4928 (91.4367%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4504/4928 (91.3961%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9281, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5309/5902 (89.9526%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5110/5902 (86.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2660, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4161/4456 (93.3797%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4098/4456 (91.9659%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9648, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5523/6124 (90.1862%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5435/6124 (88.7492%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9946, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3543/3828 (92.5549%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3559/3828 (92.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1833, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3299/3616 (91.2334%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3357/3616 (92.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8785, Accuracy: 5772/10000 (57.7200%)
time spent on training: 267.86420130729675
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [5, 7, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2335, Accuracy: 6824/10000 (68.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1344, Accuracy: 9539/9900 (96.3535%)
Done in 296.5892083644867 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4714/4885 (96.4995%), train_poison_data_count: 385
Global model norm: 43.53487287508716.
Norm before scaling: 43.511683506415835. Distance: 1.3368699684422896
Total norm for 4 adversaries is: 43.511683506415835. distance: 1.3368699684422896
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0851, Accuracy: 9686/9900 (97.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5108/5305 (96.2865%), train_poison_data_count: 415
Global model norm: 43.53487287508716.
Norm before scaling: 43.50918096361962. Distance: 1.4268407777950673
Total norm for 4 adversaries is: 43.50918096361962. distance: 1.4268407777950673
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0479, Accuracy: 9773/9900 (98.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4561/4717 (96.6928%), train_poison_data_count: 370
Global model norm: 43.53487287508716.
Norm before scaling: 43.507232415552906. Distance: 1.226067461354462
Total norm for 4 adversaries is: 43.507232415552906. distance: 1.226067461354462
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0636, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4859/5066 (95.9139%), train_poison_data_count: 400
Global model norm: 43.53487287508716.
Norm before scaling: 43.51311987852055. Distance: 1.4537162808339676
Total norm for 4 adversaries is: 43.51311987852055. distance: 1.4537162808339676
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0292, Accuracy: 9834/9900 (99.3333%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3860/4223 (91.4042%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3873/4223 (91.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8874, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4081/4362 (93.5580%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3946/4362 (90.4631%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9950, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5772/6391 (90.3145%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5624/6391 (87.9987%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0276, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4421/4793 (92.2387%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4450/4793 (92.8437%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0754, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3538/3756 (94.1960%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3546/3756 (94.4089%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7942, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4287/4618 (92.8324%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4240/4618 (91.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0686, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3746/4025 (93.0683%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3791/4025 (94.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7809, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3328/3638 (91.4788%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3366/3638 (92.5234%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8612, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4009/4315 (92.9085%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4039/4315 (93.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8244, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3945/4295 (91.8510%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3902/4295 (90.8498%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0483, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4516/4928 (91.6396%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4546/4928 (92.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9728, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4584/4986 (91.9374%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4534/4986 (90.9346%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9833, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3841/4126 (93.0926%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3804/4126 (92.1958%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0049, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4518/4918 (91.8666%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4472/4918 (90.9313%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1012, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4739/5195 (91.2223%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4512/5195 (86.8527%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1858, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5169/5740 (90.0523%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5151/5740 (89.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1289, Accuracy: 5347/10000 (53.4700%)
time spent on training: 267.63327956199646
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 11, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2352, Accuracy: 6818/10000 (68.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1212, Accuracy: 9576/9900 (96.7273%)
Done in 297.2248167991638 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4728/4885 (96.7861%), train_poison_data_count: 385
Global model norm: 43.55531459750348.
Norm before scaling: 43.52963755538432. Distance: 1.3143729062138532
Total norm for 4 adversaries is: 43.52963755538432. distance: 1.3143729062138532
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0999, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5120/5305 (96.5127%), train_poison_data_count: 415
Global model norm: 43.55531459750348.
Norm before scaling: 43.527748816039036. Distance: 1.3774507529703268
Total norm for 4 adversaries is: 43.527748816039036. distance: 1.3774507529703268
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0247, Accuracy: 9835/9900 (99.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4552/4717 (96.5020%), train_poison_data_count: 370
Global model norm: 43.55531459750348.
Norm before scaling: 43.52910753880672. Distance: 1.244543276894522
Total norm for 4 adversaries is: 43.52910753880672. distance: 1.244543276894522
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0927, Accuracy: 9664/9900 (97.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4852/5066 (95.7758%), train_poison_data_count: 400
Global model norm: 43.55531459750348.
Norm before scaling: 43.531464520738474. Distance: 1.420518920133296
Total norm for 4 adversaries is: 43.531464520738474. distance: 1.420518920133296
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0439, Accuracy: 9787/9900 (98.8586%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3063/3297 (92.9026%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3071/3297 (93.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8415, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3569/3828 (93.2341%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3554/3828 (92.8422%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9857, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4604/5063 (90.9342%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4388/5063 (86.6680%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.4693, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4136/4501 (91.8907%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4111/4501 (91.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9488, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4455/4793 (92.9480%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4466/4793 (93.1776%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8671, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3919/4223 (92.8013%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3921/4223 (92.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8820, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3545/3756 (94.3823%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3566/3756 (94.9414%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8958, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3348/3638 (92.0286%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3381/3638 (92.9357%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7386, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3351/3646 (91.9089%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3392/3646 (93.0335%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7666, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4494/4874 (92.2035%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4355/4874 (89.3517%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.3237, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5743/6263 (91.6973%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5766/6263 (92.0645%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0409, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4559/5037 (90.5102%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4633/5037 (91.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9067, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4107/4362 (94.1541%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4069/4362 (93.2829%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0202, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4053/4356 (93.0441%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3679/4356 (84.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.3696, Accuracy: 4884/10000 (48.8400%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4636/5116 (90.6177%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4526/5116 (88.4676%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0952, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4021/4346 (92.5219%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4054/4346 (93.2812%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8543, Accuracy: 5776/10000 (57.7600%)
time spent on training: 260.46544766426086
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [10, 11, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2254, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1212, Accuracy: 9570/9900 (96.6667%)
Done in 290.0204482078552 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4709/4885 (96.3971%), train_poison_data_count: 385
Global model norm: 43.57582236655867.
Norm before scaling: 43.549909351136286. Distance: 1.3433669231765122
Total norm for 4 adversaries is: 43.549909351136286. distance: 1.3433669231765122
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0666, Accuracy: 9721/9900 (98.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5115/5305 (96.4185%), train_poison_data_count: 415
Global model norm: 43.57582236655867.
Norm before scaling: 43.54730668964356. Distance: 1.3950168394624232
Total norm for 4 adversaries is: 43.54730668964356. distance: 1.3950168394624232
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0553, Accuracy: 9757/9900 (98.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4522/4717 (95.8660%), train_poison_data_count: 370
Global model norm: 43.57582236655867.
Norm before scaling: 43.55057505809338. Distance: 1.2924373952434909
Total norm for 4 adversaries is: 43.55057505809338. distance: 1.2924373952434909
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0624, Accuracy: 9735/9900 (98.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4874/5066 (96.2100%), train_poison_data_count: 400
Global model norm: 43.57582236655867.
Norm before scaling: 43.55054422557484. Distance: 1.3570743253083122
Total norm for 4 adversaries is: 43.55054422557484. distance: 1.3570743253083122
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0804, Accuracy: 9669/9900 (97.6667%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4213/4518 (93.2492%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4186/4518 (92.6516%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9744, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4173/4558 (91.5533%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4019/4558 (88.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2144, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3554/3804 (93.4280%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3563/3804 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9136, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3511/3775 (93.0066%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3587/3775 (95.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9182, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4626/5083 (91.0092%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4566/5083 (89.8288%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0513, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4521/4928 (91.7411%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4480/4928 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9862, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4653/5244 (88.7300%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4548/5244 (86.7277%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1136, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4554/4989 (91.2808%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4557/4989 (91.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9643, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4603/4986 (92.3185%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4589/4986 (92.0377%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9354, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3807/4175 (91.1856%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3864/4175 (92.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7973, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4771/5232 (91.1888%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4689/5232 (89.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0034, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4580/5063 (90.4602%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4404/5063 (86.9840%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.3136, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4166/4441 (93.8077%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4113/4441 (92.6143%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1056, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3351/3646 (91.9089%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3349/3646 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7528, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4747/5167 (91.8715%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4678/5167 (90.5361%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1603, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4265/4538 (93.9841%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4239/4538 (93.4112%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0058, Accuracy: 5515/10000 (55.1500%)
time spent on training: 262.74500942230225
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 13, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2307, Accuracy: 6835/10000 (68.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1174, Accuracy: 9578/9900 (96.7475%)
Done in 292.1229159832001 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4723/4885 (96.6837%), train_poison_data_count: 385
Global model norm: 43.59706388614017.
Norm before scaling: 43.57121813542384. Distance: 1.3236163184050291
Total norm for 4 adversaries is: 43.57121813542384. distance: 1.3236163184050291
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0572, Accuracy: 9758/9900 (98.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5105/5305 (96.2300%), train_poison_data_count: 415
Global model norm: 43.59706388614017.
Norm before scaling: 43.56932979773085. Distance: 1.4060429738560034
Total norm for 4 adversaries is: 43.56932979773085. distance: 1.4060429738560034
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0290, Accuracy: 9822/9900 (99.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4540/4717 (96.2476%), train_poison_data_count: 370
Global model norm: 43.59706388614017.
Norm before scaling: 43.571050037463955. Distance: 1.2687072897050302
Total norm for 4 adversaries is: 43.571050037463955. distance: 1.2687072897050302
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1612, Accuracy: 9480/9900 (95.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4884/5066 (96.4074%), train_poison_data_count: 400
Global model norm: 43.59706388614017.
Norm before scaling: 43.57150810288043. Distance: 1.350550410423345
Total norm for 4 adversaries is: 43.57150810288043. distance: 1.350550410423345
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0966, Accuracy: 9633/9900 (97.3030%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4075/4356 (93.5491%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3809/4356 (87.4426%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1133, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4475/4928 (90.8076%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4388/4928 (89.0422%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1110, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4599/5037 (91.3043%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4579/5037 (90.9073%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0129, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4442/4804 (92.4646%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4162/4804 (86.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3760, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3563/3775 (94.3841%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3564/3775 (94.4106%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7963, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4797/5167 (92.8392%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4702/5167 (91.0006%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2109, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3946/4235 (93.1759%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3863/4235 (91.2161%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9978, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4504/4956 (90.8797%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4407/4956 (88.9225%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1148, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5230/5740 (91.1150%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5210/5740 (90.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0167, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4329/4679 (92.5198%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4238/4679 (90.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1982, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3373/3704 (91.0637%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3430/3704 (92.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9639, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3214/3472 (92.5691%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3253/3472 (93.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9085, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4274/4651 (91.8942%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4229/4651 (90.9267%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9163, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4223/4634 (91.1308%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4173/4634 (90.0518%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0900, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5348/5902 (90.6134%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5187/5902 (87.8855%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2301, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3556/3837 (92.6766%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3562/3837 (92.8329%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9456, Accuracy: 5589/10000 (55.8900%)
time spent on training: 265.99791049957275
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 12, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2323, Accuracy: 6826/10000 (68.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1258, Accuracy: 9564/9900 (96.6061%)
Done in 295.22952151298523 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4713/4885 (96.4790%), train_poison_data_count: 385
Global model norm: 43.61738130778185.
Norm before scaling: 43.5895915355303. Distance: 1.310053452500511
Total norm for 4 adversaries is: 43.5895915355303. distance: 1.310053452500511
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0576, Accuracy: 9757/9900 (98.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5130/5305 (96.7012%), train_poison_data_count: 415
Global model norm: 43.61738130778185.
Norm before scaling: 43.5896657472954. Distance: 1.3779152829548076
Total norm for 4 adversaries is: 43.5896657472954. distance: 1.3779152829548076
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0397, Accuracy: 9798/9900 (98.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4557/4717 (96.6080%), train_poison_data_count: 370
Global model norm: 43.61738130778185.
Norm before scaling: 43.59100433781823. Distance: 1.2797592608740311
Total norm for 4 adversaries is: 43.59100433781823. distance: 1.2797592608740311
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0235, Accuracy: 9831/9900 (99.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4873/5066 (96.1903%), train_poison_data_count: 400
Global model norm: 43.61738130778185.
Norm before scaling: 43.594139223172824. Distance: 1.41143326778138
Total norm for 4 adversaries is: 43.594139223172824. distance: 1.41143326778138
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0993, Accuracy: 9638/9900 (97.3535%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3707/3969 (93.3988%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3633/3969 (91.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0137, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4347/4707 (92.3518%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4304/4707 (91.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8570, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3558/3861 (92.1523%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3526/3861 (91.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9135, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4218/4596 (91.7755%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4199/4596 (91.3621%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0125, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4157/4503 (92.3162%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4111/4503 (91.2947%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9758, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4595/4928 (93.2427%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4486/4928 (91.0308%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9444, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4579/5025 (91.1244%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4615/5025 (91.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1140, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4270/4576 (93.3129%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4204/4576 (91.8706%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0825, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4547/4918 (92.4563%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4525/4918 (92.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0677, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4026/4315 (93.3024%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4050/4315 (93.8586%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8060, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3356/3590 (93.4819%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3339/3590 (93.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8967, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4151/4456 (93.1553%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4134/4456 (92.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2823, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4022/4354 (92.3748%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3663/4354 (84.1295%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.5047, Accuracy: 4771/10000 (47.7100%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4142/4501 (92.0240%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4115/4501 (91.4241%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0322, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3644/3911 (93.1731%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3448/3911 (88.1616%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1486, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4222/4558 (92.6283%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4111/4558 (90.1931%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0526, Accuracy: 5447/10000 (54.4700%)
time spent on training: 264.24081444740295
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [8, 18, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2368, Accuracy: 6808/10000 (68.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1163, Accuracy: 9588/9900 (96.8485%)
Done in 293.3130679130554 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4740/4885 (97.0317%), train_poison_data_count: 385
Global model norm: 43.63678990936146.
Norm before scaling: 43.60829590433095. Distance: 1.2789467834872452
Total norm for 4 adversaries is: 43.60829590433095. distance: 1.2789467834872452
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0317, Accuracy: 9813/9900 (99.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5092/5305 (95.9849%), train_poison_data_count: 415
Global model norm: 43.63678990936146.
Norm before scaling: 43.61117343344693. Distance: 1.4540226122633948
Total norm for 4 adversaries is: 43.61117343344693. distance: 1.4540226122633948
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0191, Accuracy: 9847/9900 (99.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4555/4717 (96.5656%), train_poison_data_count: 370
Global model norm: 43.63678990936146.
Norm before scaling: 43.60808036191874. Distance: 1.2235947197345334
Total norm for 4 adversaries is: 43.60808036191874. distance: 1.2235947197345334
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1510, Accuracy: 9526/9900 (96.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4865/5066 (96.0324%), train_poison_data_count: 400
Global model norm: 43.63678990936146.
Norm before scaling: 43.61309214720535. Distance: 1.4046102924790556
Total norm for 4 adversaries is: 43.61309214720535. distance: 1.4046102924790556
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1196, Accuracy: 9580/9900 (96.7677%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4677/5116 (91.4191%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4619/5116 (90.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9135, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4974/5392 (92.2478%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4777/5392 (88.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1167, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4326/4767 (90.7489%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4174/4767 (87.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1400, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4320/4618 (93.5470%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4220/4618 (91.3816%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2987, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3764/4046 (93.0302%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3774/4046 (93.2773%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8861, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4176/4625 (90.2919%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4071/4625 (88.0216%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0900, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3322/3638 (91.3139%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3307/3638 (90.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9214, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4031/4416 (91.2817%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3999/4416 (90.5571%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0848, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4497/4874 (92.2651%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4263/4874 (87.4641%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.4173, Accuracy: 4923/10000 (49.2300%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3358/3646 (92.1009%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3343/3646 (91.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8372, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4645/5063 (91.7440%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4427/5063 (87.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9947, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3831/4126 (92.8502%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3854/4126 (93.4077%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7959, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4494/4934 (91.0823%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4303/4934 (87.2112%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2412, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4144/4511 (91.8643%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4123/4511 (91.3988%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0301, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4166/4518 (92.2089%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4157/4518 (92.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9557, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3071/3297 (93.1453%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3110/3297 (94.3282%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7823, Accuracy: 5891/10000 (58.9100%)
time spent on training: 263.5510928630829
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [10, 11, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2367, Accuracy: 6800/10000 (68.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1117, Accuracy: 9603/9900 (97.0000%)
Done in 292.50497579574585 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4749/4885 (97.2160%), train_poison_data_count: 385
Global model norm: 43.65728596882842.
Norm before scaling: 43.628360476765856. Distance: 1.2526374648566228
Total norm for 4 adversaries is: 43.628360476765856. distance: 1.2526374648566228
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0799, Accuracy: 9701/9900 (97.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5123/5305 (96.5693%), train_poison_data_count: 415
Global model norm: 43.65728596882842.
Norm before scaling: 43.62892286266359. Distance: 1.40311748443154
Total norm for 4 adversaries is: 43.62892286266359. distance: 1.40311748443154
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0558, Accuracy: 9750/9900 (98.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4535/4717 (96.1416%), train_poison_data_count: 370
Global model norm: 43.65728596882842.
Norm before scaling: 43.63305659622859. Distance: 1.3028116961042304
Total norm for 4 adversaries is: 43.63305659622859. distance: 1.3028116961042304
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0497, Accuracy: 9767/9900 (98.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4889/5066 (96.5061%), train_poison_data_count: 400
Global model norm: 43.65728596882842.
Norm before scaling: 43.631706705996784. Distance: 1.3715587381766325
Total norm for 4 adversaries is: 43.631706705996784. distance: 1.3715587381766325
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0436, Accuracy: 9789/9900 (98.8788%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5590/6124 (91.2802%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5440/6124 (88.8308%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0594, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4677/5025 (93.0746%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4652/5025 (92.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0701, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3221/3472 (92.7707%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3274/3472 (94.2972%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8064, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4590/5037 (91.1257%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4579/5037 (90.9073%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0346, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5201/5582 (93.1745%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4976/5582 (89.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.3798, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4705/5116 (91.9664%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4583/5116 (89.5817%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0300, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4193/4518 (92.8066%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4132/4518 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9562, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4506/4928 (91.4367%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4470/4928 (90.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2101, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4174/4558 (91.5753%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4087/4558 (89.6665%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1206, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3080/3297 (93.4183%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3113/3297 (94.4192%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.7707, Accuracy: 5897/10000 (58.9700%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3523/3756 (93.7966%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3537/3756 (94.1693%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8531, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4297/4651 (92.3887%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4195/4651 (90.1957%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0427, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4145/4441 (93.3348%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4157/4441 (93.6050%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9216, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3299/3638 (90.6817%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3344/3638 (91.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8891, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4235/4596 (92.1453%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4294/4596 (93.4291%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9726, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3003/3271 (91.8068%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3008/3271 (91.9596%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8392, Accuracy: 5771/10000 (57.7100%)
time spent on training: 265.93211674690247
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [10, 13, 18]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2400, Accuracy: 6816/10000 (68.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1036, Accuracy: 9629/9900 (97.2626%)
Done in 294.99941301345825 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4739/4885 (97.0113%), train_poison_data_count: 385
Global model norm: 43.67683055515533.
Norm before scaling: 43.64944638734694. Distance: 1.2831812004643373
Total norm for 4 adversaries is: 43.64944638734694. distance: 1.2831812004643373
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0327, Accuracy: 9814/9900 (99.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5091/5305 (95.9661%), train_poison_data_count: 415
Global model norm: 43.67683055515533.
Norm before scaling: 43.64916253089442. Distance: 1.40006200108158
Total norm for 4 adversaries is: 43.64916253089442. distance: 1.40006200108158
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1286, Accuracy: 9557/9900 (96.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4543/4717 (96.3112%), train_poison_data_count: 370
Global model norm: 43.67683055515533.
Norm before scaling: 43.650837676759565. Distance: 1.268105936297241
Total norm for 4 adversaries is: 43.650837676759565. distance: 1.268105936297241
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0729, Accuracy: 9709/9900 (98.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4877/5066 (96.2692%), train_poison_data_count: 400
Global model norm: 43.67683055515533.
Norm before scaling: 43.650879624495396. Distance: 1.3649117411910376
Total norm for 4 adversaries is: 43.650879624495396. distance: 1.3649117411910376
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0942, Accuracy: 9654/9900 (97.5152%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4572/4989 (91.6416%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4572/4989 (91.6416%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9173, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4157/4465 (93.1019%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4199/4465 (94.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9654, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4032/4315 (93.4415%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4044/4315 (93.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8660, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4314/4767 (90.4972%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4243/4767 (89.0078%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1362, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5737/6391 (89.7669%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5615/6391 (87.8579%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1101, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3369/3672 (91.7484%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3306/3672 (90.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0293, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3704/3969 (93.3233%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3649/3969 (91.9375%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7864, Accuracy: 5967/10000 (59.6700%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3354/3590 (93.4262%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3218/3590 (89.6379%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1427, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5371/5902 (91.0030%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5102/5902 (86.4453%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1589, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3751/4013 (93.4712%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3744/4013 (93.2968%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8686, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4444/4804 (92.5062%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4135/4804 (86.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3080, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3858/4175 (92.4072%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3819/4175 (91.4731%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8566, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3304/3616 (91.3717%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3323/3616 (91.8971%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7349, Accuracy: 5982/10000 (59.8200%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4004/4361 (91.8138%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3897/4361 (89.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3036, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5022/5424 (92.5885%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4992/5424 (92.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4060, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3566/3837 (92.9372%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3555/3837 (92.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9746, Accuracy: 5526/10000 (55.2600%)
time spent on training: 265.33195543289185
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 7, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2471, Accuracy: 6798/10000 (67.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1012, Accuracy: 9636/9900 (97.3333%)
Done in 294.7668488025665 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4732/4885 (96.8680%), train_poison_data_count: 385
Global model norm: 43.69698378151016.
Norm before scaling: 43.67046481399428. Distance: 1.3182683164444313
Total norm for 4 adversaries is: 43.67046481399428. distance: 1.3182683164444313
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0517, Accuracy: 9746/9900 (98.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5125/5305 (96.6070%), train_poison_data_count: 415
Global model norm: 43.69698378151016.
Norm before scaling: 43.66887987269581. Distance: 1.4184917399744463
Total norm for 4 adversaries is: 43.66887987269581. distance: 1.4184917399744463
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0339, Accuracy: 9825/9900 (99.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4558/4717 (96.6292%), train_poison_data_count: 370
Global model norm: 43.69698378151016.
Norm before scaling: 43.6702705429778. Distance: 1.268982331374635
Total norm for 4 adversaries is: 43.6702705429778. distance: 1.268982331374635
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0328, Accuracy: 9819/9900 (99.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4871/5066 (96.1508%), train_poison_data_count: 400
Global model norm: 43.69698378151016.
Norm before scaling: 43.67283792543069. Distance: 1.4119462674861485
Total norm for 4 adversaries is: 43.67283792543069. distance: 1.4119462674861485
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0402, Accuracy: 9788/9900 (98.8687%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4066/4416 (92.0743%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4036/4416 (91.3949%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9364, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5260/5740 (91.6376%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5143/5740 (89.5993%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1730, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4630/5037 (91.9198%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4614/5037 (91.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0033, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4702/5116 (91.9077%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4622/5116 (90.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0256, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4543/4918 (92.3749%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4505/4918 (91.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1604, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3579/3837 (93.2760%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3614/3837 (94.1882%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8656, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4302/4651 (92.4962%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4295/4651 (92.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0218, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3605/3861 (93.3696%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3560/3861 (92.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0501, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3869/4223 (91.6173%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3941/4223 (93.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8906, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4272/4662 (91.6345%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4301/4662 (92.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9682, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5764/6263 (92.0326%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5676/6263 (90.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1052, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3470/3781 (91.7747%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3171/3781 (83.8667%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.6218, Accuracy: 4533/10000 (45.3300%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3519/3804 (92.5079%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3548/3804 (93.2702%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9264, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3575/3828 (93.3908%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3594/3828 (93.8871%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8916, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4033/4315 (93.4647%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4057/4315 (94.0209%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8634, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4487/4956 (90.5367%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4361/4956 (87.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1854, Accuracy: 5179/10000 (51.7900%)
time spent on training: 265.11234641075134
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 13, 10]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2507, Accuracy: 6789/10000 (67.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0981, Accuracy: 9643/9900 (97.4040%)
Done in 294.6920974254608 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4745/4885 (97.1341%), train_poison_data_count: 385
Global model norm: 43.71686524261118.
Norm before scaling: 43.68671483110598. Distance: 1.222489074392975
Total norm for 4 adversaries is: 43.68671483110598. distance: 1.222489074392975
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0727, Accuracy: 9731/9900 (98.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5111/5305 (96.3431%), train_poison_data_count: 415
Global model norm: 43.71686524261118.
Norm before scaling: 43.68717308085836. Distance: 1.3913437775215458
Total norm for 4 adversaries is: 43.68717308085836. distance: 1.3913437775215458
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0421, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4565/4717 (96.7776%), train_poison_data_count: 370
Global model norm: 43.71686524261118.
Norm before scaling: 43.689244924469826. Distance: 1.214858959630221
Total norm for 4 adversaries is: 43.689244924469826. distance: 1.214858959630221
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0494, Accuracy: 9763/9900 (98.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4881/5066 (96.3482%), train_poison_data_count: 400
Global model norm: 43.71686524261118.
Norm before scaling: 43.689553666859254. Distance: 1.3571376585323034
Total norm for 4 adversaries is: 43.689553666859254. distance: 1.3571376585323034
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0541, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4289/4662 (91.9991%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4278/4662 (91.7632%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9808, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3300/3616 (91.2611%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3304/3616 (91.3717%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7403, Accuracy: 6001/10000 (60.0100%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3593/3828 (93.8610%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3541/3828 (92.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8721, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3065/3297 (92.9633%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3087/3297 (93.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8502, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3978/4361 (91.2176%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3766/4361 (86.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9559, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4244/4576 (92.7448%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4202/4576 (91.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9554, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3960/4295 (92.2002%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3947/4295 (91.8976%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9029, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4632/5083 (91.1273%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4527/5083 (89.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1831, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4689/5116 (91.6536%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4623/5116 (90.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0646, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3787/4046 (93.5986%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3780/4046 (93.4256%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7941, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5390/5902 (91.3250%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5111/5902 (86.5978%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.3541, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4804/5197 (92.4379%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4651/5197 (89.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2110, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4156/4465 (93.0795%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4153/4465 (93.0123%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9929, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3437/3704 (92.7916%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3435/3704 (92.7376%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8431, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3603/3861 (93.3178%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3572/3861 (92.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0092, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3847/4126 (93.2380%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3852/4126 (93.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7602, Accuracy: 5873/10000 (58.7300%)
time spent on training: 257.796462059021
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [18, 13, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2504, Accuracy: 6786/10000 (67.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0979, Accuracy: 9642/9900 (97.3939%)
Done in 286.98607420921326 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4753/4885 (97.2979%), train_poison_data_count: 385
Global model norm: 43.73683814294522.
Norm before scaling: 43.70670709533249. Distance: 1.2211048655330463
Total norm for 4 adversaries is: 43.70670709533249. distance: 1.2211048655330463
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1007, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5128/5305 (96.6635%), train_poison_data_count: 415
Global model norm: 43.73683814294522.
Norm before scaling: 43.7063384253896. Distance: 1.344764814199847
Total norm for 4 adversaries is: 43.7063384253896. distance: 1.344764814199847
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0944, Accuracy: 9665/9900 (97.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4559/4717 (96.6504%), train_poison_data_count: 370
Global model norm: 43.73683814294522.
Norm before scaling: 43.70836048592063. Distance: 1.2213229871510163
Total norm for 4 adversaries is: 43.70836048592063. distance: 1.2213229871510163
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0439, Accuracy: 9782/9900 (98.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4867/5066 (96.0719%), train_poison_data_count: 400
Global model norm: 43.73683814294522.
Norm before scaling: 43.71106107556258. Distance: 1.3799192689694897
Total norm for 4 adversaries is: 43.71106107556258. distance: 1.3799192689694897
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0284, Accuracy: 9833/9900 (99.3232%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4156/4511 (92.1303%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4117/4511 (91.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0059, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5232/5740 (91.1498%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5129/5740 (89.3554%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1170, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4296/4662 (92.1493%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4268/4662 (91.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0050, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3908/4235 (92.2786%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3902/4235 (92.1370%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9425, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4828/5265 (91.6999%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4627/5265 (87.8822%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0017, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4167/4433 (93.9995%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4055/4433 (91.4730%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0410, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4247/4596 (92.4064%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4241/4596 (92.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0371, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4668/5055 (92.3442%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4584/5055 (90.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9693, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4525/5037 (89.8352%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4571/5037 (90.7485%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0853, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4238/4538 (93.3892%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4290/4538 (94.5350%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8748, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3556/3756 (94.6752%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3549/3756 (94.4888%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9078, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3741/4025 (92.9441%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3762/4025 (93.4658%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8749, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4730/5244 (90.1983%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4676/5244 (89.1686%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1379, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4334/4663 (92.9445%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4355/4663 (93.3948%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9477, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3607/3837 (94.0057%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3625/3837 (94.4749%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8934, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4125/4481 (92.0553%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3878/4481 (86.5432%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2380, Accuracy: 5201/10000 (52.0100%)
time spent on training: 265.69844698905945
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [9, 15, 18]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2510, Accuracy: 6793/10000 (67.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0900, Accuracy: 9659/9900 (97.5657%)
Done in 295.45503425598145 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4741/4885 (97.0522%), train_poison_data_count: 385
Global model norm: 43.757864806476505.
Norm before scaling: 43.728253523894594. Distance: 1.2176473960716103
Total norm for 4 adversaries is: 43.728253523894594. distance: 1.2176473960716103
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1074, Accuracy: 9613/9900 (97.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5122/5305 (96.5504%), train_poison_data_count: 415
Global model norm: 43.757864806476505.
Norm before scaling: 43.7287322748692. Distance: 1.3764989658549975
Total norm for 4 adversaries is: 43.7287322748692. distance: 1.3764989658549975
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0539, Accuracy: 9756/9900 (98.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4556/4717 (96.5868%), train_poison_data_count: 370
Global model norm: 43.757864806476505.
Norm before scaling: 43.730271779647964. Distance: 1.2338292810848532
Total norm for 4 adversaries is: 43.730271779647964. distance: 1.2338292810848532
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0330, Accuracy: 9813/9900 (99.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4877/5066 (96.2692%), train_poison_data_count: 400
Global model norm: 43.757864806476505.
Norm before scaling: 43.73249231165613. Distance: 1.3901173382913183
Total norm for 4 adversaries is: 43.73249231165613. distance: 1.3901173382913183
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0189, Accuracy: 9849/9900 (99.4848%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4101/4362 (94.0165%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3869/4362 (88.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0478, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5047/5591 (90.2701%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4948/5591 (88.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2054, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4042/4315 (93.6732%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3991/4315 (92.4913%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9732, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3552/3781 (93.9434%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3297/3781 (87.1992%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2771, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3832/4158 (92.1597%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3797/4158 (91.3179%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9463, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4133/4511 (91.6205%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4153/4511 (92.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0082, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4434/4793 (92.5099%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4398/4793 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9524, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4925/5424 (90.8001%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4962/5424 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3941, Accuracy: 4956/10000 (49.5600%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4324/4618 (93.6336%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4152/4618 (89.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1870, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4004/4368 (91.6667%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3967/4368 (90.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9981, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4448/4934 (90.1500%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3965/4934 (80.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3042, Accuracy: 4888/10000 (48.8800%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4788/5232 (91.5138%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4698/5232 (89.7936%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9428, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5386/5902 (91.2572%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5188/5902 (87.9024%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2071, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4995/5392 (92.6372%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4883/5392 (90.5601%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1125, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4650/5017 (92.6849%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4554/5017 (90.7714%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8853, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4762/5195 (91.6651%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4583/5195 (88.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1651, Accuracy: 5242/10000 (52.4200%)
time spent on training: 270.8768906593323
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [9, 15, 19]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2490, Accuracy: 6794/10000 (67.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0842, Accuracy: 9675/9900 (97.7273%)
Done in 300.26028752326965 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4739/4885 (97.0113%), train_poison_data_count: 385
Global model norm: 43.78080528191336.
Norm before scaling: 43.75194471124255. Distance: 1.257919449139239
Total norm for 4 adversaries is: 43.75194471124255. distance: 1.257919449139239
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1051, Accuracy: 9615/9900 (97.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5112/5305 (96.3619%), train_poison_data_count: 415
Global model norm: 43.78080528191336.
Norm before scaling: 43.75142157288649. Distance: 1.3981948727305957
Total norm for 4 adversaries is: 43.75142157288649. distance: 1.3981948727305957
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0413, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4568/4717 (96.8412%), train_poison_data_count: 370
Global model norm: 43.78080528191336.
Norm before scaling: 43.75187356479363. Distance: 1.200085801792319
Total norm for 4 adversaries is: 43.75187356479363. distance: 1.200085801792319
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0578, Accuracy: 9748/9900 (98.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4876/5066 (96.2495%), train_poison_data_count: 400
Global model norm: 43.78080528191336.
Norm before scaling: 43.75680611121757. Distance: 1.4303408104576576
Total norm for 4 adversaries is: 43.75680611121757. distance: 1.4303408104576576
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0764, Accuracy: 9711/9900 (98.0909%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4832/5265 (91.7759%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4642/5265 (88.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9870, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3853/4126 (93.3834%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3854/4126 (93.4077%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0044, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4159/4501 (92.4017%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4074/4501 (90.5132%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0969, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5583/6124 (91.1659%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5412/6124 (88.3736%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1110, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3024/3271 (92.4488%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3077/3271 (94.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8252, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4344/4663 (93.1589%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4332/4663 (92.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9167, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3759/4025 (93.3913%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3723/4025 (92.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8796, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4255/4651 (91.4857%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4225/4651 (90.8407%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0340, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4393/4804 (91.4446%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4012/4804 (83.5137%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.6381, Accuracy: 4638/10000 (46.3800%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3348/3616 (92.5885%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3350/3616 (92.6438%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8186, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3635/3911 (92.9430%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3520/3911 (90.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1187, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4810/5197 (92.5534%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4713/5197 (90.6869%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1768, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4255/4538 (93.7638%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4285/4538 (94.4249%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8565, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5760/6391 (90.1267%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5629/6391 (88.0770%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1713, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3453/3704 (93.2235%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3454/3704 (93.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8673, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3921/4235 (92.5856%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3799/4235 (89.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0407, Accuracy: 5529/10000 (55.2900%)
time spent on training: 259.3674056529999
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [10, 8, 19]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2584, Accuracy: 6761/10000 (67.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0831, Accuracy: 9680/9900 (97.7778%)
Done in 289.2526910305023 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4751/4885 (97.2569%), train_poison_data_count: 385
Global model norm: 43.802051903724355.
Norm before scaling: 43.771388466008105. Distance: 1.234542642146605
Total norm for 4 adversaries is: 43.771388466008105. distance: 1.234542642146605
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0646, Accuracy: 9732/9900 (98.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5113/5305 (96.3808%), train_poison_data_count: 415
Global model norm: 43.802051903724355.
Norm before scaling: 43.77289579465814. Distance: 1.3831640971122716
Total norm for 4 adversaries is: 43.77289579465814. distance: 1.3831640971122716
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0335, Accuracy: 9817/9900 (99.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4573/4717 (96.9472%), train_poison_data_count: 370
Global model norm: 43.802051903724355.
Norm before scaling: 43.77250537223681. Distance: 1.2061000058698452
Total norm for 4 adversaries is: 43.77250537223681. distance: 1.2061000058698452
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0692, Accuracy: 9723/9900 (98.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4897/5066 (96.6640%), train_poison_data_count: 400
Global model norm: 43.802051903724355.
Norm before scaling: 43.77592842167585. Distance: 1.371823195606811
Total norm for 4 adversaries is: 43.77592842167585. distance: 1.371823195606811
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0487, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4762/5116 (93.0805%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4659/5116 (91.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9990, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5188/5582 (92.9416%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5153/5582 (92.3146%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1831, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3948/4235 (93.2231%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3807/4235 (89.8937%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0310, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4177/4625 (90.3135%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4027/4625 (87.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3954, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4124/4481 (92.0330%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3983/4481 (88.8864%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2039, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4757/5232 (90.9213%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4643/5232 (88.7424%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1720, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4332/4662 (92.9215%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4282/4662 (91.8490%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0201, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4185/4441 (94.2355%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4146/4441 (93.3574%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9655, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4202/4518 (93.0058%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4189/4518 (92.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0055, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4586/4928 (93.0601%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4503/4928 (91.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0048, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4236/4634 (91.4113%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4187/4634 (90.3539%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8896, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4533/4934 (91.8727%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4228/4934 (85.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.4100, Accuracy: 4927/10000 (49.2700%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3610/3861 (93.4991%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3549/3861 (91.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8377, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3310/3616 (91.5376%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3305/3616 (91.3993%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8553, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4053/4416 (91.7799%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4034/4416 (91.3496%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1013, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3525/3797 (92.8364%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3494/3797 (92.0200%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9267, Accuracy: 5642/10000 (56.4200%)
time spent on training: 265.8584315776825
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 12, 8]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2542, Accuracy: 6770/10000 (67.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0842, Accuracy: 9676/9900 (97.7374%)
Done in 295.6517758369446 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4747/4885 (97.1750%), train_poison_data_count: 385
Global model norm: 43.82256398543806.
Norm before scaling: 43.79320968876054. Distance: 1.2510729476401756
Total norm for 4 adversaries is: 43.79320968876054. distance: 1.2510729476401756
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0987, Accuracy: 9631/9900 (97.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5134/5305 (96.7766%), train_poison_data_count: 415
Global model norm: 43.82256398543806.
Norm before scaling: 43.79069117733885. Distance: 1.3295171285604026
Total norm for 4 adversaries is: 43.79069117733885. distance: 1.3295171285604026
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0443, Accuracy: 9784/9900 (98.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4545/4717 (96.3536%), train_poison_data_count: 370
Global model norm: 43.82256398543806.
Norm before scaling: 43.79453090855067. Distance: 1.2573063939877291
Total norm for 4 adversaries is: 43.79453090855067. distance: 1.2573063939877291
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0458, Accuracy: 9780/9900 (98.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4915/5066 (97.0193%), train_poison_data_count: 400
Global model norm: 43.82256398543806.
Norm before scaling: 43.79495318874867. Distance: 1.2997312231246552
Total norm for 4 adversaries is: 43.79495318874867. distance: 1.2997312231246552
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0949, Accuracy: 9655/9900 (97.5253%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5743/6263 (91.6973%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5671/6263 (90.5477%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2284, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3993/4295 (92.9686%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3871/4295 (90.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9923, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4594/4989 (92.0826%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4468/4989 (89.5570%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0643, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3917/4223 (92.7540%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3931/4223 (93.0855%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1243, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5575/6124 (91.0353%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5389/6124 (87.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1091, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4074/4481 (90.9172%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3906/4481 (87.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1816, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4291/4618 (92.9190%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4244/4618 (91.9013%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9027, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4199/4441 (94.5508%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4145/4441 (93.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9721, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3729/4013 (92.9230%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3750/4013 (93.4463%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8833, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4145/4511 (91.8865%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4108/4511 (91.0663%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0551, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4098/4416 (92.7989%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4077/4416 (92.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9088, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4536/4956 (91.5254%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4409/4956 (88.9629%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3064, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4273/4538 (94.1604%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4244/4538 (93.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7859, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4827/5265 (91.6809%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4685/5265 (88.9839%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9915, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4829/5197 (92.9190%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4775/5197 (91.8799%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0607, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4291/4716 (90.9881%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4214/4716 (89.3554%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3287, Accuracy: 5100/10000 (51.0000%)
time spent on training: 266.5865468978882
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 7, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2527, Accuracy: 6773/10000 (67.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0859, Accuracy: 9672/9900 (97.6970%)
Done in 296.1098334789276 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4754/4885 (97.3183%), train_poison_data_count: 385
Global model norm: 43.84388642619544.
Norm before scaling: 43.81512730620984. Distance: 1.244493850557944
Total norm for 4 adversaries is: 43.81512730620984. distance: 1.244493850557944
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1023, Accuracy: 9638/9900 (97.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5129/5305 (96.6824%), train_poison_data_count: 415
Global model norm: 43.84388642619544.
Norm before scaling: 43.81419954799186. Distance: 1.3511722861358555
Total norm for 4 adversaries is: 43.81419954799186. distance: 1.3511722861358555
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0568, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4558/4717 (96.6292%), train_poison_data_count: 370
Global model norm: 43.84388642619544.
Norm before scaling: 43.81503536708318. Distance: 1.255463438372957
Total norm for 4 adversaries is: 43.81503536708318. distance: 1.255463438372957
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1565, Accuracy: 9473/9900 (95.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4906/5066 (96.8417%), train_poison_data_count: 400
Global model norm: 43.84388642619544.
Norm before scaling: 43.81485984639657. Distance: 1.3190135547817767
Total norm for 4 adversaries is: 43.81485984639657. distance: 1.3190135547817767
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0432, Accuracy: 9790/9900 (98.8889%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3352/3616 (92.6991%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3393/3616 (93.8330%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9382, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4051/4315 (93.8818%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4045/4315 (93.7428%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8497, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5038/5455 (92.3556%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4930/5455 (90.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0692, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4386/4804 (91.2989%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4033/4804 (83.9509%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.4927, Accuracy: 4859/10000 (48.5900%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4105/4362 (94.1082%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4140/4362 (94.9106%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7835, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5766/6263 (92.0645%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5749/6263 (91.7931%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0788, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4272/4538 (94.1384%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4259/4538 (93.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9320, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4254/4634 (91.7997%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4238/4634 (91.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9335, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4695/5116 (91.7709%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4639/5116 (90.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1525, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4223/4716 (89.5462%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4286/4716 (90.8821%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9547, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3770/4046 (93.1784%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3758/4046 (92.8819%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9081, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4152/4518 (91.8991%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4085/4518 (90.4161%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9934, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4660/5063 (92.0403%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4439/5063 (87.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1849, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5289/5740 (92.1429%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5150/5740 (89.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0794, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5216/5582 (93.4432%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5059/5582 (90.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2354, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4159/4433 (93.8191%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4127/4433 (93.0972%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8960, Accuracy: 5748/10000 (57.4800%)
time spent on training: 270.96220088005066
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 10, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2585, Accuracy: 6773/10000 (67.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0885, Accuracy: 9665/9900 (97.6263%)
Done in 300.33154225349426 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4752/4885 (97.2774%), train_poison_data_count: 385
Global model norm: 43.86554496590975.
Norm before scaling: 43.83354745868169. Distance: 1.2295880268972113
Total norm for 4 adversaries is: 43.83354745868169. distance: 1.2295880268972113
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0695, Accuracy: 9733/9900 (98.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5116/5305 (96.4373%), train_poison_data_count: 415
Global model norm: 43.86554496590975.
Norm before scaling: 43.83645057955836. Distance: 1.4046212406676764
Total norm for 4 adversaries is: 43.83645057955836. distance: 1.4046212406676764
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1393, Accuracy: 9553/9900 (96.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4558/4717 (96.6292%), train_poison_data_count: 370
Global model norm: 43.86554496590975.
Norm before scaling: 43.83509581374267. Distance: 1.184654541040153
Total norm for 4 adversaries is: 43.83509581374267. distance: 1.184654541040153
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1332, Accuracy: 9545/9900 (96.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4891/5066 (96.5456%), train_poison_data_count: 400
Global model norm: 43.86554496590975.
Norm before scaling: 43.83916277009419. Distance: 1.3862265559588358
Total norm for 4 adversaries is: 43.83916277009419. distance: 1.3862265559588358
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0358, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4817/5197 (92.6881%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4644/5197 (89.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1042, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3753/4025 (93.2422%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3799/4025 (94.3851%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8040, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4130/4481 (92.1669%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3982/4481 (88.8641%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1269, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4335/4651 (93.2058%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4284/4651 (92.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0538, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5365/5902 (90.9014%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5167/5902 (87.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1809, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3870/4126 (93.7954%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3841/4126 (93.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9814, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4009/4368 (91.7811%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3917/4368 (89.6749%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1604, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5754/6391 (90.0329%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5615/6391 (87.8579%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.3718, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3873/4175 (92.7665%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3750/4175 (89.8204%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9445, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4257/4596 (92.6240%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4260/4596 (92.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0003, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4267/4634 (92.0803%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4237/4634 (91.4329%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1935, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3942/4223 (93.3460%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3909/4223 (92.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8715, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3624/3911 (92.6617%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3487/3911 (89.1588%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1564, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4167/4433 (93.9995%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4108/4433 (92.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8514, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4001/4336 (92.2740%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3986/4336 (91.9280%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1425, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3319/3638 (91.2314%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3363/3638 (92.4409%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8888, Accuracy: 5757/10000 (57.5700%)
time spent on training: 265.04756927490234
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [18, 14, 4]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2562, Accuracy: 6767/10000 (67.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0873, Accuracy: 9667/9900 (97.6465%)
Done in 294.43867683410645 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4737/4885 (96.9703%), train_poison_data_count: 385
Global model norm: 43.885872996134104.
Norm before scaling: 43.85603779163423. Distance: 1.281566766798297
Total norm for 4 adversaries is: 43.85603779163423. distance: 1.281566766798297
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0681, Accuracy: 9732/9900 (98.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5146/5305 (97.0028%), train_poison_data_count: 415
Global model norm: 43.885872996134104.
Norm before scaling: 43.854970332353005. Distance: 1.3239878675446601
Total norm for 4 adversaries is: 43.854970332353005. distance: 1.3239878675446601
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0825, Accuracy: 9692/9900 (97.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4558/4717 (96.6292%), train_poison_data_count: 370
Global model norm: 43.885872996134104.
Norm before scaling: 43.85601413245323. Distance: 1.22557504352728
Total norm for 4 adversaries is: 43.85601413245323. distance: 1.22557504352728
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0745, Accuracy: 9703/9900 (98.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4876/5066 (96.2495%), train_poison_data_count: 400
Global model norm: 43.885872996134104.
Norm before scaling: 43.85803625049804. Distance: 1.3408614316943537
Total norm for 4 adversaries is: 43.85803625049804. distance: 1.3408614316943537
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0504, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3528/3756 (93.9297%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3557/3756 (94.7018%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9200, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5039/5424 (92.9019%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4990/5424 (91.9985%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.4379, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4154/4433 (93.7063%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4136/4433 (93.3002%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8367, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4146/4501 (92.1129%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4013/4501 (89.1580%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0699, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3749/4025 (93.1429%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3798/4025 (94.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9529, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3989/4235 (94.1913%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3887/4235 (91.7828%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9312, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5591/6124 (91.2965%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5408/6124 (88.3083%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0565, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4272/4634 (92.1882%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4270/4634 (92.1450%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9222, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4279/4716 (90.7337%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4224/4716 (89.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1469, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4347/4767 (91.1894%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4266/4767 (89.4902%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2698, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3512/3804 (92.3239%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3582/3804 (94.1640%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9035, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3245/3472 (93.4620%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3239/3472 (93.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9225, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5048/5392 (93.6202%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4898/5392 (90.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0925, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5328/5740 (92.8223%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5205/5740 (90.6794%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0925, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4248/4596 (92.4282%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4244/4596 (92.3412%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0726, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3364/3616 (93.0310%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3335/3616 (92.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8080, Accuracy: 5846/10000 (58.4600%)
time spent on training: 266.6781396865845
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 11 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [11, 16, 4]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2567, Accuracy: 6759/10000 (67.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0914, Accuracy: 9662/9900 (97.5960%)
Done in 295.82160353660583 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4746/4885 (97.1546%), train_poison_data_count: 385
Global model norm: 43.905079499522316.
Norm before scaling: 43.8745562321753. Distance: 1.260227183871935
Total norm for 4 adversaries is: 43.8745562321753. distance: 1.260227183871935
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0668, Accuracy: 9735/9900 (98.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5104/5305 (96.2111%), train_poison_data_count: 415
Global model norm: 43.905079499522316.
Norm before scaling: 43.875528620391. Distance: 1.3920477543318228
Total norm for 4 adversaries is: 43.875528620391. distance: 1.3920477543318228
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0466, Accuracy: 9792/9900 (98.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4566/4717 (96.7988%), train_poison_data_count: 370
Global model norm: 43.905079499522316.
Norm before scaling: 43.87725632998119. Distance: 1.2452416929937866
Total norm for 4 adversaries is: 43.87725632998119. distance: 1.2452416929937866
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1080, Accuracy: 9620/9900 (97.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4891/5066 (96.5456%), train_poison_data_count: 400
Global model norm: 43.905079499522316.
Norm before scaling: 43.8775526211688. Distance: 1.370193533697365
Total norm for 4 adversaries is: 43.8775526211688. distance: 1.370193533697365
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0170, Accuracy: 9861/9900 (99.6061%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4664/5063 (92.1193%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4541/5063 (89.6899%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9907, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4431/4804 (92.2356%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4105/4804 (85.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.5291, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4210/4558 (92.3651%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4089/4558 (89.7104%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1148, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3593/3756 (95.6603%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3570/3756 (95.0479%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8540, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4955/5424 (91.3532%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4950/5424 (91.2611%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2085, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4161/4511 (92.2412%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4175/4511 (92.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0317, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4787/5167 (92.6456%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4797/5167 (92.8392%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0533, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4044/4356 (92.8375%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3937/4356 (90.3811%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0673, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4726/5244 (90.1220%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4645/5244 (88.5774%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0290, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4423/4793 (92.2804%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4408/4793 (91.9675%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9779, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3589/3828 (93.7565%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3583/3828 (93.5998%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8785, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3787/4046 (93.5986%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3760/4046 (92.9313%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0187, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3754/4013 (93.5460%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3780/4013 (94.1939%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7598, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3005/3271 (91.8679%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2965/3271 (90.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1404, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4123/4362 (94.5209%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3933/4362 (90.1651%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1405, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4069/4346 (93.6263%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4121/4346 (94.8228%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8203, Accuracy: 5823/10000 (58.2300%)
time spent on training: 262.9361352920532
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [9, 6, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2591, Accuracy: 6761/10000 (67.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0839, Accuracy: 9680/9900 (97.7778%)
Done in 292.15268564224243 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4755/4885 (97.3388%), train_poison_data_count: 385
Global model norm: 43.9240719501242.
Norm before scaling: 43.89176112137604. Distance: 1.2113108889901352
Total norm for 4 adversaries is: 43.89176112137604. distance: 1.2113108889901352
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0919, Accuracy: 9673/9900 (97.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5105/5305 (96.2300%), train_poison_data_count: 415
Global model norm: 43.9240719501242.
Norm before scaling: 43.893963750280484. Distance: 1.3922566474842162
Total norm for 4 adversaries is: 43.893963750280484. distance: 1.3922566474842162
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0173, Accuracy: 9854/9900 (99.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4556/4717 (96.5868%), train_poison_data_count: 370
Global model norm: 43.9240719501242.
Norm before scaling: 43.89549606958911. Distance: 1.2383792489439929
Total norm for 4 adversaries is: 43.89549606958911. distance: 1.2383792489439929
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0611, Accuracy: 9730/9900 (98.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4916/5066 (97.0391%), train_poison_data_count: 400
Global model norm: 43.9240719501242.
Norm before scaling: 43.89454915262828. Distance: 1.2978259357479809
Total norm for 4 adversaries is: 43.89454915262828. distance: 1.2978259357479809
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0618, Accuracy: 9748/9900 (98.4646%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3872/4126 (93.8439%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3887/4126 (94.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8010, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5057/5455 (92.7039%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4939/5455 (90.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2559, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4234/4558 (92.8916%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4196/4558 (92.0579%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9416, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3957/4235 (93.4357%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3853/4235 (90.9799%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9511, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3544/3804 (93.1651%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3507/3804 (92.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0473, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5776/6391 (90.3771%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5619/6391 (87.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.3495, Accuracy: 4989/10000 (49.8900%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4008/4336 (92.4354%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3957/4336 (91.2592%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2605, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4358/4663 (93.4591%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4335/4663 (92.9659%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9233, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4132/4511 (91.5983%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4116/4511 (91.2436%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9272, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4137/4503 (91.8721%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4015/4503 (89.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9666, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4688/5063 (92.5933%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4263/5063 (84.1991%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.3514, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4076/4315 (94.4612%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4028/4315 (93.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9931, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3317/3638 (91.1765%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3368/3638 (92.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8758, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4230/4441 (95.2488%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4172/4441 (93.9428%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0382, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4344/4679 (92.8404%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4177/4679 (89.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2418, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4835/5265 (91.8329%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4684/5265 (88.9649%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0289, Accuracy: 5487/10000 (54.8700%)
time spent on training: 268.0800516605377
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 18, 19]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2650, Accuracy: 6747/10000 (67.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0840, Accuracy: 9682/9900 (97.7980%)
Done in 297.3213806152344 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4770/4885 (97.6459%), train_poison_data_count: 385
Global model norm: 43.94423818131266.
Norm before scaling: 43.9118004165203. Distance: 1.190022299501506
Total norm for 4 adversaries is: 43.9118004165203. distance: 1.190022299501506
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0632, Accuracy: 9749/9900 (98.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5120/5305 (96.5127%), train_poison_data_count: 415
Global model norm: 43.94423818131266.
Norm before scaling: 43.91497911447755. Distance: 1.4305826522005716
Total norm for 4 adversaries is: 43.91497911447755. distance: 1.4305826522005716
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0117, Accuracy: 9874/9900 (99.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4582/4717 (97.1380%), train_poison_data_count: 370
Global model norm: 43.94423818131266.
Norm before scaling: 43.913105559089644. Distance: 1.1717784587512405
Total norm for 4 adversaries is: 43.913105559089644. distance: 1.1717784587512405
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0764, Accuracy: 9709/9900 (98.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4895/5066 (96.6246%), train_poison_data_count: 400
Global model norm: 43.94423818131266.
Norm before scaling: 43.91553366042234. Distance: 1.3348807008708892
Total norm for 4 adversaries is: 43.91553366042234. distance: 1.3348807008708892
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0364, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3996/4336 (92.1587%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4005/4336 (92.3662%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0043, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3602/3828 (94.0961%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3575/3828 (93.3908%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9435, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3410/3672 (92.8649%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3374/3672 (91.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0251, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4308/4651 (92.6252%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4198/4651 (90.2602%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0904, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4017/4361 (92.1119%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3794/4361 (86.9984%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0586, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4654/5025 (92.6169%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4572/5025 (90.9851%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1172, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5612/6124 (91.6395%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5421/6124 (88.5206%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0873, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3462/3704 (93.4665%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3469/3704 (93.6555%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8284, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4507/4934 (91.3458%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4184/4934 (84.7994%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2455, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4678/5017 (93.2430%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4663/5017 (92.9440%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9179, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5211/5582 (93.3536%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5105/5582 (91.4547%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2812, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4781/5167 (92.5295%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4700/5167 (90.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0806, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3615/3861 (93.6286%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3539/3861 (91.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9352, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3369/3646 (92.4026%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3384/3646 (92.8140%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8039, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4200/4558 (92.1457%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4090/4558 (89.7323%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1063, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4760/5116 (93.0414%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4567/5116 (89.2690%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1499, Accuracy: 5210/10000 (52.1000%)
time spent on training: 266.0569112300873
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 13, 16]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2707, Accuracy: 6746/10000 (67.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0833, Accuracy: 9682/9900 (97.7980%)
Done in 295.1635901927948 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4757/4885 (97.3797%), train_poison_data_count: 385
Global model norm: 43.96461173444999.
Norm before scaling: 43.9331573467367. Distance: 1.2199087258887493
Total norm for 4 adversaries is: 43.9331573467367. distance: 1.2199087258887493
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0845, Accuracy: 9681/9900 (97.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5110/5305 (96.3242%), train_poison_data_count: 415
Global model norm: 43.96461173444999.
Norm before scaling: 43.93452159179613. Distance: 1.3970731334425814
Total norm for 4 adversaries is: 43.93452159179613. distance: 1.3970731334425814
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0240, Accuracy: 9838/9900 (99.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4554/4717 (96.5444%), train_poison_data_count: 370
Global model norm: 43.96461173444999.
Norm before scaling: 43.936659564775034. Distance: 1.2613227624386383
Total norm for 4 adversaries is: 43.936659564775034. distance: 1.2613227624386383
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0369, Accuracy: 9805/9900 (99.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4900/5066 (96.7233%), train_poison_data_count: 400
Global model norm: 43.96461173444999.
Norm before scaling: 43.934461854864715. Distance: 1.3417034088853432
Total norm for 4 adversaries is: 43.934461854864715. distance: 1.3417034088853432
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0325, Accuracy: 9820/9900 (99.1919%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4174/4511 (92.5294%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4104/4511 (90.9776%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9652, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4113/4346 (94.6387%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4102/4346 (94.3856%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8550, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4489/4804 (93.4430%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4349/4804 (90.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0416, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4762/5232 (91.0168%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4677/5232 (89.3922%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2893, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4362/4618 (94.4565%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4281/4618 (92.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9301, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3353/3590 (93.3983%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3305/3590 (92.0613%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0667, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5819/6391 (91.0499%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5656/6391 (88.4995%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2285, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4021/4354 (92.3519%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0160, Accuracy: 3124/4354 (71.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 3.1792, Accuracy: 3847/10000 (38.4700%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4697/5055 (92.9179%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4593/5055 (90.8605%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9609, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3620/3837 (94.3445%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3617/3837 (94.2664%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8329, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4192/4503 (93.0935%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4131/4503 (91.7388%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9685, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4274/4576 (93.4003%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4259/4576 (93.0726%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9371, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4483/4793 (93.5322%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4463/4793 (93.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0245, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4315/4634 (93.1161%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4279/4634 (92.3392%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8609, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3749/4158 (90.1635%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3748/4158 (90.1395%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8846, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5306/5740 (92.4390%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5240/5740 (91.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2897, Accuracy: 5093/10000 (50.9300%)
time spent on training: 269.17805337905884
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [18, 12, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2779, Accuracy: 6724/10000 (67.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0794, Accuracy: 9694/9900 (97.9192%)
Done in 298.7970497608185 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4761/4885 (97.4616%), train_poison_data_count: 385
Global model norm: 43.9852367255729.
Norm before scaling: 43.954306718472566. Distance: 1.2343614794799478
Total norm for 4 adversaries is: 43.954306718472566. distance: 1.2343614794799478
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0596, Accuracy: 9744/9900 (98.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5140/5305 (96.8897%), train_poison_data_count: 415
Global model norm: 43.9852367255729.
Norm before scaling: 43.95260009018238. Distance: 1.3348412282161475
Total norm for 4 adversaries is: 43.95260009018238. distance: 1.3348412282161475
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0593, Accuracy: 9749/9900 (98.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4567/4717 (96.8200%), train_poison_data_count: 370
Global model norm: 43.9852367255729.
Norm before scaling: 43.95370961440214. Distance: 1.178689395483297
Total norm for 4 adversaries is: 43.95370961440214. distance: 1.178689395483297
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0395, Accuracy: 9789/9900 (98.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4917/5066 (97.0588%), train_poison_data_count: 400
Global model norm: 43.9852367255729.
Norm before scaling: 43.952872266425885. Distance: 1.2457303560665265
Total norm for 4 adversaries is: 43.952872266425885. distance: 1.2457303560665265
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0662, Accuracy: 9737/9900 (98.3535%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3886/4184 (92.8776%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3872/4184 (92.5430%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9157, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5866/6263 (93.6612%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5736/6263 (91.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2003, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4203/4456 (94.3223%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4172/4456 (93.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8522, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4284/4538 (94.4028%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4289/4538 (94.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9579, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3961/4235 (93.5301%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3865/4235 (91.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0285, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3919/4223 (92.8013%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3954/4223 (93.6301%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9697, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5041/5455 (92.4106%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4929/5455 (90.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0561, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4648/5037 (92.2771%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4671/5037 (92.7338%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9630, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3594/3756 (95.6869%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3603/3756 (95.9265%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.7514, Accuracy: 6051/10000 (60.5100%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4879/5265 (92.6686%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4706/5265 (89.3827%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1384, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4677/5055 (92.5223%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4622/5055 (91.4342%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9690, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4434/4804 (92.2981%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4119/4804 (85.7410%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2854, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4624/5063 (91.3293%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4342/5063 (85.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2362, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3998/4295 (93.0850%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3643/4295 (84.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3260, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3024/3271 (92.4488%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3023/3271 (92.4182%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0201, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4083/4356 (93.7328%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3958/4356 (90.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1020, Accuracy: 5337/10000 (53.3700%)
time spent on training: 268.15738248825073
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [5, 7, 8]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.2922, Accuracy: 6709/10000 (67.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0758, Accuracy: 9699/9900 (97.9697%)
Done in 297.7024941444397 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4747/4885 (97.1750%), train_poison_data_count: 385
Global model norm: 44.00512526745819.
Norm before scaling: 43.97462286426897. Distance: 1.262607556662084
Total norm for 4 adversaries is: 43.97462286426897. distance: 1.262607556662084
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1263, Accuracy: 9587/9900 (96.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5133/5305 (96.7578%), train_poison_data_count: 415
Global model norm: 44.00512526745819.
Norm before scaling: 43.972066161815306. Distance: 1.3312797775878271
Total norm for 4 adversaries is: 43.972066161815306. distance: 1.3312797775878271
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0278, Accuracy: 9820/9900 (99.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4568/4717 (96.8412%), train_poison_data_count: 370
Global model norm: 44.00512526745819.
Norm before scaling: 43.97471030586074. Distance: 1.200085007120279
Total norm for 4 adversaries is: 43.97471030586074. distance: 1.200085007120279
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0852, Accuracy: 9666/9900 (97.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4902/5066 (96.7627%), train_poison_data_count: 400
Global model norm: 44.00512526745819.
Norm before scaling: 43.97722105453786. Distance: 1.362767819671769
Total norm for 4 adversaries is: 43.97722105453786. distance: 1.362767819671769
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0360, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4198/4503 (93.2267%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4148/4503 (92.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0520, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4193/4456 (94.0978%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4154/4456 (93.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9262, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4899/5265 (93.0484%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4703/5265 (89.3257%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1024, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4498/4793 (93.8452%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4472/4793 (93.3027%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9211, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4568/4928 (92.6948%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4499/4928 (91.2946%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9394, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3326/3638 (91.4239%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3300/3638 (90.7092%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9574, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4337/4663 (93.0088%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4340/4663 (93.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9828, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4419/4928 (89.6713%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4397/4928 (89.2248%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1927, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4203/4465 (94.1321%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4125/4465 (92.3852%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8925, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3634/3911 (92.9174%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3519/3911 (89.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1396, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4215/4518 (93.2935%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4191/4518 (92.7623%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9946, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3979/4235 (93.9551%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3758/4235 (88.7367%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2278, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4541/4934 (92.0349%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4411/4934 (89.4001%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0996, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4286/4647 (92.2315%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4272/4647 (91.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9568, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4334/4651 (93.1843%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4268/4651 (91.7652%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0059, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4584/4989 (91.8821%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4525/4989 (90.6995%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0492, Accuracy: 5443/10000 (54.4300%)
time spent on training: 264.5751976966858
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 18, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2872, Accuracy: 6719/10000 (67.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0759, Accuracy: 9699/9900 (97.9697%)
Done in 293.85373854637146 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4751/4885 (97.2569%), train_poison_data_count: 385
Global model norm: 44.02461525154848.
Norm before scaling: 43.99235468246514. Distance: 1.2357788312027127
Total norm for 4 adversaries is: 43.99235468246514. distance: 1.2357788312027127
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0328, Accuracy: 9807/9900 (99.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5146/5305 (97.0028%), train_poison_data_count: 415
Global model norm: 44.02461525154848.
Norm before scaling: 43.99185105203434. Distance: 1.3309966961212767
Total norm for 4 adversaries is: 43.99185105203434. distance: 1.3309966961212767
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0452, Accuracy: 9791/9900 (98.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4565/4717 (96.7776%), train_poison_data_count: 370
Global model norm: 44.02461525154848.
Norm before scaling: 43.99541935052017. Distance: 1.2304097963772798
Total norm for 4 adversaries is: 43.99541935052017. distance: 1.2304097963772798
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0514, Accuracy: 9758/9900 (98.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4911/5066 (96.9404%), train_poison_data_count: 400
Global model norm: 44.02461525154848.
Norm before scaling: 43.99575369025331. Distance: 1.3461273366288096
Total norm for 4 adversaries is: 43.99575369025331. distance: 1.3461273366288096
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0556, Accuracy: 9755/9900 (98.5354%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4289/4538 (94.5130%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4271/4538 (94.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8770, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4132/4362 (94.7272%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4011/4362 (91.9532%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2217, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4752/5244 (90.6178%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4633/5244 (88.3486%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0166, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3786/4046 (93.5739%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3689/4046 (91.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8902, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3727/4013 (92.8732%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3752/4013 (93.4961%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8443, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4195/4465 (93.9530%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4129/4465 (92.4748%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9170, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4787/5232 (91.4946%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4741/5232 (90.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1279, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4612/4928 (93.5877%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4539/4928 (92.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8916, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4668/5063 (92.1983%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4466/5063 (88.2086%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2483, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5397/5902 (91.4436%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5126/5902 (86.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.4020, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4238/4456 (95.1077%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4176/4456 (93.7163%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9160, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4290/4596 (93.3420%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4259/4596 (92.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0273, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4194/4441 (94.4382%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4140/4441 (93.2222%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9238, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5343/5740 (93.0836%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5220/5740 (90.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2173, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3281/3472 (94.4988%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3250/3472 (93.6060%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8811, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3617/3861 (93.6804%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3566/3861 (92.3595%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9176, Accuracy: 5696/10000 (56.9600%)
time spent on training: 266.6456232070923
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 11, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.3036, Accuracy: 6692/10000 (66.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0716, Accuracy: 9709/9900 (98.0707%)
Done in 295.66333389282227 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.043633760223365.
Norm before scaling: 44.01070204542584. Distance: 1.1885110666725098
Total norm for 4 adversaries is: 44.01070204542584. distance: 1.1885110666725098
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0577, Accuracy: 9738/9900 (98.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5129/5305 (96.6824%), train_poison_data_count: 415
Global model norm: 44.043633760223365.
Norm before scaling: 44.011039042690044. Distance: 1.3562851351920104
Total norm for 4 adversaries is: 44.011039042690044. distance: 1.3562851351920104
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0512, Accuracy: 9777/9900 (98.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4570/4717 (96.8836%), train_poison_data_count: 370
Global model norm: 44.043633760223365.
Norm before scaling: 44.01249517404475. Distance: 1.2024138194110447
Total norm for 4 adversaries is: 44.01249517404475. distance: 1.2024138194110447
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0360, Accuracy: 9804/9900 (99.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4931/5066 (97.3352%), train_poison_data_count: 400
Global model norm: 44.043633760223365.
Norm before scaling: 44.010570296822586. Distance: 1.2349955773370913
Total norm for 4 adversaries is: 44.010570296822586. distance: 1.2349955773370913
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0858, Accuracy: 9690/9900 (97.8788%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3580/3797 (94.2850%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3552/3797 (93.5475%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9685, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3089/3297 (93.6912%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3084/3297 (93.5396%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7561, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3688/3911 (94.2981%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3617/3911 (92.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9220, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3006/3271 (91.8985%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2921/3271 (89.2999%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9639, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3812/4046 (94.2165%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3697/4046 (91.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1140, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5323/5740 (92.7352%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5200/5740 (90.5923%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1805, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3726/3969 (93.8776%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3665/3969 (92.3406%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1037, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3471/3704 (93.7095%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3435/3704 (92.7376%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8674, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4380/4767 (91.8817%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4233/4767 (88.7980%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.4441, Accuracy: 4886/10000 (48.8600%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4525/4956 (91.3035%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4452/4956 (89.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1545, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3381/3590 (94.1783%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3370/3590 (93.8719%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0512, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5423/5902 (91.8841%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5153/5902 (87.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2409, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4619/4928 (93.7297%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4509/4928 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9436, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3998/4235 (94.4038%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3912/4235 (92.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0357, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4807/5265 (91.3010%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4691/5265 (89.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9787, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4087/4356 (93.8246%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3682/4356 (84.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3917, Accuracy: 4898/10000 (48.9800%)
time spent on training: 261.7726719379425
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 12, 4]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.3147, Accuracy: 6688/10000 (66.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0715, Accuracy: 9714/9900 (98.1212%)
Done in 290.85789346694946 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4764/4885 (97.5230%), train_poison_data_count: 385
Global model norm: 44.062761801083944.
Norm before scaling: 44.0289835404085. Distance: 1.1811976083106692
Total norm for 4 adversaries is: 44.0289835404085. distance: 1.1811976083106692
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1336, Accuracy: 9567/9900 (96.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5136/5305 (96.8143%), train_poison_data_count: 415
Global model norm: 44.062761801083944.
Norm before scaling: 44.030242236959275. Distance: 1.3533925802826523
Total norm for 4 adversaries is: 44.030242236959275. distance: 1.3533925802826523
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0631, Accuracy: 9748/9900 (98.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4588/4717 (97.2652%), train_poison_data_count: 370
Global model norm: 44.062761801083944.
Norm before scaling: 44.03176704141071. Distance: 1.1820683485463397
Total norm for 4 adversaries is: 44.03176704141071. distance: 1.1820683485463397
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0717, Accuracy: 9722/9900 (98.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4933/5066 (97.3747%), train_poison_data_count: 400
Global model norm: 44.062761801083944.
Norm before scaling: 44.030239464539456. Distance: 1.2370015460215154
Total norm for 4 adversaries is: 44.030239464539456. distance: 1.2370015460215154
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0264, Accuracy: 9842/9900 (99.4141%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3805/4025 (94.5342%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3781/4025 (93.9379%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8541, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5362/5902 (90.8506%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5136/5902 (87.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1413, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4488/4793 (93.6366%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4507/4793 (94.0330%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8606, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4842/5265 (91.9658%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4751/5265 (90.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0613, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4027/4295 (93.7602%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3952/4295 (92.0140%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9557, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3472/3704 (93.7365%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3417/3704 (92.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7887, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4740/5116 (92.6505%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4713/5116 (92.1228%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9969, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5355/5740 (93.2927%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5212/5740 (90.8014%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0740, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3579/3797 (94.2586%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3522/3797 (92.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8657, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4318/4716 (91.5606%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4264/4716 (90.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1313, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4134/4433 (93.2551%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4105/4433 (92.6009%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8834, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4034/4416 (91.3496%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4001/4416 (90.6024%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0193, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3944/4223 (93.3933%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3956/4223 (93.6775%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9508, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4647/5083 (91.4224%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4468/5083 (87.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1607, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4255/4576 (92.9851%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4223/4576 (92.2858%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0127, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4896/5392 (90.8012%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4745/5392 (88.0007%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3539, Accuracy: 5068/10000 (50.6800%)
time spent on training: 265.4376685619354
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [5, 16, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.3094, Accuracy: 6691/10000 (66.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0756, Accuracy: 9700/9900 (97.9798%)
Done in 294.53660345077515 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4741/4885 (97.0522%), train_poison_data_count: 385
Global model norm: 44.083054270639245.
Norm before scaling: 44.051465539876624. Distance: 1.2620793822209768
Total norm for 4 adversaries is: 44.051465539876624. distance: 1.2620793822209768
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0719, Accuracy: 9706/9900 (98.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5138/5305 (96.8520%), train_poison_data_count: 415
Global model norm: 44.083054270639245.
Norm before scaling: 44.04998021379735. Distance: 1.3391489167966821
Total norm for 4 adversaries is: 44.04998021379735. distance: 1.3391489167966821
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0468, Accuracy: 9782/9900 (98.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4568/4717 (96.8412%), train_poison_data_count: 370
Global model norm: 44.083054270639245.
Norm before scaling: 44.05415479483746. Distance: 1.2339357487878109
Total norm for 4 adversaries is: 44.05415479483746. distance: 1.2339357487878109
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0556, Accuracy: 9755/9900 (98.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4899/5066 (96.7035%), train_poison_data_count: 400
Global model norm: 44.083054270639245.
Norm before scaling: 44.05348145737888. Distance: 1.3376901740945852
Total norm for 4 adversaries is: 44.05348145737888. distance: 1.3376901740945852
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0274, Accuracy: 9833/9900 (99.3232%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4916/5265 (93.3713%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4757/5265 (90.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0727, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4100/4356 (94.1230%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3705/4356 (85.0551%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.8419, Accuracy: 4414/10000 (44.1400%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3580/3756 (95.3142%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3567/3756 (94.9681%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8245, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3603/3837 (93.9015%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3620/3837 (94.3445%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7663, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5345/5740 (93.1185%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5208/5740 (90.7317%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1218, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3934/4223 (93.1565%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3931/4223 (93.0855%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9477, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4226/4465 (94.6473%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4208/4465 (94.2441%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8769, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5069/5591 (90.6636%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4986/5591 (89.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1076, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5411/5902 (91.6808%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5260/5902 (89.1223%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1851, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4610/4918 (93.7373%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4505/4918 (91.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0684, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3583/3861 (92.7998%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3576/3861 (92.6185%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9677, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4001/4295 (93.1548%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3807/4295 (88.6380%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0755, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3771/4158 (90.6926%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3714/4158 (89.3218%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0162, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5831/6263 (93.1023%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5754/6263 (91.8729%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1339, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4080/4354 (93.7069%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3569/4354 (81.9706%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.7956, Accuracy: 4513/10000 (45.1300%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3571/3797 (94.0479%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3537/3797 (93.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9091, Accuracy: 5685/10000 (56.8500%)
time spent on training: 269.09609627723694
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 15, 10]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.3107, Accuracy: 6692/10000 (66.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0743, Accuracy: 9700/9900 (97.9798%)
Done in 298.5046124458313 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4770/4885 (97.6459%), train_poison_data_count: 385
Global model norm: 44.10401689915132.
Norm before scaling: 44.068667841807546. Distance: 1.169205588012168
Total norm for 4 adversaries is: 44.068667841807546. distance: 1.169205588012168
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0945, Accuracy: 9648/9900 (97.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5151/5305 (97.0971%), train_poison_data_count: 415
Global model norm: 44.10401689915132.
Norm before scaling: 44.069800758197076. Distance: 1.303511312110083
Total norm for 4 adversaries is: 44.069800758197076. distance: 1.303511312110083
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0735, Accuracy: 9716/9900 (98.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4571/4717 (96.9048%), train_poison_data_count: 370
Global model norm: 44.10401689915132.
Norm before scaling: 44.071340812989654. Distance: 1.1838084111208271
Total norm for 4 adversaries is: 44.071340812989654. distance: 1.1838084111208271
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0316, Accuracy: 9811/9900 (99.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4925/5066 (97.2167%), train_poison_data_count: 400
Global model norm: 44.10401689915132.
Norm before scaling: 44.07189616127266. Distance: 1.2541061669814535
Total norm for 4 adversaries is: 44.07189616127266. distance: 1.2541061669814535
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0380, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3616/3797 (95.2331%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3545/3797 (93.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9376, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4674/5037 (92.7933%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4598/5037 (91.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0828, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4539/4934 (91.9943%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4474/4934 (90.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1962, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5097/5455 (93.4372%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4952/5455 (90.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9471, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5405/5902 (91.5791%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5071/5902 (85.9200%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1976, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5836/6391 (91.3159%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5614/6391 (87.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3043, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3667/3911 (93.7612%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3402/3911 (86.9854%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1362, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4779/5195 (91.9923%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4509/5195 (86.7950%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4321, Accuracy: 4903/10000 (49.0300%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3976/4235 (93.8843%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3902/4235 (92.1370%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1611, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4811/5116 (94.0383%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4680/5116 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8430, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4288/4538 (94.4910%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4253/4538 (93.7197%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8152, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5249/5582 (94.0344%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5161/5582 (92.4579%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1145, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4218/4558 (92.5406%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4089/4558 (89.7104%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1727, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3803/4046 (93.9941%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3753/4046 (92.7583%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8344, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3630/3828 (94.8276%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3588/3828 (93.7304%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8861, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4683/5055 (92.6409%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4596/5055 (90.9199%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0050, Accuracy: 5435/10000 (54.3500%)
time spent on training: 270.55508255958557
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [10, 6, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.3098, Accuracy: 6685/10000 (66.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0689, Accuracy: 9717/9900 (98.1515%)
Done in 299.70446968078613 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4760/4885 (97.4411%), train_poison_data_count: 385
Global model norm: 44.12555190651656.
Norm before scaling: 44.09281010913585. Distance: 1.2165769620163667
Total norm for 4 adversaries is: 44.09281010913585. distance: 1.2165769620163667
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0458, Accuracy: 9782/9900 (98.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5138/5305 (96.8520%), train_poison_data_count: 415
Global model norm: 44.12555190651656.
Norm before scaling: 44.091579500087086. Distance: 1.3157395392278768
Total norm for 4 adversaries is: 44.091579500087086. distance: 1.3157395392278768
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0762, Accuracy: 9708/9900 (98.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4578/4717 (97.0532%), train_poison_data_count: 370
Global model norm: 44.12555190651656.
Norm before scaling: 44.095013768654304. Distance: 1.2171422673293693
Total norm for 4 adversaries is: 44.095013768654304. distance: 1.2171422673293693
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0464, Accuracy: 9783/9900 (98.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4923/5066 (97.1773%), train_poison_data_count: 400
Global model norm: 44.12555190651656.
Norm before scaling: 44.09314924732497. Distance: 1.2600415777733647
Total norm for 4 adversaries is: 44.09314924732497. distance: 1.2600415777733647
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0352, Accuracy: 9810/9900 (99.0909%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5274/5582 (94.4823%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5118/5582 (91.6876%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2321, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4162/4501 (92.4683%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4070/4501 (90.4244%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2623, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3654/3911 (93.4288%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0114, Accuracy: 3084/3911 (78.8545%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.6091, Accuracy: 4554/10000 (45.5400%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4408/4663 (94.5314%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4378/4663 (93.8881%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8665, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4854/5265 (92.1937%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4709/5265 (89.4397%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0708, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4043/4416 (91.5534%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3969/4416 (89.8777%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1173, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4168/4433 (94.0221%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3963/4433 (89.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0630, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5798/6263 (92.5754%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5699/6263 (90.9947%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1143, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5046/5455 (92.5023%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4975/5455 (91.2007%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0001, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4248/4634 (91.6703%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4286/4634 (92.4903%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8218, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4399/4707 (93.4566%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4319/4707 (91.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8986, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3871/4126 (93.8197%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3868/4126 (93.7470%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8101, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4821/5116 (94.2338%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4644/5116 (90.7740%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1611, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4650/5063 (91.8428%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4479/5063 (88.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2133, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4069/4361 (93.3043%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3943/4361 (90.4150%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1087, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5558/6124 (90.7577%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5377/6124 (87.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2377, Accuracy: 5095/10000 (50.9500%)
time spent on training: 271.9558129310608
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [12, 9, 18]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.3128, Accuracy: 6663/10000 (66.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0661, Accuracy: 9722/9900 (98.2020%)
Done in 301.299681186676 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4746/4885 (97.1546%), train_poison_data_count: 385
Global model norm: 44.14762112698571.
Norm before scaling: 44.11430354594471. Distance: 1.2071778044877852
Total norm for 4 adversaries is: 44.11430354594471. distance: 1.2071778044877852
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0598, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5151/5305 (97.0971%), train_poison_data_count: 415
Global model norm: 44.14762112698571.
Norm before scaling: 44.11351628850207. Distance: 1.3226273688437629
Total norm for 4 adversaries is: 44.11351628850207. distance: 1.3226273688437629
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0291, Accuracy: 9824/9900 (99.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4589/4717 (97.2864%), train_poison_data_count: 370
Global model norm: 44.14762112698571.
Norm before scaling: 44.11439209423326. Distance: 1.1464651908764159
Total norm for 4 adversaries is: 44.11439209423326. distance: 1.1464651908764159
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0635, Accuracy: 9730/9900 (98.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4906/5066 (96.8417%), train_poison_data_count: 400
Global model norm: 44.14762112698571.
Norm before scaling: 44.11666661747576. Distance: 1.2965572381527688
Total norm for 4 adversaries is: 44.11666661747576. distance: 1.2965572381527688
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0701, Accuracy: 9711/9900 (98.0909%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4054/4356 (93.0670%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3829/4356 (87.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.4539, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4161/4362 (95.3920%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4084/4362 (93.6268%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9223, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4382/4679 (93.6525%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4200/4679 (89.7628%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1879, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3768/4158 (90.6205%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3712/4158 (89.2737%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0565, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4346/4651 (93.4423%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4222/4651 (90.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3254, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3899/4175 (93.3892%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3738/4175 (89.5329%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0906, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4345/4618 (94.0883%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4134/4618 (89.5193%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9679, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4238/4625 (91.6324%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4117/4625 (89.0162%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1092, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5264/5582 (94.3031%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5198/5582 (93.1207%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0784, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4529/4874 (92.9216%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4398/4874 (90.2339%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2289, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4549/4934 (92.1970%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4426/4934 (89.7041%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2373, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5057/5424 (93.2338%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5034/5424 (92.8097%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0598, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4513/4804 (93.9425%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4304/4804 (89.5920%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2639, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4618/4918 (93.9000%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4520/4918 (91.9073%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0555, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3611/3861 (93.5250%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3512/3861 (90.9609%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9107, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3947/4223 (93.4644%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3898/4223 (92.3040%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0111, Accuracy: 5509/10000 (55.0900%)
time spent on training: 268.4247257709503
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 8, 10]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.3151, Accuracy: 6669/10000 (66.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0628, Accuracy: 9731/9900 (98.2929%)
Done in 297.84368920326233 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4778/4885 (97.8096%), train_poison_data_count: 385
Global model norm: 44.16743792934097.
Norm before scaling: 44.13258776385512. Distance: 1.1626198040335796
Total norm for 4 adversaries is: 44.13258776385512. distance: 1.1626198040335796
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0556, Accuracy: 9760/9900 (98.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5122/5305 (96.5504%), train_poison_data_count: 415
Global model norm: 44.16743792934097.
Norm before scaling: 44.13311053293774. Distance: 1.317402810523946
Total norm for 4 adversaries is: 44.13311053293774. distance: 1.317402810523946
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0404, Accuracy: 9804/9900 (99.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4576/4717 (97.0108%), train_poison_data_count: 370
Global model norm: 44.16743792934097.
Norm before scaling: 44.13736713641147. Distance: 1.2086806401074304
Total norm for 4 adversaries is: 44.13736713641147. distance: 1.2086806401074304
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0492, Accuracy: 9764/9900 (98.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4910/5066 (96.9206%), train_poison_data_count: 400
Global model norm: 44.16743792934097.
Norm before scaling: 44.136804314734746. Distance: 1.3380179017498746
Total norm for 4 adversaries is: 44.136804314734746. distance: 1.3380179017498746
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0554, Accuracy: 9761/9900 (98.5960%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4328/4647 (93.1354%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4329/4647 (93.1569%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9659, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3550/3804 (93.3228%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3543/3804 (93.1388%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8555, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5122/5591 (91.6115%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4941/5591 (88.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1867, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4288/4634 (92.5334%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4290/4634 (92.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9041, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4179/4433 (94.2702%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4098/4433 (92.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9901, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3457/3704 (93.3315%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3456/3704 (93.3045%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7872, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3592/3837 (93.6148%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3625/3837 (94.4749%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9705, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5076/5455 (93.0522%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4879/5455 (89.4409%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0538, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5344/5740 (93.1010%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5259/5740 (91.6202%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1003, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4674/4986 (93.7425%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4586/4986 (91.9775%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8769, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4210/4456 (94.4794%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4200/4456 (94.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0626, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4045/4356 (92.8604%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4055/4356 (93.0900%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0574, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3408/3590 (94.9304%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3422/3590 (95.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0887, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4183/4503 (92.8936%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4135/4503 (91.8277%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8475, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4676/5037 (92.8330%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4606/5037 (91.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9899, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4820/5167 (93.2843%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4733/5167 (91.6005%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2048, Accuracy: 5259/10000 (52.5900%)
time spent on training: 266.05196714401245
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 7, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3289, Accuracy: 6653/10000 (66.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0629, Accuracy: 9734/9900 (98.3232%)
Done in 295.5879499912262 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4771/4885 (97.6663%), train_poison_data_count: 385
Global model norm: 44.18599990823592.
Norm before scaling: 44.15106209571506. Distance: 1.1679719140255533
Total norm for 4 adversaries is: 44.15106209571506. distance: 1.1679719140255533
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0932, Accuracy: 9638/9900 (97.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5161/5305 (97.2856%), train_poison_data_count: 415
Global model norm: 44.18599990823592.
Norm before scaling: 44.14971698398105. Distance: 1.2727245371033635
Total norm for 4 adversaries is: 44.14971698398105. distance: 1.2727245371033635
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0265, Accuracy: 9829/9900 (99.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4591/4717 (97.3288%), train_poison_data_count: 370
Global model norm: 44.18599990823592.
Norm before scaling: 44.15438806451248. Distance: 1.1780903090168175
Total norm for 4 adversaries is: 44.15438806451248. distance: 1.1780903090168175
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0599, Accuracy: 9738/9900 (98.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4899/5066 (96.7035%), train_poison_data_count: 400
Global model norm: 44.18599990823592.
Norm before scaling: 44.153676167909566. Distance: 1.2998565961531081
Total norm for 4 adversaries is: 44.153676167909566. distance: 1.2998565961531081
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0787, Accuracy: 9685/9900 (97.8283%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3357/3638 (92.2760%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3387/3638 (93.1006%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7745, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4345/4716 (92.1332%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4252/4716 (90.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0270, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4549/4956 (91.7877%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4426/4956 (89.3059%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1819, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4994/5392 (92.6187%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4837/5392 (89.7070%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1958, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3930/4184 (93.9293%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3901/4184 (93.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8775, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4137/4481 (92.3231%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3985/4481 (88.9310%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1040, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3413/3646 (93.6094%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3419/3646 (93.7740%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7452, Accuracy: 5979/10000 (59.7900%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4656/5025 (92.6567%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4582/5025 (91.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2066, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3403/3590 (94.7911%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3276/3590 (91.2535%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9462, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4294/4596 (93.4291%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4233/4596 (92.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0866, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4005/4336 (92.3662%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3953/4336 (91.1670%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1182, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4512/4874 (92.5728%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4430/4874 (90.8904%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0780, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4823/5167 (93.3424%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4779/5167 (92.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1971, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4306/4618 (93.2438%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4262/4618 (92.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0191, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4467/4928 (90.6453%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4457/4928 (90.4424%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0820, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4334/4647 (93.2645%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4316/4647 (92.8771%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9055, Accuracy: 5765/10000 (57.6500%)
time spent on training: 264.84176301956177
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [18, 14, 6]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3252, Accuracy: 6635/10000 (66.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0634, Accuracy: 9734/9900 (98.3232%)
Done in 294.22018337249756 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4771/4885 (97.6663%), train_poison_data_count: 385
Global model norm: 44.20481367179159.
Norm before scaling: 44.168823957239624. Distance: 1.1526650191060506
Total norm for 4 adversaries is: 44.168823957239624. distance: 1.1526650191060506
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0434, Accuracy: 9790/9900 (98.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5166/5305 (97.3798%), train_poison_data_count: 415
Global model norm: 44.20481367179159.
Norm before scaling: 44.168916541800776. Distance: 1.262603874465627
Total norm for 4 adversaries is: 44.168916541800776. distance: 1.262603874465627
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0601, Accuracy: 9758/9900 (98.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4589/4717 (97.2864%), train_poison_data_count: 370
Global model norm: 44.20481367179159.
Norm before scaling: 44.17384397141523. Distance: 1.190104539510834
Total norm for 4 adversaries is: 44.17384397141523. distance: 1.190104539510834
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0634, Accuracy: 9723/9900 (98.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4907/5066 (96.8614%), train_poison_data_count: 400
Global model norm: 44.20481367179159.
Norm before scaling: 44.17241250336218. Distance: 1.2949536349859425
Total norm for 4 adversaries is: 44.17241250336218. distance: 1.2949536349859425
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0120, Accuracy: 9876/9900 (99.7576%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4052/4368 (92.7656%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3914/4368 (89.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0702, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4750/5195 (91.4341%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4613/5195 (88.7969%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0576, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4044/4315 (93.7196%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4028/4315 (93.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8470, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3390/3646 (92.9786%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3417/3646 (93.7191%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9056, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3378/3590 (94.0947%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3294/3590 (91.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1140, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3900/4126 (94.5225%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3901/4126 (94.5468%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8034, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4005/4361 (91.8367%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3809/4361 (87.3424%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1591, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3588/3837 (93.5106%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3612/3837 (94.1360%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8480, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4010/4235 (94.6871%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3859/4235 (91.1216%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0444, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5433/5902 (92.0535%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5127/5902 (86.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3261, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4136/4433 (93.3002%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4063/4433 (91.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9420, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3342/3638 (91.8637%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3390/3638 (93.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9424, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4849/5232 (92.6797%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4779/5232 (91.3417%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1136, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4019/4336 (92.6891%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3989/4336 (91.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0919, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4564/4989 (91.4813%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4499/4989 (90.1784%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0041, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4095/4481 (91.3859%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3936/4481 (87.8375%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3201, Accuracy: 5127/10000 (51.2700%)
time spent on training: 261.6875624656677
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 16, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3332, Accuracy: 6626/10000 (66.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0567, Accuracy: 9749/9900 (98.4747%)
Done in 291.2814018726349 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4769/4885 (97.6254%), train_poison_data_count: 385
Global model norm: 44.22413284374551.
Norm before scaling: 44.188084276105336. Distance: 1.1613794422584083
Total norm for 4 adversaries is: 44.188084276105336. distance: 1.1613794422584083
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0670, Accuracy: 9729/9900 (98.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5152/5305 (97.1159%), train_poison_data_count: 415
Global model norm: 44.22413284374551.
Norm before scaling: 44.18972241803305. Distance: 1.3094364015298678
Total norm for 4 adversaries is: 44.18972241803305. distance: 1.3094364015298678
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0259, Accuracy: 9827/9900 (99.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4580/4717 (97.0956%), train_poison_data_count: 370
Global model norm: 44.22413284374551.
Norm before scaling: 44.19168368852405. Distance: 1.175792960175153
Total norm for 4 adversaries is: 44.19168368852405. distance: 1.175792960175153
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0199, Accuracy: 9848/9900 (99.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4946/5066 (97.6313%), train_poison_data_count: 400
Global model norm: 44.22413284374551.
Norm before scaling: 44.190157496112754. Distance: 1.2289037531047078
Total norm for 4 adversaries is: 44.190157496112754. distance: 1.2289037531047078
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0480, Accuracy: 9776/9900 (98.7475%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4757/5116 (92.9828%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4701/5116 (91.8882%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0112, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4136/4362 (94.8189%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3993/4362 (91.5406%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0981, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4201/4441 (94.5958%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4182/4441 (94.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9015, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4418/4663 (94.7459%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4386/4663 (94.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8939, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4704/5083 (92.5438%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4515/5083 (88.8255%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1675, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4356/4767 (91.3782%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4187/4767 (87.8330%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2601, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3581/3797 (94.3113%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3496/3797 (92.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8921, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4818/5195 (92.7430%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4560/5195 (87.7767%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2373, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4336/4618 (93.8935%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4191/4618 (90.7536%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0739, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4180/4433 (94.2928%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4106/4433 (92.6235%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9167, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4711/5055 (93.1949%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4625/5055 (91.4936%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9448, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3798/4158 (91.3420%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3804/4158 (91.4863%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8405, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3557/3781 (94.0756%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3384/3781 (89.5001%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1778, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3876/4175 (92.8383%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3843/4175 (92.0479%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9276, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4908/5265 (93.2194%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4724/5265 (89.7246%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0909, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3630/3837 (94.6052%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3597/3837 (93.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8977, Accuracy: 5761/10000 (57.6100%)
time spent on training: 263.73027896881104
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 5, 15]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3425, Accuracy: 6613/10000 (66.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0532, Accuracy: 9756/9900 (98.5455%)
Done in 293.0694489479065 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4781/4885 (97.8710%), train_poison_data_count: 385
Global model norm: 44.24373879829283.
Norm before scaling: 44.20752673382526. Distance: 1.1513849957539248
Total norm for 4 adversaries is: 44.20752673382526. distance: 1.1513849957539248
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0436, Accuracy: 9793/9900 (98.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5133/5305 (96.7578%), train_poison_data_count: 415
Global model norm: 44.24373879829283.
Norm before scaling: 44.21017060100891. Distance: 1.3432681084567217
Total norm for 4 adversaries is: 44.21017060100891. distance: 1.3432681084567217
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0410, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4585/4717 (97.2016%), train_poison_data_count: 370
Global model norm: 44.24373879829283.
Norm before scaling: 44.21000631308624. Distance: 1.1718192023662877
Total norm for 4 adversaries is: 44.21000631308624. distance: 1.1718192023662877
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0375, Accuracy: 9807/9900 (99.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4929/5066 (97.2957%), train_poison_data_count: 400
Global model norm: 44.24373879829283.
Norm before scaling: 44.21140757282347. Distance: 1.2810200275490429
Total norm for 4 adversaries is: 44.21140757282347. distance: 1.2810200275490429
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0763, Accuracy: 9697/9900 (97.9495%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3686/3911 (94.2470%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3531/3911 (90.2838%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1999, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4784/5195 (92.0885%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4602/5195 (88.5852%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1010, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3547/3775 (93.9603%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3582/3775 (94.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8085, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4353/4679 (93.0327%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4195/4679 (89.6559%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2957, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4007/4361 (91.8826%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3841/4361 (88.0761%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0542, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3381/3672 (92.0752%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3368/3672 (91.7211%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8995, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4071/4481 (90.8503%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3905/4481 (87.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2589, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3875/4126 (93.9166%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3868/4126 (93.7470%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7739, Accuracy: 5921/10000 (59.2100%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3716/3969 (93.6256%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3631/3969 (91.4840%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9819, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4740/5116 (92.6505%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4560/5116 (89.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1058, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4686/5063 (92.5538%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4460/5063 (88.0901%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2560, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3115/3297 (94.4798%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3128/3297 (94.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7860, Accuracy: 5965/10000 (59.6500%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4636/5037 (92.0389%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4644/5037 (92.1977%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0834, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4291/4596 (93.3638%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4314/4596 (93.8642%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8988, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4231/4501 (94.0013%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4095/4501 (90.9798%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9467, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4191/4465 (93.8634%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4170/4465 (93.3931%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9332, Accuracy: 5729/10000 (57.2900%)
time spent on training: 259.99991273880005
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 17, 4]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3519, Accuracy: 6610/10000 (66.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0490, Accuracy: 9772/9900 (98.7071%)
Done in 289.4471037387848 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4778/4885 (97.8096%), train_poison_data_count: 385
Global model norm: 44.262847931772875.
Norm before scaling: 44.22792114478209. Distance: 1.1529675363269833
Total norm for 4 adversaries is: 44.22792114478209. distance: 1.1529675363269833
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0946, Accuracy: 9659/9900 (97.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5136/5305 (96.8143%), train_poison_data_count: 415
Global model norm: 44.262847931772875.
Norm before scaling: 44.22807018605732. Distance: 1.3050061139515272
Total norm for 4 adversaries is: 44.22807018605732. distance: 1.3050061139515272
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0475, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4577/4717 (97.0320%), train_poison_data_count: 370
Global model norm: 44.262847931772875.
Norm before scaling: 44.231682903332285. Distance: 1.2073307097964865
Total norm for 4 adversaries is: 44.231682903332285. distance: 1.2073307097964865
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0334, Accuracy: 9818/9900 (99.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4916/5066 (97.0391%), train_poison_data_count: 400
Global model norm: 44.262847931772875.
Norm before scaling: 44.2301622309546. Distance: 1.3017487006930963
Total norm for 4 adversaries is: 44.2301622309546. distance: 1.3017487006930963
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1142, Accuracy: 9604/9900 (97.0101%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4061/4361 (93.1208%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3907/4361 (89.5895%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0971, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4099/4346 (94.3166%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4107/4346 (94.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8136, Accuracy: 5918/10000 (59.1800%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5102/5455 (93.5289%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4990/5455 (91.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9995, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4154/4465 (93.0347%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4172/4465 (93.4378%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8254, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3985/4336 (91.9050%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3972/4336 (91.6052%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1620, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4192/4441 (94.3932%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4151/4441 (93.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9603, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4134/4362 (94.7730%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4003/4362 (91.7698%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0392, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3757/3969 (94.6586%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3659/3969 (92.1895%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0472, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4000/4295 (93.1315%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3817/4295 (88.8708%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2887, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4676/5017 (93.2031%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4614/5017 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8713, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4695/5063 (92.7316%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4467/5063 (88.2283%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2684, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3016/3271 (92.2042%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0055, Accuracy: 2955/3271 (90.3393%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0860, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5845/6263 (93.3259%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5717/6263 (91.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1613, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4528/4874 (92.9011%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4435/4874 (90.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2939, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3690/3911 (94.3493%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3530/3911 (90.2582%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1236, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4472/4804 (93.0891%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3964/4804 (82.5146%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.7526, Accuracy: 4434/10000 (44.3400%)
time spent on training: 264.7194263935089
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 19 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 19, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3443, Accuracy: 6622/10000 (66.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0513, Accuracy: 9768/9900 (98.6667%)
Done in 294.20746660232544 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4767/4885 (97.5844%), train_poison_data_count: 385
Global model norm: 44.281593208355915.
Norm before scaling: 44.245737678723074. Distance: 1.1691056653833134
Total norm for 4 adversaries is: 44.245737678723074. distance: 1.1691056653833134
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0843, Accuracy: 9688/9900 (97.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5122/5305 (96.5504%), train_poison_data_count: 415
Global model norm: 44.281593208355915.
Norm before scaling: 44.24847030150802. Distance: 1.3732830945952117
Total norm for 4 adversaries is: 44.24847030150802. distance: 1.3732830945952117
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0496, Accuracy: 9769/9900 (98.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4596/4717 (97.4348%), train_poison_data_count: 370
Global model norm: 44.281593208355915.
Norm before scaling: 44.247164015759246. Distance: 1.1363509589268375
Total norm for 4 adversaries is: 44.247164015759246. distance: 1.1363509589268375
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0520, Accuracy: 9764/9900 (98.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4935/5066 (97.4141%), train_poison_data_count: 400
Global model norm: 44.281593208355915.
Norm before scaling: 44.248019244156566. Distance: 1.2774687539626044
Total norm for 4 adversaries is: 44.248019244156566. distance: 1.2774687539626044
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0426, Accuracy: 9783/9900 (98.8182%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5436/5902 (92.1044%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5199/5902 (88.0888%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2195, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4643/4918 (94.4083%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4525/4918 (92.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2947, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3729/4025 (92.6460%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3777/4025 (93.8385%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9175, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3283/3472 (94.5565%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3248/3472 (93.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9342, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4477/4793 (93.4071%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4397/4793 (91.7380%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0846, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4548/4934 (92.1767%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4223/4934 (85.5898%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2747, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3694/3911 (94.4515%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3426/3911 (87.5991%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2070, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5050/5392 (93.6573%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4842/5392 (89.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0630, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3334/3638 (91.6438%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3354/3638 (92.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7455, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5659/6124 (92.4069%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5499/6124 (89.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0571, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3888/4175 (93.1257%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3800/4175 (91.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8435, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4214/4625 (91.1135%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4116/4625 (88.9946%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1290, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4062/4354 (93.2935%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3725/4354 (85.5535%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.6245, Accuracy: 4688/10000 (46.8800%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4204/4511 (93.1944%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4175/4511 (92.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0631, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3434/3704 (92.7106%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3463/3704 (93.4935%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7554, Accuracy: 6017/10000 (60.1700%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3619/3861 (93.7322%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3575/3861 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8165, Accuracy: 5820/10000 (58.2000%)
time spent on training: 265.76441192626953
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 18, 7]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3519, Accuracy: 6608/10000 (66.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0516, Accuracy: 9769/9900 (98.6768%)
Done in 294.6512987613678 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4789/4885 (98.0348%), train_poison_data_count: 385
Global model norm: 44.30220702036186.
Norm before scaling: 44.26543058331821. Distance: 1.1402869572788183
Total norm for 4 adversaries is: 44.26543058331821. distance: 1.1402869572788183
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0158, Accuracy: 9861/9900 (99.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5140/5305 (96.8897%), train_poison_data_count: 415
Global model norm: 44.30220702036186.
Norm before scaling: 44.269478686382364. Distance: 1.3537010517235477
Total norm for 4 adversaries is: 44.269478686382364. distance: 1.3537010517235477
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0462, Accuracy: 9796/9900 (98.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4602/4717 (97.5620%), train_poison_data_count: 370
Global model norm: 44.30220702036186.
Norm before scaling: 44.267576013746364. Distance: 1.1412098573976308
Total norm for 4 adversaries is: 44.267576013746364. distance: 1.1412098573976308
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0233, Accuracy: 9841/9900 (99.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4927/5066 (97.2562%), train_poison_data_count: 400
Global model norm: 44.30220702036186.
Norm before scaling: 44.26939182702169. Distance: 1.2793033978244968
Total norm for 4 adversaries is: 44.26939182702169. distance: 1.2793033978244968
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0258, Accuracy: 9841/9900 (99.4040%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4735/5083 (93.1536%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4564/5083 (89.7895%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0294, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3417/3646 (93.7191%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3401/3646 (93.2803%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7098, Accuracy: 5974/10000 (59.7400%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4239/4503 (94.1372%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4113/4503 (91.3391%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1933, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4201/4501 (93.3348%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4103/4501 (91.1575%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9743, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3756/4013 (93.5958%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3794/4013 (94.5427%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8045, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4153/4362 (95.2086%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4087/4362 (93.6956%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9102, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4082/4315 (94.6002%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4096/4315 (94.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8475, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4325/4651 (92.9908%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4256/4651 (91.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1443, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4063/4416 (92.0063%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4015/4416 (90.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0322, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3458/3704 (93.3585%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3437/3704 (92.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8566, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4418/4707 (93.8602%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4327/4707 (91.9269%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9485, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4343/4662 (93.1574%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4284/4662 (91.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9818, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5068/5424 (93.4366%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4999/5424 (92.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.5321, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4032/4336 (92.9889%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4020/4336 (92.7122%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8860, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4155/4481 (92.7248%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4001/4481 (89.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1408, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3603/3828 (94.1223%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3591/3828 (93.8088%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7925, Accuracy: 5948/10000 (59.4800%)
time spent on training: 257.7910294532776
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 17 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [8, 13, 17]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3574, Accuracy: 6603/10000 (66.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0438, Accuracy: 9783/9900 (98.8182%)
Done in 286.84185218811035 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4753/4885 (97.2979%), train_poison_data_count: 385
Global model norm: 44.320354502668266.
Norm before scaling: 44.286419897127466. Distance: 1.2307887070059325
Total norm for 4 adversaries is: 44.286419897127466. distance: 1.2307887070059325
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0341, Accuracy: 9816/9900 (99.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5163/5305 (97.3233%), train_poison_data_count: 415
Global model norm: 44.320354502668266.
Norm before scaling: 44.28464612947133. Distance: 1.3041543385143384
Total norm for 4 adversaries is: 44.28464612947133. distance: 1.3041543385143384
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0726, Accuracy: 9716/9900 (98.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4584/4717 (97.1804%), train_poison_data_count: 370
Global model norm: 44.320354502668266.
Norm before scaling: 44.288022704543096. Distance: 1.1890381839386297
Total norm for 4 adversaries is: 44.288022704543096. distance: 1.1890381839386297
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0300, Accuracy: 9829/9900 (99.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4927/5066 (97.2562%), train_poison_data_count: 400
Global model norm: 44.320354502668266.
Norm before scaling: 44.28646675560506. Distance: 1.2562208827046255
Total norm for 4 adversaries is: 44.28646675560506. distance: 1.2562208827046255
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0438, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3964/4184 (94.7419%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3876/4184 (92.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7748, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4601/5037 (91.3441%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4625/5037 (91.8205%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9496, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3796/4158 (91.2939%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3707/4158 (89.1534%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0454, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3043/3271 (93.0297%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2960/3271 (90.4922%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0515, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4616/4918 (93.8593%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4611/4918 (93.7576%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1923, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5462/5902 (92.5449%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5290/5902 (89.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0928, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4087/4354 (93.8677%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3882/4354 (89.1594%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.4211, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3736/3969 (94.1295%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3685/3969 (92.8445%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8335, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4060/4356 (93.2048%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3970/4356 (91.1387%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2078, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4012/4295 (93.4109%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4022/4295 (93.6438%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8726, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3914/4126 (94.8619%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3887/4126 (94.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7059, Accuracy: 5987/10000 (59.8700%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4612/4928 (93.5877%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4520/4928 (91.7208%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8676, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4187/4511 (92.8176%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4173/4511 (92.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8806, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4342/4618 (94.0234%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4259/4618 (92.2261%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9325, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3443/3704 (92.9536%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3432/3704 (92.6566%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9118, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3336/3616 (92.2566%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3364/3616 (93.0310%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8594, Accuracy: 5826/10000 (58.2600%)
time spent on training: 262.1731426715851
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 19 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 19, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3762, Accuracy: 6549/10000 (65.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0460, Accuracy: 9779/9900 (98.7778%)
Done in 290.9179172515869 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4787/4885 (97.9939%), train_poison_data_count: 385
Global model norm: 44.33815316600224.
Norm before scaling: 44.30180197467283. Distance: 1.1402046265075156
Total norm for 4 adversaries is: 44.30180197467283. distance: 1.1402046265075156
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0471, Accuracy: 9780/9900 (98.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5155/5305 (97.1725%), train_poison_data_count: 415
Global model norm: 44.33815316600224.
Norm before scaling: 44.30240127565393. Distance: 1.2775812890603735
Total norm for 4 adversaries is: 44.30240127565393. distance: 1.2775812890603735
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0276, Accuracy: 9822/9900 (99.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4605/4717 (97.6256%), train_poison_data_count: 370
Global model norm: 44.33815316600224.
Norm before scaling: 44.30237923254306. Distance: 1.105344515987408
Total norm for 4 adversaries is: 44.30237923254306. distance: 1.105344515987408
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0359, Accuracy: 9816/9900 (99.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4932/5066 (97.3549%), train_poison_data_count: 400
Global model norm: 44.33815316600224.
Norm before scaling: 44.30252940101869. Distance: 1.2525169305171067
Total norm for 4 adversaries is: 44.30252940101869. distance: 1.2525169305171067
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0360, Accuracy: 9805/9900 (99.0404%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3042/3271 (92.9991%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2932/3271 (89.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2997, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4223/4456 (94.7711%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4116/4456 (92.3698%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9690, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3780/4013 (94.1939%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3790/4013 (94.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7279, Accuracy: 5917/10000 (59.1700%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3551/3781 (93.9170%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3338/3781 (88.2835%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3883, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3572/3775 (94.6225%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3580/3775 (94.8344%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8666, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4831/5232 (92.3356%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4669/5232 (89.2393%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0942, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4623/4989 (92.6639%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4526/4989 (90.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0069, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3398/3646 (93.1980%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3410/3646 (93.5272%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8126, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4093/4315 (94.8552%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4060/4315 (94.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8326, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4640/4918 (94.3473%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4545/4918 (92.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0512, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4063/4416 (92.0063%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3999/4416 (90.5571%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0126, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5787/6263 (92.3998%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5691/6263 (90.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1586, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5632/6124 (91.9660%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5419/6124 (88.4879%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1802, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4377/4651 (94.1088%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4301/4651 (92.4747%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8918, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4105/4356 (94.2378%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3800/4356 (87.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2962, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4109/4356 (94.3297%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3841/4356 (88.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3615, Accuracy: 4975/10000 (49.7500%)
time spent on training: 266.2593324184418
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 4, 16]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.3861, Accuracy: 6546/10000 (65.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0418, Accuracy: 9788/9900 (98.8687%)
Done in 295.3470706939697 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4789/4885 (98.0348%), train_poison_data_count: 385
Global model norm: 44.35635749467389.
Norm before scaling: 44.320408210940194. Distance: 1.1423167916113095
Total norm for 4 adversaries is: 44.320408210940194. distance: 1.1423167916113095
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0740, Accuracy: 9706/9900 (98.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5156/5305 (97.1913%), train_poison_data_count: 415
Global model norm: 44.35635749467389.
Norm before scaling: 44.320640946033116. Distance: 1.3092474372289464
Total norm for 4 adversaries is: 44.320640946033116. distance: 1.3092474372289464
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0487, Accuracy: 9772/9900 (98.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4596/4717 (97.4348%), train_poison_data_count: 370
Global model norm: 44.35635749467389.
Norm before scaling: 44.32309629566029. Distance: 1.1703302501763526
Total norm for 4 adversaries is: 44.32309629566029. distance: 1.1703302501763526
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0275, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4914/5066 (96.9996%), train_poison_data_count: 400
Global model norm: 44.35635749467389.
Norm before scaling: 44.32336619679991. Distance: 1.3015007343268181
Total norm for 4 adversaries is: 44.32336619679991. distance: 1.3015007343268181
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0258, Accuracy: 9838/9900 (99.3737%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4315/4716 (91.4970%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4223/4716 (89.5462%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1072, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4323/4634 (93.2887%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4253/4634 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9243, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3611/3828 (94.3312%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3553/3828 (92.8161%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9043, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4613/4989 (92.4634%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4542/4989 (91.0403%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9799, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4792/5116 (93.6669%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4690/5116 (91.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9385, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4171/4362 (95.6213%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4134/4362 (94.7730%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8469, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4693/5017 (93.5420%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4638/5017 (92.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8208, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4042/4354 (92.8342%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0116, Accuracy: 3408/4354 (78.2729%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.9396, Accuracy: 4280/10000 (42.8000%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3353/3638 (92.1660%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3371/3638 (92.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.7755, Accuracy: 5965/10000 (59.6500%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4821/5195 (92.8008%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4597/5195 (88.4889%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0567, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4300/4596 (93.5596%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4252/4596 (92.5152%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0963, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4499/4928 (91.2946%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4444/4928 (90.1786%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2253, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4757/5244 (90.7132%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4591/5244 (87.5477%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1614, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5491/5902 (93.0363%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5265/5902 (89.2070%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1522, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4640/5025 (92.3383%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4563/5025 (90.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0539, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5637/6124 (92.0477%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5452/6124 (89.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0466, Accuracy: 5411/10000 (54.1100%)
time spent on training: 266.52353835105896
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [9, 17, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.3884, Accuracy: 6535/10000 (65.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0408, Accuracy: 9789/9900 (98.8788%)
Done in 295.72929787635803 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4776/4885 (97.7687%), train_poison_data_count: 385
Global model norm: 44.37825967341019.
Norm before scaling: 44.34279200867938. Distance: 1.1842174837956527
Total norm for 4 adversaries is: 44.34279200867938. distance: 1.1842174837956527
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0747, Accuracy: 9699/9900 (97.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5166/5305 (97.3798%), train_poison_data_count: 415
Global model norm: 44.37825967341019.
Norm before scaling: 44.341334335629355. Distance: 1.2642296999960536
Total norm for 4 adversaries is: 44.341334335629355. distance: 1.2642296999960536
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1090, Accuracy: 9626/9900 (97.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4590/4717 (97.3076%), train_poison_data_count: 370
Global model norm: 44.37825967341019.
Norm before scaling: 44.34340727272418. Distance: 1.1165663586348857
Total norm for 4 adversaries is: 44.34340727272418. distance: 1.1165663586348857
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0216, Accuracy: 9842/9900 (99.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4935/5066 (97.4141%), train_poison_data_count: 400
Global model norm: 44.37825967341019.
Norm before scaling: 44.34265574099123. Distance: 1.2222708682773442
Total norm for 4 adversaries is: 44.34265574099123. distance: 1.2222708682773442
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0303, Accuracy: 9828/9900 (99.2727%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4809/5116 (93.9992%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4693/5116 (91.7318%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0928, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4839/5197 (93.1114%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4649/5197 (89.4555%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1818, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4088/4356 (93.8476%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3864/4356 (88.7052%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1306, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4368/4679 (93.3533%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4337/4679 (92.6907%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1819, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4326/4647 (93.0923%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4311/4647 (92.7695%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9241, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3700/3911 (94.6050%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3558/3911 (90.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0682, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4090/4315 (94.7856%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4072/4315 (94.3685%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8807, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3427/3646 (93.9934%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3385/3646 (92.8415%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8096, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4338/4634 (93.6124%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4325/4634 (93.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8988, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4646/5055 (91.9090%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4631/5055 (91.6123%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0576, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4173/4362 (95.6671%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4001/4362 (91.7240%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1451, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4575/4934 (92.7240%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0108, Accuracy: 3977/4934 (80.6040%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.7419, Accuracy: 4403/10000 (44.0300%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4415/4767 (92.6159%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4289/4767 (89.9727%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1807, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4181/4433 (94.3154%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4094/4433 (92.3528%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0263, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4524/4928 (91.8019%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4458/4928 (90.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0174, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3617/3837 (94.2664%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3630/3837 (94.6052%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8820, Accuracy: 5732/10000 (57.3200%)
time spent on training: 264.3520646095276
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 19 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 19, 18]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.3810, Accuracy: 6550/10000 (65.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0415, Accuracy: 9789/9900 (98.8788%)
Done in 293.4554531574249 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4760/4885 (97.4411%), train_poison_data_count: 385
Global model norm: 44.39763534709999.
Norm before scaling: 44.36136179066052. Distance: 1.202797981505608
Total norm for 4 adversaries is: 44.36136179066052. distance: 1.202797981505608
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0407, Accuracy: 9799/9900 (98.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5162/5305 (97.3044%), train_poison_data_count: 415
Global model norm: 44.39763534709999.
Norm before scaling: 44.36263719732589. Distance: 1.329848304644819
Total norm for 4 adversaries is: 44.36263719732589. distance: 1.329848304644819
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0181, Accuracy: 9851/9900 (99.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4582/4717 (97.1380%), train_poison_data_count: 370
Global model norm: 44.39763534709999.
Norm before scaling: 44.36430741554451. Distance: 1.1549492814128717
Total norm for 4 adversaries is: 44.36430741554451. distance: 1.1549492814128717
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0516, Accuracy: 9762/9900 (98.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4925/5066 (97.2167%), train_poison_data_count: 400
Global model norm: 44.39763534709999.
Norm before scaling: 44.362584916004245. Distance: 1.2530153621362066
Total norm for 4 adversaries is: 44.362584916004245. distance: 1.2530153621362066
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0310, Accuracy: 9822/9900 (99.2121%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4649/4986 (93.2411%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4614/4986 (92.5391%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9241, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4380/4767 (91.8817%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4290/4767 (89.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2018, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4076/4315 (94.4612%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4085/4315 (94.6698%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8911, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3411/3672 (92.8922%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3396/3672 (92.4837%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9816, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4270/4558 (93.6814%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4071/4558 (89.3155%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0763, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3627/3828 (94.7492%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3563/3828 (93.0773%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8831, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4387/4679 (93.7594%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4262/4679 (91.0878%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1881, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4558/4956 (91.9693%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4478/4956 (90.3551%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1608, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4099/4356 (94.1001%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3673/4356 (84.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1518, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4271/4538 (94.1164%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4287/4538 (94.4689%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9753, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3749/4013 (93.4214%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3775/4013 (94.0693%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8284, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4896/5265 (92.9915%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4757/5265 (90.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0266, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4410/4663 (94.5743%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4378/4663 (93.8881%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9371, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5840/6263 (93.2460%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5679/6263 (90.6754%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2218, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4658/5063 (92.0008%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4344/5063 (85.7989%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.4070, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4078/4416 (92.3460%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4078/4416 (92.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8544, Accuracy: 5839/10000 (58.3900%)
time spent on training: 267.4806697368622
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [5, 18, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.3879, Accuracy: 6539/10000 (65.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0404, Accuracy: 9793/9900 (98.9192%)
Done in 296.71496391296387 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4766/4885 (97.5640%), train_poison_data_count: 385
Global model norm: 44.41674835216652.
Norm before scaling: 44.38189179537007. Distance: 1.2149601233575023
Total norm for 4 adversaries is: 44.38189179537007. distance: 1.2149601233575023
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0428, Accuracy: 9783/9900 (98.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5160/5305 (97.2667%), train_poison_data_count: 415
Global model norm: 44.41674835216652.
Norm before scaling: 44.38050829589002. Distance: 1.2998572839747013
Total norm for 4 adversaries is: 44.38050829589002. distance: 1.2998572839747013
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0085, Accuracy: 9873/9900 (99.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4620/4717 (97.9436%), train_poison_data_count: 370
Global model norm: 44.41674835216652.
Norm before scaling: 44.38029925444467. Distance: 1.0783720977238294
Total norm for 4 adversaries is: 44.38029925444467. distance: 1.0783720977238294
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0619, Accuracy: 9737/9900 (98.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4921/5066 (97.1378%), train_poison_data_count: 400
Global model norm: 44.41674835216652.
Norm before scaling: 44.382157213301944. Distance: 1.2785177639326508
Total norm for 4 adversaries is: 44.382157213301944. distance: 1.2785177639326508
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0326, Accuracy: 9826/9900 (99.2525%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5296/5740 (92.2648%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5174/5740 (90.1394%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2152, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4345/4651 (93.4208%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4319/4651 (92.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9740, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4225/4503 (93.8263%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4051/4503 (89.9622%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0343, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4416/4767 (92.6369%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4269/4767 (89.5532%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2910, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5167/5591 (92.4164%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4953/5591 (88.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1772, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4200/4465 (94.0649%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4227/4465 (94.6697%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7382, Accuracy: 6044/10000 (60.4400%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4577/4956 (92.3527%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4395/4956 (88.6804%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2572, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3453/3704 (93.2235%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3440/3704 (92.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8544, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3822/4025 (94.9565%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3794/4025 (94.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8137, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4748/5083 (93.4094%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4624/5083 (90.9699%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9558, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5570/6124 (90.9536%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5432/6124 (88.7002%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0143, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4038/4295 (94.0163%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3896/4295 (90.7101%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9676, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4433/4804 (92.2773%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4138/4804 (86.1366%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.4223, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4541/4793 (94.7423%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4515/4793 (94.1999%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9837, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4187/4433 (94.4507%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4153/4433 (93.6837%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7588, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4072/4361 (93.3731%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3800/4361 (87.1360%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2485, Accuracy: 5124/10000 (51.2400%)
time spent on training: 268.166695356369
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [6, 7, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.3966, Accuracy: 6521/10000 (65.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0391, Accuracy: 9796/9900 (98.9495%)
Done in 297.38426899909973 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4784/4885 (97.9324%), train_poison_data_count: 385
Global model norm: 44.437623615334395.
Norm before scaling: 44.39950082859181. Distance: 1.1192302568103243
Total norm for 4 adversaries is: 44.39950082859181. distance: 1.1192302568103243
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0493, Accuracy: 9773/9900 (98.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5149/5305 (97.0594%), train_poison_data_count: 415
Global model norm: 44.437623615334395.
Norm before scaling: 44.40136760633055. Distance: 1.3177466204764017
Total norm for 4 adversaries is: 44.40136760633055. distance: 1.3177466204764017
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0388, Accuracy: 9800/9900 (98.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4608/4717 (97.6892%), train_poison_data_count: 370
Global model norm: 44.437623615334395.
Norm before scaling: 44.401330491484856. Distance: 1.1067066607851075
Total norm for 4 adversaries is: 44.401330491484856. distance: 1.1067066607851075
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0453, Accuracy: 9780/9900 (98.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4932/5066 (97.3549%), train_poison_data_count: 400
Global model norm: 44.437623615334395.
Norm before scaling: 44.402702345532276. Distance: 1.2631230525964885
Total norm for 4 adversaries is: 44.402702345532276. distance: 1.2631230525964885
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0554, Accuracy: 9751/9900 (98.4949%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4238/4558 (92.9794%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4132/4558 (90.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3417, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4352/4596 (94.6910%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4294/4596 (93.4291%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0421, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4480/4874 (91.9163%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4230/4874 (86.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.4332, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3836/4158 (92.2559%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3755/4158 (90.3078%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9652, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5096/5455 (93.4189%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4866/5455 (89.2026%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.4666, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4149/4346 (95.4671%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4128/4346 (94.9839%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.7573, Accuracy: 5968/10000 (59.6800%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4393/4679 (93.8876%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4138/4679 (88.4377%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2692, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4071/4416 (92.1875%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4058/4416 (91.8931%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9825, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3618/3828 (94.5141%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3601/3828 (94.0700%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9299, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3962/4223 (93.8196%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3950/4223 (93.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9179, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4897/5265 (93.0104%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4744/5265 (90.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2968, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5656/6124 (92.3579%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5443/6124 (88.8798%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2166, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4041/4361 (92.6622%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3957/4361 (90.7361%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1683, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4589/4956 (92.5948%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4405/4956 (88.8822%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2427, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5355/5740 (93.2927%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5173/5740 (90.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1473, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3766/4013 (93.8450%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3789/4013 (94.4181%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.7782, Accuracy: 5885/10000 (58.8500%)
time spent on training: 266.4800922870636
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 13, 4]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.4064, Accuracy: 6508/10000 (65.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0392, Accuracy: 9797/9900 (98.9596%)
Done in 295.7099370956421 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4796/4885 (98.1781%), train_poison_data_count: 385
Global model norm: 44.4574127435635.
Norm before scaling: 44.41892769636962. Distance: 1.099084922164828
Total norm for 4 adversaries is: 44.41892769636962. distance: 1.099084922164828
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0693, Accuracy: 9715/9900 (98.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5194/5305 (97.9076%), train_poison_data_count: 415
Global model norm: 44.4574127435635.
Norm before scaling: 44.416997072137264. Distance: 1.1928257225049304
Total norm for 4 adversaries is: 44.416997072137264. distance: 1.1928257225049304
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0331, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4587/4717 (97.2440%), train_poison_data_count: 370
Global model norm: 44.4574127435635.
Norm before scaling: 44.42249466460166. Distance: 1.1684716204231813
Total norm for 4 adversaries is: 44.42249466460166. distance: 1.1684716204231813
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0720, Accuracy: 9714/9900 (98.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4930/5066 (97.3154%), train_poison_data_count: 400
Global model norm: 44.4574127435635.
Norm before scaling: 44.42288899212038. Distance: 1.2689444726439474
Total norm for 4 adversaries is: 44.42288899212038. distance: 1.2689444726439474
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0588, Accuracy: 9746/9900 (98.4444%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3924/4184 (93.7859%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3852/4184 (92.0650%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9575, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3413/3590 (95.0696%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3230/3590 (89.9721%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0831, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3796/4158 (91.2939%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3765/4158 (90.5483%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0682, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3770/4025 (93.6646%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3810/4025 (94.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8618, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3785/4046 (93.5492%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3807/4046 (94.0929%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8404, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4659/5025 (92.7164%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4599/5025 (91.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1561, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4687/5063 (92.5736%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4422/5063 (87.3395%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3253, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4056/4356 (93.1129%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3731/4356 (85.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.4871, Accuracy: 4674/10000 (46.7400%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4362/4651 (93.7863%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4297/4651 (92.3887%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9823, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4142/4356 (95.0872%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3869/4356 (88.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2871, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4260/4576 (93.0944%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4250/4576 (92.8759%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1216, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4184/4456 (93.8959%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4146/4456 (93.0431%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9616, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3148/3297 (95.4807%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3116/3297 (94.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.6226, Accuracy: 6167/10000 (61.6700%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4506/4804 (93.7968%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4310/4804 (89.7169%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0500, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3757/3969 (94.6586%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3664/3969 (92.3154%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8666, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4846/5195 (93.2820%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4699/5195 (90.4524%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3198, Accuracy: 5161/10000 (51.6100%)
time spent on training: 261.0818932056427
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 16, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.4038, Accuracy: 6510/10000 (65.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0424, Accuracy: 9788/9900 (98.8687%)
Done in 290.12482595443726 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4786/4885 (97.9734%), train_poison_data_count: 385
Global model norm: 44.475634129824385.
Norm before scaling: 44.43767718187251. Distance: 1.1317753220159164
Total norm for 4 adversaries is: 44.43767718187251. distance: 1.1317753220159164
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0395, Accuracy: 9803/9900 (99.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5179/5305 (97.6249%), train_poison_data_count: 415
Global model norm: 44.475634129824385.
Norm before scaling: 44.43760301280254. Distance: 1.2626056211499006
Total norm for 4 adversaries is: 44.43760301280254. distance: 1.2626056211499006
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0893, Accuracy: 9674/9900 (97.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4606/4717 (97.6468%), train_poison_data_count: 370
Global model norm: 44.475634129824385.
Norm before scaling: 44.43999146936096. Distance: 1.1305897445622521
Total norm for 4 adversaries is: 44.43999146936096. distance: 1.1305897445622521
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0199, Accuracy: 9851/9900 (99.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4944/5066 (97.5918%), train_poison_data_count: 400
Global model norm: 44.475634129824385.
Norm before scaling: 44.44053809059078. Distance: 1.2492152134676477
Total norm for 4 adversaries is: 44.44053809059078. distance: 1.2492152134676477
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0328, Accuracy: 9823/9900 (99.2222%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3652/3837 (95.1785%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3664/3837 (95.4913%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7656, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5288/5582 (94.7331%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5160/5582 (92.4400%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0473, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5117/5455 (93.8038%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4973/5455 (91.1641%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9981, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4389/4679 (93.8021%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4357/4679 (93.1182%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9545, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4224/4518 (93.4927%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4230/4518 (93.6255%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9424, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4366/4618 (94.5431%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4325/4618 (93.6553%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8366, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4324/4716 (91.6879%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4220/4716 (89.4826%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1670, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4774/5244 (91.0374%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4665/5244 (88.9588%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0994, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4555/4874 (93.4551%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4352/4874 (89.2901%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2159, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4557/4928 (92.4716%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4443/4928 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1296, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3901/4126 (94.5468%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3889/4126 (94.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7824, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3649/3828 (95.3239%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3633/3828 (94.9060%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7452, Accuracy: 5994/10000 (59.9400%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3268/3472 (94.1244%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3244/3472 (93.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9779, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3405/3638 (93.5954%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3367/3638 (92.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7751, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3386/3590 (94.3175%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3058/3590 (85.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2038, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3960/4223 (93.7722%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3922/4223 (92.8724%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0107, Accuracy: 5620/10000 (56.2000%)
time spent on training: 263.7344961166382
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 6, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.4077, Accuracy: 6498/10000 (64.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0431, Accuracy: 9786/9900 (98.8485%)
Done in 292.71131443977356 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4798/4885 (98.2190%), train_poison_data_count: 385
Global model norm: 44.492061978532334.
Norm before scaling: 44.45417672305944. Distance: 1.11275118874508
Total norm for 4 adversaries is: 44.45417672305944. distance: 1.11275118874508
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0666, Accuracy: 9736/9900 (98.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5168/5305 (97.4175%), train_poison_data_count: 415
Global model norm: 44.492061978532334.
Norm before scaling: 44.45362889652894. Distance: 1.237975025519792
Total norm for 4 adversaries is: 44.45362889652894. distance: 1.237975025519792
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0844, Accuracy: 9693/9900 (97.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4601/4717 (97.5408%), train_poison_data_count: 370
Global model norm: 44.492061978532334.
Norm before scaling: 44.45745667603538. Distance: 1.1466004087097728
Total norm for 4 adversaries is: 44.45745667603538. distance: 1.1466004087097728
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0194, Accuracy: 9854/9900 (99.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4928/5066 (97.2760%), train_poison_data_count: 400
Global model norm: 44.492061978532334.
Norm before scaling: 44.458362773586394. Distance: 1.3100377556405056
Total norm for 4 adversaries is: 44.458362773586394. distance: 1.3100377556405056
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0223, Accuracy: 9852/9900 (99.5152%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4221/4441 (95.0462%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4180/4441 (94.1229%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8219, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4731/5017 (94.2994%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4616/5017 (92.0072%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8688, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4646/4918 (94.4693%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4542/4918 (92.3546%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1800, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4897/5197 (94.2274%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4624/5197 (88.9744%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1836, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4124/4356 (94.6740%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3867/4356 (88.7741%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3238, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5109/5455 (93.6572%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4992/5455 (91.5124%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0521, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3137/3297 (95.1471%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3150/3297 (95.5414%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.6803, Accuracy: 6109/10000 (61.0900%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4835/5195 (93.0703%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4625/5195 (89.0279%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2956, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3615/3828 (94.4357%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3638/3828 (95.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8328, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4245/4456 (95.2648%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4160/4456 (93.3573%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8458, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4100/4361 (94.0151%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3975/4361 (91.1488%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0213, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4003/4235 (94.5218%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3875/4235 (91.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2050, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4679/5025 (93.1144%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4644/5025 (92.4179%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0513, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3435/3646 (94.2128%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3423/3646 (93.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7049, Accuracy: 6026/10000 (60.2600%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3817/4158 (91.7989%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3707/4158 (89.1534%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0642, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4302/4538 (94.7995%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4317/4538 (95.1300%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7177, Accuracy: 6051/10000 (60.5100%)
time spent on training: 263.5804498195648
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 4, 13]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.4170, Accuracy: 6489/10000 (64.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0370, Accuracy: 9803/9900 (99.0202%)
Done in 292.8354437351227 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4780/4885 (97.8506%), train_poison_data_count: 385
Global model norm: 44.510254096405276.
Norm before scaling: 44.472424138887035. Distance: 1.1134599508783793
Total norm for 4 adversaries is: 44.472424138887035. distance: 1.1134599508783793
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0701, Accuracy: 9727/9900 (98.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5169/5305 (97.4364%), train_poison_data_count: 415
Global model norm: 44.510254096405276.
Norm before scaling: 44.471838108691045. Distance: 1.2770250021892409
Total norm for 4 adversaries is: 44.471838108691045. distance: 1.2770250021892409
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0229, Accuracy: 9848/9900 (99.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4609/4717 (97.7104%), train_poison_data_count: 370
Global model norm: 44.510254096405276.
Norm before scaling: 44.47342325452992. Distance: 1.1022658571316988
Total norm for 4 adversaries is: 44.47342325452992. distance: 1.1022658571316988
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0335, Accuracy: 9814/9900 (99.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4940/5066 (97.5128%), train_poison_data_count: 400
Global model norm: 44.510254096405276.
Norm before scaling: 44.47352481173139. Distance: 1.2166099343507104
Total norm for 4 adversaries is: 44.47352481173139. distance: 1.2166099343507104
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0281, Accuracy: 9831/9900 (99.3030%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4076/4295 (94.9010%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3853/4295 (89.7090%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3619, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5250/5582 (94.0523%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5174/5582 (92.6908%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2298, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3445/3672 (93.8181%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3426/3672 (93.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9962, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4255/4518 (94.1788%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4157/4518 (92.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0932, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3588/3797 (94.4957%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3536/3797 (93.1262%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9523, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4161/4362 (95.3920%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4034/4362 (92.4805%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1860, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4474/4804 (93.1307%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4373/4804 (91.0283%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.4456, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4800/5116 (93.8233%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4707/5116 (92.0055%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8244, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4669/5025 (92.9154%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4620/5025 (91.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1016, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3130/3297 (94.9348%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3126/3297 (94.8135%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7324, Accuracy: 6124/10000 (61.2400%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3435/3704 (92.7376%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3483/3704 (94.0335%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8048, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5078/5424 (93.6209%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5006/5424 (92.2935%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2637, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3628/3861 (93.9653%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3572/3861 (92.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9102, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4548/4874 (93.3114%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4322/4874 (88.6746%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3061, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4333/4647 (93.2430%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4301/4647 (92.5543%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9482, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4120/4356 (94.5822%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3968/4356 (91.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1769, Accuracy: 5352/10000 (53.5200%)
time spent on training: 269.04398226737976
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [18, 17, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.4333, Accuracy: 6440/10000 (64.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0335, Accuracy: 9810/9900 (99.0909%)
Done in 298.67376732826233 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4774/4885 (97.7277%), train_poison_data_count: 385
Global model norm: 44.52703379163326.
Norm before scaling: 44.490433596905135. Distance: 1.1891145271217824
Total norm for 4 adversaries is: 44.490433596905135. distance: 1.1891145271217824
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0990, Accuracy: 9638/9900 (97.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5137/5305 (96.8332%), train_poison_data_count: 415
Global model norm: 44.52703379163326.
Norm before scaling: 44.49138292182965. Distance: 1.3479021815485182
Total norm for 4 adversaries is: 44.49138292182965. distance: 1.3479021815485182
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0177, Accuracy: 9861/9900 (99.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4604/4717 (97.6044%), train_poison_data_count: 370
Global model norm: 44.52703379163326.
Norm before scaling: 44.49078891019536. Distance: 1.1282639309618765
Total norm for 4 adversaries is: 44.49078891019536. distance: 1.1282639309618765
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0381, Accuracy: 9797/9900 (98.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4944/5066 (97.5918%), train_poison_data_count: 400
Global model norm: 44.52703379163326.
Norm before scaling: 44.49224031493792. Distance: 1.2459219691578947
Total norm for 4 adversaries is: 44.49224031493792. distance: 1.2459219691578947
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0732, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4181/4503 (92.8492%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4138/4503 (91.8943%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9457, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3646/3861 (94.4315%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3610/3861 (93.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7896, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3957/4184 (94.5746%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3952/4184 (94.4551%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7647, Accuracy: 5934/10000 (59.3400%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4264/4518 (94.3780%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4215/4518 (93.2935%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0072, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4770/5083 (93.8422%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4519/5083 (88.9042%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0868, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4502/4804 (93.7136%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4077/4804 (84.8668%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3061, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4090/4356 (93.8935%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3979/4356 (91.3453%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0011, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4765/5244 (90.8658%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4609/5244 (87.8909%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1453, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4420/4679 (94.4646%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4126/4679 (88.1812%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1869, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4129/4416 (93.5009%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4105/4416 (92.9574%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9052, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4656/4918 (94.6726%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4578/4918 (93.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0348, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3392/3616 (93.8053%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3393/3616 (93.8330%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9342, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4295/4576 (93.8593%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4199/4576 (91.7614%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9425, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4609/4928 (93.5268%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4505/4928 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9367, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3810/4013 (94.9414%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3809/4013 (94.9165%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7337, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4075/4336 (93.9806%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3963/4336 (91.3976%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1308, Accuracy: 5400/10000 (54.0000%)
time spent on training: 264.51259422302246
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [9, 5, 6]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.4379, Accuracy: 6445/10000 (64.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0346, Accuracy: 9809/9900 (99.0808%)
Done in 293.54771304130554 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4781/4885 (97.8710%), train_poison_data_count: 385
Global model norm: 44.5452993188535.
Norm before scaling: 44.507404525732426. Distance: 1.1643848356936215
Total norm for 4 adversaries is: 44.507404525732426. distance: 1.1643848356936215
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0476, Accuracy: 9778/9900 (98.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5165/5305 (97.3610%), train_poison_data_count: 415
Global model norm: 44.5452993188535.
Norm before scaling: 44.507448408858345. Distance: 1.295568704518383
Total norm for 4 adversaries is: 44.507448408858345. distance: 1.295568704518383
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0370, Accuracy: 9803/9900 (99.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4597/4717 (97.4560%), train_poison_data_count: 370
Global model norm: 44.5452993188535.
Norm before scaling: 44.50937922356576. Distance: 1.1452012428275615
Total norm for 4 adversaries is: 44.50937922356576. distance: 1.1452012428275615
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0732, Accuracy: 9715/9900 (98.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4926/5066 (97.2365%), train_poison_data_count: 400
Global model norm: 44.5452993188535.
Norm before scaling: 44.509918136298566. Distance: 1.2699406359908068
Total norm for 4 adversaries is: 44.509918136298566. distance: 1.2699406359908068
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0426, Accuracy: 9790/9900 (98.8889%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5859/6263 (93.5494%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5790/6263 (92.4477%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0362, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3294/3472 (94.8733%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3245/3472 (93.4620%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9698, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3827/4158 (92.0394%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3765/4158 (90.5483%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9184, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3373/3638 (92.7158%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3371/3638 (92.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.7594, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4509/4874 (92.5113%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4449/4874 (91.2803%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1448, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4137/4356 (94.9725%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3865/4356 (88.7282%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3948, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4304/4538 (94.8435%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4285/4538 (94.4249%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8482, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4600/4928 (93.3442%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4489/4928 (91.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9420, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4396/4618 (95.1927%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4323/4618 (93.6120%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9055, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4405/4707 (93.5840%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4324/4707 (91.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9666, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4460/4679 (95.3195%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4171/4679 (89.1430%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0467, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4355/4647 (93.7164%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4246/4647 (91.3708%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2137, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4321/4576 (94.4274%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4209/4576 (91.9799%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9540, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3827/4046 (94.5872%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3681/4046 (90.9787%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9801, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4366/4651 (93.8723%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4259/4651 (91.5717%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0692, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4703/5055 (93.0366%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4630/5055 (91.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1714, Accuracy: 5315/10000 (53.1500%)
time spent on training: 265.211163520813
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 4 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [4, 7, 8]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.4401, Accuracy: 6434/10000 (64.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0354, Accuracy: 9808/9900 (99.0707%)
Done in 294.48225116729736 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4788/4885 (98.0143%), train_poison_data_count: 385
Global model norm: 44.56348203029093.
Norm before scaling: 44.52465137514414. Distance: 1.1348052814008451
Total norm for 4 adversaries is: 44.52465137514414. distance: 1.1348052814008451
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0525, Accuracy: 9771/9900 (98.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5154/5305 (97.1536%), train_poison_data_count: 415
Global model norm: 44.56348203029093.
Norm before scaling: 44.52676238353037. Distance: 1.2973605706154643
Total norm for 4 adversaries is: 44.52676238353037. distance: 1.2973605706154643
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0269, Accuracy: 9824/9900 (99.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4599/4717 (97.4984%), train_poison_data_count: 370
Global model norm: 44.56348203029093.
Norm before scaling: 44.52770819248393. Distance: 1.1530549004810025
Total norm for 4 adversaries is: 44.52770819248393. distance: 1.1530549004810025
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0618, Accuracy: 9744/9900 (98.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4930/5066 (97.3154%), train_poison_data_count: 400
Global model norm: 44.56348203029093.
Norm before scaling: 44.528525135931126. Distance: 1.28121078245108
Total norm for 4 adversaries is: 44.528525135931126. distance: 1.28121078245108
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0138, Accuracy: 9865/9900 (99.6465%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5332/5740 (92.8920%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5258/5740 (91.6028%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2703, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3910/4175 (93.6527%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3834/4175 (91.8323%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0610, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4662/4918 (94.7946%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4618/4918 (93.9000%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8908, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4017/4235 (94.8524%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3996/4235 (94.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8960, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5112/5455 (93.7122%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5023/5455 (92.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0882, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4361/4662 (93.5435%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4296/4662 (92.1493%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9909, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4223/4465 (94.5801%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4159/4465 (93.1467%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9657, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4391/4651 (94.4098%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4292/4651 (92.2812%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1017, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4373/4618 (94.6947%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4176/4618 (90.4288%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0736, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4677/5037 (92.8529%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4612/5037 (91.5624%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0485, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4083/4354 (93.7758%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3596/4354 (82.5907%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.5349, Accuracy: 4667/10000 (46.6700%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4226/4441 (95.1587%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4134/4441 (93.0871%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1367, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4300/4538 (94.7554%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4246/4538 (93.5654%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9242, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4834/5116 (94.4879%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4708/5116 (92.0250%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1522, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5667/6124 (92.5376%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5496/6124 (89.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3460, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4155/4362 (95.2545%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4015/4362 (92.0449%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2401, Accuracy: 5170/10000 (51.7000%)
time spent on training: 268.6104772090912
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 17, 13]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.4458, Accuracy: 6419/10000 (64.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0335, Accuracy: 9812/9900 (99.1111%)
Done in 297.85050439834595 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4791/4885 (98.0757%), train_poison_data_count: 385
Global model norm: 44.58260470831785.
Norm before scaling: 44.542594497956394. Distance: 1.1183963451077468
Total norm for 4 adversaries is: 44.542594497956394. distance: 1.1183963451077468
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0225, Accuracy: 9848/9900 (99.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5177/5305 (97.5872%), train_poison_data_count: 415
Global model norm: 44.58260470831785.
Norm before scaling: 44.543386504059164. Distance: 1.242019689969
Total norm for 4 adversaries is: 44.543386504059164. distance: 1.242019689969
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0316, Accuracy: 9813/9900 (99.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4586/4717 (97.2228%), train_poison_data_count: 370
Global model norm: 44.58260470831785.
Norm before scaling: 44.54593370848721. Distance: 1.13220166805288
Total norm for 4 adversaries is: 44.54593370848721. distance: 1.13220166805288
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0752, Accuracy: 9722/9900 (98.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4957/5066 (97.8484%), train_poison_data_count: 400
Global model norm: 44.58260470831785.
Norm before scaling: 44.54437991741003. Distance: 1.1775485725670511
Total norm for 4 adversaries is: 44.54437991741003. distance: 1.1775485725670511
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0520, Accuracy: 9771/9900 (98.6970%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4071/4361 (93.3501%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3904/4361 (89.5208%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1615, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3593/3797 (94.6273%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3561/3797 (93.7846%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0085, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4650/4918 (94.5506%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4592/4918 (93.3713%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1857, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3373/3638 (92.7158%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3399/3638 (93.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8705, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3436/3590 (95.7103%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3263/3590 (90.8914%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1171, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4641/4986 (93.0806%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4540/4986 (91.0550%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0065, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5002/5392 (92.7671%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4806/5392 (89.1320%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1345, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3566/3804 (93.7434%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3543/3804 (93.1388%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0000, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4722/5025 (93.9701%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4642/5025 (92.3781%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1008, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4489/4793 (93.6574%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4411/4793 (92.0300%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9527, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4570/4956 (92.2115%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4465/4956 (90.0928%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2146, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4808/5116 (93.9797%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4718/5116 (92.2205%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9752, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4719/5055 (93.3531%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4576/5055 (90.5242%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9964, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4710/5063 (93.0278%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4447/5063 (87.8333%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1851, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4202/4433 (94.7891%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4098/4433 (92.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9600, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4394/4662 (94.2514%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4297/4662 (92.1707%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9874, Accuracy: 5515/10000 (55.1500%)
time spent on training: 266.0828137397766
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 16, 8]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.4553, Accuracy: 6404/10000 (64.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0322, Accuracy: 9815/9900 (99.1414%)
Done in 295.5063772201538 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4792/4885 (98.0962%), train_poison_data_count: 385
Global model norm: 44.60105411669451.
Norm before scaling: 44.560085236555175. Distance: 1.0925026456683007
Total norm for 4 adversaries is: 44.560085236555175. distance: 1.0925026456683007
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0343, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5149/5305 (97.0594%), train_poison_data_count: 415
Global model norm: 44.60105411669451.
Norm before scaling: 44.562969788459874. Distance: 1.2954179782969175
Total norm for 4 adversaries is: 44.562969788459874. distance: 1.2954179782969175
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0881, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4614/4717 (97.8164%), train_poison_data_count: 370
Global model norm: 44.60105411669451.
Norm before scaling: 44.562997181220176. Distance: 1.0807593406540092
Total norm for 4 adversaries is: 44.562997181220176. distance: 1.0807593406540092
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0467, Accuracy: 9776/9900 (98.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4941/5066 (97.5326%), train_poison_data_count: 400
Global model norm: 44.60105411669451.
Norm before scaling: 44.56446266934913. Distance: 1.2436530626562263
Total norm for 4 adversaries is: 44.56446266934913. distance: 1.2436530626562263
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0114, Accuracy: 9874/9900 (99.7374%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4487/4804 (93.4013%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4286/4804 (89.2173%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.4940, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4523/4793 (94.3668%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4473/4793 (93.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9415, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3574/3781 (94.5253%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3528/3781 (93.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0264, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3909/4175 (93.6287%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3748/4175 (89.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1671, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4156/4362 (95.2774%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4124/4362 (94.5438%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9327, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4740/5083 (93.2520%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4580/5083 (90.1043%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1487, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4552/4874 (93.3935%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4395/4874 (90.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3309, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3431/3646 (94.1031%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3391/3646 (93.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8374, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3573/3756 (95.1278%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3593/3756 (95.6603%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8152, Accuracy: 5921/10000 (59.2100%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3987/4223 (94.4116%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3986/4223 (94.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0044, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4135/4356 (94.9265%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3807/4356 (87.3967%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3405, Accuracy: 4994/10000 (49.9400%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4704/5025 (93.6119%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4633/5025 (92.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0026, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5933/6391 (92.8337%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5718/6391 (89.4696%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1150, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4251/4518 (94.0903%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4241/4518 (93.8690%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9374, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4868/5167 (94.2133%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4785/5167 (92.6069%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0260, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4445/4679 (94.9989%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4162/4679 (88.9506%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1397, Accuracy: 5340/10000 (53.4000%)
time spent on training: 266.5418589115143
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 17 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [9, 5, 17]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.4798, Accuracy: 6358/10000 (63.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0302, Accuracy: 9818/9900 (99.1717%)
Done in 295.75521779060364 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4792/4885 (98.0962%), train_poison_data_count: 385
Global model norm: 44.61928934267457.
Norm before scaling: 44.579455816097344. Distance: 1.1065967318161345
Total norm for 4 adversaries is: 44.579455816097344. distance: 1.1065967318161345
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0896, Accuracy: 9668/9900 (97.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5190/5305 (97.8322%), train_poison_data_count: 415
Global model norm: 44.61928934267457.
Norm before scaling: 44.578190720245985. Distance: 1.201333632083507
Total norm for 4 adversaries is: 44.578190720245985. distance: 1.201333632083507
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0588, Accuracy: 9757/9900 (98.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4610/4717 (97.7316%), train_poison_data_count: 370
Global model norm: 44.61928934267457.
Norm before scaling: 44.58135339256201. Distance: 1.0891648232158149
Total norm for 4 adversaries is: 44.58135339256201. distance: 1.0891648232158149
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0196, Accuracy: 9854/9900 (99.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4943/5066 (97.5720%), train_poison_data_count: 400
Global model norm: 44.61928934267457.
Norm before scaling: 44.58254720880134. Distance: 1.2393490011515214
Total norm for 4 adversaries is: 44.58254720880134. distance: 1.2393490011515214
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0904, Accuracy: 9667/9900 (97.6465%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4604/4956 (92.8975%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4491/4956 (90.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1283, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3580/3797 (94.2850%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3557/3797 (93.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9807, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4730/5017 (94.2794%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4701/5017 (93.7014%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8180, Accuracy: 5951/10000 (59.5100%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4225/4433 (95.3079%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4162/4433 (93.8868%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9563, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3579/3781 (94.6575%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3564/3781 (94.2608%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9514, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4916/5265 (93.3713%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4619/5265 (87.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2923, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4865/5197 (93.6117%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4735/5197 (91.1103%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0642, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3447/3646 (94.5420%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3436/3646 (94.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7373, Accuracy: 5978/10000 (59.7800%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4040/4356 (92.7456%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3921/4356 (90.0138%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5207, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3564/3804 (93.6909%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3537/3804 (92.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9057, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3430/3590 (95.5432%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3298/3590 (91.8663%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1208, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3850/4046 (95.1557%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3837/4046 (94.8344%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7658, Accuracy: 5941/10000 (59.4100%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4792/5244 (91.3806%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4568/5244 (87.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0974, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4734/5025 (94.2090%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4589/5025 (91.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0931, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3599/3756 (95.8200%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3617/3756 (96.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8324, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5075/5392 (94.1209%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4836/5392 (89.6884%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3886, Accuracy: 5099/10000 (50.9900%)
time spent on training: 262.3178572654724
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 17, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.4824, Accuracy: 6358/10000 (63.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0315, Accuracy: 9816/9900 (99.1515%)
Done in 291.26479840278625 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4784/4885 (97.9324%), train_poison_data_count: 385
Global model norm: 44.63714383083891.
Norm before scaling: 44.598276038272346. Distance: 1.1107655795917455
Total norm for 4 adversaries is: 44.598276038272346. distance: 1.1107655795917455
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0365, Accuracy: 9803/9900 (99.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5172/5305 (97.4929%), train_poison_data_count: 415
Global model norm: 44.63714383083891.
Norm before scaling: 44.598267826946625. Distance: 1.269617963910547
Total norm for 4 adversaries is: 44.598267826946625. distance: 1.269617963910547
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0391, Accuracy: 9804/9900 (99.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4599/4717 (97.4984%), train_poison_data_count: 370
Global model norm: 44.63714383083891.
Norm before scaling: 44.59878376897598. Distance: 1.1370532929806703
Total norm for 4 adversaries is: 44.59878376897598. distance: 1.1370532929806703
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0328, Accuracy: 9812/9900 (99.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4951/5066 (97.7300%), train_poison_data_count: 400
Global model norm: 44.63714383083891.
Norm before scaling: 44.597608178841135. Distance: 1.180351474674978
Total norm for 4 adversaries is: 44.597608178841135. distance: 1.180351474674978
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0845, Accuracy: 9687/9900 (97.8485%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4422/4663 (94.8317%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4349/4663 (93.2661%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8987, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4387/4618 (94.9978%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4317/4618 (93.4820%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9989, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4390/4662 (94.1656%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4306/4662 (92.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0855, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4184/4511 (92.7511%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4130/4511 (91.5540%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0166, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4146/4362 (95.0481%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4120/4362 (94.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8486, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4266/4558 (93.5937%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4081/4558 (89.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1366, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3642/3828 (95.1411%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3649/3828 (95.3239%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7090, Accuracy: 6149/10000 (61.4900%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4419/4716 (93.7023%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4279/4716 (90.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0393, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4230/4465 (94.7368%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4170/4465 (93.3931%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8870, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4537/4928 (92.0657%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4357/4928 (88.4131%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1193, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5102/5455 (93.5289%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4853/5455 (88.9643%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0721, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4375/4647 (94.1468%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4275/4647 (91.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0066, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5099/5591 (91.2001%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4976/5591 (89.0002%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3045, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3400/3616 (94.0265%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3355/3616 (92.7821%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7595, Accuracy: 5965/10000 (59.6500%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4655/4986 (93.3614%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4589/4986 (92.0377%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0580, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4880/5167 (94.4455%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4777/5167 (92.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1457, Accuracy: 5402/10000 (54.0200%)
time spent on training: 266.78645038604736
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 12, 4]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.4820, Accuracy: 6354/10000 (63.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0317, Accuracy: 9813/9900 (99.1212%)
Done in 296.3347451686859 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4789/4885 (98.0348%), train_poison_data_count: 385
Global model norm: 44.65517706679918.
Norm before scaling: 44.61620049578054. Distance: 1.1489596574671364
Total norm for 4 adversaries is: 44.61620049578054. distance: 1.1489596574671364
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0258, Accuracy: 9837/9900 (99.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5186/5305 (97.7568%), train_poison_data_count: 415
Global model norm: 44.65517706679918.
Norm before scaling: 44.614292088900726. Distance: 1.2109579269162962
Total norm for 4 adversaries is: 44.614292088900726. distance: 1.2109579269162962
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0430, Accuracy: 9774/9900 (98.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4612/4717 (97.7740%), train_poison_data_count: 370
Global model norm: 44.65517706679918.
Norm before scaling: 44.61795013903457. Distance: 1.1224650858013707
Total norm for 4 adversaries is: 44.61795013903457. distance: 1.1224650858013707
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0557, Accuracy: 9759/9900 (98.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4955/5066 (97.8089%), train_poison_data_count: 400
Global model norm: 44.65517706679918.
Norm before scaling: 44.617218279406295. Distance: 1.1951878800597262
Total norm for 4 adversaries is: 44.617218279406295. distance: 1.1951878800597262
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0207, Accuracy: 9855/9900 (99.5455%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3944/4175 (94.4671%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3739/4175 (89.5569%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0619, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4324/4596 (94.0818%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4264/4596 (92.7763%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0168, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3375/3616 (93.3352%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3396/3616 (93.9159%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7995, Accuracy: 5996/10000 (59.9600%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4169/4356 (95.7071%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3560/4356 (81.7264%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.8575, Accuracy: 4367/10000 (43.6700%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4845/5244 (92.3913%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4632/5244 (88.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1502, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3119/3297 (94.6012%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3114/3297 (94.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7726, Accuracy: 5953/10000 (59.5300%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3439/3646 (94.3225%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3395/3646 (93.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9039, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3616/3797 (95.2331%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3525/3797 (92.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9588, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4256/4456 (95.5117%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4213/4456 (94.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8625, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3662/3828 (95.6635%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3634/3828 (94.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8736, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5299/5582 (94.9301%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5176/5582 (92.7266%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2702, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3296/3472 (94.9309%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3206/3472 (92.3387%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0549, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4147/4362 (95.0711%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4066/4362 (93.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9853, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5126/5424 (94.5059%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5081/5424 (93.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0468, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4448/4679 (95.0630%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4208/4679 (89.9337%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0729, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3430/3590 (95.5432%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3246/3590 (90.4178%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1452, Accuracy: 5428/10000 (54.2800%)
time spent on training: 256.11233949661255
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [18, 12, 6]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.5106, Accuracy: 6309/10000 (63.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0302, Accuracy: 9821/9900 (99.2020%)
Done in 285.406329870224 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4788/4885 (98.0143%), train_poison_data_count: 385
Global model norm: 44.67196517566974.
Norm before scaling: 44.6317191742074. Distance: 1.1227371983024461
Total norm for 4 adversaries is: 44.6317191742074. distance: 1.1227371983024461
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0286, Accuracy: 9827/9900 (99.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5152/5305 (97.1159%), train_poison_data_count: 415
Global model norm: 44.67196517566974.
Norm before scaling: 44.635619195621814. Distance: 1.3481828628169559
Total norm for 4 adversaries is: 44.635619195621814. distance: 1.3481828628169559
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0506, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4620/4717 (97.9436%), train_poison_data_count: 370
Global model norm: 44.67196517566974.
Norm before scaling: 44.63412595980023. Distance: 1.096518745060356
Total norm for 4 adversaries is: 44.63412595980023. distance: 1.096518745060356
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0659, Accuracy: 9737/9900 (98.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4969/5066 (98.0853%), train_poison_data_count: 400
Global model norm: 44.67196517566974.
Norm before scaling: 44.63166994314757. Distance: 1.138743691118102
Total norm for 4 adversaries is: 44.63166994314757. distance: 1.138743691118102
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0196, Accuracy: 9854/9900 (99.5354%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3590/3804 (94.3743%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3589/3804 (94.3481%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8580, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3168/3297 (96.0874%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3134/3297 (95.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7574, Accuracy: 6069/10000 (60.6900%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4112/4354 (94.4419%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3634/4354 (83.4635%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4206, Accuracy: 4856/10000 (48.5600%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4231/4433 (95.4433%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4087/4433 (92.1949%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8286, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3597/3775 (95.2848%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3602/3775 (95.4172%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8040, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4822/5195 (92.8200%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4676/5195 (90.0096%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0633, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5097/5392 (94.5289%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4964/5392 (92.0623%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9595, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4784/5244 (91.2281%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4616/5244 (88.0244%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1716, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4135/4356 (94.9265%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3717/4356 (85.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3424, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4086/4416 (92.5272%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4035/4416 (91.3723%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0151, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4148/4481 (92.5686%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3990/4481 (89.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1939, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4224/4441 (95.1137%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4146/4441 (93.3574%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0758, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4091/4336 (94.3496%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3962/4336 (91.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3015, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3475/3646 (95.3099%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3472/3646 (95.2276%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.6985, Accuracy: 6157/10000 (61.5700%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4404/4647 (94.7708%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4351/4647 (93.6303%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8301, Accuracy: 5925/10000 (59.2500%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3395/3638 (93.3205%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3374/3638 (92.7433%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9196, Accuracy: 5788/10000 (57.8800%)
time spent on training: 261.6758065223694
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 5, 19]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.5229, Accuracy: 6288/10000 (62.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0290, Accuracy: 9825/9900 (99.2424%)
Done in 290.70157647132874 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4781/4885 (97.8710%), train_poison_data_count: 385
Global model norm: 44.69051290105513.
Norm before scaling: 44.65206883198765. Distance: 1.1688380753893146
Total norm for 4 adversaries is: 44.65206883198765. distance: 1.1688380753893146
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0221, Accuracy: 9842/9900 (99.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5186/5305 (97.7568%), train_poison_data_count: 415
Global model norm: 44.69051290105513.
Norm before scaling: 44.649930940683575. Distance: 1.209980198642975
Total norm for 4 adversaries is: 44.649930940683575. distance: 1.209980198642975
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0297, Accuracy: 9825/9900 (99.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4608/4717 (97.6892%), train_poison_data_count: 370
Global model norm: 44.69051290105513.
Norm before scaling: 44.653607940998874. Distance: 1.1206105217580793
Total norm for 4 adversaries is: 44.653607940998874. distance: 1.1206105217580793
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0306, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4952/5066 (97.7497%), train_poison_data_count: 400
Global model norm: 44.69051290105513.
Norm before scaling: 44.651110620985676. Distance: 1.1845115401743254
Total norm for 4 adversaries is: 44.651110620985676. distance: 1.1845115401743254
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0285, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4319/4538 (95.1741%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4280/4538 (94.3147%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8017, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5399/5740 (94.0592%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5313/5740 (92.5610%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0326, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4558/4934 (92.3794%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4134/4934 (83.7860%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.5852, Accuracy: 4736/10000 (47.3600%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3810/4013 (94.9414%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3794/4013 (94.5427%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7426, Accuracy: 5976/10000 (59.7600%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4184/4511 (92.7511%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4135/4511 (91.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0952, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4210/4501 (93.5348%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4126/4501 (91.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9660, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4257/4518 (94.2231%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4165/4518 (92.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1005, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3594/3804 (94.4795%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3553/3804 (93.4017%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9238, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3568/3781 (94.3666%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3332/3781 (88.1248%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2215, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4265/4441 (96.0369%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4242/4441 (95.5190%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8758, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4427/4662 (94.9592%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4336/4662 (93.0073%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9809, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3294/3472 (94.8733%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3277/3472 (94.3836%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8859, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3704/3911 (94.7072%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3529/3911 (90.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0690, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4336/4634 (93.5693%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4251/4634 (91.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9103, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4400/4618 (95.2793%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4341/4618 (94.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0698, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4820/5195 (92.7815%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4647/5195 (89.4514%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1397, Accuracy: 5401/10000 (54.0100%)
time spent on training: 264.1812491416931
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 4 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [4, 15, 13]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.5173, Accuracy: 6299/10000 (62.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0310, Accuracy: 9820/9900 (99.1919%)
Done in 293.4335834980011 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4794/4885 (98.1372%), train_poison_data_count: 385
Global model norm: 44.70868297107188.
Norm before scaling: 44.667654301746275. Distance: 1.0732163069488156
Total norm for 4 adversaries is: 44.667654301746275. distance: 1.0732163069488156
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0460, Accuracy: 9788/9900 (98.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5202/5305 (98.0584%), train_poison_data_count: 415
Global model norm: 44.70868297107188.
Norm before scaling: 44.66573032897047. Distance: 1.1706388947843018
Total norm for 4 adversaries is: 44.66573032897047. distance: 1.1706388947843018
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0581, Accuracy: 9741/9900 (98.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4615/4717 (97.8376%), train_poison_data_count: 370
Global model norm: 44.70868297107188.
Norm before scaling: 44.67017255850094. Distance: 1.0906116145932994
Total norm for 4 adversaries is: 44.67017255850094. distance: 1.0906116145932994
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0546, Accuracy: 9754/9900 (98.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4958/5066 (97.8681%), train_poison_data_count: 400
Global model norm: 44.70868297107188.
Norm before scaling: 44.66932677892977. Distance: 1.1849105107442883
Total norm for 4 adversaries is: 44.66932677892977. distance: 1.1849105107442883
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0481, Accuracy: 9782/9900 (98.8081%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3023/3271 (92.4182%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0061, Accuracy: 2886/3271 (88.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1943, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4660/4928 (94.5617%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4522/4928 (91.7614%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9608, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4497/4804 (93.6095%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4042/4804 (84.1382%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.8035, Accuracy: 4622/10000 (46.2200%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4409/4618 (95.4742%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4331/4618 (93.7852%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0285, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3593/3756 (95.6603%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3583/3756 (95.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8045, Accuracy: 5956/10000 (59.5600%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4362/4634 (94.1303%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4303/4634 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1132, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3409/3638 (93.7053%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3409/3638 (93.7053%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9262, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3505/3704 (94.6274%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3480/3704 (93.9525%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7115, Accuracy: 6052/10000 (60.5200%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4414/4707 (93.7752%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4342/4707 (92.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0043, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4166/4481 (92.9703%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3964/4481 (88.4624%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1889, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4085/4354 (93.8218%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3960/4354 (90.9508%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3709, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3452/3646 (94.6791%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3454/3646 (94.7340%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7433, Accuracy: 6023/10000 (60.2300%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3964/4223 (93.8669%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3942/4223 (93.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9422, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4204/4511 (93.1944%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4155/4511 (92.1082%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9986, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4223/4456 (94.7711%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4205/4456 (94.3671%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9781, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3615/3861 (93.6286%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3567/3861 (92.3854%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0300, Accuracy: 5586/10000 (55.8600%)
time spent on training: 256.5888500213623
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [12, 10, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.5168, Accuracy: 6314/10000 (63.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0303, Accuracy: 9819/9900 (99.1818%)
Done in 285.87340259552 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4788/4885 (98.0143%), train_poison_data_count: 385
Global model norm: 44.72521354406818.
Norm before scaling: 44.68590605767452. Distance: 1.1423272794888317
Total norm for 4 adversaries is: 44.68590605767452. distance: 1.1423272794888317
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0442, Accuracy: 9792/9900 (98.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5179/5305 (97.6249%), train_poison_data_count: 415
Global model norm: 44.72521354406818.
Norm before scaling: 44.6841208294051. Distance: 1.2295407140970873
Total norm for 4 adversaries is: 44.6841208294051. distance: 1.2295407140970873
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0261, Accuracy: 9839/9900 (99.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4596/4717 (97.4348%), train_poison_data_count: 370
Global model norm: 44.72521354406818.
Norm before scaling: 44.6882908037546. Distance: 1.1497699507450307
Total norm for 4 adversaries is: 44.6882908037546. distance: 1.1497699507450307
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0414, Accuracy: 9787/9900 (98.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4967/5066 (98.0458%), train_poison_data_count: 400
Global model norm: 44.72521354406818.
Norm before scaling: 44.684542898226425. Distance: 1.151799218784047
Total norm for 4 adversaries is: 44.684542898226425. distance: 1.151799218784047
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0897, Accuracy: 9666/9900 (97.6364%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3617/3804 (95.0841%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3570/3804 (93.8486%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0319, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4243/4501 (94.2679%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4082/4501 (90.6910%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9636, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4398/4663 (94.3170%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4361/4663 (93.5235%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9743, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5181/5591 (92.6668%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5045/5591 (90.2343%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0119, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4840/5244 (92.2960%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4612/5244 (87.9481%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0435, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4230/4433 (95.4207%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4164/4433 (93.9319%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8713, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4440/4707 (94.3276%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4339/4707 (92.1819%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9300, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4214/4456 (94.5691%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4201/4456 (94.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9220, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4148/4356 (95.2250%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3891/4356 (89.3251%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0736, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4333/4576 (94.6897%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4252/4576 (92.9196%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0818, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4410/4679 (94.2509%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4118/4679 (88.0103%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3688, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4337/4634 (93.5909%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4277/4634 (92.2961%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8181, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3826/4013 (95.3401%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3813/4013 (95.0162%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8156, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4843/5232 (92.5650%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4628/5232 (88.4557%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2068, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3893/4126 (94.3529%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3879/4126 (94.0136%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8530, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3627/3756 (96.5655%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0022, Accuracy: 3608/3756 (96.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.6888, Accuracy: 6203/10000 (62.0300%)
time spent on training: 263.4909586906433
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 17, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.5214, Accuracy: 6305/10000 (63.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0318, Accuracy: 9817/9900 (99.1616%)
Done in 292.98026990890503 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4795/4885 (98.1576%), train_poison_data_count: 385
Global model norm: 44.74251148498903.
Norm before scaling: 44.70141965245973. Distance: 1.0914370467606576
Total norm for 4 adversaries is: 44.70141965245973. distance: 1.0914370467606576
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0894, Accuracy: 9663/9900 (97.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5194/5305 (97.9076%), train_poison_data_count: 415
Global model norm: 44.74251148498903.
Norm before scaling: 44.70237132360123. Distance: 1.2393871387189264
Total norm for 4 adversaries is: 44.70237132360123. distance: 1.2393871387189264
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0296, Accuracy: 9820/9900 (99.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4628/4717 (98.1132%), train_poison_data_count: 370
Global model norm: 44.74251148498903.
Norm before scaling: 44.70211463381095. Distance: 1.0085772193127254
Total norm for 4 adversaries is: 44.70211463381095. distance: 1.0085772193127254
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0920, Accuracy: 9678/9900 (97.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4948/5066 (97.6707%), train_poison_data_count: 400
Global model norm: 44.74251148498903.
Norm before scaling: 44.70478386252765. Distance: 1.2154953365260004
Total norm for 4 adversaries is: 44.70478386252765. distance: 1.2154953365260004
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0285, Accuracy: 9832/9900 (99.3131%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4772/5055 (94.4016%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4585/5055 (90.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1954, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4198/4481 (93.6844%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4011/4481 (89.5113%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1675, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4443/4767 (93.2033%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4253/4767 (89.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1760, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4888/5265 (92.8395%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4637/5265 (88.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1585, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4299/4558 (94.3177%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4188/4558 (91.8824%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9873, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5185/5591 (92.7383%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4966/5591 (88.8213%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1948, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4839/5232 (92.4885%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4699/5232 (89.8127%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1628, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3602/3756 (95.8999%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3590/3756 (95.5804%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8396, Accuracy: 5946/10000 (59.4600%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4199/4433 (94.7214%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4148/4433 (93.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8693, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4513/4793 (94.1581%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4455/4793 (92.9480%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0072, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4041/4235 (95.4191%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3776/4235 (89.1617%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0593, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4430/4707 (94.1151%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4303/4707 (91.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9785, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3825/4025 (95.0311%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3774/4025 (93.7640%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8638, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3582/3837 (93.3542%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3651/3837 (95.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8444, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5838/6391 (91.3472%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5585/6391 (87.3885%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2514, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4094/4354 (94.0285%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0119, Accuracy: 3386/4354 (77.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.5560, Accuracy: 4709/10000 (47.0900%)
time spent on training: 268.6951265335083
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [16, 10, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.5310, Accuracy: 6291/10000 (62.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0344, Accuracy: 9808/9900 (99.0707%)
Done in 298.0776824951172 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4795/4885 (98.1576%), train_poison_data_count: 385
Global model norm: 44.76324164685099.
Norm before scaling: 44.721551984631105. Distance: 1.068890985035003
Total norm for 4 adversaries is: 44.721551984631105. distance: 1.068890985035003
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0778, Accuracy: 9706/9900 (98.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5175/5305 (97.5495%), train_poison_data_count: 415
Global model norm: 44.76324164685099.
Norm before scaling: 44.723760146925116. Distance: 1.2964441433991827
Total norm for 4 adversaries is: 44.723760146925116. distance: 1.2964441433991827
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0443, Accuracy: 9785/9900 (98.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4598/4717 (97.4772%), train_poison_data_count: 370
Global model norm: 44.76324164685099.
Norm before scaling: 44.725021125187155. Distance: 1.1200734456708183
Total norm for 4 adversaries is: 44.725021125187155. distance: 1.1200734456708183
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0522, Accuracy: 9770/9900 (98.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4964/5066 (97.9866%), train_poison_data_count: 400
Global model norm: 44.76324164685099.
Norm before scaling: 44.72345581459465. Distance: 1.1444765670264
Total norm for 4 adversaries is: 44.72345581459465. distance: 1.1444765670264
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0222, Accuracy: 9849/9900 (99.4848%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5084/5424 (93.7316%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5033/5424 (92.7913%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2373, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4320/4576 (94.4056%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4277/4576 (93.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9417, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4561/4934 (92.4402%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4211/4934 (85.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3936, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5301/5582 (94.9660%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5054/5582 (90.5410%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1065, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4631/4956 (93.4423%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4481/4956 (90.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3047, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5477/5902 (92.7991%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5179/5902 (87.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3421, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3121/3297 (94.6618%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3084/3297 (93.5396%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7937, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3294/3472 (94.8733%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3298/3472 (94.9885%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9327, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4659/4928 (94.5414%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4594/4928 (93.2224%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8879, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4189/4481 (93.4836%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4016/4481 (89.6229%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0321, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4740/5025 (94.3284%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4634/5025 (92.2189%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0240, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4610/4986 (92.4589%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4574/4986 (91.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0334, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4553/4928 (92.3904%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4500/4928 (91.3149%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1443, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4539/4804 (94.4838%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4074/4804 (84.8043%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4210, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3433/3646 (94.1580%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3416/3646 (93.6917%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8394, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4465/4707 (94.8587%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4299/4707 (91.3321%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9764, Accuracy: 5499/10000 (54.9900%)
time spent on training: 268.09171628952026
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [10, 16, 6]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.5338, Accuracy: 6286/10000 (62.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0337, Accuracy: 9809/9900 (99.0808%)
Done in 297.1785943508148 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4806/4885 (98.3828%), train_poison_data_count: 385
Global model norm: 44.78242213225241.
Norm before scaling: 44.741577037698534. Distance: 1.0992142016351294
Total norm for 4 adversaries is: 44.741577037698534. distance: 1.0992142016351294
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0123, Accuracy: 9862/9900 (99.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5186/5305 (97.7568%), train_poison_data_count: 415
Global model norm: 44.78242213225241.
Norm before scaling: 44.74203539676433. Distance: 1.219754954023674
Total norm for 4 adversaries is: 44.74203539676433. distance: 1.219754954023674
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0176, Accuracy: 9857/9900 (99.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4592/4717 (97.3500%), train_poison_data_count: 370
Global model norm: 44.78242213225241.
Norm before scaling: 44.74389197578397. Distance: 1.1114018152674838
Total norm for 4 adversaries is: 44.74389197578397. distance: 1.1114018152674838
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0413, Accuracy: 9801/9900 (99.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4940/5066 (97.5128%), train_poison_data_count: 400
Global model norm: 44.78242213225241.
Norm before scaling: 44.74457265665371. Distance: 1.2448736932561693
Total norm for 4 adversaries is: 44.74457265665371. distance: 1.2448736932561693
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0411, Accuracy: 9793/9900 (98.9192%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4838/5116 (94.5661%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4719/5116 (92.2400%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0692, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4392/4651 (94.4313%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4305/4651 (92.5607%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9574, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5208/5591 (93.1497%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4988/5591 (89.2148%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1931, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4478/4804 (93.2140%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4125/4804 (85.8659%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4834, Accuracy: 4957/10000 (49.5700%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4251/4456 (95.3995%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4216/4456 (94.6140%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8535, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4727/5063 (93.3636%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4394/5063 (86.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3036, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4002/4223 (94.7668%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3960/4223 (93.7722%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8337, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4585/4934 (92.9266%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4238/4934 (85.8938%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.5116, Accuracy: 4747/10000 (47.4700%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3624/3828 (94.6708%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3634/3828 (94.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8675, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5471/5902 (92.6974%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5006/5902 (84.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4369, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4151/4416 (93.9991%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4090/4416 (92.6178%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9302, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4336/4538 (95.5487%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4304/4538 (94.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.7333, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4680/5025 (93.1343%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4619/5025 (91.9204%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0786, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4312/4625 (93.2324%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4142/4625 (89.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0588, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4911/5197 (94.4968%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4658/5197 (89.6286%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4785, Accuracy: 4883/10000 (48.8300%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3595/3804 (94.5058%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3575/3804 (93.9800%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9071, Accuracy: 5723/10000 (57.2300%)
time spent on training: 263.50967359542847
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [6, 18, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.5474, Accuracy: 6261/10000 (62.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0323, Accuracy: 9810/9900 (99.0909%)
Done in 292.6638686656952 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4790/4885 (98.0553%), train_poison_data_count: 385
Global model norm: 44.80171701683151.
Norm before scaling: 44.76183857241358. Distance: 1.1358073667681978
Total norm for 4 adversaries is: 44.76183857241358. distance: 1.1358073667681978
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0597, Accuracy: 9747/9900 (98.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5189/5305 (97.8134%), train_poison_data_count: 415
Global model norm: 44.80171701683151.
Norm before scaling: 44.75918910978644. Distance: 1.188066046474746
Total norm for 4 adversaries is: 44.75918910978644. distance: 1.188066046474746
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0684, Accuracy: 9734/9900 (98.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4596/4717 (97.4348%), train_poison_data_count: 370
Global model norm: 44.80171701683151.
Norm before scaling: 44.762450803693994. Distance: 1.0771668640940046
Total norm for 4 adversaries is: 44.762450803693994. distance: 1.0771668640940046
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0559, Accuracy: 9763/9900 (98.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4962/5066 (97.9471%), train_poison_data_count: 400
Global model norm: 44.80171701683151.
Norm before scaling: 44.761301329158066. Distance: 1.1614298909671992
Total norm for 4 adversaries is: 44.761301329158066. distance: 1.1614298909671992
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0552, Accuracy: 9759/9900 (98.5758%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4509/4804 (93.8593%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4368/4804 (90.9242%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1004, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3727/3911 (95.2953%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3456/3911 (88.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1925, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3839/4013 (95.6641%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3787/4013 (94.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7925, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4807/5232 (91.8769%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4662/5232 (89.1055%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1463, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5235/5591 (93.6326%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4984/5591 (89.1433%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2670, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3610/3837 (94.0839%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3649/3837 (95.1003%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9092, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5116/5424 (94.3215%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5006/5424 (92.2935%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2708, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4863/5167 (94.1165%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4782/5167 (92.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0236, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4245/4456 (95.2648%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4209/4456 (94.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8303, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4673/4928 (94.8255%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4608/4928 (93.5065%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8770, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4219/4433 (95.1726%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4108/4433 (92.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0100, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3137/3297 (95.1471%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3152/3297 (95.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7545, Accuracy: 6079/10000 (60.7900%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4412/4716 (93.5539%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4281/4716 (90.7761%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0979, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4365/4596 (94.9739%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4316/4596 (93.9077%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9032, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4553/4793 (94.9927%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4484/4793 (93.5531%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9975, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4133/4416 (93.5915%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4041/4416 (91.5082%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0047, Accuracy: 5568/10000 (55.6800%)
time spent on training: 266.3573741912842
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [7, 12, 6]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.5428, Accuracy: 6263/10000 (62.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0341, Accuracy: 9806/9900 (99.0505%)
Done in 295.46557784080505 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4805/4885 (98.3623%), train_poison_data_count: 385
Global model norm: 44.81923600437233.
Norm before scaling: 44.777289056332734. Distance: 1.0774214840314928
Total norm for 4 adversaries is: 44.777289056332734. distance: 1.0774214840314928
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0219, Accuracy: 9844/9900 (99.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5197/5305 (97.9642%), train_poison_data_count: 415
Global model norm: 44.81923600437233.
Norm before scaling: 44.77671383166143. Distance: 1.2015300433831368
Total norm for 4 adversaries is: 44.77671383166143. distance: 1.2015300433831368
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0290, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4612/4717 (97.7740%), train_poison_data_count: 370
Global model norm: 44.81923600437233.
Norm before scaling: 44.78171067889351. Distance: 1.1270408133467664
Total norm for 4 adversaries is: 44.78171067889351. distance: 1.1270408133467664
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0330, Accuracy: 9813/9900 (99.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4974/5066 (98.1840%), train_poison_data_count: 400
Global model norm: 44.81923600437233.
Norm before scaling: 44.77885657421089. Distance: 1.150262900031618
Total norm for 4 adversaries is: 44.77885657421089. distance: 1.150262900031618
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0210, Accuracy: 9848/9900 (99.4747%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3034/3271 (92.7545%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2964/3271 (90.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0266, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4841/5116 (94.6247%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4687/5116 (91.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9449, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4234/4501 (94.0680%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4166/4501 (92.5572%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2017, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4123/4356 (94.6511%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3946/4356 (90.5877%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2149, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4072/4368 (93.2234%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3977/4368 (91.0485%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0137, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3638/3837 (94.8137%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3631/3837 (94.6312%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9592, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5391/5740 (93.9199%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5301/5740 (92.3519%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1962, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3435/3590 (95.6825%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3135/3590 (87.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4069, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3143/3297 (95.3291%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3120/3297 (94.6315%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7364, Accuracy: 5996/10000 (59.9600%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4397/4716 (93.2358%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4258/4716 (90.2884%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0951, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4824/5055 (95.4303%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4734/5055 (93.6499%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9570, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3725/3911 (95.2442%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3279/3911 (83.8405%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4257, Accuracy: 4878/10000 (48.7800%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3826/4158 (92.0154%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3776/4158 (90.8129%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0426, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4268/4456 (95.7810%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4210/4456 (94.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8890, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4209/4511 (93.3053%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4175/4511 (92.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2247, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3450/3672 (93.9542%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3404/3672 (92.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8525, Accuracy: 5854/10000 (58.5400%)
time spent on training: 260.7466404438019
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 12, 18]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.5537, Accuracy: 6247/10000 (62.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0320, Accuracy: 9812/9900 (99.1111%)
Done in 290.04428124427795 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4808/4885 (98.4237%), train_poison_data_count: 385
Global model norm: 44.836541232431166.
Norm before scaling: 44.794010960939296. Distance: 1.061514846500281
Total norm for 4 adversaries is: 44.794010960939296. distance: 1.061514846500281
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0390, Accuracy: 9807/9900 (99.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5185/5305 (97.7380%), train_poison_data_count: 415
Global model norm: 44.836541232431166.
Norm before scaling: 44.79643491456309. Distance: 1.2556334391681072
Total norm for 4 adversaries is: 44.79643491456309. distance: 1.2556334391681072
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0161, Accuracy: 9861/9900 (99.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4609/4717 (97.7104%), train_poison_data_count: 370
Global model norm: 44.836541232431166.
Norm before scaling: 44.79737911732393. Distance: 1.079080849012881
Total norm for 4 adversaries is: 44.79737911732393. distance: 1.079080849012881
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0419, Accuracy: 9798/9900 (98.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4969/5066 (98.0853%), train_poison_data_count: 400
Global model norm: 44.836541232431166.
Norm before scaling: 44.79496066497394. Distance: 1.133620243827659
Total norm for 4 adversaries is: 44.79496066497394. distance: 1.133620243827659
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0651, Accuracy: 9741/9900 (98.3939%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4724/5063 (93.3044%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4589/5063 (90.6380%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1731, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4777/5083 (93.9799%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4534/5083 (89.1993%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2686, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3600/3797 (94.8117%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3545/3797 (93.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9525, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5666/6124 (92.5212%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5501/6124 (89.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0689, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4832/5232 (92.3547%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4757/5232 (90.9213%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9274, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3676/3861 (95.2085%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3549/3861 (91.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8859, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4663/5037 (92.5749%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4625/5037 (91.8205%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9659, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4872/5116 (95.2306%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4711/5116 (92.0837%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9506, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4073/4368 (93.2463%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3907/4368 (89.4460%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1555, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3435/3672 (93.5458%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3393/3672 (92.4020%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8552, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5473/5902 (92.7313%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5268/5902 (89.2579%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2676, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4070/4361 (93.3272%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4038/4361 (92.5934%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9434, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3813/4158 (91.7027%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3764/4158 (90.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1255, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4739/5025 (94.3085%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4685/5025 (93.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0676, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4257/4456 (95.5341%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4190/4456 (94.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8192, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4216/4433 (95.1049%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4126/4433 (93.0747%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8815, Accuracy: 5800/10000 (58.0000%)
time spent on training: 267.7589581012726
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [13, 10, 18]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.5561, Accuracy: 6247/10000 (62.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0307, Accuracy: 9817/9900 (99.1616%)
Done in 296.8516001701355 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4806/4885 (98.3828%), train_poison_data_count: 385
Global model norm: 44.85628771812891.
Norm before scaling: 44.81381296019398. Distance: 1.0487274746754855
Total norm for 4 adversaries is: 44.81381296019398. distance: 1.0487274746754855
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0697, Accuracy: 9710/9900 (98.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5179/5305 (97.6249%), train_poison_data_count: 415
Global model norm: 44.85628771812891.
Norm before scaling: 44.81394915718207. Distance: 1.2108836500438354
Total norm for 4 adversaries is: 44.81394915718207. distance: 1.2108836500438354
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0183, Accuracy: 9855/9900 (99.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4626/4717 (98.0708%), train_poison_data_count: 370
Global model norm: 44.85628771812891.
Norm before scaling: 44.81612008129022. Distance: 1.0594491915759552
Total norm for 4 adversaries is: 44.81612008129022. distance: 1.0594491915759552
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0247, Accuracy: 9838/9900 (99.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4948/5066 (97.6707%), train_poison_data_count: 400
Global model norm: 44.85628771812891.
Norm before scaling: 44.81625899506227. Distance: 1.1785864839376636
Total norm for 4 adversaries is: 44.81625899506227. distance: 1.1785864839376636
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0764, Accuracy: 9687/9900 (97.8485%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3832/4025 (95.2050%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3837/4025 (95.3292%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.7398, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4561/4928 (92.5528%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4430/4928 (89.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1441, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3936/4175 (94.2754%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3821/4175 (91.5210%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0069, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4146/4416 (93.8859%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4073/4416 (92.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0097, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3609/3797 (95.0487%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3587/3797 (94.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9988, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4866/5195 (93.6670%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4686/5195 (90.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1583, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4878/5232 (93.2339%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4777/5232 (91.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1207, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5108/5455 (93.6389%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4947/5455 (90.6874%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2408, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4359/4716 (92.4300%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4273/4716 (90.6064%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0020, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4439/4679 (94.8707%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4201/4679 (89.7841%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1608, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5910/6263 (94.3637%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5803/6263 (92.6553%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1285, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4674/4918 (95.0386%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4578/4918 (93.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0736, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4256/4456 (95.5117%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4161/4456 (93.3797%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9576, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5526/5902 (93.6293%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5221/5902 (88.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2642, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4188/4481 (93.4613%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3973/4481 (88.6632%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2073, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5207/5591 (93.1318%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4968/5591 (88.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2775, Accuracy: 5149/10000 (51.4900%)
time spent on training: 269.1024258136749
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 15, 5]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.5674, Accuracy: 6220/10000 (62.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0317, Accuracy: 9815/9900 (99.1414%)
Done in 298.7496831417084 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4801/4885 (98.2805%), train_poison_data_count: 385
Global model norm: 44.87570725417595.
Norm before scaling: 44.83538548950134. Distance: 1.1302542904184067
Total norm for 4 adversaries is: 44.83538548950134. distance: 1.1302542904184067
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0215, Accuracy: 9851/9900 (99.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5180/5305 (97.6437%), train_poison_data_count: 415
Global model norm: 44.87570725417595.
Norm before scaling: 44.83462586838227. Distance: 1.2268689009776705
Total norm for 4 adversaries is: 44.83462586838227. distance: 1.2268689009776705
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1217, Accuracy: 9580/9900 (96.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4621/4717 (97.9648%), train_poison_data_count: 370
Global model norm: 44.87570725417595.
Norm before scaling: 44.83701359464006. Distance: 1.0999414948597301
Total norm for 4 adversaries is: 44.83701359464006. distance: 1.0999414948597301
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0361, Accuracy: 9803/9900 (99.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4965/5066 (98.0063%), train_poison_data_count: 400
Global model norm: 44.87570725417595.
Norm before scaling: 44.835638693681084. Distance: 1.1636628354513157
Total norm for 4 adversaries is: 44.835638693681084. distance: 1.1636628354513157
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0386, Accuracy: 9804/9900 (99.0303%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4188/4501 (93.0460%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4068/4501 (90.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0260, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4798/5083 (94.3931%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4631/5083 (91.1076%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9010, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3586/3804 (94.2692%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3563/3804 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8967, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3603/3756 (95.9265%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3609/3756 (96.0863%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8749, Accuracy: 5938/10000 (59.3800%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3933/4175 (94.2036%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3896/4175 (93.3174%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9316, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4615/4934 (93.5347%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4164/4934 (84.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3969, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4043/4336 (93.2426%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4033/4336 (93.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1099, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4141/4356 (95.0643%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3791/4356 (87.0294%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.6176, Accuracy: 4624/10000 (46.2400%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4839/5244 (92.2769%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4639/5244 (88.4630%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1234, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4783/5017 (95.3359%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4653/5017 (92.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9493, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3668/3828 (95.8203%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3615/3828 (94.4357%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.7674, Accuracy: 5937/10000 (59.3700%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4314/4538 (95.0639%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4303/4538 (94.8215%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8634, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3402/3638 (93.5129%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3383/3638 (92.9907%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.7842, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4416/4662 (94.7233%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4378/4662 (93.9082%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0299, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3648/3797 (96.0758%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3598/3797 (94.7590%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9000, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4336/4634 (93.5693%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4289/4634 (92.5550%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9155, Accuracy: 5690/10000 (56.9000%)
time spent on training: 262.8329312801361
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 12, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.5774, Accuracy: 6204/10000 (62.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0309, Accuracy: 9815/9900 (99.1414%)
Done in 291.73509526252747 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4808/4885 (98.4237%), train_poison_data_count: 385
Global model norm: 44.89126266732968.
Norm before scaling: 44.84897345449364. Distance: 1.0645210454427336
Total norm for 4 adversaries is: 44.84897345449364. distance: 1.0645210454427336
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0274, Accuracy: 9833/9900 (99.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5176/5305 (97.5683%), train_poison_data_count: 415
Global model norm: 44.89126266732968.
Norm before scaling: 44.85080111159178. Distance: 1.2793831133713327
Total norm for 4 adversaries is: 44.85080111159178. distance: 1.2793831133713327
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0088, Accuracy: 9871/9900 (99.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4627/4717 (98.0920%), train_poison_data_count: 370
Global model norm: 44.89126266732968.
Norm before scaling: 44.849746441416755. Distance: 1.0045870242742587
Total norm for 4 adversaries is: 44.849746441416755. distance: 1.0045870242742587
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0261, Accuracy: 9833/9900 (99.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4956/5066 (97.8287%), train_poison_data_count: 400
Global model norm: 44.89126266732968.
Norm before scaling: 44.85234292671482. Distance: 1.1998070879686633
Total norm for 4 adversaries is: 44.85234292671482. distance: 1.1998070879686633
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0392, Accuracy: 9802/9900 (99.0101%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3950/4175 (94.6108%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3786/4175 (90.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2601, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4237/4465 (94.8936%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4169/4465 (93.3707%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8193, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4635/4918 (94.2456%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4523/4918 (91.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1654, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4670/5037 (92.7139%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4661/5037 (92.5352%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8866, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3608/3781 (95.4245%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3456/3781 (91.4044%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2193, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4360/4634 (94.0872%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4284/4634 (92.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.7852, Accuracy: 5965/10000 (59.6500%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4332/4576 (94.6678%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4274/4576 (93.4003%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0509, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3661/3861 (94.8200%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3514/3861 (91.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0836, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5683/6124 (92.7988%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5468/6124 (89.2880%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1292, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4003/4223 (94.7904%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3998/4223 (94.6720%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8412, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4747/5083 (93.3897%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4590/5083 (90.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2716, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4114/4356 (94.4444%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3938/4356 (90.4040%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3327, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4501/4793 (93.9078%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4464/4793 (93.1358%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1456, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4785/5055 (94.6588%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4680/5055 (92.5816%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9686, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4173/4362 (95.6671%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3998/4362 (91.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2741, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4207/4433 (94.9019%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4145/4433 (93.5033%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0249, Accuracy: 5715/10000 (57.1500%)
time spent on training: 265.80011224746704
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [10, 7, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.5781, Accuracy: 6189/10000 (61.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0294, Accuracy: 9817/9900 (99.1616%)
Done in 295.11032009124756 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4794/4885 (98.1372%), train_poison_data_count: 385
Global model norm: 44.908667895501395.
Norm before scaling: 44.86594616187204. Distance: 1.0827953518917455
Total norm for 4 adversaries is: 44.86594616187204. distance: 1.0827953518917455
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0161, Accuracy: 9862/9900 (99.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5182/5305 (97.6814%), train_poison_data_count: 415
Global model norm: 44.908667895501395.
Norm before scaling: 44.86456126411887. Distance: 1.1759359568459804
Total norm for 4 adversaries is: 44.86456126411887. distance: 1.1759359568459804
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0426, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4606/4717 (97.6468%), train_poison_data_count: 370
Global model norm: 44.908667895501395.
Norm before scaling: 44.86832405947708. Distance: 1.090420368748523
Total norm for 4 adversaries is: 44.86832405947708. distance: 1.090420368748523
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0489, Accuracy: 9781/9900 (98.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4946/5066 (97.6313%), train_poison_data_count: 400
Global model norm: 44.908667895501395.
Norm before scaling: 44.870507315583275. Distance: 1.2439252106978016
Total norm for 4 adversaries is: 44.870507315583275. distance: 1.2439252106978016
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0141, Accuracy: 9857/9900 (99.5657%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4707/5025 (93.6716%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4609/5025 (91.7214%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1700, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4229/4441 (95.2263%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4169/4441 (93.8753%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9503, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5217/5591 (93.3107%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5062/5591 (90.5384%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0555, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4230/4481 (94.3986%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4095/4481 (91.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0400, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4429/4767 (92.9096%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4282/4767 (89.8259%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3821, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4781/5055 (94.5796%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4675/5055 (92.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9685, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4292/4518 (94.9978%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4280/4518 (94.7322%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8718, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4300/4625 (92.9730%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4205/4625 (90.9189%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2200, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4542/4793 (94.7632%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4498/4793 (93.8452%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9735, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4760/5083 (93.6455%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4606/5083 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0944, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4857/5244 (92.6201%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4705/5244 (89.7216%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2130, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5866/6263 (93.6612%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5767/6263 (92.0805%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1890, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3970/4175 (95.0898%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3817/4175 (91.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9150, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4096/4416 (92.7536%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4075/4416 (92.2781%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9742, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4918/5265 (93.4093%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4818/5265 (91.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0158, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3818/4025 (94.8571%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3835/4025 (95.2795%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8287, Accuracy: 5829/10000 (58.2900%)
time spent on training: 270.2991433143616
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [5, 9, 12]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.5785, Accuracy: 6217/10000 (62.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0279, Accuracy: 9823/9900 (99.2222%)
Done in 299.7890934944153 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4808/4885 (98.4237%), train_poison_data_count: 385
Global model norm: 44.92805663989374.
Norm before scaling: 44.88506236201736. Distance: 1.06607687757733
Total norm for 4 adversaries is: 44.88506236201736. distance: 1.06607687757733
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0350, Accuracy: 9814/9900 (99.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5195/5305 (97.9265%), train_poison_data_count: 415
Global model norm: 44.92805663989374.
Norm before scaling: 44.8830321197847. Distance: 1.160674624761052
Total norm for 4 adversaries is: 44.8830321197847. distance: 1.160674624761052
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0627, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4622/4717 (97.9860%), train_poison_data_count: 370
Global model norm: 44.92805663989374.
Norm before scaling: 44.888410089371206. Distance: 1.0747339296419467
Total norm for 4 adversaries is: 44.888410089371206. distance: 1.0747339296419467
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0513, Accuracy: 9767/9900 (98.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4959/5066 (97.8879%), train_poison_data_count: 400
Global model norm: 44.92805663989374.
Norm before scaling: 44.88804296655388. Distance: 1.1891945744273613
Total norm for 4 adversaries is: 44.88804296655388. distance: 1.1891945744273613
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0140, Accuracy: 9862/9900 (99.6162%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4039/4295 (94.0396%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4006/4295 (93.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9824, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4016/4223 (95.0983%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3967/4223 (93.9380%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8663, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4515/4793 (94.1999%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4424/4793 (92.3013%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0463, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4425/4707 (94.0089%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4378/4707 (93.0104%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8635, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5109/5455 (93.6572%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5086/5455 (93.2356%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0698, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4396/4651 (94.5173%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4269/4651 (91.7867%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1632, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3644/3837 (94.9700%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3590/3837 (93.5627%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9173, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4234/4441 (95.3389%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4108/4441 (92.5017%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2973, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3397/3638 (93.3755%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3398/3638 (93.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8198, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4028/4235 (95.1122%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3941/4235 (93.0579%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9543, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4149/4362 (95.1169%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4154/4362 (95.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9540, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3636/3797 (95.7598%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3585/3797 (94.4166%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8916, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3865/4158 (92.9533%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3724/4158 (89.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1323, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3920/4126 (95.0073%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3870/4126 (93.7954%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7649, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4894/5195 (94.2060%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4653/5195 (89.5669%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1715, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3847/4046 (95.0816%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3821/4046 (94.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8489, Accuracy: 5821/10000 (58.2100%)
time spent on training: 262.07572078704834
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [15, 5, 16]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.5849, Accuracy: 6204/10000 (62.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0293, Accuracy: 9821/9900 (99.2020%)
Done in 291.183007478714 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4803/4885 (98.3214%), train_poison_data_count: 385
Global model norm: 44.944180603468425.
Norm before scaling: 44.90169791428758. Distance: 1.077322619855444
Total norm for 4 adversaries is: 44.90169791428758. distance: 1.077322619855444
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0663, Accuracy: 9730/9900 (98.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5200/5305 (98.0207%), train_poison_data_count: 415
Global model norm: 44.944180603468425.
Norm before scaling: 44.899425096803164. Distance: 1.160747493017358
Total norm for 4 adversaries is: 44.899425096803164. distance: 1.160747493017358
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0574, Accuracy: 9757/9900 (98.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4612/4717 (97.7740%), train_poison_data_count: 370
Global model norm: 44.944180603468425.
Norm before scaling: 44.90487314129656. Distance: 1.075526713924018
Total norm for 4 adversaries is: 44.90487314129656. distance: 1.075526713924018
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0205, Accuracy: 9844/9900 (99.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4955/5066 (97.8089%), train_poison_data_count: 400
Global model norm: 44.944180603468425.
Norm before scaling: 44.905199350531085. Distance: 1.2221027620533274
Total norm for 4 adversaries is: 44.905199350531085. distance: 1.2221027620533274
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0135, Accuracy: 9869/9900 (99.6869%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4144/4361 (95.0241%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3959/4361 (90.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0553, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3149/3297 (95.5111%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3124/3297 (94.7528%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.6725, Accuracy: 6140/10000 (61.4000%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4418/4716 (93.6811%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4345/4716 (92.1332%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0310, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4874/5167 (94.3294%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4852/5167 (93.9036%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1274, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4094/4368 (93.7271%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3941/4368 (90.2244%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0516, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4452/4679 (95.1485%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4223/4679 (90.2543%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1249, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4110/4356 (94.3526%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3781/4356 (86.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3595, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5557/5902 (94.1545%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5236/5902 (88.7157%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1839, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3681/3861 (95.3380%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3602/3861 (93.2919%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9974, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4119/4356 (94.5592%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3875/4356 (88.9578%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1952, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5901/6263 (94.2200%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5739/6263 (91.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1119, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3997/4235 (94.3802%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3860/4235 (91.1452%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0367, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4919/5232 (94.0176%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4783/5232 (91.4182%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1578, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4702/5017 (93.7213%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4573/5017 (91.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9587, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4505/4804 (93.7760%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4310/4804 (89.7169%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1217, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4570/4793 (95.3474%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4535/4793 (94.6172%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8174, Accuracy: 5919/10000 (59.1900%)
time spent on training: 264.85213112831116
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 18, 14]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.5822, Accuracy: 6208/10000 (62.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0282, Accuracy: 9823/9900 (99.2222%)
Done in 294.03853011131287 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4800/4885 (98.2600%), train_poison_data_count: 385
Global model norm: 44.96255902267116.
Norm before scaling: 44.920230948176346. Distance: 1.0871068572694749
Total norm for 4 adversaries is: 44.920230948176346. distance: 1.0871068572694749
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0337, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5157/5305 (97.2102%), train_poison_data_count: 415
Global model norm: 44.96255902267116.
Norm before scaling: 44.921870923912856. Distance: 1.3217648525655386
Total norm for 4 adversaries is: 44.921870923912856. distance: 1.3217648525655386
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0190, Accuracy: 9854/9900 (99.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4602/4717 (97.5620%), train_poison_data_count: 370
Global model norm: 44.96255902267116.
Norm before scaling: 44.92176358681836. Distance: 1.0825305984612719
Total norm for 4 adversaries is: 44.92176358681836. distance: 1.0825305984612719
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0065, Accuracy: 9884/9900 (99.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4949/5066 (97.6905%), train_poison_data_count: 400
Global model norm: 44.96255902267116.
Norm before scaling: 44.923119547977464. Distance: 1.220435175670138
Total norm for 4 adversaries is: 44.923119547977464. distance: 1.220435175670138
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0382, Accuracy: 9812/9900 (99.1111%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3656/3837 (95.2828%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3622/3837 (94.3967%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8409, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3678/3861 (95.2603%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3656/3861 (94.6905%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9520, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3964/4175 (94.9461%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3868/4175 (92.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8783, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4284/4441 (96.4648%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4235/4441 (95.3614%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8811, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4056/4336 (93.5424%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3995/4336 (92.1356%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3502, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3810/4046 (94.1671%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3810/4046 (94.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8980, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4634/4956 (93.5028%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4476/4956 (90.3148%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1537, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4416/4618 (95.6258%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4068/4618 (88.0901%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3196, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3398/3616 (93.9712%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3382/3616 (93.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7498, Accuracy: 6026/10000 (60.2600%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4331/4576 (94.6460%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4256/4576 (93.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0061, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3983/4223 (94.3168%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3933/4223 (93.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9570, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4283/4503 (95.1144%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4205/4503 (93.3822%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9285, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3422/3590 (95.3203%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3361/3590 (93.6212%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9726, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4466/4707 (94.8800%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4381/4707 (93.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8721, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3788/4013 (94.3932%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3795/4013 (94.5677%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7528, Accuracy: 5931/10000 (59.3100%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3527/3704 (95.2214%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3496/3704 (94.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7559, Accuracy: 6045/10000 (60.4500%)
time spent on training: 259.68574261665344
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [18, 13, 10]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.5933, Accuracy: 6168/10000 (61.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0259, Accuracy: 9826/9900 (99.2525%)
Done in 288.85049748420715 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4794/4885 (98.1372%), train_poison_data_count: 385
Global model norm: 44.97712363402783.
Norm before scaling: 44.9367325973244. Distance: 1.144833105076058
Total norm for 4 adversaries is: 44.9367325973244. distance: 1.144833105076058
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0229, Accuracy: 9841/9900 (99.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5174/5305 (97.5306%), train_poison_data_count: 415
Global model norm: 44.97712363402783.
Norm before scaling: 44.93648947055722. Distance: 1.2885902233221225
Total norm for 4 adversaries is: 44.93648947055722. distance: 1.2885902233221225
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0217, Accuracy: 9842/9900 (99.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4626/4717 (98.0708%), train_poison_data_count: 370
Global model norm: 44.97712363402783.
Norm before scaling: 44.93536618064954. Distance: 1.0009831721390008
Total norm for 4 adversaries is: 44.93536618064954. distance: 1.0009831721390008
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0207, Accuracy: 9841/9900 (99.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4960/5066 (97.9076%), train_poison_data_count: 400
Global model norm: 44.97712363402783.
Norm before scaling: 44.93838419462183. Distance: 1.2223194377460607
Total norm for 4 adversaries is: 44.93838419462183. distance: 1.2223194377460607
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0380, Accuracy: 9806/9900 (99.0505%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4361/4596 (94.8869%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4271/4596 (92.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0664, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4116/4356 (94.4904%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3942/4356 (90.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1770, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4104/4295 (95.5530%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4008/4295 (93.3178%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9924, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4367/4634 (94.2382%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4293/4634 (92.6413%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0984, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4400/4767 (92.3012%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4262/4767 (89.4063%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1171, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4034/4223 (95.5245%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4018/4223 (95.1456%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7584, Accuracy: 6020/10000 (60.2000%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3816/4046 (94.3154%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3809/4046 (94.1424%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8444, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4779/5083 (94.0193%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4615/5083 (90.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3470, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4204/4362 (96.3778%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4163/4362 (95.4379%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8575, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4432/4663 (95.0461%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4359/4663 (93.4806%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9498, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3136/3297 (95.1168%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3079/3297 (93.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8674, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4232/4433 (95.4658%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4176/4433 (94.2026%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8036, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4918/5265 (93.4093%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4768/5265 (90.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9947, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4739/4986 (95.0461%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4622/4986 (92.6996%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9457, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4378/4647 (94.2113%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4315/4647 (92.8556%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0911, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4760/5017 (94.8774%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4603/5017 (91.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8818, Accuracy: 5772/10000 (57.7200%)
time spent on training: 262.60337495803833
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 7, 9]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.5927, Accuracy: 6178/10000 (61.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0260, Accuracy: 9830/9900 (99.2929%)
Done in 291.8979082107544 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4807/4885 (98.4033%), train_poison_data_count: 385
Global model norm: 44.99392591384558.
Norm before scaling: 44.950550630143844. Distance: 1.0719223167719125
Total norm for 4 adversaries is: 44.950550630143844. distance: 1.0719223167719125
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0368, Accuracy: 9811/9900 (99.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5193/5305 (97.8888%), train_poison_data_count: 415
Global model norm: 44.99392591384558.
Norm before scaling: 44.950693201951154. Distance: 1.2087995791597979
Total norm for 4 adversaries is: 44.950693201951154. distance: 1.2087995791597979
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0665, Accuracy: 9734/9900 (98.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4617/4717 (97.8800%), train_poison_data_count: 370
Global model norm: 44.99392591384558.
Norm before scaling: 44.95312092674643. Distance: 1.0589855637327337
Total norm for 4 adversaries is: 44.95312092674643. distance: 1.0589855637327337
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0520, Accuracy: 9764/9900 (98.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4970/5066 (98.1050%), train_poison_data_count: 400
Global model norm: 44.99392591384558.
Norm before scaling: 44.951313723502565. Distance: 1.1426328466630278
Total norm for 4 adversaries is: 44.951313723502565. distance: 1.1426328466630278
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0560, Accuracy: 9755/9900 (98.5354%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3971/4184 (94.9092%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3913/4184 (93.5229%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8094, Accuracy: 5943/10000 (59.4300%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5910/6391 (92.4738%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5597/6391 (87.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3033, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4581/4934 (92.8456%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4416/4934 (89.5014%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2859, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4391/4618 (95.0845%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4191/4618 (90.7536%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0349, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4019/4235 (94.8996%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3951/4235 (93.2940%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0176, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4210/4465 (94.2889%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4196/4465 (93.9754%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8215, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4240/4503 (94.1594%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4116/4503 (91.4057%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9883, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4710/5025 (93.7313%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4692/5025 (93.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0938, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5284/5582 (94.6614%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5042/5582 (90.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2134, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3630/3804 (95.4259%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3626/3804 (95.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.7513, Accuracy: 6060/10000 (60.6000%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3890/4158 (93.5546%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3757/4158 (90.3559%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9320, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4362/4538 (96.1216%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4331/4538 (95.4385%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.6985, Accuracy: 6093/10000 (60.9300%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4090/4368 (93.6355%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3945/4368 (90.3159%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2753, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4787/5083 (94.1767%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4644/5083 (91.3634%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9745, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4874/5116 (95.2697%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4676/5116 (91.3995%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1071, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4113/4356 (94.4215%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3623/4356 (83.1726%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.4315, Accuracy: 4736/10000 (47.3600%)
time spent on training: 266.9103157520294
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [14, 15, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.5916, Accuracy: 6182/10000 (61.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0279, Accuracy: 9824/9900 (99.2323%)
Done in 296.17595887184143 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4798/4885 (98.2190%), train_poison_data_count: 385
Global model norm: 45.01295657658609.
Norm before scaling: 44.97113603381479. Distance: 1.103190038130792
Total norm for 4 adversaries is: 44.97113603381479. distance: 1.103190038130792
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0674, Accuracy: 9722/9900 (98.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5195/5305 (97.9265%), train_poison_data_count: 415
Global model norm: 45.01295657658609.
Norm before scaling: 44.968127004457976. Distance: 1.1777796190975198
Total norm for 4 adversaries is: 44.968127004457976. distance: 1.1777796190975198
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0476, Accuracy: 9782/9900 (98.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4627/4717 (98.0920%), train_poison_data_count: 370
Global model norm: 45.01295657658609.
Norm before scaling: 44.97193677902087. Distance: 1.0520017548209228
Total norm for 4 adversaries is: 44.97193677902087. distance: 1.0520017548209228
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0447, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4955/5066 (97.8089%), train_poison_data_count: 400
Global model norm: 45.01295657658609.
Norm before scaling: 44.97164769807404. Distance: 1.1856805515496918
Total norm for 4 adversaries is: 44.97164769807404. distance: 1.1856805515496918
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0697, Accuracy: 9720/9900 (98.1818%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5884/6263 (93.9486%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5712/6263 (91.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2388, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4227/4433 (95.3530%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4136/4433 (93.3002%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9344, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3481/3672 (94.7985%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3421/3672 (93.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1245, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5116/5455 (93.7855%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4983/5455 (91.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0617, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4730/5025 (94.1294%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4654/5025 (92.6169%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1719, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4400/4618 (95.2793%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4252/4618 (92.0745%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2763, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4470/4707 (94.9649%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4394/4707 (93.3503%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8388, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4194/4362 (96.1486%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4102/4362 (94.0394%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8735, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4613/4989 (92.4634%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4501/4989 (90.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0481, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4823/5083 (94.8849%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4672/5083 (91.9142%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9589, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4417/4647 (95.0506%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4293/4647 (92.3822%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0145, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4078/4368 (93.3608%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4008/4368 (91.7582%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0334, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4113/4354 (94.4649%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3779/4354 (86.7938%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.8832, Accuracy: 4521/10000 (45.2100%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4482/4767 (94.0214%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4338/4767 (91.0006%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2205, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4441/4662 (95.2595%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4362/4662 (93.5650%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0268, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4489/4804 (93.4430%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4035/4804 (83.9925%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2850, Accuracy: 5138/10000 (51.3800%)
time spent on training: 268.2492563724518
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 11 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [11, 7, 6]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.5979, Accuracy: 6184/10000 (61.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0294, Accuracy: 9818/9900 (99.1717%)
Done in 297.57151889801025 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4802/4885 (98.3009%), train_poison_data_count: 385
Global model norm: 45.03178944420125.
Norm before scaling: 44.989616043680705. Distance: 1.0865714329156781
Total norm for 4 adversaries is: 44.989616043680705. distance: 1.0865714329156781
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0456, Accuracy: 9784/9900 (98.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5187/5305 (97.7757%), train_poison_data_count: 415
Global model norm: 45.03178944420125.
Norm before scaling: 44.989561777653634. Distance: 1.2473024347920578
Total norm for 4 adversaries is: 44.989561777653634. distance: 1.2473024347920578
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0130, Accuracy: 9866/9900 (99.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4619/4717 (97.9224%), train_poison_data_count: 370
Global model norm: 45.03178944420125.
Norm before scaling: 44.991296901456394. Distance: 1.0614584698488236
Total norm for 4 adversaries is: 44.991296901456394. distance: 1.0614584698488236
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0491, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4945/5066 (97.6115%), train_poison_data_count: 400
Global model norm: 45.03178944420125.
Norm before scaling: 44.991726941339586. Distance: 1.2101370350030707
Total norm for 4 adversaries is: 44.991726941339586. distance: 1.2101370350030707
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0394, Accuracy: 9788/9900 (98.8687%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4016/4235 (94.8288%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3984/4235 (94.0732%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9820, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3573/3775 (94.6490%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3610/3775 (95.6291%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7997, Accuracy: 5983/10000 (59.8300%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4579/4874 (93.9475%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4324/4874 (88.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2566, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4954/5265 (94.0931%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4641/5265 (88.1481%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3001, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4762/5083 (93.6848%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4523/5083 (88.9829%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.4002, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4235/4511 (93.8816%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4166/4511 (92.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1578, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4325/4538 (95.3063%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4263/4538 (93.9401%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8549, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4413/4716 (93.5751%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4285/4716 (90.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0944, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4451/4663 (95.4536%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4377/4663 (93.8666%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9952, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4254/4441 (95.7892%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4239/4441 (95.4515%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8813, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4540/4793 (94.7215%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4461/4793 (93.0732%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9494, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4431/4662 (95.0450%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4366/4662 (93.6508%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9533, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3458/3704 (93.3585%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3472/3704 (93.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9561, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4614/4989 (92.4835%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4525/4989 (90.6995%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0512, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4162/4346 (95.7662%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4106/4346 (94.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7993, Accuracy: 6018/10000 (60.1800%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4203/4362 (96.3549%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4124/4362 (94.5438%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8280, Accuracy: 5882/10000 (58.8200%)
time spent on training: 261.57548332214355
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [19, 9, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.6089, Accuracy: 6165/10000 (61.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0292, Accuracy: 9817/9900 (99.1616%)
Done in 290.3915984630585 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 4823/4885 (98.7308%), train_poison_data_count: 385
Global model norm: 45.0485415274457.
Norm before scaling: 45.003390714270076. Distance: 1.0072867626450832
Total norm for 4 adversaries is: 45.003390714270076. distance: 1.0072867626450832
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0604, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5194/5305 (97.9076%), train_poison_data_count: 415
Global model norm: 45.0485415274457.
Norm before scaling: 45.00570439104775. Distance: 1.1912298853678058
Total norm for 4 adversaries is: 45.00570439104775. distance: 1.1912298853678058
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0616, Accuracy: 9755/9900 (98.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4636/4717 (98.2828%), train_poison_data_count: 370
Global model norm: 45.0485415274457.
Norm before scaling: 45.00712156104784. Distance: 1.0527728751366723
Total norm for 4 adversaries is: 45.00712156104784. distance: 1.0527728751366723
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0123, Accuracy: 9862/9900 (99.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4970/5066 (98.1050%), train_poison_data_count: 400
Global model norm: 45.0485415274457.
Norm before scaling: 45.00593629464687. Distance: 1.1184499583332526
Total norm for 4 adversaries is: 45.00593629464687. distance: 1.1184499583332526
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0320, Accuracy: 9824/9900 (99.2323%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3795/3969 (95.6160%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3668/3969 (92.4162%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8101, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4275/4558 (93.7911%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4123/4558 (90.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3330, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4673/4918 (95.0183%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4591/4918 (93.3510%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0982, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5536/5902 (93.7987%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5280/5902 (89.4612%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3455, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4965/5265 (94.3020%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4866/5265 (92.4217%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0327, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4230/4511 (93.7708%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4164/4511 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9624, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4320/4625 (93.4054%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4131/4625 (89.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1703, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4168/4416 (94.3841%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4074/4416 (92.2554%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0914, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3129/3297 (94.9045%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3128/3297 (94.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7807, Accuracy: 6044/10000 (60.4400%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4712/5025 (93.7711%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4612/5025 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1768, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4262/4441 (95.9694%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4222/4441 (95.0687%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0387, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4238/4481 (94.5771%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4011/4481 (89.5113%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1117, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3648/3797 (96.0758%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3633/3797 (95.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7921, Accuracy: 5931/10000 (59.3100%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3445/3646 (94.4871%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3416/3646 (93.6917%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7951, Accuracy: 6000/10000 (60.0000%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3854/4025 (95.7516%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3840/4025 (95.4037%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8780, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4556/4928 (92.4513%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4512/4928 (91.5584%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1897, Accuracy: 5387/10000 (53.8700%)
time spent on training: 262.8748698234558
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Identified adversaries: [9, 17, 11]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we're just takeing top 3).
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6257, Accuracy: 6137/10000 (61.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0282, Accuracy: 9824/9900 (99.2323%)
Done in 292.2001383304596 sec.
Saving all the graphs.
This run has a label: Dec.07_03.02.06. Visdom environment: cifar100_CerP
